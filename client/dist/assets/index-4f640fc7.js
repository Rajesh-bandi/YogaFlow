var gY=Object.defineProperty;var yY=(t,e,n)=>e in t?gY(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var Je=(t,e,n)=>(yY(t,typeof e!="symbol"?e+"":e,n),n),_k=(t,e,n)=>{if(!e.has(t))throw TypeError("Cannot "+n)};var J=(t,e,n)=>(_k(t,e,"read from private field"),n?n.call(t):e.get(t)),Ue=(t,e,n)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,n)},Pe=(t,e,n,s)=>(_k(t,e,"write to private field"),s?s.call(t,n):e.set(t,n),n);var ex=(t,e,n,s)=>({set _(r){Pe(t,e,r,n)},get _(){return J(t,e,s)}}),vt=(t,e,n)=>(_k(t,e,"access private method"),n);function KV(t,e){for(var n=0;n<e.length;n++){const s=e[n];if(typeof s!="string"&&!Array.isArray(s)){for(const r in s)if(r!=="default"&&!(r in t)){const i=Object.getOwnPropertyDescriptor(s,r);i&&Object.defineProperty(t,r,i.get?i:{enumerable:!0,get:()=>s[r]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function n(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(r){if(r.ep)return;r.ep=!0;const i=n(r);fetch(r.href,i)}})();var $o=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Iw(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function xY(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function s(){return this instanceof s?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(s){var r=Object.getOwnPropertyDescriptor(t,s);Object.defineProperty(n,s,r.get?r:{enumerable:!0,get:function(){return t[s]}})}),n}var qV={exports:{}},_w={},XV={exports:{}},It={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Zg=Symbol.for("react.element"),vY=Symbol.for("react.portal"),bY=Symbol.for("react.fragment"),wY=Symbol.for("react.strict_mode"),SY=Symbol.for("react.profiler"),kY=Symbol.for("react.provider"),CY=Symbol.for("react.context"),TY=Symbol.for("react.forward_ref"),NY=Symbol.for("react.suspense"),IY=Symbol.for("react.memo"),_Y=Symbol.for("react.lazy"),cO=Symbol.iterator;function EY(t){return t===null||typeof t!="object"?null:(t=cO&&t[cO]||t["@@iterator"],typeof t=="function"?t:null)}var YV={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},ZV=Object.assign,QV={};function Uf(t,e,n){this.props=t,this.context=e,this.refs=QV,this.updater=n||YV}Uf.prototype.isReactComponent={};Uf.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Uf.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function JV(){}JV.prototype=Uf.prototype;function $I(t,e,n){this.props=t,this.context=e,this.refs=QV,this.updater=n||YV}var AI=$I.prototype=new JV;AI.constructor=$I;ZV(AI,Uf.prototype);AI.isPureReactComponent=!0;var uO=Array.isArray,ej=Object.prototype.hasOwnProperty,RI={current:null},tj={key:!0,ref:!0,__self:!0,__source:!0};function nj(t,e,n){var s,r={},i=null,o=null;if(e!=null)for(s in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)ej.call(e,s)&&!tj.hasOwnProperty(s)&&(r[s]=e[s]);var a=arguments.length-2;if(a===1)r.children=n;else if(1<a){for(var l=Array(a),c=0;c<a;c++)l[c]=arguments[c+2];r.children=l}if(t&&t.defaultProps)for(s in a=t.defaultProps,a)r[s]===void 0&&(r[s]=a[s]);return{$$typeof:Zg,type:t,key:i,ref:o,props:r,_owner:RI.current}}function $Y(t,e){return{$$typeof:Zg,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function DI(t){return typeof t=="object"&&t!==null&&t.$$typeof===Zg}function AY(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var dO=/\/+/g;function Ek(t,e){return typeof t=="object"&&t!==null&&t.key!=null?AY(""+t.key):e.toString(36)}function iv(t,e,n,s,r){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Zg:case vY:o=!0}}if(o)return o=t,r=r(o),t=s===""?"."+Ek(o,0):s,uO(r)?(n="",t!=null&&(n=t.replace(dO,"$&/")+"/"),iv(r,e,n,"",function(c){return c})):r!=null&&(DI(r)&&(r=$Y(r,n+(!r.key||o&&o.key===r.key?"":(""+r.key).replace(dO,"$&/")+"/")+t)),e.push(r)),1;if(o=0,s=s===""?".":s+":",uO(t))for(var a=0;a<t.length;a++){i=t[a];var l=s+Ek(i,a);o+=iv(i,e,n,l,r)}else if(l=EY(t),typeof l=="function")for(t=l.call(t),a=0;!(i=t.next()).done;)i=i.value,l=s+Ek(i,a++),o+=iv(i,e,n,l,r);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function tx(t,e,n){if(t==null)return t;var s=[],r=0;return iv(t,s,"","",function(i){return e.call(n,i,r++)}),s}function RY(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Er={current:null},ov={transition:null},DY={ReactCurrentDispatcher:Er,ReactCurrentBatchConfig:ov,ReactCurrentOwner:RI};function sj(){throw Error("act(...) is not supported in production builds of React.")}It.Children={map:tx,forEach:function(t,e,n){tx(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return tx(t,function(){e++}),e},toArray:function(t){return tx(t,function(e){return e})||[]},only:function(t){if(!DI(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};It.Component=Uf;It.Fragment=bY;It.Profiler=SY;It.PureComponent=$I;It.StrictMode=wY;It.Suspense=NY;It.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=DY;It.act=sj;It.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var s=ZV({},t.props),r=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=RI.current),e.key!==void 0&&(r=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)ej.call(e,l)&&!tj.hasOwnProperty(l)&&(s[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){a=Array(l);for(var c=0;c<l;c++)a[c]=arguments[c+2];s.children=a}return{$$typeof:Zg,type:t.type,key:r,ref:i,props:s,_owner:o}};It.createContext=function(t){return t={$$typeof:CY,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:kY,_context:t},t.Consumer=t};It.createElement=nj;It.createFactory=function(t){var e=nj.bind(null,t);return e.type=t,e};It.createRef=function(){return{current:null}};It.forwardRef=function(t){return{$$typeof:TY,render:t}};It.isValidElement=DI;It.lazy=function(t){return{$$typeof:_Y,_payload:{_status:-1,_result:t},_init:RY}};It.memo=function(t,e){return{$$typeof:IY,type:t,compare:e===void 0?null:e}};It.startTransition=function(t){var e=ov.transition;ov.transition={};try{t()}finally{ov.transition=e}};It.unstable_act=sj;It.useCallback=function(t,e){return Er.current.useCallback(t,e)};It.useContext=function(t){return Er.current.useContext(t)};It.useDebugValue=function(){};It.useDeferredValue=function(t){return Er.current.useDeferredValue(t)};It.useEffect=function(t,e){return Er.current.useEffect(t,e)};It.useId=function(){return Er.current.useId()};It.useImperativeHandle=function(t,e,n){return Er.current.useImperativeHandle(t,e,n)};It.useInsertionEffect=function(t,e){return Er.current.useInsertionEffect(t,e)};It.useLayoutEffect=function(t,e){return Er.current.useLayoutEffect(t,e)};It.useMemo=function(t,e){return Er.current.useMemo(t,e)};It.useReducer=function(t,e,n){return Er.current.useReducer(t,e,n)};It.useRef=function(t){return Er.current.useRef(t)};It.useState=function(t){return Er.current.useState(t)};It.useSyncExternalStore=function(t,e,n){return Er.current.useSyncExternalStore(t,e,n)};It.useTransition=function(){return Er.current.useTransition()};It.version="18.3.1";XV.exports=It;var D=XV.exports;const et=Iw(D),rj=KV({__proto__:null,default:et},[D]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var OY=D,PY=Symbol.for("react.element"),FY=Symbol.for("react.fragment"),LY=Object.prototype.hasOwnProperty,MY=OY.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,zY={key:!0,ref:!0,__self:!0,__source:!0};function ij(t,e,n){var s,r={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(s in e)LY.call(e,s)&&!zY.hasOwnProperty(s)&&(r[s]=e[s]);if(t&&t.defaultProps)for(s in e=t.defaultProps,e)r[s]===void 0&&(r[s]=e[s]);return{$$typeof:PY,type:t,key:i,ref:o,props:r,_owner:MY.current}}_w.Fragment=FY;_w.jsx=ij;_w.jsxs=ij;qV.exports=_w;var S=qV.exports,oj={exports:{}},Ii={},aj={exports:{}},lj={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(M,G){var ne=M.length;M.push(G);e:for(;0<ne;){var ie=ne-1>>>1,de=M[ie];if(0<r(de,G))M[ie]=G,M[ne]=de,ne=ie;else break e}}function n(M){return M.length===0?null:M[0]}function s(M){if(M.length===0)return null;var G=M[0],ne=M.pop();if(ne!==G){M[0]=ne;e:for(var ie=0,de=M.length,he=de>>>1;ie<he;){var pe=2*(ie+1)-1,me=M[pe],ye=pe+1,Ce=M[ye];if(0>r(me,ne))ye<de&&0>r(Ce,me)?(M[ie]=Ce,M[ye]=ne,ie=ye):(M[ie]=me,M[pe]=ne,ie=pe);else if(ye<de&&0>r(Ce,ne))M[ie]=Ce,M[ye]=ne,ie=ye;else break e}}return G}function r(M,G){var ne=M.sortIndex-G.sortIndex;return ne!==0?ne:M.id-G.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],c=[],u=1,d=null,h=3,f=!1,p=!1,m=!1,g=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,x=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function v(M){for(var G=n(c);G!==null;){if(G.callback===null)s(c);else if(G.startTime<=M)s(c),G.sortIndex=G.expirationTime,e(l,G);else break;G=n(c)}}function b(M){if(m=!1,v(M),!p)if(n(l)!==null)p=!0,W(k);else{var G=n(c);G!==null&&q(b,G.startTime-M)}}function k(M,G){p=!1,m&&(m=!1,y(I),I=-1),f=!0;var ne=h;try{for(v(G),d=n(l);d!==null&&(!(d.expirationTime>G)||M&&!P());){var ie=d.callback;if(typeof ie=="function"){d.callback=null,h=d.priorityLevel;var de=ie(d.expirationTime<=G);G=t.unstable_now(),typeof de=="function"?d.callback=de:d===n(l)&&s(l),v(G)}else s(l);d=n(l)}if(d!==null)var he=!0;else{var pe=n(c);pe!==null&&q(b,pe.startTime-G),he=!1}return he}finally{d=null,h=ne,f=!1}}var C=!1,N=null,I=-1,$=5,A=-1;function P(){return!(t.unstable_now()-A<$)}function F(){if(N!==null){var M=t.unstable_now();A=M;var G=!0;try{G=N(!0,M)}finally{G?V():(C=!1,N=null)}}else C=!1}var V;if(typeof x=="function")V=function(){x(F)};else if(typeof MessageChannel<"u"){var z=new MessageChannel,B=z.port2;z.port1.onmessage=F,V=function(){B.postMessage(null)}}else V=function(){g(F,0)};function W(M){N=M,C||(C=!0,V())}function q(M,G){I=g(function(){M(t.unstable_now())},G)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(M){M.callback=null},t.unstable_continueExecution=function(){p||f||(p=!0,W(k))},t.unstable_forceFrameRate=function(M){0>M||125<M?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):$=0<M?Math.floor(1e3/M):5},t.unstable_getCurrentPriorityLevel=function(){return h},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(M){switch(h){case 1:case 2:case 3:var G=3;break;default:G=h}var ne=h;h=G;try{return M()}finally{h=ne}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(M,G){switch(M){case 1:case 2:case 3:case 4:case 5:break;default:M=3}var ne=h;h=M;try{return G()}finally{h=ne}},t.unstable_scheduleCallback=function(M,G,ne){var ie=t.unstable_now();switch(typeof ne=="object"&&ne!==null?(ne=ne.delay,ne=typeof ne=="number"&&0<ne?ie+ne:ie):ne=ie,M){case 1:var de=-1;break;case 2:de=250;break;case 5:de=1073741823;break;case 4:de=1e4;break;default:de=5e3}return de=ne+de,M={id:u++,callback:G,priorityLevel:M,startTime:ne,expirationTime:de,sortIndex:-1},ne>ie?(M.sortIndex=ne,e(c,M),n(l)===null&&M===n(c)&&(m?(y(I),I=-1):m=!0,q(b,ne-ie))):(M.sortIndex=de,e(l,M),p||f||(p=!0,W(k))),M},t.unstable_shouldYield=P,t.unstable_wrapCallback=function(M){var G=h;return function(){var ne=h;h=G;try{return M.apply(this,arguments)}finally{h=ne}}}})(lj);aj.exports=lj;var VY=aj.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jY=D,wi=VY;function we(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var cj=new Set,Hm={};function Ed(t,e){uf(t,e),uf(t+"Capture",e)}function uf(t,e){for(Hm[t]=e,t=0;t<e.length;t++)cj.add(e[t])}var ul=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),xT=Object.prototype.hasOwnProperty,BY=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,hO={},fO={};function WY(t){return xT.call(fO,t)?!0:xT.call(hO,t)?!1:BY.test(t)?fO[t]=!0:(hO[t]=!0,!1)}function UY(t,e,n,s){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return s?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function HY(t,e,n,s){if(e===null||typeof e>"u"||UY(t,e,n,s))return!0;if(s)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function $r(t,e,n,s,r,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=s,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var qs={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){qs[t]=new $r(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];qs[e]=new $r(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){qs[t]=new $r(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){qs[t]=new $r(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){qs[t]=new $r(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){qs[t]=new $r(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){qs[t]=new $r(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){qs[t]=new $r(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){qs[t]=new $r(t,5,!1,t.toLowerCase(),null,!1,!1)});var OI=/[\-:]([a-z])/g;function PI(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(OI,PI);qs[e]=new $r(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(OI,PI);qs[e]=new $r(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(OI,PI);qs[e]=new $r(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){qs[t]=new $r(t,1,!1,t.toLowerCase(),null,!1,!1)});qs.xlinkHref=new $r("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){qs[t]=new $r(t,1,!1,t.toLowerCase(),null,!0,!0)});function FI(t,e,n,s){var r=qs.hasOwnProperty(e)?qs[e]:null;(r!==null?r.type!==0:s||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(HY(e,n,r,s)&&(n=null),s||r===null?WY(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):r.mustUseProperty?t[r.propertyName]=n===null?r.type===3?!1:"":n:(e=r.attributeName,s=r.attributeNamespace,n===null?t.removeAttribute(e):(r=r.type,n=r===3||r===4&&n===!0?"":""+n,s?t.setAttributeNS(s,e,n):t.setAttribute(e,n))))}var vl=jY.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,nx=Symbol.for("react.element"),dh=Symbol.for("react.portal"),hh=Symbol.for("react.fragment"),LI=Symbol.for("react.strict_mode"),vT=Symbol.for("react.profiler"),uj=Symbol.for("react.provider"),dj=Symbol.for("react.context"),MI=Symbol.for("react.forward_ref"),bT=Symbol.for("react.suspense"),wT=Symbol.for("react.suspense_list"),zI=Symbol.for("react.memo"),Ll=Symbol.for("react.lazy"),hj=Symbol.for("react.offscreen"),pO=Symbol.iterator;function _p(t){return t===null||typeof t!="object"?null:(t=pO&&t[pO]||t["@@iterator"],typeof t=="function"?t:null)}var Ln=Object.assign,$k;function Qp(t){if($k===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);$k=e&&e[1]||""}return`
`+$k+t}var Ak=!1;function Rk(t,e){if(!t||Ak)return"";Ak=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var s=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){s=c}t.call(e.prototype)}else{try{throw Error()}catch(c){s=c}t()}}catch(c){if(c&&s&&typeof c.stack=="string"){for(var r=c.stack.split(`
`),i=s.stack.split(`
`),o=r.length-1,a=i.length-1;1<=o&&0<=a&&r[o]!==i[a];)a--;for(;1<=o&&0<=a;o--,a--)if(r[o]!==i[a]){if(o!==1||a!==1)do if(o--,a--,0>a||r[o]!==i[a]){var l=`
`+r[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{Ak=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Qp(t):""}function GY(t){switch(t.tag){case 5:return Qp(t.type);case 16:return Qp("Lazy");case 13:return Qp("Suspense");case 19:return Qp("SuspenseList");case 0:case 2:case 15:return t=Rk(t.type,!1),t;case 11:return t=Rk(t.type.render,!1),t;case 1:return t=Rk(t.type,!0),t;default:return""}}function ST(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case hh:return"Fragment";case dh:return"Portal";case vT:return"Profiler";case LI:return"StrictMode";case bT:return"Suspense";case wT:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case dj:return(t.displayName||"Context")+".Consumer";case uj:return(t._context.displayName||"Context")+".Provider";case MI:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case zI:return e=t.displayName||null,e!==null?e:ST(t.type)||"Memo";case Ll:e=t._payload,t=t._init;try{return ST(t(e))}catch{}}return null}function KY(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ST(e);case 8:return e===LI?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function _c(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function fj(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function qY(t){var e=fj(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),s=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var r=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return r.call(this)},set:function(o){s=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return s},setValue:function(o){s=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function sx(t){t._valueTracker||(t._valueTracker=qY(t))}function pj(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),s="";return t&&(s=fj(t)?t.checked?"true":"false":t.value),t=s,t!==n?(e.setValue(t),!0):!1}function zv(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function kT(t,e){var n=e.checked;return Ln({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function mO(t,e){var n=e.defaultValue==null?"":e.defaultValue,s=e.checked!=null?e.checked:e.defaultChecked;n=_c(e.value!=null?e.value:n),t._wrapperState={initialChecked:s,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function mj(t,e){e=e.checked,e!=null&&FI(t,"checked",e,!1)}function CT(t,e){mj(t,e);var n=_c(e.value),s=e.type;if(n!=null)s==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(s==="submit"||s==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?TT(t,e.type,n):e.hasOwnProperty("defaultValue")&&TT(t,e.type,_c(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function gO(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var s=e.type;if(!(s!=="submit"&&s!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function TT(t,e,n){(e!=="number"||zv(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Jp=Array.isArray;function Dh(t,e,n,s){if(t=t.options,e){e={};for(var r=0;r<n.length;r++)e["$"+n[r]]=!0;for(n=0;n<t.length;n++)r=e.hasOwnProperty("$"+t[n].value),t[n].selected!==r&&(t[n].selected=r),r&&s&&(t[n].defaultSelected=!0)}else{for(n=""+_c(n),e=null,r=0;r<t.length;r++){if(t[r].value===n){t[r].selected=!0,s&&(t[r].defaultSelected=!0);return}e!==null||t[r].disabled||(e=t[r])}e!==null&&(e.selected=!0)}}function NT(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(we(91));return Ln({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function yO(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(we(92));if(Jp(n)){if(1<n.length)throw Error(we(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:_c(n)}}function gj(t,e){var n=_c(e.value),s=_c(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),s!=null&&(t.defaultValue=""+s)}function xO(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function yj(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function IT(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?yj(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var rx,xj=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,s,r){MSApp.execUnsafeLocalFunction(function(){return t(e,n,s,r)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(rx=rx||document.createElement("div"),rx.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=rx.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Gm(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var km={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},XY=["Webkit","ms","Moz","O"];Object.keys(km).forEach(function(t){XY.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),km[e]=km[t]})});function vj(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||km.hasOwnProperty(t)&&km[t]?(""+e).trim():e+"px"}function bj(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var s=n.indexOf("--")===0,r=vj(n,e[n],s);n==="float"&&(n="cssFloat"),s?t.setProperty(n,r):t[n]=r}}var YY=Ln({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function _T(t,e){if(e){if(YY[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(we(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(we(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(we(61))}if(e.style!=null&&typeof e.style!="object")throw Error(we(62))}}function ET(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var $T=null;function VI(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var AT=null,Oh=null,Ph=null;function vO(t){if(t=ey(t)){if(typeof AT!="function")throw Error(we(280));var e=t.stateNode;e&&(e=Dw(e),AT(t.stateNode,t.type,e))}}function wj(t){Oh?Ph?Ph.push(t):Ph=[t]:Oh=t}function Sj(){if(Oh){var t=Oh,e=Ph;if(Ph=Oh=null,vO(t),e)for(t=0;t<e.length;t++)vO(e[t])}}function kj(t,e){return t(e)}function Cj(){}var Dk=!1;function Tj(t,e,n){if(Dk)return t(e,n);Dk=!0;try{return kj(t,e,n)}finally{Dk=!1,(Oh!==null||Ph!==null)&&(Cj(),Sj())}}function Km(t,e){var n=t.stateNode;if(n===null)return null;var s=Dw(n);if(s===null)return null;n=s[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(t=t.type,s=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!s;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(we(231,e,typeof n));return n}var RT=!1;if(ul)try{var Ep={};Object.defineProperty(Ep,"passive",{get:function(){RT=!0}}),window.addEventListener("test",Ep,Ep),window.removeEventListener("test",Ep,Ep)}catch{RT=!1}function ZY(t,e,n,s,r,i,o,a,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(n,c)}catch(u){this.onError(u)}}var Cm=!1,Vv=null,jv=!1,DT=null,QY={onError:function(t){Cm=!0,Vv=t}};function JY(t,e,n,s,r,i,o,a,l){Cm=!1,Vv=null,ZY.apply(QY,arguments)}function eZ(t,e,n,s,r,i,o,a,l){if(JY.apply(this,arguments),Cm){if(Cm){var c=Vv;Cm=!1,Vv=null}else throw Error(we(198));jv||(jv=!0,DT=c)}}function $d(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function Nj(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function bO(t){if($d(t)!==t)throw Error(we(188))}function tZ(t){var e=t.alternate;if(!e){if(e=$d(t),e===null)throw Error(we(188));return e!==t?null:t}for(var n=t,s=e;;){var r=n.return;if(r===null)break;var i=r.alternate;if(i===null){if(s=r.return,s!==null){n=s;continue}break}if(r.child===i.child){for(i=r.child;i;){if(i===n)return bO(r),t;if(i===s)return bO(r),e;i=i.sibling}throw Error(we(188))}if(n.return!==s.return)n=r,s=i;else{for(var o=!1,a=r.child;a;){if(a===n){o=!0,n=r,s=i;break}if(a===s){o=!0,s=r,n=i;break}a=a.sibling}if(!o){for(a=i.child;a;){if(a===n){o=!0,n=i,s=r;break}if(a===s){o=!0,s=i,n=r;break}a=a.sibling}if(!o)throw Error(we(189))}}if(n.alternate!==s)throw Error(we(190))}if(n.tag!==3)throw Error(we(188));return n.stateNode.current===n?t:e}function Ij(t){return t=tZ(t),t!==null?_j(t):null}function _j(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=_j(t);if(e!==null)return e;t=t.sibling}return null}var Ej=wi.unstable_scheduleCallback,wO=wi.unstable_cancelCallback,nZ=wi.unstable_shouldYield,sZ=wi.unstable_requestPaint,Yn=wi.unstable_now,rZ=wi.unstable_getCurrentPriorityLevel,jI=wi.unstable_ImmediatePriority,$j=wi.unstable_UserBlockingPriority,Bv=wi.unstable_NormalPriority,iZ=wi.unstable_LowPriority,Aj=wi.unstable_IdlePriority,Ew=null,pa=null;function oZ(t){if(pa&&typeof pa.onCommitFiberRoot=="function")try{pa.onCommitFiberRoot(Ew,t,void 0,(t.current.flags&128)===128)}catch{}}var Ao=Math.clz32?Math.clz32:cZ,aZ=Math.log,lZ=Math.LN2;function cZ(t){return t>>>=0,t===0?32:31-(aZ(t)/lZ|0)|0}var ix=64,ox=4194304;function em(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Wv(t,e){var n=t.pendingLanes;if(n===0)return 0;var s=0,r=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~r;a!==0?s=em(a):(i&=o,i!==0&&(s=em(i)))}else o=n&~r,o!==0?s=em(o):i!==0&&(s=em(i));if(s===0)return 0;if(e!==0&&e!==s&&!(e&r)&&(r=s&-s,i=e&-e,r>=i||r===16&&(i&4194240)!==0))return e;if(s&4&&(s|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=s;0<e;)n=31-Ao(e),r=1<<n,s|=t[n],e&=~r;return s}function uZ(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function dZ(t,e){for(var n=t.suspendedLanes,s=t.pingedLanes,r=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-Ao(i),a=1<<o,l=r[o];l===-1?(!(a&n)||a&s)&&(r[o]=uZ(a,e)):l<=e&&(t.expiredLanes|=a),i&=~a}}function OT(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Rj(){var t=ix;return ix<<=1,!(ix&4194240)&&(ix=64),t}function Ok(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Qg(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Ao(e),t[e]=n}function hZ(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var s=t.eventTimes;for(t=t.expirationTimes;0<n;){var r=31-Ao(n),i=1<<r;e[r]=0,s[r]=-1,t[r]=-1,n&=~i}}function BI(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var s=31-Ao(n),r=1<<s;r&e|t[s]&e&&(t[s]|=e),n&=~r}}var qt=0;function Dj(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Oj,WI,Pj,Fj,Lj,PT=!1,ax=[],cc=null,uc=null,dc=null,qm=new Map,Xm=new Map,jl=[],fZ="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function SO(t,e){switch(t){case"focusin":case"focusout":cc=null;break;case"dragenter":case"dragleave":uc=null;break;case"mouseover":case"mouseout":dc=null;break;case"pointerover":case"pointerout":qm.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Xm.delete(e.pointerId)}}function $p(t,e,n,s,r,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:s,nativeEvent:i,targetContainers:[r]},e!==null&&(e=ey(e),e!==null&&WI(e)),t):(t.eventSystemFlags|=s,e=t.targetContainers,r!==null&&e.indexOf(r)===-1&&e.push(r),t)}function pZ(t,e,n,s,r){switch(e){case"focusin":return cc=$p(cc,t,e,n,s,r),!0;case"dragenter":return uc=$p(uc,t,e,n,s,r),!0;case"mouseover":return dc=$p(dc,t,e,n,s,r),!0;case"pointerover":var i=r.pointerId;return qm.set(i,$p(qm.get(i)||null,t,e,n,s,r)),!0;case"gotpointercapture":return i=r.pointerId,Xm.set(i,$p(Xm.get(i)||null,t,e,n,s,r)),!0}return!1}function Mj(t){var e=Au(t.target);if(e!==null){var n=$d(e);if(n!==null){if(e=n.tag,e===13){if(e=Nj(n),e!==null){t.blockedOn=e,Lj(t.priority,function(){Pj(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function av(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=FT(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var s=new n.constructor(n.type,n);$T=s,n.target.dispatchEvent(s),$T=null}else return e=ey(n),e!==null&&WI(e),t.blockedOn=n,!1;e.shift()}return!0}function kO(t,e,n){av(t)&&n.delete(e)}function mZ(){PT=!1,cc!==null&&av(cc)&&(cc=null),uc!==null&&av(uc)&&(uc=null),dc!==null&&av(dc)&&(dc=null),qm.forEach(kO),Xm.forEach(kO)}function Ap(t,e){t.blockedOn===e&&(t.blockedOn=null,PT||(PT=!0,wi.unstable_scheduleCallback(wi.unstable_NormalPriority,mZ)))}function Ym(t){function e(r){return Ap(r,t)}if(0<ax.length){Ap(ax[0],t);for(var n=1;n<ax.length;n++){var s=ax[n];s.blockedOn===t&&(s.blockedOn=null)}}for(cc!==null&&Ap(cc,t),uc!==null&&Ap(uc,t),dc!==null&&Ap(dc,t),qm.forEach(e),Xm.forEach(e),n=0;n<jl.length;n++)s=jl[n],s.blockedOn===t&&(s.blockedOn=null);for(;0<jl.length&&(n=jl[0],n.blockedOn===null);)Mj(n),n.blockedOn===null&&jl.shift()}var Fh=vl.ReactCurrentBatchConfig,Uv=!0;function gZ(t,e,n,s){var r=qt,i=Fh.transition;Fh.transition=null;try{qt=1,UI(t,e,n,s)}finally{qt=r,Fh.transition=i}}function yZ(t,e,n,s){var r=qt,i=Fh.transition;Fh.transition=null;try{qt=4,UI(t,e,n,s)}finally{qt=r,Fh.transition=i}}function UI(t,e,n,s){if(Uv){var r=FT(t,e,n,s);if(r===null)Uk(t,e,s,Hv,n),SO(t,s);else if(pZ(r,t,e,n,s))s.stopPropagation();else if(SO(t,s),e&4&&-1<fZ.indexOf(t)){for(;r!==null;){var i=ey(r);if(i!==null&&Oj(i),i=FT(t,e,n,s),i===null&&Uk(t,e,s,Hv,n),i===r)break;r=i}r!==null&&s.stopPropagation()}else Uk(t,e,s,null,n)}}var Hv=null;function FT(t,e,n,s){if(Hv=null,t=VI(s),t=Au(t),t!==null)if(e=$d(t),e===null)t=null;else if(n=e.tag,n===13){if(t=Nj(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Hv=t,null}function zj(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(rZ()){case jI:return 1;case $j:return 4;case Bv:case iZ:return 16;case Aj:return 536870912;default:return 16}default:return 16}}var Jl=null,HI=null,lv=null;function Vj(){if(lv)return lv;var t,e=HI,n=e.length,s,r="value"in Jl?Jl.value:Jl.textContent,i=r.length;for(t=0;t<n&&e[t]===r[t];t++);var o=n-t;for(s=1;s<=o&&e[n-s]===r[i-s];s++);return lv=r.slice(t,1<s?1-s:void 0)}function cv(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function lx(){return!0}function CO(){return!1}function _i(t){function e(n,s,r,i,o){this._reactName=n,this._targetInst=r,this.type=s,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(i):i[a]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?lx:CO,this.isPropagationStopped=CO,this}return Ln(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=lx)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=lx)},persist:function(){},isPersistent:lx}),e}var Hf={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},GI=_i(Hf),Jg=Ln({},Hf,{view:0,detail:0}),xZ=_i(Jg),Pk,Fk,Rp,$w=Ln({},Jg,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:KI,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Rp&&(Rp&&t.type==="mousemove"?(Pk=t.screenX-Rp.screenX,Fk=t.screenY-Rp.screenY):Fk=Pk=0,Rp=t),Pk)},movementY:function(t){return"movementY"in t?t.movementY:Fk}}),TO=_i($w),vZ=Ln({},$w,{dataTransfer:0}),bZ=_i(vZ),wZ=Ln({},Jg,{relatedTarget:0}),Lk=_i(wZ),SZ=Ln({},Hf,{animationName:0,elapsedTime:0,pseudoElement:0}),kZ=_i(SZ),CZ=Ln({},Hf,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),TZ=_i(CZ),NZ=Ln({},Hf,{data:0}),NO=_i(NZ),IZ={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},_Z={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},EZ={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function $Z(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=EZ[t])?!!e[t]:!1}function KI(){return $Z}var AZ=Ln({},Jg,{key:function(t){if(t.key){var e=IZ[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=cv(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?_Z[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:KI,charCode:function(t){return t.type==="keypress"?cv(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?cv(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),RZ=_i(AZ),DZ=Ln({},$w,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),IO=_i(DZ),OZ=Ln({},Jg,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:KI}),PZ=_i(OZ),FZ=Ln({},Hf,{propertyName:0,elapsedTime:0,pseudoElement:0}),LZ=_i(FZ),MZ=Ln({},$w,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),zZ=_i(MZ),VZ=[9,13,27,32],qI=ul&&"CompositionEvent"in window,Tm=null;ul&&"documentMode"in document&&(Tm=document.documentMode);var jZ=ul&&"TextEvent"in window&&!Tm,jj=ul&&(!qI||Tm&&8<Tm&&11>=Tm),_O=String.fromCharCode(32),EO=!1;function Bj(t,e){switch(t){case"keyup":return VZ.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Wj(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var fh=!1;function BZ(t,e){switch(t){case"compositionend":return Wj(e);case"keypress":return e.which!==32?null:(EO=!0,_O);case"textInput":return t=e.data,t===_O&&EO?null:t;default:return null}}function WZ(t,e){if(fh)return t==="compositionend"||!qI&&Bj(t,e)?(t=Vj(),lv=HI=Jl=null,fh=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return jj&&e.locale!=="ko"?null:e.data;default:return null}}var UZ={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function $O(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!UZ[t.type]:e==="textarea"}function Uj(t,e,n,s){wj(s),e=Gv(e,"onChange"),0<e.length&&(n=new GI("onChange","change",null,n,s),t.push({event:n,listeners:e}))}var Nm=null,Zm=null;function HZ(t){tB(t,0)}function Aw(t){var e=gh(t);if(pj(e))return t}function GZ(t,e){if(t==="change")return e}var Hj=!1;if(ul){var Mk;if(ul){var zk="oninput"in document;if(!zk){var AO=document.createElement("div");AO.setAttribute("oninput","return;"),zk=typeof AO.oninput=="function"}Mk=zk}else Mk=!1;Hj=Mk&&(!document.documentMode||9<document.documentMode)}function RO(){Nm&&(Nm.detachEvent("onpropertychange",Gj),Zm=Nm=null)}function Gj(t){if(t.propertyName==="value"&&Aw(Zm)){var e=[];Uj(e,Zm,t,VI(t)),Tj(HZ,e)}}function KZ(t,e,n){t==="focusin"?(RO(),Nm=e,Zm=n,Nm.attachEvent("onpropertychange",Gj)):t==="focusout"&&RO()}function qZ(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Aw(Zm)}function XZ(t,e){if(t==="click")return Aw(e)}function YZ(t,e){if(t==="input"||t==="change")return Aw(e)}function ZZ(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Oo=typeof Object.is=="function"?Object.is:ZZ;function Qm(t,e){if(Oo(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),s=Object.keys(e);if(n.length!==s.length)return!1;for(s=0;s<n.length;s++){var r=n[s];if(!xT.call(e,r)||!Oo(t[r],e[r]))return!1}return!0}function DO(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function OO(t,e){var n=DO(t);t=0;for(var s;n;){if(n.nodeType===3){if(s=t+n.textContent.length,t<=e&&s>=e)return{node:n,offset:e-t};t=s}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=DO(n)}}function Kj(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Kj(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function qj(){for(var t=window,e=zv();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=zv(t.document)}return e}function XI(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function QZ(t){var e=qj(),n=t.focusedElem,s=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&Kj(n.ownerDocument.documentElement,n)){if(s!==null&&XI(n)){if(e=s.start,t=s.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var r=n.textContent.length,i=Math.min(s.start,r);s=s.end===void 0?i:Math.min(s.end,r),!t.extend&&i>s&&(r=s,s=i,i=r),r=OO(n,i);var o=OO(n,s);r&&o&&(t.rangeCount!==1||t.anchorNode!==r.node||t.anchorOffset!==r.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(r.node,r.offset),t.removeAllRanges(),i>s?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var JZ=ul&&"documentMode"in document&&11>=document.documentMode,ph=null,LT=null,Im=null,MT=!1;function PO(t,e,n){var s=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;MT||ph==null||ph!==zv(s)||(s=ph,"selectionStart"in s&&XI(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),Im&&Qm(Im,s)||(Im=s,s=Gv(LT,"onSelect"),0<s.length&&(e=new GI("onSelect","select",null,e,n),t.push({event:e,listeners:s}),e.target=ph)))}function cx(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var mh={animationend:cx("Animation","AnimationEnd"),animationiteration:cx("Animation","AnimationIteration"),animationstart:cx("Animation","AnimationStart"),transitionend:cx("Transition","TransitionEnd")},Vk={},Xj={};ul&&(Xj=document.createElement("div").style,"AnimationEvent"in window||(delete mh.animationend.animation,delete mh.animationiteration.animation,delete mh.animationstart.animation),"TransitionEvent"in window||delete mh.transitionend.transition);function Rw(t){if(Vk[t])return Vk[t];if(!mh[t])return t;var e=mh[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in Xj)return Vk[t]=e[n];return t}var Yj=Rw("animationend"),Zj=Rw("animationiteration"),Qj=Rw("animationstart"),Jj=Rw("transitionend"),eB=new Map,FO="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function qc(t,e){eB.set(t,e),Ed(e,[t])}for(var jk=0;jk<FO.length;jk++){var Bk=FO[jk],eQ=Bk.toLowerCase(),tQ=Bk[0].toUpperCase()+Bk.slice(1);qc(eQ,"on"+tQ)}qc(Yj,"onAnimationEnd");qc(Zj,"onAnimationIteration");qc(Qj,"onAnimationStart");qc("dblclick","onDoubleClick");qc("focusin","onFocus");qc("focusout","onBlur");qc(Jj,"onTransitionEnd");uf("onMouseEnter",["mouseout","mouseover"]);uf("onMouseLeave",["mouseout","mouseover"]);uf("onPointerEnter",["pointerout","pointerover"]);uf("onPointerLeave",["pointerout","pointerover"]);Ed("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ed("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ed("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ed("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ed("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ed("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var tm="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),nQ=new Set("cancel close invalid load scroll toggle".split(" ").concat(tm));function LO(t,e,n){var s=t.type||"unknown-event";t.currentTarget=n,eZ(s,e,void 0,t),t.currentTarget=null}function tB(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var s=t[n],r=s.event;s=s.listeners;e:{var i=void 0;if(e)for(var o=s.length-1;0<=o;o--){var a=s[o],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==i&&r.isPropagationStopped())break e;LO(r,a,c),i=l}else for(o=0;o<s.length;o++){if(a=s[o],l=a.instance,c=a.currentTarget,a=a.listener,l!==i&&r.isPropagationStopped())break e;LO(r,a,c),i=l}}}if(jv)throw t=DT,jv=!1,DT=null,t}function gn(t,e){var n=e[WT];n===void 0&&(n=e[WT]=new Set);var s=t+"__bubble";n.has(s)||(nB(e,t,2,!1),n.add(s))}function Wk(t,e,n){var s=0;e&&(s|=4),nB(n,t,s,e)}var ux="_reactListening"+Math.random().toString(36).slice(2);function Jm(t){if(!t[ux]){t[ux]=!0,cj.forEach(function(n){n!=="selectionchange"&&(nQ.has(n)||Wk(n,!1,t),Wk(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[ux]||(e[ux]=!0,Wk("selectionchange",!1,e))}}function nB(t,e,n,s){switch(zj(e)){case 1:var r=gZ;break;case 4:r=yZ;break;default:r=UI}n=r.bind(null,e,n,t),r=void 0,!RT||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(r=!0),s?r!==void 0?t.addEventListener(e,n,{capture:!0,passive:r}):t.addEventListener(e,n,!0):r!==void 0?t.addEventListener(e,n,{passive:r}):t.addEventListener(e,n,!1)}function Uk(t,e,n,s,r){var i=s;if(!(e&1)&&!(e&2)&&s!==null)e:for(;;){if(s===null)return;var o=s.tag;if(o===3||o===4){var a=s.stateNode.containerInfo;if(a===r||a.nodeType===8&&a.parentNode===r)break;if(o===4)for(o=s.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===r||l.nodeType===8&&l.parentNode===r))return;o=o.return}for(;a!==null;){if(o=Au(a),o===null)return;if(l=o.tag,l===5||l===6){s=i=o;continue e}a=a.parentNode}}s=s.return}Tj(function(){var c=i,u=VI(n),d=[];e:{var h=eB.get(t);if(h!==void 0){var f=GI,p=t;switch(t){case"keypress":if(cv(n)===0)break e;case"keydown":case"keyup":f=RZ;break;case"focusin":p="focus",f=Lk;break;case"focusout":p="blur",f=Lk;break;case"beforeblur":case"afterblur":f=Lk;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":f=TO;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":f=bZ;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":f=PZ;break;case Yj:case Zj:case Qj:f=kZ;break;case Jj:f=LZ;break;case"scroll":f=xZ;break;case"wheel":f=zZ;break;case"copy":case"cut":case"paste":f=TZ;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":f=IO}var m=(e&4)!==0,g=!m&&t==="scroll",y=m?h!==null?h+"Capture":null:h;m=[];for(var x=c,v;x!==null;){v=x;var b=v.stateNode;if(v.tag===5&&b!==null&&(v=b,y!==null&&(b=Km(x,y),b!=null&&m.push(eg(x,b,v)))),g)break;x=x.return}0<m.length&&(h=new f(h,p,null,n,u),d.push({event:h,listeners:m}))}}if(!(e&7)){e:{if(h=t==="mouseover"||t==="pointerover",f=t==="mouseout"||t==="pointerout",h&&n!==$T&&(p=n.relatedTarget||n.fromElement)&&(Au(p)||p[dl]))break e;if((f||h)&&(h=u.window===u?u:(h=u.ownerDocument)?h.defaultView||h.parentWindow:window,f?(p=n.relatedTarget||n.toElement,f=c,p=p?Au(p):null,p!==null&&(g=$d(p),p!==g||p.tag!==5&&p.tag!==6)&&(p=null)):(f=null,p=c),f!==p)){if(m=TO,b="onMouseLeave",y="onMouseEnter",x="mouse",(t==="pointerout"||t==="pointerover")&&(m=IO,b="onPointerLeave",y="onPointerEnter",x="pointer"),g=f==null?h:gh(f),v=p==null?h:gh(p),h=new m(b,x+"leave",f,n,u),h.target=g,h.relatedTarget=v,b=null,Au(u)===c&&(m=new m(y,x+"enter",p,n,u),m.target=v,m.relatedTarget=g,b=m),g=b,f&&p)t:{for(m=f,y=p,x=0,v=m;v;v=Zd(v))x++;for(v=0,b=y;b;b=Zd(b))v++;for(;0<x-v;)m=Zd(m),x--;for(;0<v-x;)y=Zd(y),v--;for(;x--;){if(m===y||y!==null&&m===y.alternate)break t;m=Zd(m),y=Zd(y)}m=null}else m=null;f!==null&&MO(d,h,f,m,!1),p!==null&&g!==null&&MO(d,g,p,m,!0)}}e:{if(h=c?gh(c):window,f=h.nodeName&&h.nodeName.toLowerCase(),f==="select"||f==="input"&&h.type==="file")var k=GZ;else if($O(h))if(Hj)k=YZ;else{k=qZ;var C=KZ}else(f=h.nodeName)&&f.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(k=XZ);if(k&&(k=k(t,c))){Uj(d,k,n,u);break e}C&&C(t,h,c),t==="focusout"&&(C=h._wrapperState)&&C.controlled&&h.type==="number"&&TT(h,"number",h.value)}switch(C=c?gh(c):window,t){case"focusin":($O(C)||C.contentEditable==="true")&&(ph=C,LT=c,Im=null);break;case"focusout":Im=LT=ph=null;break;case"mousedown":MT=!0;break;case"contextmenu":case"mouseup":case"dragend":MT=!1,PO(d,n,u);break;case"selectionchange":if(JZ)break;case"keydown":case"keyup":PO(d,n,u)}var N;if(qI)e:{switch(t){case"compositionstart":var I="onCompositionStart";break e;case"compositionend":I="onCompositionEnd";break e;case"compositionupdate":I="onCompositionUpdate";break e}I=void 0}else fh?Bj(t,n)&&(I="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(I="onCompositionStart");I&&(jj&&n.locale!=="ko"&&(fh||I!=="onCompositionStart"?I==="onCompositionEnd"&&fh&&(N=Vj()):(Jl=u,HI="value"in Jl?Jl.value:Jl.textContent,fh=!0)),C=Gv(c,I),0<C.length&&(I=new NO(I,t,null,n,u),d.push({event:I,listeners:C}),N?I.data=N:(N=Wj(n),N!==null&&(I.data=N)))),(N=jZ?BZ(t,n):WZ(t,n))&&(c=Gv(c,"onBeforeInput"),0<c.length&&(u=new NO("onBeforeInput","beforeinput",null,n,u),d.push({event:u,listeners:c}),u.data=N))}tB(d,e)})}function eg(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Gv(t,e){for(var n=e+"Capture",s=[];t!==null;){var r=t,i=r.stateNode;r.tag===5&&i!==null&&(r=i,i=Km(t,n),i!=null&&s.unshift(eg(t,i,r)),i=Km(t,e),i!=null&&s.push(eg(t,i,r))),t=t.return}return s}function Zd(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function MO(t,e,n,s,r){for(var i=e._reactName,o=[];n!==null&&n!==s;){var a=n,l=a.alternate,c=a.stateNode;if(l!==null&&l===s)break;a.tag===5&&c!==null&&(a=c,r?(l=Km(n,i),l!=null&&o.unshift(eg(n,l,a))):r||(l=Km(n,i),l!=null&&o.push(eg(n,l,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var sQ=/\r\n?/g,rQ=/\u0000|\uFFFD/g;function zO(t){return(typeof t=="string"?t:""+t).replace(sQ,`
`).replace(rQ,"")}function dx(t,e,n){if(e=zO(e),zO(t)!==e&&n)throw Error(we(425))}function Kv(){}var zT=null,VT=null;function jT(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var BT=typeof setTimeout=="function"?setTimeout:void 0,iQ=typeof clearTimeout=="function"?clearTimeout:void 0,VO=typeof Promise=="function"?Promise:void 0,oQ=typeof queueMicrotask=="function"?queueMicrotask:typeof VO<"u"?function(t){return VO.resolve(null).then(t).catch(aQ)}:BT;function aQ(t){setTimeout(function(){throw t})}function Hk(t,e){var n=e,s=0;do{var r=n.nextSibling;if(t.removeChild(n),r&&r.nodeType===8)if(n=r.data,n==="/$"){if(s===0){t.removeChild(r),Ym(e);return}s--}else n!=="$"&&n!=="$?"&&n!=="$!"||s++;n=r}while(n);Ym(e)}function hc(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function jO(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Gf=Math.random().toString(36).slice(2),oa="__reactFiber$"+Gf,tg="__reactProps$"+Gf,dl="__reactContainer$"+Gf,WT="__reactEvents$"+Gf,lQ="__reactListeners$"+Gf,cQ="__reactHandles$"+Gf;function Au(t){var e=t[oa];if(e)return e;for(var n=t.parentNode;n;){if(e=n[dl]||n[oa]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=jO(t);t!==null;){if(n=t[oa])return n;t=jO(t)}return e}t=n,n=t.parentNode}return null}function ey(t){return t=t[oa]||t[dl],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function gh(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(we(33))}function Dw(t){return t[tg]||null}var UT=[],yh=-1;function Xc(t){return{current:t}}function yn(t){0>yh||(t.current=UT[yh],UT[yh]=null,yh--)}function cn(t,e){yh++,UT[yh]=t.current,t.current=e}var Ec={},ar=Xc(Ec),Kr=Xc(!1),od=Ec;function df(t,e){var n=t.type.contextTypes;if(!n)return Ec;var s=t.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===e)return s.__reactInternalMemoizedMaskedChildContext;var r={},i;for(i in n)r[i]=e[i];return s&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=r),r}function qr(t){return t=t.childContextTypes,t!=null}function qv(){yn(Kr),yn(ar)}function BO(t,e,n){if(ar.current!==Ec)throw Error(we(168));cn(ar,e),cn(Kr,n)}function sB(t,e,n){var s=t.stateNode;if(e=e.childContextTypes,typeof s.getChildContext!="function")return n;s=s.getChildContext();for(var r in s)if(!(r in e))throw Error(we(108,KY(t)||"Unknown",r));return Ln({},n,s)}function Xv(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Ec,od=ar.current,cn(ar,t),cn(Kr,Kr.current),!0}function WO(t,e,n){var s=t.stateNode;if(!s)throw Error(we(169));n?(t=sB(t,e,od),s.__reactInternalMemoizedMergedChildContext=t,yn(Kr),yn(ar),cn(ar,t)):yn(Kr),cn(Kr,n)}var Ga=null,Ow=!1,Gk=!1;function rB(t){Ga===null?Ga=[t]:Ga.push(t)}function uQ(t){Ow=!0,rB(t)}function Yc(){if(!Gk&&Ga!==null){Gk=!0;var t=0,e=qt;try{var n=Ga;for(qt=1;t<n.length;t++){var s=n[t];do s=s(!0);while(s!==null)}Ga=null,Ow=!1}catch(r){throw Ga!==null&&(Ga=Ga.slice(t+1)),Ej(jI,Yc),r}finally{qt=e,Gk=!1}}return null}var xh=[],vh=0,Yv=null,Zv=0,Gi=[],Ki=0,ad=null,tl=1,nl="";function Su(t,e){xh[vh++]=Zv,xh[vh++]=Yv,Yv=t,Zv=e}function iB(t,e,n){Gi[Ki++]=tl,Gi[Ki++]=nl,Gi[Ki++]=ad,ad=t;var s=tl;t=nl;var r=32-Ao(s)-1;s&=~(1<<r),n+=1;var i=32-Ao(e)+r;if(30<i){var o=r-r%5;i=(s&(1<<o)-1).toString(32),s>>=o,r-=o,tl=1<<32-Ao(e)+r|n<<r|s,nl=i+t}else tl=1<<i|n<<r|s,nl=t}function YI(t){t.return!==null&&(Su(t,1),iB(t,1,0))}function ZI(t){for(;t===Yv;)Yv=xh[--vh],xh[vh]=null,Zv=xh[--vh],xh[vh]=null;for(;t===ad;)ad=Gi[--Ki],Gi[Ki]=null,nl=Gi[--Ki],Gi[Ki]=null,tl=Gi[--Ki],Gi[Ki]=null}var xi=null,mi=null,Sn=!1,Co=null;function oB(t,e){var n=Xi(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function UO(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,xi=t,mi=hc(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,xi=t,mi=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=ad!==null?{id:tl,overflow:nl}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Xi(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,xi=t,mi=null,!0):!1;default:return!1}}function HT(t){return(t.mode&1)!==0&&(t.flags&128)===0}function GT(t){if(Sn){var e=mi;if(e){var n=e;if(!UO(t,e)){if(HT(t))throw Error(we(418));e=hc(n.nextSibling);var s=xi;e&&UO(t,e)?oB(s,n):(t.flags=t.flags&-4097|2,Sn=!1,xi=t)}}else{if(HT(t))throw Error(we(418));t.flags=t.flags&-4097|2,Sn=!1,xi=t}}}function HO(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;xi=t}function hx(t){if(t!==xi)return!1;if(!Sn)return HO(t),Sn=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!jT(t.type,t.memoizedProps)),e&&(e=mi)){if(HT(t))throw aB(),Error(we(418));for(;e;)oB(t,e),e=hc(e.nextSibling)}if(HO(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(we(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){mi=hc(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}mi=null}}else mi=xi?hc(t.stateNode.nextSibling):null;return!0}function aB(){for(var t=mi;t;)t=hc(t.nextSibling)}function hf(){mi=xi=null,Sn=!1}function QI(t){Co===null?Co=[t]:Co.push(t)}var dQ=vl.ReactCurrentBatchConfig;function Dp(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(we(309));var s=n.stateNode}if(!s)throw Error(we(147,t));var r=s,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var a=r.refs;o===null?delete a[i]:a[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(we(284));if(!n._owner)throw Error(we(290,t))}return t}function fx(t,e){throw t=Object.prototype.toString.call(e),Error(we(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function GO(t){var e=t._init;return e(t._payload)}function lB(t){function e(y,x){if(t){var v=y.deletions;v===null?(y.deletions=[x],y.flags|=16):v.push(x)}}function n(y,x){if(!t)return null;for(;x!==null;)e(y,x),x=x.sibling;return null}function s(y,x){for(y=new Map;x!==null;)x.key!==null?y.set(x.key,x):y.set(x.index,x),x=x.sibling;return y}function r(y,x){return y=gc(y,x),y.index=0,y.sibling=null,y}function i(y,x,v){return y.index=v,t?(v=y.alternate,v!==null?(v=v.index,v<x?(y.flags|=2,x):v):(y.flags|=2,x)):(y.flags|=1048576,x)}function o(y){return t&&y.alternate===null&&(y.flags|=2),y}function a(y,x,v,b){return x===null||x.tag!==6?(x=Jk(v,y.mode,b),x.return=y,x):(x=r(x,v),x.return=y,x)}function l(y,x,v,b){var k=v.type;return k===hh?u(y,x,v.props.children,b,v.key):x!==null&&(x.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===Ll&&GO(k)===x.type)?(b=r(x,v.props),b.ref=Dp(y,x,v),b.return=y,b):(b=gv(v.type,v.key,v.props,null,y.mode,b),b.ref=Dp(y,x,v),b.return=y,b)}function c(y,x,v,b){return x===null||x.tag!==4||x.stateNode.containerInfo!==v.containerInfo||x.stateNode.implementation!==v.implementation?(x=eC(v,y.mode,b),x.return=y,x):(x=r(x,v.children||[]),x.return=y,x)}function u(y,x,v,b,k){return x===null||x.tag!==7?(x=Yu(v,y.mode,b,k),x.return=y,x):(x=r(x,v),x.return=y,x)}function d(y,x,v){if(typeof x=="string"&&x!==""||typeof x=="number")return x=Jk(""+x,y.mode,v),x.return=y,x;if(typeof x=="object"&&x!==null){switch(x.$$typeof){case nx:return v=gv(x.type,x.key,x.props,null,y.mode,v),v.ref=Dp(y,null,x),v.return=y,v;case dh:return x=eC(x,y.mode,v),x.return=y,x;case Ll:var b=x._init;return d(y,b(x._payload),v)}if(Jp(x)||_p(x))return x=Yu(x,y.mode,v,null),x.return=y,x;fx(y,x)}return null}function h(y,x,v,b){var k=x!==null?x.key:null;if(typeof v=="string"&&v!==""||typeof v=="number")return k!==null?null:a(y,x,""+v,b);if(typeof v=="object"&&v!==null){switch(v.$$typeof){case nx:return v.key===k?l(y,x,v,b):null;case dh:return v.key===k?c(y,x,v,b):null;case Ll:return k=v._init,h(y,x,k(v._payload),b)}if(Jp(v)||_p(v))return k!==null?null:u(y,x,v,b,null);fx(y,v)}return null}function f(y,x,v,b,k){if(typeof b=="string"&&b!==""||typeof b=="number")return y=y.get(v)||null,a(x,y,""+b,k);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case nx:return y=y.get(b.key===null?v:b.key)||null,l(x,y,b,k);case dh:return y=y.get(b.key===null?v:b.key)||null,c(x,y,b,k);case Ll:var C=b._init;return f(y,x,v,C(b._payload),k)}if(Jp(b)||_p(b))return y=y.get(v)||null,u(x,y,b,k,null);fx(x,b)}return null}function p(y,x,v,b){for(var k=null,C=null,N=x,I=x=0,$=null;N!==null&&I<v.length;I++){N.index>I?($=N,N=null):$=N.sibling;var A=h(y,N,v[I],b);if(A===null){N===null&&(N=$);break}t&&N&&A.alternate===null&&e(y,N),x=i(A,x,I),C===null?k=A:C.sibling=A,C=A,N=$}if(I===v.length)return n(y,N),Sn&&Su(y,I),k;if(N===null){for(;I<v.length;I++)N=d(y,v[I],b),N!==null&&(x=i(N,x,I),C===null?k=N:C.sibling=N,C=N);return Sn&&Su(y,I),k}for(N=s(y,N);I<v.length;I++)$=f(N,y,I,v[I],b),$!==null&&(t&&$.alternate!==null&&N.delete($.key===null?I:$.key),x=i($,x,I),C===null?k=$:C.sibling=$,C=$);return t&&N.forEach(function(P){return e(y,P)}),Sn&&Su(y,I),k}function m(y,x,v,b){var k=_p(v);if(typeof k!="function")throw Error(we(150));if(v=k.call(v),v==null)throw Error(we(151));for(var C=k=null,N=x,I=x=0,$=null,A=v.next();N!==null&&!A.done;I++,A=v.next()){N.index>I?($=N,N=null):$=N.sibling;var P=h(y,N,A.value,b);if(P===null){N===null&&(N=$);break}t&&N&&P.alternate===null&&e(y,N),x=i(P,x,I),C===null?k=P:C.sibling=P,C=P,N=$}if(A.done)return n(y,N),Sn&&Su(y,I),k;if(N===null){for(;!A.done;I++,A=v.next())A=d(y,A.value,b),A!==null&&(x=i(A,x,I),C===null?k=A:C.sibling=A,C=A);return Sn&&Su(y,I),k}for(N=s(y,N);!A.done;I++,A=v.next())A=f(N,y,I,A.value,b),A!==null&&(t&&A.alternate!==null&&N.delete(A.key===null?I:A.key),x=i(A,x,I),C===null?k=A:C.sibling=A,C=A);return t&&N.forEach(function(F){return e(y,F)}),Sn&&Su(y,I),k}function g(y,x,v,b){if(typeof v=="object"&&v!==null&&v.type===hh&&v.key===null&&(v=v.props.children),typeof v=="object"&&v!==null){switch(v.$$typeof){case nx:e:{for(var k=v.key,C=x;C!==null;){if(C.key===k){if(k=v.type,k===hh){if(C.tag===7){n(y,C.sibling),x=r(C,v.props.children),x.return=y,y=x;break e}}else if(C.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===Ll&&GO(k)===C.type){n(y,C.sibling),x=r(C,v.props),x.ref=Dp(y,C,v),x.return=y,y=x;break e}n(y,C);break}else e(y,C);C=C.sibling}v.type===hh?(x=Yu(v.props.children,y.mode,b,v.key),x.return=y,y=x):(b=gv(v.type,v.key,v.props,null,y.mode,b),b.ref=Dp(y,x,v),b.return=y,y=b)}return o(y);case dh:e:{for(C=v.key;x!==null;){if(x.key===C)if(x.tag===4&&x.stateNode.containerInfo===v.containerInfo&&x.stateNode.implementation===v.implementation){n(y,x.sibling),x=r(x,v.children||[]),x.return=y,y=x;break e}else{n(y,x);break}else e(y,x);x=x.sibling}x=eC(v,y.mode,b),x.return=y,y=x}return o(y);case Ll:return C=v._init,g(y,x,C(v._payload),b)}if(Jp(v))return p(y,x,v,b);if(_p(v))return m(y,x,v,b);fx(y,v)}return typeof v=="string"&&v!==""||typeof v=="number"?(v=""+v,x!==null&&x.tag===6?(n(y,x.sibling),x=r(x,v),x.return=y,y=x):(n(y,x),x=Jk(v,y.mode,b),x.return=y,y=x),o(y)):n(y,x)}return g}var ff=lB(!0),cB=lB(!1),Qv=Xc(null),Jv=null,bh=null,JI=null;function e_(){JI=bh=Jv=null}function t_(t){var e=Qv.current;yn(Qv),t._currentValue=e}function KT(t,e,n){for(;t!==null;){var s=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,s!==null&&(s.childLanes|=e)):s!==null&&(s.childLanes&e)!==e&&(s.childLanes|=e),t===n)break;t=t.return}}function Lh(t,e){Jv=t,JI=bh=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Ur=!0),t.firstContext=null)}function io(t){var e=t._currentValue;if(JI!==t)if(t={context:t,memoizedValue:e,next:null},bh===null){if(Jv===null)throw Error(we(308));bh=t,Jv.dependencies={lanes:0,firstContext:t}}else bh=bh.next=t;return e}var Ru=null;function n_(t){Ru===null?Ru=[t]:Ru.push(t)}function uB(t,e,n,s){var r=e.interleaved;return r===null?(n.next=n,n_(e)):(n.next=r.next,r.next=n),e.interleaved=n,hl(t,s)}function hl(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Ml=!1;function s_(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function dB(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function rl(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function fc(t,e,n){var s=t.updateQueue;if(s===null)return null;if(s=s.shared,Pt&2){var r=s.pending;return r===null?e.next=e:(e.next=r.next,r.next=e),s.pending=e,hl(t,n)}return r=s.interleaved,r===null?(e.next=e,n_(s)):(e.next=r.next,r.next=e),s.interleaved=e,hl(t,n)}function uv(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var s=e.lanes;s&=t.pendingLanes,n|=s,e.lanes=n,BI(t,n)}}function KO(t,e){var n=t.updateQueue,s=t.alternate;if(s!==null&&(s=s.updateQueue,n===s)){var r=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?r=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?r=i=e:i=i.next=e}else r=i=e;n={baseState:s.baseState,firstBaseUpdate:r,lastBaseUpdate:i,shared:s.shared,effects:s.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function eb(t,e,n,s){var r=t.updateQueue;Ml=!1;var i=r.firstBaseUpdate,o=r.lastBaseUpdate,a=r.shared.pending;if(a!==null){r.shared.pending=null;var l=a,c=l.next;l.next=null,o===null?i=c:o.next=c,o=l;var u=t.alternate;u!==null&&(u=u.updateQueue,a=u.lastBaseUpdate,a!==o&&(a===null?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(i!==null){var d=r.baseState;o=0,u=c=l=null,a=i;do{var h=a.lane,f=a.eventTime;if((s&h)===h){u!==null&&(u=u.next={eventTime:f,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var p=t,m=a;switch(h=e,f=n,m.tag){case 1:if(p=m.payload,typeof p=="function"){d=p.call(f,d,h);break e}d=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=m.payload,h=typeof p=="function"?p.call(f,d,h):p,h==null)break e;d=Ln({},d,h);break e;case 2:Ml=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,h=r.effects,h===null?r.effects=[a]:h.push(a))}else f={eventTime:f,lane:h,tag:a.tag,payload:a.payload,callback:a.callback,next:null},u===null?(c=u=f,l=d):u=u.next=f,o|=h;if(a=a.next,a===null){if(a=r.shared.pending,a===null)break;h=a,a=h.next,h.next=null,r.lastBaseUpdate=h,r.shared.pending=null}}while(1);if(u===null&&(l=d),r.baseState=l,r.firstBaseUpdate=c,r.lastBaseUpdate=u,e=r.shared.interleaved,e!==null){r=e;do o|=r.lane,r=r.next;while(r!==e)}else i===null&&(r.shared.lanes=0);cd|=o,t.lanes=o,t.memoizedState=d}}function qO(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var s=t[e],r=s.callback;if(r!==null){if(s.callback=null,s=n,typeof r!="function")throw Error(we(191,r));r.call(s)}}}var ty={},ma=Xc(ty),ng=Xc(ty),sg=Xc(ty);function Du(t){if(t===ty)throw Error(we(174));return t}function r_(t,e){switch(cn(sg,e),cn(ng,t),cn(ma,ty),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:IT(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=IT(e,t)}yn(ma),cn(ma,e)}function pf(){yn(ma),yn(ng),yn(sg)}function hB(t){Du(sg.current);var e=Du(ma.current),n=IT(e,t.type);e!==n&&(cn(ng,t),cn(ma,n))}function i_(t){ng.current===t&&(yn(ma),yn(ng))}var $n=Xc(0);function tb(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Kk=[];function o_(){for(var t=0;t<Kk.length;t++)Kk[t]._workInProgressVersionPrimary=null;Kk.length=0}var dv=vl.ReactCurrentDispatcher,qk=vl.ReactCurrentBatchConfig,ld=0,Fn=null,ys=null,Rs=null,nb=!1,_m=!1,rg=0,hQ=0;function Qs(){throw Error(we(321))}function a_(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Oo(t[n],e[n]))return!1;return!0}function l_(t,e,n,s,r,i){if(ld=i,Fn=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,dv.current=t===null||t.memoizedState===null?gQ:yQ,t=n(s,r),_m){i=0;do{if(_m=!1,rg=0,25<=i)throw Error(we(301));i+=1,Rs=ys=null,e.updateQueue=null,dv.current=xQ,t=n(s,r)}while(_m)}if(dv.current=sb,e=ys!==null&&ys.next!==null,ld=0,Rs=ys=Fn=null,nb=!1,e)throw Error(we(300));return t}function c_(){var t=rg!==0;return rg=0,t}function Zo(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Rs===null?Fn.memoizedState=Rs=t:Rs=Rs.next=t,Rs}function oo(){if(ys===null){var t=Fn.alternate;t=t!==null?t.memoizedState:null}else t=ys.next;var e=Rs===null?Fn.memoizedState:Rs.next;if(e!==null)Rs=e,ys=t;else{if(t===null)throw Error(we(310));ys=t,t={memoizedState:ys.memoizedState,baseState:ys.baseState,baseQueue:ys.baseQueue,queue:ys.queue,next:null},Rs===null?Fn.memoizedState=Rs=t:Rs=Rs.next=t}return Rs}function ig(t,e){return typeof e=="function"?e(t):e}function Xk(t){var e=oo(),n=e.queue;if(n===null)throw Error(we(311));n.lastRenderedReducer=t;var s=ys,r=s.baseQueue,i=n.pending;if(i!==null){if(r!==null){var o=r.next;r.next=i.next,i.next=o}s.baseQueue=r=i,n.pending=null}if(r!==null){i=r.next,s=s.baseState;var a=o=null,l=null,c=i;do{var u=c.lane;if((ld&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),s=c.hasEagerState?c.eagerState:t(s,c.action);else{var d={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(a=l=d,o=s):l=l.next=d,Fn.lanes|=u,cd|=u}c=c.next}while(c!==null&&c!==i);l===null?o=s:l.next=a,Oo(s,e.memoizedState)||(Ur=!0),e.memoizedState=s,e.baseState=o,e.baseQueue=l,n.lastRenderedState=s}if(t=n.interleaved,t!==null){r=t;do i=r.lane,Fn.lanes|=i,cd|=i,r=r.next;while(r!==t)}else r===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Yk(t){var e=oo(),n=e.queue;if(n===null)throw Error(we(311));n.lastRenderedReducer=t;var s=n.dispatch,r=n.pending,i=e.memoizedState;if(r!==null){n.pending=null;var o=r=r.next;do i=t(i,o.action),o=o.next;while(o!==r);Oo(i,e.memoizedState)||(Ur=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,s]}function fB(){}function pB(t,e){var n=Fn,s=oo(),r=e(),i=!Oo(s.memoizedState,r);if(i&&(s.memoizedState=r,Ur=!0),s=s.queue,u_(yB.bind(null,n,s,t),[t]),s.getSnapshot!==e||i||Rs!==null&&Rs.memoizedState.tag&1){if(n.flags|=2048,og(9,gB.bind(null,n,s,r,e),void 0,null),Fs===null)throw Error(we(349));ld&30||mB(n,e,r)}return r}function mB(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Fn.updateQueue,e===null?(e={lastEffect:null,stores:null},Fn.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function gB(t,e,n,s){e.value=n,e.getSnapshot=s,xB(e)&&vB(t)}function yB(t,e,n){return n(function(){xB(e)&&vB(t)})}function xB(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Oo(t,n)}catch{return!0}}function vB(t){var e=hl(t,1);e!==null&&Ro(e,t,1,-1)}function XO(t){var e=Zo();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ig,lastRenderedState:t},e.queue=t,t=t.dispatch=mQ.bind(null,Fn,t),[e.memoizedState,t]}function og(t,e,n,s){return t={tag:t,create:e,destroy:n,deps:s,next:null},e=Fn.updateQueue,e===null?(e={lastEffect:null,stores:null},Fn.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(s=n.next,n.next=t,t.next=s,e.lastEffect=t)),t}function bB(){return oo().memoizedState}function hv(t,e,n,s){var r=Zo();Fn.flags|=t,r.memoizedState=og(1|e,n,void 0,s===void 0?null:s)}function Pw(t,e,n,s){var r=oo();s=s===void 0?null:s;var i=void 0;if(ys!==null){var o=ys.memoizedState;if(i=o.destroy,s!==null&&a_(s,o.deps)){r.memoizedState=og(e,n,i,s);return}}Fn.flags|=t,r.memoizedState=og(1|e,n,i,s)}function YO(t,e){return hv(8390656,8,t,e)}function u_(t,e){return Pw(2048,8,t,e)}function wB(t,e){return Pw(4,2,t,e)}function SB(t,e){return Pw(4,4,t,e)}function kB(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function CB(t,e,n){return n=n!=null?n.concat([t]):null,Pw(4,4,kB.bind(null,e,t),n)}function d_(){}function TB(t,e){var n=oo();e=e===void 0?null:e;var s=n.memoizedState;return s!==null&&e!==null&&a_(e,s[1])?s[0]:(n.memoizedState=[t,e],t)}function NB(t,e){var n=oo();e=e===void 0?null:e;var s=n.memoizedState;return s!==null&&e!==null&&a_(e,s[1])?s[0]:(t=t(),n.memoizedState=[t,e],t)}function IB(t,e,n){return ld&21?(Oo(n,e)||(n=Rj(),Fn.lanes|=n,cd|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Ur=!0),t.memoizedState=n)}function fQ(t,e){var n=qt;qt=n!==0&&4>n?n:4,t(!0);var s=qk.transition;qk.transition={};try{t(!1),e()}finally{qt=n,qk.transition=s}}function _B(){return oo().memoizedState}function pQ(t,e,n){var s=mc(t);if(n={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null},EB(t))$B(e,n);else if(n=uB(t,e,n,s),n!==null){var r=Sr();Ro(n,t,s,r),AB(n,e,s)}}function mQ(t,e,n){var s=mc(t),r={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null};if(EB(t))$B(e,r);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,a=i(o,n);if(r.hasEagerState=!0,r.eagerState=a,Oo(a,o)){var l=e.interleaved;l===null?(r.next=r,n_(e)):(r.next=l.next,l.next=r),e.interleaved=r;return}}catch{}finally{}n=uB(t,e,r,s),n!==null&&(r=Sr(),Ro(n,t,s,r),AB(n,e,s))}}function EB(t){var e=t.alternate;return t===Fn||e!==null&&e===Fn}function $B(t,e){_m=nb=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function AB(t,e,n){if(n&4194240){var s=e.lanes;s&=t.pendingLanes,n|=s,e.lanes=n,BI(t,n)}}var sb={readContext:io,useCallback:Qs,useContext:Qs,useEffect:Qs,useImperativeHandle:Qs,useInsertionEffect:Qs,useLayoutEffect:Qs,useMemo:Qs,useReducer:Qs,useRef:Qs,useState:Qs,useDebugValue:Qs,useDeferredValue:Qs,useTransition:Qs,useMutableSource:Qs,useSyncExternalStore:Qs,useId:Qs,unstable_isNewReconciler:!1},gQ={readContext:io,useCallback:function(t,e){return Zo().memoizedState=[t,e===void 0?null:e],t},useContext:io,useEffect:YO,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,hv(4194308,4,kB.bind(null,e,t),n)},useLayoutEffect:function(t,e){return hv(4194308,4,t,e)},useInsertionEffect:function(t,e){return hv(4,2,t,e)},useMemo:function(t,e){var n=Zo();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var s=Zo();return e=n!==void 0?n(e):e,s.memoizedState=s.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},s.queue=t,t=t.dispatch=pQ.bind(null,Fn,t),[s.memoizedState,t]},useRef:function(t){var e=Zo();return t={current:t},e.memoizedState=t},useState:XO,useDebugValue:d_,useDeferredValue:function(t){return Zo().memoizedState=t},useTransition:function(){var t=XO(!1),e=t[0];return t=fQ.bind(null,t[1]),Zo().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var s=Fn,r=Zo();if(Sn){if(n===void 0)throw Error(we(407));n=n()}else{if(n=e(),Fs===null)throw Error(we(349));ld&30||mB(s,e,n)}r.memoizedState=n;var i={value:n,getSnapshot:e};return r.queue=i,YO(yB.bind(null,s,i,t),[t]),s.flags|=2048,og(9,gB.bind(null,s,i,n,e),void 0,null),n},useId:function(){var t=Zo(),e=Fs.identifierPrefix;if(Sn){var n=nl,s=tl;n=(s&~(1<<32-Ao(s)-1)).toString(32)+n,e=":"+e+"R"+n,n=rg++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=hQ++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},yQ={readContext:io,useCallback:TB,useContext:io,useEffect:u_,useImperativeHandle:CB,useInsertionEffect:wB,useLayoutEffect:SB,useMemo:NB,useReducer:Xk,useRef:bB,useState:function(){return Xk(ig)},useDebugValue:d_,useDeferredValue:function(t){var e=oo();return IB(e,ys.memoizedState,t)},useTransition:function(){var t=Xk(ig)[0],e=oo().memoizedState;return[t,e]},useMutableSource:fB,useSyncExternalStore:pB,useId:_B,unstable_isNewReconciler:!1},xQ={readContext:io,useCallback:TB,useContext:io,useEffect:u_,useImperativeHandle:CB,useInsertionEffect:wB,useLayoutEffect:SB,useMemo:NB,useReducer:Yk,useRef:bB,useState:function(){return Yk(ig)},useDebugValue:d_,useDeferredValue:function(t){var e=oo();return ys===null?e.memoizedState=t:IB(e,ys.memoizedState,t)},useTransition:function(){var t=Yk(ig)[0],e=oo().memoizedState;return[t,e]},useMutableSource:fB,useSyncExternalStore:pB,useId:_B,unstable_isNewReconciler:!1};function bo(t,e){if(t&&t.defaultProps){e=Ln({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function qT(t,e,n,s){e=t.memoizedState,n=n(s,e),n=n==null?e:Ln({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Fw={isMounted:function(t){return(t=t._reactInternals)?$d(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var s=Sr(),r=mc(t),i=rl(s,r);i.payload=e,n!=null&&(i.callback=n),e=fc(t,i,r),e!==null&&(Ro(e,t,r,s),uv(e,t,r))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var s=Sr(),r=mc(t),i=rl(s,r);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=fc(t,i,r),e!==null&&(Ro(e,t,r,s),uv(e,t,r))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Sr(),s=mc(t),r=rl(n,s);r.tag=2,e!=null&&(r.callback=e),e=fc(t,r,s),e!==null&&(Ro(e,t,s,n),uv(e,t,s))}};function ZO(t,e,n,s,r,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(s,i,o):e.prototype&&e.prototype.isPureReactComponent?!Qm(n,s)||!Qm(r,i):!0}function RB(t,e,n){var s=!1,r=Ec,i=e.contextType;return typeof i=="object"&&i!==null?i=io(i):(r=qr(e)?od:ar.current,s=e.contextTypes,i=(s=s!=null)?df(t,r):Ec),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Fw,t.stateNode=e,e._reactInternals=t,s&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=r,t.__reactInternalMemoizedMaskedChildContext=i),e}function QO(t,e,n,s){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,s),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,s),e.state!==t&&Fw.enqueueReplaceState(e,e.state,null)}function XT(t,e,n,s){var r=t.stateNode;r.props=n,r.state=t.memoizedState,r.refs={},s_(t);var i=e.contextType;typeof i=="object"&&i!==null?r.context=io(i):(i=qr(e)?od:ar.current,r.context=df(t,i)),r.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(qT(t,e,i,n),r.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(e=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),e!==r.state&&Fw.enqueueReplaceState(r,r.state,null),eb(t,n,r,s),r.state=t.memoizedState),typeof r.componentDidMount=="function"&&(t.flags|=4194308)}function mf(t,e){try{var n="",s=e;do n+=GY(s),s=s.return;while(s);var r=n}catch(i){r=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:r,digest:null}}function Zk(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function YT(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var vQ=typeof WeakMap=="function"?WeakMap:Map;function DB(t,e,n){n=rl(-1,n),n.tag=3,n.payload={element:null};var s=e.value;return n.callback=function(){ib||(ib=!0,oN=s),YT(t,e)},n}function OB(t,e,n){n=rl(-1,n),n.tag=3;var s=t.type.getDerivedStateFromError;if(typeof s=="function"){var r=e.value;n.payload=function(){return s(r)},n.callback=function(){YT(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){YT(t,e),typeof s!="function"&&(pc===null?pc=new Set([this]):pc.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function JO(t,e,n){var s=t.pingCache;if(s===null){s=t.pingCache=new vQ;var r=new Set;s.set(e,r)}else r=s.get(e),r===void 0&&(r=new Set,s.set(e,r));r.has(n)||(r.add(n),t=DQ.bind(null,t,e,n),e.then(t,t))}function eP(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function tP(t,e,n,s,r){return t.mode&1?(t.flags|=65536,t.lanes=r,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=rl(-1,1),e.tag=2,fc(n,e,1))),n.lanes|=1),t)}var bQ=vl.ReactCurrentOwner,Ur=!1;function gr(t,e,n,s){e.child=t===null?cB(e,null,n,s):ff(e,t.child,n,s)}function nP(t,e,n,s,r){n=n.render;var i=e.ref;return Lh(e,r),s=l_(t,e,n,s,i,r),n=c_(),t!==null&&!Ur?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,fl(t,e,r)):(Sn&&n&&YI(e),e.flags|=1,gr(t,e,s,r),e.child)}function sP(t,e,n,s,r){if(t===null){var i=n.type;return typeof i=="function"&&!v_(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,PB(t,e,i,s,r)):(t=gv(n.type,null,s,e,e.mode,r),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&r)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:Qm,n(o,s)&&t.ref===e.ref)return fl(t,e,r)}return e.flags|=1,t=gc(i,s),t.ref=e.ref,t.return=e,e.child=t}function PB(t,e,n,s,r){if(t!==null){var i=t.memoizedProps;if(Qm(i,s)&&t.ref===e.ref)if(Ur=!1,e.pendingProps=s=i,(t.lanes&r)!==0)t.flags&131072&&(Ur=!0);else return e.lanes=t.lanes,fl(t,e,r)}return ZT(t,e,n,s,r)}function FB(t,e,n){var s=e.pendingProps,r=s.children,i=t!==null?t.memoizedState:null;if(s.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},cn(Sh,ui),ui|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,cn(Sh,ui),ui|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=i!==null?i.baseLanes:n,cn(Sh,ui),ui|=s}else i!==null?(s=i.baseLanes|n,e.memoizedState=null):s=n,cn(Sh,ui),ui|=s;return gr(t,e,r,n),e.child}function LB(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function ZT(t,e,n,s,r){var i=qr(n)?od:ar.current;return i=df(e,i),Lh(e,r),n=l_(t,e,n,s,i,r),s=c_(),t!==null&&!Ur?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,fl(t,e,r)):(Sn&&s&&YI(e),e.flags|=1,gr(t,e,n,r),e.child)}function rP(t,e,n,s,r){if(qr(n)){var i=!0;Xv(e)}else i=!1;if(Lh(e,r),e.stateNode===null)fv(t,e),RB(e,n,s),XT(e,n,s,r),s=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,c=n.contextType;typeof c=="object"&&c!==null?c=io(c):(c=qr(n)?od:ar.current,c=df(e,c));var u=n.getDerivedStateFromProps,d=typeof u=="function"||typeof o.getSnapshotBeforeUpdate=="function";d||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==s||l!==c)&&QO(e,o,s,c),Ml=!1;var h=e.memoizedState;o.state=h,eb(e,s,o,r),l=e.memoizedState,a!==s||h!==l||Kr.current||Ml?(typeof u=="function"&&(qT(e,n,u,s),l=e.memoizedState),(a=Ml||ZO(e,n,a,s,h,l,c))?(d||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=s,e.memoizedState=l),o.props=s,o.state=l,o.context=c,s=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),s=!1)}else{o=e.stateNode,dB(t,e),a=e.memoizedProps,c=e.type===e.elementType?a:bo(e.type,a),o.props=c,d=e.pendingProps,h=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=io(l):(l=qr(n)?od:ar.current,l=df(e,l));var f=n.getDerivedStateFromProps;(u=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==d||h!==l)&&QO(e,o,s,l),Ml=!1,h=e.memoizedState,o.state=h,eb(e,s,o,r);var p=e.memoizedState;a!==d||h!==p||Kr.current||Ml?(typeof f=="function"&&(qT(e,n,f,s),p=e.memoizedState),(c=Ml||ZO(e,n,c,s,h,p,l)||!1)?(u||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(s,p,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(s,p,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),e.memoizedProps=s,e.memoizedState=p),o.props=s,o.state=p,o.context=l,s=c):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),s=!1)}return QT(t,e,n,s,i,r)}function QT(t,e,n,s,r,i){LB(t,e);var o=(e.flags&128)!==0;if(!s&&!o)return r&&WO(e,n,!1),fl(t,e,i);s=e.stateNode,bQ.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:s.render();return e.flags|=1,t!==null&&o?(e.child=ff(e,t.child,null,i),e.child=ff(e,null,a,i)):gr(t,e,a,i),e.memoizedState=s.state,r&&WO(e,n,!0),e.child}function MB(t){var e=t.stateNode;e.pendingContext?BO(t,e.pendingContext,e.pendingContext!==e.context):e.context&&BO(t,e.context,!1),r_(t,e.containerInfo)}function iP(t,e,n,s,r){return hf(),QI(r),e.flags|=256,gr(t,e,n,s),e.child}var JT={dehydrated:null,treeContext:null,retryLane:0};function eN(t){return{baseLanes:t,cachePool:null,transitions:null}}function zB(t,e,n){var s=e.pendingProps,r=$n.current,i=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(r&2)!==0),a?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(r|=1),cn($n,r&1),t===null)return GT(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=s.children,t=s.fallback,i?(s=e.mode,i=e.child,o={mode:"hidden",children:o},!(s&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=zw(o,s,0,null),t=Yu(t,s,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=eN(n),e.memoizedState=JT,t):h_(e,o));if(r=t.memoizedState,r!==null&&(a=r.dehydrated,a!==null))return wQ(t,e,o,s,a,r,n);if(i){i=s.fallback,o=e.mode,r=t.child,a=r.sibling;var l={mode:"hidden",children:s.children};return!(o&1)&&e.child!==r?(s=e.child,s.childLanes=0,s.pendingProps=l,e.deletions=null):(s=gc(r,l),s.subtreeFlags=r.subtreeFlags&14680064),a!==null?i=gc(a,i):(i=Yu(i,o,n,null),i.flags|=2),i.return=e,s.return=e,s.sibling=i,e.child=s,s=i,i=e.child,o=t.child.memoizedState,o=o===null?eN(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=JT,s}return i=t.child,t=i.sibling,s=gc(i,{mode:"visible",children:s.children}),!(e.mode&1)&&(s.lanes=n),s.return=e,s.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=s,e.memoizedState=null,s}function h_(t,e){return e=zw({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function px(t,e,n,s){return s!==null&&QI(s),ff(e,t.child,null,n),t=h_(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function wQ(t,e,n,s,r,i,o){if(n)return e.flags&256?(e.flags&=-257,s=Zk(Error(we(422))),px(t,e,o,s)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=s.fallback,r=e.mode,s=zw({mode:"visible",children:s.children},r,0,null),i=Yu(i,r,o,null),i.flags|=2,s.return=e,i.return=e,s.sibling=i,e.child=s,e.mode&1&&ff(e,t.child,null,o),e.child.memoizedState=eN(o),e.memoizedState=JT,i);if(!(e.mode&1))return px(t,e,o,null);if(r.data==="$!"){if(s=r.nextSibling&&r.nextSibling.dataset,s)var a=s.dgst;return s=a,i=Error(we(419)),s=Zk(i,s,void 0),px(t,e,o,s)}if(a=(o&t.childLanes)!==0,Ur||a){if(s=Fs,s!==null){switch(o&-o){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}r=r&(s.suspendedLanes|o)?0:r,r!==0&&r!==i.retryLane&&(i.retryLane=r,hl(t,r),Ro(s,t,r,-1))}return x_(),s=Zk(Error(we(421))),px(t,e,o,s)}return r.data==="$?"?(e.flags|=128,e.child=t.child,e=OQ.bind(null,t),r._reactRetry=e,null):(t=i.treeContext,mi=hc(r.nextSibling),xi=e,Sn=!0,Co=null,t!==null&&(Gi[Ki++]=tl,Gi[Ki++]=nl,Gi[Ki++]=ad,tl=t.id,nl=t.overflow,ad=e),e=h_(e,s.children),e.flags|=4096,e)}function oP(t,e,n){t.lanes|=e;var s=t.alternate;s!==null&&(s.lanes|=e),KT(t.return,e,n)}function Qk(t,e,n,s,r){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:s,tail:n,tailMode:r}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=s,i.tail=n,i.tailMode=r)}function VB(t,e,n){var s=e.pendingProps,r=s.revealOrder,i=s.tail;if(gr(t,e,s.children,n),s=$n.current,s&2)s=s&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&oP(t,n,e);else if(t.tag===19)oP(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}s&=1}if(cn($n,s),!(e.mode&1))e.memoizedState=null;else switch(r){case"forwards":for(n=e.child,r=null;n!==null;)t=n.alternate,t!==null&&tb(t)===null&&(r=n),n=n.sibling;n=r,n===null?(r=e.child,e.child=null):(r=n.sibling,n.sibling=null),Qk(e,!1,r,n,i);break;case"backwards":for(n=null,r=e.child,e.child=null;r!==null;){if(t=r.alternate,t!==null&&tb(t)===null){e.child=r;break}t=r.sibling,r.sibling=n,n=r,r=t}Qk(e,!0,n,null,i);break;case"together":Qk(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function fv(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function fl(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),cd|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(we(153));if(e.child!==null){for(t=e.child,n=gc(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=gc(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function SQ(t,e,n){switch(e.tag){case 3:MB(e),hf();break;case 5:hB(e);break;case 1:qr(e.type)&&Xv(e);break;case 4:r_(e,e.stateNode.containerInfo);break;case 10:var s=e.type._context,r=e.memoizedProps.value;cn(Qv,s._currentValue),s._currentValue=r;break;case 13:if(s=e.memoizedState,s!==null)return s.dehydrated!==null?(cn($n,$n.current&1),e.flags|=128,null):n&e.child.childLanes?zB(t,e,n):(cn($n,$n.current&1),t=fl(t,e,n),t!==null?t.sibling:null);cn($n,$n.current&1);break;case 19:if(s=(n&e.childLanes)!==0,t.flags&128){if(s)return VB(t,e,n);e.flags|=128}if(r=e.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),cn($n,$n.current),s)break;return null;case 22:case 23:return e.lanes=0,FB(t,e,n)}return fl(t,e,n)}var jB,tN,BB,WB;jB=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};tN=function(){};BB=function(t,e,n,s){var r=t.memoizedProps;if(r!==s){t=e.stateNode,Du(ma.current);var i=null;switch(n){case"input":r=kT(t,r),s=kT(t,s),i=[];break;case"select":r=Ln({},r,{value:void 0}),s=Ln({},s,{value:void 0}),i=[];break;case"textarea":r=NT(t,r),s=NT(t,s),i=[];break;default:typeof r.onClick!="function"&&typeof s.onClick=="function"&&(t.onclick=Kv)}_T(n,s);var o;n=null;for(c in r)if(!s.hasOwnProperty(c)&&r.hasOwnProperty(c)&&r[c]!=null)if(c==="style"){var a=r[c];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Hm.hasOwnProperty(c)?i||(i=[]):(i=i||[]).push(c,null));for(c in s){var l=s[c];if(a=r!=null?r[c]:void 0,s.hasOwnProperty(c)&&l!==a&&(l!=null||a!=null))if(c==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(i||(i=[]),i.push(c,n)),n=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(i=i||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(i=i||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Hm.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&gn("scroll",t),i||a===l||(i=[])):(i=i||[]).push(c,l))}n&&(i=i||[]).push("style",n);var c=i;(e.updateQueue=c)&&(e.flags|=4)}};WB=function(t,e,n,s){n!==s&&(e.flags|=4)};function Op(t,e){if(!Sn)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var s=null;n!==null;)n.alternate!==null&&(s=n),n=n.sibling;s===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:s.sibling=null}}function Js(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,s=0;if(e)for(var r=t.child;r!==null;)n|=r.lanes|r.childLanes,s|=r.subtreeFlags&14680064,s|=r.flags&14680064,r.return=t,r=r.sibling;else for(r=t.child;r!==null;)n|=r.lanes|r.childLanes,s|=r.subtreeFlags,s|=r.flags,r.return=t,r=r.sibling;return t.subtreeFlags|=s,t.childLanes=n,e}function kQ(t,e,n){var s=e.pendingProps;switch(ZI(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Js(e),null;case 1:return qr(e.type)&&qv(),Js(e),null;case 3:return s=e.stateNode,pf(),yn(Kr),yn(ar),o_(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(t===null||t.child===null)&&(hx(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Co!==null&&(cN(Co),Co=null))),tN(t,e),Js(e),null;case 5:i_(e);var r=Du(sg.current);if(n=e.type,t!==null&&e.stateNode!=null)BB(t,e,n,s,r),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!s){if(e.stateNode===null)throw Error(we(166));return Js(e),null}if(t=Du(ma.current),hx(e)){s=e.stateNode,n=e.type;var i=e.memoizedProps;switch(s[oa]=e,s[tg]=i,t=(e.mode&1)!==0,n){case"dialog":gn("cancel",s),gn("close",s);break;case"iframe":case"object":case"embed":gn("load",s);break;case"video":case"audio":for(r=0;r<tm.length;r++)gn(tm[r],s);break;case"source":gn("error",s);break;case"img":case"image":case"link":gn("error",s),gn("load",s);break;case"details":gn("toggle",s);break;case"input":mO(s,i),gn("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!i.multiple},gn("invalid",s);break;case"textarea":yO(s,i),gn("invalid",s)}_T(n,i),r=null;for(var o in i)if(i.hasOwnProperty(o)){var a=i[o];o==="children"?typeof a=="string"?s.textContent!==a&&(i.suppressHydrationWarning!==!0&&dx(s.textContent,a,t),r=["children",a]):typeof a=="number"&&s.textContent!==""+a&&(i.suppressHydrationWarning!==!0&&dx(s.textContent,a,t),r=["children",""+a]):Hm.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&gn("scroll",s)}switch(n){case"input":sx(s),gO(s,i,!0);break;case"textarea":sx(s),xO(s);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(s.onclick=Kv)}s=r,e.updateQueue=s,s!==null&&(e.flags|=4)}else{o=r.nodeType===9?r:r.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=yj(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof s.is=="string"?t=o.createElement(n,{is:s.is}):(t=o.createElement(n),n==="select"&&(o=t,s.multiple?o.multiple=!0:s.size&&(o.size=s.size))):t=o.createElementNS(t,n),t[oa]=e,t[tg]=s,jB(t,e,!1,!1),e.stateNode=t;e:{switch(o=ET(n,s),n){case"dialog":gn("cancel",t),gn("close",t),r=s;break;case"iframe":case"object":case"embed":gn("load",t),r=s;break;case"video":case"audio":for(r=0;r<tm.length;r++)gn(tm[r],t);r=s;break;case"source":gn("error",t),r=s;break;case"img":case"image":case"link":gn("error",t),gn("load",t),r=s;break;case"details":gn("toggle",t),r=s;break;case"input":mO(t,s),r=kT(t,s),gn("invalid",t);break;case"option":r=s;break;case"select":t._wrapperState={wasMultiple:!!s.multiple},r=Ln({},s,{value:void 0}),gn("invalid",t);break;case"textarea":yO(t,s),r=NT(t,s),gn("invalid",t);break;default:r=s}_T(n,r),a=r;for(i in a)if(a.hasOwnProperty(i)){var l=a[i];i==="style"?bj(t,l):i==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&xj(t,l)):i==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&Gm(t,l):typeof l=="number"&&Gm(t,""+l):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Hm.hasOwnProperty(i)?l!=null&&i==="onScroll"&&gn("scroll",t):l!=null&&FI(t,i,l,o))}switch(n){case"input":sx(t),gO(t,s,!1);break;case"textarea":sx(t),xO(t);break;case"option":s.value!=null&&t.setAttribute("value",""+_c(s.value));break;case"select":t.multiple=!!s.multiple,i=s.value,i!=null?Dh(t,!!s.multiple,i,!1):s.defaultValue!=null&&Dh(t,!!s.multiple,s.defaultValue,!0);break;default:typeof r.onClick=="function"&&(t.onclick=Kv)}switch(n){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}}s&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Js(e),null;case 6:if(t&&e.stateNode!=null)WB(t,e,t.memoizedProps,s);else{if(typeof s!="string"&&e.stateNode===null)throw Error(we(166));if(n=Du(sg.current),Du(ma.current),hx(e)){if(s=e.stateNode,n=e.memoizedProps,s[oa]=e,(i=s.nodeValue!==n)&&(t=xi,t!==null))switch(t.tag){case 3:dx(s.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&dx(s.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else s=(n.nodeType===9?n:n.ownerDocument).createTextNode(s),s[oa]=e,e.stateNode=s}return Js(e),null;case 13:if(yn($n),s=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Sn&&mi!==null&&e.mode&1&&!(e.flags&128))aB(),hf(),e.flags|=98560,i=!1;else if(i=hx(e),s!==null&&s.dehydrated!==null){if(t===null){if(!i)throw Error(we(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(we(317));i[oa]=e}else hf(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Js(e),i=!1}else Co!==null&&(cN(Co),Co=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(s=s!==null,s!==(t!==null&&t.memoizedState!==null)&&s&&(e.child.flags|=8192,e.mode&1&&(t===null||$n.current&1?bs===0&&(bs=3):x_())),e.updateQueue!==null&&(e.flags|=4),Js(e),null);case 4:return pf(),tN(t,e),t===null&&Jm(e.stateNode.containerInfo),Js(e),null;case 10:return t_(e.type._context),Js(e),null;case 17:return qr(e.type)&&qv(),Js(e),null;case 19:if(yn($n),i=e.memoizedState,i===null)return Js(e),null;if(s=(e.flags&128)!==0,o=i.rendering,o===null)if(s)Op(i,!1);else{if(bs!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=tb(t),o!==null){for(e.flags|=128,Op(i,!1),s=o.updateQueue,s!==null&&(e.updateQueue=s,e.flags|=4),e.subtreeFlags=0,s=n,n=e.child;n!==null;)i=n,t=s,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return cn($n,$n.current&1|2),e.child}t=t.sibling}i.tail!==null&&Yn()>gf&&(e.flags|=128,s=!0,Op(i,!1),e.lanes=4194304)}else{if(!s)if(t=tb(o),t!==null){if(e.flags|=128,s=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Op(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!Sn)return Js(e),null}else 2*Yn()-i.renderingStartTime>gf&&n!==1073741824&&(e.flags|=128,s=!0,Op(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Yn(),e.sibling=null,n=$n.current,cn($n,s?n&1|2:n&1),e):(Js(e),null);case 22:case 23:return y_(),s=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==s&&(e.flags|=8192),s&&e.mode&1?ui&1073741824&&(Js(e),e.subtreeFlags&6&&(e.flags|=8192)):Js(e),null;case 24:return null;case 25:return null}throw Error(we(156,e.tag))}function CQ(t,e){switch(ZI(e),e.tag){case 1:return qr(e.type)&&qv(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return pf(),yn(Kr),yn(ar),o_(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return i_(e),null;case 13:if(yn($n),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(we(340));hf()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return yn($n),null;case 4:return pf(),null;case 10:return t_(e.type._context),null;case 22:case 23:return y_(),null;case 24:return null;default:return null}}var mx=!1,nr=!1,TQ=typeof WeakSet=="function"?WeakSet:Set,ze=null;function wh(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(s){Bn(t,e,s)}else n.current=null}function nN(t,e,n){try{n()}catch(s){Bn(t,e,s)}}var aP=!1;function NQ(t,e){if(zT=Uv,t=qj(),XI(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var s=n.getSelection&&n.getSelection();if(s&&s.rangeCount!==0){n=s.anchorNode;var r=s.anchorOffset,i=s.focusNode;s=s.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,c=0,u=0,d=t,h=null;t:for(;;){for(var f;d!==n||r!==0&&d.nodeType!==3||(a=o+r),d!==i||s!==0&&d.nodeType!==3||(l=o+s),d.nodeType===3&&(o+=d.nodeValue.length),(f=d.firstChild)!==null;)h=d,d=f;for(;;){if(d===t)break t;if(h===n&&++c===r&&(a=o),h===i&&++u===s&&(l=o),(f=d.nextSibling)!==null)break;d=h,h=d.parentNode}d=f}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(VT={focusedElem:t,selectionRange:n},Uv=!1,ze=e;ze!==null;)if(e=ze,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,ze=t;else for(;ze!==null;){e=ze;try{var p=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var m=p.memoizedProps,g=p.memoizedState,y=e.stateNode,x=y.getSnapshotBeforeUpdate(e.elementType===e.type?m:bo(e.type,m),g);y.__reactInternalSnapshotBeforeUpdate=x}break;case 3:var v=e.stateNode.containerInfo;v.nodeType===1?v.textContent="":v.nodeType===9&&v.documentElement&&v.removeChild(v.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(we(163))}}catch(b){Bn(e,e.return,b)}if(t=e.sibling,t!==null){t.return=e.return,ze=t;break}ze=e.return}return p=aP,aP=!1,p}function Em(t,e,n){var s=e.updateQueue;if(s=s!==null?s.lastEffect:null,s!==null){var r=s=s.next;do{if((r.tag&t)===t){var i=r.destroy;r.destroy=void 0,i!==void 0&&nN(e,n,i)}r=r.next}while(r!==s)}}function Lw(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var s=n.create;n.destroy=s()}n=n.next}while(n!==e)}}function sN(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function UB(t){var e=t.alternate;e!==null&&(t.alternate=null,UB(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[oa],delete e[tg],delete e[WT],delete e[lQ],delete e[cQ])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function HB(t){return t.tag===5||t.tag===3||t.tag===4}function lP(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||HB(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function rN(t,e,n){var s=t.tag;if(s===5||s===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Kv));else if(s!==4&&(t=t.child,t!==null))for(rN(t,e,n),t=t.sibling;t!==null;)rN(t,e,n),t=t.sibling}function iN(t,e,n){var s=t.tag;if(s===5||s===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(s!==4&&(t=t.child,t!==null))for(iN(t,e,n),t=t.sibling;t!==null;)iN(t,e,n),t=t.sibling}var Us=null,ko=!1;function $l(t,e,n){for(n=n.child;n!==null;)GB(t,e,n),n=n.sibling}function GB(t,e,n){if(pa&&typeof pa.onCommitFiberUnmount=="function")try{pa.onCommitFiberUnmount(Ew,n)}catch{}switch(n.tag){case 5:nr||wh(n,e);case 6:var s=Us,r=ko;Us=null,$l(t,e,n),Us=s,ko=r,Us!==null&&(ko?(t=Us,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Us.removeChild(n.stateNode));break;case 18:Us!==null&&(ko?(t=Us,n=n.stateNode,t.nodeType===8?Hk(t.parentNode,n):t.nodeType===1&&Hk(t,n),Ym(t)):Hk(Us,n.stateNode));break;case 4:s=Us,r=ko,Us=n.stateNode.containerInfo,ko=!0,$l(t,e,n),Us=s,ko=r;break;case 0:case 11:case 14:case 15:if(!nr&&(s=n.updateQueue,s!==null&&(s=s.lastEffect,s!==null))){r=s=s.next;do{var i=r,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&nN(n,e,o),r=r.next}while(r!==s)}$l(t,e,n);break;case 1:if(!nr&&(wh(n,e),s=n.stateNode,typeof s.componentWillUnmount=="function"))try{s.props=n.memoizedProps,s.state=n.memoizedState,s.componentWillUnmount()}catch(a){Bn(n,e,a)}$l(t,e,n);break;case 21:$l(t,e,n);break;case 22:n.mode&1?(nr=(s=nr)||n.memoizedState!==null,$l(t,e,n),nr=s):$l(t,e,n);break;default:$l(t,e,n)}}function cP(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new TQ),e.forEach(function(s){var r=PQ.bind(null,t,s);n.has(s)||(n.add(s),s.then(r,r))})}}function go(t,e){var n=e.deletions;if(n!==null)for(var s=0;s<n.length;s++){var r=n[s];try{var i=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:Us=a.stateNode,ko=!1;break e;case 3:Us=a.stateNode.containerInfo,ko=!0;break e;case 4:Us=a.stateNode.containerInfo,ko=!0;break e}a=a.return}if(Us===null)throw Error(we(160));GB(i,o,r),Us=null,ko=!1;var l=r.alternate;l!==null&&(l.return=null),r.return=null}catch(c){Bn(r,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)KB(e,t),e=e.sibling}function KB(t,e){var n=t.alternate,s=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(go(e,t),qo(t),s&4){try{Em(3,t,t.return),Lw(3,t)}catch(m){Bn(t,t.return,m)}try{Em(5,t,t.return)}catch(m){Bn(t,t.return,m)}}break;case 1:go(e,t),qo(t),s&512&&n!==null&&wh(n,n.return);break;case 5:if(go(e,t),qo(t),s&512&&n!==null&&wh(n,n.return),t.flags&32){var r=t.stateNode;try{Gm(r,"")}catch(m){Bn(t,t.return,m)}}if(s&4&&(r=t.stateNode,r!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&i.type==="radio"&&i.name!=null&&mj(r,i),ET(a,o);var c=ET(a,i);for(o=0;o<l.length;o+=2){var u=l[o],d=l[o+1];u==="style"?bj(r,d):u==="dangerouslySetInnerHTML"?xj(r,d):u==="children"?Gm(r,d):FI(r,u,d,c)}switch(a){case"input":CT(r,i);break;case"textarea":gj(r,i);break;case"select":var h=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!i.multiple;var f=i.value;f!=null?Dh(r,!!i.multiple,f,!1):h!==!!i.multiple&&(i.defaultValue!=null?Dh(r,!!i.multiple,i.defaultValue,!0):Dh(r,!!i.multiple,i.multiple?[]:"",!1))}r[tg]=i}catch(m){Bn(t,t.return,m)}}break;case 6:if(go(e,t),qo(t),s&4){if(t.stateNode===null)throw Error(we(162));r=t.stateNode,i=t.memoizedProps;try{r.nodeValue=i}catch(m){Bn(t,t.return,m)}}break;case 3:if(go(e,t),qo(t),s&4&&n!==null&&n.memoizedState.isDehydrated)try{Ym(e.containerInfo)}catch(m){Bn(t,t.return,m)}break;case 4:go(e,t),qo(t);break;case 13:go(e,t),qo(t),r=t.child,r.flags&8192&&(i=r.memoizedState!==null,r.stateNode.isHidden=i,!i||r.alternate!==null&&r.alternate.memoizedState!==null||(m_=Yn())),s&4&&cP(t);break;case 22:if(u=n!==null&&n.memoizedState!==null,t.mode&1?(nr=(c=nr)||u,go(e,t),nr=c):go(e,t),qo(t),s&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!u&&t.mode&1)for(ze=t,u=t.child;u!==null;){for(d=ze=u;ze!==null;){switch(h=ze,f=h.child,h.tag){case 0:case 11:case 14:case 15:Em(4,h,h.return);break;case 1:wh(h,h.return);var p=h.stateNode;if(typeof p.componentWillUnmount=="function"){s=h,n=h.return;try{e=s,p.props=e.memoizedProps,p.state=e.memoizedState,p.componentWillUnmount()}catch(m){Bn(s,n,m)}}break;case 5:wh(h,h.return);break;case 22:if(h.memoizedState!==null){dP(d);continue}}f!==null?(f.return=h,ze=f):dP(d)}u=u.sibling}e:for(u=null,d=t;;){if(d.tag===5){if(u===null){u=d;try{r=d.stateNode,c?(i=r.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(a=d.stateNode,l=d.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=vj("display",o))}catch(m){Bn(t,t.return,m)}}}else if(d.tag===6){if(u===null)try{d.stateNode.nodeValue=c?"":d.memoizedProps}catch(m){Bn(t,t.return,m)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===t)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===t)break e;for(;d.sibling===null;){if(d.return===null||d.return===t)break e;u===d&&(u=null),d=d.return}u===d&&(u=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:go(e,t),qo(t),s&4&&cP(t);break;case 21:break;default:go(e,t),qo(t)}}function qo(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(HB(n)){var s=n;break e}n=n.return}throw Error(we(160))}switch(s.tag){case 5:var r=s.stateNode;s.flags&32&&(Gm(r,""),s.flags&=-33);var i=lP(t);iN(t,i,r);break;case 3:case 4:var o=s.stateNode.containerInfo,a=lP(t);rN(t,a,o);break;default:throw Error(we(161))}}catch(l){Bn(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function IQ(t,e,n){ze=t,qB(t)}function qB(t,e,n){for(var s=(t.mode&1)!==0;ze!==null;){var r=ze,i=r.child;if(r.tag===22&&s){var o=r.memoizedState!==null||mx;if(!o){var a=r.alternate,l=a!==null&&a.memoizedState!==null||nr;a=mx;var c=nr;if(mx=o,(nr=l)&&!c)for(ze=r;ze!==null;)o=ze,l=o.child,o.tag===22&&o.memoizedState!==null?hP(r):l!==null?(l.return=o,ze=l):hP(r);for(;i!==null;)ze=i,qB(i),i=i.sibling;ze=r,mx=a,nr=c}uP(t)}else r.subtreeFlags&8772&&i!==null?(i.return=r,ze=i):uP(t)}}function uP(t){for(;ze!==null;){var e=ze;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:nr||Lw(5,e);break;case 1:var s=e.stateNode;if(e.flags&4&&!nr)if(n===null)s.componentDidMount();else{var r=e.elementType===e.type?n.memoizedProps:bo(e.type,n.memoizedProps);s.componentDidUpdate(r,n.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&qO(e,i,s);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}qO(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var d=u.dehydrated;d!==null&&Ym(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(we(163))}nr||e.flags&512&&sN(e)}catch(h){Bn(e,e.return,h)}}if(e===t){ze=null;break}if(n=e.sibling,n!==null){n.return=e.return,ze=n;break}ze=e.return}}function dP(t){for(;ze!==null;){var e=ze;if(e===t){ze=null;break}var n=e.sibling;if(n!==null){n.return=e.return,ze=n;break}ze=e.return}}function hP(t){for(;ze!==null;){var e=ze;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Lw(4,e)}catch(l){Bn(e,n,l)}break;case 1:var s=e.stateNode;if(typeof s.componentDidMount=="function"){var r=e.return;try{s.componentDidMount()}catch(l){Bn(e,r,l)}}var i=e.return;try{sN(e)}catch(l){Bn(e,i,l)}break;case 5:var o=e.return;try{sN(e)}catch(l){Bn(e,o,l)}}}catch(l){Bn(e,e.return,l)}if(e===t){ze=null;break}var a=e.sibling;if(a!==null){a.return=e.return,ze=a;break}ze=e.return}}var _Q=Math.ceil,rb=vl.ReactCurrentDispatcher,f_=vl.ReactCurrentOwner,no=vl.ReactCurrentBatchConfig,Pt=0,Fs=null,ls=null,Ks=0,ui=0,Sh=Xc(0),bs=0,ag=null,cd=0,Mw=0,p_=0,$m=null,Vr=null,m_=0,gf=1/0,Ha=null,ib=!1,oN=null,pc=null,gx=!1,ec=null,ob=0,Am=0,aN=null,pv=-1,mv=0;function Sr(){return Pt&6?Yn():pv!==-1?pv:pv=Yn()}function mc(t){return t.mode&1?Pt&2&&Ks!==0?Ks&-Ks:dQ.transition!==null?(mv===0&&(mv=Rj()),mv):(t=qt,t!==0||(t=window.event,t=t===void 0?16:zj(t.type)),t):1}function Ro(t,e,n,s){if(50<Am)throw Am=0,aN=null,Error(we(185));Qg(t,n,s),(!(Pt&2)||t!==Fs)&&(t===Fs&&(!(Pt&2)&&(Mw|=n),bs===4&&Bl(t,Ks)),Xr(t,s),n===1&&Pt===0&&!(e.mode&1)&&(gf=Yn()+500,Ow&&Yc()))}function Xr(t,e){var n=t.callbackNode;dZ(t,e);var s=Wv(t,t===Fs?Ks:0);if(s===0)n!==null&&wO(n),t.callbackNode=null,t.callbackPriority=0;else if(e=s&-s,t.callbackPriority!==e){if(n!=null&&wO(n),e===1)t.tag===0?uQ(fP.bind(null,t)):rB(fP.bind(null,t)),oQ(function(){!(Pt&6)&&Yc()}),n=null;else{switch(Dj(s)){case 1:n=jI;break;case 4:n=$j;break;case 16:n=Bv;break;case 536870912:n=Aj;break;default:n=Bv}n=n4(n,XB.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function XB(t,e){if(pv=-1,mv=0,Pt&6)throw Error(we(327));var n=t.callbackNode;if(Mh()&&t.callbackNode!==n)return null;var s=Wv(t,t===Fs?Ks:0);if(s===0)return null;if(s&30||s&t.expiredLanes||e)e=ab(t,s);else{e=s;var r=Pt;Pt|=2;var i=ZB();(Fs!==t||Ks!==e)&&(Ha=null,gf=Yn()+500,Xu(t,e));do try{AQ();break}catch(a){YB(t,a)}while(1);e_(),rb.current=i,Pt=r,ls!==null?e=0:(Fs=null,Ks=0,e=bs)}if(e!==0){if(e===2&&(r=OT(t),r!==0&&(s=r,e=lN(t,r))),e===1)throw n=ag,Xu(t,0),Bl(t,s),Xr(t,Yn()),n;if(e===6)Bl(t,s);else{if(r=t.current.alternate,!(s&30)&&!EQ(r)&&(e=ab(t,s),e===2&&(i=OT(t),i!==0&&(s=i,e=lN(t,i))),e===1))throw n=ag,Xu(t,0),Bl(t,s),Xr(t,Yn()),n;switch(t.finishedWork=r,t.finishedLanes=s,e){case 0:case 1:throw Error(we(345));case 2:ku(t,Vr,Ha);break;case 3:if(Bl(t,s),(s&130023424)===s&&(e=m_+500-Yn(),10<e)){if(Wv(t,0)!==0)break;if(r=t.suspendedLanes,(r&s)!==s){Sr(),t.pingedLanes|=t.suspendedLanes&r;break}t.timeoutHandle=BT(ku.bind(null,t,Vr,Ha),e);break}ku(t,Vr,Ha);break;case 4:if(Bl(t,s),(s&4194240)===s)break;for(e=t.eventTimes,r=-1;0<s;){var o=31-Ao(s);i=1<<o,o=e[o],o>r&&(r=o),s&=~i}if(s=r,s=Yn()-s,s=(120>s?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*_Q(s/1960))-s,10<s){t.timeoutHandle=BT(ku.bind(null,t,Vr,Ha),s);break}ku(t,Vr,Ha);break;case 5:ku(t,Vr,Ha);break;default:throw Error(we(329))}}}return Xr(t,Yn()),t.callbackNode===n?XB.bind(null,t):null}function lN(t,e){var n=$m;return t.current.memoizedState.isDehydrated&&(Xu(t,e).flags|=256),t=ab(t,e),t!==2&&(e=Vr,Vr=n,e!==null&&cN(e)),t}function cN(t){Vr===null?Vr=t:Vr.push.apply(Vr,t)}function EQ(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var s=0;s<n.length;s++){var r=n[s],i=r.getSnapshot;r=r.value;try{if(!Oo(i(),r))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Bl(t,e){for(e&=~p_,e&=~Mw,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Ao(e),s=1<<n;t[n]=-1,e&=~s}}function fP(t){if(Pt&6)throw Error(we(327));Mh();var e=Wv(t,0);if(!(e&1))return Xr(t,Yn()),null;var n=ab(t,e);if(t.tag!==0&&n===2){var s=OT(t);s!==0&&(e=s,n=lN(t,s))}if(n===1)throw n=ag,Xu(t,0),Bl(t,e),Xr(t,Yn()),n;if(n===6)throw Error(we(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,ku(t,Vr,Ha),Xr(t,Yn()),null}function g_(t,e){var n=Pt;Pt|=1;try{return t(e)}finally{Pt=n,Pt===0&&(gf=Yn()+500,Ow&&Yc())}}function ud(t){ec!==null&&ec.tag===0&&!(Pt&6)&&Mh();var e=Pt;Pt|=1;var n=no.transition,s=qt;try{if(no.transition=null,qt=1,t)return t()}finally{qt=s,no.transition=n,Pt=e,!(Pt&6)&&Yc()}}function y_(){ui=Sh.current,yn(Sh)}function Xu(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,iQ(n)),ls!==null)for(n=ls.return;n!==null;){var s=n;switch(ZI(s),s.tag){case 1:s=s.type.childContextTypes,s!=null&&qv();break;case 3:pf(),yn(Kr),yn(ar),o_();break;case 5:i_(s);break;case 4:pf();break;case 13:yn($n);break;case 19:yn($n);break;case 10:t_(s.type._context);break;case 22:case 23:y_()}n=n.return}if(Fs=t,ls=t=gc(t.current,null),Ks=ui=e,bs=0,ag=null,p_=Mw=cd=0,Vr=$m=null,Ru!==null){for(e=0;e<Ru.length;e++)if(n=Ru[e],s=n.interleaved,s!==null){n.interleaved=null;var r=s.next,i=n.pending;if(i!==null){var o=i.next;i.next=r,s.next=o}n.pending=s}Ru=null}return t}function YB(t,e){do{var n=ls;try{if(e_(),dv.current=sb,nb){for(var s=Fn.memoizedState;s!==null;){var r=s.queue;r!==null&&(r.pending=null),s=s.next}nb=!1}if(ld=0,Rs=ys=Fn=null,_m=!1,rg=0,f_.current=null,n===null||n.return===null){bs=1,ag=e,ls=null;break}e:{var i=t,o=n.return,a=n,l=e;if(e=Ks,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=a,d=u.tag;if(!(u.mode&1)&&(d===0||d===11||d===15)){var h=u.alternate;h?(u.updateQueue=h.updateQueue,u.memoizedState=h.memoizedState,u.lanes=h.lanes):(u.updateQueue=null,u.memoizedState=null)}var f=eP(o);if(f!==null){f.flags&=-257,tP(f,o,a,i,e),f.mode&1&&JO(i,c,e),e=f,l=c;var p=e.updateQueue;if(p===null){var m=new Set;m.add(l),e.updateQueue=m}else p.add(l);break e}else{if(!(e&1)){JO(i,c,e),x_();break e}l=Error(we(426))}}else if(Sn&&a.mode&1){var g=eP(o);if(g!==null){!(g.flags&65536)&&(g.flags|=256),tP(g,o,a,i,e),QI(mf(l,a));break e}}i=l=mf(l,a),bs!==4&&(bs=2),$m===null?$m=[i]:$m.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var y=DB(i,l,e);KO(i,y);break e;case 1:a=l;var x=i.type,v=i.stateNode;if(!(i.flags&128)&&(typeof x.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(pc===null||!pc.has(v)))){i.flags|=65536,e&=-e,i.lanes|=e;var b=OB(i,a,e);KO(i,b);break e}}i=i.return}while(i!==null)}JB(n)}catch(k){e=k,ls===n&&n!==null&&(ls=n=n.return);continue}break}while(1)}function ZB(){var t=rb.current;return rb.current=sb,t===null?sb:t}function x_(){(bs===0||bs===3||bs===2)&&(bs=4),Fs===null||!(cd&268435455)&&!(Mw&268435455)||Bl(Fs,Ks)}function ab(t,e){var n=Pt;Pt|=2;var s=ZB();(Fs!==t||Ks!==e)&&(Ha=null,Xu(t,e));do try{$Q();break}catch(r){YB(t,r)}while(1);if(e_(),Pt=n,rb.current=s,ls!==null)throw Error(we(261));return Fs=null,Ks=0,bs}function $Q(){for(;ls!==null;)QB(ls)}function AQ(){for(;ls!==null&&!nZ();)QB(ls)}function QB(t){var e=t4(t.alternate,t,ui);t.memoizedProps=t.pendingProps,e===null?JB(t):ls=e,f_.current=null}function JB(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=CQ(n,e),n!==null){n.flags&=32767,ls=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{bs=6,ls=null;return}}else if(n=kQ(n,e,ui),n!==null){ls=n;return}if(e=e.sibling,e!==null){ls=e;return}ls=e=t}while(e!==null);bs===0&&(bs=5)}function ku(t,e,n){var s=qt,r=no.transition;try{no.transition=null,qt=1,RQ(t,e,n,s)}finally{no.transition=r,qt=s}return null}function RQ(t,e,n,s){do Mh();while(ec!==null);if(Pt&6)throw Error(we(327));n=t.finishedWork;var r=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(we(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(hZ(t,i),t===Fs&&(ls=Fs=null,Ks=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||gx||(gx=!0,n4(Bv,function(){return Mh(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=no.transition,no.transition=null;var o=qt;qt=1;var a=Pt;Pt|=4,f_.current=null,NQ(t,n),KB(n,t),QZ(VT),Uv=!!zT,VT=zT=null,t.current=n,IQ(n),sZ(),Pt=a,qt=o,no.transition=i}else t.current=n;if(gx&&(gx=!1,ec=t,ob=r),i=t.pendingLanes,i===0&&(pc=null),oZ(n.stateNode),Xr(t,Yn()),e!==null)for(s=t.onRecoverableError,n=0;n<e.length;n++)r=e[n],s(r.value,{componentStack:r.stack,digest:r.digest});if(ib)throw ib=!1,t=oN,oN=null,t;return ob&1&&t.tag!==0&&Mh(),i=t.pendingLanes,i&1?t===aN?Am++:(Am=0,aN=t):Am=0,Yc(),null}function Mh(){if(ec!==null){var t=Dj(ob),e=no.transition,n=qt;try{if(no.transition=null,qt=16>t?16:t,ec===null)var s=!1;else{if(t=ec,ec=null,ob=0,Pt&6)throw Error(we(331));var r=Pt;for(Pt|=4,ze=t.current;ze!==null;){var i=ze,o=i.child;if(ze.flags&16){var a=i.deletions;if(a!==null){for(var l=0;l<a.length;l++){var c=a[l];for(ze=c;ze!==null;){var u=ze;switch(u.tag){case 0:case 11:case 15:Em(8,u,i)}var d=u.child;if(d!==null)d.return=u,ze=d;else for(;ze!==null;){u=ze;var h=u.sibling,f=u.return;if(UB(u),u===c){ze=null;break}if(h!==null){h.return=f,ze=h;break}ze=f}}}var p=i.alternate;if(p!==null){var m=p.child;if(m!==null){p.child=null;do{var g=m.sibling;m.sibling=null,m=g}while(m!==null)}}ze=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,ze=o;else e:for(;ze!==null;){if(i=ze,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Em(9,i,i.return)}var y=i.sibling;if(y!==null){y.return=i.return,ze=y;break e}ze=i.return}}var x=t.current;for(ze=x;ze!==null;){o=ze;var v=o.child;if(o.subtreeFlags&2064&&v!==null)v.return=o,ze=v;else e:for(o=x;ze!==null;){if(a=ze,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Lw(9,a)}}catch(k){Bn(a,a.return,k)}if(a===o){ze=null;break e}var b=a.sibling;if(b!==null){b.return=a.return,ze=b;break e}ze=a.return}}if(Pt=r,Yc(),pa&&typeof pa.onPostCommitFiberRoot=="function")try{pa.onPostCommitFiberRoot(Ew,t)}catch{}s=!0}return s}finally{qt=n,no.transition=e}}return!1}function pP(t,e,n){e=mf(n,e),e=DB(t,e,1),t=fc(t,e,1),e=Sr(),t!==null&&(Qg(t,1,e),Xr(t,e))}function Bn(t,e,n){if(t.tag===3)pP(t,t,n);else for(;e!==null;){if(e.tag===3){pP(e,t,n);break}else if(e.tag===1){var s=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(pc===null||!pc.has(s))){t=mf(n,t),t=OB(e,t,1),e=fc(e,t,1),t=Sr(),e!==null&&(Qg(e,1,t),Xr(e,t));break}}e=e.return}}function DQ(t,e,n){var s=t.pingCache;s!==null&&s.delete(e),e=Sr(),t.pingedLanes|=t.suspendedLanes&n,Fs===t&&(Ks&n)===n&&(bs===4||bs===3&&(Ks&130023424)===Ks&&500>Yn()-m_?Xu(t,0):p_|=n),Xr(t,e)}function e4(t,e){e===0&&(t.mode&1?(e=ox,ox<<=1,!(ox&130023424)&&(ox=4194304)):e=1);var n=Sr();t=hl(t,e),t!==null&&(Qg(t,e,n),Xr(t,n))}function OQ(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),e4(t,n)}function PQ(t,e){var n=0;switch(t.tag){case 13:var s=t.stateNode,r=t.memoizedState;r!==null&&(n=r.retryLane);break;case 19:s=t.stateNode;break;default:throw Error(we(314))}s!==null&&s.delete(e),e4(t,n)}var t4;t4=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Kr.current)Ur=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Ur=!1,SQ(t,e,n);Ur=!!(t.flags&131072)}else Ur=!1,Sn&&e.flags&1048576&&iB(e,Zv,e.index);switch(e.lanes=0,e.tag){case 2:var s=e.type;fv(t,e),t=e.pendingProps;var r=df(e,ar.current);Lh(e,n),r=l_(null,e,s,t,r,n);var i=c_();return e.flags|=1,typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,qr(s)?(i=!0,Xv(e)):i=!1,e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,s_(e),r.updater=Fw,e.stateNode=r,r._reactInternals=e,XT(e,s,t,n),e=QT(null,e,s,!0,i,n)):(e.tag=0,Sn&&i&&YI(e),gr(null,e,r,n),e=e.child),e;case 16:s=e.elementType;e:{switch(fv(t,e),t=e.pendingProps,r=s._init,s=r(s._payload),e.type=s,r=e.tag=LQ(s),t=bo(s,t),r){case 0:e=ZT(null,e,s,t,n);break e;case 1:e=rP(null,e,s,t,n);break e;case 11:e=nP(null,e,s,t,n);break e;case 14:e=sP(null,e,s,bo(s.type,t),n);break e}throw Error(we(306,s,""))}return e;case 0:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:bo(s,r),ZT(t,e,s,r,n);case 1:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:bo(s,r),rP(t,e,s,r,n);case 3:e:{if(MB(e),t===null)throw Error(we(387));s=e.pendingProps,i=e.memoizedState,r=i.element,dB(t,e),eb(e,s,null,n);var o=e.memoizedState;if(s=o.element,i.isDehydrated)if(i={element:s,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){r=mf(Error(we(423)),e),e=iP(t,e,s,n,r);break e}else if(s!==r){r=mf(Error(we(424)),e),e=iP(t,e,s,n,r);break e}else for(mi=hc(e.stateNode.containerInfo.firstChild),xi=e,Sn=!0,Co=null,n=cB(e,null,s,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(hf(),s===r){e=fl(t,e,n);break e}gr(t,e,s,n)}e=e.child}return e;case 5:return hB(e),t===null&&GT(e),s=e.type,r=e.pendingProps,i=t!==null?t.memoizedProps:null,o=r.children,jT(s,r)?o=null:i!==null&&jT(s,i)&&(e.flags|=32),LB(t,e),gr(t,e,o,n),e.child;case 6:return t===null&&GT(e),null;case 13:return zB(t,e,n);case 4:return r_(e,e.stateNode.containerInfo),s=e.pendingProps,t===null?e.child=ff(e,null,s,n):gr(t,e,s,n),e.child;case 11:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:bo(s,r),nP(t,e,s,r,n);case 7:return gr(t,e,e.pendingProps,n),e.child;case 8:return gr(t,e,e.pendingProps.children,n),e.child;case 12:return gr(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(s=e.type._context,r=e.pendingProps,i=e.memoizedProps,o=r.value,cn(Qv,s._currentValue),s._currentValue=o,i!==null)if(Oo(i.value,o)){if(i.children===r.children&&!Kr.current){e=fl(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var a=i.dependencies;if(a!==null){o=i.child;for(var l=a.firstContext;l!==null;){if(l.context===s){if(i.tag===1){l=rl(-1,n&-n),l.tag=2;var c=i.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}i.lanes|=n,l=i.alternate,l!==null&&(l.lanes|=n),KT(i.return,n,e),a.lanes|=n;break}l=l.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(we(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),KT(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}gr(t,e,r.children,n),e=e.child}return e;case 9:return r=e.type,s=e.pendingProps.children,Lh(e,n),r=io(r),s=s(r),e.flags|=1,gr(t,e,s,n),e.child;case 14:return s=e.type,r=bo(s,e.pendingProps),r=bo(s.type,r),sP(t,e,s,r,n);case 15:return PB(t,e,e.type,e.pendingProps,n);case 17:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:bo(s,r),fv(t,e),e.tag=1,qr(s)?(t=!0,Xv(e)):t=!1,Lh(e,n),RB(e,s,r),XT(e,s,r,n),QT(null,e,s,!0,t,n);case 19:return VB(t,e,n);case 22:return FB(t,e,n)}throw Error(we(156,e.tag))};function n4(t,e){return Ej(t,e)}function FQ(t,e,n,s){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Xi(t,e,n,s){return new FQ(t,e,n,s)}function v_(t){return t=t.prototype,!(!t||!t.isReactComponent)}function LQ(t){if(typeof t=="function")return v_(t)?1:0;if(t!=null){if(t=t.$$typeof,t===MI)return 11;if(t===zI)return 14}return 2}function gc(t,e){var n=t.alternate;return n===null?(n=Xi(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function gv(t,e,n,s,r,i){var o=2;if(s=t,typeof t=="function")v_(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case hh:return Yu(n.children,r,i,e);case LI:o=8,r|=8;break;case vT:return t=Xi(12,n,e,r|2),t.elementType=vT,t.lanes=i,t;case bT:return t=Xi(13,n,e,r),t.elementType=bT,t.lanes=i,t;case wT:return t=Xi(19,n,e,r),t.elementType=wT,t.lanes=i,t;case hj:return zw(n,r,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case uj:o=10;break e;case dj:o=9;break e;case MI:o=11;break e;case zI:o=14;break e;case Ll:o=16,s=null;break e}throw Error(we(130,t==null?t:typeof t,""))}return e=Xi(o,n,e,r),e.elementType=t,e.type=s,e.lanes=i,e}function Yu(t,e,n,s){return t=Xi(7,t,s,e),t.lanes=n,t}function zw(t,e,n,s){return t=Xi(22,t,s,e),t.elementType=hj,t.lanes=n,t.stateNode={isHidden:!1},t}function Jk(t,e,n){return t=Xi(6,t,null,e),t.lanes=n,t}function eC(t,e,n){return e=Xi(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function MQ(t,e,n,s,r){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ok(0),this.expirationTimes=Ok(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ok(0),this.identifierPrefix=s,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function b_(t,e,n,s,r,i,o,a,l){return t=new MQ(t,e,n,a,l),e===1?(e=1,i===!0&&(e|=8)):e=0,i=Xi(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:s,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},s_(i),t}function zQ(t,e,n){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:dh,key:s==null?null:""+s,children:t,containerInfo:e,implementation:n}}function s4(t){if(!t)return Ec;t=t._reactInternals;e:{if($d(t)!==t||t.tag!==1)throw Error(we(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(qr(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(we(171))}if(t.tag===1){var n=t.type;if(qr(n))return sB(t,n,e)}return e}function r4(t,e,n,s,r,i,o,a,l){return t=b_(n,s,!0,t,r,i,o,a,l),t.context=s4(null),n=t.current,s=Sr(),r=mc(n),i=rl(s,r),i.callback=e??null,fc(n,i,r),t.current.lanes=r,Qg(t,r,s),Xr(t,s),t}function Vw(t,e,n,s){var r=e.current,i=Sr(),o=mc(r);return n=s4(n),e.context===null?e.context=n:e.pendingContext=n,e=rl(i,o),e.payload={element:t},s=s===void 0?null:s,s!==null&&(e.callback=s),t=fc(r,e,o),t!==null&&(Ro(t,r,o,i),uv(t,r,o)),o}function lb(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function mP(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function w_(t,e){mP(t,e),(t=t.alternate)&&mP(t,e)}function VQ(){return null}var i4=typeof reportError=="function"?reportError:function(t){console.error(t)};function S_(t){this._internalRoot=t}jw.prototype.render=S_.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(we(409));Vw(t,e,null,null)};jw.prototype.unmount=S_.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;ud(function(){Vw(null,t,null,null)}),e[dl]=null}};function jw(t){this._internalRoot=t}jw.prototype.unstable_scheduleHydration=function(t){if(t){var e=Fj();t={blockedOn:null,target:t,priority:e};for(var n=0;n<jl.length&&e!==0&&e<jl[n].priority;n++);jl.splice(n,0,t),n===0&&Mj(t)}};function k_(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Bw(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function gP(){}function jQ(t,e,n,s,r){if(r){if(typeof s=="function"){var i=s;s=function(){var c=lb(o);i.call(c)}}var o=r4(e,s,t,0,null,!1,!1,"",gP);return t._reactRootContainer=o,t[dl]=o.current,Jm(t.nodeType===8?t.parentNode:t),ud(),o}for(;r=t.lastChild;)t.removeChild(r);if(typeof s=="function"){var a=s;s=function(){var c=lb(l);a.call(c)}}var l=b_(t,0,!1,null,null,!1,!1,"",gP);return t._reactRootContainer=l,t[dl]=l.current,Jm(t.nodeType===8?t.parentNode:t),ud(function(){Vw(e,l,n,s)}),l}function Ww(t,e,n,s,r){var i=n._reactRootContainer;if(i){var o=i;if(typeof r=="function"){var a=r;r=function(){var l=lb(o);a.call(l)}}Vw(e,o,t,r)}else o=jQ(n,e,t,r,s);return lb(o)}Oj=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=em(e.pendingLanes);n!==0&&(BI(e,n|1),Xr(e,Yn()),!(Pt&6)&&(gf=Yn()+500,Yc()))}break;case 13:ud(function(){var s=hl(t,1);if(s!==null){var r=Sr();Ro(s,t,1,r)}}),w_(t,1)}};WI=function(t){if(t.tag===13){var e=hl(t,134217728);if(e!==null){var n=Sr();Ro(e,t,134217728,n)}w_(t,134217728)}};Pj=function(t){if(t.tag===13){var e=mc(t),n=hl(t,e);if(n!==null){var s=Sr();Ro(n,t,e,s)}w_(t,e)}};Fj=function(){return qt};Lj=function(t,e){var n=qt;try{return qt=t,e()}finally{qt=n}};AT=function(t,e,n){switch(e){case"input":if(CT(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var s=n[e];if(s!==t&&s.form===t.form){var r=Dw(s);if(!r)throw Error(we(90));pj(s),CT(s,r)}}}break;case"textarea":gj(t,n);break;case"select":e=n.value,e!=null&&Dh(t,!!n.multiple,e,!1)}};kj=g_;Cj=ud;var BQ={usingClientEntryPoint:!1,Events:[ey,gh,Dw,wj,Sj,g_]},Pp={findFiberByHostInstance:Au,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},WQ={bundleType:Pp.bundleType,version:Pp.version,rendererPackageName:Pp.rendererPackageName,rendererConfig:Pp.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:vl.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Ij(t),t===null?null:t.stateNode},findFiberByHostInstance:Pp.findFiberByHostInstance||VQ,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var yx=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!yx.isDisabled&&yx.supportsFiber)try{Ew=yx.inject(WQ),pa=yx}catch{}}Ii.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=BQ;Ii.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!k_(e))throw Error(we(200));return zQ(t,e,null,n)};Ii.createRoot=function(t,e){if(!k_(t))throw Error(we(299));var n=!1,s="",r=i4;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(s=e.identifierPrefix),e.onRecoverableError!==void 0&&(r=e.onRecoverableError)),e=b_(t,1,!1,null,null,n,!1,s,r),t[dl]=e.current,Jm(t.nodeType===8?t.parentNode:t),new S_(e)};Ii.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(we(188)):(t=Object.keys(t).join(","),Error(we(268,t)));return t=Ij(e),t=t===null?null:t.stateNode,t};Ii.flushSync=function(t){return ud(t)};Ii.hydrate=function(t,e,n){if(!Bw(e))throw Error(we(200));return Ww(null,t,e,!0,n)};Ii.hydrateRoot=function(t,e,n){if(!k_(t))throw Error(we(405));var s=n!=null&&n.hydratedSources||null,r=!1,i="",o=i4;if(n!=null&&(n.unstable_strictMode===!0&&(r=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=r4(e,null,t,1,n??null,r,!1,i,o),t[dl]=e.current,Jm(t),s)for(t=0;t<s.length;t++)n=s[t],r=n._getVersion,r=r(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,r]:e.mutableSourceEagerHydrationData.push(n,r);return new jw(e)};Ii.render=function(t,e,n){if(!Bw(e))throw Error(we(200));return Ww(null,t,e,!1,n)};Ii.unmountComponentAtNode=function(t){if(!Bw(t))throw Error(we(40));return t._reactRootContainer?(ud(function(){Ww(null,null,t,!1,function(){t._reactRootContainer=null,t[dl]=null})}),!0):!1};Ii.unstable_batchedUpdates=g_;Ii.unstable_renderSubtreeIntoContainer=function(t,e,n,s){if(!Bw(n))throw Error(we(200));if(t==null||t._reactInternals===void 0)throw Error(we(38));return Ww(t,e,n,!1,s)};Ii.version="18.3.1-next-f1338f8080-20240426";function o4(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(o4)}catch(t){console.error(t)}}o4(),oj.exports=Ii;var ny=oj.exports;const UQ=Iw(ny);var a4,yP=ny;a4=yP.createRoot,yP.hydrateRoot;function HQ(t,e){if(t instanceof RegExp)return{keys:!1,pattern:t};var n,s,r,i,o=[],a="",l=t.split("/");for(l[0]||l.shift();r=l.shift();)n=r[0],n==="*"?(o.push(n),a+=r[1]==="?"?"(?:/(.*))?":"/(.*)"):n===":"?(s=r.indexOf("?",1),i=r.indexOf(".",1),o.push(r.substring(1,~s?s:~i?i:r.length)),a+=~s&&!~i?"(?:/([^/]+?))?":"/([^/]+?)",~i&&(a+=(~s?"?":"")+"\\"+r.substring(i))):a+="/"+r;return{keys:o,pattern:new RegExp("^"+a+(e?"(?=$|/)":"/?$"),"i")}}var l4={exports:{}},c4={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yf=D;function GQ(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var KQ=typeof Object.is=="function"?Object.is:GQ,qQ=yf.useState,XQ=yf.useEffect,YQ=yf.useLayoutEffect,ZQ=yf.useDebugValue;function QQ(t,e){var n=e(),s=qQ({inst:{value:n,getSnapshot:e}}),r=s[0].inst,i=s[1];return YQ(function(){r.value=n,r.getSnapshot=e,tC(r)&&i({inst:r})},[t,n,e]),XQ(function(){return tC(r)&&i({inst:r}),t(function(){tC(r)&&i({inst:r})})},[t]),ZQ(n),n}function tC(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!KQ(t,n)}catch{return!0}}function JQ(t,e){return e()}var eJ=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?JQ:QQ;c4.useSyncExternalStore=yf.useSyncExternalStore!==void 0?yf.useSyncExternalStore:eJ;l4.exports=c4;var tJ=l4.exports;const nJ=rj["useInsertionEffect"],sJ=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",rJ=sJ?D.useLayoutEffect:D.useEffect,iJ=nJ||rJ,u4=t=>{const e=D.useRef([t,(...n)=>e[0](...n)]).current;return iJ(()=>{e[0]=t}),e[1]},oJ="popstate",C_="pushState",T_="replaceState",aJ="hashchange",xP=[oJ,C_,T_,aJ],lJ=t=>{for(const e of xP)addEventListener(e,t);return()=>{for(const e of xP)removeEventListener(e,t)}},d4=(t,e)=>tJ.useSyncExternalStore(lJ,t,e),cJ=()=>location.search,uJ=({ssrSearch:t=""}={})=>d4(cJ,()=>t),vP=()=>location.pathname,dJ=({ssrPath:t}={})=>d4(vP,t?()=>t:vP),hJ=(t,{replace:e=!1,state:n=null}={})=>history[e?T_:C_](n,"",t),fJ=(t={})=>[dJ(t),hJ],bP=Symbol.for("wouter_v3");if(typeof history<"u"&&typeof window[bP]>"u"){for(const t of[C_,T_]){const e=history[t];history[t]=function(){const n=e.apply(this,arguments),s=new Event(t);return s.arguments=arguments,dispatchEvent(s),n}}Object.defineProperty(window,bP,{value:!0})}const pJ=(t,e)=>e.toLowerCase().indexOf(t.toLowerCase())?"~"+e:e.slice(t.length)||"/",h4=(t="")=>t==="/"?"":t,mJ=(t,e)=>t[0]==="~"?t.slice(1):h4(e)+t,gJ=(t="",e)=>pJ(wP(h4(t)),wP(e)),wP=t=>{try{return decodeURI(t)}catch{return t}},f4={hook:fJ,searchHook:uJ,parser:HQ,base:"",ssrPath:void 0,ssrSearch:void 0,ssrContext:void 0,hrefs:t=>t},p4=D.createContext(f4),sy=()=>D.useContext(p4),m4={},g4=D.createContext(m4),y4=()=>D.useContext(g4),Uw=t=>{const[e,n]=t.hook(t);return[gJ(t.base,e),u4((s,r)=>n(mJ(s,t.base),r))]},ti=()=>Uw(sy()),x4=(t,e,n,s)=>{const{pattern:r,keys:i}=e instanceof RegExp?{keys:!1,pattern:e}:t(e||"*",s),o=r.exec(n)||[],[a,...l]=o;return a!==void 0?[!0,(()=>{const c=i!==!1?Object.fromEntries(i.map((d,h)=>[d,l[h]])):o.groups;let u={...l};return c&&Object.assign(u,c),u})(),...s?[a]:[]]:[!1,null]},yJ=({children:t,...e})=>{var u,d;const n=sy(),s=e.hook?f4:n;let r=s;const[i,o]=((u=e.ssrPath)==null?void 0:u.split("?"))??[];o&&(e.ssrSearch=o,e.ssrPath=i),e.hrefs=e.hrefs??((d=e.hook)==null?void 0:d.hrefs);let a=D.useRef({}),l=a.current,c=l;for(let h in s){const f=h==="base"?s[h]+(e[h]||""):e[h]||s[h];l===c&&f!==c[h]&&(a.current=c={...c}),c[h]=f,(f!==s[h]||f!==r[h])&&(r=c)}return D.createElement(p4.Provider,{value:r,children:t})},SP=({children:t,component:e},n)=>e?D.createElement(e,{params:n}):typeof t=="function"?t(n):t,xJ=t=>{let e=D.useRef(m4);const n=e.current;return e.current=Object.keys(t).length!==Object.keys(n).length||Object.entries(t).some(([s,r])=>r!==n[s])?t:n},yo=({path:t,nest:e,match:n,...s})=>{const r=sy(),[i]=Uw(r),[o,a,l]=n??x4(r.parser,t,i,e),c=xJ({...y4(),...a});if(!o)return null;const u=l?D.createElement(yJ,{base:l},SP(s,c)):SP(s,c);return D.createElement(g4.Provider,{value:c,children:u})};D.forwardRef((t,e)=>{const n=sy(),[s,r]=Uw(n),{to:i="",href:o=i,onClick:a,asChild:l,children:c,className:u,replace:d,state:h,...f}=t,p=u4(g=>{g.ctrlKey||g.metaKey||g.altKey||g.shiftKey||g.button!==0||(a==null||a(g),g.defaultPrevented||(g.preventDefault(),r(o,t)))}),m=n.hrefs(o[0]==="~"?o.slice(1):n.base+o,n);return l&&D.isValidElement(c)?D.cloneElement(c,{onClick:p,href:m}):D.createElement("a",{...f,onClick:p,href:m,className:u!=null&&u.call?u(s===o):u,children:c,ref:e})});const v4=t=>Array.isArray(t)?t.flatMap(e=>v4(e&&e.type===D.Fragment?e.props.children:e)):[t],vJ=({children:t,location:e})=>{const n=sy(),[s]=Uw(n);for(const r of v4(t)){let i=0;if(D.isValidElement(r)&&(i=x4(n.parser,r.props.path,e||s,r.props.nest))[0])return D.cloneElement(r,{match:i})}return null};var Kf=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(t){return this.listeners.add(t),this.onSubscribe(),()=>{this.listeners.delete(t),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},dd=typeof window>"u"||"Deno"in globalThis;function yr(){}function bJ(t,e){return typeof t=="function"?t(e):t}function uN(t){return typeof t=="number"&&t>=0&&t!==1/0}function b4(t,e){return Math.max(t+(e||0)-Date.now(),0)}function yc(t,e){return typeof t=="function"?t(e):t}function Hi(t,e){return typeof t=="function"?t(e):t}function kP(t,e){const{type:n="all",exact:s,fetchStatus:r,predicate:i,queryKey:o,stale:a}=t;if(o){if(s){if(e.queryHash!==N_(o,e.options))return!1}else if(!lg(e.queryKey,o))return!1}if(n!=="all"){const l=e.isActive();if(n==="active"&&!l||n==="inactive"&&l)return!1}return!(typeof a=="boolean"&&e.isStale()!==a||r&&r!==e.state.fetchStatus||i&&!i(e))}function CP(t,e){const{exact:n,status:s,predicate:r,mutationKey:i}=t;if(i){if(!e.options.mutationKey)return!1;if(n){if(hd(e.options.mutationKey)!==hd(i))return!1}else if(!lg(e.options.mutationKey,i))return!1}return!(s&&e.state.status!==s||r&&!r(e))}function N_(t,e){return((e==null?void 0:e.queryKeyHashFn)||hd)(t)}function hd(t){return JSON.stringify(t,(e,n)=>dN(n)?Object.keys(n).sort().reduce((s,r)=>(s[r]=n[r],s),{}):n)}function lg(t,e){return t===e?!0:typeof t!=typeof e?!1:t&&e&&typeof t=="object"&&typeof e=="object"?Object.keys(e).every(n=>lg(t[n],e[n])):!1}function w4(t,e){if(t===e)return t;const n=TP(t)&&TP(e);if(n||dN(t)&&dN(e)){const s=n?t:Object.keys(t),r=s.length,i=n?e:Object.keys(e),o=i.length,a=n?[]:{},l=new Set(s);let c=0;for(let u=0;u<o;u++){const d=n?u:i[u];(!n&&l.has(d)||n)&&t[d]===void 0&&e[d]===void 0?(a[d]=void 0,c++):(a[d]=w4(t[d],e[d]),a[d]===t[d]&&t[d]!==void 0&&c++)}return r===o&&c===r?t:a}return e}function cb(t,e){if(!e||Object.keys(t).length!==Object.keys(e).length)return!1;for(const n in t)if(t[n]!==e[n])return!1;return!0}function TP(t){return Array.isArray(t)&&t.length===Object.keys(t).length}function dN(t){if(!NP(t))return!1;const e=t.constructor;if(e===void 0)return!0;const n=e.prototype;return!(!NP(n)||!n.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(t)!==Object.prototype)}function NP(t){return Object.prototype.toString.call(t)==="[object Object]"}function wJ(t){return new Promise(e=>{setTimeout(e,t)})}function hN(t,e,n){return typeof n.structuralSharing=="function"?n.structuralSharing(t,e):n.structuralSharing!==!1?w4(t,e):e}function SJ(t,e,n=0){const s=[...t,e];return n&&s.length>n?s.slice(1):s}function kJ(t,e,n=0){const s=[e,...t];return n&&s.length>n?s.slice(0,-1):s}var I_=Symbol();function S4(t,e){return!t.queryFn&&(e!=null&&e.initialPromise)?()=>e.initialPromise:!t.queryFn||t.queryFn===I_?()=>Promise.reject(new Error(`Missing queryFn: '${t.queryHash}'`)):t.queryFn}function k4(t,e){return typeof t=="function"?t(...e):!!t}var Vu,Wl,Xh,LV,CJ=(LV=class extends Kf{constructor(){super();Ue(this,Vu,void 0);Ue(this,Wl,void 0);Ue(this,Xh,void 0);Pe(this,Xh,e=>{if(!dd&&window.addEventListener){const n=()=>e();return window.addEventListener("visibilitychange",n,!1),()=>{window.removeEventListener("visibilitychange",n)}}})}onSubscribe(){J(this,Wl)||this.setEventListener(J(this,Xh))}onUnsubscribe(){var e;this.hasListeners()||((e=J(this,Wl))==null||e.call(this),Pe(this,Wl,void 0))}setEventListener(e){var n;Pe(this,Xh,e),(n=J(this,Wl))==null||n.call(this),Pe(this,Wl,e(s=>{typeof s=="boolean"?this.setFocused(s):this.onFocus()}))}setFocused(e){J(this,Vu)!==e&&(Pe(this,Vu,e),this.onFocus())}onFocus(){const e=this.isFocused();this.listeners.forEach(n=>{n(e)})}isFocused(){var e;return typeof J(this,Vu)=="boolean"?J(this,Vu):((e=globalThis.document)==null?void 0:e.visibilityState)!=="hidden"}},Vu=new WeakMap,Wl=new WeakMap,Xh=new WeakMap,LV),__=new CJ,Yh,Ul,Zh,MV,TJ=(MV=class extends Kf{constructor(){super();Ue(this,Yh,!0);Ue(this,Ul,void 0);Ue(this,Zh,void 0);Pe(this,Zh,e=>{if(!dd&&window.addEventListener){const n=()=>e(!0),s=()=>e(!1);return window.addEventListener("online",n,!1),window.addEventListener("offline",s,!1),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",s)}}})}onSubscribe(){J(this,Ul)||this.setEventListener(J(this,Zh))}onUnsubscribe(){var e;this.hasListeners()||((e=J(this,Ul))==null||e.call(this),Pe(this,Ul,void 0))}setEventListener(e){var n;Pe(this,Zh,e),(n=J(this,Ul))==null||n.call(this),Pe(this,Ul,e(this.setOnline.bind(this)))}setOnline(e){J(this,Yh)!==e&&(Pe(this,Yh,e),this.listeners.forEach(s=>{s(e)}))}isOnline(){return J(this,Yh)}},Yh=new WeakMap,Ul=new WeakMap,Zh=new WeakMap,MV),ub=new TJ;function fN(){let t,e;const n=new Promise((r,i)=>{t=r,e=i});n.status="pending",n.catch(()=>{});function s(r){Object.assign(n,r),delete n.resolve,delete n.reject}return n.resolve=r=>{s({status:"fulfilled",value:r}),t(r)},n.reject=r=>{s({status:"rejected",reason:r}),e(r)},n}function NJ(t){return Math.min(1e3*2**t,3e4)}function C4(t){return(t??"online")==="online"?ub.isOnline():!0}var T4=class extends Error{constructor(t){super("CancelledError"),this.revert=t==null?void 0:t.revert,this.silent=t==null?void 0:t.silent}};function N4(t){let e=!1,n=0,s;const r=fN(),i=()=>r.status!=="pending",o=m=>{var g;i()||(h(new T4(m)),(g=t.abort)==null||g.call(t))},a=()=>{e=!0},l=()=>{e=!1},c=()=>__.isFocused()&&(t.networkMode==="always"||ub.isOnline())&&t.canRun(),u=()=>C4(t.networkMode)&&t.canRun(),d=m=>{i()||(s==null||s(),r.resolve(m))},h=m=>{i()||(s==null||s(),r.reject(m))},f=()=>new Promise(m=>{var g;s=y=>{(i()||c())&&m(y)},(g=t.onPause)==null||g.call(t)}).then(()=>{var m;s=void 0,i()||(m=t.onContinue)==null||m.call(t)}),p=()=>{if(i())return;let m;const g=n===0?t.initialPromise:void 0;try{m=g??t.fn()}catch(y){m=Promise.reject(y)}Promise.resolve(m).then(d).catch(y=>{var C;if(i())return;const x=t.retry??(dd?0:3),v=t.retryDelay??NJ,b=typeof v=="function"?v(n,y):v,k=x===!0||typeof x=="number"&&n<x||typeof x=="function"&&x(n,y);if(e||!k){h(y);return}n++,(C=t.onFail)==null||C.call(t,n,y),wJ(b).then(()=>c()?void 0:f()).then(()=>{e?h(y):p()})})};return{promise:r,status:()=>r.status,cancel:o,continue:()=>(s==null||s(),r),cancelRetry:a,continueRetry:l,canStart:u,start:()=>(u()?p():f().then(p),r)}}var IJ=t=>setTimeout(t,0);function _J(){let t=[],e=0,n=a=>{a()},s=a=>{a()},r=IJ;const i=a=>{e?t.push(a):r(()=>{n(a)})},o=()=>{const a=t;t=[],a.length&&r(()=>{s(()=>{a.forEach(l=>{n(l)})})})};return{batch:a=>{let l;e++;try{l=a()}finally{e--,e||o()}return l},batchCalls:a=>(...l)=>{i(()=>{a(...l)})},schedule:i,setNotifyFunction:a=>{n=a},setBatchNotifyFunction:a=>{s=a},setScheduler:a=>{r=a}}}var xs=_J(),ju,zV,I4=(zV=class{constructor(){Ue(this,ju,void 0)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),uN(this.gcTime)&&Pe(this,ju,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(t){this.gcTime=Math.max(this.gcTime||0,t??(dd?1/0:5*60*1e3))}clearGcTimeout(){J(this,ju)&&(clearTimeout(J(this,ju)),Pe(this,ju,void 0))}},ju=new WeakMap,zV),Qh,Jh,Wi,Bu,$s,zg,Wu,wo,Ba,VV,EJ=(VV=class extends I4{constructor(e){super();Ue(this,wo);Ue(this,Qh,void 0);Ue(this,Jh,void 0);Ue(this,Wi,void 0);Ue(this,Bu,void 0);Ue(this,$s,void 0);Ue(this,zg,void 0);Ue(this,Wu,void 0);Pe(this,Wu,!1),Pe(this,zg,e.defaultOptions),this.setOptions(e.options),this.observers=[],Pe(this,Bu,e.client),Pe(this,Wi,J(this,Bu).getQueryCache()),this.queryKey=e.queryKey,this.queryHash=e.queryHash,Pe(this,Qh,$J(this.options)),this.state=e.state??J(this,Qh),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var e;return(e=J(this,$s))==null?void 0:e.promise}setOptions(e){this.options={...J(this,zg),...e},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&J(this,Wi).remove(this)}setData(e,n){const s=hN(this.state.data,e,this.options);return vt(this,wo,Ba).call(this,{data:s,type:"success",dataUpdatedAt:n==null?void 0:n.updatedAt,manual:n==null?void 0:n.manual}),s}setState(e,n){vt(this,wo,Ba).call(this,{type:"setState",state:e,setStateOptions:n})}cancel(e){var s,r;const n=(s=J(this,$s))==null?void 0:s.promise;return(r=J(this,$s))==null||r.cancel(e),n?n.then(yr).catch(yr):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(J(this,Qh))}isActive(){return this.observers.some(e=>Hi(e.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===I_||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(e=>yc(e.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(e=>e.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(e=0){return this.state.data===void 0?!0:e==="static"?!1:this.state.isInvalidated?!0:!b4(this.state.dataUpdatedAt,e)}onFocus(){var n;const e=this.observers.find(s=>s.shouldFetchOnWindowFocus());e==null||e.refetch({cancelRefetch:!1}),(n=J(this,$s))==null||n.continue()}onOnline(){var n;const e=this.observers.find(s=>s.shouldFetchOnReconnect());e==null||e.refetch({cancelRefetch:!1}),(n=J(this,$s))==null||n.continue()}addObserver(e){this.observers.includes(e)||(this.observers.push(e),this.clearGcTimeout(),J(this,Wi).notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){this.observers.includes(e)&&(this.observers=this.observers.filter(n=>n!==e),this.observers.length||(J(this,$s)&&(J(this,Wu)?J(this,$s).cancel({revert:!0}):J(this,$s).cancelRetry()),this.scheduleGc()),J(this,Wi).notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||vt(this,wo,Ba).call(this,{type:"invalidate"})}async fetch(e,n){var l,c,u,d,h,f,p,m,g,y,x,v;if(this.state.fetchStatus!=="idle"&&((l=J(this,$s))==null?void 0:l.status())!=="rejected"){if(this.state.data!==void 0&&(n!=null&&n.cancelRefetch))this.cancel({silent:!0});else if(J(this,$s))return J(this,$s).continueRetry(),J(this,$s).promise}if(e&&this.setOptions(e),!this.options.queryFn){const b=this.observers.find(k=>k.options.queryFn);b&&this.setOptions(b.options)}const s=new AbortController,r=b=>{Object.defineProperty(b,"signal",{enumerable:!0,get:()=>(Pe(this,Wu,!0),s.signal)})},i=()=>{const b=S4(this.options,n),C=(()=>{const N={client:J(this,Bu),queryKey:this.queryKey,meta:this.meta};return r(N),N})();return Pe(this,Wu,!1),this.options.persister?this.options.persister(b,C,this):b(C)},a=(()=>{const b={fetchOptions:n,options:this.options,queryKey:this.queryKey,client:J(this,Bu),state:this.state,fetchFn:i};return r(b),b})();(c=this.options.behavior)==null||c.onFetch(a,this),Pe(this,Jh,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((u=a.fetchOptions)==null?void 0:u.meta))&&vt(this,wo,Ba).call(this,{type:"fetch",meta:(d=a.fetchOptions)==null?void 0:d.meta}),Pe(this,$s,N4({initialPromise:n==null?void 0:n.initialPromise,fn:a.fetchFn,abort:s.abort.bind(s),onFail:(b,k)=>{vt(this,wo,Ba).call(this,{type:"failed",failureCount:b,error:k})},onPause:()=>{vt(this,wo,Ba).call(this,{type:"pause"})},onContinue:()=>{vt(this,wo,Ba).call(this,{type:"continue"})},retry:a.options.retry,retryDelay:a.options.retryDelay,networkMode:a.options.networkMode,canRun:()=>!0}));try{const b=await J(this,$s).start();if(b===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(b),(f=(h=J(this,Wi).config).onSuccess)==null||f.call(h,b,this),(m=(p=J(this,Wi).config).onSettled)==null||m.call(p,b,this.state.error,this),b}catch(b){if(b instanceof T4){if(b.silent)return J(this,$s).promise;if(b.revert)return this.setState({...J(this,Jh),fetchStatus:"idle"}),this.state.data}throw vt(this,wo,Ba).call(this,{type:"error",error:b}),(y=(g=J(this,Wi).config).onError)==null||y.call(g,b,this),(v=(x=J(this,Wi).config).onSettled)==null||v.call(x,this.state.data,b,this),b}finally{this.scheduleGc()}}},Qh=new WeakMap,Jh=new WeakMap,Wi=new WeakMap,Bu=new WeakMap,$s=new WeakMap,zg=new WeakMap,Wu=new WeakMap,wo=new WeakSet,Ba=function(e){const n=s=>{switch(e.type){case"failed":return{...s,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case"pause":return{...s,fetchStatus:"paused"};case"continue":return{...s,fetchStatus:"fetching"};case"fetch":return{...s,..._4(s.data,this.options),fetchMeta:e.meta??null};case"success":const r={...s,data:e.data,dataUpdateCount:s.dataUpdateCount+1,dataUpdatedAt:e.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return Pe(this,Jh,e.manual?r:void 0),r;case"error":const i=e.error;return{...s,error:i,errorUpdateCount:s.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:s.fetchFailureCount+1,fetchFailureReason:i,fetchStatus:"idle",status:"error"};case"invalidate":return{...s,isInvalidated:!0};case"setState":return{...s,...e.state}}};this.state=n(this.state),xs.batch(()=>{this.observers.forEach(s=>{s.onQueryUpdate()}),J(this,Wi).notify({query:this,type:"updated",action:e})})},VV);function _4(t,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:C4(e.networkMode)?"fetching":"paused",...t===void 0&&{error:null,status:"pending"}}}function $J(t){const e=typeof t.initialData=="function"?t.initialData():t.initialData,n=e!==void 0,s=n?typeof t.initialDataUpdatedAt=="function"?t.initialDataUpdatedAt():t.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:n?s??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}var Jo,jV,AJ=(jV=class extends Kf{constructor(e={}){super();Ue(this,Jo,void 0);this.config=e,Pe(this,Jo,new Map)}build(e,n,s){const r=n.queryKey,i=n.queryHash??N_(r,n);let o=this.get(i);return o||(o=new EJ({client:e,queryKey:r,queryHash:i,options:e.defaultQueryOptions(n),state:s,defaultOptions:e.getQueryDefaults(r)}),this.add(o)),o}add(e){J(this,Jo).has(e.queryHash)||(J(this,Jo).set(e.queryHash,e),this.notify({type:"added",query:e}))}remove(e){const n=J(this,Jo).get(e.queryHash);n&&(e.destroy(),n===e&&J(this,Jo).delete(e.queryHash),this.notify({type:"removed",query:e}))}clear(){xs.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}get(e){return J(this,Jo).get(e)}getAll(){return[...J(this,Jo).values()]}find(e){const n={exact:!0,...e};return this.getAll().find(s=>kP(n,s))}findAll(e={}){const n=this.getAll();return Object.keys(e).length>0?n.filter(s=>kP(e,s)):n}notify(e){xs.batch(()=>{this.listeners.forEach(n=>{n(e)})})}onFocus(){xs.batch(()=>{this.getAll().forEach(e=>{e.onFocus()})})}onOnline(){xs.batch(()=>{this.getAll().forEach(e=>{e.onOnline()})})}},Jo=new WeakMap,jV),ea,pr,Uu,ta,Ol,BV,RJ=(BV=class extends I4{constructor(e){super();Ue(this,ta);Ue(this,ea,void 0);Ue(this,pr,void 0);Ue(this,Uu,void 0);this.mutationId=e.mutationId,Pe(this,pr,e.mutationCache),Pe(this,ea,[]),this.state=e.state||E4(),this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){J(this,ea).includes(e)||(J(this,ea).push(e),this.clearGcTimeout(),J(this,pr).notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){Pe(this,ea,J(this,ea).filter(n=>n!==e)),this.scheduleGc(),J(this,pr).notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){J(this,ea).length||(this.state.status==="pending"?this.scheduleGc():J(this,pr).remove(this))}continue(){var e;return((e=J(this,Uu))==null?void 0:e.continue())??this.execute(this.state.variables)}async execute(e){var i,o,a,l,c,u,d,h,f,p,m,g,y,x,v,b,k,C,N,I;const n=()=>{vt(this,ta,Ol).call(this,{type:"continue"})};Pe(this,Uu,N4({fn:()=>this.options.mutationFn?this.options.mutationFn(e):Promise.reject(new Error("No mutationFn found")),onFail:($,A)=>{vt(this,ta,Ol).call(this,{type:"failed",failureCount:$,error:A})},onPause:()=>{vt(this,ta,Ol).call(this,{type:"pause"})},onContinue:n,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>J(this,pr).canRun(this)}));const s=this.state.status==="pending",r=!J(this,Uu).canStart();try{if(s)n();else{vt(this,ta,Ol).call(this,{type:"pending",variables:e,isPaused:r}),await((o=(i=J(this,pr).config).onMutate)==null?void 0:o.call(i,e,this));const A=await((l=(a=this.options).onMutate)==null?void 0:l.call(a,e));A!==this.state.context&&vt(this,ta,Ol).call(this,{type:"pending",context:A,variables:e,isPaused:r})}const $=await J(this,Uu).start();return await((u=(c=J(this,pr).config).onSuccess)==null?void 0:u.call(c,$,e,this.state.context,this)),await((h=(d=this.options).onSuccess)==null?void 0:h.call(d,$,e,this.state.context)),await((p=(f=J(this,pr).config).onSettled)==null?void 0:p.call(f,$,null,this.state.variables,this.state.context,this)),await((g=(m=this.options).onSettled)==null?void 0:g.call(m,$,null,e,this.state.context)),vt(this,ta,Ol).call(this,{type:"success",data:$}),$}catch($){try{throw await((x=(y=J(this,pr).config).onError)==null?void 0:x.call(y,$,e,this.state.context,this)),await((b=(v=this.options).onError)==null?void 0:b.call(v,$,e,this.state.context)),await((C=(k=J(this,pr).config).onSettled)==null?void 0:C.call(k,void 0,$,this.state.variables,this.state.context,this)),await((I=(N=this.options).onSettled)==null?void 0:I.call(N,void 0,$,e,this.state.context)),$}finally{vt(this,ta,Ol).call(this,{type:"error",error:$})}}finally{J(this,pr).runNext(this)}}},ea=new WeakMap,pr=new WeakMap,Uu=new WeakMap,ta=new WeakSet,Ol=function(e){const n=s=>{switch(e.type){case"failed":return{...s,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...s,isPaused:!0};case"continue":return{...s,isPaused:!1};case"pending":return{...s,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...s,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...s,data:void 0,error:e.error,failureCount:s.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}};this.state=n(this.state),xs.batch(()=>{J(this,ea).forEach(s=>{s.onMutationUpdate(e)}),J(this,pr).notify({mutation:this,type:"updated",action:e})})},BV);function E4(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var Ya,So,Vg,WV,DJ=(WV=class extends Kf{constructor(e={}){super();Ue(this,Ya,void 0);Ue(this,So,void 0);Ue(this,Vg,void 0);this.config=e,Pe(this,Ya,new Set),Pe(this,So,new Map),Pe(this,Vg,0)}build(e,n,s){const r=new RJ({mutationCache:this,mutationId:++ex(this,Vg)._,options:e.defaultMutationOptions(n),state:s});return this.add(r),r}add(e){J(this,Ya).add(e);const n=xx(e);if(typeof n=="string"){const s=J(this,So).get(n);s?s.push(e):J(this,So).set(n,[e])}this.notify({type:"added",mutation:e})}remove(e){if(J(this,Ya).delete(e)){const n=xx(e);if(typeof n=="string"){const s=J(this,So).get(n);if(s)if(s.length>1){const r=s.indexOf(e);r!==-1&&s.splice(r,1)}else s[0]===e&&J(this,So).delete(n)}}this.notify({type:"removed",mutation:e})}canRun(e){const n=xx(e);if(typeof n=="string"){const s=J(this,So).get(n),r=s==null?void 0:s.find(i=>i.state.status==="pending");return!r||r===e}else return!0}runNext(e){var s;const n=xx(e);if(typeof n=="string"){const r=(s=J(this,So).get(n))==null?void 0:s.find(i=>i!==e&&i.state.isPaused);return(r==null?void 0:r.continue())??Promise.resolve()}else return Promise.resolve()}clear(){xs.batch(()=>{J(this,Ya).forEach(e=>{this.notify({type:"removed",mutation:e})}),J(this,Ya).clear(),J(this,So).clear()})}getAll(){return Array.from(J(this,Ya))}find(e){const n={exact:!0,...e};return this.getAll().find(s=>CP(n,s))}findAll(e={}){return this.getAll().filter(n=>CP(e,n))}notify(e){xs.batch(()=>{this.listeners.forEach(n=>{n(e)})})}resumePausedMutations(){const e=this.getAll().filter(n=>n.state.isPaused);return xs.batch(()=>Promise.all(e.map(n=>n.continue().catch(yr))))}},Ya=new WeakMap,So=new WeakMap,Vg=new WeakMap,WV);function xx(t){var e;return(e=t.options.scope)==null?void 0:e.id}function IP(t){return{onFetch:(e,n)=>{var u,d,h,f,p;const s=e.options,r=(h=(d=(u=e.fetchOptions)==null?void 0:u.meta)==null?void 0:d.fetchMore)==null?void 0:h.direction,i=((f=e.state.data)==null?void 0:f.pages)||[],o=((p=e.state.data)==null?void 0:p.pageParams)||[];let a={pages:[],pageParams:[]},l=0;const c=async()=>{let m=!1;const g=v=>{Object.defineProperty(v,"signal",{enumerable:!0,get:()=>(e.signal.aborted?m=!0:e.signal.addEventListener("abort",()=>{m=!0}),e.signal)})},y=S4(e.options,e.fetchOptions),x=async(v,b,k)=>{if(m)return Promise.reject();if(b==null&&v.pages.length)return Promise.resolve(v);const N=(()=>{const P={client:e.client,queryKey:e.queryKey,pageParam:b,direction:k?"backward":"forward",meta:e.options.meta};return g(P),P})(),I=await y(N),{maxPages:$}=e.options,A=k?kJ:SJ;return{pages:A(v.pages,I,$),pageParams:A(v.pageParams,b,$)}};if(r&&i.length){const v=r==="backward",b=v?OJ:_P,k={pages:i,pageParams:o},C=b(s,k);a=await x(k,C,v)}else{const v=t??i.length;do{const b=l===0?o[0]??s.initialPageParam:_P(s,a);if(l>0&&b==null)break;a=await x(a,b),l++}while(l<v)}return a};e.options.persister?e.fetchFn=()=>{var m,g;return(g=(m=e.options).persister)==null?void 0:g.call(m,c,{client:e.client,queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},n)}:e.fetchFn=c}}}function _P(t,{pages:e,pageParams:n}){const s=e.length-1;return e.length>0?t.getNextPageParam(e[s],e,n[s],n):void 0}function OJ(t,{pages:e,pageParams:n}){var s;return e.length>0?(s=t.getPreviousPageParam)==null?void 0:s.call(t,e[0],e,n[0],n):void 0}var zn,Hl,Gl,ef,tf,Kl,nf,sf,UV,PJ=(UV=class{constructor(t={}){Ue(this,zn,void 0);Ue(this,Hl,void 0);Ue(this,Gl,void 0);Ue(this,ef,void 0);Ue(this,tf,void 0);Ue(this,Kl,void 0);Ue(this,nf,void 0);Ue(this,sf,void 0);Pe(this,zn,t.queryCache||new AJ),Pe(this,Hl,t.mutationCache||new DJ),Pe(this,Gl,t.defaultOptions||{}),Pe(this,ef,new Map),Pe(this,tf,new Map),Pe(this,Kl,0)}mount(){ex(this,Kl)._++,J(this,Kl)===1&&(Pe(this,nf,__.subscribe(async t=>{t&&(await this.resumePausedMutations(),J(this,zn).onFocus())})),Pe(this,sf,ub.subscribe(async t=>{t&&(await this.resumePausedMutations(),J(this,zn).onOnline())})))}unmount(){var t,e;ex(this,Kl)._--,J(this,Kl)===0&&((t=J(this,nf))==null||t.call(this),Pe(this,nf,void 0),(e=J(this,sf))==null||e.call(this),Pe(this,sf,void 0))}isFetching(t){return J(this,zn).findAll({...t,fetchStatus:"fetching"}).length}isMutating(t){return J(this,Hl).findAll({...t,status:"pending"}).length}getQueryData(t){var n;const e=this.defaultQueryOptions({queryKey:t});return(n=J(this,zn).get(e.queryHash))==null?void 0:n.state.data}ensureQueryData(t){const e=this.defaultQueryOptions(t),n=J(this,zn).build(this,e),s=n.state.data;return s===void 0?this.fetchQuery(t):(t.revalidateIfStale&&n.isStaleByTime(yc(e.staleTime,n))&&this.prefetchQuery(e),Promise.resolve(s))}getQueriesData(t){return J(this,zn).findAll(t).map(({queryKey:e,state:n})=>{const s=n.data;return[e,s]})}setQueryData(t,e,n){const s=this.defaultQueryOptions({queryKey:t}),r=J(this,zn).get(s.queryHash),i=r==null?void 0:r.state.data,o=bJ(e,i);if(o!==void 0)return J(this,zn).build(this,s).setData(o,{...n,manual:!0})}setQueriesData(t,e,n){return xs.batch(()=>J(this,zn).findAll(t).map(({queryKey:s})=>[s,this.setQueryData(s,e,n)]))}getQueryState(t){var n;const e=this.defaultQueryOptions({queryKey:t});return(n=J(this,zn).get(e.queryHash))==null?void 0:n.state}removeQueries(t){const e=J(this,zn);xs.batch(()=>{e.findAll(t).forEach(n=>{e.remove(n)})})}resetQueries(t,e){const n=J(this,zn);return xs.batch(()=>(n.findAll(t).forEach(s=>{s.reset()}),this.refetchQueries({type:"active",...t},e)))}cancelQueries(t,e={}){const n={revert:!0,...e},s=xs.batch(()=>J(this,zn).findAll(t).map(r=>r.cancel(n)));return Promise.all(s).then(yr).catch(yr)}invalidateQueries(t,e={}){return xs.batch(()=>(J(this,zn).findAll(t).forEach(n=>{n.invalidate()}),(t==null?void 0:t.refetchType)==="none"?Promise.resolve():this.refetchQueries({...t,type:(t==null?void 0:t.refetchType)??(t==null?void 0:t.type)??"active"},e)))}refetchQueries(t,e={}){const n={...e,cancelRefetch:e.cancelRefetch??!0},s=xs.batch(()=>J(this,zn).findAll(t).filter(r=>!r.isDisabled()&&!r.isStatic()).map(r=>{let i=r.fetch(void 0,n);return n.throwOnError||(i=i.catch(yr)),r.state.fetchStatus==="paused"?Promise.resolve():i}));return Promise.all(s).then(yr)}fetchQuery(t){const e=this.defaultQueryOptions(t);e.retry===void 0&&(e.retry=!1);const n=J(this,zn).build(this,e);return n.isStaleByTime(yc(e.staleTime,n))?n.fetch(e):Promise.resolve(n.state.data)}prefetchQuery(t){return this.fetchQuery(t).then(yr).catch(yr)}fetchInfiniteQuery(t){return t.behavior=IP(t.pages),this.fetchQuery(t)}prefetchInfiniteQuery(t){return this.fetchInfiniteQuery(t).then(yr).catch(yr)}ensureInfiniteQueryData(t){return t.behavior=IP(t.pages),this.ensureQueryData(t)}resumePausedMutations(){return ub.isOnline()?J(this,Hl).resumePausedMutations():Promise.resolve()}getQueryCache(){return J(this,zn)}getMutationCache(){return J(this,Hl)}getDefaultOptions(){return J(this,Gl)}setDefaultOptions(t){Pe(this,Gl,t)}setQueryDefaults(t,e){J(this,ef).set(hd(t),{queryKey:t,defaultOptions:e})}getQueryDefaults(t){const e=[...J(this,ef).values()],n={};return e.forEach(s=>{lg(t,s.queryKey)&&Object.assign(n,s.defaultOptions)}),n}setMutationDefaults(t,e){J(this,tf).set(hd(t),{mutationKey:t,defaultOptions:e})}getMutationDefaults(t){const e=[...J(this,tf).values()],n={};return e.forEach(s=>{lg(t,s.mutationKey)&&Object.assign(n,s.defaultOptions)}),n}defaultQueryOptions(t){if(t._defaulted)return t;const e={...J(this,Gl).queries,...this.getQueryDefaults(t.queryKey),...t,_defaulted:!0};return e.queryHash||(e.queryHash=N_(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!=="always"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e.queryFn===I_&&(e.enabled=!1),e}defaultMutationOptions(t){return t!=null&&t._defaulted?t:{...J(this,Gl).mutations,...(t==null?void 0:t.mutationKey)&&this.getMutationDefaults(t.mutationKey),...t,_defaulted:!0}}clear(){J(this,zn).clear(),J(this,Hl).clear()}},zn=new WeakMap,Hl=new WeakMap,Gl=new WeakMap,ef=new WeakMap,tf=new WeakMap,Kl=new WeakMap,nf=new WeakMap,sf=new WeakMap,UV),Fr,Rt,jg,mr,Hu,rf,ql,Xl,Bg,of,af,Gu,Ku,Yl,lf,qu,nm,Wg,pN,Ug,mN,Hg,gN,Gg,yN,Kg,xN,qg,vN,Xg,bN,Nw,$4,HV,FJ=(HV=class extends Kf{constructor(e,n){super();Ue(this,qu);Ue(this,Wg);Ue(this,Ug);Ue(this,Hg);Ue(this,Gg);Ue(this,Kg);Ue(this,qg);Ue(this,Xg);Ue(this,Nw);Ue(this,Fr,void 0);Ue(this,Rt,void 0);Ue(this,jg,void 0);Ue(this,mr,void 0);Ue(this,Hu,void 0);Ue(this,rf,void 0);Ue(this,ql,void 0);Ue(this,Xl,void 0);Ue(this,Bg,void 0);Ue(this,of,void 0);Ue(this,af,void 0);Ue(this,Gu,void 0);Ue(this,Ku,void 0);Ue(this,Yl,void 0);Ue(this,lf,new Set);this.options=n,Pe(this,Fr,e),Pe(this,Xl,null),Pe(this,ql,fN()),this.options.experimental_prefetchInRender||J(this,ql).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),this.bindMethods(),this.setOptions(n)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(J(this,Rt).addObserver(this),EP(J(this,Rt),this.options)?vt(this,qu,nm).call(this):this.updateResult(),vt(this,Gg,yN).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return wN(J(this,Rt),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return wN(J(this,Rt),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,vt(this,Kg,xN).call(this),vt(this,qg,vN).call(this),J(this,Rt).removeObserver(this)}setOptions(e){const n=this.options,s=J(this,Rt);if(this.options=J(this,Fr).defaultQueryOptions(e),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof Hi(this.options.enabled,J(this,Rt))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");vt(this,Xg,bN).call(this),J(this,Rt).setOptions(this.options),n._defaulted&&!cb(this.options,n)&&J(this,Fr).getQueryCache().notify({type:"observerOptionsUpdated",query:J(this,Rt),observer:this});const r=this.hasListeners();r&&$P(J(this,Rt),s,this.options,n)&&vt(this,qu,nm).call(this),this.updateResult(),r&&(J(this,Rt)!==s||Hi(this.options.enabled,J(this,Rt))!==Hi(n.enabled,J(this,Rt))||yc(this.options.staleTime,J(this,Rt))!==yc(n.staleTime,J(this,Rt)))&&vt(this,Wg,pN).call(this);const i=vt(this,Ug,mN).call(this);r&&(J(this,Rt)!==s||Hi(this.options.enabled,J(this,Rt))!==Hi(n.enabled,J(this,Rt))||i!==J(this,Yl))&&vt(this,Hg,gN).call(this,i)}getOptimisticResult(e){const n=J(this,Fr).getQueryCache().build(J(this,Fr),e),s=this.createResult(n,e);return MJ(this,s)&&(Pe(this,mr,s),Pe(this,rf,this.options),Pe(this,Hu,J(this,Rt).state)),s}getCurrentResult(){return J(this,mr)}trackResult(e,n){return new Proxy(e,{get:(s,r)=>(this.trackProp(r),n==null||n(r),Reflect.get(s,r))})}trackProp(e){J(this,lf).add(e)}getCurrentQuery(){return J(this,Rt)}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){const n=J(this,Fr).defaultQueryOptions(e),s=J(this,Fr).getQueryCache().build(J(this,Fr),n);return s.fetch().then(()=>this.createResult(s,n))}fetch(e){return vt(this,qu,nm).call(this,{...e,cancelRefetch:e.cancelRefetch??!0}).then(()=>(this.updateResult(),J(this,mr)))}createResult(e,n){var $;const s=J(this,Rt),r=this.options,i=J(this,mr),o=J(this,Hu),a=J(this,rf),c=e!==s?e.state:J(this,jg),{state:u}=e;let d={...u},h=!1,f;if(n._optimisticResults){const A=this.hasListeners(),P=!A&&EP(e,n),F=A&&$P(e,s,n,r);(P||F)&&(d={...d,..._4(u.data,e.options)}),n._optimisticResults==="isRestoring"&&(d.fetchStatus="idle")}let{error:p,errorUpdatedAt:m,status:g}=d;f=d.data;let y=!1;if(n.placeholderData!==void 0&&f===void 0&&g==="pending"){let A;i!=null&&i.isPlaceholderData&&n.placeholderData===(a==null?void 0:a.placeholderData)?(A=i.data,y=!0):A=typeof n.placeholderData=="function"?n.placeholderData(($=J(this,af))==null?void 0:$.state.data,J(this,af)):n.placeholderData,A!==void 0&&(g="success",f=hN(i==null?void 0:i.data,A,n),h=!0)}if(n.select&&f!==void 0&&!y)if(i&&f===(o==null?void 0:o.data)&&n.select===J(this,Bg))f=J(this,of);else try{Pe(this,Bg,n.select),f=n.select(f),f=hN(i==null?void 0:i.data,f,n),Pe(this,of,f),Pe(this,Xl,null)}catch(A){Pe(this,Xl,A)}J(this,Xl)&&(p=J(this,Xl),f=J(this,of),m=Date.now(),g="error");const x=d.fetchStatus==="fetching",v=g==="pending",b=g==="error",k=v&&x,C=f!==void 0,I={status:g,fetchStatus:d.fetchStatus,isPending:v,isSuccess:g==="success",isError:b,isInitialLoading:k,isLoading:k,data:f,dataUpdatedAt:d.dataUpdatedAt,error:p,errorUpdatedAt:m,failureCount:d.fetchFailureCount,failureReason:d.fetchFailureReason,errorUpdateCount:d.errorUpdateCount,isFetched:d.dataUpdateCount>0||d.errorUpdateCount>0,isFetchedAfterMount:d.dataUpdateCount>c.dataUpdateCount||d.errorUpdateCount>c.errorUpdateCount,isFetching:x,isRefetching:x&&!v,isLoadingError:b&&!C,isPaused:d.fetchStatus==="paused",isPlaceholderData:h,isRefetchError:b&&C,isStale:E_(e,n),refetch:this.refetch,promise:J(this,ql),isEnabled:Hi(n.enabled,e)!==!1};if(this.options.experimental_prefetchInRender){const A=V=>{I.status==="error"?V.reject(I.error):I.data!==void 0&&V.resolve(I.data)},P=()=>{const V=Pe(this,ql,I.promise=fN());A(V)},F=J(this,ql);switch(F.status){case"pending":e.queryHash===s.queryHash&&A(F);break;case"fulfilled":(I.status==="error"||I.data!==F.value)&&P();break;case"rejected":(I.status!=="error"||I.error!==F.reason)&&P();break}}return I}updateResult(){const e=J(this,mr),n=this.createResult(J(this,Rt),this.options);if(Pe(this,Hu,J(this,Rt).state),Pe(this,rf,this.options),J(this,Hu).data!==void 0&&Pe(this,af,J(this,Rt)),cb(n,e))return;Pe(this,mr,n);const s=()=>{if(!e)return!0;const{notifyOnChangeProps:r}=this.options,i=typeof r=="function"?r():r;if(i==="all"||!i&&!J(this,lf).size)return!0;const o=new Set(i??J(this,lf));return this.options.throwOnError&&o.add("error"),Object.keys(J(this,mr)).some(a=>{const l=a;return J(this,mr)[l]!==e[l]&&o.has(l)})};vt(this,Nw,$4).call(this,{listeners:s()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&vt(this,Gg,yN).call(this)}},Fr=new WeakMap,Rt=new WeakMap,jg=new WeakMap,mr=new WeakMap,Hu=new WeakMap,rf=new WeakMap,ql=new WeakMap,Xl=new WeakMap,Bg=new WeakMap,of=new WeakMap,af=new WeakMap,Gu=new WeakMap,Ku=new WeakMap,Yl=new WeakMap,lf=new WeakMap,qu=new WeakSet,nm=function(e){vt(this,Xg,bN).call(this);let n=J(this,Rt).fetch(this.options,e);return e!=null&&e.throwOnError||(n=n.catch(yr)),n},Wg=new WeakSet,pN=function(){vt(this,Kg,xN).call(this);const e=yc(this.options.staleTime,J(this,Rt));if(dd||J(this,mr).isStale||!uN(e))return;const s=b4(J(this,mr).dataUpdatedAt,e)+1;Pe(this,Gu,setTimeout(()=>{J(this,mr).isStale||this.updateResult()},s))},Ug=new WeakSet,mN=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(J(this,Rt)):this.options.refetchInterval)??!1},Hg=new WeakSet,gN=function(e){vt(this,qg,vN).call(this),Pe(this,Yl,e),!(dd||Hi(this.options.enabled,J(this,Rt))===!1||!uN(J(this,Yl))||J(this,Yl)===0)&&Pe(this,Ku,setInterval(()=>{(this.options.refetchIntervalInBackground||__.isFocused())&&vt(this,qu,nm).call(this)},J(this,Yl)))},Gg=new WeakSet,yN=function(){vt(this,Wg,pN).call(this),vt(this,Hg,gN).call(this,vt(this,Ug,mN).call(this))},Kg=new WeakSet,xN=function(){J(this,Gu)&&(clearTimeout(J(this,Gu)),Pe(this,Gu,void 0))},qg=new WeakSet,vN=function(){J(this,Ku)&&(clearInterval(J(this,Ku)),Pe(this,Ku,void 0))},Xg=new WeakSet,bN=function(){const e=J(this,Fr).getQueryCache().build(J(this,Fr),this.options);if(e===J(this,Rt))return;const n=J(this,Rt);Pe(this,Rt,e),Pe(this,jg,e.state),this.hasListeners()&&(n==null||n.removeObserver(this),e.addObserver(this))},Nw=new WeakSet,$4=function(e){xs.batch(()=>{e.listeners&&this.listeners.forEach(n=>{n(J(this,mr))}),J(this,Fr).getQueryCache().notify({query:J(this,Rt),type:"observerResultsUpdated"})})},HV);function LJ(t,e){return Hi(e.enabled,t)!==!1&&t.state.data===void 0&&!(t.state.status==="error"&&e.retryOnMount===!1)}function EP(t,e){return LJ(t,e)||t.state.data!==void 0&&wN(t,e,e.refetchOnMount)}function wN(t,e,n){if(Hi(e.enabled,t)!==!1&&yc(e.staleTime,t)!=="static"){const s=typeof n=="function"?n(t):n;return s==="always"||s!==!1&&E_(t,e)}return!1}function $P(t,e,n,s){return(t!==e||Hi(s.enabled,t)===!1)&&(!n.suspense||t.state.status!=="error")&&E_(t,n)}function E_(t,e){return Hi(e.enabled,t)!==!1&&t.isStaleByTime(yc(e.staleTime,t))}function MJ(t,e){return!cb(t.getCurrentResult(),e)}var Zl,Ql,Lr,Za,cf,yv,Yg,SN,GV,zJ=(GV=class extends Kf{constructor(n,s){super();Ue(this,cf);Ue(this,Yg);Ue(this,Zl,void 0);Ue(this,Ql,void 0);Ue(this,Lr,void 0);Ue(this,Za,void 0);Pe(this,Zl,n),this.setOptions(s),this.bindMethods(),vt(this,cf,yv).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(n){var r;const s=this.options;this.options=J(this,Zl).defaultMutationOptions(n),cb(this.options,s)||J(this,Zl).getMutationCache().notify({type:"observerOptionsUpdated",mutation:J(this,Lr),observer:this}),s!=null&&s.mutationKey&&this.options.mutationKey&&hd(s.mutationKey)!==hd(this.options.mutationKey)?this.reset():((r=J(this,Lr))==null?void 0:r.state.status)==="pending"&&J(this,Lr).setOptions(this.options)}onUnsubscribe(){var n;this.hasListeners()||(n=J(this,Lr))==null||n.removeObserver(this)}onMutationUpdate(n){vt(this,cf,yv).call(this),vt(this,Yg,SN).call(this,n)}getCurrentResult(){return J(this,Ql)}reset(){var n;(n=J(this,Lr))==null||n.removeObserver(this),Pe(this,Lr,void 0),vt(this,cf,yv).call(this),vt(this,Yg,SN).call(this)}mutate(n,s){var r;return Pe(this,Za,s),(r=J(this,Lr))==null||r.removeObserver(this),Pe(this,Lr,J(this,Zl).getMutationCache().build(J(this,Zl),this.options)),J(this,Lr).addObserver(this),J(this,Lr).execute(n)}},Zl=new WeakMap,Ql=new WeakMap,Lr=new WeakMap,Za=new WeakMap,cf=new WeakSet,yv=function(){var s;const n=((s=J(this,Lr))==null?void 0:s.state)??E4();Pe(this,Ql,{...n,isPending:n.status==="pending",isSuccess:n.status==="success",isError:n.status==="error",isIdle:n.status==="idle",mutate:this.mutate,reset:this.reset})},Yg=new WeakSet,SN=function(n){xs.batch(()=>{var s,r,i,o,a,l,c,u;if(J(this,Za)&&this.hasListeners()){const d=J(this,Ql).variables,h=J(this,Ql).context;(n==null?void 0:n.type)==="success"?((r=(s=J(this,Za)).onSuccess)==null||r.call(s,n.data,d,h),(o=(i=J(this,Za)).onSettled)==null||o.call(i,n.data,null,d,h)):(n==null?void 0:n.type)==="error"&&((l=(a=J(this,Za)).onError)==null||l.call(a,n.error,d,h),(u=(c=J(this,Za)).onSettled)==null||u.call(c,void 0,n.error,d,h))}this.listeners.forEach(d=>{d(J(this,Ql))})})},GV),A4=D.createContext(void 0),R4=t=>{const e=D.useContext(A4);if(t)return t;if(!e)throw new Error("No QueryClient set, use QueryClientProvider to set one");return e},D4=({client:t,children:e})=>(D.useEffect(()=>(t.mount(),()=>{t.unmount()}),[t]),S.jsx(A4.Provider,{value:t,children:e})),O4=D.createContext(!1),VJ=()=>D.useContext(O4);O4.Provider;function jJ(){let t=!1;return{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t}}var BJ=D.createContext(jJ()),WJ=()=>D.useContext(BJ),UJ=(t,e)=>{(t.suspense||t.throwOnError||t.experimental_prefetchInRender)&&(e.isReset()||(t.retryOnMount=!1))},HJ=t=>{D.useEffect(()=>{t.clearReset()},[t])},GJ=({result:t,errorResetBoundary:e,throwOnError:n,query:s,suspense:r})=>t.isError&&!e.isReset()&&!t.isFetching&&s&&(r&&t.data===void 0||k4(n,[t.error,s])),KJ=t=>{if(t.suspense){const e=s=>s==="static"?s:Math.max(s??1e3,1e3),n=t.staleTime;t.staleTime=typeof n=="function"?(...s)=>e(n(...s)):e(n),typeof t.gcTime=="number"&&(t.gcTime=Math.max(t.gcTime,1e3))}},qJ=(t,e)=>t.isLoading&&t.isFetching&&!e,XJ=(t,e)=>(t==null?void 0:t.suspense)&&e.isPending,AP=(t,e,n)=>e.fetchOptimistic(t).catch(()=>{n.clearReset()});function YJ(t,e,n){var d,h,f,p,m;const s=VJ(),r=WJ(),i=R4(n),o=i.defaultQueryOptions(t);(h=(d=i.getDefaultOptions().queries)==null?void 0:d._experimental_beforeQuery)==null||h.call(d,o),o._optimisticResults=s?"isRestoring":"optimistic",KJ(o),UJ(o,r),HJ(r);const a=!i.getQueryCache().get(o.queryHash),[l]=D.useState(()=>new e(i,o)),c=l.getOptimisticResult(o),u=!s&&t.subscribed!==!1;if(D.useSyncExternalStore(D.useCallback(g=>{const y=u?l.subscribe(xs.batchCalls(g)):yr;return l.updateResult(),y},[l,u]),()=>l.getCurrentResult(),()=>l.getCurrentResult()),D.useEffect(()=>{l.setOptions(o)},[o,l]),XJ(o,c))throw AP(o,l,r);if(GJ({result:c,errorResetBoundary:r,throwOnError:o.throwOnError,query:i.getQueryCache().get(o.queryHash),suspense:o.suspense}))throw c.error;if((p=(f=i.getDefaultOptions().queries)==null?void 0:f._experimental_afterQuery)==null||p.call(f,o,c),o.experimental_prefetchInRender&&!dd&&qJ(c,s)){const g=a?AP(o,l,r):(m=i.getQueryCache().get(o.queryHash))==null?void 0:m.promise;g==null||g.catch(yr).finally(()=>{l.updateResult()})}return o.notifyOnChangeProps?c:l.trackResult(c)}function Zu(t,e){return YJ(t,FJ,e)}function db(t,e){const n=R4(e),[s]=D.useState(()=>new zJ(n,t));D.useEffect(()=>{s.setOptions(t)},[s,t]);const r=D.useSyncExternalStore(D.useCallback(o=>s.subscribe(xs.batchCalls(o)),[s]),()=>s.getCurrentResult(),()=>s.getCurrentResult()),i=D.useCallback((o,a)=>{s.mutate(o,a).catch(yr)},[s]);if(r.error&&k4(s.options.throwOnError,[r.error]))throw r.error;return{...r,mutate:i,mutateAsync:r.mutate}}async function ZJ(t){if(!t.ok){const e=await t.text()||t.statusText;throw new Error(`${t.status}: ${e}`)}}const QJ=({on401:t})=>async({queryKey:e})=>{const n=await fetch(e.join("/"),{credentials:"include"});return t==="returnNull"&&n.status===401?null:(await ZJ(n),await n.json())},$_=new PJ({defaultOptions:{queries:{queryFn:QJ({on401:"throw"}),refetchInterval:!1,refetchOnWindowFocus:!1,staleTime:1/0,retry:!1},mutations:{retry:!1}}}),JJ=1,eee=1e6;let nC=0;function tee(){return nC=(nC+1)%Number.MAX_SAFE_INTEGER,nC.toString()}const sC=new Map,RP=t=>{if(sC.has(t))return;const e=setTimeout(()=>{sC.delete(t),Rm({type:"REMOVE_TOAST",toastId:t})},eee);sC.set(t,e)},nee=(t,e)=>{switch(e.type){case"ADD_TOAST":return{...t,toasts:[e.toast,...t.toasts].slice(0,JJ)};case"UPDATE_TOAST":return{...t,toasts:t.toasts.map(n=>n.id===e.toast.id?{...n,...e.toast}:n)};case"DISMISS_TOAST":{const{toastId:n}=e;return n?RP(n):t.toasts.forEach(s=>{RP(s.id)}),{...t,toasts:t.toasts.map(s=>s.id===n||n===void 0?{...s,open:!1}:s)}}case"REMOVE_TOAST":return e.toastId===void 0?{...t,toasts:[]}:{...t,toasts:t.toasts.filter(n=>n.id!==e.toastId)}}},xv=[];let vv={toasts:[]};function Rm(t){vv=nee(vv,t),xv.forEach(e=>{e(vv)})}function see({...t}){const e=tee(),n=r=>Rm({type:"UPDATE_TOAST",toast:{...r,id:e}}),s=()=>Rm({type:"DISMISS_TOAST",toastId:e});return Rm({type:"ADD_TOAST",toast:{...t,id:e,open:!0,onOpenChange:r=>{r||s()}}}),{id:e,dismiss:s,update:n}}function Hw(){const[t,e]=D.useState(vv);return D.useEffect(()=>(xv.push(e),()=>{const n=xv.indexOf(e);n>-1&&xv.splice(n,1)}),[t]),{...t,toast:see,dismiss:n=>Rm({type:"DISMISS_TOAST",toastId:n})}}function Zn(t,e,{checkForDefaultPrevented:n=!0}={}){return function(r){if(t==null||t(r),n===!1||!r.defaultPrevented)return e==null?void 0:e(r)}}function DP(t,e){if(typeof t=="function")return t(e);t!=null&&(t.current=e)}function P4(...t){return e=>{let n=!1;const s=t.map(r=>{const i=DP(r,e);return!n&&typeof i=="function"&&(n=!0),i});if(n)return()=>{for(let r=0;r<s.length;r++){const i=s[r];typeof i=="function"?i():DP(t[r],null)}}}}function Si(...t){return D.useCallback(P4(...t),t)}function ry(t,e=[]){let n=[];function s(i,o){const a=D.createContext(o),l=n.length;n=[...n,o];const c=d=>{var y;const{scope:h,children:f,...p}=d,m=((y=h==null?void 0:h[t])==null?void 0:y[l])||a,g=D.useMemo(()=>p,Object.values(p));return S.jsx(m.Provider,{value:g,children:f})};c.displayName=i+"Provider";function u(d,h){var m;const f=((m=h==null?void 0:h[t])==null?void 0:m[l])||a,p=D.useContext(f);if(p)return p;if(o!==void 0)return o;throw new Error(`\`${d}\` must be used within \`${i}\``)}return[c,u]}const r=()=>{const i=n.map(o=>D.createContext(o));return function(a){const l=(a==null?void 0:a[t])||i;return D.useMemo(()=>({[`__scope${t}`]:{...a,[t]:l}}),[a,l])}};return r.scopeName=t,[s,ree(r,...e)]}function ree(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const s=t.map(r=>({useScope:r(),scopeName:r.scopeName}));return function(i){const o=s.reduce((a,{useScope:l,scopeName:c})=>{const d=l(i)[`__scope${c}`];return{...a,...d}},{});return D.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return n.scopeName=e.scopeName,n}function hb(t){const e=iee(t),n=D.forwardRef((s,r)=>{const{children:i,...o}=s,a=D.Children.toArray(i),l=a.find(aee);if(l){const c=l.props.children,u=a.map(d=>d===l?D.Children.count(c)>1?D.Children.only(null):D.isValidElement(c)?c.props.children:null:d);return S.jsx(e,{...o,ref:r,children:D.isValidElement(c)?D.cloneElement(c,void 0,u):null})}return S.jsx(e,{...o,ref:r,children:i})});return n.displayName=`${t}.Slot`,n}var F4=hb("Slot");function iee(t){const e=D.forwardRef((n,s)=>{const{children:r,...i}=n;if(D.isValidElement(r)){const o=cee(r),a=lee(i,r.props);return r.type!==D.Fragment&&(a.ref=s?P4(s,o):o),D.cloneElement(r,a)}return D.Children.count(r)>1?D.Children.only(null):null});return e.displayName=`${t}.SlotClone`,e}var L4=Symbol("radix.slottable");function oee(t){const e=({children:n})=>S.jsx(S.Fragment,{children:n});return e.displayName=`${t}.Slottable`,e.__radixId=L4,e}function aee(t){return D.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===L4}function lee(t,e){const n={...e};for(const s in e){const r=t[s],i=e[s];/^on[A-Z]/.test(s)?r&&i?n[s]=(...a)=>{const l=i(...a);return r(...a),l}:r&&(n[s]=r):s==="style"?n[s]={...r,...i}:s==="className"&&(n[s]=[r,i].filter(Boolean).join(" "))}return{...t,...n}}function cee(t){var s,r;let e=(s=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:s.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(r=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}function uee(t){const e=t+"CollectionProvider",[n,s]=ry(e),[r,i]=n(e,{collectionRef:{current:null},itemMap:new Map}),o=m=>{const{scope:g,children:y}=m,x=et.useRef(null),v=et.useRef(new Map).current;return S.jsx(r,{scope:g,itemMap:v,collectionRef:x,children:y})};o.displayName=e;const a=t+"CollectionSlot",l=hb(a),c=et.forwardRef((m,g)=>{const{scope:y,children:x}=m,v=i(a,y),b=Si(g,v.collectionRef);return S.jsx(l,{ref:b,children:x})});c.displayName=a;const u=t+"CollectionItemSlot",d="data-radix-collection-item",h=hb(u),f=et.forwardRef((m,g)=>{const{scope:y,children:x,...v}=m,b=et.useRef(null),k=Si(g,b),C=i(u,y);return et.useEffect(()=>(C.itemMap.set(b,{ref:b,...v}),()=>void C.itemMap.delete(b))),S.jsx(h,{[d]:"",ref:k,children:x})});f.displayName=u;function p(m){const g=i(t+"CollectionConsumer",m);return et.useCallback(()=>{const x=g.collectionRef.current;if(!x)return[];const v=Array.from(x.querySelectorAll(`[${d}]`));return Array.from(g.itemMap.values()).sort((C,N)=>v.indexOf(C.ref.current)-v.indexOf(N.ref.current))},[g.collectionRef,g.itemMap])}return[{Provider:o,Slot:c,ItemSlot:f},p,s]}var dee=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Ls=dee.reduce((t,e)=>{const n=hb(`Primitive.${e}`),s=D.forwardRef((r,i)=>{const{asChild:o,...a}=r,l=o?n:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),S.jsx(l,{...a,ref:i})});return s.displayName=`Primitive.${e}`,{...t,[e]:s}},{});function M4(t,e){t&&ny.flushSync(()=>t.dispatchEvent(e))}function $c(t){const e=D.useRef(t);return D.useEffect(()=>{e.current=t}),D.useMemo(()=>(...n)=>{var s;return(s=e.current)==null?void 0:s.call(e,...n)},[])}function hee(t,e=globalThis==null?void 0:globalThis.document){const n=$c(t);D.useEffect(()=>{const s=r=>{r.key==="Escape"&&n(r)};return e.addEventListener("keydown",s,{capture:!0}),()=>e.removeEventListener("keydown",s,{capture:!0})},[n,e])}var fee="DismissableLayer",kN="dismissableLayer.update",pee="dismissableLayer.pointerDownOutside",mee="dismissableLayer.focusOutside",OP,z4=D.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),A_=D.forwardRef((t,e)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:s,onPointerDownOutside:r,onFocusOutside:i,onInteractOutside:o,onDismiss:a,...l}=t,c=D.useContext(z4),[u,d]=D.useState(null),h=(u==null?void 0:u.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,f]=D.useState({}),p=Si(e,N=>d(N)),m=Array.from(c.layers),[g]=[...c.layersWithOutsidePointerEventsDisabled].slice(-1),y=m.indexOf(g),x=u?m.indexOf(u):-1,v=c.layersWithOutsidePointerEventsDisabled.size>0,b=x>=y,k=yee(N=>{const I=N.target,$=[...c.branches].some(A=>A.contains(I));!b||$||(r==null||r(N),o==null||o(N),N.defaultPrevented||a==null||a())},h),C=xee(N=>{const I=N.target;[...c.branches].some(A=>A.contains(I))||(i==null||i(N),o==null||o(N),N.defaultPrevented||a==null||a())},h);return hee(N=>{x===c.layers.size-1&&(s==null||s(N),!N.defaultPrevented&&a&&(N.preventDefault(),a()))},h),D.useEffect(()=>{if(u)return n&&(c.layersWithOutsidePointerEventsDisabled.size===0&&(OP=h.body.style.pointerEvents,h.body.style.pointerEvents="none"),c.layersWithOutsidePointerEventsDisabled.add(u)),c.layers.add(u),PP(),()=>{n&&c.layersWithOutsidePointerEventsDisabled.size===1&&(h.body.style.pointerEvents=OP)}},[u,h,n,c]),D.useEffect(()=>()=>{u&&(c.layers.delete(u),c.layersWithOutsidePointerEventsDisabled.delete(u),PP())},[u,c]),D.useEffect(()=>{const N=()=>f({});return document.addEventListener(kN,N),()=>document.removeEventListener(kN,N)},[]),S.jsx(Ls.div,{...l,ref:p,style:{pointerEvents:v?b?"auto":"none":void 0,...t.style},onFocusCapture:Zn(t.onFocusCapture,C.onFocusCapture),onBlurCapture:Zn(t.onBlurCapture,C.onBlurCapture),onPointerDownCapture:Zn(t.onPointerDownCapture,k.onPointerDownCapture)})});A_.displayName=fee;var gee="DismissableLayerBranch",V4=D.forwardRef((t,e)=>{const n=D.useContext(z4),s=D.useRef(null),r=Si(e,s);return D.useEffect(()=>{const i=s.current;if(i)return n.branches.add(i),()=>{n.branches.delete(i)}},[n.branches]),S.jsx(Ls.div,{...t,ref:r})});V4.displayName=gee;function yee(t,e=globalThis==null?void 0:globalThis.document){const n=$c(t),s=D.useRef(!1),r=D.useRef(()=>{});return D.useEffect(()=>{const i=a=>{if(a.target&&!s.current){let l=function(){j4(pee,n,c,{discrete:!0})};const c={originalEvent:a};a.pointerType==="touch"?(e.removeEventListener("click",r.current),r.current=l,e.addEventListener("click",r.current,{once:!0})):l()}else e.removeEventListener("click",r.current);s.current=!1},o=window.setTimeout(()=>{e.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(o),e.removeEventListener("pointerdown",i),e.removeEventListener("click",r.current)}},[e,n]),{onPointerDownCapture:()=>s.current=!0}}function xee(t,e=globalThis==null?void 0:globalThis.document){const n=$c(t),s=D.useRef(!1);return D.useEffect(()=>{const r=i=>{i.target&&!s.current&&j4(mee,n,{originalEvent:i},{discrete:!1})};return e.addEventListener("focusin",r),()=>e.removeEventListener("focusin",r)},[e,n]),{onFocusCapture:()=>s.current=!0,onBlurCapture:()=>s.current=!1}}function PP(){const t=new CustomEvent(kN);document.dispatchEvent(t)}function j4(t,e,n,{discrete:s}){const r=n.originalEvent.target,i=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:n});e&&r.addEventListener(t,e,{once:!0}),s?M4(r,i):r.dispatchEvent(i)}var vee=A_,bee=V4,Ac=globalThis!=null&&globalThis.document?D.useLayoutEffect:()=>{},wee="Portal",B4=D.forwardRef((t,e)=>{var a;const{container:n,...s}=t,[r,i]=D.useState(!1);Ac(()=>i(!0),[]);const o=n||r&&((a=globalThis==null?void 0:globalThis.document)==null?void 0:a.body);return o?UQ.createPortal(S.jsx(Ls.div,{...s,ref:e}),o):null});B4.displayName=wee;function See(t,e){return D.useReducer((n,s)=>e[n][s]??n,t)}var Gw=t=>{const{present:e,children:n}=t,s=kee(e),r=typeof n=="function"?n({present:s.isPresent}):D.Children.only(n),i=Si(s.ref,Cee(r));return typeof n=="function"||s.isPresent?D.cloneElement(r,{ref:i}):null};Gw.displayName="Presence";function kee(t){const[e,n]=D.useState(),s=D.useRef(null),r=D.useRef(t),i=D.useRef("none"),o=t?"mounted":"unmounted",[a,l]=See(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return D.useEffect(()=>{const c=vx(s.current);i.current=a==="mounted"?c:"none"},[a]),Ac(()=>{const c=s.current,u=r.current;if(u!==t){const h=i.current,f=vx(c);t?l("MOUNT"):f==="none"||(c==null?void 0:c.display)==="none"?l("UNMOUNT"):l(u&&h!==f?"ANIMATION_OUT":"UNMOUNT"),r.current=t}},[t,l]),Ac(()=>{if(e){let c;const u=e.ownerDocument.defaultView??window,d=f=>{const m=vx(s.current).includes(CSS.escape(f.animationName));if(f.target===e&&m&&(l("ANIMATION_END"),!r.current)){const g=e.style.animationFillMode;e.style.animationFillMode="forwards",c=u.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=g)})}},h=f=>{f.target===e&&(i.current=vx(s.current))};return e.addEventListener("animationstart",h),e.addEventListener("animationcancel",d),e.addEventListener("animationend",d),()=>{u.clearTimeout(c),e.removeEventListener("animationstart",h),e.removeEventListener("animationcancel",d),e.removeEventListener("animationend",d)}}else l("ANIMATION_END")},[e,l]),{isPresent:["mounted","unmountSuspended"].includes(a),ref:D.useCallback(c=>{s.current=c?getComputedStyle(c):null,n(c)},[])}}function vx(t){return(t==null?void 0:t.animationName)||"none"}function Cee(t){var s,r;let e=(s=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:s.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(r=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}var Tee=rj[" useInsertionEffect ".trim().toString()]||Ac;function W4({prop:t,defaultProp:e,onChange:n=()=>{},caller:s}){const[r,i,o]=Nee({defaultProp:e,onChange:n}),a=t!==void 0,l=a?t:r;{const u=D.useRef(t!==void 0);D.useEffect(()=>{const d=u.current;d!==a&&console.warn(`${s} is changing from ${d?"controlled":"uncontrolled"} to ${a?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),u.current=a},[a,s])}const c=D.useCallback(u=>{var d;if(a){const h=Iee(u)?u(t):u;h!==t&&((d=o.current)==null||d.call(o,h))}else i(u)},[a,t,i,o]);return[l,c]}function Nee({defaultProp:t,onChange:e}){const[n,s]=D.useState(t),r=D.useRef(n),i=D.useRef(e);return Tee(()=>{i.current=e},[e]),D.useEffect(()=>{var o;r.current!==n&&((o=i.current)==null||o.call(i,n),r.current=n)},[n,r]),[n,s,i]}function Iee(t){return typeof t=="function"}var _ee=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),Eee="VisuallyHidden",Kw=D.forwardRef((t,e)=>S.jsx(Ls.span,{...t,ref:e,style:{..._ee,...t.style}}));Kw.displayName=Eee;var $ee=Kw,R_="ToastProvider",[D_,Aee,Ree]=uee("Toast"),[U4,HWe]=ry("Toast",[Ree]),[Dee,qw]=U4(R_),H4=t=>{const{__scopeToast:e,label:n="Notification",duration:s=5e3,swipeDirection:r="right",swipeThreshold:i=50,children:o}=t,[a,l]=D.useState(null),[c,u]=D.useState(0),d=D.useRef(!1),h=D.useRef(!1);return n.trim()||console.error(`Invalid prop \`label\` supplied to \`${R_}\`. Expected non-empty \`string\`.`),S.jsx(D_.Provider,{scope:e,children:S.jsx(Dee,{scope:e,label:n,duration:s,swipeDirection:r,swipeThreshold:i,toastCount:c,viewport:a,onViewportChange:l,onToastAdd:D.useCallback(()=>u(f=>f+1),[]),onToastRemove:D.useCallback(()=>u(f=>f-1),[]),isFocusedToastEscapeKeyDownRef:d,isClosePausedRef:h,children:o})})};H4.displayName=R_;var G4="ToastViewport",Oee=["F8"],CN="toast.viewportPause",TN="toast.viewportResume",K4=D.forwardRef((t,e)=>{const{__scopeToast:n,hotkey:s=Oee,label:r="Notifications ({hotkey})",...i}=t,o=qw(G4,n),a=Aee(n),l=D.useRef(null),c=D.useRef(null),u=D.useRef(null),d=D.useRef(null),h=Si(e,d,o.onViewportChange),f=s.join("+").replace(/Key/g,"").replace(/Digit/g,""),p=o.toastCount>0;D.useEffect(()=>{const g=y=>{var v;s.length!==0&&s.every(b=>y[b]||y.code===b)&&((v=d.current)==null||v.focus())};return document.addEventListener("keydown",g),()=>document.removeEventListener("keydown",g)},[s]),D.useEffect(()=>{const g=l.current,y=d.current;if(p&&g&&y){const x=()=>{if(!o.isClosePausedRef.current){const C=new CustomEvent(CN);y.dispatchEvent(C),o.isClosePausedRef.current=!0}},v=()=>{if(o.isClosePausedRef.current){const C=new CustomEvent(TN);y.dispatchEvent(C),o.isClosePausedRef.current=!1}},b=C=>{!g.contains(C.relatedTarget)&&v()},k=()=>{g.contains(document.activeElement)||v()};return g.addEventListener("focusin",x),g.addEventListener("focusout",b),g.addEventListener("pointermove",x),g.addEventListener("pointerleave",k),window.addEventListener("blur",x),window.addEventListener("focus",v),()=>{g.removeEventListener("focusin",x),g.removeEventListener("focusout",b),g.removeEventListener("pointermove",x),g.removeEventListener("pointerleave",k),window.removeEventListener("blur",x),window.removeEventListener("focus",v)}}},[p,o.isClosePausedRef]);const m=D.useCallback(({tabbingDirection:g})=>{const x=a().map(v=>{const b=v.ref.current,k=[b,...Kee(b)];return g==="forwards"?k:k.reverse()});return(g==="forwards"?x.reverse():x).flat()},[a]);return D.useEffect(()=>{const g=d.current;if(g){const y=x=>{var k,C,N;const v=x.altKey||x.ctrlKey||x.metaKey;if(x.key==="Tab"&&!v){const I=document.activeElement,$=x.shiftKey;if(x.target===g&&$){(k=c.current)==null||k.focus();return}const F=m({tabbingDirection:$?"backwards":"forwards"}),V=F.findIndex(z=>z===I);rC(F.slice(V+1))?x.preventDefault():$?(C=c.current)==null||C.focus():(N=u.current)==null||N.focus()}};return g.addEventListener("keydown",y),()=>g.removeEventListener("keydown",y)}},[a,m]),S.jsxs(bee,{ref:l,role:"region","aria-label":r.replace("{hotkey}",f),tabIndex:-1,style:{pointerEvents:p?void 0:"none"},children:[p&&S.jsx(NN,{ref:c,onFocusFromOutsideViewport:()=>{const g=m({tabbingDirection:"forwards"});rC(g)}}),S.jsx(D_.Slot,{scope:n,children:S.jsx(Ls.ol,{tabIndex:-1,...i,ref:h})}),p&&S.jsx(NN,{ref:u,onFocusFromOutsideViewport:()=>{const g=m({tabbingDirection:"backwards"});rC(g)}})]})});K4.displayName=G4;var q4="ToastFocusProxy",NN=D.forwardRef((t,e)=>{const{__scopeToast:n,onFocusFromOutsideViewport:s,...r}=t,i=qw(q4,n);return S.jsx(Kw,{tabIndex:0,...r,ref:e,style:{position:"fixed"},onFocus:o=>{var c;const a=o.relatedTarget;!((c=i.viewport)!=null&&c.contains(a))&&s()}})});NN.displayName=q4;var iy="Toast",Pee="toast.swipeStart",Fee="toast.swipeMove",Lee="toast.swipeCancel",Mee="toast.swipeEnd",X4=D.forwardRef((t,e)=>{const{forceMount:n,open:s,defaultOpen:r,onOpenChange:i,...o}=t,[a,l]=W4({prop:s,defaultProp:r??!0,onChange:i,caller:iy});return S.jsx(Gw,{present:n||a,children:S.jsx(jee,{open:a,...o,ref:e,onClose:()=>l(!1),onPause:$c(t.onPause),onResume:$c(t.onResume),onSwipeStart:Zn(t.onSwipeStart,c=>{c.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:Zn(t.onSwipeMove,c=>{const{x:u,y:d}=c.detail.delta;c.currentTarget.setAttribute("data-swipe","move"),c.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${u}px`),c.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${d}px`)}),onSwipeCancel:Zn(t.onSwipeCancel,c=>{c.currentTarget.setAttribute("data-swipe","cancel"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),c.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),c.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:Zn(t.onSwipeEnd,c=>{const{x:u,y:d}=c.detail.delta;c.currentTarget.setAttribute("data-swipe","end"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),c.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${u}px`),c.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${d}px`),l(!1)})})})});X4.displayName=iy;var[zee,Vee]=U4(iy,{onClose(){}}),jee=D.forwardRef((t,e)=>{const{__scopeToast:n,type:s="foreground",duration:r,open:i,onClose:o,onEscapeKeyDown:a,onPause:l,onResume:c,onSwipeStart:u,onSwipeMove:d,onSwipeCancel:h,onSwipeEnd:f,...p}=t,m=qw(iy,n),[g,y]=D.useState(null),x=Si(e,z=>y(z)),v=D.useRef(null),b=D.useRef(null),k=r||m.duration,C=D.useRef(0),N=D.useRef(k),I=D.useRef(0),{onToastAdd:$,onToastRemove:A}=m,P=$c(()=>{var B;(g==null?void 0:g.contains(document.activeElement))&&((B=m.viewport)==null||B.focus()),o()}),F=D.useCallback(z=>{!z||z===1/0||(window.clearTimeout(I.current),C.current=new Date().getTime(),I.current=window.setTimeout(P,z))},[P]);D.useEffect(()=>{const z=m.viewport;if(z){const B=()=>{F(N.current),c==null||c()},W=()=>{const q=new Date().getTime()-C.current;N.current=N.current-q,window.clearTimeout(I.current),l==null||l()};return z.addEventListener(CN,W),z.addEventListener(TN,B),()=>{z.removeEventListener(CN,W),z.removeEventListener(TN,B)}}},[m.viewport,k,l,c,F]),D.useEffect(()=>{i&&!m.isClosePausedRef.current&&F(k)},[i,k,m.isClosePausedRef,F]),D.useEffect(()=>($(),()=>A()),[$,A]);const V=D.useMemo(()=>g?nW(g):null,[g]);return m.viewport?S.jsxs(S.Fragment,{children:[V&&S.jsx(Bee,{__scopeToast:n,role:"status","aria-live":s==="foreground"?"assertive":"polite",children:V}),S.jsx(zee,{scope:n,onClose:P,children:ny.createPortal(S.jsx(D_.ItemSlot,{scope:n,children:S.jsx(vee,{asChild:!0,onEscapeKeyDown:Zn(a,()=>{m.isFocusedToastEscapeKeyDownRef.current||P(),m.isFocusedToastEscapeKeyDownRef.current=!1}),children:S.jsx(Ls.li,{tabIndex:0,"data-state":i?"open":"closed","data-swipe-direction":m.swipeDirection,...p,ref:x,style:{userSelect:"none",touchAction:"none",...t.style},onKeyDown:Zn(t.onKeyDown,z=>{z.key==="Escape"&&(a==null||a(z.nativeEvent),z.nativeEvent.defaultPrevented||(m.isFocusedToastEscapeKeyDownRef.current=!0,P()))}),onPointerDown:Zn(t.onPointerDown,z=>{z.button===0&&(v.current={x:z.clientX,y:z.clientY})}),onPointerMove:Zn(t.onPointerMove,z=>{if(!v.current)return;const B=z.clientX-v.current.x,W=z.clientY-v.current.y,q=!!b.current,M=["left","right"].includes(m.swipeDirection),G=["left","up"].includes(m.swipeDirection)?Math.min:Math.max,ne=M?G(0,B):0,ie=M?0:G(0,W),de=z.pointerType==="touch"?10:2,he={x:ne,y:ie},pe={originalEvent:z,delta:he};q?(b.current=he,bx(Fee,d,pe,{discrete:!1})):FP(he,m.swipeDirection,de)?(b.current=he,bx(Pee,u,pe,{discrete:!1}),z.target.setPointerCapture(z.pointerId)):(Math.abs(B)>de||Math.abs(W)>de)&&(v.current=null)}),onPointerUp:Zn(t.onPointerUp,z=>{const B=b.current,W=z.target;if(W.hasPointerCapture(z.pointerId)&&W.releasePointerCapture(z.pointerId),b.current=null,v.current=null,B){const q=z.currentTarget,M={originalEvent:z,delta:B};FP(B,m.swipeDirection,m.swipeThreshold)?bx(Mee,f,M,{discrete:!0}):bx(Lee,h,M,{discrete:!0}),q.addEventListener("click",G=>G.preventDefault(),{once:!0})}})})})}),m.viewport)})]}):null}),Bee=t=>{const{__scopeToast:e,children:n,...s}=t,r=qw(iy,e),[i,o]=D.useState(!1),[a,l]=D.useState(!1);return Hee(()=>o(!0)),D.useEffect(()=>{const c=window.setTimeout(()=>l(!0),1e3);return()=>window.clearTimeout(c)},[]),a?null:S.jsx(B4,{asChild:!0,children:S.jsx(Kw,{...s,children:i&&S.jsxs(S.Fragment,{children:[r.label," ",n]})})})},Wee="ToastTitle",Y4=D.forwardRef((t,e)=>{const{__scopeToast:n,...s}=t;return S.jsx(Ls.div,{...s,ref:e})});Y4.displayName=Wee;var Uee="ToastDescription",Z4=D.forwardRef((t,e)=>{const{__scopeToast:n,...s}=t;return S.jsx(Ls.div,{...s,ref:e})});Z4.displayName=Uee;var Q4="ToastAction",J4=D.forwardRef((t,e)=>{const{altText:n,...s}=t;return n.trim()?S.jsx(tW,{altText:n,asChild:!0,children:S.jsx(O_,{...s,ref:e})}):(console.error(`Invalid prop \`altText\` supplied to \`${Q4}\`. Expected non-empty \`string\`.`),null)});J4.displayName=Q4;var eW="ToastClose",O_=D.forwardRef((t,e)=>{const{__scopeToast:n,...s}=t,r=Vee(eW,n);return S.jsx(tW,{asChild:!0,children:S.jsx(Ls.button,{type:"button",...s,ref:e,onClick:Zn(t.onClick,r.onClose)})})});O_.displayName=eW;var tW=D.forwardRef((t,e)=>{const{__scopeToast:n,altText:s,...r}=t;return S.jsx(Ls.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":s||void 0,...r,ref:e})});function nW(t){const e=[];return Array.from(t.childNodes).forEach(s=>{if(s.nodeType===s.TEXT_NODE&&s.textContent&&e.push(s.textContent),Gee(s)){const r=s.ariaHidden||s.hidden||s.style.display==="none",i=s.dataset.radixToastAnnounceExclude==="";if(!r)if(i){const o=s.dataset.radixToastAnnounceAlt;o&&e.push(o)}else e.push(...nW(s))}}),e}function bx(t,e,n,{discrete:s}){const r=n.originalEvent.currentTarget,i=new CustomEvent(t,{bubbles:!0,cancelable:!0,detail:n});e&&r.addEventListener(t,e,{once:!0}),s?M4(r,i):r.dispatchEvent(i)}var FP=(t,e,n=0)=>{const s=Math.abs(t.x),r=Math.abs(t.y),i=s>r;return e==="left"||e==="right"?i&&s>n:!i&&r>n};function Hee(t=()=>{}){const e=$c(t);Ac(()=>{let n=0,s=0;return n=window.requestAnimationFrame(()=>s=window.requestAnimationFrame(e)),()=>{window.cancelAnimationFrame(n),window.cancelAnimationFrame(s)}},[e])}function Gee(t){return t.nodeType===t.ELEMENT_NODE}function Kee(t){const e=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:s=>{const r=s.tagName==="INPUT"&&s.type==="hidden";return s.disabled||s.hidden||r?NodeFilter.FILTER_SKIP:s.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)e.push(n.currentNode);return e}function rC(t){const e=document.activeElement;return t.some(n=>n===e?!0:(n.focus(),document.activeElement!==e))}var qee=H4,sW=K4,rW=X4,iW=Y4,oW=Z4,aW=J4,lW=O_;function cW(t){var e,n,s="";if(typeof t=="string"||typeof t=="number")s+=t;else if(typeof t=="object")if(Array.isArray(t)){var r=t.length;for(e=0;e<r;e++)t[e]&&(n=cW(t[e]))&&(s&&(s+=" "),s+=n)}else for(n in t)t[n]&&(s&&(s+=" "),s+=n);return s}function qf(){for(var t,e,n=0,s="",r=arguments.length;n<r;n++)(t=arguments[n])&&(e=cW(t))&&(s&&(s+=" "),s+=e);return s}const LP=t=>typeof t=="boolean"?`${t}`:t===0?"0":t,MP=qf,Xw=(t,e)=>n=>{var s;if((e==null?void 0:e.variants)==null)return MP(t,n==null?void 0:n.class,n==null?void 0:n.className);const{variants:r,defaultVariants:i}=e,o=Object.keys(r).map(c=>{const u=n==null?void 0:n[c],d=i==null?void 0:i[c];if(u===null)return null;const h=LP(u)||LP(d);return r[c][h]}),a=n&&Object.entries(n).reduce((c,u)=>{let[d,h]=u;return h===void 0||(c[d]=h),c},{}),l=e==null||(s=e.compoundVariants)===null||s===void 0?void 0:s.reduce((c,u)=>{let{class:d,className:h,...f}=u;return Object.entries(f).every(p=>{let[m,g]=p;return Array.isArray(g)?g.includes({...i,...a}[m]):{...i,...a}[m]===g})?[...c,d,h]:c},[]);return MP(t,o,l,n==null?void 0:n.class,n==null?void 0:n.className)};/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xee=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),uW=(...t)=>t.filter((e,n,s)=>!!e&&s.indexOf(e)===n).join(" ");/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Yee={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zee=D.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:n=2,absoluteStrokeWidth:s,className:r="",children:i,iconNode:o,...a},l)=>D.createElement("svg",{ref:l,...Yee,width:e,height:e,stroke:t,strokeWidth:s?Number(n)*24/Number(e):n,className:uW("lucide",r),...a},[...o.map(([c,u])=>D.createElement(c,u)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rn=(t,e)=>{const n=D.forwardRef(({className:s,...r},i)=>D.createElement(Zee,{ref:i,iconNode:e,className:uW(`lucide-${Xee(t)}`,s),...r}));return n.displayName=`${t}`,n};/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zP=rn("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qee=rn("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jee=rn("CalendarCheck",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"m9 16 2 2 4-4",key:"19s6y9"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ete=rn("CalendarClock",[["path",{d:"M21 7.5V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h3.5",key:"1osxxc"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M3 10h5",key:"r794hk"}],["path",{d:"M17.5 17.5 16 16.3V14",key:"akvzfd"}],["circle",{cx:"16",cy:"16",r:"6",key:"qoo3c4"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tte=rn("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nte=rn("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dW=rn("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ste=rn("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rte=rn("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ite=rn("Leaf",[["path",{d:"M11 20A7 7 0 0 1 9.8 6.1C15.5 5 17 4.48 19 2c1 2 2 4.18 2 8 0 5.5-4.78 10-10 10Z",key:"nnexq3"}],["path",{d:"M2 21c0-3 1.85-5.36 5.08-6C9.5 14.52 12 13 13 12",key:"mt58a7"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ote=rn("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hW=rn("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ate=rn("Pause",[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fW=rn("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VP=rn("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jP=rn("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lte=rn("SkipForward",[["polygon",{points:"5 4 15 12 5 20 5 4",key:"16p6eg"}],["line",{x1:"19",x2:"19",y1:"5",y2:"19",key:"futhcm"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cte=rn("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ute=rn("Sprout",[["path",{d:"M7 20h10",key:"e6iznv"}],["path",{d:"M10 20c5.5-2.5.8-6.4 3-10",key:"161w41"}],["path",{d:"M9.5 9.4c1.1.8 1.8 2.2 2.3 3.7-2 .4-3.5.4-4.8-.3-1.2-.6-2.3-1.9-3-4.2 2.8-.5 4.4 0 5.5.8z",key:"9gtqwd"}],["path",{d:"M14.1 6a7 7 0 0 0-1.1 4c1.9-.1 3.3-.6 4.3-1.4 1-1 1.6-2.3 1.7-4.6-2.7.1-4 1-4.9 2z",key:"bkxnd2"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pW=rn("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dte=rn("Timer",[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hte=rn("TreePine",[["path",{d:"m17 14 3 3.3a1 1 0 0 1-.7 1.7H4.7a1 1 0 0 1-.7-1.7L7 14h-.3a1 1 0 0 1-.7-1.7L9 9h-.2A1 1 0 0 1 8 7.3L12 3l4 4.3a1 1 0 0 1-.8 1.7H15l3 3.3a1 1 0 0 1-.7 1.7H17Z",key:"cpyugq"}],["path",{d:"M12 22v-3",key:"kmzjlo"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fte=rn("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pte=rn("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mte=rn("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P_=rn("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gte=rn("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),F_="-",yte=t=>{const e=vte(t),{conflictingClassGroups:n,conflictingClassGroupModifiers:s}=t;return{getClassGroupId:o=>{const a=o.split(F_);return a[0]===""&&a.length!==1&&a.shift(),mW(a,e)||xte(o)},getConflictingClassGroupIds:(o,a)=>{const l=n[o]||[];return a&&s[o]?[...l,...s[o]]:l}}},mW=(t,e)=>{var o;if(t.length===0)return e.classGroupId;const n=t[0],s=e.nextPart.get(n),r=s?mW(t.slice(1),s):void 0;if(r)return r;if(e.validators.length===0)return;const i=t.join(F_);return(o=e.validators.find(({validator:a})=>a(i)))==null?void 0:o.classGroupId},BP=/^\[(.+)\]$/,xte=t=>{if(BP.test(t)){const e=BP.exec(t)[1],n=e==null?void 0:e.substring(0,e.indexOf(":"));if(n)return"arbitrary.."+n}},vte=t=>{const{theme:e,prefix:n}=t,s={nextPart:new Map,validators:[]};return wte(Object.entries(t.classGroups),n).forEach(([i,o])=>{IN(o,s,i,e)}),s},IN=(t,e,n,s)=>{t.forEach(r=>{if(typeof r=="string"){const i=r===""?e:WP(e,r);i.classGroupId=n;return}if(typeof r=="function"){if(bte(r)){IN(r(s),e,n,s);return}e.validators.push({validator:r,classGroupId:n});return}Object.entries(r).forEach(([i,o])=>{IN(o,WP(e,i),n,s)})})},WP=(t,e)=>{let n=t;return e.split(F_).forEach(s=>{n.nextPart.has(s)||n.nextPart.set(s,{nextPart:new Map,validators:[]}),n=n.nextPart.get(s)}),n},bte=t=>t.isThemeGetter,wte=(t,e)=>e?t.map(([n,s])=>{const r=s.map(i=>typeof i=="string"?e+i:typeof i=="object"?Object.fromEntries(Object.entries(i).map(([o,a])=>[e+o,a])):i);return[n,r]}):t,Ste=t=>{if(t<1)return{get:()=>{},set:()=>{}};let e=0,n=new Map,s=new Map;const r=(i,o)=>{n.set(i,o),e++,e>t&&(e=0,s=n,n=new Map)};return{get(i){let o=n.get(i);if(o!==void 0)return o;if((o=s.get(i))!==void 0)return r(i,o),o},set(i,o){n.has(i)?n.set(i,o):r(i,o)}}},gW="!",kte=t=>{const{separator:e,experimentalParseClassName:n}=t,s=e.length===1,r=e[0],i=e.length,o=a=>{const l=[];let c=0,u=0,d;for(let g=0;g<a.length;g++){let y=a[g];if(c===0){if(y===r&&(s||a.slice(g,g+i)===e)){l.push(a.slice(u,g)),u=g+i;continue}if(y==="/"){d=g;continue}}y==="["?c++:y==="]"&&c--}const h=l.length===0?a:a.substring(u),f=h.startsWith(gW),p=f?h.substring(1):h,m=d&&d>u?d-u:void 0;return{modifiers:l,hasImportantModifier:f,baseClassName:p,maybePostfixModifierPosition:m}};return n?a=>n({className:a,parseClassName:o}):o},Cte=t=>{if(t.length<=1)return t;const e=[];let n=[];return t.forEach(s=>{s[0]==="["?(e.push(...n.sort(),s),n=[]):n.push(s)}),e.push(...n.sort()),e},Tte=t=>({cache:Ste(t.cacheSize),parseClassName:kte(t),...yte(t)}),Nte=/\s+/,Ite=(t,e)=>{const{parseClassName:n,getClassGroupId:s,getConflictingClassGroupIds:r}=e,i=[],o=t.trim().split(Nte);let a="";for(let l=o.length-1;l>=0;l-=1){const c=o[l],{modifiers:u,hasImportantModifier:d,baseClassName:h,maybePostfixModifierPosition:f}=n(c);let p=!!f,m=s(p?h.substring(0,f):h);if(!m){if(!p){a=c+(a.length>0?" "+a:a);continue}if(m=s(h),!m){a=c+(a.length>0?" "+a:a);continue}p=!1}const g=Cte(u).join(":"),y=d?g+gW:g,x=y+m;if(i.includes(x))continue;i.push(x);const v=r(m,p);for(let b=0;b<v.length;++b){const k=v[b];i.push(y+k)}a=c+(a.length>0?" "+a:a)}return a};function _te(){let t=0,e,n,s="";for(;t<arguments.length;)(e=arguments[t++])&&(n=yW(e))&&(s&&(s+=" "),s+=n);return s}const yW=t=>{if(typeof t=="string")return t;let e,n="";for(let s=0;s<t.length;s++)t[s]&&(e=yW(t[s]))&&(n&&(n+=" "),n+=e);return n};function Ete(t,...e){let n,s,r,i=o;function o(l){const c=e.reduce((u,d)=>d(u),t());return n=Tte(c),s=n.cache.get,r=n.cache.set,i=a,a(l)}function a(l){const c=s(l);if(c)return c;const u=Ite(l,n);return r(l,u),u}return function(){return i(_te.apply(null,arguments))}}const mn=t=>{const e=n=>n[t]||[];return e.isThemeGetter=!0,e},xW=/^\[(?:([a-z-]+):)?(.+)\]$/i,$te=/^\d+\/\d+$/,Ate=new Set(["px","full","screen"]),Rte=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,Dte=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,Ote=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,Pte=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,Fte=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Ma=t=>zh(t)||Ate.has(t)||$te.test(t),Al=t=>Xf(t,"length",Ute),zh=t=>!!t&&!Number.isNaN(Number(t)),iC=t=>Xf(t,"number",zh),Fp=t=>!!t&&Number.isInteger(Number(t)),Lte=t=>t.endsWith("%")&&zh(t.slice(0,-1)),xt=t=>xW.test(t),Rl=t=>Rte.test(t),Mte=new Set(["length","size","percentage"]),zte=t=>Xf(t,Mte,vW),Vte=t=>Xf(t,"position",vW),jte=new Set(["image","url"]),Bte=t=>Xf(t,jte,Gte),Wte=t=>Xf(t,"",Hte),Lp=()=>!0,Xf=(t,e,n)=>{const s=xW.exec(t);return s?s[1]?typeof e=="string"?s[1]===e:e.has(s[1]):n(s[2]):!1},Ute=t=>Dte.test(t)&&!Ote.test(t),vW=()=>!1,Hte=t=>Pte.test(t),Gte=t=>Fte.test(t),Kte=()=>{const t=mn("colors"),e=mn("spacing"),n=mn("blur"),s=mn("brightness"),r=mn("borderColor"),i=mn("borderRadius"),o=mn("borderSpacing"),a=mn("borderWidth"),l=mn("contrast"),c=mn("grayscale"),u=mn("hueRotate"),d=mn("invert"),h=mn("gap"),f=mn("gradientColorStops"),p=mn("gradientColorStopPositions"),m=mn("inset"),g=mn("margin"),y=mn("opacity"),x=mn("padding"),v=mn("saturate"),b=mn("scale"),k=mn("sepia"),C=mn("skew"),N=mn("space"),I=mn("translate"),$=()=>["auto","contain","none"],A=()=>["auto","hidden","clip","visible","scroll"],P=()=>["auto",xt,e],F=()=>[xt,e],V=()=>["",Ma,Al],z=()=>["auto",zh,xt],B=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],W=()=>["solid","dashed","dotted","double","none"],q=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],M=()=>["start","end","center","between","around","evenly","stretch"],G=()=>["","0",xt],ne=()=>["auto","avoid","all","avoid-page","page","left","right","column"],ie=()=>[zh,xt];return{cacheSize:500,separator:":",theme:{colors:[Lp],spacing:[Ma,Al],blur:["none","",Rl,xt],brightness:ie(),borderColor:[t],borderRadius:["none","","full",Rl,xt],borderSpacing:F(),borderWidth:V(),contrast:ie(),grayscale:G(),hueRotate:ie(),invert:G(),gap:F(),gradientColorStops:[t],gradientColorStopPositions:[Lte,Al],inset:P(),margin:P(),opacity:ie(),padding:F(),saturate:ie(),scale:ie(),sepia:G(),skew:ie(),space:F(),translate:F()},classGroups:{aspect:[{aspect:["auto","square","video",xt]}],container:["container"],columns:[{columns:[Rl]}],"break-after":[{"break-after":ne()}],"break-before":[{"break-before":ne()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...B(),xt]}],overflow:[{overflow:A()}],"overflow-x":[{"overflow-x":A()}],"overflow-y":[{"overflow-y":A()}],overscroll:[{overscroll:$()}],"overscroll-x":[{"overscroll-x":$()}],"overscroll-y":[{"overscroll-y":$()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[m]}],"inset-x":[{"inset-x":[m]}],"inset-y":[{"inset-y":[m]}],start:[{start:[m]}],end:[{end:[m]}],top:[{top:[m]}],right:[{right:[m]}],bottom:[{bottom:[m]}],left:[{left:[m]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Fp,xt]}],basis:[{basis:P()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",xt]}],grow:[{grow:G()}],shrink:[{shrink:G()}],order:[{order:["first","last","none",Fp,xt]}],"grid-cols":[{"grid-cols":[Lp]}],"col-start-end":[{col:["auto",{span:["full",Fp,xt]},xt]}],"col-start":[{"col-start":z()}],"col-end":[{"col-end":z()}],"grid-rows":[{"grid-rows":[Lp]}],"row-start-end":[{row:["auto",{span:[Fp,xt]},xt]}],"row-start":[{"row-start":z()}],"row-end":[{"row-end":z()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",xt]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",xt]}],gap:[{gap:[h]}],"gap-x":[{"gap-x":[h]}],"gap-y":[{"gap-y":[h]}],"justify-content":[{justify:["normal",...M()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...M(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...M(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[x]}],px:[{px:[x]}],py:[{py:[x]}],ps:[{ps:[x]}],pe:[{pe:[x]}],pt:[{pt:[x]}],pr:[{pr:[x]}],pb:[{pb:[x]}],pl:[{pl:[x]}],m:[{m:[g]}],mx:[{mx:[g]}],my:[{my:[g]}],ms:[{ms:[g]}],me:[{me:[g]}],mt:[{mt:[g]}],mr:[{mr:[g]}],mb:[{mb:[g]}],ml:[{ml:[g]}],"space-x":[{"space-x":[N]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[N]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",xt,e]}],"min-w":[{"min-w":[xt,e,"min","max","fit"]}],"max-w":[{"max-w":[xt,e,"none","full","min","max","fit","prose",{screen:[Rl]},Rl]}],h:[{h:[xt,e,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[xt,e,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[xt,e,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[xt,e,"auto","min","max","fit"]}],"font-size":[{text:["base",Rl,Al]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",iC]}],"font-family":[{font:[Lp]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",xt]}],"line-clamp":[{"line-clamp":["none",zh,iC]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Ma,xt]}],"list-image":[{"list-image":["none",xt]}],"list-style-type":[{list:["none","disc","decimal",xt]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[t]}],"placeholder-opacity":[{"placeholder-opacity":[y]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[t]}],"text-opacity":[{"text-opacity":[y]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...W(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Ma,Al]}],"underline-offset":[{"underline-offset":["auto",Ma,xt]}],"text-decoration-color":[{decoration:[t]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:F()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",xt]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",xt]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[y]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...B(),Vte]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",zte]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},Bte]}],"bg-color":[{bg:[t]}],"gradient-from-pos":[{from:[p]}],"gradient-via-pos":[{via:[p]}],"gradient-to-pos":[{to:[p]}],"gradient-from":[{from:[f]}],"gradient-via":[{via:[f]}],"gradient-to":[{to:[f]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[a]}],"border-w-x":[{"border-x":[a]}],"border-w-y":[{"border-y":[a]}],"border-w-s":[{"border-s":[a]}],"border-w-e":[{"border-e":[a]}],"border-w-t":[{"border-t":[a]}],"border-w-r":[{"border-r":[a]}],"border-w-b":[{"border-b":[a]}],"border-w-l":[{"border-l":[a]}],"border-opacity":[{"border-opacity":[y]}],"border-style":[{border:[...W(),"hidden"]}],"divide-x":[{"divide-x":[a]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[a]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[y]}],"divide-style":[{divide:W()}],"border-color":[{border:[r]}],"border-color-x":[{"border-x":[r]}],"border-color-y":[{"border-y":[r]}],"border-color-s":[{"border-s":[r]}],"border-color-e":[{"border-e":[r]}],"border-color-t":[{"border-t":[r]}],"border-color-r":[{"border-r":[r]}],"border-color-b":[{"border-b":[r]}],"border-color-l":[{"border-l":[r]}],"divide-color":[{divide:[r]}],"outline-style":[{outline:["",...W()]}],"outline-offset":[{"outline-offset":[Ma,xt]}],"outline-w":[{outline:[Ma,Al]}],"outline-color":[{outline:[t]}],"ring-w":[{ring:V()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[t]}],"ring-opacity":[{"ring-opacity":[y]}],"ring-offset-w":[{"ring-offset":[Ma,Al]}],"ring-offset-color":[{"ring-offset":[t]}],shadow:[{shadow:["","inner","none",Rl,Wte]}],"shadow-color":[{shadow:[Lp]}],opacity:[{opacity:[y]}],"mix-blend":[{"mix-blend":[...q(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":q()}],filter:[{filter:["","none"]}],blur:[{blur:[n]}],brightness:[{brightness:[s]}],contrast:[{contrast:[l]}],"drop-shadow":[{"drop-shadow":["","none",Rl,xt]}],grayscale:[{grayscale:[c]}],"hue-rotate":[{"hue-rotate":[u]}],invert:[{invert:[d]}],saturate:[{saturate:[v]}],sepia:[{sepia:[k]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[n]}],"backdrop-brightness":[{"backdrop-brightness":[s]}],"backdrop-contrast":[{"backdrop-contrast":[l]}],"backdrop-grayscale":[{"backdrop-grayscale":[c]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[u]}],"backdrop-invert":[{"backdrop-invert":[d]}],"backdrop-opacity":[{"backdrop-opacity":[y]}],"backdrop-saturate":[{"backdrop-saturate":[v]}],"backdrop-sepia":[{"backdrop-sepia":[k]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[o]}],"border-spacing-x":[{"border-spacing-x":[o]}],"border-spacing-y":[{"border-spacing-y":[o]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",xt]}],duration:[{duration:ie()}],ease:[{ease:["linear","in","out","in-out",xt]}],delay:[{delay:ie()}],animate:[{animate:["none","spin","ping","pulse","bounce",xt]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[b]}],"scale-x":[{"scale-x":[b]}],"scale-y":[{"scale-y":[b]}],rotate:[{rotate:[Fp,xt]}],"translate-x":[{"translate-x":[I]}],"translate-y":[{"translate-y":[I]}],"skew-x":[{"skew-x":[C]}],"skew-y":[{"skew-y":[C]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",xt]}],accent:[{accent:["auto",t]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",xt]}],"caret-color":[{caret:[t]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":F()}],"scroll-mx":[{"scroll-mx":F()}],"scroll-my":[{"scroll-my":F()}],"scroll-ms":[{"scroll-ms":F()}],"scroll-me":[{"scroll-me":F()}],"scroll-mt":[{"scroll-mt":F()}],"scroll-mr":[{"scroll-mr":F()}],"scroll-mb":[{"scroll-mb":F()}],"scroll-ml":[{"scroll-ml":F()}],"scroll-p":[{"scroll-p":F()}],"scroll-px":[{"scroll-px":F()}],"scroll-py":[{"scroll-py":F()}],"scroll-ps":[{"scroll-ps":F()}],"scroll-pe":[{"scroll-pe":F()}],"scroll-pt":[{"scroll-pt":F()}],"scroll-pr":[{"scroll-pr":F()}],"scroll-pb":[{"scroll-pb":F()}],"scroll-pl":[{"scroll-pl":F()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",xt]}],fill:[{fill:[t,"none"]}],"stroke-w":[{stroke:[Ma,Al,iC]}],stroke:[{stroke:[t,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},qte=Ete(Kte);function Tn(...t){return qte(qf(t))}const Xte=qee,bW=D.forwardRef(({className:t,...e},n)=>S.jsx(sW,{ref:n,className:Tn("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",t),...e}));bW.displayName=sW.displayName;const Yte=Xw("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),wW=D.forwardRef(({className:t,variant:e,...n},s)=>S.jsx(rW,{ref:s,className:Tn(Yte({variant:e}),t),...n}));wW.displayName=rW.displayName;const Zte=D.forwardRef(({className:t,...e},n)=>S.jsx(aW,{ref:n,className:Tn("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",t),...e}));Zte.displayName=aW.displayName;const SW=D.forwardRef(({className:t,...e},n)=>S.jsx(lW,{ref:n,className:Tn("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",t),"toast-close":"",...e,children:S.jsx(P_,{className:"h-4 w-4"})}));SW.displayName=lW.displayName;const kW=D.forwardRef(({className:t,...e},n)=>S.jsx(iW,{ref:n,className:Tn("text-sm font-semibold",t),...e}));kW.displayName=iW.displayName;const CW=D.forwardRef(({className:t,...e},n)=>S.jsx(oW,{ref:n,className:Tn("text-sm opacity-90",t),...e}));CW.displayName=oW.displayName;function Qte(){const{toasts:t}=Hw();return S.jsxs(Xte,{children:[t.map(function({id:e,title:n,description:s,action:r,...i}){return S.jsxs(wW,{...i,children:[S.jsxs("div",{className:"grid gap-1",children:[n&&S.jsx(kW,{children:n}),s&&S.jsx(CW,{children:s})]}),r,S.jsx(SW,{})]},e)}),S.jsx(bW,{})]})}const Jte=["top","right","bottom","left"],Rc=Math.min,fi=Math.max,fb=Math.round,wx=Math.floor,ga=t=>({x:t,y:t}),ene={left:"right",right:"left",bottom:"top",top:"bottom"},tne={start:"end",end:"start"};function _N(t,e,n){return fi(t,Rc(e,n))}function pl(t,e){return typeof t=="function"?t(e):t}function ml(t){return t.split("-")[0]}function Yf(t){return t.split("-")[1]}function L_(t){return t==="x"?"y":"x"}function M_(t){return t==="y"?"height":"width"}const nne=new Set(["top","bottom"]);function la(t){return nne.has(ml(t))?"y":"x"}function z_(t){return L_(la(t))}function sne(t,e,n){n===void 0&&(n=!1);const s=Yf(t),r=z_(t),i=M_(r);let o=r==="x"?s===(n?"end":"start")?"right":"left":s==="start"?"bottom":"top";return e.reference[i]>e.floating[i]&&(o=pb(o)),[o,pb(o)]}function rne(t){const e=pb(t);return[EN(t),e,EN(e)]}function EN(t){return t.replace(/start|end/g,e=>tne[e])}const UP=["left","right"],HP=["right","left"],ine=["top","bottom"],one=["bottom","top"];function ane(t,e,n){switch(t){case"top":case"bottom":return n?e?HP:UP:e?UP:HP;case"left":case"right":return e?ine:one;default:return[]}}function lne(t,e,n,s){const r=Yf(t);let i=ane(ml(t),n==="start",s);return r&&(i=i.map(o=>o+"-"+r),e&&(i=i.concat(i.map(EN)))),i}function pb(t){return t.replace(/left|right|bottom|top/g,e=>ene[e])}function cne(t){return{top:0,right:0,bottom:0,left:0,...t}}function TW(t){return typeof t!="number"?cne(t):{top:t,right:t,bottom:t,left:t}}function mb(t){const{x:e,y:n,width:s,height:r}=t;return{width:s,height:r,top:n,left:e,right:e+s,bottom:n+r,x:e,y:n}}function GP(t,e,n){let{reference:s,floating:r}=t;const i=la(e),o=z_(e),a=M_(o),l=ml(e),c=i==="y",u=s.x+s.width/2-r.width/2,d=s.y+s.height/2-r.height/2,h=s[a]/2-r[a]/2;let f;switch(l){case"top":f={x:u,y:s.y-r.height};break;case"bottom":f={x:u,y:s.y+s.height};break;case"right":f={x:s.x+s.width,y:d};break;case"left":f={x:s.x-r.width,y:d};break;default:f={x:s.x,y:s.y}}switch(Yf(e)){case"start":f[o]-=h*(n&&c?-1:1);break;case"end":f[o]+=h*(n&&c?-1:1);break}return f}const une=async(t,e,n)=>{const{placement:s="bottom",strategy:r="absolute",middleware:i=[],platform:o}=n,a=i.filter(Boolean),l=await(o.isRTL==null?void 0:o.isRTL(e));let c=await o.getElementRects({reference:t,floating:e,strategy:r}),{x:u,y:d}=GP(c,s,l),h=s,f={},p=0;for(let m=0;m<a.length;m++){const{name:g,fn:y}=a[m],{x,y:v,data:b,reset:k}=await y({x:u,y:d,initialPlacement:s,placement:h,strategy:r,middlewareData:f,rects:c,platform:o,elements:{reference:t,floating:e}});u=x??u,d=v??d,f={...f,[g]:{...f[g],...b}},k&&p<=50&&(p++,typeof k=="object"&&(k.placement&&(h=k.placement),k.rects&&(c=k.rects===!0?await o.getElementRects({reference:t,floating:e,strategy:r}):k.rects),{x:u,y:d}=GP(c,h,l)),m=-1)}return{x:u,y:d,placement:h,strategy:r,middlewareData:f}};async function cg(t,e){var n;e===void 0&&(e={});const{x:s,y:r,platform:i,rects:o,elements:a,strategy:l}=t,{boundary:c="clippingAncestors",rootBoundary:u="viewport",elementContext:d="floating",altBoundary:h=!1,padding:f=0}=pl(e,t),p=TW(f),g=a[h?d==="floating"?"reference":"floating":d],y=mb(await i.getClippingRect({element:(n=await(i.isElement==null?void 0:i.isElement(g)))==null||n?g:g.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(a.floating)),boundary:c,rootBoundary:u,strategy:l})),x=d==="floating"?{x:s,y:r,width:o.floating.width,height:o.floating.height}:o.reference,v=await(i.getOffsetParent==null?void 0:i.getOffsetParent(a.floating)),b=await(i.isElement==null?void 0:i.isElement(v))?await(i.getScale==null?void 0:i.getScale(v))||{x:1,y:1}:{x:1,y:1},k=mb(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:x,offsetParent:v,strategy:l}):x);return{top:(y.top-k.top+p.top)/b.y,bottom:(k.bottom-y.bottom+p.bottom)/b.y,left:(y.left-k.left+p.left)/b.x,right:(k.right-y.right+p.right)/b.x}}const dne=t=>({name:"arrow",options:t,async fn(e){const{x:n,y:s,placement:r,rects:i,platform:o,elements:a,middlewareData:l}=e,{element:c,padding:u=0}=pl(t,e)||{};if(c==null)return{};const d=TW(u),h={x:n,y:s},f=z_(r),p=M_(f),m=await o.getDimensions(c),g=f==="y",y=g?"top":"left",x=g?"bottom":"right",v=g?"clientHeight":"clientWidth",b=i.reference[p]+i.reference[f]-h[f]-i.floating[p],k=h[f]-i.reference[f],C=await(o.getOffsetParent==null?void 0:o.getOffsetParent(c));let N=C?C[v]:0;(!N||!await(o.isElement==null?void 0:o.isElement(C)))&&(N=a.floating[v]||i.floating[p]);const I=b/2-k/2,$=N/2-m[p]/2-1,A=Rc(d[y],$),P=Rc(d[x],$),F=A,V=N-m[p]-P,z=N/2-m[p]/2+I,B=_N(F,z,V),W=!l.arrow&&Yf(r)!=null&&z!==B&&i.reference[p]/2-(z<F?A:P)-m[p]/2<0,q=W?z<F?z-F:z-V:0;return{[f]:h[f]+q,data:{[f]:B,centerOffset:z-B-q,...W&&{alignmentOffset:q}},reset:W}}}),hne=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var n,s;const{placement:r,middlewareData:i,rects:o,initialPlacement:a,platform:l,elements:c}=e,{mainAxis:u=!0,crossAxis:d=!0,fallbackPlacements:h,fallbackStrategy:f="bestFit",fallbackAxisSideDirection:p="none",flipAlignment:m=!0,...g}=pl(t,e);if((n=i.arrow)!=null&&n.alignmentOffset)return{};const y=ml(r),x=la(a),v=ml(a)===a,b=await(l.isRTL==null?void 0:l.isRTL(c.floating)),k=h||(v||!m?[pb(a)]:rne(a)),C=p!=="none";!h&&C&&k.push(...lne(a,m,p,b));const N=[a,...k],I=await cg(e,g),$=[];let A=((s=i.flip)==null?void 0:s.overflows)||[];if(u&&$.push(I[y]),d){const z=sne(r,o,b);$.push(I[z[0]],I[z[1]])}if(A=[...A,{placement:r,overflows:$}],!$.every(z=>z<=0)){var P,F;const z=(((P=i.flip)==null?void 0:P.index)||0)+1,B=N[z];if(B&&(!(d==="alignment"?x!==la(B):!1)||A.every(M=>la(M.placement)===x?M.overflows[0]>0:!0)))return{data:{index:z,overflows:A},reset:{placement:B}};let W=(F=A.filter(q=>q.overflows[0]<=0).sort((q,M)=>q.overflows[1]-M.overflows[1])[0])==null?void 0:F.placement;if(!W)switch(f){case"bestFit":{var V;const q=(V=A.filter(M=>{if(C){const G=la(M.placement);return G===x||G==="y"}return!0}).map(M=>[M.placement,M.overflows.filter(G=>G>0).reduce((G,ne)=>G+ne,0)]).sort((M,G)=>M[1]-G[1])[0])==null?void 0:V[0];q&&(W=q);break}case"initialPlacement":W=a;break}if(r!==W)return{reset:{placement:W}}}return{}}}};function KP(t,e){return{top:t.top-e.height,right:t.right-e.width,bottom:t.bottom-e.height,left:t.left-e.width}}function qP(t){return Jte.some(e=>t[e]>=0)}const fne=function(t){return t===void 0&&(t={}),{name:"hide",options:t,async fn(e){const{rects:n}=e,{strategy:s="referenceHidden",...r}=pl(t,e);switch(s){case"referenceHidden":{const i=await cg(e,{...r,elementContext:"reference"}),o=KP(i,n.reference);return{data:{referenceHiddenOffsets:o,referenceHidden:qP(o)}}}case"escaped":{const i=await cg(e,{...r,altBoundary:!0}),o=KP(i,n.floating);return{data:{escapedOffsets:o,escaped:qP(o)}}}default:return{}}}}},NW=new Set(["left","top"]);async function pne(t,e){const{placement:n,platform:s,elements:r}=t,i=await(s.isRTL==null?void 0:s.isRTL(r.floating)),o=ml(n),a=Yf(n),l=la(n)==="y",c=NW.has(o)?-1:1,u=i&&l?-1:1,d=pl(e,t);let{mainAxis:h,crossAxis:f,alignmentAxis:p}=typeof d=="number"?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:d.mainAxis||0,crossAxis:d.crossAxis||0,alignmentAxis:d.alignmentAxis};return a&&typeof p=="number"&&(f=a==="end"?p*-1:p),l?{x:f*u,y:h*c}:{x:h*c,y:f*u}}const mne=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){var n,s;const{x:r,y:i,placement:o,middlewareData:a}=e,l=await pne(e,t);return o===((n=a.offset)==null?void 0:n.placement)&&(s=a.arrow)!=null&&s.alignmentOffset?{}:{x:r+l.x,y:i+l.y,data:{...l,placement:o}}}}},gne=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:n,y:s,placement:r}=e,{mainAxis:i=!0,crossAxis:o=!1,limiter:a={fn:g=>{let{x:y,y:x}=g;return{x:y,y:x}}},...l}=pl(t,e),c={x:n,y:s},u=await cg(e,l),d=la(ml(r)),h=L_(d);let f=c[h],p=c[d];if(i){const g=h==="y"?"top":"left",y=h==="y"?"bottom":"right",x=f+u[g],v=f-u[y];f=_N(x,f,v)}if(o){const g=d==="y"?"top":"left",y=d==="y"?"bottom":"right",x=p+u[g],v=p-u[y];p=_N(x,p,v)}const m=a.fn({...e,[h]:f,[d]:p});return{...m,data:{x:m.x-n,y:m.y-s,enabled:{[h]:i,[d]:o}}}}}},yne=function(t){return t===void 0&&(t={}),{options:t,fn(e){const{x:n,y:s,placement:r,rects:i,middlewareData:o}=e,{offset:a=0,mainAxis:l=!0,crossAxis:c=!0}=pl(t,e),u={x:n,y:s},d=la(r),h=L_(d);let f=u[h],p=u[d];const m=pl(a,e),g=typeof m=="number"?{mainAxis:m,crossAxis:0}:{mainAxis:0,crossAxis:0,...m};if(l){const v=h==="y"?"height":"width",b=i.reference[h]-i.floating[v]+g.mainAxis,k=i.reference[h]+i.reference[v]-g.mainAxis;f<b?f=b:f>k&&(f=k)}if(c){var y,x;const v=h==="y"?"width":"height",b=NW.has(ml(r)),k=i.reference[d]-i.floating[v]+(b&&((y=o.offset)==null?void 0:y[d])||0)+(b?0:g.crossAxis),C=i.reference[d]+i.reference[v]+(b?0:((x=o.offset)==null?void 0:x[d])||0)-(b?g.crossAxis:0);p<k?p=k:p>C&&(p=C)}return{[h]:f,[d]:p}}}},xne=function(t){return t===void 0&&(t={}),{name:"size",options:t,async fn(e){var n,s;const{placement:r,rects:i,platform:o,elements:a}=e,{apply:l=()=>{},...c}=pl(t,e),u=await cg(e,c),d=ml(r),h=Yf(r),f=la(r)==="y",{width:p,height:m}=i.floating;let g,y;d==="top"||d==="bottom"?(g=d,y=h===(await(o.isRTL==null?void 0:o.isRTL(a.floating))?"start":"end")?"left":"right"):(y=d,g=h==="end"?"top":"bottom");const x=m-u.top-u.bottom,v=p-u.left-u.right,b=Rc(m-u[g],x),k=Rc(p-u[y],v),C=!e.middlewareData.shift;let N=b,I=k;if((n=e.middlewareData.shift)!=null&&n.enabled.x&&(I=v),(s=e.middlewareData.shift)!=null&&s.enabled.y&&(N=x),C&&!h){const A=fi(u.left,0),P=fi(u.right,0),F=fi(u.top,0),V=fi(u.bottom,0);f?I=p-2*(A!==0||P!==0?A+P:fi(u.left,u.right)):N=m-2*(F!==0||V!==0?F+V:fi(u.top,u.bottom))}await l({...e,availableWidth:I,availableHeight:N});const $=await o.getDimensions(a.floating);return p!==$.width||m!==$.height?{reset:{rects:!0}}:{}}}};function Yw(){return typeof window<"u"}function Zf(t){return IW(t)?(t.nodeName||"").toLowerCase():"#document"}function vi(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function Da(t){var e;return(e=(IW(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function IW(t){return Yw()?t instanceof Node||t instanceof vi(t).Node:!1}function Po(t){return Yw()?t instanceof Element||t instanceof vi(t).Element:!1}function Na(t){return Yw()?t instanceof HTMLElement||t instanceof vi(t).HTMLElement:!1}function XP(t){return!Yw()||typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof vi(t).ShadowRoot}const vne=new Set(["inline","contents"]);function oy(t){const{overflow:e,overflowX:n,overflowY:s,display:r}=Fo(t);return/auto|scroll|overlay|hidden|clip/.test(e+s+n)&&!vne.has(r)}const bne=new Set(["table","td","th"]);function wne(t){return bne.has(Zf(t))}const Sne=[":popover-open",":modal"];function Zw(t){return Sne.some(e=>{try{return t.matches(e)}catch{return!1}})}const kne=["transform","translate","scale","rotate","perspective"],Cne=["transform","translate","scale","rotate","perspective","filter"],Tne=["paint","layout","strict","content"];function V_(t){const e=j_(),n=Po(t)?Fo(t):t;return kne.some(s=>n[s]?n[s]!=="none":!1)||(n.containerType?n.containerType!=="normal":!1)||!e&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!e&&(n.filter?n.filter!=="none":!1)||Cne.some(s=>(n.willChange||"").includes(s))||Tne.some(s=>(n.contain||"").includes(s))}function Nne(t){let e=Dc(t);for(;Na(e)&&!xf(e);){if(V_(e))return e;if(Zw(e))return null;e=Dc(e)}return null}function j_(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const Ine=new Set(["html","body","#document"]);function xf(t){return Ine.has(Zf(t))}function Fo(t){return vi(t).getComputedStyle(t)}function Qw(t){return Po(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function Dc(t){if(Zf(t)==="html")return t;const e=t.assignedSlot||t.parentNode||XP(t)&&t.host||Da(t);return XP(e)?e.host:e}function _W(t){const e=Dc(t);return xf(e)?t.ownerDocument?t.ownerDocument.body:t.body:Na(e)&&oy(e)?e:_W(e)}function ug(t,e,n){var s;e===void 0&&(e=[]),n===void 0&&(n=!0);const r=_W(t),i=r===((s=t.ownerDocument)==null?void 0:s.body),o=vi(r);if(i){const a=$N(o);return e.concat(o,o.visualViewport||[],oy(r)?r:[],a&&n?ug(a):[])}return e.concat(r,ug(r,[],n))}function $N(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function EW(t){const e=Fo(t);let n=parseFloat(e.width)||0,s=parseFloat(e.height)||0;const r=Na(t),i=r?t.offsetWidth:n,o=r?t.offsetHeight:s,a=fb(n)!==i||fb(s)!==o;return a&&(n=i,s=o),{width:n,height:s,$:a}}function B_(t){return Po(t)?t:t.contextElement}function Vh(t){const e=B_(t);if(!Na(e))return ga(1);const n=e.getBoundingClientRect(),{width:s,height:r,$:i}=EW(e);let o=(i?fb(n.width):n.width)/s,a=(i?fb(n.height):n.height)/r;return(!o||!Number.isFinite(o))&&(o=1),(!a||!Number.isFinite(a))&&(a=1),{x:o,y:a}}const _ne=ga(0);function $W(t){const e=vi(t);return!j_()||!e.visualViewport?_ne:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function Ene(t,e,n){return e===void 0&&(e=!1),!n||e&&n!==vi(t)?!1:e}function fd(t,e,n,s){e===void 0&&(e=!1),n===void 0&&(n=!1);const r=t.getBoundingClientRect(),i=B_(t);let o=ga(1);e&&(s?Po(s)&&(o=Vh(s)):o=Vh(t));const a=Ene(i,n,s)?$W(i):ga(0);let l=(r.left+a.x)/o.x,c=(r.top+a.y)/o.y,u=r.width/o.x,d=r.height/o.y;if(i){const h=vi(i),f=s&&Po(s)?vi(s):s;let p=h,m=$N(p);for(;m&&s&&f!==p;){const g=Vh(m),y=m.getBoundingClientRect(),x=Fo(m),v=y.left+(m.clientLeft+parseFloat(x.paddingLeft))*g.x,b=y.top+(m.clientTop+parseFloat(x.paddingTop))*g.y;l*=g.x,c*=g.y,u*=g.x,d*=g.y,l+=v,c+=b,p=vi(m),m=$N(p)}}return mb({width:u,height:d,x:l,y:c})}function W_(t,e){const n=Qw(t).scrollLeft;return e?e.left+n:fd(Da(t)).left+n}function AW(t,e,n){n===void 0&&(n=!1);const s=t.getBoundingClientRect(),r=s.left+e.scrollLeft-(n?0:W_(t,s)),i=s.top+e.scrollTop;return{x:r,y:i}}function $ne(t){let{elements:e,rect:n,offsetParent:s,strategy:r}=t;const i=r==="fixed",o=Da(s),a=e?Zw(e.floating):!1;if(s===o||a&&i)return n;let l={scrollLeft:0,scrollTop:0},c=ga(1);const u=ga(0),d=Na(s);if((d||!d&&!i)&&((Zf(s)!=="body"||oy(o))&&(l=Qw(s)),Na(s))){const f=fd(s);c=Vh(s),u.x=f.x+s.clientLeft,u.y=f.y+s.clientTop}const h=o&&!d&&!i?AW(o,l,!0):ga(0);return{width:n.width*c.x,height:n.height*c.y,x:n.x*c.x-l.scrollLeft*c.x+u.x+h.x,y:n.y*c.y-l.scrollTop*c.y+u.y+h.y}}function Ane(t){return Array.from(t.getClientRects())}function Rne(t){const e=Da(t),n=Qw(t),s=t.ownerDocument.body,r=fi(e.scrollWidth,e.clientWidth,s.scrollWidth,s.clientWidth),i=fi(e.scrollHeight,e.clientHeight,s.scrollHeight,s.clientHeight);let o=-n.scrollLeft+W_(t);const a=-n.scrollTop;return Fo(s).direction==="rtl"&&(o+=fi(e.clientWidth,s.clientWidth)-r),{width:r,height:i,x:o,y:a}}function Dne(t,e){const n=vi(t),s=Da(t),r=n.visualViewport;let i=s.clientWidth,o=s.clientHeight,a=0,l=0;if(r){i=r.width,o=r.height;const c=j_();(!c||c&&e==="fixed")&&(a=r.offsetLeft,l=r.offsetTop)}return{width:i,height:o,x:a,y:l}}const One=new Set(["absolute","fixed"]);function Pne(t,e){const n=fd(t,!0,e==="fixed"),s=n.top+t.clientTop,r=n.left+t.clientLeft,i=Na(t)?Vh(t):ga(1),o=t.clientWidth*i.x,a=t.clientHeight*i.y,l=r*i.x,c=s*i.y;return{width:o,height:a,x:l,y:c}}function YP(t,e,n){let s;if(e==="viewport")s=Dne(t,n);else if(e==="document")s=Rne(Da(t));else if(Po(e))s=Pne(e,n);else{const r=$W(t);s={x:e.x-r.x,y:e.y-r.y,width:e.width,height:e.height}}return mb(s)}function RW(t,e){const n=Dc(t);return n===e||!Po(n)||xf(n)?!1:Fo(n).position==="fixed"||RW(n,e)}function Fne(t,e){const n=e.get(t);if(n)return n;let s=ug(t,[],!1).filter(a=>Po(a)&&Zf(a)!=="body"),r=null;const i=Fo(t).position==="fixed";let o=i?Dc(t):t;for(;Po(o)&&!xf(o);){const a=Fo(o),l=V_(o);!l&&a.position==="fixed"&&(r=null),(i?!l&&!r:!l&&a.position==="static"&&!!r&&One.has(r.position)||oy(o)&&!l&&RW(t,o))?s=s.filter(u=>u!==o):r=a,o=Dc(o)}return e.set(t,s),s}function Lne(t){let{element:e,boundary:n,rootBoundary:s,strategy:r}=t;const o=[...n==="clippingAncestors"?Zw(e)?[]:Fne(e,this._c):[].concat(n),s],a=o[0],l=o.reduce((c,u)=>{const d=YP(e,u,r);return c.top=fi(d.top,c.top),c.right=Rc(d.right,c.right),c.bottom=Rc(d.bottom,c.bottom),c.left=fi(d.left,c.left),c},YP(e,a,r));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function Mne(t){const{width:e,height:n}=EW(t);return{width:e,height:n}}function zne(t,e,n){const s=Na(e),r=Da(e),i=n==="fixed",o=fd(t,!0,i,e);let a={scrollLeft:0,scrollTop:0};const l=ga(0);function c(){l.x=W_(r)}if(s||!s&&!i)if((Zf(e)!=="body"||oy(r))&&(a=Qw(e)),s){const f=fd(e,!0,i,e);l.x=f.x+e.clientLeft,l.y=f.y+e.clientTop}else r&&c();i&&!s&&r&&c();const u=r&&!s&&!i?AW(r,a):ga(0),d=o.left+a.scrollLeft-l.x-u.x,h=o.top+a.scrollTop-l.y-u.y;return{x:d,y:h,width:o.width,height:o.height}}function oC(t){return Fo(t).position==="static"}function ZP(t,e){if(!Na(t)||Fo(t).position==="fixed")return null;if(e)return e(t);let n=t.offsetParent;return Da(t)===n&&(n=n.ownerDocument.body),n}function DW(t,e){const n=vi(t);if(Zw(t))return n;if(!Na(t)){let r=Dc(t);for(;r&&!xf(r);){if(Po(r)&&!oC(r))return r;r=Dc(r)}return n}let s=ZP(t,e);for(;s&&wne(s)&&oC(s);)s=ZP(s,e);return s&&xf(s)&&oC(s)&&!V_(s)?n:s||Nne(t)||n}const Vne=async function(t){const e=this.getOffsetParent||DW,n=this.getDimensions,s=await n(t.floating);return{reference:zne(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:s.width,height:s.height}}};function jne(t){return Fo(t).direction==="rtl"}const Bne={convertOffsetParentRelativeRectToViewportRelativeRect:$ne,getDocumentElement:Da,getClippingRect:Lne,getOffsetParent:DW,getElementRects:Vne,getClientRects:Ane,getDimensions:Mne,getScale:Vh,isElement:Po,isRTL:jne};function OW(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height}function Wne(t,e){let n=null,s;const r=Da(t);function i(){var a;clearTimeout(s),(a=n)==null||a.disconnect(),n=null}function o(a,l){a===void 0&&(a=!1),l===void 0&&(l=1),i();const c=t.getBoundingClientRect(),{left:u,top:d,width:h,height:f}=c;if(a||e(),!h||!f)return;const p=wx(d),m=wx(r.clientWidth-(u+h)),g=wx(r.clientHeight-(d+f)),y=wx(u),v={rootMargin:-p+"px "+-m+"px "+-g+"px "+-y+"px",threshold:fi(0,Rc(1,l))||1};let b=!0;function k(C){const N=C[0].intersectionRatio;if(N!==l){if(!b)return o();N?o(!1,N):s=setTimeout(()=>{o(!1,1e-7)},1e3)}N===1&&!OW(c,t.getBoundingClientRect())&&o(),b=!1}try{n=new IntersectionObserver(k,{...v,root:r.ownerDocument})}catch{n=new IntersectionObserver(k,v)}n.observe(t)}return o(!0),i}function Une(t,e,n,s){s===void 0&&(s={});const{ancestorScroll:r=!0,ancestorResize:i=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:a=typeof IntersectionObserver=="function",animationFrame:l=!1}=s,c=B_(t),u=r||i?[...c?ug(c):[],...ug(e)]:[];u.forEach(y=>{r&&y.addEventListener("scroll",n,{passive:!0}),i&&y.addEventListener("resize",n)});const d=c&&a?Wne(c,n):null;let h=-1,f=null;o&&(f=new ResizeObserver(y=>{let[x]=y;x&&x.target===c&&f&&(f.unobserve(e),cancelAnimationFrame(h),h=requestAnimationFrame(()=>{var v;(v=f)==null||v.observe(e)})),n()}),c&&!l&&f.observe(c),f.observe(e));let p,m=l?fd(t):null;l&&g();function g(){const y=fd(t);m&&!OW(m,y)&&n(),m=y,p=requestAnimationFrame(g)}return n(),()=>{var y;u.forEach(x=>{r&&x.removeEventListener("scroll",n),i&&x.removeEventListener("resize",n)}),d==null||d(),(y=f)==null||y.disconnect(),f=null,l&&cancelAnimationFrame(p)}}const Hne=mne,Gne=gne,Kne=hne,qne=xne,Xne=fne,QP=dne,Yne=yne,Zne=(t,e,n)=>{const s=new Map,r={platform:Bne,...n},i={...r.platform,_c:s};return une(t,e,{...r,platform:i})};var Qne=typeof document<"u",Jne=function(){},bv=Qne?D.useLayoutEffect:Jne;function gb(t,e){if(t===e)return!0;if(typeof t!=typeof e)return!1;if(typeof t=="function"&&t.toString()===e.toString())return!0;let n,s,r;if(t&&e&&typeof t=="object"){if(Array.isArray(t)){if(n=t.length,n!==e.length)return!1;for(s=n;s--!==0;)if(!gb(t[s],e[s]))return!1;return!0}if(r=Object.keys(t),n=r.length,n!==Object.keys(e).length)return!1;for(s=n;s--!==0;)if(!{}.hasOwnProperty.call(e,r[s]))return!1;for(s=n;s--!==0;){const i=r[s];if(!(i==="_owner"&&t.$$typeof)&&!gb(t[i],e[i]))return!1}return!0}return t!==t&&e!==e}function PW(t){return typeof window>"u"?1:(t.ownerDocument.defaultView||window).devicePixelRatio||1}function JP(t,e){const n=PW(t);return Math.round(e*n)/n}function aC(t){const e=D.useRef(t);return bv(()=>{e.current=t}),e}function ese(t){t===void 0&&(t={});const{placement:e="bottom",strategy:n="absolute",middleware:s=[],platform:r,elements:{reference:i,floating:o}={},transform:a=!0,whileElementsMounted:l,open:c}=t,[u,d]=D.useState({x:0,y:0,strategy:n,placement:e,middlewareData:{},isPositioned:!1}),[h,f]=D.useState(s);gb(h,s)||f(s);const[p,m]=D.useState(null),[g,y]=D.useState(null),x=D.useCallback(M=>{M!==C.current&&(C.current=M,m(M))},[]),v=D.useCallback(M=>{M!==N.current&&(N.current=M,y(M))},[]),b=i||p,k=o||g,C=D.useRef(null),N=D.useRef(null),I=D.useRef(u),$=l!=null,A=aC(l),P=aC(r),F=aC(c),V=D.useCallback(()=>{if(!C.current||!N.current)return;const M={placement:e,strategy:n,middleware:h};P.current&&(M.platform=P.current),Zne(C.current,N.current,M).then(G=>{const ne={...G,isPositioned:F.current!==!1};z.current&&!gb(I.current,ne)&&(I.current=ne,ny.flushSync(()=>{d(ne)}))})},[h,e,n,P,F]);bv(()=>{c===!1&&I.current.isPositioned&&(I.current.isPositioned=!1,d(M=>({...M,isPositioned:!1})))},[c]);const z=D.useRef(!1);bv(()=>(z.current=!0,()=>{z.current=!1}),[]),bv(()=>{if(b&&(C.current=b),k&&(N.current=k),b&&k){if(A.current)return A.current(b,k,V);V()}},[b,k,V,A,$]);const B=D.useMemo(()=>({reference:C,floating:N,setReference:x,setFloating:v}),[x,v]),W=D.useMemo(()=>({reference:b,floating:k}),[b,k]),q=D.useMemo(()=>{const M={position:n,left:0,top:0};if(!W.floating)return M;const G=JP(W.floating,u.x),ne=JP(W.floating,u.y);return a?{...M,transform:"translate("+G+"px, "+ne+"px)",...PW(W.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:G,top:ne}},[n,a,W.floating,u.x,u.y]);return D.useMemo(()=>({...u,update:V,refs:B,elements:W,floatingStyles:q}),[u,V,B,W,q])}const tse=t=>{function e(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:t,fn(n){const{element:s,padding:r}=typeof t=="function"?t(n):t;return s&&e(s)?s.current!=null?QP({element:s.current,padding:r}).fn(n):{}:s?QP({element:s,padding:r}).fn(n):{}}}},nse=(t,e)=>({...Hne(t),options:[t,e]}),sse=(t,e)=>({...Gne(t),options:[t,e]}),rse=(t,e)=>({...Yne(t),options:[t,e]}),ise=(t,e)=>({...Kne(t),options:[t,e]}),ose=(t,e)=>({...qne(t),options:[t,e]}),ase=(t,e)=>({...Xne(t),options:[t,e]}),lse=(t,e)=>({...tse(t),options:[t,e]});var cse="Arrow",FW=D.forwardRef((t,e)=>{const{children:n,width:s=10,height:r=5,...i}=t;return S.jsx(Ls.svg,{...i,ref:e,width:s,height:r,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:t.asChild?n:S.jsx("polygon",{points:"0,0 30,0 15,10"})})});FW.displayName=cse;var use=FW;function LW(t){const[e,n]=D.useState(void 0);return Ac(()=>{if(t){n({width:t.offsetWidth,height:t.offsetHeight});const s=new ResizeObserver(r=>{if(!Array.isArray(r)||!r.length)return;const i=r[0];let o,a;if("borderBoxSize"in i){const l=i.borderBoxSize,c=Array.isArray(l)?l[0]:l;o=c.inlineSize,a=c.blockSize}else o=t.offsetWidth,a=t.offsetHeight;n({width:o,height:a})});return s.observe(t,{box:"border-box"}),()=>s.unobserve(t)}else n(void 0)},[t]),e}var MW="Popper",[zW,VW]=ry(MW),[GWe,jW]=zW(MW),BW="PopperAnchor",WW=D.forwardRef((t,e)=>{const{__scopePopper:n,virtualRef:s,...r}=t,i=jW(BW,n),o=D.useRef(null),a=Si(e,o),l=D.useRef(null);return D.useEffect(()=>{const c=l.current;l.current=(s==null?void 0:s.current)||o.current,c!==l.current&&i.onAnchorChange(l.current)}),s?null:S.jsx(Ls.div,{...r,ref:a})});WW.displayName=BW;var U_="PopperContent",[dse,hse]=zW(U_),UW=D.forwardRef((t,e)=>{var Ce,Le,Re,Ze,tt,mt;const{__scopePopper:n,side:s="bottom",sideOffset:r=0,align:i="center",alignOffset:o=0,arrowPadding:a=0,avoidCollisions:l=!0,collisionBoundary:c=[],collisionPadding:u=0,sticky:d="partial",hideWhenDetached:h=!1,updatePositionStrategy:f="optimized",onPlaced:p,...m}=t,g=jW(U_,n),[y,x]=D.useState(null),v=Si(e,Xe=>x(Xe)),[b,k]=D.useState(null),C=LW(b),N=(C==null?void 0:C.width)??0,I=(C==null?void 0:C.height)??0,$=s+(i!=="center"?"-"+i:""),A=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},P=Array.isArray(c)?c:[c],F=P.length>0,V={padding:A,boundary:P.filter(pse),altBoundary:F},{refs:z,floatingStyles:B,placement:W,isPositioned:q,middlewareData:M}=ese({strategy:"fixed",placement:$,whileElementsMounted:(...Xe)=>Une(...Xe,{animationFrame:f==="always"}),elements:{reference:g.anchor},middleware:[nse({mainAxis:r+I,alignmentAxis:o}),l&&sse({mainAxis:!0,crossAxis:!1,limiter:d==="partial"?rse():void 0,...V}),l&&ise({...V}),ose({...V,apply:({elements:Xe,rects:Me,availableWidth:wt,availableHeight:it})=>{const{width:At,height:Vt}=Me.reference,_n=Xe.floating.style;_n.setProperty("--radix-popper-available-width",`${wt}px`),_n.setProperty("--radix-popper-available-height",`${it}px`),_n.setProperty("--radix-popper-anchor-width",`${At}px`),_n.setProperty("--radix-popper-anchor-height",`${Vt}px`)}}),b&&lse({element:b,padding:a}),mse({arrowWidth:N,arrowHeight:I}),h&&ase({strategy:"referenceHidden",...V})]}),[G,ne]=KW(W),ie=$c(p);Ac(()=>{q&&(ie==null||ie())},[q,ie]);const de=(Ce=M.arrow)==null?void 0:Ce.x,he=(Le=M.arrow)==null?void 0:Le.y,pe=((Re=M.arrow)==null?void 0:Re.centerOffset)!==0,[me,ye]=D.useState();return Ac(()=>{y&&ye(window.getComputedStyle(y).zIndex)},[y]),S.jsx("div",{ref:z.setFloating,"data-radix-popper-content-wrapper":"",style:{...B,transform:q?B.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:me,"--radix-popper-transform-origin":[(Ze=M.transformOrigin)==null?void 0:Ze.x,(tt=M.transformOrigin)==null?void 0:tt.y].join(" "),...((mt=M.hide)==null?void 0:mt.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:t.dir,children:S.jsx(dse,{scope:n,placedSide:G,onArrowChange:k,arrowX:de,arrowY:he,shouldHideArrow:pe,children:S.jsx(Ls.div,{"data-side":G,"data-align":ne,...m,ref:v,style:{...m.style,animation:q?void 0:"none"}})})})});UW.displayName=U_;var HW="PopperArrow",fse={top:"bottom",right:"left",bottom:"top",left:"right"},GW=D.forwardRef(function(e,n){const{__scopePopper:s,...r}=e,i=hse(HW,s),o=fse[i.placedSide];return S.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[o]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:S.jsx(use,{...r,ref:n,style:{...r.style,display:"block"}})})});GW.displayName=HW;function pse(t){return t!==null}var mse=t=>({name:"transformOrigin",options:t,fn(e){var g,y,x;const{placement:n,rects:s,middlewareData:r}=e,o=((g=r.arrow)==null?void 0:g.centerOffset)!==0,a=o?0:t.arrowWidth,l=o?0:t.arrowHeight,[c,u]=KW(n),d={start:"0%",center:"50%",end:"100%"}[u],h=(((y=r.arrow)==null?void 0:y.x)??0)+a/2,f=(((x=r.arrow)==null?void 0:x.y)??0)+l/2;let p="",m="";return c==="bottom"?(p=o?d:`${h}px`,m=`${-l}px`):c==="top"?(p=o?d:`${h}px`,m=`${s.floating.height+l}px`):c==="right"?(p=`${-l}px`,m=o?d:`${f}px`):c==="left"&&(p=`${s.floating.width+l}px`,m=o?d:`${f}px`),{data:{x:p,y:m}}}});function KW(t){const[e,n="center"]=t.split("-");return[e,n]}var gse=WW,yse=UW,xse=GW,[Jw,KWe]=ry("Tooltip",[VW]),H_=VW(),qW="TooltipProvider",vse=700,eF="tooltip.open",[bse,XW]=Jw(qW),YW=t=>{const{__scopeTooltip:e,delayDuration:n=vse,skipDelayDuration:s=300,disableHoverableContent:r=!1,children:i}=t,o=D.useRef(!0),a=D.useRef(!1),l=D.useRef(0);return D.useEffect(()=>{const c=l.current;return()=>window.clearTimeout(c)},[]),S.jsx(bse,{scope:e,isOpenDelayedRef:o,delayDuration:n,onOpen:D.useCallback(()=>{window.clearTimeout(l.current),o.current=!1},[]),onClose:D.useCallback(()=>{window.clearTimeout(l.current),l.current=window.setTimeout(()=>o.current=!0,s)},[s]),isPointerInTransitRef:a,onPointerInTransitChange:D.useCallback(c=>{a.current=c},[]),disableHoverableContent:r,children:i})};YW.displayName=qW;var ZW="Tooltip",[qWe,e1]=Jw(ZW),AN="TooltipTrigger",wse=D.forwardRef((t,e)=>{const{__scopeTooltip:n,...s}=t,r=e1(AN,n),i=XW(AN,n),o=H_(n),a=D.useRef(null),l=Si(e,a,r.onTriggerChange),c=D.useRef(!1),u=D.useRef(!1),d=D.useCallback(()=>c.current=!1,[]);return D.useEffect(()=>()=>document.removeEventListener("pointerup",d),[d]),S.jsx(gse,{asChild:!0,...o,children:S.jsx(Ls.button,{"aria-describedby":r.open?r.contentId:void 0,"data-state":r.stateAttribute,...s,ref:l,onPointerMove:Zn(t.onPointerMove,h=>{h.pointerType!=="touch"&&!u.current&&!i.isPointerInTransitRef.current&&(r.onTriggerEnter(),u.current=!0)}),onPointerLeave:Zn(t.onPointerLeave,()=>{r.onTriggerLeave(),u.current=!1}),onPointerDown:Zn(t.onPointerDown,()=>{r.open&&r.onClose(),c.current=!0,document.addEventListener("pointerup",d,{once:!0})}),onFocus:Zn(t.onFocus,()=>{c.current||r.onOpen()}),onBlur:Zn(t.onBlur,r.onClose),onClick:Zn(t.onClick,r.onClose)})})});wse.displayName=AN;var Sse="TooltipPortal",[XWe,kse]=Jw(Sse,{forceMount:void 0}),vf="TooltipContent",QW=D.forwardRef((t,e)=>{const n=kse(vf,t.__scopeTooltip),{forceMount:s=n.forceMount,side:r="top",...i}=t,o=e1(vf,t.__scopeTooltip);return S.jsx(Gw,{present:s||o.open,children:o.disableHoverableContent?S.jsx(JW,{side:r,...i,ref:e}):S.jsx(Cse,{side:r,...i,ref:e})})}),Cse=D.forwardRef((t,e)=>{const n=e1(vf,t.__scopeTooltip),s=XW(vf,t.__scopeTooltip),r=D.useRef(null),i=Si(e,r),[o,a]=D.useState(null),{trigger:l,onClose:c}=n,u=r.current,{onPointerInTransitChange:d}=s,h=D.useCallback(()=>{a(null),d(!1)},[d]),f=D.useCallback((p,m)=>{const g=p.currentTarget,y={x:p.clientX,y:p.clientY},x=Ese(y,g.getBoundingClientRect()),v=$se(y,x),b=Ase(m.getBoundingClientRect()),k=Dse([...v,...b]);a(k),d(!0)},[d]);return D.useEffect(()=>()=>h(),[h]),D.useEffect(()=>{if(l&&u){const p=g=>f(g,u),m=g=>f(g,l);return l.addEventListener("pointerleave",p),u.addEventListener("pointerleave",m),()=>{l.removeEventListener("pointerleave",p),u.removeEventListener("pointerleave",m)}}},[l,u,f,h]),D.useEffect(()=>{if(o){const p=m=>{const g=m.target,y={x:m.clientX,y:m.clientY},x=(l==null?void 0:l.contains(g))||(u==null?void 0:u.contains(g)),v=!Rse(y,o);x?h():v&&(h(),c())};return document.addEventListener("pointermove",p),()=>document.removeEventListener("pointermove",p)}},[l,u,o,c,h]),S.jsx(JW,{...t,ref:i})}),[Tse,Nse]=Jw(ZW,{isInside:!1}),Ise=oee("TooltipContent"),JW=D.forwardRef((t,e)=>{const{__scopeTooltip:n,children:s,"aria-label":r,onEscapeKeyDown:i,onPointerDownOutside:o,...a}=t,l=e1(vf,n),c=H_(n),{onClose:u}=l;return D.useEffect(()=>(document.addEventListener(eF,u),()=>document.removeEventListener(eF,u)),[u]),D.useEffect(()=>{if(l.trigger){const d=h=>{const f=h.target;f!=null&&f.contains(l.trigger)&&u()};return window.addEventListener("scroll",d,{capture:!0}),()=>window.removeEventListener("scroll",d,{capture:!0})}},[l.trigger,u]),S.jsx(A_,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:i,onPointerDownOutside:o,onFocusOutside:d=>d.preventDefault(),onDismiss:u,children:S.jsxs(yse,{"data-state":l.stateAttribute,...c,...a,ref:e,style:{...a.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[S.jsx(Ise,{children:s}),S.jsx(Tse,{scope:n,isInside:!0,children:S.jsx($ee,{id:l.contentId,role:"tooltip",children:r||s})})]})})});QW.displayName=vf;var eU="TooltipArrow",_se=D.forwardRef((t,e)=>{const{__scopeTooltip:n,...s}=t,r=H_(n);return Nse(eU,n).isInside?null:S.jsx(xse,{...r,...s,ref:e})});_se.displayName=eU;function Ese(t,e){const n=Math.abs(e.top-t.y),s=Math.abs(e.bottom-t.y),r=Math.abs(e.right-t.x),i=Math.abs(e.left-t.x);switch(Math.min(n,s,r,i)){case i:return"left";case r:return"right";case n:return"top";case s:return"bottom";default:throw new Error("unreachable")}}function $se(t,e,n=5){const s=[];switch(e){case"top":s.push({x:t.x-n,y:t.y+n},{x:t.x+n,y:t.y+n});break;case"bottom":s.push({x:t.x-n,y:t.y-n},{x:t.x+n,y:t.y-n});break;case"left":s.push({x:t.x+n,y:t.y-n},{x:t.x+n,y:t.y+n});break;case"right":s.push({x:t.x-n,y:t.y-n},{x:t.x-n,y:t.y+n});break}return s}function Ase(t){const{top:e,right:n,bottom:s,left:r}=t;return[{x:r,y:e},{x:n,y:e},{x:n,y:s},{x:r,y:s}]}function Rse(t,e){const{x:n,y:s}=t;let r=!1;for(let i=0,o=e.length-1;i<e.length;o=i++){const a=e[i],l=e[o],c=a.x,u=a.y,d=l.x,h=l.y;u>s!=h>s&&n<(d-c)*(s-u)/(h-u)+c&&(r=!r)}return r}function Dse(t){const e=t.slice();return e.sort((n,s)=>n.x<s.x?-1:n.x>s.x?1:n.y<s.y?-1:n.y>s.y?1:0),Ose(e)}function Ose(t){if(t.length<=1)return t.slice();const e=[];for(let s=0;s<t.length;s++){const r=t[s];for(;e.length>=2;){const i=e[e.length-1],o=e[e.length-2];if((i.x-o.x)*(r.y-o.y)>=(i.y-o.y)*(r.x-o.x))e.pop();else break}e.push(r)}e.pop();const n=[];for(let s=t.length-1;s>=0;s--){const r=t[s];for(;n.length>=2;){const i=n[n.length-1],o=n[n.length-2];if((i.x-o.x)*(r.y-o.y)>=(i.y-o.y)*(r.x-o.x))n.pop();else break}n.push(r)}return n.pop(),e.length===1&&n.length===1&&e[0].x===n[0].x&&e[0].y===n[0].y?e:e.concat(n)}var Pse=YW,tU=QW;const Fse=Pse,Lse=D.forwardRef(({className:t,sideOffset:e=4,...n},s)=>S.jsx(tU,{ref:s,sideOffset:e,className:Tn("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]",t),...n}));Lse.displayName=tU.displayName;const Mse=Xw("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),lt=D.forwardRef(({className:t,variant:e,size:n,asChild:s=!1,...r},i)=>{const o=s?F4:"button";return S.jsx(o,{className:Tn(Mse({variant:e,size:n,className:t})),ref:i,...r})});lt.displayName="Button";function il(){const[t,e]=ti(),[n,s]=D.useState(!1),[r,i]=D.useState(!1),[o,a]=D.useState(!1);D.useEffect(()=>{i(!!localStorage.getItem("user"))},[t]);const l=[{href:"/",label:"Home"},{href:"/assessment",label:"Assessment"},{href:"/routines",label:"Routines"},{href:"/poses",label:"Poses"},{href:"live-detection",label:"Live Detection"}];return S.jsx("nav",{className:"fixed top-0 w-full z-50 transition-all duration-300 bg-white/80 backdrop-blur-md border-b border-wellness-200",children:S.jsxs("div",{className:"max-w-7xl mx-auto px-6 py-4",children:[S.jsxs("div",{className:"flex justify-between items-center",children:[S.jsxs("button",{onClick:()=>e("/"),className:"flex items-center space-x-2",children:[S.jsx("div",{className:"w-10 h-10 gradient-bg rounded-full flex items-center justify-center",children:S.jsx("span",{className:"text-white text-lg",children:"🧘"})}),S.jsx("span",{className:"font-poppins font-bold text-xl gradient-text",children:"YogaFlow"})]}),S.jsxs("div",{className:"hidden md:flex items-center space-x-8",children:[S.jsx("div",{className:"flex items-center space-x-6",children:l.map(c=>c.label==="Live Detection"?S.jsx("button",{onClick:()=>e("/live-detection"),className:"font-medium transition-colors text-wellness-600 hover:text-primary-500",children:c.label},c.href):S.jsx("button",{onClick:()=>e(c.href),className:`font-medium transition-colors ${t===c.href?"text-primary-500":"text-wellness-600 hover:text-primary-500"}`,children:c.label},c.href))}),S.jsx("div",{className:"flex items-center space-x-3",children:r?S.jsxs("div",{className:"relative",children:[S.jsx("button",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-primary-500 to-secondary-500 flex items-center justify-center font-bold text-white text-lg hover:shadow-lg transition-all",style:{minWidth:40,minHeight:40},onClick:()=>a(c=>!c),onBlur:()=>setTimeout(()=>a(!1),150),children:(()=>{try{const c=JSON.parse(localStorage.getItem("user")||"{}");return c.username?c.username.charAt(0).toUpperCase():"U"}catch{return"U"}})()}),o&&S.jsxs("div",{className:"absolute right-0 mt-1 bg-white border rounded shadow z-50 min-w-[100px] py-1 text-sm",style:{top:"100%"},children:[S.jsx("button",{className:"w-full px-3 py-1 text-left hover:bg-gray-100 rounded",onMouseDown:()=>e("/profile"),children:"Profile"}),S.jsx("button",{className:"w-full px-3 py-1 text-left hover:bg-gray-100 text-red-600 rounded",onMouseDown:()=>{localStorage.removeItem("user"),e("/login")},children:"Logout"})]})]}):S.jsxs(S.Fragment,{children:[S.jsx(lt,{onClick:()=>window.open("https://youtu.be/dQw4w9WgXcQ","_blank"),variant:"outline",size:"sm",className:"px-4 py-2 border-primary-500 text-primary-600 hover:bg-primary-50 transition-colors",children:"Watch Demo"}),S.jsx(lt,{onClick:()=>e("/login"),variant:"ghost",size:"sm",className:"px-4 py-2 text-wellness-600 hover:bg-gray-100 transition-colors",children:"Log In"}),S.jsx(lt,{onClick:()=>e("/signup"),size:"sm",className:"gradient-bg text-white px-4 py-2 rounded-full font-medium hover:shadow-lg transform hover:scale-105 transition-all",children:"Sign Up"}),S.jsx(lt,{onClick:()=>e("/assessment"),size:"sm",className:"bg-secondary-500 text-white px-4 py-2 rounded-full font-medium hover:bg-secondary-600 transform hover:scale-105 transition-all",children:"Get Started"})]})})]}),S.jsx("button",{className:"md:hidden text-wellness-600",onClick:()=>s(!n),children:n?S.jsx(P_,{className:"w-6 h-6"}):S.jsx(hW,{className:"w-6 h-6"})})]}),n&&S.jsx("div",{className:"md:hidden mt-4 pb-4 border-t border-wellness-200 pt-4",children:S.jsxs("div",{className:"flex flex-col space-y-4",children:[l.map(c=>S.jsx("button",{onClick:()=>{e(c.href),s(!1)},className:`text-left font-medium transition-colors ${t===c.href?"text-primary-500":"text-wellness-600 hover:text-primary-500"}`,children:c.label},c.href)),S.jsx("div",{className:"flex flex-col space-y-3 pt-2",children:r?S.jsxs("div",{className:"relative",children:[S.jsx("button",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-primary-500 to-secondary-500 flex items-center justify-center font-bold text-white text-lg hover:shadow-lg transition-all",style:{minWidth:40,minHeight:40},onClick:()=>a(c=>!c),onBlur:()=>setTimeout(()=>a(!1),150),children:(()=>{try{const c=JSON.parse(localStorage.getItem("user")||"{}");return c.username?c.username.charAt(0).toUpperCase():"U"}catch{return"U"}})()}),o&&S.jsxs("div",{className:"absolute left-0 w-full mt-2 bg-white border rounded shadow z-50 min-w-[100px] py-1 text-sm",style:{top:"100%"},children:[S.jsx("button",{className:"w-full px-3 py-1 text-left hover:bg-gray-100 rounded",onMouseDown:()=>{e("/profile"),s(!1)},children:"Profile"}),S.jsx("button",{className:"w-full px-3 py-1 text-left hover:bg-gray-100 text-red-600 rounded",onMouseDown:()=>{localStorage.removeItem("user"),e("/login"),s(!1)},children:"Logout"})]})]}):S.jsxs(S.Fragment,{children:[S.jsx(lt,{onClick:()=>{window.open("https://youtu.be/dQw4w9WgXcQ","_blank"),s(!1)},variant:"outline",className:"border-primary-500 text-primary-600 hover:bg-primary-50 w-fit",children:"Watch Demo"}),S.jsxs("div",{className:"flex gap-2",children:[S.jsx(lt,{onClick:()=>{e("/login"),s(!1)},variant:"ghost",size:"sm",className:"text-wellness-600 hover:bg-gray-100",children:"Log In"}),S.jsx(lt,{onClick:()=>{e("/signup"),s(!1)},size:"sm",className:"gradient-bg text-white px-4 py-2 rounded-full font-medium",children:"Sign Up"})]}),S.jsx(lt,{onClick:()=>{e("/assessment"),s(!1)},className:"bg-secondary-500 text-white px-6 py-2 rounded-full font-medium hover:bg-secondary-600 w-fit",children:"Get Started"})]})})]})})]})})}const nU=D.createContext({});function t1(t){const e=D.useRef(null);return e.current===null&&(e.current=t()),e.current}const G_=D.createContext(null),K_=D.createContext({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"});function zse(t=!0){const e=D.useContext(G_);if(e===null)return[!0,null];const{isPresent:n,onExitComplete:s,register:r}=e,i=D.useId();D.useEffect(()=>{t&&r(i)},[t]);const o=D.useCallback(()=>t&&s&&s(i),[i,s,t]);return!n&&s?[!1,o]:[!0]}const q_=typeof window<"u",X_=q_?D.useLayoutEffect:D.useEffect,kr=t=>t;let Vse=kr,sU=kr;function Y_(t){let e;return()=>(e===void 0&&(e=t()),e)}const pd=(t,e,n)=>{const s=e-t;return s===0?1:(n-t)/s},ol=t=>t*1e3,al=t=>t/1e3,jse={skipAnimations:!1,useManualTiming:!1};function Bse(t){let e=new Set,n=new Set,s=!1,r=!1;const i=new WeakSet;let o={delta:0,timestamp:0,isProcessing:!1};function a(c){i.has(c)&&(l.schedule(c),t()),c(o)}const l={schedule:(c,u=!1,d=!1)=>{const f=d&&s?e:n;return u&&i.add(c),f.has(c)||f.add(c),c},cancel:c=>{n.delete(c),i.delete(c)},process:c=>{if(o=c,s){r=!0;return}s=!0,[e,n]=[n,e],e.forEach(a),e.clear(),s=!1,r&&(r=!1,l.process(c))}};return l}const Sx=["read","resolveKeyframes","update","preRender","render","postRender"],Wse=40;function rU(t,e){let n=!1,s=!0;const r={delta:0,timestamp:0,isProcessing:!1},i=()=>n=!0,o=Sx.reduce((y,x)=>(y[x]=Bse(i),y),{}),{read:a,resolveKeyframes:l,update:c,preRender:u,render:d,postRender:h}=o,f=()=>{const y=performance.now();n=!1,r.delta=s?1e3/60:Math.max(Math.min(y-r.timestamp,Wse),1),r.timestamp=y,r.isProcessing=!0,a.process(r),l.process(r),c.process(r),u.process(r),d.process(r),h.process(r),r.isProcessing=!1,n&&e&&(s=!1,t(f))},p=()=>{n=!0,s=!0,r.isProcessing||t(f)};return{schedule:Sx.reduce((y,x)=>{const v=o[x];return y[x]=(b,k=!1,C=!1)=>(n||p(),v.schedule(b,k,C)),y},{}),cancel:y=>{for(let x=0;x<Sx.length;x++)o[Sx[x]].cancel(y)},state:r,steps:o}}const{schedule:jt,cancel:Lo,state:As,steps:lC}=rU(typeof requestAnimationFrame<"u"?requestAnimationFrame:kr,!0),iU=D.createContext({strict:!1}),tF={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},bf={};for(const t in tF)bf[t]={isEnabled:e=>tF[t].some(n=>!!e[n])};function Use(t){for(const e in t)bf[e]={...bf[e],...t[e]}}const Hse=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function yb(t){return t.startsWith("while")||t.startsWith("drag")&&t!=="draggable"||t.startsWith("layout")||t.startsWith("onTap")||t.startsWith("onPan")||t.startsWith("onLayout")||Hse.has(t)}let oU=t=>!yb(t);function Gse(t){t&&(oU=e=>e.startsWith("on")?!yb(e):t(e))}try{Gse(require("@emotion/is-prop-valid").default)}catch{}function Kse(t,e,n){const s={};for(const r in t)r==="values"&&typeof t.values=="object"||(oU(r)||n===!0&&yb(r)||!e&&!yb(r)||t.draggable&&r.startsWith("onDrag"))&&(s[r]=t[r]);return s}function qse(t){if(typeof Proxy>"u")return t;const e=new Map,n=(...s)=>t(...s);return new Proxy(n,{get:(s,r)=>r==="create"?t:(e.has(r)||e.set(r,t(r)),e.get(r))})}const n1=D.createContext({});function dg(t){return typeof t=="string"||Array.isArray(t)}function s1(t){return t!==null&&typeof t=="object"&&typeof t.start=="function"}const Z_=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],Q_=["initial",...Z_];function r1(t){return s1(t.animate)||Q_.some(e=>dg(t[e]))}function aU(t){return!!(r1(t)||t.variants)}function Xse(t,e){if(r1(t)){const{initial:n,animate:s}=t;return{initial:n===!1||dg(n)?n:void 0,animate:dg(s)?s:void 0}}return t.inherit!==!1?e:{}}function Yse(t){const{initial:e,animate:n}=Xse(t,D.useContext(n1));return D.useMemo(()=>({initial:e,animate:n}),[nF(e),nF(n)])}function nF(t){return Array.isArray(t)?t.join(" "):t}const Zse=Symbol.for("motionComponentSymbol");function kh(t){return t&&typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function Qse(t,e,n){return D.useCallback(s=>{s&&t.onMount&&t.onMount(s),e&&(s?e.mount(s):e.unmount()),n&&(typeof n=="function"?n(s):kh(n)&&(n.current=s))},[e])}const J_=t=>t.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),Jse="framerAppearId",lU="data-"+J_(Jse),{schedule:eE,cancel:YWe}=rU(queueMicrotask,!1),cU=D.createContext({});function ere(t,e,n,s,r){var i,o;const{visualElement:a}=D.useContext(n1),l=D.useContext(iU),c=D.useContext(G_),u=D.useContext(K_).reducedMotion,d=D.useRef(null);s=s||l.renderer,!d.current&&s&&(d.current=s(t,{visualState:e,parent:a,props:n,presenceContext:c,blockInitialAnimation:c?c.initial===!1:!1,reducedMotionConfig:u}));const h=d.current,f=D.useContext(cU);h&&!h.projection&&r&&(h.type==="html"||h.type==="svg")&&tre(d.current,n,r,f);const p=D.useRef(!1);D.useInsertionEffect(()=>{h&&p.current&&h.update(n,c)});const m=n[lU],g=D.useRef(!!m&&!(!((i=window.MotionHandoffIsComplete)===null||i===void 0)&&i.call(window,m))&&((o=window.MotionHasOptimisedAnimation)===null||o===void 0?void 0:o.call(window,m)));return X_(()=>{h&&(p.current=!0,window.MotionIsMounted=!0,h.updateFeatures(),eE.render(h.render),g.current&&h.animationState&&h.animationState.animateChanges())}),D.useEffect(()=>{h&&(!g.current&&h.animationState&&h.animationState.animateChanges(),g.current&&(queueMicrotask(()=>{var y;(y=window.MotionHandoffMarkAsComplete)===null||y===void 0||y.call(window,m)}),g.current=!1))}),h}function tre(t,e,n,s){const{layoutId:r,layout:i,drag:o,dragConstraints:a,layoutScroll:l,layoutRoot:c}=e;t.projection=new n(t.latestValues,e["data-framer-portal-id"]?void 0:uU(t.parent)),t.projection.setOptions({layoutId:r,layout:i,alwaysMeasureLayout:!!o||a&&kh(a),visualElement:t,animationType:typeof i=="string"?i:"both",initialPromotionConfig:s,layoutScroll:l,layoutRoot:c})}function uU(t){if(t)return t.options.allowProjection!==!1?t.projection:uU(t.parent)}function nre({preloadedFeatures:t,createVisualElement:e,useRender:n,useVisualState:s,Component:r}){var i,o;t&&Use(t);function a(c,u){let d;const h={...D.useContext(K_),...c,layoutId:sre(c)},{isStatic:f}=h,p=Yse(c),m=s(c,f);if(!f&&q_){rre();const g=ire(h);d=g.MeasureLayout,p.visualElement=ere(r,m,h,e,g.ProjectionNode)}return S.jsxs(n1.Provider,{value:p,children:[d&&p.visualElement?S.jsx(d,{visualElement:p.visualElement,...h}):null,n(r,c,Qse(m,p.visualElement,u),m,f,p.visualElement)]})}a.displayName=`motion.${typeof r=="string"?r:`create(${(o=(i=r.displayName)!==null&&i!==void 0?i:r.name)!==null&&o!==void 0?o:""})`}`;const l=D.forwardRef(a);return l[Zse]=r,l}function sre({layoutId:t}){const e=D.useContext(nU).id;return e&&t!==void 0?e+"-"+t:t}function rre(t,e){D.useContext(iU).strict}function ire(t){const{drag:e,layout:n}=bf;if(!e&&!n)return{};const s={...e,...n};return{MeasureLayout:e!=null&&e.isEnabled(t)||n!=null&&n.isEnabled(t)?s.MeasureLayout:void 0,ProjectionNode:s.ProjectionNode}}const ore=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function tE(t){return typeof t!="string"||t.includes("-")?!1:!!(ore.indexOf(t)>-1||/[A-Z]/u.test(t))}function sF(t){const e=[{},{}];return t==null||t.values.forEach((n,s)=>{e[0][s]=n.get(),e[1][s]=n.getVelocity()}),e}function nE(t,e,n,s){if(typeof e=="function"){const[r,i]=sF(s);e=e(n!==void 0?n:t.custom,r,i)}if(typeof e=="string"&&(e=t.variants&&t.variants[e]),typeof e=="function"){const[r,i]=sF(s);e=e(n!==void 0?n:t.custom,r,i)}return e}const RN=t=>Array.isArray(t),are=t=>!!(t&&typeof t=="object"&&t.mix&&t.toValue),lre=t=>RN(t)?t[t.length-1]||0:t,or=t=>!!(t&&t.getVelocity);function wv(t){const e=or(t)?t.get():t;return are(e)?e.toValue():e}function cre({scrapeMotionValuesFromProps:t,createRenderState:e,onUpdate:n},s,r,i){const o={latestValues:ure(s,r,i,t),renderState:e()};return n&&(o.onMount=a=>n({props:s,current:a,...o}),o.onUpdate=a=>n(a)),o}const dU=t=>(e,n)=>{const s=D.useContext(n1),r=D.useContext(G_),i=()=>cre(t,e,s,r);return n?i():t1(i)};function ure(t,e,n,s){const r={},i=s(t,{});for(const h in i)r[h]=wv(i[h]);let{initial:o,animate:a}=t;const l=r1(t),c=aU(t);e&&c&&!l&&t.inherit!==!1&&(o===void 0&&(o=e.initial),a===void 0&&(a=e.animate));let u=n?n.initial===!1:!1;u=u||o===!1;const d=u?a:o;if(d&&typeof d!="boolean"&&!s1(d)){const h=Array.isArray(d)?d:[d];for(let f=0;f<h.length;f++){const p=nE(t,h[f]);if(p){const{transitionEnd:m,transition:g,...y}=p;for(const x in y){let v=y[x];if(Array.isArray(v)){const b=u?v.length-1:0;v=v[b]}v!==null&&(r[x]=v)}for(const x in m)r[x]=m[x]}}}return r}const Qf=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Ad=new Set(Qf),hU=t=>e=>typeof e=="string"&&e.startsWith(t),fU=hU("--"),dre=hU("var(--"),sE=t=>dre(t)?hre.test(t.split("/*")[0].trim()):!1,hre=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,pU=(t,e)=>e&&typeof t=="number"?e.transform(t):t,Ia=(t,e,n)=>n>e?e:n<t?t:n,Jf={test:t=>typeof t=="number",parse:parseFloat,transform:t=>t},hg={...Jf,transform:t=>Ia(0,1,t)},kx={...Jf,default:1},ay=t=>({test:e=>typeof e=="string"&&e.endsWith(t)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${t}`}),Pl=ay("deg"),ya=ay("%"),nt=ay("px"),fre=ay("vh"),pre=ay("vw"),rF={...ya,parse:t=>ya.parse(t)/100,transform:t=>ya.transform(t*100)},mre={borderWidth:nt,borderTopWidth:nt,borderRightWidth:nt,borderBottomWidth:nt,borderLeftWidth:nt,borderRadius:nt,radius:nt,borderTopLeftRadius:nt,borderTopRightRadius:nt,borderBottomRightRadius:nt,borderBottomLeftRadius:nt,width:nt,maxWidth:nt,height:nt,maxHeight:nt,top:nt,right:nt,bottom:nt,left:nt,padding:nt,paddingTop:nt,paddingRight:nt,paddingBottom:nt,paddingLeft:nt,margin:nt,marginTop:nt,marginRight:nt,marginBottom:nt,marginLeft:nt,backgroundPositionX:nt,backgroundPositionY:nt},gre={rotate:Pl,rotateX:Pl,rotateY:Pl,rotateZ:Pl,scale:kx,scaleX:kx,scaleY:kx,scaleZ:kx,skew:Pl,skewX:Pl,skewY:Pl,distance:nt,translateX:nt,translateY:nt,translateZ:nt,x:nt,y:nt,z:nt,perspective:nt,transformPerspective:nt,opacity:hg,originX:rF,originY:rF,originZ:nt},iF={...Jf,transform:Math.round},rE={...mre,...gre,zIndex:iF,size:nt,fillOpacity:hg,strokeOpacity:hg,numOctaves:iF},yre={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},xre=Qf.length;function vre(t,e,n){let s="",r=!0;for(let i=0;i<xre;i++){const o=Qf[i],a=t[o];if(a===void 0)continue;let l=!0;if(typeof a=="number"?l=a===(o.startsWith("scale")?1:0):l=parseFloat(a)===0,!l||n){const c=pU(a,rE[o]);if(!l){r=!1;const u=yre[o]||o;s+=`${u}(${c}) `}n&&(e[o]=c)}}return s=s.trim(),n?s=n(e,r?"":s):r&&(s="none"),s}function iE(t,e,n){const{style:s,vars:r,transformOrigin:i}=t;let o=!1,a=!1;for(const l in e){const c=e[l];if(Ad.has(l)){o=!0;continue}else if(fU(l)){r[l]=c;continue}else{const u=pU(c,rE[l]);l.startsWith("origin")?(a=!0,i[l]=u):s[l]=u}}if(e.transform||(o||n?s.transform=vre(e,t.transform,n):s.transform&&(s.transform="none")),a){const{originX:l="50%",originY:c="50%",originZ:u=0}=i;s.transformOrigin=`${l} ${c} ${u}`}}const bre={offset:"stroke-dashoffset",array:"stroke-dasharray"},wre={offset:"strokeDashoffset",array:"strokeDasharray"};function Sre(t,e,n=1,s=0,r=!0){t.pathLength=1;const i=r?bre:wre;t[i.offset]=nt.transform(-s);const o=nt.transform(e),a=nt.transform(n);t[i.array]=`${o} ${a}`}function oF(t,e,n){return typeof t=="string"?t:nt.transform(e+n*t)}function kre(t,e,n){const s=oF(e,t.x,t.width),r=oF(n,t.y,t.height);return`${s} ${r}`}function oE(t,{attrX:e,attrY:n,attrScale:s,originX:r,originY:i,pathLength:o,pathSpacing:a=1,pathOffset:l=0,...c},u,d){if(iE(t,c,d),u){t.style.viewBox&&(t.attrs.viewBox=t.style.viewBox);return}t.attrs=t.style,t.style={};const{attrs:h,style:f,dimensions:p}=t;h.transform&&(p&&(f.transform=h.transform),delete h.transform),p&&(r!==void 0||i!==void 0||f.transform)&&(f.transformOrigin=kre(p,r!==void 0?r:.5,i!==void 0?i:.5)),e!==void 0&&(h.x=e),n!==void 0&&(h.y=n),s!==void 0&&(h.scale=s),o!==void 0&&Sre(h,o,a,l,!1)}const aE=()=>({style:{},transform:{},transformOrigin:{},vars:{}}),mU=()=>({...aE(),attrs:{}}),lE=t=>typeof t=="string"&&t.toLowerCase()==="svg";function gU(t,{style:e,vars:n},s,r){Object.assign(t.style,e,r&&r.getProjectionStyles(s));for(const i in n)t.style.setProperty(i,n[i])}const yU=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function xU(t,e,n,s){gU(t,e,void 0,s);for(const r in e.attrs)t.setAttribute(yU.has(r)?r:J_(r),e.attrs[r])}const xb={};function Cre(t){Object.assign(xb,t)}function vU(t,{layout:e,layoutId:n}){return Ad.has(t)||t.startsWith("origin")||(e||n!==void 0)&&(!!xb[t]||t==="opacity")}function cE(t,e,n){var s;const{style:r}=t,i={};for(const o in r)(or(r[o])||e.style&&or(e.style[o])||vU(o,t)||((s=n==null?void 0:n.getValue(o))===null||s===void 0?void 0:s.liveStyle)!==void 0)&&(i[o]=r[o]);return i}function bU(t,e,n){const s=cE(t,e,n);for(const r in t)if(or(t[r])||or(e[r])){const i=Qf.indexOf(r)!==-1?"attr"+r.charAt(0).toUpperCase()+r.substring(1):r;s[i]=t[r]}return s}function Tre(t,e){try{e.dimensions=typeof t.getBBox=="function"?t.getBBox():t.getBoundingClientRect()}catch{e.dimensions={x:0,y:0,width:0,height:0}}}const aF=["x","y","width","height","cx","cy","r"],Nre={useVisualState:dU({scrapeMotionValuesFromProps:bU,createRenderState:mU,onUpdate:({props:t,prevProps:e,current:n,renderState:s,latestValues:r})=>{if(!n)return;let i=!!t.drag;if(!i){for(const a in r)if(Ad.has(a)){i=!0;break}}if(!i)return;let o=!e;if(e)for(let a=0;a<aF.length;a++){const l=aF[a];t[l]!==e[l]&&(o=!0)}o&&jt.read(()=>{Tre(n,s),jt.render(()=>{oE(s,r,lE(n.tagName),t.transformTemplate),xU(n,s)})})}})},Ire={useVisualState:dU({scrapeMotionValuesFromProps:cE,createRenderState:aE})};function wU(t,e,n){for(const s in e)!or(e[s])&&!vU(s,n)&&(t[s]=e[s])}function _re({transformTemplate:t},e){return D.useMemo(()=>{const n=aE();return iE(n,e,t),Object.assign({},n.vars,n.style)},[e])}function Ere(t,e){const n=t.style||{},s={};return wU(s,n,t),Object.assign(s,_re(t,e)),s}function $re(t,e){const n={},s=Ere(t,e);return t.drag&&t.dragListener!==!1&&(n.draggable=!1,s.userSelect=s.WebkitUserSelect=s.WebkitTouchCallout="none",s.touchAction=t.drag===!0?"none":`pan-${t.drag==="x"?"y":"x"}`),t.tabIndex===void 0&&(t.onTap||t.onTapStart||t.whileTap)&&(n.tabIndex=0),n.style=s,n}function Are(t,e,n,s){const r=D.useMemo(()=>{const i=mU();return oE(i,e,lE(s),t.transformTemplate),{...i.attrs,style:{...i.style}}},[e]);if(t.style){const i={};wU(i,t.style,t),r.style={...i,...r.style}}return r}function Rre(t=!1){return(n,s,r,{latestValues:i},o)=>{const l=(tE(n)?Are:$re)(s,i,o,n),c=Kse(s,typeof n=="string",t),u=n!==D.Fragment?{...c,...l,ref:r}:{},{children:d}=s,h=D.useMemo(()=>or(d)?d.get():d,[d]);return D.createElement(n,{...u,children:h})}}function Dre(t,e){return function(s,{forwardMotionProps:r}={forwardMotionProps:!1}){const o={...tE(s)?Nre:Ire,preloadedFeatures:t,useRender:Rre(r),createVisualElement:e,Component:s};return nre(o)}}function SU(t,e){if(!Array.isArray(e))return!1;const n=e.length;if(n!==t.length)return!1;for(let s=0;s<n;s++)if(e[s]!==t[s])return!1;return!0}function i1(t,e,n){const s=t.getProps();return nE(s,e,n!==void 0?n:s.custom,t)}const kU=Y_(()=>window.ScrollTimeline!==void 0);class Ore{constructor(e){this.stop=()=>this.runAll("stop"),this.animations=e.filter(Boolean)}get finished(){return Promise.all(this.animations.map(e=>"finished"in e?e.finished:e))}getAll(e){return this.animations[0][e]}setAll(e,n){for(let s=0;s<this.animations.length;s++)this.animations[s][e]=n}attachTimeline(e,n){const s=this.animations.map(r=>{if(kU()&&r.attachTimeline)return r.attachTimeline(e);if(typeof n=="function")return n(r)});return()=>{s.forEach((r,i)=>{r&&r(),this.animations[i].stop()})}}get time(){return this.getAll("time")}set time(e){this.setAll("time",e)}get speed(){return this.getAll("speed")}set speed(e){this.setAll("speed",e)}get startTime(){return this.getAll("startTime")}get duration(){let e=0;for(let n=0;n<this.animations.length;n++)e=Math.max(e,this.animations[n].duration);return e}runAll(e){this.animations.forEach(n=>n[e]())}flatten(){this.runAll("flatten")}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}class Pre extends Ore{then(e,n){return Promise.all(this.animations).then(e).catch(n)}}function uE(t,e){return t?t[e]||t.default||t:void 0}const DN=2e4;function CU(t){let e=0;const n=50;let s=t.next(e);for(;!s.done&&e<DN;)e+=n,s=t.next(e);return e>=DN?1/0:e}function dE(t){return typeof t=="function"}function lF(t,e){t.timeline=e,t.onfinish=null}const hE=t=>Array.isArray(t)&&typeof t[0]=="number",Fre={linearEasing:void 0};function Lre(t,e){const n=Y_(t);return()=>{var s;return(s=Fre[e])!==null&&s!==void 0?s:n()}}const vb=Lre(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),TU=(t,e,n=10)=>{let s="";const r=Math.max(Math.round(e/n),2);for(let i=0;i<r;i++)s+=t(pd(0,r-1,i))+", ";return`linear(${s.substring(0,s.length-2)})`};function NU(t){return!!(typeof t=="function"&&vb()||!t||typeof t=="string"&&(t in ON||vb())||hE(t)||Array.isArray(t)&&t.every(NU))}const sm=([t,e,n,s])=>`cubic-bezier(${t}, ${e}, ${n}, ${s})`,ON={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:sm([0,.65,.55,1]),circOut:sm([.55,0,1,.45]),backIn:sm([.31,.01,.66,-.59]),backOut:sm([.33,1.53,.69,.99])};function IU(t,e){if(t)return typeof t=="function"&&vb()?TU(t,e):hE(t)?sm(t):Array.isArray(t)?t.map(n=>IU(n,e)||ON.easeOut):ON[t]}const xo={x:!1,y:!1};function _U(){return xo.x||xo.y}function EU(t,e,n){var s;if(t instanceof Element)return[t];if(typeof t=="string"){let r=document;e&&(r=e.current);const i=(s=n==null?void 0:n[t])!==null&&s!==void 0?s:r.querySelectorAll(t);return i?Array.from(i):[]}return Array.from(t)}function $U(t,e){const n=EU(t),s=new AbortController,r={passive:!0,...e,signal:s.signal};return[n,r,()=>s.abort()]}function cF(t){return e=>{e.pointerType==="touch"||_U()||t(e)}}function Mre(t,e,n={}){const[s,r,i]=$U(t,n),o=cF(a=>{const{target:l}=a,c=e(a);if(typeof c!="function"||!l)return;const u=cF(d=>{c(d),l.removeEventListener("pointerleave",u)});l.addEventListener("pointerleave",u,r)});return s.forEach(a=>{a.addEventListener("pointerenter",o,r)}),i}const AU=(t,e)=>e?t===e?!0:AU(t,e.parentElement):!1,fE=t=>t.pointerType==="mouse"?typeof t.button!="number"||t.button<=0:t.isPrimary!==!1,zre=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function Vre(t){return zre.has(t.tagName)||t.tabIndex!==-1}const rm=new WeakSet;function uF(t){return e=>{e.key==="Enter"&&t(e)}}function cC(t,e){t.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const jre=(t,e)=>{const n=t.currentTarget;if(!n)return;const s=uF(()=>{if(rm.has(n))return;cC(n,"down");const r=uF(()=>{cC(n,"up")}),i=()=>cC(n,"cancel");n.addEventListener("keyup",r,e),n.addEventListener("blur",i,e)});n.addEventListener("keydown",s,e),n.addEventListener("blur",()=>n.removeEventListener("keydown",s),e)};function dF(t){return fE(t)&&!_U()}function Bre(t,e,n={}){const[s,r,i]=$U(t,n),o=a=>{const l=a.currentTarget;if(!dF(a)||rm.has(l))return;rm.add(l);const c=e(a),u=(f,p)=>{window.removeEventListener("pointerup",d),window.removeEventListener("pointercancel",h),!(!dF(f)||!rm.has(l))&&(rm.delete(l),typeof c=="function"&&c(f,{success:p}))},d=f=>{u(f,n.useGlobalTarget||AU(l,f.target))},h=f=>{u(f,!1)};window.addEventListener("pointerup",d,r),window.addEventListener("pointercancel",h,r)};return s.forEach(a=>{!Vre(a)&&a.getAttribute("tabindex")===null&&(a.tabIndex=0),(n.useGlobalTarget?window:a).addEventListener("pointerdown",o,r),a.addEventListener("focus",c=>jre(c,r),r)}),i}function Wre(t){return t==="x"||t==="y"?xo[t]?null:(xo[t]=!0,()=>{xo[t]=!1}):xo.x||xo.y?null:(xo.x=xo.y=!0,()=>{xo.x=xo.y=!1})}const RU=new Set(["width","height","top","left","right","bottom",...Qf]);let Sv;function Ure(){Sv=void 0}const xa={now:()=>(Sv===void 0&&xa.set(As.isProcessing||jse.useManualTiming?As.timestamp:performance.now()),Sv),set:t=>{Sv=t,queueMicrotask(Ure)}};function pE(t,e){t.indexOf(e)===-1&&t.push(e)}function mE(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}class gE{constructor(){this.subscriptions=[]}add(e){return pE(this.subscriptions,e),()=>mE(this.subscriptions,e)}notify(e,n,s){const r=this.subscriptions.length;if(r)if(r===1)this.subscriptions[0](e,n,s);else for(let i=0;i<r;i++){const o=this.subscriptions[i];o&&o(e,n,s)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}function yE(t,e){return e?t*(1e3/e):0}const hF=30,Hre=t=>!isNaN(parseFloat(t)),Dm={current:void 0};class Gre{constructor(e,n={}){this.version="11.18.2",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(s,r=!0)=>{const i=xa.now();this.updatedAt!==i&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(s),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),r&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(e),this.owner=n.owner}setCurrent(e){this.current=e,this.updatedAt=xa.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=Hre(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,n){this.events[e]||(this.events[e]=new gE);const s=this.events[e].add(n);return e==="change"?()=>{s(),jt.read(()=>{this.events.change.getSize()||this.stop()})}:s}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,n){this.passiveEffect=e,this.stopPassiveEffect=n}set(e,n=!0){!n||!this.passiveEffect?this.updateAndNotify(e,n):this.passiveEffect(e,this.updateAndNotify)}setWithVelocity(e,n,s){this.set(n),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-s}jump(e,n=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,n&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return Dm.current&&Dm.current.push(this),this.current}getPrevious(){return this.prev}getVelocity(){const e=xa.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>hF)return 0;const n=Math.min(this.updatedAt-this.prevUpdatedAt,hF);return yE(parseFloat(this.current)-parseFloat(this.prevFrameValue),n)}start(e){return this.stop(),new Promise(n=>{this.hasAnimated=!0,this.animation=e(n),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function ca(t,e){return new Gre(t,e)}function Kre(t,e,n){t.hasValue(e)?t.getValue(e).set(n):t.addValue(e,ca(n))}function qre(t,e){const n=i1(t,e);let{transitionEnd:s={},transition:r={},...i}=n||{};i={...i,...s};for(const o in i){const a=lre(i[o]);Kre(t,o,a)}}function Xre(t){return!!(or(t)&&t.add)}function PN(t,e){const n=t.getValue("willChange");if(Xre(n))return n.add(e)}function DU(t){return t.props[lU]}const OU=(t,e,n)=>(((1-3*n+3*e)*t+(3*n-6*e))*t+3*e)*t,Yre=1e-7,Zre=12;function Qre(t,e,n,s,r){let i,o,a=0;do o=e+(n-e)/2,i=OU(o,s,r)-t,i>0?n=o:e=o;while(Math.abs(i)>Yre&&++a<Zre);return o}function ly(t,e,n,s){if(t===e&&n===s)return kr;const r=i=>Qre(i,0,1,t,n);return i=>i===0||i===1?i:OU(r(i),e,s)}const PU=t=>e=>e<=.5?t(2*e)/2:(2-t(2*(1-e)))/2,FU=t=>e=>1-t(1-e),LU=ly(.33,1.53,.69,.99),xE=FU(LU),MU=PU(xE),zU=t=>(t*=2)<1?.5*xE(t):.5*(2-Math.pow(2,-10*(t-1))),vE=t=>1-Math.sin(Math.acos(t)),VU=FU(vE),jU=PU(vE),BU=t=>/^0[^.\s]+$/u.test(t);function Jre(t){return typeof t=="number"?t===0:t!==null?t==="none"||t==="0"||BU(t):!0}const Om=t=>Math.round(t*1e5)/1e5,bE=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function eie(t){return t==null}const tie=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,wE=(t,e)=>n=>!!(typeof n=="string"&&tie.test(n)&&n.startsWith(t)||e&&!eie(n)&&Object.prototype.hasOwnProperty.call(n,e)),WU=(t,e,n)=>s=>{if(typeof s!="string")return s;const[r,i,o,a]=s.match(bE);return{[t]:parseFloat(r),[e]:parseFloat(i),[n]:parseFloat(o),alpha:a!==void 0?parseFloat(a):1}},nie=t=>Ia(0,255,t),uC={...Jf,transform:t=>Math.round(nie(t))},Ou={test:wE("rgb","red"),parse:WU("red","green","blue"),transform:({red:t,green:e,blue:n,alpha:s=1})=>"rgba("+uC.transform(t)+", "+uC.transform(e)+", "+uC.transform(n)+", "+Om(hg.transform(s))+")"};function sie(t){let e="",n="",s="",r="";return t.length>5?(e=t.substring(1,3),n=t.substring(3,5),s=t.substring(5,7),r=t.substring(7,9)):(e=t.substring(1,2),n=t.substring(2,3),s=t.substring(3,4),r=t.substring(4,5),e+=e,n+=n,s+=s,r+=r),{red:parseInt(e,16),green:parseInt(n,16),blue:parseInt(s,16),alpha:r?parseInt(r,16)/255:1}}const FN={test:wE("#"),parse:sie,transform:Ou.transform},Ch={test:wE("hsl","hue"),parse:WU("hue","saturation","lightness"),transform:({hue:t,saturation:e,lightness:n,alpha:s=1})=>"hsla("+Math.round(t)+", "+ya.transform(Om(e))+", "+ya.transform(Om(n))+", "+Om(hg.transform(s))+")"},er={test:t=>Ou.test(t)||FN.test(t)||Ch.test(t),parse:t=>Ou.test(t)?Ou.parse(t):Ch.test(t)?Ch.parse(t):FN.parse(t),transform:t=>typeof t=="string"?t:t.hasOwnProperty("red")?Ou.transform(t):Ch.transform(t)},rie=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function iie(t){var e,n;return isNaN(t)&&typeof t=="string"&&(((e=t.match(bE))===null||e===void 0?void 0:e.length)||0)+(((n=t.match(rie))===null||n===void 0?void 0:n.length)||0)>0}const UU="number",HU="color",oie="var",aie="var(",fF="${}",lie=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function fg(t){const e=t.toString(),n=[],s={color:[],number:[],var:[]},r=[];let i=0;const a=e.replace(lie,l=>(er.test(l)?(s.color.push(i),r.push(HU),n.push(er.parse(l))):l.startsWith(aie)?(s.var.push(i),r.push(oie),n.push(l)):(s.number.push(i),r.push(UU),n.push(parseFloat(l))),++i,fF)).split(fF);return{values:n,split:a,indexes:s,types:r}}function GU(t){return fg(t).values}function KU(t){const{split:e,types:n}=fg(t),s=e.length;return r=>{let i="";for(let o=0;o<s;o++)if(i+=e[o],r[o]!==void 0){const a=n[o];a===UU?i+=Om(r[o]):a===HU?i+=er.transform(r[o]):i+=r[o]}return i}}const cie=t=>typeof t=="number"?0:t;function uie(t){const e=GU(t);return KU(t)(e.map(cie))}const Oc={test:iie,parse:GU,createTransformer:KU,getAnimatableNone:uie},die=new Set(["brightness","contrast","saturate","opacity"]);function hie(t){const[e,n]=t.slice(0,-1).split("(");if(e==="drop-shadow")return t;const[s]=n.match(bE)||[];if(!s)return t;const r=n.replace(s,"");let i=die.has(e)?1:0;return s!==n&&(i*=100),e+"("+i+r+")"}const fie=/\b([a-z-]*)\(.*?\)/gu,LN={...Oc,getAnimatableNone:t=>{const e=t.match(fie);return e?e.map(hie).join(" "):t}},pie={...rE,color:er,backgroundColor:er,outlineColor:er,fill:er,stroke:er,borderColor:er,borderTopColor:er,borderRightColor:er,borderBottomColor:er,borderLeftColor:er,filter:LN,WebkitFilter:LN},SE=t=>pie[t];function qU(t,e){let n=SE(t);return n!==LN&&(n=Oc),n.getAnimatableNone?n.getAnimatableNone(e):void 0}const mie=new Set(["auto","none","0"]);function gie(t,e,n){let s=0,r;for(;s<t.length&&!r;){const i=t[s];typeof i=="string"&&!mie.has(i)&&fg(i).values.length&&(r=t[s]),s++}if(r&&n)for(const i of e)t[i]=qU(n,r)}const pF=t=>t===Jf||t===nt,mF=(t,e)=>parseFloat(t.split(", ")[e]),gF=(t,e)=>(n,{transform:s})=>{if(s==="none"||!s)return 0;const r=s.match(/^matrix3d\((.+)\)$/u);if(r)return mF(r[1],e);{const i=s.match(/^matrix\((.+)\)$/u);return i?mF(i[1],t):0}},yie=new Set(["x","y","z"]),xie=Qf.filter(t=>!yie.has(t));function vie(t){const e=[];return xie.forEach(n=>{const s=t.getValue(n);s!==void 0&&(e.push([n,s.get()]),s.set(n.startsWith("scale")?1:0))}),e}const wf={width:({x:t},{paddingLeft:e="0",paddingRight:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),height:({y:t},{paddingTop:e="0",paddingBottom:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),top:(t,{top:e})=>parseFloat(e),left:(t,{left:e})=>parseFloat(e),bottom:({y:t},{top:e})=>parseFloat(e)+(t.max-t.min),right:({x:t},{left:e})=>parseFloat(e)+(t.max-t.min),x:gF(4,13),y:gF(5,14)};wf.translateX=wf.x;wf.translateY=wf.y;const Qu=new Set;let MN=!1,zN=!1;function XU(){if(zN){const t=Array.from(Qu).filter(s=>s.needsMeasurement),e=new Set(t.map(s=>s.element)),n=new Map;e.forEach(s=>{const r=vie(s);r.length&&(n.set(s,r),s.render())}),t.forEach(s=>s.measureInitialState()),e.forEach(s=>{s.render();const r=n.get(s);r&&r.forEach(([i,o])=>{var a;(a=s.getValue(i))===null||a===void 0||a.set(o)})}),t.forEach(s=>s.measureEndState()),t.forEach(s=>{s.suspendedScrollY!==void 0&&window.scrollTo(0,s.suspendedScrollY)})}zN=!1,MN=!1,Qu.forEach(t=>t.complete()),Qu.clear()}function YU(){Qu.forEach(t=>{t.readKeyframes(),t.needsMeasurement&&(zN=!0)})}function bie(){YU(),XU()}class kE{constructor(e,n,s,r,i,o=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...e],this.onComplete=n,this.name=s,this.motionValue=r,this.element=i,this.isAsync=o}scheduleResolve(){this.isScheduled=!0,this.isAsync?(Qu.add(this),MN||(MN=!0,jt.read(YU),jt.resolveKeyframes(XU))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:n,element:s,motionValue:r}=this;for(let i=0;i<e.length;i++)if(e[i]===null)if(i===0){const o=r==null?void 0:r.get(),a=e[e.length-1];if(o!==void 0)e[0]=o;else if(s&&n){const l=s.readValue(n,a);l!=null&&(e[0]=l)}e[0]===void 0&&(e[0]=a),r&&o===void 0&&r.set(e[0])}else e[i]=e[i-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),Qu.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,Qu.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const ZU=t=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(t),wie=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function Sie(t){const e=wie.exec(t);if(!e)return[,];const[,n,s,r]=e;return[`--${n??s}`,r]}function QU(t,e,n=1){const[s,r]=Sie(t);if(!s)return;const i=window.getComputedStyle(e).getPropertyValue(s);if(i){const o=i.trim();return ZU(o)?parseFloat(o):o}return sE(r)?QU(r,e,n+1):r}const JU=t=>e=>e.test(t),kie={test:t=>t==="auto",parse:t=>t},e5=[Jf,nt,ya,Pl,pre,fre,kie],yF=t=>e5.find(JU(t));class t5 extends kE{constructor(e,n,s,r,i){super(e,n,s,r,i,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:n,name:s}=this;if(!n||!n.current)return;super.readKeyframes();for(let l=0;l<e.length;l++){let c=e[l];if(typeof c=="string"&&(c=c.trim(),sE(c))){const u=QU(c,n.current);u!==void 0&&(e[l]=u),l===e.length-1&&(this.finalKeyframe=c)}}if(this.resolveNoneKeyframes(),!RU.has(s)||e.length!==2)return;const[r,i]=e,o=yF(r),a=yF(i);if(o!==a)if(pF(o)&&pF(a))for(let l=0;l<e.length;l++){const c=e[l];typeof c=="string"&&(e[l]=parseFloat(c))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:n}=this,s=[];for(let r=0;r<e.length;r++)Jre(e[r])&&s.push(r);s.length&&gie(e,s,n)}measureInitialState(){const{element:e,unresolvedKeyframes:n,name:s}=this;if(!e||!e.current)return;s==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=wf[s](e.measureViewportBox(),window.getComputedStyle(e.current)),n[0]=this.measuredOrigin;const r=n[n.length-1];r!==void 0&&e.getValue(s,r).jump(r,!1)}measureEndState(){var e;const{element:n,name:s,unresolvedKeyframes:r}=this;if(!n||!n.current)return;const i=n.getValue(s);i&&i.jump(this.measuredOrigin,!1);const o=r.length-1,a=r[o];r[o]=wf[s](n.measureViewportBox(),window.getComputedStyle(n.current)),a!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=a),!((e=this.removedTransforms)===null||e===void 0)&&e.length&&this.removedTransforms.forEach(([l,c])=>{n.getValue(l).set(c)}),this.resolveNoneKeyframes()}}const xF=(t,e)=>e==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&(Oc.test(t)||t==="0")&&!t.startsWith("url("));function Cie(t){const e=t[0];if(t.length===1)return!0;for(let n=0;n<t.length;n++)if(t[n]!==e)return!0}function Tie(t,e,n,s){const r=t[0];if(r===null)return!1;if(e==="display"||e==="visibility")return!0;const i=t[t.length-1],o=xF(r,e),a=xF(i,e);return!o||!a?!1:Cie(t)||(n==="spring"||dE(n))&&s}const Nie=t=>t!==null;function o1(t,{repeat:e,repeatType:n="loop"},s){const r=t.filter(Nie),i=e&&n!=="loop"&&e%2===1?0:r.length-1;return!i||s===void 0?r[i]:s}const Iie=40;class n5{constructor({autoplay:e=!0,delay:n=0,type:s="keyframes",repeat:r=0,repeatDelay:i=0,repeatType:o="loop",...a}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.createdAt=xa.now(),this.options={autoplay:e,delay:n,type:s,repeat:r,repeatDelay:i,repeatType:o,...a},this.updateFinishedPromise()}calcStartTime(){return this.resolvedAt?this.resolvedAt-this.createdAt>Iie?this.resolvedAt:this.createdAt:this.createdAt}get resolved(){return!this._resolved&&!this.hasAttemptedResolve&&bie(),this._resolved}onKeyframesResolved(e,n){this.resolvedAt=xa.now(),this.hasAttemptedResolve=!0;const{name:s,type:r,velocity:i,delay:o,onComplete:a,onUpdate:l,isGenerator:c}=this.options;if(!c&&!Tie(e,s,r,i))if(o)this.options.duration=0;else{l&&l(o1(e,this.options,n)),a&&a(),this.resolveFinishedPromise();return}const u=this.initPlayback(e,n);u!==!1&&(this._resolved={keyframes:e,finalKeyframe:n,...u},this.onPostResolved())}onPostResolved(){}then(e,n){return this.currentFinishedPromise.then(e,n)}flatten(){this.options.type="keyframes",this.options.ease="linear"}updateFinishedPromise(){this.currentFinishedPromise=new Promise(e=>{this.resolveFinishedPromise=e})}}const An=(t,e,n)=>t+(e-t)*n;function dC(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*(2/3-n)*6:t}function _ie({hue:t,saturation:e,lightness:n,alpha:s}){t/=360,e/=100,n/=100;let r=0,i=0,o=0;if(!e)r=i=o=n;else{const a=n<.5?n*(1+e):n+e-n*e,l=2*n-a;r=dC(l,a,t+1/3),i=dC(l,a,t),o=dC(l,a,t-1/3)}return{red:Math.round(r*255),green:Math.round(i*255),blue:Math.round(o*255),alpha:s}}function bb(t,e){return n=>n>0?e:t}const hC=(t,e,n)=>{const s=t*t,r=n*(e*e-s)+s;return r<0?0:Math.sqrt(r)},Eie=[FN,Ou,Ch],$ie=t=>Eie.find(e=>e.test(t));function vF(t){const e=$ie(t);if(!e)return!1;let n=e.parse(t);return e===Ch&&(n=_ie(n)),n}const bF=(t,e)=>{const n=vF(t),s=vF(e);if(!n||!s)return bb(t,e);const r={...n};return i=>(r.red=hC(n.red,s.red,i),r.green=hC(n.green,s.green,i),r.blue=hC(n.blue,s.blue,i),r.alpha=An(n.alpha,s.alpha,i),Ou.transform(r))},Aie=(t,e)=>n=>e(t(n)),cy=(...t)=>t.reduce(Aie),VN=new Set(["none","hidden"]);function Rie(t,e){return VN.has(t)?n=>n<=0?t:e:n=>n>=1?e:t}function Die(t,e){return n=>An(t,e,n)}function CE(t){return typeof t=="number"?Die:typeof t=="string"?sE(t)?bb:er.test(t)?bF:Fie:Array.isArray(t)?s5:typeof t=="object"?er.test(t)?bF:Oie:bb}function s5(t,e){const n=[...t],s=n.length,r=t.map((i,o)=>CE(i)(i,e[o]));return i=>{for(let o=0;o<s;o++)n[o]=r[o](i);return n}}function Oie(t,e){const n={...t,...e},s={};for(const r in n)t[r]!==void 0&&e[r]!==void 0&&(s[r]=CE(t[r])(t[r],e[r]));return r=>{for(const i in s)n[i]=s[i](r);return n}}function Pie(t,e){var n;const s=[],r={color:0,var:0,number:0};for(let i=0;i<e.values.length;i++){const o=e.types[i],a=t.indexes[o][r[o]],l=(n=t.values[a])!==null&&n!==void 0?n:0;s[i]=l,r[o]++}return s}const Fie=(t,e)=>{const n=Oc.createTransformer(e),s=fg(t),r=fg(e);return s.indexes.var.length===r.indexes.var.length&&s.indexes.color.length===r.indexes.color.length&&s.indexes.number.length>=r.indexes.number.length?VN.has(t)&&!r.values.length||VN.has(e)&&!s.values.length?Rie(t,e):cy(s5(Pie(s,r),r.values),n):bb(t,e)};function r5(t,e,n){return typeof t=="number"&&typeof e=="number"&&typeof n=="number"?An(t,e,n):CE(t)(t,e)}const Lie=5;function i5(t,e,n){const s=Math.max(e-Lie,0);return yE(n-t(s),e-s)}const Vn={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},fC=.001;function Mie({duration:t=Vn.duration,bounce:e=Vn.bounce,velocity:n=Vn.velocity,mass:s=Vn.mass}){let r,i,o=1-e;o=Ia(Vn.minDamping,Vn.maxDamping,o),t=Ia(Vn.minDuration,Vn.maxDuration,al(t)),o<1?(r=c=>{const u=c*o,d=u*t,h=u-n,f=jN(c,o),p=Math.exp(-d);return fC-h/f*p},i=c=>{const d=c*o*t,h=d*n+n,f=Math.pow(o,2)*Math.pow(c,2)*t,p=Math.exp(-d),m=jN(Math.pow(c,2),o);return(-r(c)+fC>0?-1:1)*((h-f)*p)/m}):(r=c=>{const u=Math.exp(-c*t),d=(c-n)*t+1;return-fC+u*d},i=c=>{const u=Math.exp(-c*t),d=(n-c)*(t*t);return u*d});const a=5/t,l=Vie(r,i,a);if(t=ol(t),isNaN(l))return{stiffness:Vn.stiffness,damping:Vn.damping,duration:t};{const c=Math.pow(l,2)*s;return{stiffness:c,damping:o*2*Math.sqrt(s*c),duration:t}}}const zie=12;function Vie(t,e,n){let s=n;for(let r=1;r<zie;r++)s=s-t(s)/e(s);return s}function jN(t,e){return t*Math.sqrt(1-e*e)}const jie=["duration","bounce"],Bie=["stiffness","damping","mass"];function wF(t,e){return e.some(n=>t[n]!==void 0)}function Wie(t){let e={velocity:Vn.velocity,stiffness:Vn.stiffness,damping:Vn.damping,mass:Vn.mass,isResolvedFromDuration:!1,...t};if(!wF(t,Bie)&&wF(t,jie))if(t.visualDuration){const n=t.visualDuration,s=2*Math.PI/(n*1.2),r=s*s,i=2*Ia(.05,1,1-(t.bounce||0))*Math.sqrt(r);e={...e,mass:Vn.mass,stiffness:r,damping:i}}else{const n=Mie(t);e={...e,...n,mass:Vn.mass},e.isResolvedFromDuration=!0}return e}function o5(t=Vn.visualDuration,e=Vn.bounce){const n=typeof t!="object"?{visualDuration:t,keyframes:[0,1],bounce:e}:t;let{restSpeed:s,restDelta:r}=n;const i=n.keyframes[0],o=n.keyframes[n.keyframes.length-1],a={done:!1,value:i},{stiffness:l,damping:c,mass:u,duration:d,velocity:h,isResolvedFromDuration:f}=Wie({...n,velocity:-al(n.velocity||0)}),p=h||0,m=c/(2*Math.sqrt(l*u)),g=o-i,y=al(Math.sqrt(l/u)),x=Math.abs(g)<5;s||(s=x?Vn.restSpeed.granular:Vn.restSpeed.default),r||(r=x?Vn.restDelta.granular:Vn.restDelta.default);let v;if(m<1){const k=jN(y,m);v=C=>{const N=Math.exp(-m*y*C);return o-N*((p+m*y*g)/k*Math.sin(k*C)+g*Math.cos(k*C))}}else if(m===1)v=k=>o-Math.exp(-y*k)*(g+(p+y*g)*k);else{const k=y*Math.sqrt(m*m-1);v=C=>{const N=Math.exp(-m*y*C),I=Math.min(k*C,300);return o-N*((p+m*y*g)*Math.sinh(I)+k*g*Math.cosh(I))/k}}const b={calculatedDuration:f&&d||null,next:k=>{const C=v(k);if(f)a.done=k>=d;else{let N=0;m<1&&(N=k===0?ol(p):i5(v,k,C));const I=Math.abs(N)<=s,$=Math.abs(o-C)<=r;a.done=I&&$}return a.value=a.done?o:C,a},toString:()=>{const k=Math.min(CU(b),DN),C=TU(N=>b.next(k*N).value,k,30);return k+"ms "+C}};return b}function SF({keyframes:t,velocity:e=0,power:n=.8,timeConstant:s=325,bounceDamping:r=10,bounceStiffness:i=500,modifyTarget:o,min:a,max:l,restDelta:c=.5,restSpeed:u}){const d=t[0],h={done:!1,value:d},f=I=>a!==void 0&&I<a||l!==void 0&&I>l,p=I=>a===void 0?l:l===void 0||Math.abs(a-I)<Math.abs(l-I)?a:l;let m=n*e;const g=d+m,y=o===void 0?g:o(g);y!==g&&(m=y-d);const x=I=>-m*Math.exp(-I/s),v=I=>y+x(I),b=I=>{const $=x(I),A=v(I);h.done=Math.abs($)<=c,h.value=h.done?y:A};let k,C;const N=I=>{f(h.value)&&(k=I,C=o5({keyframes:[h.value,p(h.value)],velocity:i5(v,I,h.value),damping:r,stiffness:i,restDelta:c,restSpeed:u}))};return N(0),{calculatedDuration:null,next:I=>{let $=!1;return!C&&k===void 0&&($=!0,b(I),N(I)),k!==void 0&&I>=k?C.next(I-k):(!$&&b(I),h)}}}const Uie=ly(.42,0,1,1),Hie=ly(0,0,.58,1),a5=ly(.42,0,.58,1),Gie=t=>Array.isArray(t)&&typeof t[0]!="number",Kie={linear:kr,easeIn:Uie,easeInOut:a5,easeOut:Hie,circIn:vE,circInOut:jU,circOut:VU,backIn:xE,backInOut:MU,backOut:LU,anticipate:zU},kF=t=>{if(hE(t)){sU(t.length===4);const[e,n,s,r]=t;return ly(e,n,s,r)}else if(typeof t=="string")return Kie[t];return t};function qie(t,e,n){const s=[],r=n||r5,i=t.length-1;for(let o=0;o<i;o++){let a=r(t[o],t[o+1]);if(e){const l=Array.isArray(e)?e[o]||kr:e;a=cy(l,a)}s.push(a)}return s}function TE(t,e,{clamp:n=!0,ease:s,mixer:r}={}){const i=t.length;if(sU(i===e.length),i===1)return()=>e[0];if(i===2&&e[0]===e[1])return()=>e[1];const o=t[0]===t[1];t[0]>t[i-1]&&(t=[...t].reverse(),e=[...e].reverse());const a=qie(e,s,r),l=a.length,c=u=>{if(o&&u<t[0])return e[0];let d=0;if(l>1)for(;d<t.length-2&&!(u<t[d+1]);d++);const h=pd(t[d],t[d+1],u);return a[d](h)};return n?u=>c(Ia(t[0],t[i-1],u)):c}function Xie(t,e){const n=t[t.length-1];for(let s=1;s<=e;s++){const r=pd(0,e,s);t.push(An(n,1,r))}}function l5(t){const e=[0];return Xie(e,t.length-1),e}function Yie(t,e){return t.map(n=>n*e)}function Zie(t,e){return t.map(()=>e||a5).splice(0,t.length-1)}function wb({duration:t=300,keyframes:e,times:n,ease:s="easeInOut"}){const r=Gie(s)?s.map(kF):kF(s),i={done:!1,value:e[0]},o=Yie(n&&n.length===e.length?n:l5(e),t),a=TE(o,e,{ease:Array.isArray(r)?r:Zie(e,r)});return{calculatedDuration:t,next:l=>(i.value=a(l),i.done=l>=t,i)}}const Qie=t=>{const e=({timestamp:n})=>t(n);return{start:()=>jt.update(e,!0),stop:()=>Lo(e),now:()=>As.isProcessing?As.timestamp:xa.now()}},Jie={decay:SF,inertia:SF,tween:wb,keyframes:wb,spring:o5},eoe=t=>t/100;class NE extends n5{constructor(e){super(e),this.holdTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.startTime=null,this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:l}=this.options;l&&l()};const{name:n,motionValue:s,element:r,keyframes:i}=this.options,o=(r==null?void 0:r.KeyframeResolver)||kE,a=(l,c)=>this.onKeyframesResolved(l,c);this.resolver=new o(i,a,n,s,r),this.resolver.scheduleResolve()}flatten(){super.flatten(),this._resolved&&Object.assign(this._resolved,this.initPlayback(this._resolved.keyframes))}initPlayback(e){const{type:n="keyframes",repeat:s=0,repeatDelay:r=0,repeatType:i,velocity:o=0}=this.options,a=dE(n)?n:Jie[n]||wb;let l,c;a!==wb&&typeof e[0]!="number"&&(l=cy(eoe,r5(e[0],e[1])),e=[0,100]);const u=a({...this.options,keyframes:e});i==="mirror"&&(c=a({...this.options,keyframes:[...e].reverse(),velocity:-o})),u.calculatedDuration===null&&(u.calculatedDuration=CU(u));const{calculatedDuration:d}=u,h=d+r,f=h*(s+1)-r;return{generator:u,mirroredGenerator:c,mapPercentToKeyframes:l,calculatedDuration:d,resolvedDuration:h,totalDuration:f}}onPostResolved(){const{autoplay:e=!0}=this.options;this.play(),this.pendingPlayState==="paused"||!e?this.pause():this.state=this.pendingPlayState}tick(e,n=!1){const{resolved:s}=this;if(!s){const{keyframes:I}=this.options;return{done:!0,value:I[I.length-1]}}const{finalKeyframe:r,generator:i,mirroredGenerator:o,mapPercentToKeyframes:a,keyframes:l,calculatedDuration:c,totalDuration:u,resolvedDuration:d}=s;if(this.startTime===null)return i.next(0);const{delay:h,repeat:f,repeatType:p,repeatDelay:m,onUpdate:g}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-u/this.speed,this.startTime)),n?this.currentTime=e:this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=Math.round(e-this.startTime)*this.speed;const y=this.currentTime-h*(this.speed>=0?1:-1),x=this.speed>=0?y<0:y>u;this.currentTime=Math.max(y,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=u);let v=this.currentTime,b=i;if(f){const I=Math.min(this.currentTime,u)/d;let $=Math.floor(I),A=I%1;!A&&I>=1&&(A=1),A===1&&$--,$=Math.min($,f+1),!!($%2)&&(p==="reverse"?(A=1-A,m&&(A-=m/d)):p==="mirror"&&(b=o)),v=Ia(0,1,A)*d}const k=x?{done:!1,value:l[0]}:b.next(v);a&&(k.value=a(k.value));let{done:C}=k;!x&&c!==null&&(C=this.speed>=0?this.currentTime>=u:this.currentTime<=0);const N=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&C);return N&&r!==void 0&&(k.value=o1(l,this.options,r)),g&&g(k.value),N&&this.finish(),k}get duration(){const{resolved:e}=this;return e?al(e.calculatedDuration):0}get time(){return al(this.currentTime)}set time(e){e=ol(e),this.currentTime=e,this.holdTime!==null||this.speed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.speed)}get speed(){return this.playbackSpeed}set speed(e){const n=this.playbackSpeed!==e;this.playbackSpeed=e,n&&(this.time=al(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;const{driver:e=Qie,onPlay:n,startTime:s}=this.options;this.driver||(this.driver=e(i=>this.tick(i))),n&&n();const r=this.driver.now();this.holdTime!==null?this.startTime=r-this.holdTime:this.startTime?this.state==="finished"&&(this.startTime=r):this.startTime=s??this.calcStartTime(),this.state==="finished"&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var e;if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=(e=this.currentTime)!==null&&e!==void 0?e:0}complete(){this.state!=="running"&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:e}=this.options;e&&e()}cancel(){this.cancelTime!==null&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}}const toe=new Set(["opacity","clipPath","filter","transform"]);function noe(t,e,n,{delay:s=0,duration:r=300,repeat:i=0,repeatType:o="loop",ease:a="easeInOut",times:l}={}){const c={[e]:n};l&&(c.offset=l);const u=IU(a,r);return Array.isArray(u)&&(c.easing=u),t.animate(c,{delay:s,duration:r,easing:Array.isArray(u)?"linear":u,fill:"both",iterations:i+1,direction:o==="reverse"?"alternate":"normal"})}const soe=Y_(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),Sb=10,roe=2e4;function ioe(t){return dE(t.type)||t.type==="spring"||!NU(t.ease)}function ooe(t,e){const n=new NE({...e,keyframes:t,repeat:0,delay:0,isGenerator:!0});let s={done:!1,value:t[0]};const r=[];let i=0;for(;!s.done&&i<roe;)s=n.sample(i),r.push(s.value),i+=Sb;return{times:void 0,keyframes:r,duration:i-Sb,ease:"linear"}}const c5={anticipate:zU,backInOut:MU,circInOut:jU};function aoe(t){return t in c5}class CF extends n5{constructor(e){super(e);const{name:n,motionValue:s,element:r,keyframes:i}=this.options;this.resolver=new t5(i,(o,a)=>this.onKeyframesResolved(o,a),n,s,r),this.resolver.scheduleResolve()}initPlayback(e,n){let{duration:s=300,times:r,ease:i,type:o,motionValue:a,name:l,startTime:c}=this.options;if(!a.owner||!a.owner.current)return!1;if(typeof i=="string"&&vb()&&aoe(i)&&(i=c5[i]),ioe(this.options)){const{onComplete:d,onUpdate:h,motionValue:f,element:p,...m}=this.options,g=ooe(e,m);e=g.keyframes,e.length===1&&(e[1]=e[0]),s=g.duration,r=g.times,i=g.ease,o="keyframes"}const u=noe(a.owner.current,l,e,{...this.options,duration:s,times:r,ease:i});return u.startTime=c??this.calcStartTime(),this.pendingTimeline?(lF(u,this.pendingTimeline),this.pendingTimeline=void 0):u.onfinish=()=>{const{onComplete:d}=this.options;a.set(o1(e,this.options,n)),d&&d(),this.cancel(),this.resolveFinishedPromise()},{animation:u,duration:s,times:r,type:o,ease:i,keyframes:e}}get duration(){const{resolved:e}=this;if(!e)return 0;const{duration:n}=e;return al(n)}get time(){const{resolved:e}=this;if(!e)return 0;const{animation:n}=e;return al(n.currentTime||0)}set time(e){const{resolved:n}=this;if(!n)return;const{animation:s}=n;s.currentTime=ol(e)}get speed(){const{resolved:e}=this;if(!e)return 1;const{animation:n}=e;return n.playbackRate}set speed(e){const{resolved:n}=this;if(!n)return;const{animation:s}=n;s.playbackRate=e}get state(){const{resolved:e}=this;if(!e)return"idle";const{animation:n}=e;return n.playState}get startTime(){const{resolved:e}=this;if(!e)return null;const{animation:n}=e;return n.startTime}attachTimeline(e){if(!this._resolved)this.pendingTimeline=e;else{const{resolved:n}=this;if(!n)return kr;const{animation:s}=n;lF(s,e)}return kr}play(){if(this.isStopped)return;const{resolved:e}=this;if(!e)return;const{animation:n}=e;n.playState==="finished"&&this.updateFinishedPromise(),n.play()}pause(){const{resolved:e}=this;if(!e)return;const{animation:n}=e;n.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.resolveFinishedPromise(),this.updateFinishedPromise();const{resolved:e}=this;if(!e)return;const{animation:n,keyframes:s,duration:r,type:i,ease:o,times:a}=e;if(n.playState==="idle"||n.playState==="finished")return;if(this.time){const{motionValue:c,onUpdate:u,onComplete:d,element:h,...f}=this.options,p=new NE({...f,keyframes:s,duration:r,type:i,ease:o,times:a,isGenerator:!0}),m=ol(this.time);c.setWithVelocity(p.sample(m-Sb).value,p.sample(m).value,Sb)}const{onStop:l}=this.options;l&&l(),this.cancel()}complete(){const{resolved:e}=this;e&&e.animation.finish()}cancel(){const{resolved:e}=this;e&&e.animation.cancel()}static supports(e){const{motionValue:n,name:s,repeatDelay:r,repeatType:i,damping:o,type:a}=e;if(!n||!n.owner||!(n.owner.current instanceof HTMLElement))return!1;const{onUpdate:l,transformTemplate:c}=n.owner.getProps();return soe()&&s&&toe.has(s)&&!l&&!c&&!r&&i!=="mirror"&&o!==0&&a!=="inertia"}}const loe={type:"spring",stiffness:500,damping:25,restSpeed:10},coe=t=>({type:"spring",stiffness:550,damping:t===0?2*Math.sqrt(550):30,restSpeed:10}),uoe={type:"keyframes",duration:.8},doe={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},hoe=(t,{keyframes:e})=>e.length>2?uoe:Ad.has(t)?t.startsWith("scale")?coe(e[1]):loe:doe;function foe({when:t,delay:e,delayChildren:n,staggerChildren:s,staggerDirection:r,repeat:i,repeatType:o,repeatDelay:a,from:l,elapsed:c,...u}){return!!Object.keys(u).length}const IE=(t,e,n,s={},r,i)=>o=>{const a=uE(s,t)||{},l=a.delay||s.delay||0;let{elapsed:c=0}=s;c=c-ol(l);let u={keyframes:Array.isArray(n)?n:[null,n],ease:"easeOut",velocity:e.getVelocity(),...a,delay:-c,onUpdate:h=>{e.set(h),a.onUpdate&&a.onUpdate(h)},onComplete:()=>{o(),a.onComplete&&a.onComplete()},name:t,motionValue:e,element:i?void 0:r};foe(a)||(u={...u,...hoe(t,u)}),u.duration&&(u.duration=ol(u.duration)),u.repeatDelay&&(u.repeatDelay=ol(u.repeatDelay)),u.from!==void 0&&(u.keyframes[0]=u.from);let d=!1;if((u.type===!1||u.duration===0&&!u.repeatDelay)&&(u.duration=0,u.delay===0&&(d=!0)),d&&!i&&e.get()!==void 0){const h=o1(u.keyframes,a);if(h!==void 0)return jt.update(()=>{u.onUpdate(h),u.onComplete()}),new Pre([])}return!i&&CF.supports(u)?new CF(u):new NE(u)};function poe({protectedKeys:t,needsAnimating:e},n){const s=t.hasOwnProperty(n)&&e[n]!==!0;return e[n]=!1,s}function u5(t,e,{delay:n=0,transitionOverride:s,type:r}={}){var i;let{transition:o=t.getDefaultTransition(),transitionEnd:a,...l}=e;s&&(o=s);const c=[],u=r&&t.animationState&&t.animationState.getState()[r];for(const d in l){const h=t.getValue(d,(i=t.latestValues[d])!==null&&i!==void 0?i:null),f=l[d];if(f===void 0||u&&poe(u,d))continue;const p={delay:n,...uE(o||{},d)};let m=!1;if(window.MotionHandoffAnimation){const y=DU(t);if(y){const x=window.MotionHandoffAnimation(y,d,jt);x!==null&&(p.startTime=x,m=!0)}}PN(t,d),h.start(IE(d,h,f,t.shouldReduceMotion&&RU.has(d)?{type:!1}:p,t,m));const g=h.animation;g&&c.push(g)}return a&&Promise.all(c).then(()=>{jt.update(()=>{a&&qre(t,a)})}),c}function BN(t,e,n={}){var s;const r=i1(t,e,n.type==="exit"?(s=t.presenceContext)===null||s===void 0?void 0:s.custom:void 0);let{transition:i=t.getDefaultTransition()||{}}=r||{};n.transitionOverride&&(i=n.transitionOverride);const o=r?()=>Promise.all(u5(t,r,n)):()=>Promise.resolve(),a=t.variantChildren&&t.variantChildren.size?(c=0)=>{const{delayChildren:u=0,staggerChildren:d,staggerDirection:h}=i;return moe(t,e,u+c,d,h,n)}:()=>Promise.resolve(),{when:l}=i;if(l){const[c,u]=l==="beforeChildren"?[o,a]:[a,o];return c().then(()=>u())}else return Promise.all([o(),a(n.delay)])}function moe(t,e,n=0,s=0,r=1,i){const o=[],a=(t.variantChildren.size-1)*s,l=r===1?(c=0)=>c*s:(c=0)=>a-c*s;return Array.from(t.variantChildren).sort(goe).forEach((c,u)=>{c.notify("AnimationStart",e),o.push(BN(c,e,{...i,delay:n+l(u)}).then(()=>c.notify("AnimationComplete",e)))}),Promise.all(o)}function goe(t,e){return t.sortNodePosition(e)}function yoe(t,e,n={}){t.notify("AnimationStart",e);let s;if(Array.isArray(e)){const r=e.map(i=>BN(t,i,n));s=Promise.all(r)}else if(typeof e=="string")s=BN(t,e,n);else{const r=typeof e=="function"?i1(t,e,n.custom):e;s=Promise.all(u5(t,r,n))}return s.then(()=>{t.notify("AnimationComplete",e)})}const xoe=Q_.length;function d5(t){if(!t)return;if(!t.isControllingVariants){const n=t.parent?d5(t.parent)||{}:{};return t.props.initial!==void 0&&(n.initial=t.props.initial),n}const e={};for(let n=0;n<xoe;n++){const s=Q_[n],r=t.props[s];(dg(r)||r===!1)&&(e[s]=r)}return e}const voe=[...Z_].reverse(),boe=Z_.length;function woe(t){return e=>Promise.all(e.map(({animation:n,options:s})=>yoe(t,n,s)))}function Soe(t){let e=woe(t),n=TF(),s=!0;const r=l=>(c,u)=>{var d;const h=i1(t,u,l==="exit"?(d=t.presenceContext)===null||d===void 0?void 0:d.custom:void 0);if(h){const{transition:f,transitionEnd:p,...m}=h;c={...c,...m,...p}}return c};function i(l){e=l(t)}function o(l){const{props:c}=t,u=d5(t.parent)||{},d=[],h=new Set;let f={},p=1/0;for(let g=0;g<boe;g++){const y=voe[g],x=n[y],v=c[y]!==void 0?c[y]:u[y],b=dg(v),k=y===l?x.isActive:null;k===!1&&(p=g);let C=v===u[y]&&v!==c[y]&&b;if(C&&s&&t.manuallyAnimateOnMount&&(C=!1),x.protectedKeys={...f},!x.isActive&&k===null||!v&&!x.prevProp||s1(v)||typeof v=="boolean")continue;const N=koe(x.prevProp,v);let I=N||y===l&&x.isActive&&!C&&b||g>p&&b,$=!1;const A=Array.isArray(v)?v:[v];let P=A.reduce(r(y),{});k===!1&&(P={});const{prevResolvedValues:F={}}=x,V={...F,...P},z=q=>{I=!0,h.has(q)&&($=!0,h.delete(q)),x.needsAnimating[q]=!0;const M=t.getValue(q);M&&(M.liveStyle=!1)};for(const q in V){const M=P[q],G=F[q];if(f.hasOwnProperty(q))continue;let ne=!1;RN(M)&&RN(G)?ne=!SU(M,G):ne=M!==G,ne?M!=null?z(q):h.add(q):M!==void 0&&h.has(q)?z(q):x.protectedKeys[q]=!0}x.prevProp=v,x.prevResolvedValues=P,x.isActive&&(f={...f,...P}),s&&t.blockInitialAnimation&&(I=!1),I&&(!(C&&N)||$)&&d.push(...A.map(q=>({animation:q,options:{type:y}})))}if(h.size){const g={};h.forEach(y=>{const x=t.getBaseTarget(y),v=t.getValue(y);v&&(v.liveStyle=!0),g[y]=x??null}),d.push({animation:g})}let m=!!d.length;return s&&(c.initial===!1||c.initial===c.animate)&&!t.manuallyAnimateOnMount&&(m=!1),s=!1,m?e(d):Promise.resolve()}function a(l,c){var u;if(n[l].isActive===c)return Promise.resolve();(u=t.variantChildren)===null||u===void 0||u.forEach(h=>{var f;return(f=h.animationState)===null||f===void 0?void 0:f.setActive(l,c)}),n[l].isActive=c;const d=o(l);for(const h in n)n[h].protectedKeys={};return d}return{animateChanges:o,setActive:a,setAnimateFunction:i,getState:()=>n,reset:()=>{n=TF(),s=!0}}}function koe(t,e){return typeof e=="string"?e!==t:Array.isArray(e)?!SU(e,t):!1}function fu(t=!1){return{isActive:t,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function TF(){return{animate:fu(!0),whileInView:fu(),whileHover:fu(),whileTap:fu(),whileDrag:fu(),whileFocus:fu(),exit:fu()}}class Zc{constructor(e){this.isMounted=!1,this.node=e}update(){}}class Coe extends Zc{constructor(e){super(e),e.animationState||(e.animationState=Soe(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();s1(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:n}=this.node.prevProps||{};e!==n&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),(e=this.unmountControls)===null||e===void 0||e.call(this)}}let Toe=0;class Noe extends Zc{constructor(){super(...arguments),this.id=Toe++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:n}=this.node.presenceContext,{isPresent:s}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===s)return;const r=this.node.animationState.setActive("exit",!e);n&&!e&&r.then(()=>n(this.id))}mount(){const{register:e}=this.node.presenceContext||{};e&&(this.unmount=e(this.id))}unmount(){}}const Ioe={animation:{Feature:Coe},exit:{Feature:Noe}};function pg(t,e,n,s={passive:!0}){return t.addEventListener(e,n,s),()=>t.removeEventListener(e,n)}function uy(t){return{point:{x:t.pageX,y:t.pageY}}}const _oe=t=>e=>fE(e)&&t(e,uy(e));function Pm(t,e,n,s){return pg(t,e,_oe(n),s)}const NF=(t,e)=>Math.abs(t-e);function Eoe(t,e){const n=NF(t.x,e.x),s=NF(t.y,e.y);return Math.sqrt(n**2+s**2)}class h5{constructor(e,n,{transformPagePoint:s,contextWindow:r,dragSnapToOrigin:i=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const d=mC(this.lastMoveEventInfo,this.history),h=this.startEvent!==null,f=Eoe(d.offset,{x:0,y:0})>=3;if(!h&&!f)return;const{point:p}=d,{timestamp:m}=As;this.history.push({...p,timestamp:m});const{onStart:g,onMove:y}=this.handlers;h||(g&&g(this.lastMoveEvent,d),this.startEvent=this.lastMoveEvent),y&&y(this.lastMoveEvent,d)},this.handlePointerMove=(d,h)=>{this.lastMoveEvent=d,this.lastMoveEventInfo=pC(h,this.transformPagePoint),jt.update(this.updatePoint,!0)},this.handlePointerUp=(d,h)=>{this.end();const{onEnd:f,onSessionEnd:p,resumeAnimation:m}=this.handlers;if(this.dragSnapToOrigin&&m&&m(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const g=mC(d.type==="pointercancel"?this.lastMoveEventInfo:pC(h,this.transformPagePoint),this.history);this.startEvent&&f&&f(d,g),p&&p(d,g)},!fE(e))return;this.dragSnapToOrigin=i,this.handlers=n,this.transformPagePoint=s,this.contextWindow=r||window;const o=uy(e),a=pC(o,this.transformPagePoint),{point:l}=a,{timestamp:c}=As;this.history=[{...l,timestamp:c}];const{onSessionStart:u}=n;u&&u(e,mC(a,this.history)),this.removeListeners=cy(Pm(this.contextWindow,"pointermove",this.handlePointerMove),Pm(this.contextWindow,"pointerup",this.handlePointerUp),Pm(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),Lo(this.updatePoint)}}function pC(t,e){return e?{point:e(t.point)}:t}function IF(t,e){return{x:t.x-e.x,y:t.y-e.y}}function mC({point:t},e){return{point:t,delta:IF(t,f5(e)),offset:IF(t,$oe(e)),velocity:Aoe(e,.1)}}function $oe(t){return t[0]}function f5(t){return t[t.length-1]}function Aoe(t,e){if(t.length<2)return{x:0,y:0};let n=t.length-1,s=null;const r=f5(t);for(;n>=0&&(s=t[n],!(r.timestamp-s.timestamp>ol(e)));)n--;if(!s)return{x:0,y:0};const i=al(r.timestamp-s.timestamp);if(i===0)return{x:0,y:0};const o={x:(r.x-s.x)/i,y:(r.y-s.y)/i};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}const p5=1e-4,Roe=1-p5,Doe=1+p5,m5=.01,Ooe=0-m5,Poe=0+m5;function ki(t){return t.max-t.min}function Foe(t,e,n){return Math.abs(t-e)<=n}function _F(t,e,n,s=.5){t.origin=s,t.originPoint=An(e.min,e.max,t.origin),t.scale=ki(n)/ki(e),t.translate=An(n.min,n.max,t.origin)-t.originPoint,(t.scale>=Roe&&t.scale<=Doe||isNaN(t.scale))&&(t.scale=1),(t.translate>=Ooe&&t.translate<=Poe||isNaN(t.translate))&&(t.translate=0)}function Fm(t,e,n,s){_F(t.x,e.x,n.x,s?s.originX:void 0),_F(t.y,e.y,n.y,s?s.originY:void 0)}function EF(t,e,n){t.min=n.min+e.min,t.max=t.min+ki(e)}function Loe(t,e,n){EF(t.x,e.x,n.x),EF(t.y,e.y,n.y)}function $F(t,e,n){t.min=e.min-n.min,t.max=t.min+ki(e)}function Lm(t,e,n){$F(t.x,e.x,n.x),$F(t.y,e.y,n.y)}function Moe(t,{min:e,max:n},s){return e!==void 0&&t<e?t=s?An(e,t,s.min):Math.max(t,e):n!==void 0&&t>n&&(t=s?An(n,t,s.max):Math.min(t,n)),t}function AF(t,e,n){return{min:e!==void 0?t.min+e:void 0,max:n!==void 0?t.max+n-(t.max-t.min):void 0}}function zoe(t,{top:e,left:n,bottom:s,right:r}){return{x:AF(t.x,n,r),y:AF(t.y,e,s)}}function RF(t,e){let n=e.min-t.min,s=e.max-t.max;return e.max-e.min<t.max-t.min&&([n,s]=[s,n]),{min:n,max:s}}function Voe(t,e){return{x:RF(t.x,e.x),y:RF(t.y,e.y)}}function joe(t,e){let n=.5;const s=ki(t),r=ki(e);return r>s?n=pd(e.min,e.max-s,t.min):s>r&&(n=pd(t.min,t.max-r,e.min)),Ia(0,1,n)}function Boe(t,e){const n={};return e.min!==void 0&&(n.min=e.min-t.min),e.max!==void 0&&(n.max=e.max-t.min),n}const WN=.35;function Woe(t=WN){return t===!1?t=0:t===!0&&(t=WN),{x:DF(t,"left","right"),y:DF(t,"top","bottom")}}function DF(t,e,n){return{min:OF(t,e),max:OF(t,n)}}function OF(t,e){return typeof t=="number"?t:t[e]||0}const PF=()=>({translate:0,scale:1,origin:0,originPoint:0}),Th=()=>({x:PF(),y:PF()}),FF=()=>({min:0,max:0}),qn=()=>({x:FF(),y:FF()});function Vi(t){return[t("x"),t("y")]}function g5({top:t,left:e,right:n,bottom:s}){return{x:{min:e,max:n},y:{min:t,max:s}}}function Uoe({x:t,y:e}){return{top:e.min,right:t.max,bottom:e.max,left:t.min}}function Hoe(t,e){if(!e)return t;const n=e({x:t.left,y:t.top}),s=e({x:t.right,y:t.bottom});return{top:n.y,left:n.x,bottom:s.y,right:s.x}}function gC(t){return t===void 0||t===1}function UN({scale:t,scaleX:e,scaleY:n}){return!gC(t)||!gC(e)||!gC(n)}function Cu(t){return UN(t)||y5(t)||t.z||t.rotate||t.rotateX||t.rotateY||t.skewX||t.skewY}function y5(t){return LF(t.x)||LF(t.y)}function LF(t){return t&&t!=="0%"}function kb(t,e,n){const s=t-n,r=e*s;return n+r}function MF(t,e,n,s,r){return r!==void 0&&(t=kb(t,r,s)),kb(t,n,s)+e}function HN(t,e=0,n=1,s,r){t.min=MF(t.min,e,n,s,r),t.max=MF(t.max,e,n,s,r)}function x5(t,{x:e,y:n}){HN(t.x,e.translate,e.scale,e.originPoint),HN(t.y,n.translate,n.scale,n.originPoint)}const zF=.999999999999,VF=1.0000000000001;function Goe(t,e,n,s=!1){const r=n.length;if(!r)return;e.x=e.y=1;let i,o;for(let a=0;a<r;a++){i=n[a],o=i.projectionDelta;const{visualElement:l}=i.options;l&&l.props.style&&l.props.style.display==="contents"||(s&&i.options.layoutScroll&&i.scroll&&i!==i.root&&Ih(t,{x:-i.scroll.offset.x,y:-i.scroll.offset.y}),o&&(e.x*=o.x.scale,e.y*=o.y.scale,x5(t,o)),s&&Cu(i.latestValues)&&Ih(t,i.latestValues))}e.x<VF&&e.x>zF&&(e.x=1),e.y<VF&&e.y>zF&&(e.y=1)}function Nh(t,e){t.min=t.min+e,t.max=t.max+e}function jF(t,e,n,s,r=.5){const i=An(t.min,t.max,r);HN(t,e,n,i,s)}function Ih(t,e){jF(t.x,e.x,e.scaleX,e.scale,e.originX),jF(t.y,e.y,e.scaleY,e.scale,e.originY)}function v5(t,e){return g5(Hoe(t.getBoundingClientRect(),e))}function Koe(t,e,n){const s=v5(t,n),{scroll:r}=e;return r&&(Nh(s.x,r.offset.x),Nh(s.y,r.offset.y)),s}const b5=({current:t})=>t?t.ownerDocument.defaultView:null,qoe=new WeakMap;class Xoe{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=qn(),this.visualElement=e}start(e,{snapToCursor:n=!1}={}){const{presenceContext:s}=this.visualElement;if(s&&s.isPresent===!1)return;const r=u=>{const{dragSnapToOrigin:d}=this.getProps();d?this.pauseAnimation():this.stopAnimation(),n&&this.snapToCursor(uy(u).point)},i=(u,d)=>{const{drag:h,dragPropagation:f,onDragStart:p}=this.getProps();if(h&&!f&&(this.openDragLock&&this.openDragLock(),this.openDragLock=Wre(h),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Vi(g=>{let y=this.getAxisMotionValue(g).get()||0;if(ya.test(y)){const{projection:x}=this.visualElement;if(x&&x.layout){const v=x.layout.layoutBox[g];v&&(y=ki(v)*(parseFloat(y)/100))}}this.originPoint[g]=y}),p&&jt.postRender(()=>p(u,d)),PN(this.visualElement,"transform");const{animationState:m}=this.visualElement;m&&m.setActive("whileDrag",!0)},o=(u,d)=>{const{dragPropagation:h,dragDirectionLock:f,onDirectionLock:p,onDrag:m}=this.getProps();if(!h&&!this.openDragLock)return;const{offset:g}=d;if(f&&this.currentDirection===null){this.currentDirection=Yoe(g),this.currentDirection!==null&&p&&p(this.currentDirection);return}this.updateAxis("x",d.point,g),this.updateAxis("y",d.point,g),this.visualElement.render(),m&&m(u,d)},a=(u,d)=>this.stop(u,d),l=()=>Vi(u=>{var d;return this.getAnimationState(u)==="paused"&&((d=this.getAxisMotionValue(u).animation)===null||d===void 0?void 0:d.play())}),{dragSnapToOrigin:c}=this.getProps();this.panSession=new h5(e,{onSessionStart:r,onStart:i,onMove:o,onSessionEnd:a,resumeAnimation:l},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:c,contextWindow:b5(this.visualElement)})}stop(e,n){const s=this.isDragging;if(this.cancel(),!s)return;const{velocity:r}=n;this.startAnimation(r);const{onDragEnd:i}=this.getProps();i&&jt.postRender(()=>i(e,n))}cancel(){this.isDragging=!1;const{projection:e,animationState:n}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:s}=this.getProps();!s&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),n&&n.setActive("whileDrag",!1)}updateAxis(e,n,s){const{drag:r}=this.getProps();if(!s||!Cx(e,r,this.currentDirection))return;const i=this.getAxisMotionValue(e);let o=this.originPoint[e]+s[e];this.constraints&&this.constraints[e]&&(o=Moe(o,this.constraints[e],this.elastic[e])),i.set(o)}resolveConstraints(){var e;const{dragConstraints:n,dragElastic:s}=this.getProps(),r=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(e=this.visualElement.projection)===null||e===void 0?void 0:e.layout,i=this.constraints;n&&kh(n)?this.constraints||(this.constraints=this.resolveRefConstraints()):n&&r?this.constraints=zoe(r.layoutBox,n):this.constraints=!1,this.elastic=Woe(s),i!==this.constraints&&r&&this.constraints&&!this.hasMutatedConstraints&&Vi(o=>{this.constraints!==!1&&this.getAxisMotionValue(o)&&(this.constraints[o]=Boe(r.layoutBox[o],this.constraints[o]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:n}=this.getProps();if(!e||!kh(e))return!1;const s=e.current,{projection:r}=this.visualElement;if(!r||!r.layout)return!1;const i=Koe(s,r.root,this.visualElement.getTransformPagePoint());let o=Voe(r.layout.layoutBox,i);if(n){const a=n(Uoe(o));this.hasMutatedConstraints=!!a,a&&(o=g5(a))}return o}startAnimation(e){const{drag:n,dragMomentum:s,dragElastic:r,dragTransition:i,dragSnapToOrigin:o,onDragTransitionEnd:a}=this.getProps(),l=this.constraints||{},c=Vi(u=>{if(!Cx(u,n,this.currentDirection))return;let d=l&&l[u]||{};o&&(d={min:0,max:0});const h=r?200:1e6,f=r?40:1e7,p={type:"inertia",velocity:s?e[u]:0,bounceStiffness:h,bounceDamping:f,timeConstant:750,restDelta:1,restSpeed:10,...i,...d};return this.startAxisValueAnimation(u,p)});return Promise.all(c).then(a)}startAxisValueAnimation(e,n){const s=this.getAxisMotionValue(e);return PN(this.visualElement,e),s.start(IE(e,s,0,n,this.visualElement,!1))}stopAnimation(){Vi(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){Vi(e=>{var n;return(n=this.getAxisMotionValue(e).animation)===null||n===void 0?void 0:n.pause()})}getAnimationState(e){var n;return(n=this.getAxisMotionValue(e).animation)===null||n===void 0?void 0:n.state}getAxisMotionValue(e){const n=`_drag${e.toUpperCase()}`,s=this.visualElement.getProps(),r=s[n];return r||this.visualElement.getValue(e,(s.initial?s.initial[e]:void 0)||0)}snapToCursor(e){Vi(n=>{const{drag:s}=this.getProps();if(!Cx(n,s,this.currentDirection))return;const{projection:r}=this.visualElement,i=this.getAxisMotionValue(n);if(r&&r.layout){const{min:o,max:a}=r.layout.layoutBox[n];i.set(e[n]-An(o,a,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:n}=this.getProps(),{projection:s}=this.visualElement;if(!kh(n)||!s||!this.constraints)return;this.stopAnimation();const r={x:0,y:0};Vi(o=>{const a=this.getAxisMotionValue(o);if(a&&this.constraints!==!1){const l=a.get();r[o]=joe({min:l,max:l},this.constraints[o])}});const{transformTemplate:i}=this.visualElement.getProps();this.visualElement.current.style.transform=i?i({},""):"none",s.root&&s.root.updateScroll(),s.updateLayout(),this.resolveConstraints(),Vi(o=>{if(!Cx(o,e,null))return;const a=this.getAxisMotionValue(o),{min:l,max:c}=this.constraints[o];a.set(An(l,c,r[o]))})}addListeners(){if(!this.visualElement.current)return;qoe.set(this.visualElement,this);const e=this.visualElement.current,n=Pm(e,"pointerdown",l=>{const{drag:c,dragListener:u=!0}=this.getProps();c&&u&&this.start(l)}),s=()=>{const{dragConstraints:l}=this.getProps();kh(l)&&l.current&&(this.constraints=this.resolveRefConstraints())},{projection:r}=this.visualElement,i=r.addEventListener("measure",s);r&&!r.layout&&(r.root&&r.root.updateScroll(),r.updateLayout()),jt.read(s);const o=pg(window,"resize",()=>this.scalePositionWithinConstraints()),a=r.addEventListener("didUpdate",({delta:l,hasLayoutChanged:c})=>{this.isDragging&&c&&(Vi(u=>{const d=this.getAxisMotionValue(u);d&&(this.originPoint[u]+=l[u].translate,d.set(d.get()+l[u].translate))}),this.visualElement.render())});return()=>{o(),n(),i(),a&&a()}}getProps(){const e=this.visualElement.getProps(),{drag:n=!1,dragDirectionLock:s=!1,dragPropagation:r=!1,dragConstraints:i=!1,dragElastic:o=WN,dragMomentum:a=!0}=e;return{...e,drag:n,dragDirectionLock:s,dragPropagation:r,dragConstraints:i,dragElastic:o,dragMomentum:a}}}function Cx(t,e,n){return(e===!0||e===t)&&(n===null||n===t)}function Yoe(t,e=10){let n=null;return Math.abs(t.y)>e?n="y":Math.abs(t.x)>e&&(n="x"),n}class Zoe extends Zc{constructor(e){super(e),this.removeGroupControls=kr,this.removeListeners=kr,this.controls=new Xoe(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||kr}unmount(){this.removeGroupControls(),this.removeListeners()}}const BF=t=>(e,n)=>{t&&jt.postRender(()=>t(e,n))};class Qoe extends Zc{constructor(){super(...arguments),this.removePointerDownListener=kr}onPointerDown(e){this.session=new h5(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:b5(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:n,onPan:s,onPanEnd:r}=this.node.getProps();return{onSessionStart:BF(e),onStart:BF(n),onMove:s,onEnd:(i,o)=>{delete this.session,r&&jt.postRender(()=>r(i,o))}}}mount(){this.removePointerDownListener=Pm(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const kv={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function WF(t,e){return e.max===e.min?0:t/(e.max-e.min)*100}const Mp={correct:(t,e)=>{if(!e.target)return t;if(typeof t=="string")if(nt.test(t))t=parseFloat(t);else return t;const n=WF(t,e.target.x),s=WF(t,e.target.y);return`${n}% ${s}%`}},Joe={correct:(t,{treeScale:e,projectionDelta:n})=>{const s=t,r=Oc.parse(t);if(r.length>5)return s;const i=Oc.createTransformer(t),o=typeof r[0]!="number"?1:0,a=n.x.scale*e.x,l=n.y.scale*e.y;r[0+o]/=a,r[1+o]/=l;const c=An(a,l,.5);return typeof r[2+o]=="number"&&(r[2+o]/=c),typeof r[3+o]=="number"&&(r[3+o]/=c),i(r)}};class eae extends D.Component{componentDidMount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:s,layoutId:r}=this.props,{projection:i}=e;Cre(tae),i&&(n.group&&n.group.add(i),s&&s.register&&r&&s.register(i),i.root.didUpdate(),i.addEventListener("animationComplete",()=>{this.safeToRemove()}),i.setOptions({...i.options,onExitComplete:()=>this.safeToRemove()})),kv.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:n,visualElement:s,drag:r,isPresent:i}=this.props,o=s.projection;return o&&(o.isPresent=i,r||e.layoutDependency!==n||n===void 0?o.willUpdate():this.safeToRemove(),e.isPresent!==i&&(i?o.promote():o.relegate()||jt.postRender(()=>{const a=o.getStack();(!a||!a.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),eE.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:s}=this.props,{projection:r}=e;r&&(r.scheduleCheckAfterUnmount(),n&&n.group&&n.group.remove(r),s&&s.deregister&&s.deregister(r))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function w5(t){const[e,n]=zse(),s=D.useContext(nU);return S.jsx(eae,{...t,layoutGroup:s,switchLayoutGroup:D.useContext(cU),isPresent:e,safeToRemove:n})}const tae={borderRadius:{...Mp,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Mp,borderTopRightRadius:Mp,borderBottomLeftRadius:Mp,borderBottomRightRadius:Mp,boxShadow:Joe};function nae(t,e,n){const s=or(t)?t:ca(t);return s.start(IE("",s,e,n)),s.animation}function sae(t){return t instanceof SVGElement&&t.tagName!=="svg"}const rae=(t,e)=>t.depth-e.depth;class iae{constructor(){this.children=[],this.isDirty=!1}add(e){pE(this.children,e),this.isDirty=!0}remove(e){mE(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(rae),this.isDirty=!1,this.children.forEach(e)}}function oae(t,e){const n=xa.now(),s=({timestamp:r})=>{const i=r-n;i>=e&&(Lo(s),t(i-e))};return jt.read(s,!0),()=>Lo(s)}const S5=["TopLeft","TopRight","BottomLeft","BottomRight"],aae=S5.length,UF=t=>typeof t=="string"?parseFloat(t):t,HF=t=>typeof t=="number"||nt.test(t);function lae(t,e,n,s,r,i){r?(t.opacity=An(0,n.opacity!==void 0?n.opacity:1,cae(s)),t.opacityExit=An(e.opacity!==void 0?e.opacity:1,0,uae(s))):i&&(t.opacity=An(e.opacity!==void 0?e.opacity:1,n.opacity!==void 0?n.opacity:1,s));for(let o=0;o<aae;o++){const a=`border${S5[o]}Radius`;let l=GF(e,a),c=GF(n,a);if(l===void 0&&c===void 0)continue;l||(l=0),c||(c=0),l===0||c===0||HF(l)===HF(c)?(t[a]=Math.max(An(UF(l),UF(c),s),0),(ya.test(c)||ya.test(l))&&(t[a]+="%")):t[a]=c}(e.rotate||n.rotate)&&(t.rotate=An(e.rotate||0,n.rotate||0,s))}function GF(t,e){return t[e]!==void 0?t[e]:t.borderRadius}const cae=k5(0,.5,VU),uae=k5(.5,.95,kr);function k5(t,e,n){return s=>s<t?0:s>e?1:n(pd(t,e,s))}function KF(t,e){t.min=e.min,t.max=e.max}function Fi(t,e){KF(t.x,e.x),KF(t.y,e.y)}function qF(t,e){t.translate=e.translate,t.scale=e.scale,t.originPoint=e.originPoint,t.origin=e.origin}function XF(t,e,n,s,r){return t-=e,t=kb(t,1/n,s),r!==void 0&&(t=kb(t,1/r,s)),t}function dae(t,e=0,n=1,s=.5,r,i=t,o=t){if(ya.test(e)&&(e=parseFloat(e),e=An(o.min,o.max,e/100)-o.min),typeof e!="number")return;let a=An(i.min,i.max,s);t===i&&(a-=e),t.min=XF(t.min,e,n,a,r),t.max=XF(t.max,e,n,a,r)}function YF(t,e,[n,s,r],i,o){dae(t,e[n],e[s],e[r],e.scale,i,o)}const hae=["x","scaleX","originX"],fae=["y","scaleY","originY"];function ZF(t,e,n,s){YF(t.x,e,hae,n?n.x:void 0,s?s.x:void 0),YF(t.y,e,fae,n?n.y:void 0,s?s.y:void 0)}function QF(t){return t.translate===0&&t.scale===1}function C5(t){return QF(t.x)&&QF(t.y)}function JF(t,e){return t.min===e.min&&t.max===e.max}function pae(t,e){return JF(t.x,e.x)&&JF(t.y,e.y)}function eL(t,e){return Math.round(t.min)===Math.round(e.min)&&Math.round(t.max)===Math.round(e.max)}function T5(t,e){return eL(t.x,e.x)&&eL(t.y,e.y)}function tL(t){return ki(t.x)/ki(t.y)}function nL(t,e){return t.translate===e.translate&&t.scale===e.scale&&t.originPoint===e.originPoint}class mae{constructor(){this.members=[]}add(e){pE(this.members,e),e.scheduleRender()}remove(e){if(mE(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const n=this.members[this.members.length-1];n&&this.promote(n)}}relegate(e){const n=this.members.findIndex(r=>e===r);if(n===0)return!1;let s;for(let r=n;r>=0;r--){const i=this.members[r];if(i.isPresent!==!1){s=i;break}}return s?(this.promote(s),!0):!1}promote(e,n){const s=this.lead;if(e!==s&&(this.prevLead=s,this.lead=e,e.show(),s)){s.instance&&s.scheduleRender(),e.scheduleRender(),e.resumeFrom=s,n&&(e.resumeFrom.preserveOpacity=!0),s.snapshot&&(e.snapshot=s.snapshot,e.snapshot.latestValues=s.animationValues||s.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:r}=e.options;r===!1&&s.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:n,resumingFrom:s}=e;n.onExitComplete&&n.onExitComplete(),s&&s.options.onExitComplete&&s.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function gae(t,e,n){let s="";const r=t.x.translate/e.x,i=t.y.translate/e.y,o=(n==null?void 0:n.z)||0;if((r||i||o)&&(s=`translate3d(${r}px, ${i}px, ${o}px) `),(e.x!==1||e.y!==1)&&(s+=`scale(${1/e.x}, ${1/e.y}) `),n){const{transformPerspective:c,rotate:u,rotateX:d,rotateY:h,skewX:f,skewY:p}=n;c&&(s=`perspective(${c}px) ${s}`),u&&(s+=`rotate(${u}deg) `),d&&(s+=`rotateX(${d}deg) `),h&&(s+=`rotateY(${h}deg) `),f&&(s+=`skewX(${f}deg) `),p&&(s+=`skewY(${p}deg) `)}const a=t.x.scale*e.x,l=t.y.scale*e.y;return(a!==1||l!==1)&&(s+=`scale(${a}, ${l})`),s||"none"}const Tu={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0},im=typeof window<"u"&&window.MotionDebug!==void 0,yC=["","X","Y","Z"],yae={visibility:"hidden"},sL=1e3;let xae=0;function xC(t,e,n,s){const{latestValues:r}=e;r[t]&&(n[t]=r[t],e.setStaticValue(t,0),s&&(s[t]=0))}function N5(t){if(t.hasCheckedOptimisedAppear=!0,t.root===t)return;const{visualElement:e}=t.options;if(!e)return;const n=DU(e);if(window.MotionHasOptimisedAnimation(n,"transform")){const{layout:r,layoutId:i}=t.options;window.MotionCancelOptimisedAnimation(n,"transform",jt,!(r||i))}const{parent:s}=t;s&&!s.hasCheckedOptimisedAppear&&N5(s)}function I5({attachResizeListener:t,defaultParent:e,measureScroll:n,checkIsScrollRoot:s,resetTransform:r}){return class{constructor(o={},a=e==null?void 0:e()){this.id=xae++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,im&&(Tu.totalNodes=Tu.resolvedTargetDeltas=Tu.recalculatedProjection=0),this.nodes.forEach(wae),this.nodes.forEach(Nae),this.nodes.forEach(Iae),this.nodes.forEach(Sae),im&&window.MotionDebug.record(Tu)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=a?a.root||a:this,this.path=a?[...a.path,a]:[],this.parent=a,this.depth=a?a.depth+1:0;for(let l=0;l<this.path.length;l++)this.path[l].shouldResetTransform=!0;this.root===this&&(this.nodes=new iae)}addEventListener(o,a){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new gE),this.eventHandlers.get(o).add(a)}notifyListeners(o,...a){const l=this.eventHandlers.get(o);l&&l.notify(...a)}hasListeners(o){return this.eventHandlers.has(o)}mount(o,a=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=sae(o),this.instance=o;const{layoutId:l,layout:c,visualElement:u}=this.options;if(u&&!u.current&&u.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),a&&(c||l)&&(this.isLayoutDirty=!0),t){let d;const h=()=>this.root.updateBlockedByResize=!1;t(o,()=>{this.root.updateBlockedByResize=!0,d&&d(),d=oae(h,250),kv.hasAnimatedSinceResize&&(kv.hasAnimatedSinceResize=!1,this.nodes.forEach(iL))})}l&&this.root.registerSharedNode(l,this),this.options.animate!==!1&&u&&(l||c)&&this.addEventListener("didUpdate",({delta:d,hasLayoutChanged:h,hasRelativeTargetChanged:f,layout:p})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const m=this.options.transition||u.getDefaultTransition()||Rae,{onLayoutAnimationStart:g,onLayoutAnimationComplete:y}=u.getProps(),x=!this.targetLayout||!T5(this.targetLayout,p)||f,v=!h&&f;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||v||h&&(x||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(d,v);const b={...uE(m,"layout"),onPlay:g,onComplete:y};(u.shouldReduceMotion||this.options.layoutRoot)&&(b.delay=0,b.type=!1),this.startAnimation(b)}else h||iL(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=p})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,Lo(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(_ae),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&N5(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let u=0;u<this.path.length;u++){const d=this.path[u];d.shouldResetTransform=!0,d.updateScroll("snapshot"),d.options.layoutRoot&&d.willUpdate(!1)}const{layoutId:a,layout:l}=this.options;if(a===void 0&&!l)return;const c=this.getTransformTemplate();this.prevTransformTemplateValue=c?c(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(rL);return}this.isUpdating||this.nodes.forEach(Cae),this.isUpdating=!1,this.nodes.forEach(Tae),this.nodes.forEach(vae),this.nodes.forEach(bae),this.clearAllSnapshots();const a=xa.now();As.delta=Ia(0,1e3/60,a-As.timestamp),As.timestamp=a,As.isProcessing=!0,lC.update.process(As),lC.preRender.process(As),lC.render.process(As),As.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,eE.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(kae),this.sharedNodes.forEach(Eae)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,jt.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){jt.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let l=0;l<this.path.length;l++)this.path[l].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutCorrected=qn(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:a}=this.options;a&&a.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let a=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(a=!1),a){const l=s(this.instance);this.scroll={animationId:this.root.animationId,phase:o,isRoot:l,offset:n(this.instance),wasRoot:this.scroll?this.scroll.isRoot:l}}}resetTransform(){if(!r)return;const o=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,a=this.projectionDelta&&!C5(this.projectionDelta),l=this.getTransformTemplate(),c=l?l(this.latestValues,""):void 0,u=c!==this.prevTransformTemplateValue;o&&(a||Cu(this.latestValues)||u)&&(r(this.instance,c),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const a=this.measurePageBox();let l=this.removeElementScroll(a);return o&&(l=this.removeTransform(l)),Dae(l),{animationId:this.root.animationId,measuredBox:a,layoutBox:l,latestValues:{},source:this.id}}measurePageBox(){var o;const{visualElement:a}=this.options;if(!a)return qn();const l=a.measureViewportBox();if(!(((o=this.scroll)===null||o===void 0?void 0:o.wasRoot)||this.path.some(Oae))){const{scroll:u}=this.root;u&&(Nh(l.x,u.offset.x),Nh(l.y,u.offset.y))}return l}removeElementScroll(o){var a;const l=qn();if(Fi(l,o),!((a=this.scroll)===null||a===void 0)&&a.wasRoot)return l;for(let c=0;c<this.path.length;c++){const u=this.path[c],{scroll:d,options:h}=u;u!==this.root&&d&&h.layoutScroll&&(d.wasRoot&&Fi(l,o),Nh(l.x,d.offset.x),Nh(l.y,d.offset.y))}return l}applyTransform(o,a=!1){const l=qn();Fi(l,o);for(let c=0;c<this.path.length;c++){const u=this.path[c];!a&&u.options.layoutScroll&&u.scroll&&u!==u.root&&Ih(l,{x:-u.scroll.offset.x,y:-u.scroll.offset.y}),Cu(u.latestValues)&&Ih(l,u.latestValues)}return Cu(this.latestValues)&&Ih(l,this.latestValues),l}removeTransform(o){const a=qn();Fi(a,o);for(let l=0;l<this.path.length;l++){const c=this.path[l];if(!c.instance||!Cu(c.latestValues))continue;UN(c.latestValues)&&c.updateSnapshot();const u=qn(),d=c.measurePageBox();Fi(u,d),ZF(a,c.latestValues,c.snapshot?c.snapshot.layoutBox:void 0,u)}return Cu(this.latestValues)&&ZF(a,this.latestValues),a}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==As.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){var a;const l=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=l.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=l.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=l.isSharedProjectionDirty);const c=!!this.resumingFrom||this!==l;if(!(o||c&&this.isSharedProjectionDirty||this.isProjectionDirty||!((a=this.parent)===null||a===void 0)&&a.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:d,layoutId:h}=this.options;if(!(!this.layout||!(d||h))){if(this.resolvedRelativeTargetAt=As.timestamp,!this.targetDelta&&!this.relativeTarget){const f=this.getClosestProjectingParent();f&&f.layout&&this.animationProgress!==1?(this.relativeParent=f,this.forceRelativeParentToResolveTarget(),this.relativeTarget=qn(),this.relativeTargetOrigin=qn(),Lm(this.relativeTargetOrigin,this.layout.layoutBox,f.layout.layoutBox),Fi(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=qn(),this.targetWithTransforms=qn()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),Loe(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Fi(this.target,this.layout.layoutBox),x5(this.target,this.targetDelta)):Fi(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const f=this.getClosestProjectingParent();f&&!!f.resumingFrom==!!this.resumingFrom&&!f.options.layoutScroll&&f.target&&this.animationProgress!==1?(this.relativeParent=f,this.forceRelativeParentToResolveTarget(),this.relativeTarget=qn(),this.relativeTargetOrigin=qn(),Lm(this.relativeTargetOrigin,this.target,f.target),Fi(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}im&&Tu.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||UN(this.parent.latestValues)||y5(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var o;const a=this.getLead(),l=!!this.resumingFrom||this!==a;let c=!0;if((this.isProjectionDirty||!((o=this.parent)===null||o===void 0)&&o.isProjectionDirty)&&(c=!1),l&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(c=!1),this.resolvedRelativeTargetAt===As.timestamp&&(c=!1),c)return;const{layout:u,layoutId:d}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(u||d))return;Fi(this.layoutCorrected,this.layout.layoutBox);const h=this.treeScale.x,f=this.treeScale.y;Goe(this.layoutCorrected,this.treeScale,this.path,l),a.layout&&!a.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(a.target=a.layout.layoutBox,a.targetWithTransforms=qn());const{target:p}=a;if(!p){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(qF(this.prevProjectionDelta.x,this.projectionDelta.x),qF(this.prevProjectionDelta.y,this.projectionDelta.y)),Fm(this.projectionDelta,this.layoutCorrected,p,this.latestValues),(this.treeScale.x!==h||this.treeScale.y!==f||!nL(this.projectionDelta.x,this.prevProjectionDelta.x)||!nL(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",p)),im&&Tu.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){var a;if((a=this.options.visualElement)===null||a===void 0||a.scheduleRender(),o){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=Th(),this.projectionDelta=Th(),this.projectionDeltaWithTransform=Th()}setAnimationOrigin(o,a=!1){const l=this.snapshot,c=l?l.latestValues:{},u={...this.latestValues},d=Th();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!a;const h=qn(),f=l?l.source:void 0,p=this.layout?this.layout.source:void 0,m=f!==p,g=this.getStack(),y=!g||g.members.length<=1,x=!!(m&&!y&&this.options.crossfade===!0&&!this.path.some(Aae));this.animationProgress=0;let v;this.mixTargetDelta=b=>{const k=b/1e3;oL(d.x,o.x,k),oL(d.y,o.y,k),this.setTargetDelta(d),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Lm(h,this.layout.layoutBox,this.relativeParent.layout.layoutBox),$ae(this.relativeTarget,this.relativeTargetOrigin,h,k),v&&pae(this.relativeTarget,v)&&(this.isProjectionDirty=!1),v||(v=qn()),Fi(v,this.relativeTarget)),m&&(this.animationValues=u,lae(u,c,this.latestValues,k,x,y)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=k},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(Lo(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=jt.update(()=>{kv.hasAnimatedSinceResize=!0,this.currentAnimation=nae(0,sL,{...o,onUpdate:a=>{this.mixTargetDelta(a),o.onUpdate&&o.onUpdate(a)},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(sL),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:a,target:l,layout:c,latestValues:u}=o;if(!(!a||!l||!c)){if(this!==o&&this.layout&&c&&_5(this.options.animationType,this.layout.layoutBox,c.layoutBox)){l=this.target||qn();const d=ki(this.layout.layoutBox.x);l.x.min=o.target.x.min,l.x.max=l.x.min+d;const h=ki(this.layout.layoutBox.y);l.y.min=o.target.y.min,l.y.max=l.y.min+h}Fi(a,l),Ih(a,u),Fm(this.projectionDeltaWithTransform,this.layoutCorrected,a,u)}}registerSharedNode(o,a){this.sharedNodes.has(o)||this.sharedNodes.set(o,new mae),this.sharedNodes.get(o).add(a);const c=a.options.initialPromotionConfig;a.promote({transition:c?c.transition:void 0,preserveFollowOpacity:c&&c.shouldPreserveFollowOpacity?c.shouldPreserveFollowOpacity(a):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){var o;const{layoutId:a}=this.options;return a?((o=this.getStack())===null||o===void 0?void 0:o.lead)||this:this}getPrevLead(){var o;const{layoutId:a}=this.options;return a?(o=this.getStack())===null||o===void 0?void 0:o.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:a,preserveFollowOpacity:l}={}){const c=this.getStack();c&&c.promote(this,l),o&&(this.projectionDelta=void 0,this.needsReset=!0),a&&this.setOptions({transition:a})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetSkewAndRotation(){const{visualElement:o}=this.options;if(!o)return;let a=!1;const{latestValues:l}=o;if((l.z||l.rotate||l.rotateX||l.rotateY||l.rotateZ||l.skewX||l.skewY)&&(a=!0),!a)return;const c={};l.z&&xC("z",o,c,this.animationValues);for(let u=0;u<yC.length;u++)xC(`rotate${yC[u]}`,o,c,this.animationValues),xC(`skew${yC[u]}`,o,c,this.animationValues);o.render();for(const u in c)o.setStaticValue(u,c[u]),this.animationValues&&(this.animationValues[u]=c[u]);o.scheduleRender()}getProjectionStyles(o){var a,l;if(!this.instance||this.isSVG)return;if(!this.isVisible)return yae;const c={visibility:""},u=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,c.opacity="",c.pointerEvents=wv(o==null?void 0:o.pointerEvents)||"",c.transform=u?u(this.latestValues,""):"none",c;const d=this.getLead();if(!this.projectionDelta||!this.layout||!d.target){const m={};return this.options.layoutId&&(m.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,m.pointerEvents=wv(o==null?void 0:o.pointerEvents)||""),this.hasProjected&&!Cu(this.latestValues)&&(m.transform=u?u({},""):"none",this.hasProjected=!1),m}const h=d.animationValues||d.latestValues;this.applyTransformsToTarget(),c.transform=gae(this.projectionDeltaWithTransform,this.treeScale,h),u&&(c.transform=u(h,c.transform));const{x:f,y:p}=this.projectionDelta;c.transformOrigin=`${f.origin*100}% ${p.origin*100}% 0`,d.animationValues?c.opacity=d===this?(l=(a=h.opacity)!==null&&a!==void 0?a:this.latestValues.opacity)!==null&&l!==void 0?l:1:this.preserveOpacity?this.latestValues.opacity:h.opacityExit:c.opacity=d===this?h.opacity!==void 0?h.opacity:"":h.opacityExit!==void 0?h.opacityExit:0;for(const m in xb){if(h[m]===void 0)continue;const{correct:g,applyTo:y}=xb[m],x=c.transform==="none"?h[m]:g(h[m],d);if(y){const v=y.length;for(let b=0;b<v;b++)c[y[b]]=x}else c[m]=x}return this.options.layoutId&&(c.pointerEvents=d===this?wv(o==null?void 0:o.pointerEvents)||"":"none"),c}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>{var a;return(a=o.currentAnimation)===null||a===void 0?void 0:a.stop()}),this.root.nodes.forEach(rL),this.root.sharedNodes.clear()}}}function vae(t){t.updateLayout()}function bae(t){var e;const n=((e=t.resumeFrom)===null||e===void 0?void 0:e.snapshot)||t.snapshot;if(t.isLead()&&t.layout&&n&&t.hasListeners("didUpdate")){const{layoutBox:s,measuredBox:r}=t.layout,{animationType:i}=t.options,o=n.source!==t.layout.source;i==="size"?Vi(d=>{const h=o?n.measuredBox[d]:n.layoutBox[d],f=ki(h);h.min=s[d].min,h.max=h.min+f}):_5(i,n.layoutBox,s)&&Vi(d=>{const h=o?n.measuredBox[d]:n.layoutBox[d],f=ki(s[d]);h.max=h.min+f,t.relativeTarget&&!t.currentAnimation&&(t.isProjectionDirty=!0,t.relativeTarget[d].max=t.relativeTarget[d].min+f)});const a=Th();Fm(a,s,n.layoutBox);const l=Th();o?Fm(l,t.applyTransform(r,!0),n.measuredBox):Fm(l,s,n.layoutBox);const c=!C5(a);let u=!1;if(!t.resumeFrom){const d=t.getClosestProjectingParent();if(d&&!d.resumeFrom){const{snapshot:h,layout:f}=d;if(h&&f){const p=qn();Lm(p,n.layoutBox,h.layoutBox);const m=qn();Lm(m,s,f.layoutBox),T5(p,m)||(u=!0),d.options.layoutRoot&&(t.relativeTarget=m,t.relativeTargetOrigin=p,t.relativeParent=d)}}}t.notifyListeners("didUpdate",{layout:s,snapshot:n,delta:l,layoutDelta:a,hasLayoutChanged:c,hasRelativeTargetChanged:u})}else if(t.isLead()){const{onExitComplete:s}=t.options;s&&s()}t.options.transition=void 0}function wae(t){im&&Tu.totalNodes++,t.parent&&(t.isProjecting()||(t.isProjectionDirty=t.parent.isProjectionDirty),t.isSharedProjectionDirty||(t.isSharedProjectionDirty=!!(t.isProjectionDirty||t.parent.isProjectionDirty||t.parent.isSharedProjectionDirty)),t.isTransformDirty||(t.isTransformDirty=t.parent.isTransformDirty))}function Sae(t){t.isProjectionDirty=t.isSharedProjectionDirty=t.isTransformDirty=!1}function kae(t){t.clearSnapshot()}function rL(t){t.clearMeasurements()}function Cae(t){t.isLayoutDirty=!1}function Tae(t){const{visualElement:e}=t.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),t.resetTransform()}function iL(t){t.finishAnimation(),t.targetDelta=t.relativeTarget=t.target=void 0,t.isProjectionDirty=!0}function Nae(t){t.resolveTargetDelta()}function Iae(t){t.calcProjection()}function _ae(t){t.resetSkewAndRotation()}function Eae(t){t.removeLeadSnapshot()}function oL(t,e,n){t.translate=An(e.translate,0,n),t.scale=An(e.scale,1,n),t.origin=e.origin,t.originPoint=e.originPoint}function aL(t,e,n,s){t.min=An(e.min,n.min,s),t.max=An(e.max,n.max,s)}function $ae(t,e,n,s){aL(t.x,e.x,n.x,s),aL(t.y,e.y,n.y,s)}function Aae(t){return t.animationValues&&t.animationValues.opacityExit!==void 0}const Rae={duration:.45,ease:[.4,0,.1,1]},lL=t=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(t),cL=lL("applewebkit/")&&!lL("chrome/")?Math.round:kr;function uL(t){t.min=cL(t.min),t.max=cL(t.max)}function Dae(t){uL(t.x),uL(t.y)}function _5(t,e,n){return t==="position"||t==="preserve-aspect"&&!Foe(tL(e),tL(n),.2)}function Oae(t){var e;return t!==t.root&&((e=t.scroll)===null||e===void 0?void 0:e.wasRoot)}const Pae=I5({attachResizeListener:(t,e)=>pg(t,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),vC={current:void 0},E5=I5({measureScroll:t=>({x:t.scrollLeft,y:t.scrollTop}),defaultParent:()=>{if(!vC.current){const t=new Pae({});t.mount(window),t.setOptions({layoutScroll:!0}),vC.current=t}return vC.current},resetTransform:(t,e)=>{t.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:t=>window.getComputedStyle(t).position==="fixed"}),Fae={pan:{Feature:Qoe},drag:{Feature:Zoe,ProjectionNode:E5,MeasureLayout:w5}};function dL(t,e,n){const{props:s}=t;t.animationState&&s.whileHover&&t.animationState.setActive("whileHover",n==="Start");const r="onHover"+n,i=s[r];i&&jt.postRender(()=>i(e,uy(e)))}class Lae extends Zc{mount(){const{current:e}=this.node;e&&(this.unmount=Mre(e,n=>(dL(this.node,n,"Start"),s=>dL(this.node,s,"End"))))}unmount(){}}class Mae extends Zc{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=cy(pg(this.node.current,"focus",()=>this.onFocus()),pg(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function hL(t,e,n){const{props:s}=t;t.animationState&&s.whileTap&&t.animationState.setActive("whileTap",n==="Start");const r="onTap"+(n==="End"?"":n),i=s[r];i&&jt.postRender(()=>i(e,uy(e)))}class zae extends Zc{mount(){const{current:e}=this.node;e&&(this.unmount=Bre(e,n=>(hL(this.node,n,"Start"),(s,{success:r})=>hL(this.node,s,r?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const GN=new WeakMap,bC=new WeakMap,Vae=t=>{const e=GN.get(t.target);e&&e(t)},jae=t=>{t.forEach(Vae)};function Bae({root:t,...e}){const n=t||document;bC.has(n)||bC.set(n,{});const s=bC.get(n),r=JSON.stringify(e);return s[r]||(s[r]=new IntersectionObserver(jae,{root:t,...e})),s[r]}function Wae(t,e,n){const s=Bae(e);return GN.set(t,n),s.observe(t),()=>{GN.delete(t),s.unobserve(t)}}const Uae={some:0,all:1};class Hae extends Zc{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:n,margin:s,amount:r="some",once:i}=e,o={root:n?n.current:void 0,rootMargin:s,threshold:typeof r=="number"?r:Uae[r]},a=l=>{const{isIntersecting:c}=l;if(this.isInView===c||(this.isInView=c,i&&!c&&this.hasEnteredView))return;c&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",c);const{onViewportEnter:u,onViewportLeave:d}=this.node.getProps(),h=c?u:d;h&&h(l)};return Wae(this.node.current,o,a)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:n}=this.node;["amount","margin","root"].some(Gae(e,n))&&this.startObserver()}unmount(){}}function Gae({viewport:t={}},{viewport:e={}}={}){return n=>t[n]!==e[n]}const Kae={inView:{Feature:Hae},tap:{Feature:zae},focus:{Feature:Mae},hover:{Feature:Lae}},qae={layout:{ProjectionNode:E5,MeasureLayout:w5}},KN={current:null},$5={current:!1};function Xae(){if($5.current=!0,!!q_)if(window.matchMedia){const t=window.matchMedia("(prefers-reduced-motion)"),e=()=>KN.current=t.matches;t.addListener(e),e()}else KN.current=!1}const Yae=[...e5,er,Oc],Zae=t=>Yae.find(JU(t)),fL=new WeakMap;function Qae(t,e,n){for(const s in e){const r=e[s],i=n[s];if(or(r))t.addValue(s,r);else if(or(i))t.addValue(s,ca(r,{owner:t}));else if(i!==r)if(t.hasValue(s)){const o=t.getValue(s);o.liveStyle===!0?o.jump(r):o.hasAnimated||o.set(r)}else{const o=t.getStaticValue(s);t.addValue(s,ca(o!==void 0?o:r,{owner:t}))}}for(const s in n)e[s]===void 0&&t.removeValue(s);return e}const pL=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class Jae{scrapeMotionValuesFromProps(e,n,s){return{}}constructor({parent:e,props:n,presenceContext:s,reducedMotionConfig:r,blockInitialAnimation:i,visualState:o},a={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=kE,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const f=xa.now();this.renderScheduledAt<f&&(this.renderScheduledAt=f,jt.render(this.render,!1,!0))};const{latestValues:l,renderState:c,onUpdate:u}=o;this.onUpdate=u,this.latestValues=l,this.baseTarget={...l},this.initialValues=n.initial?{...l}:{},this.renderState=c,this.parent=e,this.props=n,this.presenceContext=s,this.depth=e?e.depth+1:0,this.reducedMotionConfig=r,this.options=a,this.blockInitialAnimation=!!i,this.isControllingVariants=r1(n),this.isVariantNode=aU(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:d,...h}=this.scrapeMotionValuesFromProps(n,{},this);for(const f in h){const p=h[f];l[f]!==void 0&&or(p)&&p.set(l[f],!1)}}mount(e){this.current=e,fL.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((n,s)=>this.bindToMotionValue(s,n)),$5.current||Xae(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:KN.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){fL.delete(this.current),this.projection&&this.projection.unmount(),Lo(this.notifyUpdate),Lo(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const n=this.features[e];n&&(n.unmount(),n.isMounted=!1)}this.current=null}bindToMotionValue(e,n){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const s=Ad.has(e),r=n.on("change",a=>{this.latestValues[e]=a,this.props.onUpdate&&jt.preRender(this.notifyUpdate),s&&this.projection&&(this.projection.isTransformDirty=!0)}),i=n.on("renderRequest",this.scheduleRender);let o;window.MotionCheckAppearSync&&(o=window.MotionCheckAppearSync(this,e,n)),this.valueSubscriptions.set(e,()=>{r(),i(),o&&o(),n.owner&&n.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in bf){const n=bf[e];if(!n)continue;const{isEnabled:s,Feature:r}=n;if(!this.features[e]&&r&&s(this.props)&&(this.features[e]=new r(this)),this.features[e]){const i=this.features[e];i.isMounted?i.update():(i.mount(),i.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):qn()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,n){this.latestValues[e]=n}update(e,n){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=n;for(let s=0;s<pL.length;s++){const r=pL[s];this.propEventSubscriptions[r]&&(this.propEventSubscriptions[r](),delete this.propEventSubscriptions[r]);const i="on"+r,o=e[i];o&&(this.propEventSubscriptions[r]=this.on(r,o))}this.prevMotionValues=Qae(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue(),this.onUpdate&&this.onUpdate(this)}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const n=this.getClosestVariantNode();if(n)return n.variantChildren&&n.variantChildren.add(e),()=>n.variantChildren.delete(e)}addValue(e,n){const s=this.values.get(e);n!==s&&(s&&this.removeValue(e),this.bindToMotionValue(e,n),this.values.set(e,n),this.latestValues[e]=n.get())}removeValue(e){this.values.delete(e);const n=this.valueSubscriptions.get(e);n&&(n(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,n){if(this.props.values&&this.props.values[e])return this.props.values[e];let s=this.values.get(e);return s===void 0&&n!==void 0&&(s=ca(n===null?void 0:n,{owner:this}),this.addValue(e,s)),s}readValue(e,n){var s;let r=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:(s=this.getBaseTargetFromProps(this.props,e))!==null&&s!==void 0?s:this.readValueFromInstance(this.current,e,this.options);return r!=null&&(typeof r=="string"&&(ZU(r)||BU(r))?r=parseFloat(r):!Zae(r)&&Oc.test(n)&&(r=qU(e,n)),this.setBaseTarget(e,or(r)?r.get():r)),or(r)?r.get():r}setBaseTarget(e,n){this.baseTarget[e]=n}getBaseTarget(e){var n;const{initial:s}=this.props;let r;if(typeof s=="string"||typeof s=="object"){const o=nE(this.props,s,(n=this.presenceContext)===null||n===void 0?void 0:n.custom);o&&(r=o[e])}if(s&&r!==void 0)return r;const i=this.getBaseTargetFromProps(this.props,e);return i!==void 0&&!or(i)?i:this.initialValues[e]!==void 0&&r===void 0?void 0:this.baseTarget[e]}on(e,n){return this.events[e]||(this.events[e]=new gE),this.events[e].add(n)}notify(e,...n){this.events[e]&&this.events[e].notify(...n)}}class A5 extends Jae{constructor(){super(...arguments),this.KeyframeResolver=t5}sortInstanceNodePosition(e,n){return e.compareDocumentPosition(n)&2?1:-1}getBaseTargetFromProps(e,n){return e.style?e.style[n]:void 0}removeValueFromRenderState(e,{vars:n,style:s}){delete n[e],delete s[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;or(e)&&(this.childSubscription=e.on("change",n=>{this.current&&(this.current.textContent=`${n}`)}))}}function ele(t){return window.getComputedStyle(t)}class tle extends A5{constructor(){super(...arguments),this.type="html",this.renderInstance=gU}readValueFromInstance(e,n){if(Ad.has(n)){const s=SE(n);return s&&s.default||0}else{const s=ele(e),r=(fU(n)?s.getPropertyValue(n):s[n])||0;return typeof r=="string"?r.trim():r}}measureInstanceViewportBox(e,{transformPagePoint:n}){return v5(e,n)}build(e,n,s){iE(e,n,s.transformTemplate)}scrapeMotionValuesFromProps(e,n,s){return cE(e,n,s)}}class nle extends A5{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=qn}getBaseTargetFromProps(e,n){return e[n]}readValueFromInstance(e,n){if(Ad.has(n)){const s=SE(n);return s&&s.default||0}return n=yU.has(n)?n:J_(n),e.getAttribute(n)}scrapeMotionValuesFromProps(e,n,s){return bU(e,n,s)}build(e,n,s){oE(e,n,this.isSVGTag,s.transformTemplate)}renderInstance(e,n,s,r){xU(e,n,s,r)}mount(e){this.isSVGTag=lE(e.tagName),super.mount(e)}}const sle=(t,e)=>tE(t)?new nle(e):new tle(e,{allowProjection:t!==D.Fragment}),rle=Dre({...Ioe,...Kae,...Fae,...qae},sle),We=qse(rle);function R5(t,e){let n;const s=()=>{const{currentTime:r}=e,o=(r===null?0:r.value)/100;n!==o&&t(o),n=o};return jt.update(s,!0),()=>Lo(s)}const Cv=new WeakMap;let Fl;function ile(t,e){if(e){const{inlineSize:n,blockSize:s}=e[0];return{width:n,height:s}}else return t instanceof SVGElement&&"getBBox"in t?t.getBBox():{width:t.offsetWidth,height:t.offsetHeight}}function ole({target:t,contentRect:e,borderBoxSize:n}){var s;(s=Cv.get(t))===null||s===void 0||s.forEach(r=>{r({target:t,contentSize:e,get size(){return ile(t,n)}})})}function ale(t){t.forEach(ole)}function lle(){typeof ResizeObserver>"u"||(Fl=new ResizeObserver(ale))}function cle(t,e){Fl||lle();const n=EU(t);return n.forEach(s=>{let r=Cv.get(s);r||(r=new Set,Cv.set(s,r)),r.add(e),Fl==null||Fl.observe(s)}),()=>{n.forEach(s=>{const r=Cv.get(s);r==null||r.delete(e),r!=null&&r.size||Fl==null||Fl.unobserve(s)})}}const Tv=new Set;let Mm;function ule(){Mm=()=>{const t={width:window.innerWidth,height:window.innerHeight},e={target:window,size:t,contentSize:t};Tv.forEach(n=>n(e))},window.addEventListener("resize",Mm)}function dle(t){return Tv.add(t),Mm||ule(),()=>{Tv.delete(t),!Tv.size&&Mm&&(Mm=void 0)}}function hle(t,e){return typeof t=="function"?dle(t):cle(t,e)}const fle=50,mL=()=>({current:0,offset:[],progress:0,scrollLength:0,targetOffset:0,targetLength:0,containerLength:0,velocity:0}),ple=()=>({time:0,x:mL(),y:mL()}),mle={x:{length:"Width",position:"Left"},y:{length:"Height",position:"Top"}};function gL(t,e,n,s){const r=n[e],{length:i,position:o}=mle[e],a=r.current,l=n.time;r.current=t[`scroll${o}`],r.scrollLength=t[`scroll${i}`]-t[`client${i}`],r.offset.length=0,r.offset[0]=0,r.offset[1]=r.scrollLength,r.progress=pd(0,r.scrollLength,r.current);const c=s-l;r.velocity=c>fle?0:yE(r.current-a,c)}function gle(t,e,n){gL(t,"x",e,n),gL(t,"y",e,n),e.time=n}function yle(t,e){const n={x:0,y:0};let s=t;for(;s&&s!==e;)if(s instanceof HTMLElement)n.x+=s.offsetLeft,n.y+=s.offsetTop,s=s.offsetParent;else if(s.tagName==="svg"){const r=s.getBoundingClientRect();s=s.parentElement;const i=s.getBoundingClientRect();n.x+=r.left-i.left,n.y+=r.top-i.top}else if(s instanceof SVGGraphicsElement){const{x:r,y:i}=s.getBBox();n.x+=r,n.y+=i;let o=null,a=s.parentNode;for(;!o;)a.tagName==="svg"&&(o=a),a=s.parentNode;s=o}else break;return n}const qN={start:0,center:.5,end:1};function yL(t,e,n=0){let s=0;if(t in qN&&(t=qN[t]),typeof t=="string"){const r=parseFloat(t);t.endsWith("px")?s=r:t.endsWith("%")?t=r/100:t.endsWith("vw")?s=r/100*document.documentElement.clientWidth:t.endsWith("vh")?s=r/100*document.documentElement.clientHeight:t=r}return typeof t=="number"&&(s=e*t),n+s}const xle=[0,0];function vle(t,e,n,s){let r=Array.isArray(t)?t:xle,i=0,o=0;return typeof t=="number"?r=[t,t]:typeof t=="string"&&(t=t.trim(),t.includes(" ")?r=t.split(" "):r=[t,qN[t]?t:"0"]),i=yL(r[0],n,s),o=yL(r[1],e),i-o}const ble={Enter:[[0,1],[1,1]],Exit:[[0,0],[1,0]],Any:[[1,0],[0,1]],All:[[0,0],[1,1]]},wle={x:0,y:0};function Sle(t){return"getBBox"in t&&t.tagName!=="svg"?t.getBBox():{width:t.clientWidth,height:t.clientHeight}}function kle(t,e,n){const{offset:s=ble.All}=n,{target:r=t,axis:i="y"}=n,o=i==="y"?"height":"width",a=r!==t?yle(r,t):wle,l=r===t?{width:t.scrollWidth,height:t.scrollHeight}:Sle(r),c={width:t.clientWidth,height:t.clientHeight};e[i].offset.length=0;let u=!e[i].interpolate;const d=s.length;for(let h=0;h<d;h++){const f=vle(s[h],c[o],l[o],a[i]);!u&&f!==e[i].interpolatorOffsets[h]&&(u=!0),e[i].offset[h]=f}u&&(e[i].interpolate=TE(e[i].offset,l5(s),{clamp:!1}),e[i].interpolatorOffsets=[...e[i].offset]),e[i].progress=Ia(0,1,e[i].interpolate(e[i].current))}function Cle(t,e=t,n){if(n.x.targetOffset=0,n.y.targetOffset=0,e!==t){let s=e;for(;s&&s!==t;)n.x.targetOffset+=s.offsetLeft,n.y.targetOffset+=s.offsetTop,s=s.offsetParent}n.x.targetLength=e===t?e.scrollWidth:e.clientWidth,n.y.targetLength=e===t?e.scrollHeight:e.clientHeight,n.x.containerLength=t.clientWidth,n.y.containerLength=t.clientHeight}function Tle(t,e,n,s={}){return{measure:()=>Cle(t,s.target,n),update:r=>{gle(t,n,r),(s.offset||s.target)&&kle(t,n,s)},notify:()=>e(n)}}const zp=new WeakMap,xL=new WeakMap,wC=new WeakMap,vL=t=>t===document.documentElement?window:t;function _E(t,{container:e=document.documentElement,...n}={}){let s=wC.get(e);s||(s=new Set,wC.set(e,s));const r=ple(),i=Tle(e,t,r,n);if(s.add(i),!zp.has(e)){const a=()=>{for(const h of s)h.measure()},l=()=>{for(const h of s)h.update(As.timestamp)},c=()=>{for(const h of s)h.notify()},u=()=>{jt.read(a,!1,!0),jt.read(l,!1,!0),jt.update(c,!1,!0)};zp.set(e,u);const d=vL(e);window.addEventListener("resize",u,{passive:!0}),e!==document.documentElement&&xL.set(e,hle(e,u)),d.addEventListener("scroll",u,{passive:!0})}const o=zp.get(e);return jt.read(o,!1,!0),()=>{var a;Lo(o);const l=wC.get(e);if(!l||(l.delete(i),l.size))return;const c=zp.get(e);zp.delete(e),c&&(vL(e).removeEventListener("scroll",c),(a=xL.get(e))===null||a===void 0||a(),window.removeEventListener("resize",c))}}function Nle({source:t,container:e,axis:n="y"}){t&&(e=t);const s={value:0},r=_E(i=>{s.value=i[n].progress*100},{container:e,axis:n});return{currentTime:s,cancel:r}}const SC=new Map;function D5({source:t,container:e=document.documentElement,axis:n="y"}={}){t&&(e=t),SC.has(e)||SC.set(e,{});const s=SC.get(e);return s[n]||(s[n]=kU()?new ScrollTimeline({source:e,axis:n}):Nle({source:e,axis:n})),s[n]}function Ile(t){return t.length===2}function O5(t){return t&&(t.target||t.offset)}function _le(t,e){return Ile(t)||O5(e)?_E(n=>{t(n[e.axis].progress,n)},e):R5(t,D5(e))}function Ele(t,e){if(t.flatten(),O5(e))return t.pause(),_E(n=>{t.time=t.duration*n[e.axis].progress},e);{const n=D5(e);return t.attachTimeline?t.attachTimeline(n,s=>(s.pause(),R5(r=>{s.time=s.duration*r},n))):kr}}function $le(t,{axis:e="y",...n}={}){const s={axis:e,...n};return typeof t=="function"?_le(t,s):Ele(t,s)}function bL(t,e){Vse(!!(!e||e.current))}const Ale=()=>({scrollX:ca(0),scrollY:ca(0),scrollXProgress:ca(0),scrollYProgress:ca(0)});function P5({container:t,target:e,layoutEffect:n=!0,...s}={}){const r=t1(Ale);return(n?X_:D.useEffect)(()=>(bL("target",e),bL("container",t),$le((o,{x:a,y:l})=>{r.scrollX.set(a.current),r.scrollXProgress.set(a.progress),r.scrollY.set(l.current),r.scrollYProgress.set(l.progress)},{...s,container:(t==null?void 0:t.current)||void 0,target:(e==null?void 0:e.current)||void 0})),[t,e,JSON.stringify(s.offset)]),r}function Rle(t){const e=t1(()=>ca(t)),{isStatic:n}=D.useContext(K_);if(n){const[,s]=D.useState(t);D.useEffect(()=>e.on("change",s),[])}return e}function F5(t,e){const n=Rle(e()),s=()=>n.set(e());return s(),X_(()=>{const r=()=>jt.preRender(s,!1,!0),i=t.map(o=>o.on("change",r));return()=>{i.forEach(o=>o()),Lo(s)}}),n}const Dle=t=>t&&typeof t=="object"&&t.mix,Ole=t=>Dle(t)?t.mix:void 0;function Ple(...t){const e=!Array.isArray(t[0]),n=e?0:-1,s=t[0+n],r=t[1+n],i=t[2+n],o=t[3+n],a=TE(r,i,{mixer:Ole(i[0]),...o});return e?a(s):a}function Fle(t){Dm.current=[],t();const e=F5(Dm.current,t);return Dm.current=void 0,e}function Nv(t,e,n,s){if(typeof t=="function")return Fle(t);const r=typeof e=="function"?e:Ple(e,n,s);return Array.isArray(t)?wL(t,r):wL([t],([i])=>r(i))}function wL(t,e){const n=t1(()=>[]);return F5(t,()=>{n.length=0;const s=t.length;for(let r=0;r<s;r++)n[r]=t[r].get();return e(n)})}function Lle(){const[,t]=ti(),e=D.useRef(null),{scrollYProgress:n}=P5({target:e,offset:["start start","end start"]}),s=Nv(n,[0,1],["0%","50%"]),r=Nv(n,[0,1],[0,15]),i=Nv(n,[0,1],[1,.8]),[o,a]=D.useState(0),l=[{name:"Tree Pose",image:"https://images.unsplash.com/photo-1588286840104-8957b019727f?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&h=600",description:"Perfect balance and grounding"},{name:"Warrior Pose",image:"https://images.unsplash.com/photo-1544367567-0f2fcb009e0b?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&h=600",description:"Build strength and confidence"},{name:"Lotus Position",image:"https://images.unsplash.com/photo-1506905925346-21bda4d32df4?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&h=600",description:"Find inner peace and calm"}];D.useEffect(()=>{const u=setInterval(()=>{a(d=>(d+1)%l.length)},4e3);return()=>clearInterval(u)},[]);const c=[{label:"Active Users",value:"10K+"},{label:"Yoga Poses",value:"500+"},{label:"Satisfaction",value:"95%"}];return S.jsxs("section",{ref:e,className:"min-h-screen flex items-center relative overflow-hidden",children:[S.jsx(We.div,{className:"absolute inset-0 gradient-bg opacity-5",style:{y:s}}),S.jsx("div",{className:"absolute inset-0 overflow-hidden",children:[...Array(20)].map((u,d)=>S.jsx(We.div,{className:"absolute w-2 h-2 bg-primary-400 rounded-full opacity-30",initial:{x:Math.random()*window.innerWidth,y:Math.random()*window.innerHeight},animate:{y:[0,-100,0],x:[0,Math.random()*50-25,0],opacity:[.3,.8,.3]},transition:{duration:4+Math.random()*4,repeat:1/0,delay:Math.random()*3},style:{left:`${Math.random()*100}%`,top:`${Math.random()*100}%`}},d))}),S.jsxs("div",{className:"max-w-7xl mx-auto px-6 py-20 grid lg:grid-cols-2 gap-12 items-center relative z-10",children:[S.jsxs(We.div,{className:"space-y-8",initial:{opacity:0,x:-50},animate:{opacity:1,x:0},transition:{duration:.8,delay:.2},children:[S.jsx(We.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8,delay:.4},children:S.jsxs(We.h1,{className:"font-poppins font-bold text-5xl lg:text-7xl leading-tight",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:1,delay:.6},children:["Your Perfect",S.jsx(We.span,{className:"gradient-text block",initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{duration:.8,delay:.8},children:"Yoga Journey"}),"Starts Here"]})}),S.jsx(We.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8,delay:1},children:S.jsx("p",{className:"text-xl text-wellness-600 leading-relaxed",children:"Discover personalized yoga routines powered by AI. Whether you're a beginner or advanced practitioner, our intelligent system creates the perfect practice for your goals, flexibility, and lifestyle."})}),S.jsxs(We.div,{className:"flex flex-col sm:flex-row gap-4",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8,delay:1.2},children:[S.jsx(We.div,{whileHover:{scale:1.05},whileTap:{scale:.95},children:S.jsxs(lt,{onClick:()=>t("/assessment"),className:"gradient-bg text-white px-8 py-4 rounded-full font-semibold text-lg hover:shadow-xl transition-all flex items-center justify-center space-x-2",children:[S.jsx("span",{children:"Start Your Assessment"}),S.jsx(Qee,{className:"w-5 h-5"})]})}),S.jsx(We.div,{whileHover:{scale:1.05},whileTap:{scale:.95},children:S.jsxs(lt,{variant:"outline",className:"border-2 border-primary-400 text-primary-500 px-8 py-4 rounded-full font-semibold text-lg hover:bg-primary-50 transition-all flex items-center justify-center space-x-2",children:[S.jsx(fW,{className:"w-5 h-5"}),S.jsx("span",{children:"Watch Demo"})]})})]}),S.jsx(We.div,{className:"grid grid-cols-3 gap-8 pt-8",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8,delay:1.4},children:c.map((u,d)=>S.jsxs(We.div,{className:"text-center",whileHover:{scale:1.1},initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:1.6+d*.1},children:[S.jsx(We.div,{className:"text-3xl font-bold gradient-text",initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:200,delay:1.8+d*.1},children:u.value}),S.jsx("div",{className:"text-wellness-600",children:u.label})]},d))})]}),S.jsxs(We.div,{className:"relative",initial:{opacity:0,x:50},animate:{opacity:1,x:0},transition:{duration:.8,delay:.4},style:{scale:i,rotateX:r},children:[S.jsxs(We.div,{className:"w-full h-96 lg:h-[500px] rounded-3xl glass-morphism relative overflow-hidden",whileHover:{scale:1.02},transition:{duration:.3},children:[l.map((u,d)=>S.jsx(We.img,{src:u.image,alt:u.name,className:"w-full h-full object-cover rounded-3xl absolute inset-0",initial:{opacity:0,scale:1.1},animate:{opacity:d===o?1:0,scale:d===o?1:1.1},transition:{duration:1,ease:"easeInOut"}},d)),S.jsx(We.div,{className:"absolute inset-0 bg-gradient-to-br from-black/10 via-transparent to-primary-500/20 rounded-3xl",initial:{opacity:0},animate:{opacity:1},transition:{duration:1,delay:.5}}),S.jsxs(We.div,{className:"absolute bottom-6 left-6 bg-white/90 rounded-2xl p-4 backdrop-blur-sm",initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.5},children:[S.jsx("h3",{className:"font-semibold text-wellness-800",children:l[o].name}),S.jsx("p",{className:"text-sm text-wellness-600",children:l[o].description})]},o)]}),S.jsx(We.div,{className:"absolute -bottom-4 -right-4 bg-white rounded-2xl p-4 shadow-lg",initial:{opacity:0,scale:0},animate:{opacity:1,scale:1},transition:{type:"spring",stiffness:200,delay:1.5},whileHover:{scale:1.05,rotate:5},children:S.jsxs("div",{className:"flex items-center space-x-3",children:[S.jsx(We.div,{className:"w-12 h-12 bg-secondary-400 rounded-full flex items-center justify-center",animate:{rotate:[0,10,-10,0]},transition:{duration:2,repeat:1/0,delay:2},children:S.jsx(cte,{className:"w-6 h-6 text-white"})}),S.jsxs("div",{children:[S.jsx("div",{className:"font-semibold text-wellness-800",children:"AI Powered"}),S.jsx("div",{className:"text-sm text-wellness-600",children:"Personalized Routines"})]})]})}),[...Array(5)].map((u,d)=>S.jsx(We.div,{className:"absolute w-3 h-3 bg-gradient-to-r from-primary-400 to-secondary-400 rounded-full blur-sm",style:{top:`${15+d*20}%`,right:`${5+d*10}%`},animate:{y:[0,-30,0],x:[0,15,0],scale:[.8,1.4,.8],opacity:[.3,.9,.3]},transition:{duration:4+d*.8,repeat:1/0,delay:d*.7,ease:"easeInOut"}},d)),S.jsx(We.div,{className:"absolute inset-0 rounded-3xl",initial:{opacity:0},animate:{opacity:1},transition:{delay:2},children:[...Array(3)].map((u,d)=>S.jsx(We.div,{className:"absolute w-full h-0.5 bg-gradient-to-r from-transparent via-primary-400/50 to-transparent",style:{top:`${30+d*20}%`,left:0},animate:{scaleX:[0,1,0],opacity:[0,.7,0]},transition:{duration:3,repeat:1/0,delay:d*1,ease:"easeInOut"}},d))})]})]})]})}const Qn=D.forwardRef(({className:t,...e},n)=>S.jsx("div",{ref:n,className:Tn("rounded-lg border bg-card text-card-foreground shadow-sm",t),...e}));Qn.displayName="Card";const EE=D.forwardRef(({className:t,...e},n)=>S.jsx("div",{ref:n,className:Tn("flex flex-col space-y-1.5 p-6",t),...e}));EE.displayName="CardHeader";const $E=D.forwardRef(({className:t,...e},n)=>S.jsx("div",{ref:n,className:Tn("text-2xl font-semibold leading-none tracking-tight",t),...e}));$E.displayName="CardTitle";const AE=D.forwardRef(({className:t,...e},n)=>S.jsx("div",{ref:n,className:Tn("text-sm text-muted-foreground",t),...e}));AE.displayName="CardDescription";const Jn=D.forwardRef(({className:t,...e},n)=>S.jsx("div",{ref:n,className:Tn("p-6 pt-0",t),...e}));Jn.displayName="CardContent";const Mle=D.forwardRef(({className:t,...e},n)=>S.jsx("div",{ref:n,className:Tn("flex items-center p-6 pt-0",t),...e}));Mle.displayName="CardFooter";function zle(t="fadeInUp"){const e=D.useRef(null);return D.useEffect(()=>{const n=e.current;if(!n)return;const s=new IntersectionObserver(r=>{r.forEach(i=>{if(i.isIntersecting){switch(i.target.classList.remove("opacity-0","translate-y-12","-translate-x-12","translate-x-12","scale-75","rotate-12"),t){case"fadeInUp":i.target.classList.add("opacity-100","translate-y-0");break;case"fadeInLeft":i.target.classList.add("opacity-100","translate-x-0");break;case"fadeInRight":i.target.classList.add("opacity-100","translate-x-0");break;case"scale":i.target.classList.add("opacity-100","scale-100");break;case"rotateIn":i.target.classList.add("opacity-100","rotate-0");break}i.target.classList.add("transition-all","duration-700","ease-out","transform")}})},{threshold:.15,rootMargin:"0px 0px -50px 0px"});if(n)switch(n.classList.add("transition-all","duration-700","ease-out","transform"),t){case"fadeInUp":n.classList.add("opacity-0","translate-y-12");break;case"fadeInLeft":n.classList.add("opacity-0","-translate-x-12");break;case"fadeInRight":n.classList.add("opacity-0","translate-x-12");break;case"scale":n.classList.add("opacity-0","scale-75");break;case"rotateIn":n.classList.add("opacity-0","rotate-12");break}return s.observe(n),()=>{s.unobserve(n)}},[t]),e}function Vle(){const[,t]=ti(),e=zle(),n=D.useRef(null),{scrollYProgress:s}=P5({target:n,offset:["start end","end start"]}),r=Nv(s,[0,1],["0%","-20%"]),i=[{icon:S.jsx(pW,{className:"w-6 h-6"}),title:"Personalized Routines",description:"AI-powered recommendations based on your goals and experience level"},{icon:S.jsx(gte,{className:"w-6 h-6"}),title:"Real-time Guidance",description:"Step-by-step instructions with proper form demonstrations"},{icon:S.jsx(pte,{className:"w-6 h-6"}),title:"Progress Tracking",description:"Monitor your improvement with detailed analytics and achievements"}],o=[{label:"Active Users",value:"10K+"},{label:"Yoga Poses",value:"73+"},{label:"Satisfaction",value:"95%"}];return S.jsxs("div",{className:"min-h-screen bg-wellness-50",children:[S.jsx(il,{}),S.jsx(Lle,{}),S.jsxs(We.section,{ref:n,className:"py-20 bg-white relative overflow-hidden",style:{y:r},children:[S.jsx("div",{className:"absolute inset-0 overflow-hidden",children:[...Array(15)].map((a,l)=>S.jsx(We.div,{className:"absolute w-1 h-1 bg-primary-300 rounded-full opacity-20",animate:{y:[0,-50,0],x:[0,Math.random()*30-15,0],scale:[.5,1.5,.5],opacity:[.1,.4,.1]},transition:{duration:5+Math.random()*3,repeat:1/0,delay:Math.random()*2},style:{left:`${Math.random()*100}%`,top:`${Math.random()*100}%`}},l))}),S.jsxs("div",{className:"max-w-7xl mx-auto px-6 relative z-10",children:[S.jsxs(We.div,{ref:e,className:"text-center mb-16",initial:{opacity:0,y:50},whileInView:{opacity:1,y:0},transition:{duration:.8},viewport:{once:!0,margin:"-100px"},children:[S.jsxs(We.h2,{className:"font-poppins font-bold text-4xl lg:text-5xl mb-6",initial:{opacity:0,scale:.8},whileInView:{opacity:1,scale:1},transition:{duration:.8,delay:.2},viewport:{once:!0},children:["Why Choose ",S.jsx("span",{className:"gradient-text",children:"YogaFlow?"})]}),S.jsx(We.p,{className:"text-xl text-wellness-600 max-w-2xl mx-auto",initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},transition:{duration:.8,delay:.4},viewport:{once:!0},children:"Experience the perfect blend of ancient wisdom and modern technology"})]}),S.jsx("div",{className:"grid lg:grid-cols-3 gap-8",children:i.map((a,l)=>S.jsx(We.div,{initial:{opacity:0,y:50,rotateY:-15},whileInView:{opacity:1,y:0,rotateY:0},transition:{duration:.6,delay:l*.2,type:"spring",stiffness:100},viewport:{once:!0,margin:"-50px"},whileHover:{y:-10,rotateY:5,scale:1.02,transition:{duration:.3}},children:S.jsxs(Qn,{className:"bg-wellness-50 border-none shadow-lg hover:shadow-xl transition-all h-full relative overflow-hidden",children:[S.jsx(We.div,{className:"absolute inset-0 bg-gradient-to-br from-primary-400/5 to-secondary-400/5 opacity-0",whileHover:{opacity:1},transition:{duration:.3}}),S.jsxs(Jn,{className:"p-8 text-center relative z-10",children:[S.jsxs(We.div,{className:"w-16 h-16 gradient-bg rounded-full flex items-center justify-center mx-auto mb-6 text-white relative",whileHover:{scale:1.1,rotate:[0,-10,10,0]},transition:{duration:.5},children:[a.icon,S.jsx(We.div,{className:"absolute inset-0 bg-white/20 rounded-full",animate:{scale:[1,1.2,1],opacity:[0,.5,0]},transition:{duration:2,repeat:1/0,delay:l*.7}})]}),S.jsx(We.h3,{className:"font-bold text-xl mb-4",initial:{opacity:0},whileInView:{opacity:1},transition:{delay:.1+l*.2},children:a.title}),S.jsx(We.p,{className:"text-wellness-600",initial:{opacity:0},whileInView:{opacity:1},transition:{delay:.2+l*.2},children:a.description})]})]})},l))})]})]}),S.jsxs(We.section,{className:"py-20 gradient-bg relative overflow-hidden",initial:{opacity:0},whileInView:{opacity:1},transition:{duration:1},viewport:{once:!0},children:[S.jsx("div",{className:"absolute inset-0",children:[...Array(8)].map((a,l)=>S.jsx(We.div,{className:"absolute w-32 h-32 border border-white/10 rounded-full",style:{left:`${10+l*15}%`,top:`${20+l%3*20}%`},animate:{scale:[1,1.2,1],rotate:[0,180,360],opacity:[.1,.3,.1]},transition:{duration:8+l*2,repeat:1/0,delay:l*.5}},l))}),S.jsx("div",{className:"max-w-7xl mx-auto px-6 relative z-10",children:S.jsx("div",{className:"grid grid-cols-3 gap-8 text-center text-white",children:o.map((a,l)=>S.jsxs(We.div,{initial:{opacity:0,scale:.5,y:50},whileInView:{opacity:1,scale:1,y:0},transition:{duration:.8,delay:l*.2,type:"spring",stiffness:100},viewport:{once:!0},whileHover:{scale:1.1,y:-10,transition:{duration:.3}},className:"group cursor-pointer",children:[S.jsxs(We.div,{className:"text-4xl font-bold mb-2 relative",animate:{textShadow:["0 0 10px rgba(255,255,255,0.3)","0 0 20px rgba(255,255,255,0.6)","0 0 10px rgba(255,255,255,0.3)"]},transition:{duration:2,repeat:1/0,delay:l*.7},children:[a.value,S.jsx(We.div,{className:"absolute -inset-2 bg-white/10 rounded-lg opacity-0 group-hover:opacity-100",initial:{scale:.8},whileHover:{scale:1},transition:{duration:.3}})]}),S.jsx(We.div,{className:"text-lg opacity-90",initial:{opacity:0},whileInView:{opacity:.9},transition:{delay:.3+l*.1},children:a.label})]},l))})})]}),S.jsxs(We.section,{className:"py-20 bg-white relative overflow-hidden",initial:{opacity:0},whileInView:{opacity:1},transition:{duration:1},viewport:{once:!0,margin:"-100px"},children:[S.jsx("div",{className:"absolute inset-0",children:[...Array(12)].map((a,l)=>S.jsx(We.div,{className:"absolute w-8 h-8 bg-gradient-to-br from-primary-200 to-secondary-200 rounded-full opacity-20",style:{left:`${Math.random()*100}%`,top:`${Math.random()*100}%`},animate:{y:[0,-100,0],x:[0,Math.random()*50-25,0],rotate:[0,360],scale:[.5,1.2,.5]},transition:{duration:6+Math.random()*4,repeat:1/0,delay:Math.random()*3}},l))}),S.jsxs("div",{className:"max-w-4xl mx-auto px-6 text-center relative z-10",children:[S.jsxs(We.h2,{className:"font-poppins font-bold text-4xl lg:text-5xl mb-6",initial:{opacity:0,y:50,scale:.8},whileInView:{opacity:1,y:0,scale:1},transition:{duration:.8,type:"spring",stiffness:100},viewport:{once:!0},children:["Ready to Start Your"," ",S.jsxs(We.span,{className:"gradient-text relative",initial:{opacity:0,rotateX:-90},whileInView:{opacity:1,rotateX:0},transition:{duration:.8,delay:.3},children:["Yoga Journey?",S.jsx(We.div,{className:"absolute -inset-2 bg-gradient-to-r from-primary-400/20 to-secondary-400/20 rounded-lg -z-10",initial:{scale:0,rotate:-5},whileInView:{scale:1,rotate:0},transition:{duration:.5,delay:.5}})]})]}),S.jsx(We.p,{className:"text-xl text-wellness-600 mb-8 max-w-2xl mx-auto",initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},transition:{duration:.8,delay:.4},viewport:{once:!0},children:"Take our personalized assessment and receive custom yoga routines designed just for you"}),S.jsx(We.div,{initial:{opacity:0,scale:.8},whileInView:{opacity:1,scale:1},transition:{duration:.6,delay:.6,type:"spring",stiffness:150},viewport:{once:!0},whileHover:{scale:1.05},whileTap:{scale:.95},children:S.jsxs(lt,{onClick:()=>t("/assessment"),className:"gradient-bg text-white px-12 py-6 text-lg font-semibold hover:shadow-xl transition-all relative overflow-hidden group",children:[S.jsx(We.div,{className:"absolute inset-0 bg-gradient-to-r from-white/20 to-transparent opacity-0 group-hover:opacity-100",initial:{x:"-100%"},whileHover:{x:"100%"},transition:{duration:.6}}),S.jsx("span",{className:"relative z-10",children:"Start Your Assessment"}),S.jsx(We.div,{className:"ml-2 inline-block",animate:{x:[0,5,0]},transition:{duration:1.5,repeat:1/0},children:"✨"})]})})]})]}),S.jsx("footer",{className:"bg-wellness-800 text-white py-16",children:S.jsxs("div",{className:"max-w-7xl mx-auto px-6",children:[S.jsxs("div",{className:"grid lg:grid-cols-4 gap-8 mb-12",children:[S.jsxs("div",{children:[S.jsxs("div",{className:"flex items-center space-x-2 mb-6",children:[S.jsx("div",{className:"w-10 h-10 gradient-bg rounded-full flex items-center justify-center",children:S.jsx("span",{className:"text-lg",children:"🧘"})}),S.jsx("span",{className:"font-poppins font-bold text-xl",children:"YogaFlow"})]}),S.jsx("p",{className:"text-gray-300 mb-6",children:"Discover your perfect yoga journey with AI-powered personalized routines designed for every level and goal."})]}),S.jsxs("div",{children:[S.jsx("h4",{className:"font-bold text-lg mb-6",children:"Features"}),S.jsxs("ul",{className:"space-y-3 text-gray-300",children:[S.jsx("li",{children:"Personalized Routines"}),S.jsx("li",{children:"AI Recommendations"}),S.jsx("li",{children:"Progress Tracking"}),S.jsx("li",{children:"Pose Library"})]})]}),S.jsxs("div",{children:[S.jsx("h4",{className:"font-bold text-lg mb-6",children:"Support"}),S.jsxs("ul",{className:"space-y-3 text-gray-300",children:[S.jsx("li",{children:"Help Center"}),S.jsx("li",{children:"Contact Us"}),S.jsx("li",{children:"Community"}),S.jsx("li",{children:"FAQ"})]})]}),S.jsxs("div",{children:[S.jsx("h4",{className:"font-bold text-lg mb-6",children:"Newsletter"}),S.jsx("p",{className:"text-gray-300 mb-6",children:"Get weekly yoga tips and new routine updates"}),S.jsxs("div",{className:"space-y-3",children:[S.jsx("input",{type:"email",placeholder:"Enter your email",className:"w-full px-4 py-3 rounded-xl bg-wellness-600 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-primary-500"}),S.jsx(lt,{className:"w-full gradient-bg text-white py-3 rounded-xl font-semibold hover:shadow-lg transition-all",children:"Subscribe"})]})]})]}),S.jsxs("div",{className:"border-t border-wellness-600 pt-8 flex flex-col lg:flex-row justify-between items-center",children:[S.jsx("div",{className:"text-gray-300 text-sm mb-4 lg:mb-0",children:"© 2024 YogaFlow. All rights reserved."}),S.jsxs("div",{className:"flex space-x-6 text-sm text-gray-300",children:[S.jsx("a",{href:"#",className:"hover:text-white transition-colors",children:"Privacy Policy"}),S.jsx("a",{href:"#",className:"hover:text-white transition-colors",children:"Terms of Service"}),S.jsx("a",{href:"#",className:"hover:text-white transition-colors",children:"Cookie Policy"})]})]})]})})]})}function jle(){const[t,e]=ti(),[n,s]=D.useState(!1),[r,i]=D.useState(!1),[o,a]=D.useState(!1);D.useEffect(()=>{i(!!localStorage.getItem("user"))},[t]);const l=[{href:"/",label:"Home"},{href:"/assessment",label:"Assessment"},{href:"/routines",label:"Routines"},{href:"/poses",label:"Poses"},{href:"live-detection",label:"Live Detection"}];return S.jsx("nav",{className:"fixed top-0 w-full z-50 transition-all duration-300 bg-white/80 backdrop-blur-md border-b border-wellness-200",children:S.jsxs("div",{className:"max-w-7xl mx-auto px-6 py-4",children:[S.jsxs("div",{className:"flex justify-between items-center",children:[S.jsxs("button",{onClick:()=>e("/"),className:"flex items-center space-x-2",children:[S.jsx("div",{className:"w-10 h-10 gradient-bg rounded-full flex items-center justify-center",children:S.jsx("span",{className:"text-white text-lg",children:"🧘"})}),S.jsx("span",{className:"font-poppins font-bold text-xl gradient-text",children:"YogaFlow"})]}),S.jsxs("div",{className:"hidden md:flex items-center space-x-8",children:[S.jsx("div",{className:"flex items-center space-x-6",children:l.map(c=>c.label==="Live Detection"?S.jsx("button",{onClick:()=>e("/live-detection"),className:"font-medium transition-colors text-wellness-600 hover:text-primary-500",children:c.label},c.href):S.jsx("button",{onClick:()=>e(c.href),className:`font-medium transition-colors ${t===c.href?"text-primary-500":"text-wellness-600 hover:text-primary-500"}`,children:c.label},c.href))}),S.jsx("div",{className:"flex items-center space-x-3",children:r?S.jsxs("div",{className:"relative",children:[S.jsx("button",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-primary-500 to-secondary-500 flex items-center justify-center font-bold text-white text-lg hover:shadow-lg transition-all",style:{minWidth:40,minHeight:40},onClick:()=>a(c=>!c),onBlur:()=>setTimeout(()=>a(!1),150),children:(()=>{try{const c=JSON.parse(localStorage.getItem("user")||"{}");return c.username?c.username.charAt(0).toUpperCase():"U"}catch{return"U"}})()}),o&&S.jsxs("div",{className:"absolute right-0 mt-2 bg-white border rounded shadow z-50 min-w-[120px] py-1 text-sm",style:{top:"100%"},children:[S.jsx("button",{className:"w-full px-3 py-1 text-left hover:bg-gray-100 rounded",onMouseDown:()=>e("/profile"),children:"Profile"}),S.jsx("button",{className:"w-full px-3 py-1 text-left hover:bg-gray-100 text-red-600 rounded",onMouseDown:()=>{localStorage.removeItem("user"),e("/login")},children:"Logout"})]})]}):S.jsxs(S.Fragment,{children:[S.jsx(lt,{onClick:()=>window.open("https://youtu.be/dQw4w9WgXcQ","_blank"),variant:"outline",size:"sm",className:"px-4 py-2 border-primary-500 text-primary-600 hover:bg-primary-50 transition-colors",children:"Watch Demo"}),S.jsx(lt,{onClick:()=>e("/login"),variant:"ghost",size:"sm",className:"px-4 py-2 text-wellness-600 hover:bg-gray-100 transition-colors",children:"Log In"}),S.jsx(lt,{onClick:()=>e("/signup"),size:"sm",className:"gradient-bg text-white px-4 py-2 rounded-full font-medium hover:shadow-lg transform hover:scale-105 transition-all",children:"Sign Up"}),S.jsx(lt,{onClick:()=>e("/assessment"),size:"sm",className:"bg-secondary-500 text-white px-4 py-2 rounded-full font-medium hover:bg-secondary-600 transform hover:scale-105 transition-all",children:"Get Started"})]})})]}),S.jsx("button",{className:"md:hidden text-wellness-600",onClick:()=>s(!n),children:n?S.jsx(P_,{className:"w-6 h-6"}):S.jsx(hW,{className:"w-6 h-6"})})]}),n&&S.jsx("div",{className:"md:hidden mt-4 pb-4 border-t border-wellness-200 pt-4",children:S.jsxs("div",{className:"flex flex-col space-y-4",children:[l.map(c=>S.jsx("button",{onClick:()=>{e(c.href),s(!1)},className:`text-left font-medium transition-colors ${t===c.href?"text-primary-500":"text-wellness-600 hover:text-primary-500"}`,children:c.label},c.href)),S.jsx("div",{className:"flex flex-col space-y-3 pt-2",children:r?S.jsxs("div",{className:"relative",children:[S.jsx("button",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-primary-500 to-secondary-500 flex items-center justify-center font-bold text-white text-lg hover:shadow-lg transition-all",style:{minWidth:40,minHeight:40},onClick:()=>a(c=>!c),onBlur:()=>setTimeout(()=>a(!1),150),children:(()=>{try{const c=JSON.parse(localStorage.getItem("user")||"{}");return c.username?c.username.charAt(0).toUpperCase():"U"}catch{return"U"}})()}),o&&S.jsxs("div",{className:"absolute left-0 w-full mt-2 bg-white border rounded shadow z-50 min-w-[120px] py-1 text-sm",style:{top:"100%"},children:[S.jsx("button",{className:"w-full px-3 py-1 text-left hover:bg-gray-100 rounded",onMouseDown:()=>{e("/profile"),s(!1)},children:"Profile"}),S.jsx("button",{className:"w-full px-3 py-1 text-left hover:bg-gray-100 text-red-600 rounded",onMouseDown:()=>{localStorage.removeItem("user"),e("/login"),s(!1)},children:"Logout"})]})]}):S.jsxs(S.Fragment,{children:[S.jsx(lt,{onClick:()=>{window.open("https://youtu.be/dQw4w9WgXcQ","_blank"),s(!1)},variant:"outline",className:"border-primary-500 text-primary-600 hover:bg-primary-50 w-fit",children:"Watch Demo"}),S.jsxs("div",{className:"flex gap-2",children:[S.jsx(lt,{onClick:()=>{e("/login"),s(!1)},variant:"ghost",size:"sm",className:"text-wellness-600 hover:bg-gray-100",children:"Log In"}),S.jsx(lt,{onClick:()=>{e("/signup"),s(!1)},size:"sm",className:"gradient-bg text-white px-4 py-2 rounded-full font-medium",children:"Sign Up"})]}),S.jsx(lt,{onClick:()=>{e("/assessment"),s(!1)},className:"bg-secondary-500 text-white px-6 py-2 rounded-full font-medium hover:bg-secondary-600 w-fit",children:"Get Started"})]})})]})})]})})}var dy=t=>t.type==="checkbox",Pu=t=>t instanceof Date,xr=t=>t==null;const L5=t=>typeof t=="object";var ss=t=>!xr(t)&&!Array.isArray(t)&&L5(t)&&!Pu(t),M5=t=>ss(t)&&t.target?dy(t.target)?t.target.checked:t.target.value:t,Ble=t=>t.substring(0,t.search(/\.\d+(\.|$)/))||t,z5=(t,e)=>t.has(Ble(e)),Wle=t=>{const e=t.constructor&&t.constructor.prototype;return ss(e)&&e.hasOwnProperty("isPrototypeOf")},RE=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function gs(t){let e;const n=Array.isArray(t),s=typeof FileList<"u"?t instanceof FileList:!1;if(t instanceof Date)e=new Date(t);else if(!(RE&&(t instanceof Blob||s))&&(n||ss(t)))if(e=n?[]:Object.create(Object.getPrototypeOf(t)),!n&&!Wle(t))e=t;else for(const r in t)t.hasOwnProperty(r)&&(e[r]=gs(t[r]));else return t;return e}var a1=t=>/^\w*$/.test(t),Xn=t=>t===void 0,DE=t=>Array.isArray(t)?t.filter(Boolean):[],OE=t=>DE(t.replace(/["|']|\]/g,"").split(/\.|\[/)),Ee=(t,e,n)=>{if(!e||!ss(t))return n;const s=(a1(e)?[e]:OE(e)).reduce((r,i)=>xr(r)?r:r[i],t);return Xn(s)||s===t?Xn(t[e])?n:t[e]:s},di=t=>typeof t=="boolean",Gt=(t,e,n)=>{let s=-1;const r=a1(e)?[e]:OE(e),i=r.length,o=i-1;for(;++s<i;){const a=r[s];let l=n;if(s!==o){const c=t[a];l=ss(c)||Array.isArray(c)?c:isNaN(+r[s+1])?{}:[]}if(a==="__proto__"||a==="constructor"||a==="prototype")return;t[a]=l,t=t[a]}};const Cb={BLUR:"blur",FOCUS_OUT:"focusout",CHANGE:"change"},_o={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},za={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},PE=et.createContext(null);PE.displayName="HookFormContext";const l1=()=>et.useContext(PE),Ule=t=>{const{children:e,...n}=t;return et.createElement(PE.Provider,{value:n},e)};var V5=(t,e,n,s=!0)=>{const r={defaultValues:e._defaultValues};for(const i in t)Object.defineProperty(r,i,{get:()=>{const o=i;return e._proxyFormState[o]!==_o.all&&(e._proxyFormState[o]=!s||_o.all),n&&(n[o]=!0),t[o]}});return r};const FE=typeof window<"u"?et.useLayoutEffect:et.useEffect;function Hle(t){const e=l1(),{control:n=e.control,disabled:s,name:r,exact:i}=t||{},[o,a]=et.useState(n._formState),l=et.useRef({isDirty:!1,isLoading:!1,dirtyFields:!1,touchedFields:!1,validatingFields:!1,isValidating:!1,isValid:!1,errors:!1});return FE(()=>n._subscribe({name:r,formState:l.current,exact:i,callback:c=>{!s&&a({...n._formState,...c})}}),[r,s,i]),et.useEffect(()=>{l.current.isValid&&n._setValid(!0)},[n]),et.useMemo(()=>V5(o,n,l.current,!1),[o,n])}var ua=t=>typeof t=="string",j5=(t,e,n,s,r)=>ua(t)?(s&&e.watch.add(t),Ee(n,t,r)):Array.isArray(t)?t.map(i=>(s&&e.watch.add(i),Ee(n,i))):(s&&(e.watchAll=!0),n),XN=t=>xr(t)||!L5(t);function Qa(t,e,n=new WeakSet){if(XN(t)||XN(e))return t===e;if(Pu(t)&&Pu(e))return t.getTime()===e.getTime();const s=Object.keys(t),r=Object.keys(e);if(s.length!==r.length)return!1;if(n.has(t)||n.has(e))return!0;n.add(t),n.add(e);for(const i of s){const o=t[i];if(!r.includes(i))return!1;if(i!=="ref"){const a=e[i];if(Pu(o)&&Pu(a)||ss(o)&&ss(a)||Array.isArray(o)&&Array.isArray(a)?!Qa(o,a,n):o!==a)return!1}}return!0}function Gle(t){const e=l1(),{control:n=e.control,name:s,defaultValue:r,disabled:i,exact:o,compute:a}=t||{},l=et.useRef(r),c=et.useRef(a),u=et.useRef(void 0);c.current=a;const d=et.useMemo(()=>n._getWatch(s,l.current),[n,s]),[h,f]=et.useState(c.current?c.current(d):d);return FE(()=>n._subscribe({name:s,formState:{values:!0},exact:o,callback:p=>{if(!i){const m=j5(s,n._names,p.values||n._formValues,!1,l.current);if(c.current){const g=c.current(m);Qa(g,u.current)||(f(g),u.current=g)}else f(m)}}}),[n,i,s,o]),et.useEffect(()=>n._removeUnmounted()),h}function Kle(t){const e=l1(),{name:n,disabled:s,control:r=e.control,shouldUnregister:i,defaultValue:o}=t,a=z5(r._names.array,n),l=et.useMemo(()=>Ee(r._formValues,n,Ee(r._defaultValues,n,o)),[r,n,o]),c=Gle({control:r,name:n,defaultValue:l,exact:!0}),u=Hle({control:r,name:n,exact:!0}),d=et.useRef(t),h=et.useRef(r.register(n,{...t.rules,value:c,...di(t.disabled)?{disabled:t.disabled}:{}}));d.current=t;const f=et.useMemo(()=>Object.defineProperties({},{invalid:{enumerable:!0,get:()=>!!Ee(u.errors,n)},isDirty:{enumerable:!0,get:()=>!!Ee(u.dirtyFields,n)},isTouched:{enumerable:!0,get:()=>!!Ee(u.touchedFields,n)},isValidating:{enumerable:!0,get:()=>!!Ee(u.validatingFields,n)},error:{enumerable:!0,get:()=>Ee(u.errors,n)}}),[u,n]),p=et.useCallback(x=>h.current.onChange({target:{value:M5(x),name:n},type:Cb.CHANGE}),[n]),m=et.useCallback(()=>h.current.onBlur({target:{value:Ee(r._formValues,n),name:n},type:Cb.BLUR}),[n,r._formValues]),g=et.useCallback(x=>{const v=Ee(r._fields,n);v&&x&&(v._f.ref={focus:()=>x.focus&&x.focus(),select:()=>x.select&&x.select(),setCustomValidity:b=>x.setCustomValidity(b),reportValidity:()=>x.reportValidity()})},[r._fields,n]),y=et.useMemo(()=>({name:n,value:c,...di(s)||u.disabled?{disabled:u.disabled||s}:{},onChange:p,onBlur:m,ref:g}),[n,s,u.disabled,p,m,g,c]);return et.useEffect(()=>{const x=r._options.shouldUnregister||i;r.register(n,{...d.current.rules,...di(d.current.disabled)?{disabled:d.current.disabled}:{}});const v=(b,k)=>{const C=Ee(r._fields,b);C&&C._f&&(C._f.mount=k)};if(v(n,!0),x){const b=gs(Ee(r._options.defaultValues,n));Gt(r._defaultValues,n,b),Xn(Ee(r._formValues,n))&&Gt(r._formValues,n,b)}return!a&&r.register(n),()=>{(a?x&&!r._state.action:x)?r.unregister(n):v(n,!1)}},[n,r,a,i]),et.useEffect(()=>{r._setDisabledField({disabled:s,name:n})},[s,n,r]),et.useMemo(()=>({field:y,formState:u,fieldState:f}),[y,u,f])}const qle=t=>t.render(Kle(t));var B5=(t,e,n,s,r)=>e?{...n[t],types:{...n[t]&&n[t].types?n[t].types:{},[s]:r||!0}}:{},zm=t=>Array.isArray(t)?t:[t],SL=()=>{let t=[];return{get observers(){return t},next:r=>{for(const i of t)i.next&&i.next(r)},subscribe:r=>(t.push(r),{unsubscribe:()=>{t=t.filter(i=>i!==r)}}),unsubscribe:()=>{t=[]}}},Mr=t=>ss(t)&&!Object.keys(t).length,LE=t=>t.type==="file",Eo=t=>typeof t=="function",Tb=t=>{if(!RE)return!1;const e=t?t.ownerDocument:0;return t instanceof(e&&e.defaultView?e.defaultView.HTMLElement:HTMLElement)},W5=t=>t.type==="select-multiple",ME=t=>t.type==="radio",Xle=t=>ME(t)||dy(t),kC=t=>Tb(t)&&t.isConnected;function Yle(t,e){const n=e.slice(0,-1).length;let s=0;for(;s<n;)t=Xn(t)?s++:t[e[s++]];return t}function Zle(t){for(const e in t)if(t.hasOwnProperty(e)&&!Xn(t[e]))return!1;return!0}function is(t,e){const n=Array.isArray(e)?e:a1(e)?[e]:OE(e),s=n.length===1?t:Yle(t,n),r=n.length-1,i=n[r];return s&&delete s[i],r!==0&&(ss(s)&&Mr(s)||Array.isArray(s)&&Zle(s))&&is(t,n.slice(0,-1)),t}var U5=t=>{for(const e in t)if(Eo(t[e]))return!0;return!1};function Nb(t,e={}){const n=Array.isArray(t);if(ss(t)||n)for(const s in t)Array.isArray(t[s])||ss(t[s])&&!U5(t[s])?(e[s]=Array.isArray(t[s])?[]:{},Nb(t[s],e[s])):xr(t[s])||(e[s]=!0);return e}function H5(t,e,n){const s=Array.isArray(t);if(ss(t)||s)for(const r in t)Array.isArray(t[r])||ss(t[r])&&!U5(t[r])?Xn(e)||XN(n[r])?n[r]=Array.isArray(t[r])?Nb(t[r],[]):{...Nb(t[r])}:H5(t[r],xr(e)?{}:e[r],n[r]):n[r]=!Qa(t[r],e[r]);return n}var Vp=(t,e)=>H5(t,e,Nb(e));const kL={value:!1,isValid:!1},CL={value:!0,isValid:!0};var G5=t=>{if(Array.isArray(t)){if(t.length>1){const e=t.filter(n=>n&&n.checked&&!n.disabled).map(n=>n.value);return{value:e,isValid:!!e.length}}return t[0].checked&&!t[0].disabled?t[0].attributes&&!Xn(t[0].attributes.value)?Xn(t[0].value)||t[0].value===""?CL:{value:t[0].value,isValid:!0}:CL:kL}return kL},K5=(t,{valueAsNumber:e,valueAsDate:n,setValueAs:s})=>Xn(t)?t:e?t===""?NaN:t&&+t:n&&ua(t)?new Date(t):s?s(t):t;const TL={isValid:!1,value:null};var q5=t=>Array.isArray(t)?t.reduce((e,n)=>n&&n.checked&&!n.disabled?{isValid:!0,value:n.value}:e,TL):TL;function NL(t){const e=t.ref;return LE(e)?e.files:ME(e)?q5(t.refs).value:W5(e)?[...e.selectedOptions].map(({value:n})=>n):dy(e)?G5(t.refs).value:K5(Xn(e.value)?t.ref.value:e.value,t)}var Qle=(t,e,n,s)=>{const r={};for(const i of t){const o=Ee(e,i);o&&Gt(r,i,o._f)}return{criteriaMode:n,names:[...t],fields:r,shouldUseNativeValidation:s}},Ib=t=>t instanceof RegExp,jp=t=>Xn(t)?t:Ib(t)?t.source:ss(t)?Ib(t.value)?t.value.source:t.value:t,IL=t=>({isOnSubmit:!t||t===_o.onSubmit,isOnBlur:t===_o.onBlur,isOnChange:t===_o.onChange,isOnAll:t===_o.all,isOnTouch:t===_o.onTouched});const _L="AsyncFunction";var Jle=t=>!!t&&!!t.validate&&!!(Eo(t.validate)&&t.validate.constructor.name===_L||ss(t.validate)&&Object.values(t.validate).find(e=>e.constructor.name===_L)),ece=t=>t.mount&&(t.required||t.min||t.max||t.maxLength||t.minLength||t.pattern||t.validate),EL=(t,e,n)=>!n&&(e.watchAll||e.watch.has(t)||[...e.watch].some(s=>t.startsWith(s)&&/^\.\w+/.test(t.slice(s.length))));const Vm=(t,e,n,s)=>{for(const r of n||Object.keys(t)){const i=Ee(t,r);if(i){const{_f:o,...a}=i;if(o){if(o.refs&&o.refs[0]&&e(o.refs[0],r)&&!s)return!0;if(o.ref&&e(o.ref,o.name)&&!s)return!0;if(Vm(a,e))break}else if(ss(a)&&Vm(a,e))break}}};function $L(t,e,n){const s=Ee(t,n);if(s||a1(n))return{error:s,name:n};const r=n.split(".");for(;r.length;){const i=r.join("."),o=Ee(e,i),a=Ee(t,i);if(o&&!Array.isArray(o)&&n!==i)return{name:n};if(a&&a.type)return{name:i,error:a};if(a&&a.root&&a.root.type)return{name:`${i}.root`,error:a.root};r.pop()}return{name:n}}var tce=(t,e,n,s)=>{n(t);const{name:r,...i}=t;return Mr(i)||Object.keys(i).length>=Object.keys(e).length||Object.keys(i).find(o=>e[o]===(!s||_o.all))},nce=(t,e,n)=>!t||!e||t===e||zm(t).some(s=>s&&(n?s===e:s.startsWith(e)||e.startsWith(s))),sce=(t,e,n,s,r)=>r.isOnAll?!1:!n&&r.isOnTouch?!(e||t):(n?s.isOnBlur:r.isOnBlur)?!t:(n?s.isOnChange:r.isOnChange)?t:!0,rce=(t,e)=>!DE(Ee(t,e)).length&&is(t,e),ice=(t,e,n)=>{const s=zm(Ee(t,n));return Gt(s,"root",e[n]),Gt(t,n,s),t},Iv=t=>ua(t);function AL(t,e,n="validate"){if(Iv(t)||Array.isArray(t)&&t.every(Iv)||di(t)&&!t)return{type:n,message:Iv(t)?t:"",ref:e}}var Qd=t=>ss(t)&&!Ib(t)?t:{value:t,message:""},RL=async(t,e,n,s,r,i)=>{const{ref:o,refs:a,required:l,maxLength:c,minLength:u,min:d,max:h,pattern:f,validate:p,name:m,valueAsNumber:g,mount:y}=t._f,x=Ee(n,m);if(!y||e.has(m))return{};const v=a?a[0]:o,b=F=>{r&&v.reportValidity&&(v.setCustomValidity(di(F)?"":F||""),v.reportValidity())},k={},C=ME(o),N=dy(o),I=C||N,$=(g||LE(o))&&Xn(o.value)&&Xn(x)||Tb(o)&&o.value===""||x===""||Array.isArray(x)&&!x.length,A=B5.bind(null,m,s,k),P=(F,V,z,B=za.maxLength,W=za.minLength)=>{const q=F?V:z;k[m]={type:F?B:W,message:q,ref:o,...A(F?B:W,q)}};if(i?!Array.isArray(x)||!x.length:l&&(!I&&($||xr(x))||di(x)&&!x||N&&!G5(a).isValid||C&&!q5(a).isValid)){const{value:F,message:V}=Iv(l)?{value:!!l,message:l}:Qd(l);if(F&&(k[m]={type:za.required,message:V,ref:v,...A(za.required,V)},!s))return b(V),k}if(!$&&(!xr(d)||!xr(h))){let F,V;const z=Qd(h),B=Qd(d);if(!xr(x)&&!isNaN(x)){const W=o.valueAsNumber||x&&+x;xr(z.value)||(F=W>z.value),xr(B.value)||(V=W<B.value)}else{const W=o.valueAsDate||new Date(x),q=ne=>new Date(new Date().toDateString()+" "+ne),M=o.type=="time",G=o.type=="week";ua(z.value)&&x&&(F=M?q(x)>q(z.value):G?x>z.value:W>new Date(z.value)),ua(B.value)&&x&&(V=M?q(x)<q(B.value):G?x<B.value:W<new Date(B.value))}if((F||V)&&(P(!!F,z.message,B.message,za.max,za.min),!s))return b(k[m].message),k}if((c||u)&&!$&&(ua(x)||i&&Array.isArray(x))){const F=Qd(c),V=Qd(u),z=!xr(F.value)&&x.length>+F.value,B=!xr(V.value)&&x.length<+V.value;if((z||B)&&(P(z,F.message,V.message),!s))return b(k[m].message),k}if(f&&!$&&ua(x)){const{value:F,message:V}=Qd(f);if(Ib(F)&&!x.match(F)&&(k[m]={type:za.pattern,message:V,ref:o,...A(za.pattern,V)},!s))return b(V),k}if(p){if(Eo(p)){const F=await p(x,n),V=AL(F,v);if(V&&(k[m]={...V,...A(za.validate,V.message)},!s))return b(V.message),k}else if(ss(p)){let F={};for(const V in p){if(!Mr(F)&&!s)break;const z=AL(await p[V](x,n),v,V);z&&(F={...z,...A(V,z.message)},b(z.message),s&&(k[m]=F))}if(!Mr(F)&&(k[m]={ref:v,...F},!s))return k}}return b(!0),k};const oce={mode:_o.onSubmit,reValidateMode:_o.onChange,shouldFocusError:!0};function ace(t={}){let e={...oce,...t},n={submitCount:0,isDirty:!1,isReady:!1,isLoading:Eo(e.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:e.errors||{},disabled:e.disabled||!1},s={},r=ss(e.defaultValues)||ss(e.values)?gs(e.defaultValues||e.values)||{}:{},i=e.shouldUnregister?{}:gs(r),o={action:!1,mount:!1,watch:!1},a={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},l,c=0;const u={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1};let d={...u};const h={array:SL(),state:SL()},f=e.criteriaMode===_o.all,p=K=>re=>{clearTimeout(c),c=setTimeout(K,re)},m=async K=>{if(!e.disabled&&(u.isValid||d.isValid||K)){const re=e.resolver?Mr((await N()).errors):await $(s,!0);re!==n.isValid&&h.state.next({isValid:re})}},g=(K,re)=>{!e.disabled&&(u.isValidating||u.validatingFields||d.isValidating||d.validatingFields)&&((K||Array.from(a.mount)).forEach(ce=>{ce&&(re?Gt(n.validatingFields,ce,re):is(n.validatingFields,ce))}),h.state.next({validatingFields:n.validatingFields,isValidating:!Mr(n.validatingFields)}))},y=(K,re=[],ce,ke,xe=!0,ve=!0)=>{if(ke&&ce&&!e.disabled){if(o.action=!0,ve&&Array.isArray(Ee(s,K))){const Oe=ce(Ee(s,K),ke.argA,ke.argB);xe&&Gt(s,K,Oe)}if(ve&&Array.isArray(Ee(n.errors,K))){const Oe=ce(Ee(n.errors,K),ke.argA,ke.argB);xe&&Gt(n.errors,K,Oe),rce(n.errors,K)}if((u.touchedFields||d.touchedFields)&&ve&&Array.isArray(Ee(n.touchedFields,K))){const Oe=ce(Ee(n.touchedFields,K),ke.argA,ke.argB);xe&&Gt(n.touchedFields,K,Oe)}(u.dirtyFields||d.dirtyFields)&&(n.dirtyFields=Vp(r,i)),h.state.next({name:K,isDirty:P(K,re),dirtyFields:n.dirtyFields,errors:n.errors,isValid:n.isValid})}else Gt(i,K,re)},x=(K,re)=>{Gt(n.errors,K,re),h.state.next({errors:n.errors})},v=K=>{n.errors=K,h.state.next({errors:n.errors,isValid:!1})},b=(K,re,ce,ke)=>{const xe=Ee(s,K);if(xe){const ve=Ee(i,K,Xn(ce)?Ee(r,K):ce);Xn(ve)||ke&&ke.defaultChecked||re?Gt(i,K,re?ve:NL(xe._f)):z(K,ve),o.mount&&m()}},k=(K,re,ce,ke,xe)=>{let ve=!1,Oe=!1;const ut={name:K};if(!e.disabled){if(!ce||ke){(u.isDirty||d.isDirty)&&(Oe=n.isDirty,n.isDirty=ut.isDirty=P(),ve=Oe!==ut.isDirty);const St=Qa(Ee(r,K),re);Oe=!!Ee(n.dirtyFields,K),St?is(n.dirtyFields,K):Gt(n.dirtyFields,K,!0),ut.dirtyFields=n.dirtyFields,ve=ve||(u.dirtyFields||d.dirtyFields)&&Oe!==!St}if(ce){const St=Ee(n.touchedFields,K);St||(Gt(n.touchedFields,K,ce),ut.touchedFields=n.touchedFields,ve=ve||(u.touchedFields||d.touchedFields)&&St!==ce)}ve&&xe&&h.state.next(ut)}return ve?ut:{}},C=(K,re,ce,ke)=>{const xe=Ee(n.errors,K),ve=(u.isValid||d.isValid)&&di(re)&&n.isValid!==re;if(e.delayError&&ce?(l=p(()=>x(K,ce)),l(e.delayError)):(clearTimeout(c),l=null,ce?Gt(n.errors,K,ce):is(n.errors,K)),(ce?!Qa(xe,ce):xe)||!Mr(ke)||ve){const Oe={...ke,...ve&&di(re)?{isValid:re}:{},errors:n.errors,name:K};n={...n,...Oe},h.state.next(Oe)}},N=async K=>{g(K,!0);const re=await e.resolver(i,e.context,Qle(K||a.mount,s,e.criteriaMode,e.shouldUseNativeValidation));return g(K),re},I=async K=>{const{errors:re}=await N(K);if(K)for(const ce of K){const ke=Ee(re,ce);ke?Gt(n.errors,ce,ke):is(n.errors,ce)}else n.errors=re;return re},$=async(K,re,ce={valid:!0})=>{for(const ke in K){const xe=K[ke];if(xe){const{_f:ve,...Oe}=xe;if(ve){const ut=a.array.has(ve.name),St=xe._f&&Jle(xe._f);St&&u.validatingFields&&g([ke],!0);const hn=await RL(xe,a.disabled,i,f,e.shouldUseNativeValidation&&!re,ut);if(St&&u.validatingFields&&g([ke]),hn[ve.name]&&(ce.valid=!1,re))break;!re&&(Ee(hn,ve.name)?ut?ice(n.errors,hn,ve.name):Gt(n.errors,ve.name,hn[ve.name]):is(n.errors,ve.name))}!Mr(Oe)&&await $(Oe,re,ce)}}return ce.valid},A=()=>{for(const K of a.unMount){const re=Ee(s,K);re&&(re._f.refs?re._f.refs.every(ce=>!kC(ce)):!kC(re._f.ref))&&Ce(K)}a.unMount=new Set},P=(K,re)=>!e.disabled&&(K&&re&&Gt(i,K,re),!Qa(ne(),r)),F=(K,re,ce)=>j5(K,a,{...o.mount?i:Xn(re)?r:ua(K)?{[K]:re}:re},ce,re),V=K=>DE(Ee(o.mount?i:r,K,e.shouldUnregister?Ee(r,K,[]):[])),z=(K,re,ce={})=>{const ke=Ee(s,K);let xe=re;if(ke){const ve=ke._f;ve&&(!ve.disabled&&Gt(i,K,K5(re,ve)),xe=Tb(ve.ref)&&xr(re)?"":re,W5(ve.ref)?[...ve.ref.options].forEach(Oe=>Oe.selected=xe.includes(Oe.value)):ve.refs?dy(ve.ref)?ve.refs.forEach(Oe=>{(!Oe.defaultChecked||!Oe.disabled)&&(Array.isArray(xe)?Oe.checked=!!xe.find(ut=>ut===Oe.value):Oe.checked=xe===Oe.value||!!xe)}):ve.refs.forEach(Oe=>Oe.checked=Oe.value===xe):LE(ve.ref)?ve.ref.value="":(ve.ref.value=xe,ve.ref.type||h.state.next({name:K,values:gs(i)})))}(ce.shouldDirty||ce.shouldTouch)&&k(K,xe,ce.shouldTouch,ce.shouldDirty,!0),ce.shouldValidate&&G(K)},B=(K,re,ce)=>{for(const ke in re){if(!re.hasOwnProperty(ke))return;const xe=re[ke],ve=K+"."+ke,Oe=Ee(s,ve);(a.array.has(K)||ss(xe)||Oe&&!Oe._f)&&!Pu(xe)?B(ve,xe,ce):z(ve,xe,ce)}},W=(K,re,ce={})=>{const ke=Ee(s,K),xe=a.array.has(K),ve=gs(re);Gt(i,K,ve),xe?(h.array.next({name:K,values:gs(i)}),(u.isDirty||u.dirtyFields||d.isDirty||d.dirtyFields)&&ce.shouldDirty&&h.state.next({name:K,dirtyFields:Vp(r,i),isDirty:P(K,ve)})):ke&&!ke._f&&!xr(ve)?B(K,ve,ce):z(K,ve,ce),EL(K,a)&&h.state.next({...n,name:K}),h.state.next({name:o.mount?K:void 0,values:gs(i)})},q=async K=>{o.mount=!0;const re=K.target;let ce=re.name,ke=!0;const xe=Ee(s,ce),ve=St=>{ke=Number.isNaN(St)||Pu(St)&&isNaN(St.getTime())||Qa(St,Ee(i,ce,St))},Oe=IL(e.mode),ut=IL(e.reValidateMode);if(xe){let St,hn;const ri=re.type?NL(xe._f):M5(K),_s=K.type===Cb.BLUR||K.type===Cb.FOCUS_OUT,Tl=!ece(xe._f)&&!e.resolver&&!Ee(n.errors,ce)&&!xe._f.deps||sce(_s,Ee(n.touchedFields,ce),n.isSubmitted,ut,Oe),ms=EL(ce,a,_s);Gt(i,ce,ri),_s?(!re||!re.readOnly)&&(xe._f.onBlur&&xe._f.onBlur(K),l&&l(0)):xe._f.onChange&&xe._f.onChange(K);const Ai=k(ce,ri,_s),Nl=!Mr(Ai)||ms;if(!_s&&h.state.next({name:ce,type:K.type,values:gs(i)}),Tl)return(u.isValid||d.isValid)&&(e.mode==="onBlur"?_s&&m():_s||m()),Nl&&h.state.next({name:ce,...ms?{}:Ai});if(!_s&&ms&&h.state.next({...n}),e.resolver){const{errors:uu}=await N([ce]);if(ve(ri),ke){const du=$L(n.errors,s,ce),Ho=$L(uu,s,du.name||ce);St=Ho.error,ce=Ho.name,hn=Mr(uu)}}else g([ce],!0),St=(await RL(xe,a.disabled,i,f,e.shouldUseNativeValidation))[ce],g([ce]),ve(ri),ke&&(St?hn=!1:(u.isValid||d.isValid)&&(hn=await $(s,!0)));ke&&(xe._f.deps&&G(xe._f.deps),C(ce,hn,St,Ai))}},M=(K,re)=>{if(Ee(n.errors,re)&&K.focus)return K.focus(),1},G=async(K,re={})=>{let ce,ke;const xe=zm(K);if(e.resolver){const ve=await I(Xn(K)?K:xe);ce=Mr(ve),ke=K?!xe.some(Oe=>Ee(ve,Oe)):ce}else K?(ke=(await Promise.all(xe.map(async ve=>{const Oe=Ee(s,ve);return await $(Oe&&Oe._f?{[ve]:Oe}:Oe)}))).every(Boolean),!(!ke&&!n.isValid)&&m()):ke=ce=await $(s);return h.state.next({...!ua(K)||(u.isValid||d.isValid)&&ce!==n.isValid?{}:{name:K},...e.resolver||!K?{isValid:ce}:{},errors:n.errors}),re.shouldFocus&&!ke&&Vm(s,M,K?xe:a.mount),ke},ne=K=>{const re={...o.mount?i:r};return Xn(K)?re:ua(K)?Ee(re,K):K.map(ce=>Ee(re,ce))},ie=(K,re)=>({invalid:!!Ee((re||n).errors,K),isDirty:!!Ee((re||n).dirtyFields,K),error:Ee((re||n).errors,K),isValidating:!!Ee(n.validatingFields,K),isTouched:!!Ee((re||n).touchedFields,K)}),de=K=>{K&&zm(K).forEach(re=>is(n.errors,re)),h.state.next({errors:K?n.errors:{}})},he=(K,re,ce)=>{const ke=(Ee(s,K,{_f:{}})._f||{}).ref,xe=Ee(n.errors,K)||{},{ref:ve,message:Oe,type:ut,...St}=xe;Gt(n.errors,K,{...St,...re,ref:ke}),h.state.next({name:K,errors:n.errors,isValid:!1}),ce&&ce.shouldFocus&&ke&&ke.focus&&ke.focus()},pe=(K,re)=>Eo(K)?h.state.subscribe({next:ce=>"values"in ce&&K(F(void 0,re),ce)}):F(K,re,!0),me=K=>h.state.subscribe({next:re=>{nce(K.name,re.name,K.exact)&&tce(re,K.formState||u,At,K.reRenderRoot)&&K.callback({values:{...i},...n,...re,defaultValues:r})}}).unsubscribe,ye=K=>(o.mount=!0,d={...d,...K.formState},me({...K,formState:d})),Ce=(K,re={})=>{for(const ce of K?zm(K):a.mount)a.mount.delete(ce),a.array.delete(ce),re.keepValue||(is(s,ce),is(i,ce)),!re.keepError&&is(n.errors,ce),!re.keepDirty&&is(n.dirtyFields,ce),!re.keepTouched&&is(n.touchedFields,ce),!re.keepIsValidating&&is(n.validatingFields,ce),!e.shouldUnregister&&!re.keepDefaultValue&&is(r,ce);h.state.next({values:gs(i)}),h.state.next({...n,...re.keepDirty?{isDirty:P()}:{}}),!re.keepIsValid&&m()},Le=({disabled:K,name:re})=>{(di(K)&&o.mount||K||a.disabled.has(re))&&(K?a.disabled.add(re):a.disabled.delete(re))},Re=(K,re={})=>{let ce=Ee(s,K);const ke=di(re.disabled)||di(e.disabled);return Gt(s,K,{...ce||{},_f:{...ce&&ce._f?ce._f:{ref:{name:K}},name:K,mount:!0,...re}}),a.mount.add(K),ce?Le({disabled:di(re.disabled)?re.disabled:e.disabled,name:K}):b(K,!0,re.value),{...ke?{disabled:re.disabled||e.disabled}:{},...e.progressive?{required:!!re.required,min:jp(re.min),max:jp(re.max),minLength:jp(re.minLength),maxLength:jp(re.maxLength),pattern:jp(re.pattern)}:{},name:K,onChange:q,onBlur:q,ref:xe=>{if(xe){Re(K,re),ce=Ee(s,K);const ve=Xn(xe.value)&&xe.querySelectorAll&&xe.querySelectorAll("input,select,textarea")[0]||xe,Oe=Xle(ve),ut=ce._f.refs||[];if(Oe?ut.find(St=>St===ve):ve===ce._f.ref)return;Gt(s,K,{_f:{...ce._f,...Oe?{refs:[...ut.filter(kC),ve,...Array.isArray(Ee(r,K))?[{}]:[]],ref:{type:ve.type,name:K}}:{ref:ve}}}),b(K,!1,void 0,ve)}else ce=Ee(s,K,{}),ce._f&&(ce._f.mount=!1),(e.shouldUnregister||re.shouldUnregister)&&!(z5(a.array,K)&&o.action)&&a.unMount.add(K)}}},Ze=()=>e.shouldFocusError&&Vm(s,M,a.mount),tt=K=>{di(K)&&(h.state.next({disabled:K}),Vm(s,(re,ce)=>{const ke=Ee(s,ce);ke&&(re.disabled=ke._f.disabled||K,Array.isArray(ke._f.refs)&&ke._f.refs.forEach(xe=>{xe.disabled=ke._f.disabled||K}))},0,!1))},mt=(K,re)=>async ce=>{let ke;ce&&(ce.preventDefault&&ce.preventDefault(),ce.persist&&ce.persist());let xe=gs(i);if(h.state.next({isSubmitting:!0}),e.resolver){const{errors:ve,values:Oe}=await N();n.errors=ve,xe=gs(Oe)}else await $(s);if(a.disabled.size)for(const ve of a.disabled)is(xe,ve);if(is(n.errors,"root"),Mr(n.errors)){h.state.next({errors:{}});try{await K(xe,ce)}catch(ve){ke=ve}}else re&&await re({...n.errors},ce),Ze(),setTimeout(Ze);if(h.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:Mr(n.errors)&&!ke,submitCount:n.submitCount+1,errors:n.errors}),ke)throw ke},Xe=(K,re={})=>{Ee(s,K)&&(Xn(re.defaultValue)?W(K,gs(Ee(r,K))):(W(K,re.defaultValue),Gt(r,K,gs(re.defaultValue))),re.keepTouched||is(n.touchedFields,K),re.keepDirty||(is(n.dirtyFields,K),n.isDirty=re.defaultValue?P(K,gs(Ee(r,K))):P()),re.keepError||(is(n.errors,K),u.isValid&&m()),h.state.next({...n}))},Me=(K,re={})=>{const ce=K?gs(K):r,ke=gs(ce),xe=Mr(K),ve=xe?r:ke;if(re.keepDefaultValues||(r=ce),!re.keepValues){if(re.keepDirtyValues){const Oe=new Set([...a.mount,...Object.keys(Vp(r,i))]);for(const ut of Array.from(Oe))Ee(n.dirtyFields,ut)?Gt(ve,ut,Ee(i,ut)):W(ut,Ee(ve,ut))}else{if(RE&&Xn(K))for(const Oe of a.mount){const ut=Ee(s,Oe);if(ut&&ut._f){const St=Array.isArray(ut._f.refs)?ut._f.refs[0]:ut._f.ref;if(Tb(St)){const hn=St.closest("form");if(hn){hn.reset();break}}}}if(re.keepFieldsRef)for(const Oe of a.mount)W(Oe,Ee(ve,Oe));else s={}}i=e.shouldUnregister?re.keepDefaultValues?gs(r):{}:gs(ve),h.array.next({values:{...ve}}),h.state.next({values:{...ve}})}a={mount:re.keepDirtyValues?a.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},o.mount=!u.isValid||!!re.keepIsValid||!!re.keepDirtyValues,o.watch=!!e.shouldUnregister,h.state.next({submitCount:re.keepSubmitCount?n.submitCount:0,isDirty:xe?!1:re.keepDirty?n.isDirty:!!(re.keepDefaultValues&&!Qa(K,r)),isSubmitted:re.keepIsSubmitted?n.isSubmitted:!1,dirtyFields:xe?{}:re.keepDirtyValues?re.keepDefaultValues&&i?Vp(r,i):n.dirtyFields:re.keepDefaultValues&&K?Vp(r,K):re.keepDirty?n.dirtyFields:{},touchedFields:re.keepTouched?n.touchedFields:{},errors:re.keepErrors?n.errors:{},isSubmitSuccessful:re.keepIsSubmitSuccessful?n.isSubmitSuccessful:!1,isSubmitting:!1,defaultValues:r})},wt=(K,re)=>Me(Eo(K)?K(i):K,re),it=(K,re={})=>{const ce=Ee(s,K),ke=ce&&ce._f;if(ke){const xe=ke.refs?ke.refs[0]:ke.ref;xe.focus&&(xe.focus(),re.shouldSelect&&Eo(xe.select)&&xe.select())}},At=K=>{n={...n,...K}},_n={control:{register:Re,unregister:Ce,getFieldState:ie,handleSubmit:mt,setError:he,_subscribe:me,_runSchema:N,_focusError:Ze,_getWatch:F,_getDirty:P,_setValid:m,_setFieldArray:y,_setDisabledField:Le,_setErrors:v,_getFieldArray:V,_reset:Me,_resetDefaultValues:()=>Eo(e.defaultValues)&&e.defaultValues().then(K=>{wt(K,e.resetOptions),h.state.next({isLoading:!1})}),_removeUnmounted:A,_disableForm:tt,_subjects:h,_proxyFormState:u,get _fields(){return s},get _formValues(){return i},get _state(){return o},set _state(K){o=K},get _defaultValues(){return r},get _names(){return a},set _names(K){a=K},get _formState(){return n},get _options(){return e},set _options(K){e={...e,...K}}},subscribe:ye,trigger:G,register:Re,handleSubmit:mt,watch:pe,setValue:W,getValues:ne,reset:wt,resetField:Xe,clearErrors:de,unregister:Ce,setError:he,setFocus:it,getFieldState:ie};return{..._n,formControl:_n}}function lce(t={}){const e=et.useRef(void 0),n=et.useRef(void 0),[s,r]=et.useState({isDirty:!1,isValidating:!1,isLoading:Eo(t.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:t.errors||{},disabled:t.disabled||!1,isReady:!1,defaultValues:Eo(t.defaultValues)?void 0:t.defaultValues});if(!e.current)if(t.formControl)e.current={...t.formControl,formState:s},t.defaultValues&&!Eo(t.defaultValues)&&t.formControl.reset(t.defaultValues,t.resetOptions);else{const{formControl:o,...a}=ace(t);e.current={...a,formState:s}}const i=e.current.control;return i._options=t,FE(()=>{const o=i._subscribe({formState:i._proxyFormState,callback:()=>r({...i._formState}),reRenderRoot:!0});return r(a=>({...a,isReady:!0})),i._formState.isReady=!0,o},[i]),et.useEffect(()=>i._disableForm(t.disabled),[i,t.disabled]),et.useEffect(()=>{t.mode&&(i._options.mode=t.mode),t.reValidateMode&&(i._options.reValidateMode=t.reValidateMode)},[i,t.mode,t.reValidateMode]),et.useEffect(()=>{t.errors&&(i._setErrors(t.errors),i._focusError())},[i,t.errors]),et.useEffect(()=>{t.shouldUnregister&&i._subjects.state.next({values:i._getWatch()})},[i,t.shouldUnregister]),et.useEffect(()=>{if(i._proxyFormState.isDirty){const o=i._getDirty();o!==s.isDirty&&i._subjects.state.next({isDirty:o})}},[i,s.isDirty]),et.useEffect(()=>{t.values&&!Qa(t.values,n.current)?(i._reset(t.values,{keepFieldsRef:!0,...i._options.resetOptions}),n.current=t.values,r(o=>({...o}))):i._resetDefaultValues()},[i,t.values]),et.useEffect(()=>{i._state.mount||(i._setValid(),i._state.mount=!0),i._state.watch&&(i._state.watch=!1,i._subjects.state.next({...i._formState})),i._removeUnmounted()}),e.current.formState=V5(s,i),e.current}const DL=(t,e,n)=>{if(t&&"reportValidity"in t){const s=Ee(n,e);t.setCustomValidity(s&&s.message||""),t.reportValidity()}},X5=(t,e)=>{for(const n in e.fields){const s=e.fields[n];s&&s.ref&&"reportValidity"in s.ref?DL(s.ref,n,t):s.refs&&s.refs.forEach(r=>DL(r,n,t))}},cce=(t,e)=>{e.shouldUseNativeValidation&&X5(t,e);const n={};for(const s in t){const r=Ee(e.fields,s),i=Object.assign(t[s]||{},{ref:r&&r.ref});if(uce(e.names||Object.keys(t),s)){const o=Object.assign({},Ee(n,s));Gt(o,"root",i),Gt(n,s,o)}else Gt(n,s,i)}return n},uce=(t,e)=>t.some(n=>n.startsWith(e+"."));var dce=function(t,e){for(var n={};t.length;){var s=t[0],r=s.code,i=s.message,o=s.path.join(".");if(!n[o])if("unionErrors"in s){var a=s.unionErrors[0].errors[0];n[o]={message:a.message,type:a.code}}else n[o]={message:i,type:r};if("unionErrors"in s&&s.unionErrors.forEach(function(u){return u.errors.forEach(function(d){return t.push(d)})}),e){var l=n[o].types,c=l&&l[s.code];n[o]=B5(o,e,n,r,c?[].concat(c,s.message):s.message)}t.shift()}return n},hce=function(t,e,n){return n===void 0&&(n={}),function(s,r,i){try{return Promise.resolve(function(o,a){try{var l=Promise.resolve(t[n.mode==="sync"?"parse":"parseAsync"](s,e)).then(function(c){return i.shouldUseNativeValidation&&X5({},i),{errors:{},values:n.raw?s:c}})}catch(c){return a(c)}return l&&l.then?l.then(void 0,a):l}(0,function(o){if(function(a){return Array.isArray(a==null?void 0:a.errors)}(o))return{values:{},errors:cce(dce(o.errors,!i.shouldUseNativeValidation&&i.criteriaMode==="all"),i)};throw o}))}catch(o){return Promise.reject(o)}}},zt;(function(t){t.assertEqual=r=>{};function e(r){}t.assertIs=e;function n(r){throw new Error}t.assertNever=n,t.arrayToEnum=r=>{const i={};for(const o of r)i[o]=o;return i},t.getValidEnumValues=r=>{const i=t.objectKeys(r).filter(a=>typeof r[r[a]]!="number"),o={};for(const a of i)o[a]=r[a];return t.objectValues(o)},t.objectValues=r=>t.objectKeys(r).map(function(i){return r[i]}),t.objectKeys=typeof Object.keys=="function"?r=>Object.keys(r):r=>{const i=[];for(const o in r)Object.prototype.hasOwnProperty.call(r,o)&&i.push(o);return i},t.find=(r,i)=>{for(const o of r)if(i(o))return o},t.isInteger=typeof Number.isInteger=="function"?r=>Number.isInteger(r):r=>typeof r=="number"&&Number.isFinite(r)&&Math.floor(r)===r;function s(r,i=" | "){return r.map(o=>typeof o=="string"?`'${o}'`:o).join(i)}t.joinValues=s,t.jsonStringifyReplacer=(r,i)=>typeof i=="bigint"?i.toString():i})(zt||(zt={}));var OL;(function(t){t.mergeShapes=(e,n)=>({...e,...n})})(OL||(OL={}));const He=zt.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),zl=t=>{switch(typeof t){case"undefined":return He.undefined;case"string":return He.string;case"number":return Number.isNaN(t)?He.nan:He.number;case"boolean":return He.boolean;case"function":return He.function;case"bigint":return He.bigint;case"symbol":return He.symbol;case"object":return Array.isArray(t)?He.array:t===null?He.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?He.promise:typeof Map<"u"&&t instanceof Map?He.map:typeof Set<"u"&&t instanceof Set?He.set:typeof Date<"u"&&t instanceof Date?He.date:He.object;default:return He.unknown}},Se=zt.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class gl extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=s=>{this.issues=[...this.issues,s]},this.addIssues=(s=[])=>{this.issues=[...this.issues,...s]};const n=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,n):this.__proto__=n,this.name="ZodError",this.issues=e}format(e){const n=e||function(i){return i.message},s={_errors:[]},r=i=>{for(const o of i.issues)if(o.code==="invalid_union")o.unionErrors.map(r);else if(o.code==="invalid_return_type")r(o.returnTypeError);else if(o.code==="invalid_arguments")r(o.argumentsError);else if(o.path.length===0)s._errors.push(n(o));else{let a=s,l=0;for(;l<o.path.length;){const c=o.path[l];l===o.path.length-1?(a[c]=a[c]||{_errors:[]},a[c]._errors.push(n(o))):a[c]=a[c]||{_errors:[]},a=a[c],l++}}};return r(this),s}static assert(e){if(!(e instanceof gl))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,zt.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=n=>n.message){const n={},s=[];for(const r of this.issues)if(r.path.length>0){const i=r.path[0];n[i]=n[i]||[],n[i].push(e(r))}else s.push(e(r));return{formErrors:s,fieldErrors:n}}get formErrors(){return this.flatten()}}gl.create=t=>new gl(t);const fce=(t,e)=>{let n;switch(t.code){case Se.invalid_type:t.received===He.undefined?n="Required":n=`Expected ${t.expected}, received ${t.received}`;break;case Se.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(t.expected,zt.jsonStringifyReplacer)}`;break;case Se.unrecognized_keys:n=`Unrecognized key(s) in object: ${zt.joinValues(t.keys,", ")}`;break;case Se.invalid_union:n="Invalid input";break;case Se.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${zt.joinValues(t.options)}`;break;case Se.invalid_enum_value:n=`Invalid enum value. Expected ${zt.joinValues(t.options)}, received '${t.received}'`;break;case Se.invalid_arguments:n="Invalid function arguments";break;case Se.invalid_return_type:n="Invalid function return type";break;case Se.invalid_date:n="Invalid date";break;case Se.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(n=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(n=`${n} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?n=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?n=`Invalid input: must end with "${t.validation.endsWith}"`:zt.assertNever(t.validation):t.validation!=="regex"?n=`Invalid ${t.validation}`:n="Invalid";break;case Se.too_small:t.type==="array"?n=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?n=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?n=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="bigint"?n=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?n=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:n="Invalid input";break;case Se.too_big:t.type==="array"?n=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?n=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?n=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?n=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?n=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:n="Invalid input";break;case Se.custom:n="Invalid input";break;case Se.invalid_intersection_types:n="Intersection results could not be merged";break;case Se.not_multiple_of:n=`Number must be a multiple of ${t.multipleOf}`;break;case Se.not_finite:n="Number must be finite";break;default:n=e.defaultError,zt.assertNever(t)}return{message:n}},YN=fce;let pce=YN;function mce(){return pce}const gce=t=>{const{data:e,path:n,errorMaps:s,issueData:r}=t,i=[...n,...r.path||[]],o={...r,path:i};if(r.message!==void 0)return{...r,path:i,message:r.message};let a="";const l=s.filter(c=>!!c).slice().reverse();for(const c of l)a=c(o,{data:e,defaultError:a}).message;return{...r,path:i,message:a}};function Fe(t,e){const n=mce(),s=gce({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,n,n===YN?void 0:YN].filter(r=>!!r)});t.common.issues.push(s)}class Ci{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,n){const s=[];for(const r of n){if(r.status==="aborted")return dt;r.status==="dirty"&&e.dirty(),s.push(r.value)}return{status:e.value,value:s}}static async mergeObjectAsync(e,n){const s=[];for(const r of n){const i=await r.key,o=await r.value;s.push({key:i,value:o})}return Ci.mergeObjectSync(e,s)}static mergeObjectSync(e,n){const s={};for(const r of n){const{key:i,value:o}=r;if(i.status==="aborted"||o.status==="aborted")return dt;i.status==="dirty"&&e.dirty(),o.status==="dirty"&&e.dirty(),i.value!=="__proto__"&&(typeof o.value<"u"||r.alwaysSet)&&(s[i.value]=o.value)}return{status:e.value,value:s}}}const dt=Object.freeze({status:"aborted"}),om=t=>({status:"dirty",value:t}),co=t=>({status:"valid",value:t}),PL=t=>t.status==="aborted",FL=t=>t.status==="dirty",Sf=t=>t.status==="valid",_b=t=>typeof Promise<"u"&&t instanceof Promise;var qe;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(qe||(qe={}));class Pc{constructor(e,n,s,r){this._cachedPath=[],this.parent=e,this.data=n,this._path=s,this._key=r}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const LL=(t,e)=>{if(Sf(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const n=new gl(t.common.issues);return this._error=n,this._error}}};function Tt(t){if(!t)return{};const{errorMap:e,invalid_type_error:n,required_error:s,description:r}=t;if(e&&(n||s))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:r}:{errorMap:(o,a)=>{const{message:l}=t;return o.code==="invalid_enum_value"?{message:l??a.defaultError}:typeof a.data>"u"?{message:l??s??a.defaultError}:o.code!=="invalid_type"?{message:a.defaultError}:{message:l??n??a.defaultError}},description:r}}class Lt{get description(){return this._def.description}_getType(e){return zl(e.data)}_getOrReturnCtx(e,n){return n||{common:e.parent.common,data:e.data,parsedType:zl(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Ci,ctx:{common:e.parent.common,data:e.data,parsedType:zl(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const n=this._parse(e);if(_b(n))throw new Error("Synchronous parse encountered promise.");return n}_parseAsync(e){const n=this._parse(e);return Promise.resolve(n)}parse(e,n){const s=this.safeParse(e,n);if(s.success)return s.data;throw s.error}safeParse(e,n){const s={common:{issues:[],async:(n==null?void 0:n.async)??!1,contextualErrorMap:n==null?void 0:n.errorMap},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:zl(e)},r=this._parseSync({data:e,path:s.path,parent:s});return LL(s,r)}"~validate"(e){var s,r;const n={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:zl(e)};if(!this["~standard"].async)try{const i=this._parseSync({data:e,path:[],parent:n});return Sf(i)?{value:i.value}:{issues:n.common.issues}}catch(i){(r=(s=i==null?void 0:i.message)==null?void 0:s.toLowerCase())!=null&&r.includes("encountered")&&(this["~standard"].async=!0),n.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:n}).then(i=>Sf(i)?{value:i.value}:{issues:n.common.issues})}async parseAsync(e,n){const s=await this.safeParseAsync(e,n);if(s.success)return s.data;throw s.error}async safeParseAsync(e,n){const s={common:{issues:[],contextualErrorMap:n==null?void 0:n.errorMap,async:!0},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:zl(e)},r=this._parse({data:e,path:s.path,parent:s}),i=await(_b(r)?r:Promise.resolve(r));return LL(s,i)}refine(e,n){const s=r=>typeof n=="string"||typeof n>"u"?{message:n}:typeof n=="function"?n(r):n;return this._refinement((r,i)=>{const o=e(r),a=()=>i.addIssue({code:Se.custom,...s(r)});return typeof Promise<"u"&&o instanceof Promise?o.then(l=>l?!0:(a(),!1)):o?!0:(a(),!1)})}refinement(e,n){return this._refinement((s,r)=>e(s)?!0:(r.addIssue(typeof n=="function"?n(s,r):n),!1))}_refinement(e){return new Cf({schema:this,typeName:ht.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:n=>this["~validate"](n)}}optional(){return xc.create(this,this._def)}nullable(){return Tf.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return va.create(this)}promise(){return Rb.create(this,this._def)}or(e){return $b.create([this,e],this._def)}and(e){return Ab.create(this,e,this._def)}transform(e){return new Cf({...Tt(this._def),schema:this,typeName:ht.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const n=typeof e=="function"?e:()=>e;return new QN({...Tt(this._def),innerType:this,defaultValue:n,typeName:ht.ZodDefault})}brand(){return new zce({typeName:ht.ZodBranded,type:this,...Tt(this._def)})}catch(e){const n=typeof e=="function"?e:()=>e;return new JN({...Tt(this._def),innerType:this,catchValue:n,typeName:ht.ZodCatch})}describe(e){const n=this.constructor;return new n({...this._def,description:e})}pipe(e){return zE.create(this,e)}readonly(){return e2.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const yce=/^c[^\s-]{8,}$/i,xce=/^[0-9a-z]+$/,vce=/^[0-9A-HJKMNP-TV-Z]{26}$/i,bce=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,wce=/^[a-z0-9_-]{21}$/i,Sce=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,kce=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,Cce=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,Tce="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let CC;const Nce=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,Ice=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,_ce=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,Ece=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,$ce=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,Ace=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,Y5="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",Rce=new RegExp(`^${Y5}$`);function Z5(t){let e="[0-5]\\d";t.precision?e=`${e}\\.\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\.\\d+)?`);const n=t.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${e})${n}`}function Dce(t){return new RegExp(`^${Z5(t)}$`)}function Oce(t){let e=`${Y5}T${Z5(t)}`;const n=[];return n.push(t.local?"Z?":"Z"),t.offset&&n.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${n.join("|")})`,new RegExp(`^${e}$`)}function Pce(t,e){return!!((e==="v4"||!e)&&Nce.test(t)||(e==="v6"||!e)&&_ce.test(t))}function Fce(t,e){if(!Sce.test(t))return!1;try{const[n]=t.split(".");if(!n)return!1;const s=n.replace(/-/g,"+").replace(/_/g,"/").padEnd(n.length+(4-n.length%4)%4,"="),r=JSON.parse(atob(s));return!(typeof r!="object"||r===null||"typ"in r&&(r==null?void 0:r.typ)!=="JWT"||!r.alg||e&&r.alg!==e)}catch{return!1}}function Lce(t,e){return!!((e==="v4"||!e)&&Ice.test(t)||(e==="v6"||!e)&&Ece.test(t))}class tc extends Lt{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==He.string){const i=this._getOrReturnCtx(e);return Fe(i,{code:Se.invalid_type,expected:He.string,received:i.parsedType}),dt}const s=new Ci;let r;for(const i of this._def.checks)if(i.kind==="min")e.data.length<i.value&&(r=this._getOrReturnCtx(e,r),Fe(r,{code:Se.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),s.dirty());else if(i.kind==="max")e.data.length>i.value&&(r=this._getOrReturnCtx(e,r),Fe(r,{code:Se.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),s.dirty());else if(i.kind==="length"){const o=e.data.length>i.value,a=e.data.length<i.value;(o||a)&&(r=this._getOrReturnCtx(e,r),o?Fe(r,{code:Se.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):a&&Fe(r,{code:Se.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),s.dirty())}else if(i.kind==="email")Cce.test(e.data)||(r=this._getOrReturnCtx(e,r),Fe(r,{validation:"email",code:Se.invalid_string,message:i.message}),s.dirty());else if(i.kind==="emoji")CC||(CC=new RegExp(Tce,"u")),CC.test(e.data)||(r=this._getOrReturnCtx(e,r),Fe(r,{validation:"emoji",code:Se.invalid_string,message:i.message}),s.dirty());else if(i.kind==="uuid")bce.test(e.data)||(r=this._getOrReturnCtx(e,r),Fe(r,{validation:"uuid",code:Se.invalid_string,message:i.message}),s.dirty());else if(i.kind==="nanoid")wce.test(e.data)||(r=this._getOrReturnCtx(e,r),Fe(r,{validation:"nanoid",code:Se.invalid_string,message:i.message}),s.dirty());else if(i.kind==="cuid")yce.test(e.data)||(r=this._getOrReturnCtx(e,r),Fe(r,{validation:"cuid",code:Se.invalid_string,message:i.message}),s.dirty());else if(i.kind==="cuid2")xce.test(e.data)||(r=this._getOrReturnCtx(e,r),Fe(r,{validation:"cuid2",code:Se.invalid_string,message:i.message}),s.dirty());else if(i.kind==="ulid")vce.test(e.data)||(r=this._getOrReturnCtx(e,r),Fe(r,{validation:"ulid",code:Se.invalid_string,message:i.message}),s.dirty());else if(i.kind==="url")try{new URL(e.data)}catch{r=this._getOrReturnCtx(e,r),Fe(r,{validation:"url",code:Se.invalid_string,message:i.message}),s.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(e.data)||(r=this._getOrReturnCtx(e,r),Fe(r,{validation:"regex",code:Se.invalid_string,message:i.message}),s.dirty())):i.kind==="trim"?e.data=e.data.trim():i.kind==="includes"?e.data.includes(i.value,i.position)||(r=this._getOrReturnCtx(e,r),Fe(r,{code:Se.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),s.dirty()):i.kind==="toLowerCase"?e.data=e.data.toLowerCase():i.kind==="toUpperCase"?e.data=e.data.toUpperCase():i.kind==="startsWith"?e.data.startsWith(i.value)||(r=this._getOrReturnCtx(e,r),Fe(r,{code:Se.invalid_string,validation:{startsWith:i.value},message:i.message}),s.dirty()):i.kind==="endsWith"?e.data.endsWith(i.value)||(r=this._getOrReturnCtx(e,r),Fe(r,{code:Se.invalid_string,validation:{endsWith:i.value},message:i.message}),s.dirty()):i.kind==="datetime"?Oce(i).test(e.data)||(r=this._getOrReturnCtx(e,r),Fe(r,{code:Se.invalid_string,validation:"datetime",message:i.message}),s.dirty()):i.kind==="date"?Rce.test(e.data)||(r=this._getOrReturnCtx(e,r),Fe(r,{code:Se.invalid_string,validation:"date",message:i.message}),s.dirty()):i.kind==="time"?Dce(i).test(e.data)||(r=this._getOrReturnCtx(e,r),Fe(r,{code:Se.invalid_string,validation:"time",message:i.message}),s.dirty()):i.kind==="duration"?kce.test(e.data)||(r=this._getOrReturnCtx(e,r),Fe(r,{validation:"duration",code:Se.invalid_string,message:i.message}),s.dirty()):i.kind==="ip"?Pce(e.data,i.version)||(r=this._getOrReturnCtx(e,r),Fe(r,{validation:"ip",code:Se.invalid_string,message:i.message}),s.dirty()):i.kind==="jwt"?Fce(e.data,i.alg)||(r=this._getOrReturnCtx(e,r),Fe(r,{validation:"jwt",code:Se.invalid_string,message:i.message}),s.dirty()):i.kind==="cidr"?Lce(e.data,i.version)||(r=this._getOrReturnCtx(e,r),Fe(r,{validation:"cidr",code:Se.invalid_string,message:i.message}),s.dirty()):i.kind==="base64"?$ce.test(e.data)||(r=this._getOrReturnCtx(e,r),Fe(r,{validation:"base64",code:Se.invalid_string,message:i.message}),s.dirty()):i.kind==="base64url"?Ace.test(e.data)||(r=this._getOrReturnCtx(e,r),Fe(r,{validation:"base64url",code:Se.invalid_string,message:i.message}),s.dirty()):zt.assertNever(i);return{status:s.value,value:e.data}}_regex(e,n,s){return this.refinement(r=>e.test(r),{validation:n,code:Se.invalid_string,...qe.errToObj(s)})}_addCheck(e){return new tc({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...qe.errToObj(e)})}url(e){return this._addCheck({kind:"url",...qe.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...qe.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...qe.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...qe.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...qe.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...qe.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...qe.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...qe.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...qe.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...qe.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...qe.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...qe.errToObj(e)})}datetime(e){return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,offset:(e==null?void 0:e.offset)??!1,local:(e==null?void 0:e.local)??!1,...qe.errToObj(e==null?void 0:e.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,...qe.errToObj(e==null?void 0:e.message)})}duration(e){return this._addCheck({kind:"duration",...qe.errToObj(e)})}regex(e,n){return this._addCheck({kind:"regex",regex:e,...qe.errToObj(n)})}includes(e,n){return this._addCheck({kind:"includes",value:e,position:n==null?void 0:n.position,...qe.errToObj(n==null?void 0:n.message)})}startsWith(e,n){return this._addCheck({kind:"startsWith",value:e,...qe.errToObj(n)})}endsWith(e,n){return this._addCheck({kind:"endsWith",value:e,...qe.errToObj(n)})}min(e,n){return this._addCheck({kind:"min",value:e,...qe.errToObj(n)})}max(e,n){return this._addCheck({kind:"max",value:e,...qe.errToObj(n)})}length(e,n){return this._addCheck({kind:"length",value:e,...qe.errToObj(n)})}nonempty(e){return this.min(1,qe.errToObj(e))}trim(){return new tc({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new tc({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new tc({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxLength(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}}tc.create=t=>new tc({checks:[],typeName:ht.ZodString,coerce:(t==null?void 0:t.coerce)??!1,...Tt(t)});function Mce(t,e){const n=(t.toString().split(".")[1]||"").length,s=(e.toString().split(".")[1]||"").length,r=n>s?n:s,i=Number.parseInt(t.toFixed(r).replace(".","")),o=Number.parseInt(e.toFixed(r).replace(".",""));return i%o/10**r}class mg extends Lt{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==He.number){const i=this._getOrReturnCtx(e);return Fe(i,{code:Se.invalid_type,expected:He.number,received:i.parsedType}),dt}let s;const r=new Ci;for(const i of this._def.checks)i.kind==="int"?zt.isInteger(e.data)||(s=this._getOrReturnCtx(e,s),Fe(s,{code:Se.invalid_type,expected:"integer",received:"float",message:i.message}),r.dirty()):i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(s=this._getOrReturnCtx(e,s),Fe(s,{code:Se.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),r.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(s=this._getOrReturnCtx(e,s),Fe(s,{code:Se.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),r.dirty()):i.kind==="multipleOf"?Mce(e.data,i.value)!==0&&(s=this._getOrReturnCtx(e,s),Fe(s,{code:Se.not_multiple_of,multipleOf:i.value,message:i.message}),r.dirty()):i.kind==="finite"?Number.isFinite(e.data)||(s=this._getOrReturnCtx(e,s),Fe(s,{code:Se.not_finite,message:i.message}),r.dirty()):zt.assertNever(i);return{status:r.value,value:e.data}}gte(e,n){return this.setLimit("min",e,!0,qe.toString(n))}gt(e,n){return this.setLimit("min",e,!1,qe.toString(n))}lte(e,n){return this.setLimit("max",e,!0,qe.toString(n))}lt(e,n){return this.setLimit("max",e,!1,qe.toString(n))}setLimit(e,n,s,r){return new mg({...this._def,checks:[...this._def.checks,{kind:e,value:n,inclusive:s,message:qe.toString(r)}]})}_addCheck(e){return new mg({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:qe.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:qe.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:qe.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:qe.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:qe.toString(e)})}multipleOf(e,n){return this._addCheck({kind:"multipleOf",value:e,message:qe.toString(n)})}finite(e){return this._addCheck({kind:"finite",message:qe.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:qe.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:qe.toString(e)})}get minValue(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxValue(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&zt.isInteger(e.value))}get isFinite(){let e=null,n=null;for(const s of this._def.checks){if(s.kind==="finite"||s.kind==="int"||s.kind==="multipleOf")return!0;s.kind==="min"?(n===null||s.value>n)&&(n=s.value):s.kind==="max"&&(e===null||s.value<e)&&(e=s.value)}return Number.isFinite(n)&&Number.isFinite(e)}}mg.create=t=>new mg({checks:[],typeName:ht.ZodNumber,coerce:(t==null?void 0:t.coerce)||!1,...Tt(t)});class gg extends Lt{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==He.bigint)return this._getInvalidInput(e);let s;const r=new Ci;for(const i of this._def.checks)i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(s=this._getOrReturnCtx(e,s),Fe(s,{code:Se.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),r.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(s=this._getOrReturnCtx(e,s),Fe(s,{code:Se.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),r.dirty()):i.kind==="multipleOf"?e.data%i.value!==BigInt(0)&&(s=this._getOrReturnCtx(e,s),Fe(s,{code:Se.not_multiple_of,multipleOf:i.value,message:i.message}),r.dirty()):zt.assertNever(i);return{status:r.value,value:e.data}}_getInvalidInput(e){const n=this._getOrReturnCtx(e);return Fe(n,{code:Se.invalid_type,expected:He.bigint,received:n.parsedType}),dt}gte(e,n){return this.setLimit("min",e,!0,qe.toString(n))}gt(e,n){return this.setLimit("min",e,!1,qe.toString(n))}lte(e,n){return this.setLimit("max",e,!0,qe.toString(n))}lt(e,n){return this.setLimit("max",e,!1,qe.toString(n))}setLimit(e,n,s,r){return new gg({...this._def,checks:[...this._def.checks,{kind:e,value:n,inclusive:s,message:qe.toString(r)}]})}_addCheck(e){return new gg({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:qe.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:qe.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:qe.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:qe.toString(e)})}multipleOf(e,n){return this._addCheck({kind:"multipleOf",value:e,message:qe.toString(n)})}get minValue(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxValue(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}}gg.create=t=>new gg({checks:[],typeName:ht.ZodBigInt,coerce:(t==null?void 0:t.coerce)??!1,...Tt(t)});class ML extends Lt{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==He.boolean){const s=this._getOrReturnCtx(e);return Fe(s,{code:Se.invalid_type,expected:He.boolean,received:s.parsedType}),dt}return co(e.data)}}ML.create=t=>new ML({typeName:ht.ZodBoolean,coerce:(t==null?void 0:t.coerce)||!1,...Tt(t)});class Eb extends Lt{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==He.date){const i=this._getOrReturnCtx(e);return Fe(i,{code:Se.invalid_type,expected:He.date,received:i.parsedType}),dt}if(Number.isNaN(e.data.getTime())){const i=this._getOrReturnCtx(e);return Fe(i,{code:Se.invalid_date}),dt}const s=new Ci;let r;for(const i of this._def.checks)i.kind==="min"?e.data.getTime()<i.value&&(r=this._getOrReturnCtx(e,r),Fe(r,{code:Se.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),s.dirty()):i.kind==="max"?e.data.getTime()>i.value&&(r=this._getOrReturnCtx(e,r),Fe(r,{code:Se.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),s.dirty()):zt.assertNever(i);return{status:s.value,value:new Date(e.data.getTime())}}_addCheck(e){return new Eb({...this._def,checks:[...this._def.checks,e]})}min(e,n){return this._addCheck({kind:"min",value:e.getTime(),message:qe.toString(n)})}max(e,n){return this._addCheck({kind:"max",value:e.getTime(),message:qe.toString(n)})}get minDate(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e!=null?new Date(e):null}}Eb.create=t=>new Eb({checks:[],coerce:(t==null?void 0:t.coerce)||!1,typeName:ht.ZodDate,...Tt(t)});class zL extends Lt{_parse(e){if(this._getType(e)!==He.symbol){const s=this._getOrReturnCtx(e);return Fe(s,{code:Se.invalid_type,expected:He.symbol,received:s.parsedType}),dt}return co(e.data)}}zL.create=t=>new zL({typeName:ht.ZodSymbol,...Tt(t)});class VL extends Lt{_parse(e){if(this._getType(e)!==He.undefined){const s=this._getOrReturnCtx(e);return Fe(s,{code:Se.invalid_type,expected:He.undefined,received:s.parsedType}),dt}return co(e.data)}}VL.create=t=>new VL({typeName:ht.ZodUndefined,...Tt(t)});class jL extends Lt{_parse(e){if(this._getType(e)!==He.null){const s=this._getOrReturnCtx(e);return Fe(s,{code:Se.invalid_type,expected:He.null,received:s.parsedType}),dt}return co(e.data)}}jL.create=t=>new jL({typeName:ht.ZodNull,...Tt(t)});class BL extends Lt{constructor(){super(...arguments),this._any=!0}_parse(e){return co(e.data)}}BL.create=t=>new BL({typeName:ht.ZodAny,...Tt(t)});class WL extends Lt{constructor(){super(...arguments),this._unknown=!0}_parse(e){return co(e.data)}}WL.create=t=>new WL({typeName:ht.ZodUnknown,...Tt(t)});class Fc extends Lt{_parse(e){const n=this._getOrReturnCtx(e);return Fe(n,{code:Se.invalid_type,expected:He.never,received:n.parsedType}),dt}}Fc.create=t=>new Fc({typeName:ht.ZodNever,...Tt(t)});class UL extends Lt{_parse(e){if(this._getType(e)!==He.undefined){const s=this._getOrReturnCtx(e);return Fe(s,{code:Se.invalid_type,expected:He.void,received:s.parsedType}),dt}return co(e.data)}}UL.create=t=>new UL({typeName:ht.ZodVoid,...Tt(t)});class va extends Lt{_parse(e){const{ctx:n,status:s}=this._processInputParams(e),r=this._def;if(n.parsedType!==He.array)return Fe(n,{code:Se.invalid_type,expected:He.array,received:n.parsedType}),dt;if(r.exactLength!==null){const o=n.data.length>r.exactLength.value,a=n.data.length<r.exactLength.value;(o||a)&&(Fe(n,{code:o?Se.too_big:Se.too_small,minimum:a?r.exactLength.value:void 0,maximum:o?r.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:r.exactLength.message}),s.dirty())}if(r.minLength!==null&&n.data.length<r.minLength.value&&(Fe(n,{code:Se.too_small,minimum:r.minLength.value,type:"array",inclusive:!0,exact:!1,message:r.minLength.message}),s.dirty()),r.maxLength!==null&&n.data.length>r.maxLength.value&&(Fe(n,{code:Se.too_big,maximum:r.maxLength.value,type:"array",inclusive:!0,exact:!1,message:r.maxLength.message}),s.dirty()),n.common.async)return Promise.all([...n.data].map((o,a)=>r.type._parseAsync(new Pc(n,o,n.path,a)))).then(o=>Ci.mergeArray(s,o));const i=[...n.data].map((o,a)=>r.type._parseSync(new Pc(n,o,n.path,a)));return Ci.mergeArray(s,i)}get element(){return this._def.type}min(e,n){return new va({...this._def,minLength:{value:e,message:qe.toString(n)}})}max(e,n){return new va({...this._def,maxLength:{value:e,message:qe.toString(n)}})}length(e,n){return new va({...this._def,exactLength:{value:e,message:qe.toString(n)}})}nonempty(e){return this.min(1,e)}}va.create=(t,e)=>new va({type:t,minLength:null,maxLength:null,exactLength:null,typeName:ht.ZodArray,...Tt(e)});function ih(t){if(t instanceof jn){const e={};for(const n in t.shape){const s=t.shape[n];e[n]=xc.create(ih(s))}return new jn({...t._def,shape:()=>e})}else return t instanceof va?new va({...t._def,type:ih(t.element)}):t instanceof xc?xc.create(ih(t.unwrap())):t instanceof Tf?Tf.create(ih(t.unwrap())):t instanceof md?md.create(t.items.map(e=>ih(e))):t}class jn extends Lt{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),n=zt.objectKeys(e);return this._cached={shape:e,keys:n},this._cached}_parse(e){if(this._getType(e)!==He.object){const c=this._getOrReturnCtx(e);return Fe(c,{code:Se.invalid_type,expected:He.object,received:c.parsedType}),dt}const{status:s,ctx:r}=this._processInputParams(e),{shape:i,keys:o}=this._getCached(),a=[];if(!(this._def.catchall instanceof Fc&&this._def.unknownKeys==="strip"))for(const c in r.data)o.includes(c)||a.push(c);const l=[];for(const c of o){const u=i[c],d=r.data[c];l.push({key:{status:"valid",value:c},value:u._parse(new Pc(r,d,r.path,c)),alwaysSet:c in r.data})}if(this._def.catchall instanceof Fc){const c=this._def.unknownKeys;if(c==="passthrough")for(const u of a)l.push({key:{status:"valid",value:u},value:{status:"valid",value:r.data[u]}});else if(c==="strict")a.length>0&&(Fe(r,{code:Se.unrecognized_keys,keys:a}),s.dirty());else if(c!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const c=this._def.catchall;for(const u of a){const d=r.data[u];l.push({key:{status:"valid",value:u},value:c._parse(new Pc(r,d,r.path,u)),alwaysSet:u in r.data})}}return r.common.async?Promise.resolve().then(async()=>{const c=[];for(const u of l){const d=await u.key,h=await u.value;c.push({key:d,value:h,alwaysSet:u.alwaysSet})}return c}).then(c=>Ci.mergeObjectSync(s,c)):Ci.mergeObjectSync(s,l)}get shape(){return this._def.shape()}strict(e){return qe.errToObj,new jn({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(n,s)=>{var i,o;const r=((o=(i=this._def).errorMap)==null?void 0:o.call(i,n,s).message)??s.defaultError;return n.code==="unrecognized_keys"?{message:qe.errToObj(e).message??r}:{message:r}}}:{}})}strip(){return new jn({...this._def,unknownKeys:"strip"})}passthrough(){return new jn({...this._def,unknownKeys:"passthrough"})}extend(e){return new jn({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new jn({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:ht.ZodObject})}setKey(e,n){return this.augment({[e]:n})}catchall(e){return new jn({...this._def,catchall:e})}pick(e){const n={};for(const s of zt.objectKeys(e))e[s]&&this.shape[s]&&(n[s]=this.shape[s]);return new jn({...this._def,shape:()=>n})}omit(e){const n={};for(const s of zt.objectKeys(this.shape))e[s]||(n[s]=this.shape[s]);return new jn({...this._def,shape:()=>n})}deepPartial(){return ih(this)}partial(e){const n={};for(const s of zt.objectKeys(this.shape)){const r=this.shape[s];e&&!e[s]?n[s]=r:n[s]=r.optional()}return new jn({...this._def,shape:()=>n})}required(e){const n={};for(const s of zt.objectKeys(this.shape))if(e&&!e[s])n[s]=this.shape[s];else{let i=this.shape[s];for(;i instanceof xc;)i=i._def.innerType;n[s]=i}return new jn({...this._def,shape:()=>n})}keyof(){return Q5(zt.objectKeys(this.shape))}}jn.create=(t,e)=>new jn({shape:()=>t,unknownKeys:"strip",catchall:Fc.create(),typeName:ht.ZodObject,...Tt(e)});jn.strictCreate=(t,e)=>new jn({shape:()=>t,unknownKeys:"strict",catchall:Fc.create(),typeName:ht.ZodObject,...Tt(e)});jn.lazycreate=(t,e)=>new jn({shape:t,unknownKeys:"strip",catchall:Fc.create(),typeName:ht.ZodObject,...Tt(e)});class $b extends Lt{_parse(e){const{ctx:n}=this._processInputParams(e),s=this._def.options;function r(i){for(const a of i)if(a.result.status==="valid")return a.result;for(const a of i)if(a.result.status==="dirty")return n.common.issues.push(...a.ctx.common.issues),a.result;const o=i.map(a=>new gl(a.ctx.common.issues));return Fe(n,{code:Se.invalid_union,unionErrors:o}),dt}if(n.common.async)return Promise.all(s.map(async i=>{const o={...n,common:{...n.common,issues:[]},parent:null};return{result:await i._parseAsync({data:n.data,path:n.path,parent:o}),ctx:o}})).then(r);{let i;const o=[];for(const l of s){const c={...n,common:{...n.common,issues:[]},parent:null},u=l._parseSync({data:n.data,path:n.path,parent:c});if(u.status==="valid")return u;u.status==="dirty"&&!i&&(i={result:u,ctx:c}),c.common.issues.length&&o.push(c.common.issues)}if(i)return n.common.issues.push(...i.ctx.common.issues),i.result;const a=o.map(l=>new gl(l));return Fe(n,{code:Se.invalid_union,unionErrors:a}),dt}}get options(){return this._def.options}}$b.create=(t,e)=>new $b({options:t,typeName:ht.ZodUnion,...Tt(e)});function ZN(t,e){const n=zl(t),s=zl(e);if(t===e)return{valid:!0,data:t};if(n===He.object&&s===He.object){const r=zt.objectKeys(e),i=zt.objectKeys(t).filter(a=>r.indexOf(a)!==-1),o={...t,...e};for(const a of i){const l=ZN(t[a],e[a]);if(!l.valid)return{valid:!1};o[a]=l.data}return{valid:!0,data:o}}else if(n===He.array&&s===He.array){if(t.length!==e.length)return{valid:!1};const r=[];for(let i=0;i<t.length;i++){const o=t[i],a=e[i],l=ZN(o,a);if(!l.valid)return{valid:!1};r.push(l.data)}return{valid:!0,data:r}}else return n===He.date&&s===He.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}class Ab extends Lt{_parse(e){const{status:n,ctx:s}=this._processInputParams(e),r=(i,o)=>{if(PL(i)||PL(o))return dt;const a=ZN(i.value,o.value);return a.valid?((FL(i)||FL(o))&&n.dirty(),{status:n.value,value:a.data}):(Fe(s,{code:Se.invalid_intersection_types}),dt)};return s.common.async?Promise.all([this._def.left._parseAsync({data:s.data,path:s.path,parent:s}),this._def.right._parseAsync({data:s.data,path:s.path,parent:s})]).then(([i,o])=>r(i,o)):r(this._def.left._parseSync({data:s.data,path:s.path,parent:s}),this._def.right._parseSync({data:s.data,path:s.path,parent:s}))}}Ab.create=(t,e,n)=>new Ab({left:t,right:e,typeName:ht.ZodIntersection,...Tt(n)});class md extends Lt{_parse(e){const{status:n,ctx:s}=this._processInputParams(e);if(s.parsedType!==He.array)return Fe(s,{code:Se.invalid_type,expected:He.array,received:s.parsedType}),dt;if(s.data.length<this._def.items.length)return Fe(s,{code:Se.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),dt;!this._def.rest&&s.data.length>this._def.items.length&&(Fe(s,{code:Se.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),n.dirty());const i=[...s.data].map((o,a)=>{const l=this._def.items[a]||this._def.rest;return l?l._parse(new Pc(s,o,s.path,a)):null}).filter(o=>!!o);return s.common.async?Promise.all(i).then(o=>Ci.mergeArray(n,o)):Ci.mergeArray(n,i)}get items(){return this._def.items}rest(e){return new md({...this._def,rest:e})}}md.create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new md({items:t,typeName:ht.ZodTuple,rest:null,...Tt(e)})};class HL extends Lt{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:n,ctx:s}=this._processInputParams(e);if(s.parsedType!==He.map)return Fe(s,{code:Se.invalid_type,expected:He.map,received:s.parsedType}),dt;const r=this._def.keyType,i=this._def.valueType,o=[...s.data.entries()].map(([a,l],c)=>({key:r._parse(new Pc(s,a,s.path,[c,"key"])),value:i._parse(new Pc(s,l,s.path,[c,"value"]))}));if(s.common.async){const a=new Map;return Promise.resolve().then(async()=>{for(const l of o){const c=await l.key,u=await l.value;if(c.status==="aborted"||u.status==="aborted")return dt;(c.status==="dirty"||u.status==="dirty")&&n.dirty(),a.set(c.value,u.value)}return{status:n.value,value:a}})}else{const a=new Map;for(const l of o){const c=l.key,u=l.value;if(c.status==="aborted"||u.status==="aborted")return dt;(c.status==="dirty"||u.status==="dirty")&&n.dirty(),a.set(c.value,u.value)}return{status:n.value,value:a}}}}HL.create=(t,e,n)=>new HL({valueType:e,keyType:t,typeName:ht.ZodMap,...Tt(n)});class yg extends Lt{_parse(e){const{status:n,ctx:s}=this._processInputParams(e);if(s.parsedType!==He.set)return Fe(s,{code:Se.invalid_type,expected:He.set,received:s.parsedType}),dt;const r=this._def;r.minSize!==null&&s.data.size<r.minSize.value&&(Fe(s,{code:Se.too_small,minimum:r.minSize.value,type:"set",inclusive:!0,exact:!1,message:r.minSize.message}),n.dirty()),r.maxSize!==null&&s.data.size>r.maxSize.value&&(Fe(s,{code:Se.too_big,maximum:r.maxSize.value,type:"set",inclusive:!0,exact:!1,message:r.maxSize.message}),n.dirty());const i=this._def.valueType;function o(l){const c=new Set;for(const u of l){if(u.status==="aborted")return dt;u.status==="dirty"&&n.dirty(),c.add(u.value)}return{status:n.value,value:c}}const a=[...s.data.values()].map((l,c)=>i._parse(new Pc(s,l,s.path,c)));return s.common.async?Promise.all(a).then(l=>o(l)):o(a)}min(e,n){return new yg({...this._def,minSize:{value:e,message:qe.toString(n)}})}max(e,n){return new yg({...this._def,maxSize:{value:e,message:qe.toString(n)}})}size(e,n){return this.min(e,n).max(e,n)}nonempty(e){return this.min(1,e)}}yg.create=(t,e)=>new yg({valueType:t,minSize:null,maxSize:null,typeName:ht.ZodSet,...Tt(e)});class GL extends Lt{get schema(){return this._def.getter()}_parse(e){const{ctx:n}=this._processInputParams(e);return this._def.getter()._parse({data:n.data,path:n.path,parent:n})}}GL.create=(t,e)=>new GL({getter:t,typeName:ht.ZodLazy,...Tt(e)});class KL extends Lt{_parse(e){if(e.data!==this._def.value){const n=this._getOrReturnCtx(e);return Fe(n,{received:n.data,code:Se.invalid_literal,expected:this._def.value}),dt}return{status:"valid",value:e.data}}get value(){return this._def.value}}KL.create=(t,e)=>new KL({value:t,typeName:ht.ZodLiteral,...Tt(e)});function Q5(t,e){return new kf({values:t,typeName:ht.ZodEnum,...Tt(e)})}class kf extends Lt{_parse(e){if(typeof e.data!="string"){const n=this._getOrReturnCtx(e),s=this._def.values;return Fe(n,{expected:zt.joinValues(s),received:n.parsedType,code:Se.invalid_type}),dt}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(e.data)){const n=this._getOrReturnCtx(e),s=this._def.values;return Fe(n,{received:n.data,code:Se.invalid_enum_value,options:s}),dt}return co(e.data)}get options(){return this._def.values}get enum(){const e={};for(const n of this._def.values)e[n]=n;return e}get Values(){const e={};for(const n of this._def.values)e[n]=n;return e}get Enum(){const e={};for(const n of this._def.values)e[n]=n;return e}extract(e,n=this._def){return kf.create(e,{...this._def,...n})}exclude(e,n=this._def){return kf.create(this.options.filter(s=>!e.includes(s)),{...this._def,...n})}}kf.create=Q5;class qL extends Lt{_parse(e){const n=zt.getValidEnumValues(this._def.values),s=this._getOrReturnCtx(e);if(s.parsedType!==He.string&&s.parsedType!==He.number){const r=zt.objectValues(n);return Fe(s,{expected:zt.joinValues(r),received:s.parsedType,code:Se.invalid_type}),dt}if(this._cache||(this._cache=new Set(zt.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){const r=zt.objectValues(n);return Fe(s,{received:s.data,code:Se.invalid_enum_value,options:r}),dt}return co(e.data)}get enum(){return this._def.values}}qL.create=(t,e)=>new qL({values:t,typeName:ht.ZodNativeEnum,...Tt(e)});class Rb extends Lt{unwrap(){return this._def.type}_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==He.promise&&n.common.async===!1)return Fe(n,{code:Se.invalid_type,expected:He.promise,received:n.parsedType}),dt;const s=n.parsedType===He.promise?n.data:Promise.resolve(n.data);return co(s.then(r=>this._def.type.parseAsync(r,{path:n.path,errorMap:n.common.contextualErrorMap})))}}Rb.create=(t,e)=>new Rb({type:t,typeName:ht.ZodPromise,...Tt(e)});class Cf extends Lt{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===ht.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:n,ctx:s}=this._processInputParams(e),r=this._def.effect||null,i={addIssue:o=>{Fe(s,o),o.fatal?n.abort():n.dirty()},get path(){return s.path}};if(i.addIssue=i.addIssue.bind(i),r.type==="preprocess"){const o=r.transform(s.data,i);if(s.common.async)return Promise.resolve(o).then(async a=>{if(n.value==="aborted")return dt;const l=await this._def.schema._parseAsync({data:a,path:s.path,parent:s});return l.status==="aborted"?dt:l.status==="dirty"||n.value==="dirty"?om(l.value):l});{if(n.value==="aborted")return dt;const a=this._def.schema._parseSync({data:o,path:s.path,parent:s});return a.status==="aborted"?dt:a.status==="dirty"||n.value==="dirty"?om(a.value):a}}if(r.type==="refinement"){const o=a=>{const l=r.refinement(a,i);if(s.common.async)return Promise.resolve(l);if(l instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return a};if(s.common.async===!1){const a=this._def.schema._parseSync({data:s.data,path:s.path,parent:s});return a.status==="aborted"?dt:(a.status==="dirty"&&n.dirty(),o(a.value),{status:n.value,value:a.value})}else return this._def.schema._parseAsync({data:s.data,path:s.path,parent:s}).then(a=>a.status==="aborted"?dt:(a.status==="dirty"&&n.dirty(),o(a.value).then(()=>({status:n.value,value:a.value}))))}if(r.type==="transform")if(s.common.async===!1){const o=this._def.schema._parseSync({data:s.data,path:s.path,parent:s});if(!Sf(o))return dt;const a=r.transform(o.value,i);if(a instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:n.value,value:a}}else return this._def.schema._parseAsync({data:s.data,path:s.path,parent:s}).then(o=>Sf(o)?Promise.resolve(r.transform(o.value,i)).then(a=>({status:n.value,value:a})):dt);zt.assertNever(r)}}Cf.create=(t,e,n)=>new Cf({schema:t,typeName:ht.ZodEffects,effect:e,...Tt(n)});Cf.createWithPreprocess=(t,e,n)=>new Cf({schema:e,effect:{type:"preprocess",transform:t},typeName:ht.ZodEffects,...Tt(n)});class xc extends Lt{_parse(e){return this._getType(e)===He.undefined?co(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}xc.create=(t,e)=>new xc({innerType:t,typeName:ht.ZodOptional,...Tt(e)});class Tf extends Lt{_parse(e){return this._getType(e)===He.null?co(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Tf.create=(t,e)=>new Tf({innerType:t,typeName:ht.ZodNullable,...Tt(e)});class QN extends Lt{_parse(e){const{ctx:n}=this._processInputParams(e);let s=n.data;return n.parsedType===He.undefined&&(s=this._def.defaultValue()),this._def.innerType._parse({data:s,path:n.path,parent:n})}removeDefault(){return this._def.innerType}}QN.create=(t,e)=>new QN({innerType:t,typeName:ht.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...Tt(e)});class JN extends Lt{_parse(e){const{ctx:n}=this._processInputParams(e),s={...n,common:{...n.common,issues:[]}},r=this._def.innerType._parse({data:s.data,path:s.path,parent:{...s}});return _b(r)?r.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new gl(s.common.issues)},input:s.data})})):{status:"valid",value:r.status==="valid"?r.value:this._def.catchValue({get error(){return new gl(s.common.issues)},input:s.data})}}removeCatch(){return this._def.innerType}}JN.create=(t,e)=>new JN({innerType:t,typeName:ht.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...Tt(e)});class XL extends Lt{_parse(e){if(this._getType(e)!==He.nan){const s=this._getOrReturnCtx(e);return Fe(s,{code:Se.invalid_type,expected:He.nan,received:s.parsedType}),dt}return{status:"valid",value:e.data}}}XL.create=t=>new XL({typeName:ht.ZodNaN,...Tt(t)});class zce extends Lt{_parse(e){const{ctx:n}=this._processInputParams(e),s=n.data;return this._def.type._parse({data:s,path:n.path,parent:n})}unwrap(){return this._def.type}}class zE extends Lt{_parse(e){const{status:n,ctx:s}=this._processInputParams(e);if(s.common.async)return(async()=>{const i=await this._def.in._parseAsync({data:s.data,path:s.path,parent:s});return i.status==="aborted"?dt:i.status==="dirty"?(n.dirty(),om(i.value)):this._def.out._parseAsync({data:i.value,path:s.path,parent:s})})();{const r=this._def.in._parseSync({data:s.data,path:s.path,parent:s});return r.status==="aborted"?dt:r.status==="dirty"?(n.dirty(),{status:"dirty",value:r.value}):this._def.out._parseSync({data:r.value,path:s.path,parent:s})}}static create(e,n){return new zE({in:e,out:n,typeName:ht.ZodPipeline})}}class e2 extends Lt{_parse(e){const n=this._def.innerType._parse(e),s=r=>(Sf(r)&&(r.value=Object.freeze(r.value)),r);return _b(n)?n.then(r=>s(r)):s(n)}unwrap(){return this._def.innerType}}e2.create=(t,e)=>new e2({innerType:t,typeName:ht.ZodReadonly,...Tt(e)});jn.lazycreate;var ht;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})(ht||(ht={}));const Bp=tc.create;Fc.create;const YL=va.create,Vce=jn.create;jn.strictCreate;$b.create;Ab.create;md.create;kf.create;Rb.create;xc.create;Tf.create;var jce="Label",J5=D.forwardRef((t,e)=>S.jsx(Ls.label,{...t,ref:e,onMouseDown:n=>{var r;n.target.closest("button, input, select, textarea")||((r=t.onMouseDown)==null||r.call(t,n),!n.defaultPrevented&&n.detail>1&&n.preventDefault())}}));J5.displayName=jce;var eH=J5;const Bce=Xw("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),Ja=D.forwardRef(({className:t,...e},n)=>S.jsx(eH,{ref:n,className:Tn(Bce(),t),...e}));Ja.displayName=eH.displayName;const Wce=Ule,tH=D.createContext({}),Wp=({...t})=>S.jsx(tH.Provider,{value:{name:t.name},children:S.jsx(qle,{...t})}),c1=()=>{const t=D.useContext(tH),e=D.useContext(nH),{getFieldState:n,formState:s}=l1(),r=n(t.name,s);if(!t)throw new Error("useFormField should be used within <FormField>");const{id:i}=e;return{id:i,name:t.name,formItemId:`${i}-form-item`,formDescriptionId:`${i}-form-item-description`,formMessageId:`${i}-form-item-message`,...r}},nH=D.createContext({}),oh=D.forwardRef(({className:t,...e},n)=>{const s=D.useId();return S.jsx(nH.Provider,{value:{id:s},children:S.jsx("div",{ref:n,className:Tn("space-y-2",t),...e})})});oh.displayName="FormItem";const ah=D.forwardRef(({className:t,...e},n)=>{const{error:s,formItemId:r}=c1();return S.jsx(Ja,{ref:n,className:Tn(s&&"text-destructive",t),htmlFor:r,...e})});ah.displayName="FormLabel";const am=D.forwardRef(({...t},e)=>{const{error:n,formItemId:s,formDescriptionId:r,formMessageId:i}=c1();return S.jsx(F4,{ref:e,id:s,"aria-describedby":n?`${r} ${i}`:`${r}`,"aria-invalid":!!n,...t})});am.displayName="FormControl";const Uce=D.forwardRef(({className:t,...e},n)=>{const{formDescriptionId:s}=c1();return S.jsx("p",{ref:n,id:s,className:Tn("text-sm text-muted-foreground",t),...e})});Uce.displayName="FormDescription";const lm=D.forwardRef(({className:t,children:e,...n},s)=>{const{error:r,formMessageId:i}=c1(),o=r?String((r==null?void 0:r.message)??""):e;return o?S.jsx("p",{ref:s,id:i,className:Tn("text-sm font-medium text-destructive",t),...n,children:o}):null});lm.displayName="FormMessage";function Hce(t){const e=D.useRef({value:t,previous:t});return D.useMemo(()=>(e.current.value!==t&&(e.current.previous=e.current.value,e.current.value=t),e.current.previous),[t])}var u1="Checkbox",[Gce,QWe]=ry(u1),[Kce,VE]=Gce(u1);function qce(t){const{__scopeCheckbox:e,checked:n,children:s,defaultChecked:r,disabled:i,form:o,name:a,onCheckedChange:l,required:c,value:u="on",internal_do_not_use_render:d}=t,[h,f]=W4({prop:n,defaultProp:r??!1,onChange:l,caller:u1}),[p,m]=D.useState(null),[g,y]=D.useState(null),x=D.useRef(!1),v=p?!!o||!!p.closest("form"):!0,b={checked:h,disabled:i,setChecked:f,control:p,setControl:m,name:a,form:o,value:u,hasConsumerStoppedPropagationRef:x,required:c,defaultChecked:vc(r)?!1:r,isFormControl:v,bubbleInput:g,setBubbleInput:y};return S.jsx(Kce,{scope:e,...b,children:Xce(d)?d(b):s})}var sH="CheckboxTrigger",rH=D.forwardRef(({__scopeCheckbox:t,onKeyDown:e,onClick:n,...s},r)=>{const{control:i,value:o,disabled:a,checked:l,required:c,setControl:u,setChecked:d,hasConsumerStoppedPropagationRef:h,isFormControl:f,bubbleInput:p}=VE(sH,t),m=Si(r,u),g=D.useRef(l);return D.useEffect(()=>{const y=i==null?void 0:i.form;if(y){const x=()=>d(g.current);return y.addEventListener("reset",x),()=>y.removeEventListener("reset",x)}},[i,d]),S.jsx(Ls.button,{type:"button",role:"checkbox","aria-checked":vc(l)?"mixed":l,"aria-required":c,"data-state":cH(l),"data-disabled":a?"":void 0,disabled:a,value:o,...s,ref:m,onKeyDown:Zn(e,y=>{y.key==="Enter"&&y.preventDefault()}),onClick:Zn(n,y=>{d(x=>vc(x)?!0:!x),p&&f&&(h.current=y.isPropagationStopped(),h.current||y.stopPropagation())})})});rH.displayName=sH;var jE=D.forwardRef((t,e)=>{const{__scopeCheckbox:n,name:s,checked:r,defaultChecked:i,required:o,disabled:a,value:l,onCheckedChange:c,form:u,...d}=t;return S.jsx(qce,{__scopeCheckbox:n,checked:r,defaultChecked:i,disabled:a,required:o,onCheckedChange:c,name:s,form:u,value:l,internal_do_not_use_render:({isFormControl:h})=>S.jsxs(S.Fragment,{children:[S.jsx(rH,{...d,ref:e,__scopeCheckbox:n}),h&&S.jsx(lH,{__scopeCheckbox:n})]})})});jE.displayName=u1;var iH="CheckboxIndicator",oH=D.forwardRef((t,e)=>{const{__scopeCheckbox:n,forceMount:s,...r}=t,i=VE(iH,n);return S.jsx(Gw,{present:s||vc(i.checked)||i.checked===!0,children:S.jsx(Ls.span,{"data-state":cH(i.checked),"data-disabled":i.disabled?"":void 0,...r,ref:e,style:{pointerEvents:"none",...t.style}})})});oH.displayName=iH;var aH="CheckboxBubbleInput",lH=D.forwardRef(({__scopeCheckbox:t,...e},n)=>{const{control:s,hasConsumerStoppedPropagationRef:r,checked:i,defaultChecked:o,required:a,disabled:l,name:c,value:u,form:d,bubbleInput:h,setBubbleInput:f}=VE(aH,t),p=Si(n,f),m=Hce(i),g=LW(s);D.useEffect(()=>{const x=h;if(!x)return;const v=window.HTMLInputElement.prototype,k=Object.getOwnPropertyDescriptor(v,"checked").set,C=!r.current;if(m!==i&&k){const N=new Event("click",{bubbles:C});x.indeterminate=vc(i),k.call(x,vc(i)?!1:i),x.dispatchEvent(N)}},[h,m,i,r]);const y=D.useRef(vc(i)?!1:i);return S.jsx(Ls.input,{type:"checkbox","aria-hidden":!0,defaultChecked:o??y.current,required:a,disabled:l,name:c,value:u,form:d,...e,tabIndex:-1,ref:p,style:{...e.style,...g,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});lH.displayName=aH;function Xce(t){return typeof t=="function"}function vc(t){return t==="indeterminate"}function cH(t){return vc(t)?"indeterminate":t?"checked":"unchecked"}const uH=D.forwardRef(({className:t,...e},n)=>S.jsx(jE,{ref:n,className:Tn("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",t),...e,children:S.jsx(oH,{className:Tn("flex items-center justify-center text-current"),children:S.jsx(tte,{className:"h-4 w-4"})})}));uH.displayName=jE.displayName;const Yce=Vce({ageGroup:Bp().min(1,"Please select your age group"),experience:Bp().min(1,"Please select your experience level"),goals:YL(Bp()).min(1,"Please select at least one goal"),timeAvailable:Bp().min(1,"Please select your available time"),healthConditions:YL(Bp()).optional()});function Zce(){ti();const{toast:t}=Hw(),[e,n]=D.useState(""),[s,r]=D.useState(""),[i,o]=D.useState(""),[a,l]=D.useState([]),c=lce({resolver:hce(Yce),defaultValues:{ageGroup:"",experience:"",goals:[],timeAvailable:"",healthConditions:[]}}),u=db({mutationFn:async g=>{const x=await fetch("http://localhost:5000/api/assessment",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(g)});if(!x.ok)throw new Error("Failed to fetch recommendations");return x.json()},onSuccess:g=>{t({title:"Assessment Complete!",description:"Your personalized routines have been generated."}),g&&g.recommendations?(l(g.recommendations),console.log("Recommended poses:",g.recommendations)):g&&g.recommendedPoses?(l(g.recommendedPoses),console.log("Recommended poses:",g.recommendedPoses)):(l([]),console.log("No recommended poses returned."));const y=JSON.parse(localStorage.getItem("user")||"{}");y&&y.username&&$_.invalidateQueries({queryKey:["recommended-poses",y.username]})},onError:g=>{t({title:"Error",description:"Failed to generate recommendations. Please try again.",variant:"destructive"})}}),d=g=>{const y=JSON.parse(localStorage.getItem("user")||"{}");if(!y||!y.id||!y.username){t({title:"Login Required",description:"Please log in to generate your personalized routine.",variant:"destructive"});return}u.mutate({...g,username:y.username})},h=[{value:"<18",label:"Under 18"},{value:"18-25",label:"18-25"},{value:"26-35",label:"26-35"},{value:"36-50",label:"36-50"},{value:"50+",label:"Above 50"}],f=[{value:"beginner",label:"Beginner",icon:S.jsx(ute,{className:"w-6 h-6"}),description:"New to yoga or less than 6 months experience"},{value:"intermediate",label:"Intermediate",icon:S.jsx(ite,{className:"w-6 h-6"}),description:"6 months to 2 years of regular practice"},{value:"advanced",label:"Advanced",icon:S.jsx(hte,{className:"w-6 h-6"}),description:"2+ years of consistent yoga practice"}],p=["flexibility","strength","stress relief","balance","meditation","weight loss"],m=[{value:"10-15 min",label:"10-15 min",icon:S.jsx(dW,{className:"w-6 h-6"})},{value:"15-30 min",label:"15-30 min",icon:S.jsx(dte,{className:"w-6 h-6"})},{value:"30-45 min",label:"30-45 min",icon:S.jsx(ete,{className:"w-6 h-6"})},{value:"45+ min",label:"45+ min",icon:S.jsx(Jee,{className:"w-6 h-6"})}];return S.jsx(Qn,{className:"bg-wellness-50 border-none shadow-lg",children:S.jsx(Jn,{className:"p-8 lg:p-12",children:S.jsx(Wce,{...c,children:S.jsxs("form",{onSubmit:c.handleSubmit(d),className:"space-y-8",children:[S.jsx(Wp,{control:c.control,name:"ageGroup",render:({field:g})=>S.jsxs(oh,{children:[S.jsx(ah,{className:"text-lg font-semibold text-wellness-800",children:"What's your age group?"}),S.jsx(am,{children:S.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:h.map(y=>S.jsx("button",{type:"button",className:`p-4 border-2 rounded-xl transition-all text-center ${e===y.value?"border-primary-400 bg-primary-50":"border-wellness-200 hover:border-primary-400 hover:bg-primary-50"}`,onClick:()=>{n(y.value),g.onChange(y.value)},children:S.jsx("div",{className:"font-semibold",children:y.label})},y.value))})}),S.jsx(lm,{})]})}),S.jsx(Wp,{control:c.control,name:"experience",render:({field:g})=>S.jsxs(oh,{children:[S.jsx(ah,{className:"text-lg font-semibold text-wellness-800",children:"What's your yoga experience?"}),S.jsx(am,{children:S.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4",children:f.map(y=>S.jsxs("button",{type:"button",className:`p-6 border-2 rounded-xl transition-all cursor-pointer text-left ${s===y.value?"border-primary-400 bg-primary-50":"border-wellness-200 hover:border-primary-400 hover:bg-primary-50"}`,onClick:()=>{r(y.value),g.onChange(y.value)},children:[S.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[S.jsx("div",{className:"text-secondary-500",children:y.icon}),S.jsx("span",{className:"font-semibold text-lg",children:y.label})]}),S.jsx("p",{className:"text-wellness-600 text-sm",children:y.description})]},y.value))})}),S.jsx(lm,{})]})}),S.jsx(Wp,{control:c.control,name:"goals",render:()=>S.jsxs(oh,{children:[S.jsx(ah,{className:"text-lg font-semibold text-wellness-800",children:"What are your primary goals? (Select all that apply)"}),S.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-3 gap-4",children:p.map(g=>S.jsx(Wp,{control:c.control,name:"goals",render:({field:y})=>{var x;return S.jsxs(oh,{className:"flex items-center space-x-3 p-4 border-2 border-wellness-200 rounded-xl hover:bg-wellness-100 transition-all cursor-pointer",children:[S.jsx(am,{children:S.jsx(uH,{checked:(x=y.value)==null?void 0:x.includes(g),onCheckedChange:v=>{var b;return v?y.onChange([...y.value,g]):y.onChange((b=y.value)==null?void 0:b.filter(k=>k!==g))}})}),S.jsx(ah,{className:"capitalize cursor-pointer",children:g})]})}},g))}),S.jsx(lm,{})]})}),S.jsx(Wp,{control:c.control,name:"timeAvailable",render:({field:g})=>S.jsxs(oh,{children:[S.jsx(ah,{className:"text-lg font-semibold text-wellness-800",children:"How much time can you dedicate daily?"}),S.jsx(am,{children:S.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:m.map(y=>S.jsxs("button",{type:"button",className:`p-4 border-2 rounded-xl transition-all text-center ${i===y.value?"border-primary-400 bg-primary-50":"border-wellness-200 hover:border-primary-400 hover:bg-primary-50"}`,onClick:()=>{o(y.value),g.onChange(y.value)},children:[S.jsx("div",{className:"text-2xl mb-2 flex justify-center",children:y.icon}),S.jsx("div",{className:"font-semibold",children:y.label})]},y.value))})}),S.jsx(lm,{})]})}),S.jsx("div",{className:"text-center pt-8",children:S.jsx(lt,{type:"submit",disabled:u.isPending,className:"gradient-bg text-white px-12 py-4 rounded-full font-semibold text-lg hover:shadow-xl transform hover:scale-105 transition-all",children:u.isPending?S.jsxs(S.Fragment,{children:[S.jsx(ote,{className:"w-5 h-5 mr-2 animate-spin"}),"Generating..."]}):S.jsxs(S.Fragment,{children:["Generate My Routine",S.jsx("span",{className:"ml-2",children:"✨"})]})})})]})})})})}function Qce(){return S.jsxs("div",{className:"min-h-screen bg-wellness-50",children:[S.jsx(il,{}),S.jsx("div",{className:"pt-24 pb-20",children:S.jsxs("div",{className:"max-w-4xl mx-auto px-6",children:[S.jsxs("div",{className:"text-center mb-16",children:[S.jsxs("h1",{className:"font-poppins font-bold text-4xl lg:text-5xl mb-6",children:["Personalized ",S.jsx("span",{className:"gradient-text",children:"Assessment"})]}),S.jsx("p",{className:"text-xl text-wellness-600 max-w-2xl mx-auto",children:"Answer a few questions to help our AI create the perfect yoga routine tailored specifically for you"})]}),S.jsx(Zce,{})]})})]})}const Jce=Xw("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function _v({className:t,variant:e,...n}){return S.jsx("div",{className:Tn(Jce({variant:e}),t),...n})}const eue={beginner:"bg-secondary-400",intermediate:"bg-orange-500",advanced:"bg-red-500","all levels":"bg-green-500"};function dH({pose:t}){const[,e]=ti(),[n,s]=D.useState(t.image);et.useEffect(()=>{fetch("/pose-images.json").then(i=>i.json()).then(i=>{i[t.name]&&s(i[t.name])})},[t.name]);const r=()=>{if(!t.name)return;console.log("View details for:",t.name);const i=t.name.toLowerCase().replace(/\s+/g,"-").replace(/[^a-z0-9-]/g,"");e(`/pose/${i}`)};return S.jsx(Qn,{className:"bg-wellness-50 border-none rounded-2xl hover:shadow-lg transition-all transform hover:-translate-y-1",children:S.jsxs(Jn,{className:"p-6",children:[S.jsxs("div",{className:"relative overflow-hidden rounded-xl mb-4",children:[S.jsx("img",{src:n,alt:t.name,className:"w-full h-48 object-cover transition-transform hover:scale-105",onError:()=>s("https://images.pexels.com/photos/3823039/pexels-photo-3823039.jpeg?auto=compress&w=400&h=300")}),S.jsx("div",{className:"absolute top-2 right-2",children:S.jsx(_v,{className:`${eue[t.difficulty]} text-white text-xs shadow-md`,children:t.difficulty})}),t.duration&&S.jsx("div",{className:"absolute bottom-2 left-2",children:S.jsxs(_v,{className:"bg-black/70 text-white text-xs",children:[Math.floor(t.duration/60),":",(t.duration%60).toString().padStart(2,"0")]})})]}),S.jsxs("div",{className:"mb-4",children:[S.jsx("h3",{className:"font-bold text-lg text-wellness-800 mb-1",children:t.name}),t.sanskrit_name&&S.jsx("p",{className:"text-primary-600 text-sm italic mb-2",children:t.sanskrit_name}),S.jsx("p",{className:"text-wellness-600 text-sm line-clamp-2",children:t.description})]}),S.jsxs("div",{className:"flex items-center justify-between",children:[S.jsx("div",{className:"flex items-center gap-2",children:S.jsx(_v,{variant:"outline",className:"text-xs border-wellness-300",children:t.category?t.category.replace("-"," "):""})}),S.jsx(lt,{variant:"ghost",size:"sm",onClick:r,className:"text-primary-500 hover:text-primary-600 hover:bg-primary-50 transition-all p-2 rounded-full",children:S.jsx(rte,{className:"w-4 h-4"})})]})]})})}function jr({className:t,...e}){return S.jsx("div",{className:Tn("animate-pulse rounded-md bg-muted",t),...e})}function tue(){const[t,e]=ti(),n=typeof window<"u"?JSON.parse(localStorage.getItem("user")||"{}"):{},{data:s,isLoading:r}=Zu({queryKey:["recommended-poses",n==null?void 0:n.username],queryFn:async()=>{if(!(n!=null&&n.username))return[];const p=await fetch(`http://localhost:5000/api/routines?username=${n.username}`);return p.ok?await p.json():[]}}),i="http://localhost:5000/api",{data:o=[],isLoading:a}=Zu({queryKey:["/api/poses"],queryFn:async()=>{const f=await fetch(`${i}/poses`);return f.ok?await f.json():[]}}),l=(s??[]).map(f=>o.find(p=>p.name===f)).filter(Boolean),c=l.length>0,u=new Date().toISOString().slice(0,10),h=(typeof window<"u"?localStorage.getItem("lastStreakDate"):null)===u;return et.useEffect(()=>{},[c,l]),S.jsxs("div",{className:"min-h-screen bg-wellness-50",children:[S.jsx(il,{}),S.jsx("div",{className:"pt-24 pb-20",children:S.jsxs("div",{className:"max-w-7xl mx-auto px-6",children:[S.jsxs("div",{className:"text-center mb-16",children:[S.jsxs("h1",{className:"font-poppins font-bold text-4xl lg:text-5xl mb-6",children:["Your ",S.jsx("span",{className:"gradient-text",children:"Personalized"})," Routines"]}),S.jsx("p",{className:"text-xl text-wellness-600 max-w-2xl mx-auto",children:"AI-generated yoga sequences designed specifically for your goals, experience level, and preferences"})]}),r||a?S.jsx("div",{className:"grid lg:grid-cols-3 gap-8",children:[...Array(6)].map((f,p)=>S.jsxs("div",{className:"bg-white rounded-3xl p-8 shadow-lg",children:[S.jsx(jr,{className:"w-full h-48 rounded-xl mb-6"}),S.jsx(jr,{className:"h-6 w-3/4 mb-4"}),S.jsx(jr,{className:"h-4 w-full mb-2"}),S.jsx(jr,{className:"h-4 w-2/3 mb-6"}),S.jsx(jr,{className:"h-12 w-full"})]},p))}):S.jsxs(S.Fragment,{children:[S.jsx("div",{className:"grid lg:grid-cols-3 gap-8",children:c?l.map((f,p)=>S.jsx(dH,{pose:f},f.id||f.name||p)):S.jsx("div",{className:"col-span-3 text-center text-xl text-wellness-600 py-12",children:"No recommended poses found. Please complete your assessment."})}),c&&S.jsx("div",{className:"flex justify-center mt-12",children:S.jsx(lt,{className:"gradient-bg text-white px-8 py-4 rounded-full font-semibold text-lg shadow-lg hover:scale-105 transition-all",onClick:()=>{localStorage.setItem("routinePoses",JSON.stringify(l)),e("/start-routine")},children:h?"Do Again":"Start Routine"})})]})]})})]})}const nue=()=>{var h,f;const[,t]=ti(),[e,n]=D.useState("all"),[s,r]=D.useState("all"),i="http://localhost:5000/api",{data:o=[],isLoading:a}=Zu({queryKey:["/api/poses"],queryFn:async()=>{const p=await fetch(`${i}/poses`);return p.ok?await p.json():[]}}),l=[{id:"all",name:"All Categories"},{id:"mindfulness",name:"Mindfulness"},{id:"weight loss",name:"Weight Loss"},{id:"posture",name:"Posture"},{id:"stress relief",name:"Stress Relief"},{id:"strength",name:"Strength"},{id:"flexibility",name:"Flexibility"}],c=[{id:"all",name:"All Levels"},{id:"beginner",name:"Beginner"},{id:"intermediate",name:"Intermediate"},{id:"advanced",name:"Advanced"}],u=o.filter(p=>{const m=e==="all"||p.goal_category.toLowerCase()===e.toLowerCase(),g=s==="all"||p.difficulty.toLowerCase()===s.toLowerCase();return m&&g}),d=u.map((p,m)=>({id:m.toString(),name:p.name,sanskrit_name:p.sanskrit_name,description:p.benefits,difficulty:p.difficulty,category:p.goal_category.toLowerCase().replace(" ","-"),duration:p.duration_sec,instructions:p.instructions||"Detailed instructions coming soon",precautions:p.precautions||"General yoga precautions apply",modifications:p.modifications||"Modifications available upon request",image:p.image?`/yoga/${p.image.replace(/^\/api\/yoga\//,"").replace(/^\/yoga\//,"")}`:`https://source.unsplash.com/400x300/?yoga,${encodeURIComponent(p.name)}`}));return S.jsxs("div",{className:"min-h-screen bg-wellness-50",children:[S.jsx(il,{}),S.jsx("div",{className:"pt-24 pb-20",children:S.jsxs("div",{className:"max-w-7xl mx-auto px-6",children:[S.jsxs("div",{className:"text-center mb-16",children:[S.jsxs("h1",{className:"font-poppins font-bold text-4xl lg:text-5xl mb-6",children:["Pose ",S.jsx("span",{className:"gradient-text",children:"Library"})]}),S.jsx("p",{className:"text-xl text-wellness-600 max-w-2xl mx-auto mb-4",children:"Explore our comprehensive library of yoga poses with detailed instructions and benefits"}),S.jsx("p",{className:"text-lg text-wellness-500",children:a?"Loading...":`${o.length} authentic yoga poses from our real dataset`})]}),S.jsxs("div",{className:"mb-8",children:[S.jsx("h3",{className:"font-semibold text-lg mb-4 text-center",children:"Filter by Category"}),S.jsx("div",{className:"flex flex-wrap justify-center gap-3 mb-6",children:l.map(p=>S.jsx(lt,{variant:e===p.id?"default":"outline",size:"sm",onClick:()=>n(p.id),className:e===p.id?"gradient-bg text-white":"bg-wellness-100 text-wellness-600 hover:bg-primary-50",children:p.name},p.id))}),S.jsx("h3",{className:"font-semibold text-lg mb-4 text-center",children:"Filter by Difficulty"}),S.jsx("div",{className:"flex flex-wrap justify-center gap-3 mb-8",children:c.map(p=>S.jsx(lt,{variant:s===p.id?"default":"outline",size:"sm",onClick:()=>r(p.id),className:s===p.id?"bg-secondary-500 text-white hover:bg-secondary-600":"bg-wellness-100 text-wellness-600 hover:bg-secondary-50",children:p.name},p.id))})]}),S.jsx("div",{className:"text-center mb-8",children:S.jsxs("p",{className:"text-wellness-600",children:["Showing ",u.length," poses",e!=="all"&&` in ${(h=l.find(p=>p.id===e))==null?void 0:h.name}`,s!=="all"&&` for ${(f=c.find(p=>p.id===s))==null?void 0:f.name}`]})}),a&&S.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-4 gap-6",children:[...Array(8)].map((p,m)=>S.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:[S.jsx(jr,{className:"w-full h-48"}),S.jsxs("div",{className:"p-4",children:[S.jsx(jr,{className:"h-6 w-3/4 mb-2"}),S.jsx(jr,{className:"h-4 w-full mb-2"}),S.jsx(jr,{className:"h-4 w-1/2"})]})]},m))}),!a&&S.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:d.map(p=>S.jsx(dH,{pose:p},p.id))}),!a&&u.length===0&&S.jsxs("div",{className:"text-center py-12",children:[S.jsx("p",{className:"text-xl text-wellness-600 mb-4",children:"No poses found for the selected filters"}),S.jsx(lt,{onClick:()=>{n("all"),r("all")},className:"gradient-bg text-white",children:"Clear Filters"})]}),S.jsx("div",{className:"text-center mt-16",children:S.jsxs("div",{className:"bg-gradient-to-r from-primary-50 to-secondary-50 rounded-2xl p-8 max-w-2xl mx-auto",children:[S.jsx("h3",{className:"font-poppins font-bold text-2xl mb-4",children:"Ready to start your yoga journey?"}),S.jsx("p",{className:"text-wellness-600 mb-6",children:"Take our personalized assessment to get custom routines with poses that match your goals and experience level."}),S.jsx(lt,{onClick:()=>t("/assessment"),className:"gradient-bg text-white px-8 py-3 text-lg font-semibold hover:shadow-xl transform hover:scale-105 transition-all",children:"Take Assessment"})]})})]})})]})},cm={"Mountain Pose":["Stand tall with feet hip-width apart","Ground through all four corners of your feet","Lengthen your spine toward the sky","Relax your shoulders away from your ears","Breathe deeply and find your center"],"Child's Pose":["Kneel on the mat with big toes touching","Sit back on your heels","Fold forward and rest your forehead on the mat","Extend your arms forward or by your sides","Breathe deeply and relax"],"Downward Dog":["Start in tabletop position","Tuck your toes and lift your hips up","Straighten your legs as much as comfortable","Press through your palms","Create an inverted V-shape with your body"],"Warrior I":["Step your left foot back 3-4 feet","Turn your left foot out 45 degrees","Bend your right knee over your ankle","Raise your arms overhead","Hold and breathe, then switch sides"],"Warrior II":["From Warrior I, open your hips and torso to the side","Extend your arms parallel to the floor","Gaze over your front hand","Keep your front knee tracking over your ankle","Hold and breathe steadily"],"Tree Pose":["Stand tall in Mountain Pose","Shift weight to your left foot","Place right foot on inner left thigh or calf","Press hands together at heart center","Find a focal point and breathe"],"Bridge Pose":["Lie on your back with knees bent","Place feet hip-width apart","Press into your feet and lift your hips","Interlace fingers under your back","Keep knees parallel and breathe"],"Cobra Pose":["Lie face down with palms under shoulders","Press palms down and lift your chest","Keep shoulders away from ears","Engage your back muscles","Breathe and avoid straining your neck"],Plank:["Start in tabletop position","Step feet back into straight line","Keep shoulders over wrists","Engage your core muscles","Maintain straight line from head to heels"],"Corpse Pose":["Lie flat on your back","Let arms rest at your sides","Close your eyes gently","Breathe naturally and deeply","Release all tension from your body"]},sue={name:"Morning Flow",description:"Start your day with energizing poses",duration:15,difficulty:"beginner",category:"Mindfulness",score:.9,matchReasons:["Perfect for beginners","Great morning routine"],poses:[{difficulty:"beginner",goal_category:"Mindfulness",name:"Mountain Pose",sanskrit_name:"Tadasana",min_age:10,max_age:80,benefits:"Improves focus, grounding, posture",duration_sec:60,instructions:cm["Mountain Pose"]},{difficulty:"beginner",goal_category:"Strength",name:"Downward Dog",sanskrit_name:"Adho Mukha Svanasana",min_age:14,max_age:70,benefits:"Arm/leg strength",duration_sec:90,instructions:cm["Downward Dog"]},{difficulty:"beginner",goal_category:"Strength",name:"Warrior I",sanskrit_name:"Virabhadrasana I",min_age:16,max_age:65,benefits:"Builds leg/core strength",duration_sec:75,instructions:cm["Warrior I"]},{difficulty:"beginner",goal_category:"Mindfulness",name:"Child's Pose",sanskrit_name:"Balasana",min_age:8,max_age:85,benefits:"Calms mind, reduces anxiety",duration_sec:120,instructions:cm["Child's Pose"]}]};function ZL(){var n,s;const t=typeof window<"u"?localStorage.getItem("routinePoses"):null;let e=[];if(t)try{e=JSON.parse(t).map(i=>({...i,instructions:Array.isArray(i.instructions)?i.instructions:typeof i.instructions=="string"?[i.instructions]:cm[i.name]||[],precautions:i.precautions||"",modifications:i.modifications||"",image:"",youtube_link:i.youtube_link||""})).filter(i=>i&&i.name),typeof window<"u"&&fetch("/pose-images.json").then(i=>i.json()).then(i=>{e.forEach(o=>{o.name&&i[o.name]&&(o.image=i[o.name])})})}catch{}return{name:"Personalized Routine",description:"Your recommended yoga sequence",duration:e.reduce((r,i)=>r+(i.duration_sec||0),0),difficulty:((n=e[0])==null?void 0:n.difficulty)||"beginner",category:((s=e[0])==null?void 0:s.goal_category)||"Mindfulness",score:1,matchReasons:[],poses:e}}function rue(){var v,b;const[t,e]=ti(),[n,s]=D.useState(ZL()),[r,i]=D.useState(0),[o,a]=D.useState(((v=n.poses[0])==null?void 0:v.duration_sec)||60),[l,c]=D.useState(!1),[u,d]=D.useState(!1),[h,f]=D.useState(!1);D.useEffect(()=>{if(u&&n&&n.poses.length>0){const k=typeof window<"u"?JSON.parse(localStorage.getItem("user")||"{}"):{},C=(k==null?void 0:k.id)||(k==null?void 0:k.userId)||(k==null?void 0:k.username),N=n.poses.reduce(($,A)=>$+(A.duration_sec||0),0),I=n.poses.map($=>$.name);C&&fetch("http://localhost:5000/api/progress",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:C,routineId:n.name,duration:N,rating:null,completedPoses:I})}).catch(()=>{})}},[u,n]);const p=n.poses[r];D.useEffect(()=>{var k;s(ZL()),i(0),a(((k=n.poses[0])==null?void 0:k.duration_sec)||60),d(!1),c(!1)},[]),D.useEffect(()=>{let k;return l&&o>0&&!u&&(k=setInterval(()=>{a(C=>C<=1?r<n.poses.length-1?(i(r+1),n.poses[r+1].duration_sec):(d(!0),c(!1),0):C-1)},1e3)),()=>clearInterval(k)},[l,o,r,u,n.poses]);const m=()=>{c(!l)},g=()=>{window.speechSynthesis.cancel(),f(!1),r<n.poses.length-1&&(i(r+1),a(n.poses[r+1].duration_sec))},y=()=>{i(0),a(n.poses[0].duration_sec),c(!1),d(!1)},x=k=>{const C=Math.floor(k/60),N=k%60;return`${C}:${N.toString().padStart(2,"0")}`};if(u){const k=new Date().toISOString().slice(0,10),C=typeof window<"u"?localStorage.getItem("lastStreakDate"):null;let N=typeof window<"u"?parseInt(localStorage.getItem("streak")||"0",10):0;C!==k&&(C&&new Date(k).getTime()-new Date(C).getTime()<=864e5?N+=1:N=1,typeof window<"u"&&(localStorage.setItem("streak",N.toString()),localStorage.setItem("lastStreakDate",k)));const I=`routineMonth_${k.slice(0,7)}`;let $=!1;return typeof window<"u"&&(localStorage.getItem(I)||($=!0,localStorage.setItem(I,"done"))),S.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-wellness-50 to-white",children:[S.jsx(il,{}),S.jsx(We.div,{className:"pt-24 pb-12 px-6",initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:.6},children:S.jsxs("div",{className:"max-w-2xl mx-auto text-center",children:[S.jsx(We.div,{className:"w-24 h-24 bg-gradient-to-r from-primary-400 to-secondary-400 rounded-full flex items-center justify-center mx-auto mb-8",animate:{rotate:360},transition:{duration:2},children:S.jsx("span",{className:"text-3xl",children:"🧘‍♀️"})}),S.jsx("h1",{className:"font-poppins font-bold text-4xl mb-6 gradient-text",children:"Routine Complete!"}),S.jsxs("p",{className:"text-xl text-wellness-600 mb-8",children:["Congratulations on completing your ",sue.name," routine. You've taken an important step in your wellness journey."]}),S.jsx("div",{className:"mb-8",children:S.jsxs("span",{className:`inline-block rounded-full px-6 py-3 font-semibold text-xl shadow ${$?"bg-green-100 text-green-700":"bg-primary-100 text-primary-700"}`,children:["🔥 Streak: ",N," day",N===1?"":"s","!",$&&S.jsx("span",{className:"ml-2",children:"🟢 First routine of the month!"})]})}),S.jsxs("div",{className:"flex gap-4 justify-center flex-wrap",children:[S.jsxs(lt,{onClick:y,className:"gradient-bg text-white px-8 py-3",children:[S.jsx(VP,{className:"w-5 h-5 mr-2"}),"Do Again"]}),S.jsx(lt,{onClick:()=>e("/routines"),variant:"outline",className:"px-8 py-3",children:"Browse Routines"})]})]})})]})}return S.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-wellness-50 to-white",children:[S.jsx(il,{}),S.jsx("div",{className:"pt-24 pb-12 px-6",children:S.jsx("div",{className:"max-w-6xl mx-auto",children:S.jsxs("div",{className:"grid lg:grid-cols-2 gap-12 items-start",children:[S.jsx(We.div,{className:"sticky top-8",initial:{opacity:0,x:-50},animate:{opacity:1,x:0},transition:{duration:.6},children:S.jsx(Qn,{className:"bg-white shadow-xl border-none overflow-hidden",children:S.jsxs(Jn,{className:"p-0",children:[S.jsxs("div",{className:"relative w-full max-w-md mx-auto flex items-center justify-center aspect-square sm:aspect-square md:aspect-square lg:aspect-square",style:{maxHeight:"340px"},children:[S.jsx("div",{className:"absolute inset-0 w-full h-full z-20 overflow-hidden",children:S.jsx(We.div,{className:"absolute inset-0 border-[6px] border-primary-500 rounded-xl",style:{clipPath:`polygon(
                            0 0, 100% 0, 100% 100%, 0 100%, 
                            0 0, 6px 6px, 6px calc(100% - 6px), calc(100% - 6px) calc(100% - 6px), 
                            calc(100% - 6px) 6px, 6px 6px
                          )`},animate:{clipPath:[`polygon(
                              0 0, 100% 0, 100% 100%, 0 100%, 
                              0 0, 6px 6px, 6px calc(100% - 6px), calc(100% - 6px) calc(100% - 6px), 
                              calc(100% - 6px) 6px, 6px 6px
                            )`,`polygon(
                              0 0, 100% 0, 100% 100%, 0 100%, 
                              0 0, 100% 0, 100% 100%, 0 100%, 
                              0 0, 6px 6px
                            )`]},transition:{duration:p.duration_sec,ease:"linear"}})}),S.jsx(We.div,{initial:{scale:.5,rotate:-180},animate:{scale:1,rotate:0},transition:{duration:.8,type:"spring"},className:"absolute inset-0 w-full h-full z-10 flex items-center justify-center",children:p.image?S.jsx("img",{src:p.image,alt:p.name,className:"w-full h-full object-cover rounded-xl",style:{background:"transparent",maxHeight:"340px"}}):S.jsx("span",{className:"text-white text-6xl sm:text-8xl",children:"🧘‍♀️"})},p.name),S.jsxs("div",{className:"absolute bottom-4 left-4 bg-black/60 backdrop-blur-sm rounded-lg px-4 py-2 z-30 flex items-center",children:[S.jsx("svg",{className:"w-6 h-6 mr-2 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:S.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 8v4l3 2m6-2a10 10 0 11-20 0 10 10 0 0120 0z"})}),S.jsx("div",{className:"text-white text-xl font-bold",children:x(o)})]})]}),S.jsxs("div",{className:"p-4 sm:p-6",children:[S.jsx("div",{className:"flex justify-center mb-6",children:S.jsxs("div",{className:"flex gap-2",children:[S.jsx(lt,{onClick:m,className:"gradient-bg text-white w-16 h-16 rounded-full",children:l?S.jsx(ate,{className:"w-6 h-6"}):S.jsx(fW,{className:"w-6 h-6"})}),S.jsx(lt,{onClick:g,disabled:r>=n.poses.length-1,variant:"outline",className:"w-16 h-16 rounded-full",children:S.jsx(lte,{className:"w-6 h-6"})}),S.jsx(lt,{onClick:y,variant:"outline",className:"w-16 h-16 rounded-full",children:S.jsx(VP,{className:"w-6 h-6"})})]})}),S.jsx("div",{className:"w-full bg-wellness-100 rounded-full h-2 mb-4",children:S.jsx(We.div,{className:"gradient-bg h-2 rounded-full",initial:{width:0},animate:{width:`${(r+1)/n.poses.length*100}%`},transition:{duration:.3}})}),S.jsxs("p",{className:"text-center text-wellness-600",children:["Pose ",r+1," of ",n.poses.length]})]})]})})}),S.jsx(We.div,{initial:{opacity:0,x:50},animate:{opacity:1,x:0},transition:{duration:.6},children:S.jsxs("div",{className:"space-y-6",children:[S.jsxs("div",{children:[S.jsx("h1",{className:"font-poppins font-bold text-4xl mb-4 gradient-text",children:p.name}),S.jsxs("p",{className:"text-xl text-wellness-600 mb-6",children:[p.sanskrit_name," - ",p.benefits]})]}),S.jsx(Qn,{className:"bg-white shadow-lg border-none",children:S.jsxs(Jn,{className:"p-6",children:[S.jsxs("h3",{className:"font-bold text-xl mb-4 flex items-center",children:[S.jsx(pW,{className:"w-5 h-5 mr-2 text-primary-500"}),"Instructions"]}),S.jsx("ul",{className:"space-y-2",children:(b=p.instructions)==null?void 0:b.map((k,C)=>S.jsxs(We.li,{className:"flex items-start",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:C*.1},children:[S.jsx("span",{className:"w-6 h-6 bg-gradient-to-r from-primary-400 to-secondary-400 text-white rounded-full flex items-center justify-center text-sm mr-3 mt-0.5",children:C+1}),S.jsx("span",{className:"text-wellness-700",children:k})]},C))}),S.jsx("div",{className:"flex justify-center mt-4",children:S.jsx(lt,{onClick:()=>{if(h)window.speechSynthesis.cancel(),f(!1);else if(window.speechSynthesis.cancel(),Array.isArray(p.instructions)&&p.instructions.length>0){let k=0;f(!0);const C=()=>{if(!Array.isArray(p.instructions)||k>=p.instructions.length){f(!1);return}const N=new window.SpeechSynthesisUtterance(p.instructions[k]);N.rate=.8,N.onend=()=>{setTimeout(()=>{k++,C()},700)},N.onerror=()=>{f(!1)},window.speechSynthesis.speak(N)};C()}},variant:"outline",className:"px-6 py-2",children:h?"Stop":"Read Instructions Aloud"})})]})}),S.jsx(Qn,{className:"bg-white shadow-lg border-none",children:S.jsxs(Jn,{className:"p-6",children:[S.jsxs("h3",{className:"font-bold text-xl mb-4 flex items-center",children:[S.jsx("span",{className:"text-primary-500 mr-2",children:"✨"}),"Benefits"]}),S.jsx("div",{className:"grid grid-cols-1 gap-2",children:p.benefits.split(", ").map((k,C)=>S.jsxs(We.div,{className:"flex items-center",initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{delay:C*.1},children:[S.jsx("div",{className:"w-2 h-2 bg-gradient-to-r from-primary-400 to-secondary-400 rounded-full mr-3"}),S.jsx("span",{className:"text-wellness-700",children:k})]},C))})]})}),S.jsx(Qn,{className:"bg-white shadow-lg border-none",children:S.jsxs(Jn,{className:"p-6",children:[S.jsxs("h3",{className:"font-bold text-xl mb-4 flex items-center",children:[S.jsx("span",{className:"text-red-500 mr-2",children:"⚠️"}),"Precautions"]}),S.jsx("div",{className:"text-wellness-700",children:p.precautions||"No specific precautions."})]})}),S.jsx(Qn,{className:"bg-white shadow-lg border-none",children:S.jsxs(Jn,{className:"p-6",children:[S.jsxs("h3",{className:"font-bold text-xl mb-4 flex items-center",children:[S.jsx("span",{className:"text-yellow-500 mr-2",children:"⚙️"}),"Modifications"]}),S.jsx("div",{className:"text-wellness-700",children:p.modifications||"No specific modifications."})]})}),(p.image||p.youtube_link)&&S.jsx(Qn,{className:"bg-white shadow-lg border-none",children:S.jsxs(Jn,{className:"p-6",children:[S.jsxs("h3",{className:"font-bold text-xl mb-4 flex items-center",children:[S.jsx("span",{className:"text-primary-500 mr-2",children:"📹"}),"Media"]}),S.jsxs("div",{className:"flex gap-4",children:[p.image&&S.jsx("img",{src:p.image,alt:p.name,className:"w-full h-auto rounded-lg shadow-md"}),p.youtube_link&&S.jsxs("a",{href:p.youtube_link,target:"_blank",rel:"noopener noreferrer",className:"flex-1 bg-primary-500 text-white rounded-lg shadow-md px-4 py-2 flex items-center justify-center gap-2",children:[S.jsx("span",{children:"Watch on YouTube"}),S.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:S.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.875 18.825A4.125 4.125 0 119 14.625M15.75 9.75l-3.375 3.375L15.75 16.5M21 12H3"})})]})]})]})})]})},p.name)]})})})]})}const iue={beginner:"bg-secondary-400",intermediate:"bg-orange-500",advanced:"bg-red-500"};function oue(){const[,t]=ti(),{slug:e}=y4(),{data:n=[],isLoading:s}=Zu({queryKey:["/api/poses"]}),r=n.find(o=>o.name.toLowerCase().replace(/\s+/g,"-").replace(/[^a-z0-9-]/g,"")===e);if(s)return S.jsxs("div",{className:"min-h-screen bg-wellness-50",children:[S.jsx(il,{}),S.jsx("div",{className:"pt-24 pb-20",children:S.jsxs("div",{className:"max-w-4xl mx-auto px-6",children:[S.jsx(jr,{className:"h-8 w-32 mb-6"}),S.jsxs("div",{className:"grid md:grid-cols-2 gap-8",children:[S.jsx(jr,{className:"h-96 w-full rounded-2xl"}),S.jsxs("div",{className:"space-y-4",children:[S.jsx(jr,{className:"h-12 w-3/4"}),S.jsx(jr,{className:"h-6 w-1/2"}),S.jsx(jr,{className:"h-24 w-full"})]})]})]})})]});if(!r)return S.jsxs("div",{className:"min-h-screen bg-wellness-50",children:[S.jsx(il,{}),S.jsx("div",{className:"pt-24 pb-20",children:S.jsxs("div",{className:"max-w-4xl mx-auto px-6 text-center",children:[S.jsx("h1",{className:"text-2xl font-bold text-wellness-800 mb-4",children:"Pose Not Found"}),S.jsxs(lt,{onClick:()=>t("/poses"),className:"gradient-bg text-white",children:[S.jsx(zP,{className:"w-4 h-4 mr-2"}),"Back to Poses"]})]})})]});const i=o=>{const a=Math.floor(o/60),l=o%60;return a>0?`${a}:${l.toString().padStart(2,"0")}`:`${l}s`};return S.jsxs("div",{className:"min-h-screen bg-wellness-50",children:[S.jsx(il,{}),S.jsx("div",{className:"pt-24 pb-20",children:S.jsxs("div",{className:"max-w-6xl mx-auto px-6",children:[S.jsxs(lt,{variant:"ghost",onClick:()=>t("/poses"),className:"mb-6 text-wellness-600 hover:text-primary-600",children:[S.jsx(zP,{className:"w-4 h-4 mr-2"}),"Back to Poses"]}),S.jsxs("div",{className:"grid lg:grid-cols-2 gap-12 mb-12",children:[S.jsx("div",{className:"space-y-6",children:S.jsxs("div",{className:"relative overflow-hidden rounded-2xl shadow-lg",children:[S.jsx("img",{src:r.image||"https://images.unsplash.com/photo-1599901860904-17e6ed7083a0?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&h=400",alt:r.name,className:"w-full h-96 object-cover"}),S.jsx("div",{className:"absolute top-4 right-4",children:S.jsx(_v,{className:`${iue[r.difficulty]} text-white shadow-lg`,children:r.difficulty})})]})}),S.jsxs("div",{className:"space-y-6",children:[S.jsxs("div",{children:[S.jsx("h1",{className:"font-poppins font-bold text-4xl text-wellness-800 mb-2",children:r.name}),S.jsx("p",{className:"text-primary-600 text-lg italic mb-4",children:r.sanskrit_name}),S.jsx("p",{className:"text-wellness-600 text-lg leading-relaxed",children:r.benefits})]}),S.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[S.jsx(Qn,{className:"bg-white border-none shadow-sm",children:S.jsxs(Jn,{className:"p-4 text-center",children:[S.jsx(dW,{className:"w-5 h-5 text-primary-500 mx-auto mb-2"}),S.jsx("p",{className:"text-sm text-wellness-600",children:"Duration"}),S.jsx("p",{className:"font-semibold text-wellness-800",children:i(r.duration_sec)})]})}),S.jsx(Qn,{className:"bg-white border-none shadow-sm",children:S.jsxs(Jn,{className:"p-4 text-center",children:[S.jsx(mte,{className:"w-5 h-5 text-primary-500 mx-auto mb-2"}),S.jsx("p",{className:"text-sm text-wellness-600",children:"Age Range"}),S.jsxs("p",{className:"font-semibold text-wellness-800",children:[r.min_age,"-",r.max_age]})]})}),S.jsx(Qn,{className:"bg-white border-none shadow-sm",children:S.jsxs(Jn,{className:"p-4 text-center",children:[S.jsx(ste,{className:"w-5 h-5 text-primary-500 mx-auto mb-2"}),S.jsx("p",{className:"text-sm text-wellness-600",children:"Category"}),S.jsx("p",{className:"font-semibold text-wellness-800",children:r.goal_category})]})})]})]})]}),S.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[r.instructions&&S.jsx(Qn,{className:"bg-white border-none shadow-lg",children:S.jsxs(Jn,{className:"p-6",children:[S.jsxs("div",{className:"flex items-center mb-4",children:[S.jsx("div",{className:"w-8 h-8 bg-primary-100 rounded-lg flex items-center justify-center mr-3",children:S.jsx(jP,{className:"w-4 h-4 text-primary-600"})}),S.jsx("h3",{className:"font-semibold text-lg text-wellness-800",children:"Instructions"})]}),S.jsx("p",{className:"text-wellness-600 leading-relaxed",children:r.instructions})]})}),r.precautions&&S.jsx(Qn,{className:"bg-white border-none shadow-lg",children:S.jsxs(Jn,{className:"p-6",children:[S.jsxs("div",{className:"flex items-center mb-4",children:[S.jsx("div",{className:"w-8 h-8 bg-red-100 rounded-lg flex items-center justify-center mr-3",children:S.jsx(fte,{className:"w-4 h-4 text-red-600"})}),S.jsx("h3",{className:"font-semibold text-lg text-wellness-800",children:"Precautions"})]}),S.jsx("p",{className:"text-wellness-600 leading-relaxed",children:r.precautions})]})}),r.modifications&&S.jsx(Qn,{className:"bg-white border-none shadow-lg",children:S.jsxs(Jn,{className:"p-6",children:[S.jsxs("div",{className:"flex items-center mb-4",children:[S.jsx("div",{className:"w-8 h-8 bg-secondary-100 rounded-lg flex items-center justify-center mr-3",children:S.jsx(jP,{className:"w-4 h-4 text-secondary-600"})}),S.jsx("h3",{className:"font-semibold text-lg text-wellness-800",children:"Modifications"})]}),S.jsx("p",{className:"text-wellness-600 leading-relaxed",children:r.modifications})]})})]}),S.jsx("div",{className:"text-center mt-12",children:S.jsxs("div",{className:"bg-gradient-to-r from-primary-50 to-secondary-50 rounded-2xl p-8 max-w-2xl mx-auto",children:[S.jsx("h3",{className:"font-poppins font-bold text-2xl mb-4",children:"Ready to practice this pose?"}),S.jsx("p",{className:"text-wellness-600 mb-6",children:"Get personalized routines that include poses perfect for your level and goals."}),S.jsxs("div",{className:"flex gap-4 justify-center",children:[S.jsx(lt,{onClick:()=>t("/assessment"),className:"gradient-bg text-white px-6 py-3 font-semibold hover:shadow-xl transform hover:scale-105 transition-all",children:"Start Assessment"}),S.jsx(lt,{onClick:()=>t("/poses"),variant:"outline",className:"px-6 py-3 border-primary-500 text-primary-600 hover:bg-primary-50",children:"Browse More Poses"})]})]})})]})})]})}const aa=D.forwardRef(({className:t,type:e,...n},s)=>S.jsx("input",{type:e,className:Tn("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:s,...n}));aa.displayName="Input";function aue(){const[,t]=ti(),{toast:e}=Hw(),[n,s]=D.useState({username:"",password:""}),r="http://localhost:5000/api",i=db({mutationFn:async l=>{const c=await fetch(`${r}/auth/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)});if(!c.ok){const u=await c.json();throw new Error(u.message||"Login failed")}return c.json()},onSuccess:l=>{l&&l.user&&localStorage.setItem("user",JSON.stringify(l.user)),e({title:"Welcome back!",description:"You've successfully logged in."}),t("/")},onError:l=>{e({variant:"destructive",title:"Login failed",description:l.message||"Invalid credentials. Please try again."})}}),o=l=>{if(l.preventDefault(),!n.username||!n.password){e({variant:"destructive",title:"Missing fields",description:"Please fill in both username and password."});return}i.mutate(n)},a=(l,c)=>{s(u=>({...u,[l]:c}))};return S.jsx("div",{className:"min-h-screen bg-gradient-to-br from-purple-50 via-white to-blue-50 dark:from-purple-950 dark:via-gray-900 dark:to-blue-950 flex items-center justify-center p-4",children:S.jsxs(Qn,{className:"w-full max-w-md",children:[S.jsxs(EE,{className:"space-y-1",children:[S.jsx($E,{className:"text-2xl font-bold text-center",children:"Sign In"}),S.jsx(AE,{className:"text-center",children:"Welcome back to YogaFlow"})]}),S.jsxs(Jn,{children:[S.jsxs("form",{onSubmit:o,className:"space-y-4",children:[S.jsxs("div",{className:"space-y-2",children:[S.jsx(Ja,{htmlFor:"username",children:"Username"}),S.jsx(aa,{id:"username",type:"text",placeholder:"Enter your username",value:n.username,onChange:l=>a("username",l.target.value),required:!0})]}),S.jsxs("div",{className:"space-y-2",children:[S.jsx(Ja,{htmlFor:"password",children:"Password"}),S.jsx(aa,{id:"password",type:"password",placeholder:"Enter your password",value:n.password,onChange:l=>a("password",l.target.value),required:!0})]}),S.jsx(lt,{type:"submit",className:"w-full",disabled:i.isPending,children:i.isPending?"Signing in...":"Sign In"})]}),S.jsxs("div",{className:"mt-4 text-center text-sm",children:[S.jsx("span",{className:"text-muted-foreground",children:"Don't have an account? "}),S.jsx(lt,{variant:"link",className:"p-0 h-auto",onClick:()=>t("/signup"),children:"Sign up here"})]})]})]})})}function lue(){const[,t]=ti(),{toast:e}=Hw(),[n,s]=D.useState({username:"",email:"",password:"",confirmPassword:""}),[r,i]=D.useState(""),[o,a]=D.useState(!1),l=db({mutationFn:async f=>{const m=await fetch("http://localhost:5000/api/auth/signup/request-code",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(f)});if(!m.ok)throw await m.json();return m.json()},onSuccess:()=>{a(!0),e({title:"Verification code sent",description:"Check your email for a 6-digit code."})},onError:f=>{e({variant:"destructive",title:"Could not send code",description:(f==null?void 0:f.message)||"Please try again."})}}),c=db({mutationFn:async f=>{const m=await fetch("http://localhost:5000/api/auth/signup/verify",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(f)});if(!m.ok)throw await m.json();return m.json()},onSuccess:()=>{e({title:"Account created!",description:"You can now sign in."}),t("/login")},onError:f=>{e({variant:"destructive",title:"Verification failed",description:(f==null?void 0:f.message)||"Please try again."})}}),u=f=>{if(f.preventDefault(),!n.username||!n.email){e({variant:"destructive",title:"Missing fields",description:"Enter username and email first."});return}l.mutate({username:n.username,email:n.email})},d=f=>{if(f.preventDefault(),!n.username||!n.email||!n.password||!n.confirmPassword){e({variant:"destructive",title:"Missing fields",description:"Please fill in all required fields."});return}if(n.password!==n.confirmPassword){e({variant:"destructive",title:"Password mismatch",description:"Passwords do not match."});return}if(!r||r.length<6){e({variant:"destructive",title:"Enter your code",description:"Enter the 6-digit verification code."});return}c.mutate({username:n.username,email:n.email,password:n.password,code:r})},h=(f,p)=>{s(m=>({...m,[f]:p}))};return S.jsx("div",{className:"min-h-screen bg-gradient-to-br from-purple-50 via-white to-blue-50 dark:from-purple-950 dark:via-gray-900 dark:to-blue-950 flex items-center justify-center p-4",children:S.jsxs(Qn,{className:"w-full max-w-md",children:[S.jsxs(EE,{className:"space-y-1",children:[S.jsx($E,{className:"text-2xl font-bold text-center",children:"Create Account"}),S.jsx(AE,{className:"text-center",children:"Join YogaFlow and start your yoga journey"})]}),S.jsxs(Jn,{children:[S.jsxs("form",{className:"space-y-4",children:[S.jsxs("div",{className:"space-y-2",children:[S.jsx(Ja,{htmlFor:"username",children:"Username"}),S.jsx(aa,{id:"username",type:"text",placeholder:"Choose a username",value:n.username,onChange:f=>h("username",f.target.value),required:!0})]}),S.jsxs("div",{className:"space-y-2",children:[S.jsx(Ja,{htmlFor:"email",children:"Email"}),S.jsx(aa,{id:"email",type:"email",placeholder:"Enter your email address",value:n.email,onChange:f=>h("email",f.target.value),required:!0})]}),S.jsxs("div",{className:"space-y-2",children:[S.jsx(Ja,{htmlFor:"password",children:"Password"}),S.jsx(aa,{id:"password",type:"password",placeholder:"Create a password (min. 6 characters)",value:n.password,onChange:f=>h("password",f.target.value),required:!0})]}),S.jsxs("div",{className:"space-y-2",children:[S.jsx(Ja,{htmlFor:"confirmPassword",children:"Confirm Password"}),S.jsx(aa,{id:"confirmPassword",type:"password",placeholder:"Confirm your password",value:n.confirmPassword,onChange:f=>h("confirmPassword",f.target.value),required:!0})]}),!o&&S.jsx(lt,{onClick:u,className:"w-full",type:"button",disabled:l.isPending,children:l.isPending?"Sending code…":"Send verification code"}),o&&S.jsxs(S.Fragment,{children:[S.jsxs("div",{className:"space-y-2",children:[S.jsx(Ja,{htmlFor:"code",children:"Verification Code"}),S.jsx(aa,{id:"code",type:"text",inputMode:"numeric",placeholder:"Enter 6-digit code",value:r,onChange:f=>i(f.target.value),maxLength:6})]}),S.jsx(lt,{onClick:d,className:"w-full",type:"button",disabled:c.isPending,children:c.isPending?"Creating account…":"Verify and create account"})]})]}),S.jsxs("div",{className:"mt-4 text-center text-sm",children:[S.jsx("span",{className:"text-muted-foreground",children:"Already have an account? "}),S.jsx(lt,{variant:"link",className:"p-0 h-auto",onClick:()=>t("/login"),children:"Sign in here"})]})]})]})})}function cue(){return S.jsx("div",{className:"min-h-screen w-full flex items-center justify-center bg-gray-50",children:S.jsx(Qn,{className:"w-full max-w-md mx-4",children:S.jsxs(Jn,{className:"pt-6",children:[S.jsxs("div",{className:"flex mb-4 gap-2",children:[S.jsx(nte,{className:"h-8 w-8 text-red-500"}),S.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"404 Page Not Found"})]}),S.jsx("p",{className:"mt-4 text-sm text-gray-600",children:"Did you forget to add the page to the router?"})]})})})}/*!
 * @kurkle/color v0.3.4
 * https://github.com/kurkle/color#readme
 * (c) 2024 Jukka Kurkela
 * Released under the MIT License
 */function hy(t){return t+.5|0}const nc=(t,e,n)=>Math.max(Math.min(t,n),e);function um(t){return nc(hy(t*2.55),0,255)}function bc(t){return nc(hy(t*255),0,255)}function Ka(t){return nc(hy(t/2.55)/100,0,1)}function QL(t){return nc(hy(t*100),0,100)}const Li={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},t2=[..."0123456789ABCDEF"],uue=t=>t2[t&15],due=t=>t2[(t&240)>>4]+t2[t&15],Tx=t=>(t&240)>>4===(t&15),hue=t=>Tx(t.r)&&Tx(t.g)&&Tx(t.b)&&Tx(t.a);function fue(t){var e=t.length,n;return t[0]==="#"&&(e===4||e===5?n={r:255&Li[t[1]]*17,g:255&Li[t[2]]*17,b:255&Li[t[3]]*17,a:e===5?Li[t[4]]*17:255}:(e===7||e===9)&&(n={r:Li[t[1]]<<4|Li[t[2]],g:Li[t[3]]<<4|Li[t[4]],b:Li[t[5]]<<4|Li[t[6]],a:e===9?Li[t[7]]<<4|Li[t[8]]:255})),n}const pue=(t,e)=>t<255?e(t):"";function mue(t){var e=hue(t)?uue:due;return t?"#"+e(t.r)+e(t.g)+e(t.b)+pue(t.a,e):void 0}const gue=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function hH(t,e,n){const s=e*Math.min(n,1-n),r=(i,o=(i+t/30)%12)=>n-s*Math.max(Math.min(o-3,9-o,1),-1);return[r(0),r(8),r(4)]}function yue(t,e,n){const s=(r,i=(r+t/60)%6)=>n-n*e*Math.max(Math.min(i,4-i,1),0);return[s(5),s(3),s(1)]}function xue(t,e,n){const s=hH(t,1,.5);let r;for(e+n>1&&(r=1/(e+n),e*=r,n*=r),r=0;r<3;r++)s[r]*=1-e-n,s[r]+=e;return s}function vue(t,e,n,s,r){return t===r?(e-n)/s+(e<n?6:0):e===r?(n-t)/s+2:(t-e)/s+4}function BE(t){const n=t.r/255,s=t.g/255,r=t.b/255,i=Math.max(n,s,r),o=Math.min(n,s,r),a=(i+o)/2;let l,c,u;return i!==o&&(u=i-o,c=a>.5?u/(2-i-o):u/(i+o),l=vue(n,s,r,u,i),l=l*60+.5),[l|0,c||0,a]}function WE(t,e,n,s){return(Array.isArray(e)?t(e[0],e[1],e[2]):t(e,n,s)).map(bc)}function UE(t,e,n){return WE(hH,t,e,n)}function bue(t,e,n){return WE(xue,t,e,n)}function wue(t,e,n){return WE(yue,t,e,n)}function fH(t){return(t%360+360)%360}function Sue(t){const e=gue.exec(t);let n=255,s;if(!e)return;e[5]!==s&&(n=e[6]?um(+e[5]):bc(+e[5]));const r=fH(+e[2]),i=+e[3]/100,o=+e[4]/100;return e[1]==="hwb"?s=bue(r,i,o):e[1]==="hsv"?s=wue(r,i,o):s=UE(r,i,o),{r:s[0],g:s[1],b:s[2],a:n}}function kue(t,e){var n=BE(t);n[0]=fH(n[0]+e),n=UE(n),t.r=n[0],t.g=n[1],t.b=n[2]}function Cue(t){if(!t)return;const e=BE(t),n=e[0],s=QL(e[1]),r=QL(e[2]);return t.a<255?`hsla(${n}, ${s}%, ${r}%, ${Ka(t.a)})`:`hsl(${n}, ${s}%, ${r}%)`}const JL={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},eM={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function Tue(){const t={},e=Object.keys(eM),n=Object.keys(JL);let s,r,i,o,a;for(s=0;s<e.length;s++){for(o=a=e[s],r=0;r<n.length;r++)i=n[r],a=a.replace(i,JL[i]);i=parseInt(eM[o],16),t[a]=[i>>16&255,i>>8&255,i&255]}return t}let Nx;function Nue(t){Nx||(Nx=Tue(),Nx.transparent=[0,0,0,0]);const e=Nx[t.toLowerCase()];return e&&{r:e[0],g:e[1],b:e[2],a:e.length===4?e[3]:255}}const Iue=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function _ue(t){const e=Iue.exec(t);let n=255,s,r,i;if(e){if(e[7]!==s){const o=+e[7];n=e[8]?um(o):nc(o*255,0,255)}return s=+e[1],r=+e[3],i=+e[5],s=255&(e[2]?um(s):nc(s,0,255)),r=255&(e[4]?um(r):nc(r,0,255)),i=255&(e[6]?um(i):nc(i,0,255)),{r:s,g:r,b:i,a:n}}}function Eue(t){return t&&(t.a<255?`rgba(${t.r}, ${t.g}, ${t.b}, ${Ka(t.a)})`:`rgb(${t.r}, ${t.g}, ${t.b})`)}const TC=t=>t<=.0031308?t*12.92:Math.pow(t,1/2.4)*1.055-.055,Jd=t=>t<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4);function $ue(t,e,n){const s=Jd(Ka(t.r)),r=Jd(Ka(t.g)),i=Jd(Ka(t.b));return{r:bc(TC(s+n*(Jd(Ka(e.r))-s))),g:bc(TC(r+n*(Jd(Ka(e.g))-r))),b:bc(TC(i+n*(Jd(Ka(e.b))-i))),a:t.a+n*(e.a-t.a)}}function Ix(t,e,n){if(t){let s=BE(t);s[e]=Math.max(0,Math.min(s[e]+s[e]*n,e===0?360:1)),s=UE(s),t.r=s[0],t.g=s[1],t.b=s[2]}}function pH(t,e){return t&&Object.assign(e||{},t)}function tM(t){var e={r:0,g:0,b:0,a:255};return Array.isArray(t)?t.length>=3&&(e={r:t[0],g:t[1],b:t[2],a:255},t.length>3&&(e.a=bc(t[3]))):(e=pH(t,{r:0,g:0,b:0,a:1}),e.a=bc(e.a)),e}function Aue(t){return t.charAt(0)==="r"?_ue(t):Sue(t)}class xg{constructor(e){if(e instanceof xg)return e;const n=typeof e;let s;n==="object"?s=tM(e):n==="string"&&(s=fue(e)||Nue(e)||Aue(e)),this._rgb=s,this._valid=!!s}get valid(){return this._valid}get rgb(){var e=pH(this._rgb);return e&&(e.a=Ka(e.a)),e}set rgb(e){this._rgb=tM(e)}rgbString(){return this._valid?Eue(this._rgb):void 0}hexString(){return this._valid?mue(this._rgb):void 0}hslString(){return this._valid?Cue(this._rgb):void 0}mix(e,n){if(e){const s=this.rgb,r=e.rgb;let i;const o=n===i?.5:n,a=2*o-1,l=s.a-r.a,c=((a*l===-1?a:(a+l)/(1+a*l))+1)/2;i=1-c,s.r=255&c*s.r+i*r.r+.5,s.g=255&c*s.g+i*r.g+.5,s.b=255&c*s.b+i*r.b+.5,s.a=o*s.a+(1-o)*r.a,this.rgb=s}return this}interpolate(e,n){return e&&(this._rgb=$ue(this._rgb,e._rgb,n)),this}clone(){return new xg(this.rgb)}alpha(e){return this._rgb.a=bc(e),this}clearer(e){const n=this._rgb;return n.a*=1-e,this}greyscale(){const e=this._rgb,n=hy(e.r*.3+e.g*.59+e.b*.11);return e.r=e.g=e.b=n,this}opaquer(e){const n=this._rgb;return n.a*=1+e,this}negate(){const e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}lighten(e){return Ix(this._rgb,2,e),this}darken(e){return Ix(this._rgb,2,-e),this}saturate(e){return Ix(this._rgb,1,e),this}desaturate(e){return Ix(this._rgb,1,-e),this}rotate(e){return kue(this._rgb,e),this}}/*!
 * Chart.js v4.5.0
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */function Va(){}const Rue=(()=>{let t=0;return()=>t++})();function Wt(t){return t==null}function Rn(t){if(Array.isArray&&Array.isArray(t))return!0;const e=Object.prototype.toString.call(t);return e.slice(0,7)==="[object"&&e.slice(-6)==="Array]"}function Ft(t){return t!==null&&Object.prototype.toString.call(t)==="[object Object]"}function Os(t){return(typeof t=="number"||t instanceof Number)&&isFinite(+t)}function ci(t,e){return Os(t)?t:e}function Ot(t,e){return typeof t>"u"?e:t}const Due=(t,e)=>typeof t=="string"&&t.endsWith("%")?parseFloat(t)/100:+t/e,mH=(t,e)=>typeof t=="string"&&t.endsWith("%")?parseFloat(t)/100*e:+t;function an(t,e,n){if(t&&typeof t.call=="function")return t.apply(n,e)}function Kt(t,e,n,s){let r,i,o;if(Rn(t))if(i=t.length,s)for(r=i-1;r>=0;r--)e.call(n,t[r],r);else for(r=0;r<i;r++)e.call(n,t[r],r);else if(Ft(t))for(o=Object.keys(t),i=o.length,r=0;r<i;r++)e.call(n,t[o[r]],o[r])}function Db(t,e){let n,s,r,i;if(!t||!e||t.length!==e.length)return!1;for(n=0,s=t.length;n<s;++n)if(r=t[n],i=e[n],r.datasetIndex!==i.datasetIndex||r.index!==i.index)return!1;return!0}function Ob(t){if(Rn(t))return t.map(Ob);if(Ft(t)){const e=Object.create(null),n=Object.keys(t),s=n.length;let r=0;for(;r<s;++r)e[n[r]]=Ob(t[n[r]]);return e}return t}function gH(t){return["__proto__","prototype","constructor"].indexOf(t)===-1}function Oue(t,e,n,s){if(!gH(t))return;const r=e[t],i=n[t];Ft(r)&&Ft(i)?vg(r,i,s):e[t]=Ob(i)}function vg(t,e,n){const s=Rn(e)?e:[e],r=s.length;if(!Ft(t))return t;n=n||{};const i=n.merger||Oue;let o;for(let a=0;a<r;++a){if(o=s[a],!Ft(o))continue;const l=Object.keys(o);for(let c=0,u=l.length;c<u;++c)i(l[c],t,o,n)}return t}function jm(t,e){return vg(t,e,{merger:Pue})}function Pue(t,e,n){if(!gH(t))return;const s=e[t],r=n[t];Ft(s)&&Ft(r)?jm(s,r):Object.prototype.hasOwnProperty.call(e,t)||(e[t]=Ob(r))}const nM={"":t=>t,x:t=>t.x,y:t=>t.y};function Fue(t){const e=t.split("."),n=[];let s="";for(const r of e)s+=r,s.endsWith("\\")?s=s.slice(0,-1)+".":(n.push(s),s="");return n}function Lue(t){const e=Fue(t);return n=>{for(const s of e){if(s==="")break;n=n&&n[s]}return n}}function gd(t,e){return(nM[e]||(nM[e]=Lue(e)))(t)}function HE(t){return t.charAt(0).toUpperCase()+t.slice(1)}const bg=t=>typeof t<"u",Lc=t=>typeof t=="function",sM=(t,e)=>{if(t.size!==e.size)return!1;for(const n of t)if(!e.has(n))return!1;return!0};function Mue(t){return t.type==="mouseup"||t.type==="click"||t.type==="contextmenu"}const tn=Math.PI,Wn=2*tn,Pb=Number.POSITIVE_INFINITY,zue=tn/180,ns=tn/2,pu=tn/4,rM=tn*2/3,sc=Math.log10,wc=Math.sign;function Ev(t,e,n){return Math.abs(t-e)<n}function iM(t){const e=Math.round(t);t=Ev(t,e,t/1e3)?e:t;const n=Math.pow(10,Math.floor(sc(t))),s=t/n;return(s<=1?1:s<=2?2:s<=5?5:10)*n}function Vue(t){const e=[],n=Math.sqrt(t);let s;for(s=1;s<n;s++)t%s===0&&(e.push(s),e.push(t/s));return n===(n|0)&&e.push(n),e.sort((r,i)=>r-i).pop(),e}function jue(t){return typeof t=="symbol"||typeof t=="object"&&t!==null&&!(Symbol.toPrimitive in t||"toString"in t||"valueOf"in t)}function Fb(t){return!jue(t)&&!isNaN(parseFloat(t))&&isFinite(t)}function Bue(t,e){const n=Math.round(t);return n-e<=t&&n+e>=t}function yH(t,e,n){let s,r,i;for(s=0,r=t.length;s<r;s++)i=t[s][n],isNaN(i)||(e.min=Math.min(e.min,i),e.max=Math.max(e.max,i))}function da(t){return t*(tn/180)}function GE(t){return t*(180/tn)}function oM(t){if(!Os(t))return;let e=1,n=0;for(;Math.round(t*e)/e!==t;)e*=10,n++;return n}function xH(t,e){const n=e.x-t.x,s=e.y-t.y,r=Math.sqrt(n*n+s*s);let i=Math.atan2(s,n);return i<-.5*tn&&(i+=Wn),{angle:i,distance:r}}function Wue(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function hi(t){return(t%Wn+Wn)%Wn}function Lb(t,e,n,s){const r=hi(t),i=hi(e),o=hi(n),a=hi(i-r),l=hi(o-r),c=hi(r-i),u=hi(r-o);return r===i||r===o||s&&i===o||a>l&&c<u}function Hr(t,e,n){return Math.max(e,Math.min(n,t))}function Uue(t){return Hr(t,-32768,32767)}function Fu(t,e,n,s=1e-6){return t>=Math.min(e,n)-s&&t<=Math.max(e,n)+s}function KE(t,e,n){n=n||(o=>t[o]<e);let s=t.length-1,r=0,i;for(;s-r>1;)i=r+s>>1,n(i)?r=i:s=i;return{lo:r,hi:s}}const n2=(t,e,n,s)=>KE(t,n,s?r=>{const i=t[r][e];return i<n||i===n&&t[r+1][e]===n}:r=>t[r][e]<n),Hue=(t,e,n)=>KE(t,n,s=>t[s][e]>=n);function Gue(t,e,n){let s=0,r=t.length;for(;s<r&&t[s]<e;)s++;for(;r>s&&t[r-1]>n;)r--;return s>0||r<t.length?t.slice(s,r):t}const vH=["push","pop","shift","splice","unshift"];function Kue(t,e){if(t._chartjs){t._chartjs.listeners.push(e);return}Object.defineProperty(t,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[e]}}),vH.forEach(n=>{const s="_onData"+HE(n),r=t[n];Object.defineProperty(t,n,{configurable:!0,enumerable:!1,value(...i){const o=r.apply(this,i);return t._chartjs.listeners.forEach(a=>{typeof a[s]=="function"&&a[s](...i)}),o}})})}function aM(t,e){const n=t._chartjs;if(!n)return;const s=n.listeners,r=s.indexOf(e);r!==-1&&s.splice(r,1),!(s.length>0)&&(vH.forEach(i=>{delete t[i]}),delete t._chartjs)}function bH(t){const e=new Set(t);return e.size===t.length?t:Array.from(e)}const wH=function(){return typeof window>"u"?function(t){return t()}:window.requestAnimationFrame}();function SH(t,e){let n=[],s=!1;return function(...r){n=r,s||(s=!0,wH.call(window,()=>{s=!1,t.apply(e,n)}))}}function que(t,e){let n;return function(...s){return e?(clearTimeout(n),n=setTimeout(t,e,s)):t.apply(this,s),e}}const kH=t=>t==="start"?"left":t==="end"?"right":"center",li=(t,e,n)=>t==="start"?e:t==="end"?n:(e+n)/2,Xue=(t,e,n,s)=>t===(s?"left":"right")?n:t==="center"?(e+n)/2:e,_x=t=>t===0||t===1,lM=(t,e,n)=>-(Math.pow(2,10*(t-=1))*Math.sin((t-e)*Wn/n)),cM=(t,e,n)=>Math.pow(2,-10*t)*Math.sin((t-e)*Wn/n)+1,Bm={linear:t=>t,easeInQuad:t=>t*t,easeOutQuad:t=>-t*(t-2),easeInOutQuad:t=>(t/=.5)<1?.5*t*t:-.5*(--t*(t-2)-1),easeInCubic:t=>t*t*t,easeOutCubic:t=>(t-=1)*t*t+1,easeInOutCubic:t=>(t/=.5)<1?.5*t*t*t:.5*((t-=2)*t*t+2),easeInQuart:t=>t*t*t*t,easeOutQuart:t=>-((t-=1)*t*t*t-1),easeInOutQuart:t=>(t/=.5)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2),easeInQuint:t=>t*t*t*t*t,easeOutQuint:t=>(t-=1)*t*t*t*t+1,easeInOutQuint:t=>(t/=.5)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2),easeInSine:t=>-Math.cos(t*ns)+1,easeOutSine:t=>Math.sin(t*ns),easeInOutSine:t=>-.5*(Math.cos(tn*t)-1),easeInExpo:t=>t===0?0:Math.pow(2,10*(t-1)),easeOutExpo:t=>t===1?1:-Math.pow(2,-10*t)+1,easeInOutExpo:t=>_x(t)?t:t<.5?.5*Math.pow(2,10*(t*2-1)):.5*(-Math.pow(2,-10*(t*2-1))+2),easeInCirc:t=>t>=1?t:-(Math.sqrt(1-t*t)-1),easeOutCirc:t=>Math.sqrt(1-(t-=1)*t),easeInOutCirc:t=>(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1),easeInElastic:t=>_x(t)?t:lM(t,.075,.3),easeOutElastic:t=>_x(t)?t:cM(t,.075,.3),easeInOutElastic(t){return _x(t)?t:t<.5?.5*lM(t*2,.1125,.45):.5+.5*cM(t*2-1,.1125,.45)},easeInBack(t){return t*t*((1.70158+1)*t-1.70158)},easeOutBack(t){return(t-=1)*t*((1.70158+1)*t+1.70158)+1},easeInOutBack(t){let e=1.70158;return(t/=.5)<1?.5*(t*t*(((e*=1.525)+1)*t-e)):.5*((t-=2)*t*(((e*=1.525)+1)*t+e)+2)},easeInBounce:t=>1-Bm.easeOutBounce(1-t),easeOutBounce(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},easeInOutBounce:t=>t<.5?Bm.easeInBounce(t*2)*.5:Bm.easeOutBounce(t*2-1)*.5+.5};function CH(t){if(t&&typeof t=="object"){const e=t.toString();return e==="[object CanvasPattern]"||e==="[object CanvasGradient]"}return!1}function uM(t){return CH(t)?t:new xg(t)}function NC(t){return CH(t)?t:new xg(t).saturate(.5).darken(.1).hexString()}const Yue=["x","y","borderWidth","radius","tension"],Zue=["color","borderColor","backgroundColor"];function Que(t){t.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),t.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:e=>e!=="onProgress"&&e!=="onComplete"&&e!=="fn"}),t.set("animations",{colors:{type:"color",properties:Zue},numbers:{type:"number",properties:Yue}}),t.describe("animations",{_fallback:"animation"}),t.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:e=>e|0}}}})}function Jue(t){t.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const dM=new Map;function ede(t,e){e=e||{};const n=t+JSON.stringify(e);let s=dM.get(n);return s||(s=new Intl.NumberFormat(t,e),dM.set(n,s)),s}function d1(t,e,n){return ede(e,n).format(t)}const TH={values(t){return Rn(t)?t:""+t},numeric(t,e,n){if(t===0)return"0";const s=this.chart.options.locale;let r,i=t;if(n.length>1){const c=Math.max(Math.abs(n[0].value),Math.abs(n[n.length-1].value));(c<1e-4||c>1e15)&&(r="scientific"),i=tde(t,n)}const o=sc(Math.abs(i)),a=isNaN(o)?1:Math.max(Math.min(-1*Math.floor(o),20),0),l={notation:r,minimumFractionDigits:a,maximumFractionDigits:a};return Object.assign(l,this.options.ticks.format),d1(t,s,l)},logarithmic(t,e,n){if(t===0)return"0";const s=n[e].significand||t/Math.pow(10,Math.floor(sc(t)));return[1,2,3,5,10,15].includes(s)||e>.8*n.length?TH.numeric.call(this,t,e,n):""}};function tde(t,e){let n=e.length>3?e[2].value-e[1].value:e[1].value-e[0].value;return Math.abs(n)>=1&&t!==Math.floor(t)&&(n=t-Math.floor(t)),n}var h1={formatters:TH};function nde(t){t.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(e,n)=>n.lineWidth,tickColor:(e,n)=>n.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:h1.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),t.route("scale.ticks","color","","color"),t.route("scale.grid","color","","borderColor"),t.route("scale.border","color","","borderColor"),t.route("scale.title","color","","color"),t.describe("scale",{_fallback:!1,_scriptable:e=>!e.startsWith("before")&&!e.startsWith("after")&&e!=="callback"&&e!=="parser",_indexable:e=>e!=="borderDash"&&e!=="tickBorderDash"&&e!=="dash"}),t.describe("scales",{_fallback:"scale"}),t.describe("scale.ticks",{_scriptable:e=>e!=="backdropPadding"&&e!=="callback",_indexable:e=>e!=="backdropPadding"})}const yd=Object.create(null),s2=Object.create(null);function Wm(t,e){if(!e)return t;const n=e.split(".");for(let s=0,r=n.length;s<r;++s){const i=n[s];t=t[i]||(t[i]=Object.create(null))}return t}function IC(t,e,n){return typeof e=="string"?vg(Wm(t,e),n):vg(Wm(t,""),e)}class sde{constructor(e,n){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=s=>s.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(s,r)=>NC(r.backgroundColor),this.hoverBorderColor=(s,r)=>NC(r.borderColor),this.hoverColor=(s,r)=>NC(r.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(e),this.apply(n)}set(e,n){return IC(this,e,n)}get(e){return Wm(this,e)}describe(e,n){return IC(s2,e,n)}override(e,n){return IC(yd,e,n)}route(e,n,s,r){const i=Wm(this,e),o=Wm(this,s),a="_"+n;Object.defineProperties(i,{[a]:{value:i[n],writable:!0},[n]:{enumerable:!0,get(){const l=this[a],c=o[r];return Ft(l)?Object.assign({},c,l):Ot(l,c)},set(l){this[a]=l}}})}apply(e){e.forEach(n=>n(this))}}var Un=new sde({_scriptable:t=>!t.startsWith("on"),_indexable:t=>t!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[Que,Jue,nde]);function rde(t){return!t||Wt(t.size)||Wt(t.family)?null:(t.style?t.style+" ":"")+(t.weight?t.weight+" ":"")+t.size+"px "+t.family}function Mb(t,e,n,s,r){let i=e[r];return i||(i=e[r]=t.measureText(r).width,n.push(r)),i>s&&(s=i),s}function ide(t,e,n,s){s=s||{};let r=s.data=s.data||{},i=s.garbageCollect=s.garbageCollect||[];s.font!==e&&(r=s.data={},i=s.garbageCollect=[],s.font=e),t.save(),t.font=e;let o=0;const a=n.length;let l,c,u,d,h;for(l=0;l<a;l++)if(d=n[l],d!=null&&!Rn(d))o=Mb(t,r,i,o,d);else if(Rn(d))for(c=0,u=d.length;c<u;c++)h=d[c],h!=null&&!Rn(h)&&(o=Mb(t,r,i,o,h));t.restore();const f=i.length/2;if(f>n.length){for(l=0;l<f;l++)delete r[i[l]];i.splice(0,f)}return o}function mu(t,e,n){const s=t.currentDevicePixelRatio,r=n!==0?Math.max(n/2,.5):0;return Math.round((e-r)*s)/s+r}function hM(t,e){!e&&!t||(e=e||t.getContext("2d"),e.save(),e.resetTransform(),e.clearRect(0,0,t.width,t.height),e.restore())}function fM(t,e,n,s){NH(t,e,n,s,null)}function NH(t,e,n,s,r){let i,o,a,l,c,u,d,h;const f=e.pointStyle,p=e.rotation,m=e.radius;let g=(p||0)*zue;if(f&&typeof f=="object"&&(i=f.toString(),i==="[object HTMLImageElement]"||i==="[object HTMLCanvasElement]")){t.save(),t.translate(n,s),t.rotate(g),t.drawImage(f,-f.width/2,-f.height/2,f.width,f.height),t.restore();return}if(!(isNaN(m)||m<=0)){switch(t.beginPath(),f){default:r?t.ellipse(n,s,r/2,m,0,0,Wn):t.arc(n,s,m,0,Wn),t.closePath();break;case"triangle":u=r?r/2:m,t.moveTo(n+Math.sin(g)*u,s-Math.cos(g)*m),g+=rM,t.lineTo(n+Math.sin(g)*u,s-Math.cos(g)*m),g+=rM,t.lineTo(n+Math.sin(g)*u,s-Math.cos(g)*m),t.closePath();break;case"rectRounded":c=m*.516,l=m-c,o=Math.cos(g+pu)*l,d=Math.cos(g+pu)*(r?r/2-c:l),a=Math.sin(g+pu)*l,h=Math.sin(g+pu)*(r?r/2-c:l),t.arc(n-d,s-a,c,g-tn,g-ns),t.arc(n+h,s-o,c,g-ns,g),t.arc(n+d,s+a,c,g,g+ns),t.arc(n-h,s+o,c,g+ns,g+tn),t.closePath();break;case"rect":if(!p){l=Math.SQRT1_2*m,u=r?r/2:l,t.rect(n-u,s-l,2*u,2*l);break}g+=pu;case"rectRot":d=Math.cos(g)*(r?r/2:m),o=Math.cos(g)*m,a=Math.sin(g)*m,h=Math.sin(g)*(r?r/2:m),t.moveTo(n-d,s-a),t.lineTo(n+h,s-o),t.lineTo(n+d,s+a),t.lineTo(n-h,s+o),t.closePath();break;case"crossRot":g+=pu;case"cross":d=Math.cos(g)*(r?r/2:m),o=Math.cos(g)*m,a=Math.sin(g)*m,h=Math.sin(g)*(r?r/2:m),t.moveTo(n-d,s-a),t.lineTo(n+d,s+a),t.moveTo(n+h,s-o),t.lineTo(n-h,s+o);break;case"star":d=Math.cos(g)*(r?r/2:m),o=Math.cos(g)*m,a=Math.sin(g)*m,h=Math.sin(g)*(r?r/2:m),t.moveTo(n-d,s-a),t.lineTo(n+d,s+a),t.moveTo(n+h,s-o),t.lineTo(n-h,s+o),g+=pu,d=Math.cos(g)*(r?r/2:m),o=Math.cos(g)*m,a=Math.sin(g)*m,h=Math.sin(g)*(r?r/2:m),t.moveTo(n-d,s-a),t.lineTo(n+d,s+a),t.moveTo(n+h,s-o),t.lineTo(n-h,s+o);break;case"line":o=r?r/2:Math.cos(g)*m,a=Math.sin(g)*m,t.moveTo(n-o,s-a),t.lineTo(n+o,s+a);break;case"dash":t.moveTo(n,s),t.lineTo(n+Math.cos(g)*(r?r/2:m),s+Math.sin(g)*m);break;case!1:t.closePath();break}t.fill(),e.borderWidth>0&&t.stroke()}}function _h(t,e,n){return n=n||.5,!e||t&&t.x>e.left-n&&t.x<e.right+n&&t.y>e.top-n&&t.y<e.bottom+n}function qE(t,e){t.save(),t.beginPath(),t.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),t.clip()}function XE(t){t.restore()}function ode(t,e){e.translation&&t.translate(e.translation[0],e.translation[1]),Wt(e.rotation)||t.rotate(e.rotation),e.color&&(t.fillStyle=e.color),e.textAlign&&(t.textAlign=e.textAlign),e.textBaseline&&(t.textBaseline=e.textBaseline)}function ade(t,e,n,s,r){if(r.strikethrough||r.underline){const i=t.measureText(s),o=e-i.actualBoundingBoxLeft,a=e+i.actualBoundingBoxRight,l=n-i.actualBoundingBoxAscent,c=n+i.actualBoundingBoxDescent,u=r.strikethrough?(l+c)/2:c;t.strokeStyle=t.fillStyle,t.beginPath(),t.lineWidth=r.decorationWidth||2,t.moveTo(o,u),t.lineTo(a,u),t.stroke()}}function lde(t,e){const n=t.fillStyle;t.fillStyle=e.color,t.fillRect(e.left,e.top,e.width,e.height),t.fillStyle=n}function Nf(t,e,n,s,r,i={}){const o=Rn(e)?e:[e],a=i.strokeWidth>0&&i.strokeColor!=="";let l,c;for(t.save(),t.font=r.string,ode(t,i),l=0;l<o.length;++l)c=o[l],i.backdrop&&lde(t,i.backdrop),a&&(i.strokeColor&&(t.strokeStyle=i.strokeColor),Wt(i.strokeWidth)||(t.lineWidth=i.strokeWidth),t.strokeText(c,n,s,i.maxWidth)),t.fillText(c,n,s,i.maxWidth),ade(t,n,s,c,i),s+=Number(r.lineHeight);t.restore()}function wg(t,e){const{x:n,y:s,w:r,h:i,radius:o}=e;t.arc(n+o.topLeft,s+o.topLeft,o.topLeft,1.5*tn,tn,!0),t.lineTo(n,s+i-o.bottomLeft),t.arc(n+o.bottomLeft,s+i-o.bottomLeft,o.bottomLeft,tn,ns,!0),t.lineTo(n+r-o.bottomRight,s+i),t.arc(n+r-o.bottomRight,s+i-o.bottomRight,o.bottomRight,ns,0,!0),t.lineTo(n+r,s+o.topRight),t.arc(n+r-o.topRight,s+o.topRight,o.topRight,0,-ns,!0),t.lineTo(n+o.topLeft,s)}const cde=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,ude=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function dde(t,e){const n=(""+t).match(cde);if(!n||n[1]==="normal")return e*1.2;switch(t=+n[2],n[3]){case"px":return t;case"%":t/=100;break}return e*t}const hde=t=>+t||0;function YE(t,e){const n={},s=Ft(e),r=s?Object.keys(e):e,i=Ft(t)?s?o=>Ot(t[o],t[e[o]]):o=>t[o]:()=>t;for(const o of r)n[o]=hde(i(o));return n}function IH(t){return YE(t,{top:"y",right:"x",bottom:"y",left:"x"})}function Ju(t){return YE(t,["topLeft","topRight","bottomLeft","bottomRight"])}function Cr(t){const e=IH(t);return e.width=e.left+e.right,e.height=e.top+e.bottom,e}function Gs(t,e){t=t||{},e=e||Un.font;let n=Ot(t.size,e.size);typeof n=="string"&&(n=parseInt(n,10));let s=Ot(t.style,e.style);s&&!(""+s).match(ude)&&(console.warn('Invalid font style specified: "'+s+'"'),s=void 0);const r={family:Ot(t.family,e.family),lineHeight:dde(Ot(t.lineHeight,e.lineHeight),n),size:n,style:s,weight:Ot(t.weight,e.weight),string:""};return r.string=rde(r),r}function Ex(t,e,n,s){let r=!0,i,o,a;for(i=0,o=t.length;i<o;++i)if(a=t[i],a!==void 0&&(e!==void 0&&typeof a=="function"&&(a=a(e),r=!1),n!==void 0&&Rn(a)&&(a=a[n%a.length],r=!1),a!==void 0))return s&&!r&&(s.cacheable=!1),a}function fde(t,e,n){const{min:s,max:r}=t,i=mH(e,(r-s)/2),o=(a,l)=>n&&a===0?0:a+l;return{min:o(s,-Math.abs(i)),max:o(r,i)}}function Rd(t,e){return Object.assign(Object.create(t),e)}function ZE(t,e=[""],n,s,r=()=>t[0]){const i=n||t;typeof s>"u"&&(s=AH("_fallback",t));const o={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:t,_rootScopes:i,_fallback:s,_getTarget:r,override:a=>ZE([a,...t],e,i,s)};return new Proxy(o,{deleteProperty(a,l){return delete a[l],delete a._keys,delete t[0][l],!0},get(a,l){return EH(a,l,()=>wde(l,e,t,a))},getOwnPropertyDescriptor(a,l){return Reflect.getOwnPropertyDescriptor(a._scopes[0],l)},getPrototypeOf(){return Reflect.getPrototypeOf(t[0])},has(a,l){return mM(a).includes(l)},ownKeys(a){return mM(a)},set(a,l,c){const u=a._storage||(a._storage=r());return a[l]=u[l]=c,delete a._keys,!0}})}function If(t,e,n,s){const r={_cacheable:!1,_proxy:t,_context:e,_subProxy:n,_stack:new Set,_descriptors:_H(t,s),setContext:i=>If(t,i,n,s),override:i=>If(t.override(i),e,n,s)};return new Proxy(r,{deleteProperty(i,o){return delete i[o],delete t[o],!0},get(i,o,a){return EH(i,o,()=>mde(i,o,a))},getOwnPropertyDescriptor(i,o){return i._descriptors.allKeys?Reflect.has(t,o)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(t,o)},getPrototypeOf(){return Reflect.getPrototypeOf(t)},has(i,o){return Reflect.has(t,o)},ownKeys(){return Reflect.ownKeys(t)},set(i,o,a){return t[o]=a,delete i[o],!0}})}function _H(t,e={scriptable:!0,indexable:!0}){const{_scriptable:n=e.scriptable,_indexable:s=e.indexable,_allKeys:r=e.allKeys}=t;return{allKeys:r,scriptable:n,indexable:s,isScriptable:Lc(n)?n:()=>n,isIndexable:Lc(s)?s:()=>s}}const pde=(t,e)=>t?t+HE(e):e,QE=(t,e)=>Ft(e)&&t!=="adapters"&&(Object.getPrototypeOf(e)===null||e.constructor===Object);function EH(t,e,n){if(Object.prototype.hasOwnProperty.call(t,e)||e==="constructor")return t[e];const s=n();return t[e]=s,s}function mde(t,e,n){const{_proxy:s,_context:r,_subProxy:i,_descriptors:o}=t;let a=s[e];return Lc(a)&&o.isScriptable(e)&&(a=gde(e,a,t,n)),Rn(a)&&a.length&&(a=yde(e,a,t,o.isIndexable)),QE(e,a)&&(a=If(a,r,i&&i[e],o)),a}function gde(t,e,n,s){const{_proxy:r,_context:i,_subProxy:o,_stack:a}=n;if(a.has(t))throw new Error("Recursion detected: "+Array.from(a).join("->")+"->"+t);a.add(t);let l=e(i,o||s);return a.delete(t),QE(t,l)&&(l=JE(r._scopes,r,t,l)),l}function yde(t,e,n,s){const{_proxy:r,_context:i,_subProxy:o,_descriptors:a}=n;if(typeof i.index<"u"&&s(t))return e[i.index%e.length];if(Ft(e[0])){const l=e,c=r._scopes.filter(u=>u!==l);e=[];for(const u of l){const d=JE(c,r,t,u);e.push(If(d,i,o&&o[t],a))}}return e}function $H(t,e,n){return Lc(t)?t(e,n):t}const xde=(t,e)=>t===!0?e:typeof t=="string"?gd(e,t):void 0;function vde(t,e,n,s,r){for(const i of e){const o=xde(n,i);if(o){t.add(o);const a=$H(o._fallback,n,r);if(typeof a<"u"&&a!==n&&a!==s)return a}else if(o===!1&&typeof s<"u"&&n!==s)return null}return!1}function JE(t,e,n,s){const r=e._rootScopes,i=$H(e._fallback,n,s),o=[...t,...r],a=new Set;a.add(s);let l=pM(a,o,n,i||n,s);return l===null||typeof i<"u"&&i!==n&&(l=pM(a,o,i,l,s),l===null)?!1:ZE(Array.from(a),[""],r,i,()=>bde(e,n,s))}function pM(t,e,n,s,r){for(;n;)n=vde(t,e,n,s,r);return n}function bde(t,e,n){const s=t._getTarget();e in s||(s[e]={});const r=s[e];return Rn(r)&&Ft(n)?n:r||{}}function wde(t,e,n,s){let r;for(const i of e)if(r=AH(pde(i,t),n),typeof r<"u")return QE(t,r)?JE(n,s,t,r):r}function AH(t,e){for(const n of e){if(!n)continue;const s=n[t];if(typeof s<"u")return s}}function mM(t){let e=t._keys;return e||(e=t._keys=Sde(t._scopes)),e}function Sde(t){const e=new Set;for(const n of t)for(const s of Object.keys(n).filter(r=>!r.startsWith("_")))e.add(s);return Array.from(e)}function e$(){return typeof window<"u"&&typeof document<"u"}function t$(t){let e=t.parentNode;return e&&e.toString()==="[object ShadowRoot]"&&(e=e.host),e}function zb(t,e,n){let s;return typeof t=="string"?(s=parseInt(t,10),t.indexOf("%")!==-1&&(s=s/100*e.parentNode[n])):s=t,s}const f1=t=>t.ownerDocument.defaultView.getComputedStyle(t,null);function kde(t,e){return f1(t).getPropertyValue(e)}const Cde=["top","right","bottom","left"];function ed(t,e,n){const s={};n=n?"-"+n:"";for(let r=0;r<4;r++){const i=Cde[r];s[i]=parseFloat(t[e+"-"+i+n])||0}return s.width=s.left+s.right,s.height=s.top+s.bottom,s}const Tde=(t,e,n)=>(t>0||e>0)&&(!n||!n.shadowRoot);function Nde(t,e){const n=t.touches,s=n&&n.length?n[0]:t,{offsetX:r,offsetY:i}=s;let o=!1,a,l;if(Tde(r,i,t.target))a=r,l=i;else{const c=e.getBoundingClientRect();a=s.clientX-c.left,l=s.clientY-c.top,o=!0}return{x:a,y:l,box:o}}function Nu(t,e){if("native"in t)return t;const{canvas:n,currentDevicePixelRatio:s}=e,r=f1(n),i=r.boxSizing==="border-box",o=ed(r,"padding"),a=ed(r,"border","width"),{x:l,y:c,box:u}=Nde(t,n),d=o.left+(u&&a.left),h=o.top+(u&&a.top);let{width:f,height:p}=e;return i&&(f-=o.width+a.width,p-=o.height+a.height),{x:Math.round((l-d)/f*n.width/s),y:Math.round((c-h)/p*n.height/s)}}function Ide(t,e,n){let s,r;if(e===void 0||n===void 0){const i=t&&t$(t);if(!i)e=t.clientWidth,n=t.clientHeight;else{const o=i.getBoundingClientRect(),a=f1(i),l=ed(a,"border","width"),c=ed(a,"padding");e=o.width-c.width-l.width,n=o.height-c.height-l.height,s=zb(a.maxWidth,i,"clientWidth"),r=zb(a.maxHeight,i,"clientHeight")}}return{width:e,height:n,maxWidth:s||Pb,maxHeight:r||Pb}}const $x=t=>Math.round(t*10)/10;function _de(t,e,n,s){const r=f1(t),i=ed(r,"margin"),o=zb(r.maxWidth,t,"clientWidth")||Pb,a=zb(r.maxHeight,t,"clientHeight")||Pb,l=Ide(t,e,n);let{width:c,height:u}=l;if(r.boxSizing==="content-box"){const h=ed(r,"border","width"),f=ed(r,"padding");c-=f.width+h.width,u-=f.height+h.height}return c=Math.max(0,c-i.width),u=Math.max(0,s?c/s:u-i.height),c=$x(Math.min(c,o,l.maxWidth)),u=$x(Math.min(u,a,l.maxHeight)),c&&!u&&(u=$x(c/2)),(e!==void 0||n!==void 0)&&s&&l.height&&u>l.height&&(u=l.height,c=$x(Math.floor(u*s))),{width:c,height:u}}function gM(t,e,n){const s=e||1,r=Math.floor(t.height*s),i=Math.floor(t.width*s);t.height=Math.floor(t.height),t.width=Math.floor(t.width);const o=t.canvas;return o.style&&(n||!o.style.height&&!o.style.width)&&(o.style.height=`${t.height}px`,o.style.width=`${t.width}px`),t.currentDevicePixelRatio!==s||o.height!==r||o.width!==i?(t.currentDevicePixelRatio=s,o.height=r,o.width=i,t.ctx.setTransform(s,0,0,s,0,0),!0):!1}const Ede=function(){let t=!1;try{const e={get passive(){return t=!0,!1}};e$()&&(window.addEventListener("test",null,e),window.removeEventListener("test",null,e))}catch{}return t}();function yM(t,e){const n=kde(t,e),s=n&&n.match(/^(\d+)(\.\d+)?px$/);return s?+s[1]:void 0}const $de=function(t,e){return{x(n){return t+t+e-n},setWidth(n){e=n},textAlign(n){return n==="center"?n:n==="right"?"left":"right"},xPlus(n,s){return n-s},leftForLtr(n,s){return n-s}}},Ade=function(){return{x(t){return t},setWidth(t){},textAlign(t){return t},xPlus(t,e){return t+e},leftForLtr(t,e){return t}}};function jh(t,e,n){return t?$de(e,n):Ade()}function RH(t,e){let n,s;(e==="ltr"||e==="rtl")&&(n=t.canvas.style,s=[n.getPropertyValue("direction"),n.getPropertyPriority("direction")],n.setProperty("direction",e,"important"),t.prevTextDirection=s)}function DH(t,e){e!==void 0&&(delete t.prevTextDirection,t.canvas.style.setProperty("direction",e[0],e[1]))}function Ax(t,e,n){return t.options.clip?t[n]:e[n]}function Rde(t,e){const{xScale:n,yScale:s}=t;return n&&s?{left:Ax(n,e,"left"),right:Ax(n,e,"right"),top:Ax(s,e,"top"),bottom:Ax(s,e,"bottom")}:e}function Dde(t,e){const n=e._clip;if(n.disabled)return!1;const s=Rde(e,t.chartArea);return{left:n.left===!1?0:s.left-(n.left===!0?0:n.left),right:n.right===!1?t.width:s.right+(n.right===!0?0:n.right),top:n.top===!1?0:s.top-(n.top===!0?0:n.top),bottom:n.bottom===!1?t.height:s.bottom+(n.bottom===!0?0:n.bottom)}}/*!
 * Chart.js v4.5.0
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */class Ode{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(e,n,s,r){const i=n.listeners[r],o=n.duration;i.forEach(a=>a({chart:e,initial:n.initial,numSteps:o,currentStep:Math.min(s-n.start,o)}))}_refresh(){this._request||(this._running=!0,this._request=wH.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(e=Date.now()){let n=0;this._charts.forEach((s,r)=>{if(!s.running||!s.items.length)return;const i=s.items;let o=i.length-1,a=!1,l;for(;o>=0;--o)l=i[o],l._active?(l._total>s.duration&&(s.duration=l._total),l.tick(e),a=!0):(i[o]=i[i.length-1],i.pop());a&&(r.draw(),this._notify(r,s,e,"progress")),i.length||(s.running=!1,this._notify(r,s,e,"complete"),s.initial=!1),n+=i.length}),this._lastDate=e,n===0&&(this._running=!1)}_getAnims(e){const n=this._charts;let s=n.get(e);return s||(s={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},n.set(e,s)),s}listen(e,n,s){this._getAnims(e).listeners[n].push(s)}add(e,n){!n||!n.length||this._getAnims(e).items.push(...n)}has(e){return this._getAnims(e).items.length>0}start(e){const n=this._charts.get(e);n&&(n.running=!0,n.start=Date.now(),n.duration=n.items.reduce((s,r)=>Math.max(s,r._duration),0),this._refresh())}running(e){if(!this._running)return!1;const n=this._charts.get(e);return!(!n||!n.running||!n.items.length)}stop(e){const n=this._charts.get(e);if(!n||!n.items.length)return;const s=n.items;let r=s.length-1;for(;r>=0;--r)s[r].cancel();n.items=[],this._notify(e,n,Date.now(),"complete")}remove(e){return this._charts.delete(e)}}var Wa=new Ode;const xM="transparent",Pde={boolean(t,e,n){return n>.5?e:t},color(t,e,n){const s=uM(t||xM),r=s.valid&&uM(e||xM);return r&&r.valid?r.mix(s,n).hexString():e},number(t,e,n){return t+(e-t)*n}};class Fde{constructor(e,n,s,r){const i=n[s];r=Ex([e.to,r,i,e.from]);const o=Ex([e.from,i,r]);this._active=!0,this._fn=e.fn||Pde[e.type||typeof o],this._easing=Bm[e.easing]||Bm.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=n,this._prop=s,this._from=o,this._to=r,this._promises=void 0}active(){return this._active}update(e,n,s){if(this._active){this._notify(!1);const r=this._target[this._prop],i=s-this._start,o=this._duration-i;this._start=s,this._duration=Math.floor(Math.max(o,e.duration)),this._total+=i,this._loop=!!e.loop,this._to=Ex([e.to,n,r,e.from]),this._from=Ex([e.from,r,n])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(e){const n=e-this._start,s=this._duration,r=this._prop,i=this._from,o=this._loop,a=this._to;let l;if(this._active=i!==a&&(o||n<s),!this._active){this._target[r]=a,this._notify(!0);return}if(n<0){this._target[r]=i;return}l=n/s%2,l=o&&l>1?2-l:l,l=this._easing(Math.min(1,Math.max(0,l))),this._target[r]=this._fn(i,a,l)}wait(){const e=this._promises||(this._promises=[]);return new Promise((n,s)=>{e.push({res:n,rej:s})})}_notify(e){const n=e?"res":"rej",s=this._promises||[];for(let r=0;r<s.length;r++)s[r][n]()}}class OH{constructor(e,n){this._chart=e,this._properties=new Map,this.configure(n)}configure(e){if(!Ft(e))return;const n=Object.keys(Un.animation),s=this._properties;Object.getOwnPropertyNames(e).forEach(r=>{const i=e[r];if(!Ft(i))return;const o={};for(const a of n)o[a]=i[a];(Rn(i.properties)&&i.properties||[r]).forEach(a=>{(a===r||!s.has(a))&&s.set(a,o)})})}_animateOptions(e,n){const s=n.options,r=Mde(e,s);if(!r)return[];const i=this._createAnimations(r,s);return s.$shared&&Lde(e.options.$animations,s).then(()=>{e.options=s},()=>{}),i}_createAnimations(e,n){const s=this._properties,r=[],i=e.$animations||(e.$animations={}),o=Object.keys(n),a=Date.now();let l;for(l=o.length-1;l>=0;--l){const c=o[l];if(c.charAt(0)==="$")continue;if(c==="options"){r.push(...this._animateOptions(e,n));continue}const u=n[c];let d=i[c];const h=s.get(c);if(d)if(h&&d.active()){d.update(h,u,a);continue}else d.cancel();if(!h||!h.duration){e[c]=u;continue}i[c]=d=new Fde(h,e,c,u),r.push(d)}return r}update(e,n){if(this._properties.size===0){Object.assign(e,n);return}const s=this._createAnimations(e,n);if(s.length)return Wa.add(this._chart,s),!0}}function Lde(t,e){const n=[],s=Object.keys(e);for(let r=0;r<s.length;r++){const i=t[s[r]];i&&i.active()&&n.push(i.wait())}return Promise.all(n)}function Mde(t,e){if(!e)return;let n=t.options;if(!n){t.options=e;return}return n.$shared&&(t.options=n=Object.assign({},n,{$shared:!1,$animations:{}})),n}function vM(t,e){const n=t&&t.options||{},s=n.reverse,r=n.min===void 0?e:0,i=n.max===void 0?e:0;return{start:s?i:r,end:s?r:i}}function zde(t,e,n){if(n===!1)return!1;const s=vM(t,n),r=vM(e,n);return{top:r.end,right:s.end,bottom:r.start,left:s.start}}function Vde(t){let e,n,s,r;return Ft(t)?(e=t.top,n=t.right,s=t.bottom,r=t.left):e=n=s=r=t,{top:e,right:n,bottom:s,left:r,disabled:t===!1}}function PH(t,e){const n=[],s=t._getSortedDatasetMetas(e);let r,i;for(r=0,i=s.length;r<i;++r)n.push(s[r].index);return n}function bM(t,e,n,s={}){const r=t.keys,i=s.mode==="single";let o,a,l,c;if(e===null)return;let u=!1;for(o=0,a=r.length;o<a;++o){if(l=+r[o],l===n){if(u=!0,s.all)continue;break}c=t.values[l],Os(c)&&(i||e===0||wc(e)===wc(c))&&(e+=c)}return!u&&!s.all?0:e}function jde(t,e){const{iScale:n,vScale:s}=e,r=n.axis==="x"?"x":"y",i=s.axis==="x"?"x":"y",o=Object.keys(t),a=new Array(o.length);let l,c,u;for(l=0,c=o.length;l<c;++l)u=o[l],a[l]={[r]:u,[i]:t[u]};return a}function _C(t,e){const n=t&&t.options.stacked;return n||n===void 0&&e.stack!==void 0}function Bde(t,e,n){return`${t.id}.${e.id}.${n.stack||n.type}`}function Wde(t){const{min:e,max:n,minDefined:s,maxDefined:r}=t.getUserBounds();return{min:s?e:Number.NEGATIVE_INFINITY,max:r?n:Number.POSITIVE_INFINITY}}function Ude(t,e,n){const s=t[e]||(t[e]={});return s[n]||(s[n]={})}function wM(t,e,n,s){for(const r of e.getMatchingVisibleMetas(s).reverse()){const i=t[r.index];if(n&&i>0||!n&&i<0)return r.index}return null}function SM(t,e){const{chart:n,_cachedMeta:s}=t,r=n._stacks||(n._stacks={}),{iScale:i,vScale:o,index:a}=s,l=i.axis,c=o.axis,u=Bde(i,o,s),d=e.length;let h;for(let f=0;f<d;++f){const p=e[f],{[l]:m,[c]:g}=p,y=p._stacks||(p._stacks={});h=y[c]=Ude(r,u,m),h[a]=g,h._top=wM(h,o,!0,s.type),h._bottom=wM(h,o,!1,s.type);const x=h._visualValues||(h._visualValues={});x[a]=g}}function EC(t,e){const n=t.scales;return Object.keys(n).filter(s=>n[s].axis===e).shift()}function Hde(t,e){return Rd(t,{active:!1,dataset:void 0,datasetIndex:e,index:e,mode:"default",type:"dataset"})}function Gde(t,e,n){return Rd(t,{active:!1,dataIndex:e,parsed:void 0,raw:void 0,element:n,index:e,mode:"default",type:"data"})}function Up(t,e){const n=t.controller.index,s=t.vScale&&t.vScale.axis;if(s){e=e||t._parsed;for(const r of e){const i=r._stacks;if(!i||i[s]===void 0||i[s][n]===void 0)return;delete i[s][n],i[s]._visualValues!==void 0&&i[s]._visualValues[n]!==void 0&&delete i[s]._visualValues[n]}}}const $C=t=>t==="reset"||t==="none",kM=(t,e)=>e?t:Object.assign({},t),Kde=(t,e,n)=>t&&!e.hidden&&e._stacked&&{keys:PH(n,!0),values:null};class Bh{constructor(e,n){this.chart=e,this._ctx=e.ctx,this.index=n,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=_C(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(e){this.index!==e&&Up(this._cachedMeta),this.index=e}linkScales(){const e=this.chart,n=this._cachedMeta,s=this.getDataset(),r=(d,h,f,p)=>d==="x"?h:d==="r"?p:f,i=n.xAxisID=Ot(s.xAxisID,EC(e,"x")),o=n.yAxisID=Ot(s.yAxisID,EC(e,"y")),a=n.rAxisID=Ot(s.rAxisID,EC(e,"r")),l=n.indexAxis,c=n.iAxisID=r(l,i,o,a),u=n.vAxisID=r(l,o,i,a);n.xScale=this.getScaleForId(i),n.yScale=this.getScaleForId(o),n.rScale=this.getScaleForId(a),n.iScale=this.getScaleForId(c),n.vScale=this.getScaleForId(u)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){const n=this._cachedMeta;return e===n.iScale?n.vScale:n.iScale}reset(){this._update("reset")}_destroy(){const e=this._cachedMeta;this._data&&aM(this._data,this),e._stacked&&Up(e)}_dataCheck(){const e=this.getDataset(),n=e.data||(e.data=[]),s=this._data;if(Ft(n)){const r=this._cachedMeta;this._data=jde(n,r)}else if(s!==n){if(s){aM(s,this);const r=this._cachedMeta;Up(r),r._parsed=[]}n&&Object.isExtensible(n)&&Kue(n,this),this._syncList=[],this._data=n}}addElements(){const e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){const n=this._cachedMeta,s=this.getDataset();let r=!1;this._dataCheck();const i=n._stacked;n._stacked=_C(n.vScale,n),n.stack!==s.stack&&(r=!0,Up(n),n.stack=s.stack),this._resyncElements(e),(r||i!==n._stacked)&&(SM(this,n._parsed),n._stacked=_C(n.vScale,n))}configure(){const e=this.chart.config,n=e.datasetScopeKeys(this._type),s=e.getOptionScopes(this.getDataset(),n,!0);this.options=e.createResolver(s,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,n){const{_cachedMeta:s,_data:r}=this,{iScale:i,_stacked:o}=s,a=i.axis;let l=e===0&&n===r.length?!0:s._sorted,c=e>0&&s._parsed[e-1],u,d,h;if(this._parsing===!1)s._parsed=r,s._sorted=!0,h=r;else{Rn(r[e])?h=this.parseArrayData(s,r,e,n):Ft(r[e])?h=this.parseObjectData(s,r,e,n):h=this.parsePrimitiveData(s,r,e,n);const f=()=>d[a]===null||c&&d[a]<c[a];for(u=0;u<n;++u)s._parsed[u+e]=d=h[u],l&&(f()&&(l=!1),c=d);s._sorted=l}o&&SM(this,h)}parsePrimitiveData(e,n,s,r){const{iScale:i,vScale:o}=e,a=i.axis,l=o.axis,c=i.getLabels(),u=i===o,d=new Array(r);let h,f,p;for(h=0,f=r;h<f;++h)p=h+s,d[h]={[a]:u||i.parse(c[p],p),[l]:o.parse(n[p],p)};return d}parseArrayData(e,n,s,r){const{xScale:i,yScale:o}=e,a=new Array(r);let l,c,u,d;for(l=0,c=r;l<c;++l)u=l+s,d=n[u],a[l]={x:i.parse(d[0],u),y:o.parse(d[1],u)};return a}parseObjectData(e,n,s,r){const{xScale:i,yScale:o}=e,{xAxisKey:a="x",yAxisKey:l="y"}=this._parsing,c=new Array(r);let u,d,h,f;for(u=0,d=r;u<d;++u)h=u+s,f=n[h],c[u]={x:i.parse(gd(f,a),h),y:o.parse(gd(f,l),h)};return c}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,n,s){const r=this.chart,i=this._cachedMeta,o=n[e.axis],a={keys:PH(r,!0),values:n._stacks[e.axis]._visualValues};return bM(a,o,i.index,{mode:s})}updateRangeFromParsed(e,n,s,r){const i=s[n.axis];let o=i===null?NaN:i;const a=r&&s._stacks[n.axis];r&&a&&(r.values=a,o=bM(r,i,this._cachedMeta.index)),e.min=Math.min(e.min,o),e.max=Math.max(e.max,o)}getMinMax(e,n){const s=this._cachedMeta,r=s._parsed,i=s._sorted&&e===s.iScale,o=r.length,a=this._getOtherScale(e),l=Kde(n,s,this.chart),c={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:u,max:d}=Wde(a);let h,f;function p(){f=r[h];const m=f[a.axis];return!Os(f[e.axis])||u>m||d<m}for(h=0;h<o&&!(!p()&&(this.updateRangeFromParsed(c,e,f,l),i));++h);if(i){for(h=o-1;h>=0;--h)if(!p()){this.updateRangeFromParsed(c,e,f,l);break}}return c}getAllParsedValues(e){const n=this._cachedMeta._parsed,s=[];let r,i,o;for(r=0,i=n.length;r<i;++r)o=n[r][e.axis],Os(o)&&s.push(o);return s}getMaxOverflow(){return!1}getLabelAndValue(e){const n=this._cachedMeta,s=n.iScale,r=n.vScale,i=this.getParsed(e);return{label:s?""+s.getLabelForValue(i[s.axis]):"",value:r?""+r.getLabelForValue(i[r.axis]):""}}_update(e){const n=this._cachedMeta;this.update(e||"default"),n._clip=Vde(Ot(this.options.clip,zde(n.xScale,n.yScale,this.getMaxOverflow())))}update(e){}draw(){const e=this._ctx,n=this.chart,s=this._cachedMeta,r=s.data||[],i=n.chartArea,o=[],a=this._drawStart||0,l=this._drawCount||r.length-a,c=this.options.drawActiveElementsOnTop;let u;for(s.dataset&&s.dataset.draw(e,i,a,l),u=a;u<a+l;++u){const d=r[u];d.hidden||(d.active&&c?o.push(d):d.draw(e,i))}for(u=0;u<o.length;++u)o[u].draw(e,i)}getStyle(e,n){const s=n?"active":"default";return e===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(s):this.resolveDataElementOptions(e||0,s)}getContext(e,n,s){const r=this.getDataset();let i;if(e>=0&&e<this._cachedMeta.data.length){const o=this._cachedMeta.data[e];i=o.$context||(o.$context=Gde(this.getContext(),e,o)),i.parsed=this.getParsed(e),i.raw=r.data[e],i.index=i.dataIndex=e}else i=this.$context||(this.$context=Hde(this.chart.getContext(),this.index)),i.dataset=r,i.index=i.datasetIndex=this.index;return i.active=!!n,i.mode=s,i}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,n){return this._resolveElementOptions(this.dataElementType.id,n,e)}_resolveElementOptions(e,n="default",s){const r=n==="active",i=this._cachedDataOpts,o=e+"-"+n,a=i[o],l=this.enableOptionSharing&&bg(s);if(a)return kM(a,l);const c=this.chart.config,u=c.datasetElementScopeKeys(this._type,e),d=r?[`${e}Hover`,"hover",e,""]:[e,""],h=c.getOptionScopes(this.getDataset(),u),f=Object.keys(Un.elements[e]),p=()=>this.getContext(s,r,n),m=c.resolveNamedOptions(h,f,p,d);return m.$shared&&(m.$shared=l,i[o]=Object.freeze(kM(m,l))),m}_resolveAnimations(e,n,s){const r=this.chart,i=this._cachedDataOpts,o=`animation-${n}`,a=i[o];if(a)return a;let l;if(r.options.animation!==!1){const u=this.chart.config,d=u.datasetAnimationScopeKeys(this._type,n),h=u.getOptionScopes(this.getDataset(),d);l=u.createResolver(h,this.getContext(e,s,n))}const c=new OH(r,l&&l.animations);return l&&l._cacheable&&(i[o]=Object.freeze(c)),c}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,n){return!n||$C(e)||this.chart._animationsDisabled}_getSharedOptions(e,n){const s=this.resolveDataElementOptions(e,n),r=this._sharedOptions,i=this.getSharedOptions(s),o=this.includeOptions(n,i)||i!==r;return this.updateSharedOptions(i,n,s),{sharedOptions:i,includeOptions:o}}updateElement(e,n,s,r){$C(r)?Object.assign(e,s):this._resolveAnimations(n,r).update(e,s)}updateSharedOptions(e,n,s){e&&!$C(n)&&this._resolveAnimations(void 0,n).update(e,s)}_setStyle(e,n,s,r){e.active=r;const i=this.getStyle(n,r);this._resolveAnimations(n,s,r).update(e,{options:!r&&this.getSharedOptions(i)||i})}removeHoverStyle(e,n,s){this._setStyle(e,s,"active",!1)}setHoverStyle(e,n,s){this._setStyle(e,s,"active",!0)}_removeDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const n=this._data,s=this._cachedMeta.data;for(const[a,l,c]of this._syncList)this[a](l,c);this._syncList=[];const r=s.length,i=n.length,o=Math.min(i,r);o&&this.parse(0,o),i>r?this._insertElements(r,i-r,e):i<r&&this._removeElements(i,r-i)}_insertElements(e,n,s=!0){const r=this._cachedMeta,i=r.data,o=e+n;let a;const l=c=>{for(c.length+=n,a=c.length-1;a>=o;a--)c[a]=c[a-n]};for(l(i),a=e;a<o;++a)i[a]=new this.dataElementType;this._parsing&&l(r._parsed),this.parse(e,n),s&&this.updateElements(i,e,n,"reset")}updateElements(e,n,s,r){}_removeElements(e,n){const s=this._cachedMeta;if(this._parsing){const r=s._parsed.splice(e,n);s._stacked&&Up(s,r)}s.data.splice(e,n)}_sync(e){if(this._parsing)this._syncList.push(e);else{const[n,s,r]=e;this[n](s,r)}this.chart._dataChanges.push([this.index,...e])}_onDataPush(){const e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,n){n&&this._sync(["_removeElements",e,n]);const s=arguments.length-2;s&&this._sync(["_insertElements",e,s])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}Je(Bh,"defaults",{}),Je(Bh,"datasetElementType",null),Je(Bh,"dataElementType",null);function qde(t,e){if(!t._cache.$bar){const n=t.getMatchingVisibleMetas(e);let s=[];for(let r=0,i=n.length;r<i;r++)s=s.concat(n[r].controller.getAllParsedValues(t));t._cache.$bar=bH(s.sort((r,i)=>r-i))}return t._cache.$bar}function Xde(t){const e=t.iScale,n=qde(e,t.type);let s=e._length,r,i,o,a;const l=()=>{o===32767||o===-32768||(bg(a)&&(s=Math.min(s,Math.abs(o-a)||s)),a=o)};for(r=0,i=n.length;r<i;++r)o=e.getPixelForValue(n[r]),l();for(a=void 0,r=0,i=e.ticks.length;r<i;++r)o=e.getPixelForTick(r),l();return s}function Yde(t,e,n,s){const r=n.barThickness;let i,o;return Wt(r)?(i=e.min*n.categoryPercentage,o=n.barPercentage):(i=r*s,o=1),{chunk:i/s,ratio:o,start:e.pixels[t]-i/2}}function Zde(t,e,n,s){const r=e.pixels,i=r[t];let o=t>0?r[t-1]:null,a=t<r.length-1?r[t+1]:null;const l=n.categoryPercentage;o===null&&(o=i-(a===null?e.end-e.start:a-i)),a===null&&(a=i+i-o);const c=i-(i-Math.min(o,a))/2*l;return{chunk:Math.abs(a-o)/2*l/s,ratio:n.barPercentage,start:c}}function Qde(t,e,n,s){const r=n.parse(t[0],s),i=n.parse(t[1],s),o=Math.min(r,i),a=Math.max(r,i);let l=o,c=a;Math.abs(o)>Math.abs(a)&&(l=a,c=o),e[n.axis]=c,e._custom={barStart:l,barEnd:c,start:r,end:i,min:o,max:a}}function FH(t,e,n,s){return Rn(t)?Qde(t,e,n,s):e[n.axis]=n.parse(t,s),e}function CM(t,e,n,s){const r=t.iScale,i=t.vScale,o=r.getLabels(),a=r===i,l=[];let c,u,d,h;for(c=n,u=n+s;c<u;++c)h=e[c],d={},d[r.axis]=a||r.parse(o[c],c),l.push(FH(h,d,i,c));return l}function AC(t){return t&&t.barStart!==void 0&&t.barEnd!==void 0}function Jde(t,e,n){return t!==0?wc(t):(e.isHorizontal()?1:-1)*(e.min>=n?1:-1)}function ehe(t){let e,n,s,r,i;return t.horizontal?(e=t.base>t.x,n="left",s="right"):(e=t.base<t.y,n="bottom",s="top"),e?(r="end",i="start"):(r="start",i="end"),{start:n,end:s,reverse:e,top:r,bottom:i}}function the(t,e,n,s){let r=e.borderSkipped;const i={};if(!r){t.borderSkipped=i;return}if(r===!0){t.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:o,end:a,reverse:l,top:c,bottom:u}=ehe(t);r==="middle"&&n&&(t.enableBorderRadius=!0,(n._top||0)===s?r=c:(n._bottom||0)===s?r=u:(i[TM(u,o,a,l)]=!0,r=c)),i[TM(r,o,a,l)]=!0,t.borderSkipped=i}function TM(t,e,n,s){return s?(t=nhe(t,e,n),t=NM(t,n,e)):t=NM(t,e,n),t}function nhe(t,e,n){return t===e?n:t===n?e:t}function NM(t,e,n){return t==="start"?e:t==="end"?n:t}function she(t,{inflateAmount:e},n){t.inflateAmount=e==="auto"?n===1?.33:0:e}class $v extends Bh{parsePrimitiveData(e,n,s,r){return CM(e,n,s,r)}parseArrayData(e,n,s,r){return CM(e,n,s,r)}parseObjectData(e,n,s,r){const{iScale:i,vScale:o}=e,{xAxisKey:a="x",yAxisKey:l="y"}=this._parsing,c=i.axis==="x"?a:l,u=o.axis==="x"?a:l,d=[];let h,f,p,m;for(h=s,f=s+r;h<f;++h)m=n[h],p={},p[i.axis]=i.parse(gd(m,c),h),d.push(FH(gd(m,u),p,o,h));return d}updateRangeFromParsed(e,n,s,r){super.updateRangeFromParsed(e,n,s,r);const i=s._custom;i&&n===this._cachedMeta.vScale&&(e.min=Math.min(e.min,i.min),e.max=Math.max(e.max,i.max))}getMaxOverflow(){return 0}getLabelAndValue(e){const n=this._cachedMeta,{iScale:s,vScale:r}=n,i=this.getParsed(e),o=i._custom,a=AC(o)?"["+o.start+", "+o.end+"]":""+r.getLabelForValue(i[r.axis]);return{label:""+s.getLabelForValue(i[s.axis]),value:a}}initialize(){this.enableOptionSharing=!0,super.initialize();const e=this._cachedMeta;e.stack=this.getDataset().stack}update(e){const n=this._cachedMeta;this.updateElements(n.data,0,n.data.length,e)}updateElements(e,n,s,r){const i=r==="reset",{index:o,_cachedMeta:{vScale:a}}=this,l=a.getBasePixel(),c=a.isHorizontal(),u=this._getRuler(),{sharedOptions:d,includeOptions:h}=this._getSharedOptions(n,r);for(let f=n;f<n+s;f++){const p=this.getParsed(f),m=i||Wt(p[a.axis])?{base:l,head:l}:this._calculateBarValuePixels(f),g=this._calculateBarIndexPixels(f,u),y=(p._stacks||{})[a.axis],x={horizontal:c,base:m.base,enableBorderRadius:!y||AC(p._custom)||o===y._top||o===y._bottom,x:c?m.head:g.center,y:c?g.center:m.head,height:c?g.size:Math.abs(m.size),width:c?Math.abs(m.size):g.size};h&&(x.options=d||this.resolveDataElementOptions(f,e[f].active?"active":r));const v=x.options||e[f].options;the(x,v,y,o),she(x,v,u.ratio),this.updateElement(e[f],f,x,r)}}_getStacks(e,n){const{iScale:s}=this._cachedMeta,r=s.getMatchingVisibleMetas(this._type).filter(u=>u.controller.options.grouped),i=s.options.stacked,o=[],a=this._cachedMeta.controller.getParsed(n),l=a&&a[s.axis],c=u=>{const d=u._parsed.find(f=>f[s.axis]===l),h=d&&d[u.vScale.axis];if(Wt(h)||isNaN(h))return!0};for(const u of r)if(!(n!==void 0&&c(u))&&((i===!1||o.indexOf(u.stack)===-1||i===void 0&&u.stack===void 0)&&o.push(u.stack),u.index===e))break;return o.length||o.push(void 0),o}_getStackCount(e){return this._getStacks(void 0,e).length}_getAxisCount(){return this._getAxis().length}getFirstScaleIdForIndexAxis(){const e=this.chart.scales,n=this.chart.options.indexAxis;return Object.keys(e).filter(s=>e[s].axis===n).shift()}_getAxis(){const e={},n=this.getFirstScaleIdForIndexAxis();for(const s of this.chart.data.datasets)e[Ot(this.chart.options.indexAxis==="x"?s.xAxisID:s.yAxisID,n)]=!0;return Object.keys(e)}_getStackIndex(e,n,s){const r=this._getStacks(e,s),i=n!==void 0?r.indexOf(n):-1;return i===-1?r.length-1:i}_getRuler(){const e=this.options,n=this._cachedMeta,s=n.iScale,r=[];let i,o;for(i=0,o=n.data.length;i<o;++i)r.push(s.getPixelForValue(this.getParsed(i)[s.axis],i));const a=e.barThickness;return{min:a||Xde(n),pixels:r,start:s._startPixel,end:s._endPixel,stackCount:this._getStackCount(),scale:s,grouped:e.grouped,ratio:a?1:e.categoryPercentage*e.barPercentage}}_calculateBarValuePixels(e){const{_cachedMeta:{vScale:n,_stacked:s,index:r},options:{base:i,minBarLength:o}}=this,a=i||0,l=this.getParsed(e),c=l._custom,u=AC(c);let d=l[n.axis],h=0,f=s?this.applyStack(n,l,s):d,p,m;f!==d&&(h=f-d,f=d),u&&(d=c.barStart,f=c.barEnd-c.barStart,d!==0&&wc(d)!==wc(c.barEnd)&&(h=0),h+=d);const g=!Wt(i)&&!u?i:h;let y=n.getPixelForValue(g);if(this.chart.getDataVisibility(e)?p=n.getPixelForValue(h+f):p=y,m=p-y,Math.abs(m)<o){m=Jde(m,n,a)*o,d===a&&(y-=m/2);const x=n.getPixelForDecimal(0),v=n.getPixelForDecimal(1),b=Math.min(x,v),k=Math.max(x,v);y=Math.max(Math.min(y,k),b),p=y+m,s&&!u&&(l._stacks[n.axis]._visualValues[r]=n.getValueForPixel(p)-n.getValueForPixel(y))}if(y===n.getPixelForValue(a)){const x=wc(m)*n.getLineWidthForValue(a)/2;y+=x,m-=x}return{size:m,base:y,head:p,center:p+m/2}}_calculateBarIndexPixels(e,n){const s=n.scale,r=this.options,i=r.skipNull,o=Ot(r.maxBarThickness,1/0);let a,l;const c=this._getAxisCount();if(n.grouped){const u=i?this._getStackCount(e):n.stackCount,d=r.barThickness==="flex"?Zde(e,n,r,u*c):Yde(e,n,r,u*c),h=this.chart.options.indexAxis==="x"?this.getDataset().xAxisID:this.getDataset().yAxisID,f=this._getAxis().indexOf(Ot(h,this.getFirstScaleIdForIndexAxis())),p=this._getStackIndex(this.index,this._cachedMeta.stack,i?e:void 0)+f;a=d.start+d.chunk*p+d.chunk/2,l=Math.min(o,d.chunk*d.ratio)}else a=s.getPixelForValue(this.getParsed(e)[s.axis],e),l=Math.min(o,n.min*n.ratio);return{base:a-l/2,head:a+l/2,center:a,size:l}}draw(){const e=this._cachedMeta,n=e.vScale,s=e.data,r=s.length;let i=0;for(;i<r;++i)this.getParsed(i)[n.axis]!==null&&!s[i].hidden&&s[i].draw(this._ctx)}}Je($v,"id","bar"),Je($v,"defaults",{datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}}),Je($v,"overrides",{scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}});function rhe(t,e,n){let s=1,r=1,i=0,o=0;if(e<Wn){const a=t,l=a+e,c=Math.cos(a),u=Math.sin(a),d=Math.cos(l),h=Math.sin(l),f=(v,b,k)=>Lb(v,a,l,!0)?1:Math.max(b,b*n,k,k*n),p=(v,b,k)=>Lb(v,a,l,!0)?-1:Math.min(b,b*n,k,k*n),m=f(0,c,d),g=f(ns,u,h),y=p(tn,c,d),x=p(tn+ns,u,h);s=(m-y)/2,r=(g-x)/2,i=-(m+y)/2,o=-(g+x)/2}return{ratioX:s,ratioY:r,offsetX:i,offsetY:o}}class dm extends Bh{constructor(e,n){super(e,n),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(e,n){const s=this.getDataset().data,r=this._cachedMeta;if(this._parsing===!1)r._parsed=s;else{let i=l=>+s[l];if(Ft(s[e])){const{key:l="value"}=this._parsing;i=c=>+gd(s[c],l)}let o,a;for(o=e,a=e+n;o<a;++o)r._parsed[o]=i(o)}}_getRotation(){return da(this.options.rotation-90)}_getCircumference(){return da(this.options.circumference)}_getRotationExtents(){let e=Wn,n=-Wn;for(let s=0;s<this.chart.data.datasets.length;++s)if(this.chart.isDatasetVisible(s)&&this.chart.getDatasetMeta(s).type===this._type){const r=this.chart.getDatasetMeta(s).controller,i=r._getRotation(),o=r._getCircumference();e=Math.min(e,i),n=Math.max(n,i+o)}return{rotation:e,circumference:n-e}}update(e){const n=this.chart,{chartArea:s}=n,r=this._cachedMeta,i=r.data,o=this.getMaxBorderWidth()+this.getMaxOffset(i)+this.options.spacing,a=Math.max((Math.min(s.width,s.height)-o)/2,0),l=Math.min(Due(this.options.cutout,a),1),c=this._getRingWeight(this.index),{circumference:u,rotation:d}=this._getRotationExtents(),{ratioX:h,ratioY:f,offsetX:p,offsetY:m}=rhe(d,u,l),g=(s.width-o)/h,y=(s.height-o)/f,x=Math.max(Math.min(g,y)/2,0),v=mH(this.options.radius,x),b=Math.max(v*l,0),k=(v-b)/this._getVisibleDatasetWeightTotal();this.offsetX=p*v,this.offsetY=m*v,r.total=this.calculateTotal(),this.outerRadius=v-k*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-k*c,0),this.updateElements(i,0,i.length,e)}_circumference(e,n){const s=this.options,r=this._cachedMeta,i=this._getCircumference();return n&&s.animation.animateRotate||!this.chart.getDataVisibility(e)||r._parsed[e]===null||r.data[e].hidden?0:this.calculateCircumference(r._parsed[e]*i/Wn)}updateElements(e,n,s,r){const i=r==="reset",o=this.chart,a=o.chartArea,c=o.options.animation,u=(a.left+a.right)/2,d=(a.top+a.bottom)/2,h=i&&c.animateScale,f=h?0:this.innerRadius,p=h?0:this.outerRadius,{sharedOptions:m,includeOptions:g}=this._getSharedOptions(n,r);let y=this._getRotation(),x;for(x=0;x<n;++x)y+=this._circumference(x,i);for(x=n;x<n+s;++x){const v=this._circumference(x,i),b=e[x],k={x:u+this.offsetX,y:d+this.offsetY,startAngle:y,endAngle:y+v,circumference:v,outerRadius:p,innerRadius:f};g&&(k.options=m||this.resolveDataElementOptions(x,b.active?"active":r)),y+=v,this.updateElement(b,x,k,r)}}calculateTotal(){const e=this._cachedMeta,n=e.data;let s=0,r;for(r=0;r<n.length;r++){const i=e._parsed[r];i!==null&&!isNaN(i)&&this.chart.getDataVisibility(r)&&!n[r].hidden&&(s+=Math.abs(i))}return s}calculateCircumference(e){const n=this._cachedMeta.total;return n>0&&!isNaN(e)?Wn*(Math.abs(e)/n):0}getLabelAndValue(e){const n=this._cachedMeta,s=this.chart,r=s.data.labels||[],i=d1(n._parsed[e],s.options.locale);return{label:r[e]||"",value:i}}getMaxBorderWidth(e){let n=0;const s=this.chart;let r,i,o,a,l;if(!e){for(r=0,i=s.data.datasets.length;r<i;++r)if(s.isDatasetVisible(r)){o=s.getDatasetMeta(r),e=o.data,a=o.controller;break}}if(!e)return 0;for(r=0,i=e.length;r<i;++r)l=a.resolveDataElementOptions(r),l.borderAlign!=="inner"&&(n=Math.max(n,l.borderWidth||0,l.hoverBorderWidth||0));return n}getMaxOffset(e){let n=0;for(let s=0,r=e.length;s<r;++s){const i=this.resolveDataElementOptions(s);n=Math.max(n,i.offset||0,i.hoverOffset||0)}return n}_getRingWeightOffset(e){let n=0;for(let s=0;s<e;++s)this.chart.isDatasetVisible(s)&&(n+=this._getRingWeight(s));return n}_getRingWeight(e){return Math.max(Ot(this.chart.data.datasets[e].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}Je(dm,"id","doughnut"),Je(dm,"defaults",{datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"}),Je(dm,"descriptors",{_scriptable:e=>e!=="spacing",_indexable:e=>e!=="spacing"&&!e.startsWith("borderDash")&&!e.startsWith("hoverBorderDash")}),Je(dm,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const n=e.data;if(n.labels.length&&n.datasets.length){const{labels:{pointStyle:s,color:r}}=e.legend.options;return n.labels.map((i,o)=>{const l=e.getDatasetMeta(0).controller.getStyle(o);return{text:i,fillStyle:l.backgroundColor,strokeStyle:l.borderColor,fontColor:r,lineWidth:l.borderWidth,pointStyle:s,hidden:!e.getDataVisibility(o),index:o}})}return[]}},onClick(e,n,s){s.chart.toggleDataVisibility(n.index),s.chart.update()}}}});class r2 extends dm{}Je(r2,"id","pie"),Je(r2,"defaults",{cutout:0,rotation:0,circumference:360,radius:"100%"});function gu(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class n${constructor(e){Je(this,"options");this.options=e||{}}static override(e){Object.assign(n$.prototype,e)}init(){}formats(){return gu()}parse(){return gu()}format(){return gu()}add(){return gu()}diff(){return gu()}startOf(){return gu()}endOf(){return gu()}}var ihe={_date:n$};function ohe(t,e,n,s){const{controller:r,data:i,_sorted:o}=t,a=r._cachedMeta.iScale,l=t.dataset&&t.dataset.options?t.dataset.options.spanGaps:null;if(a&&e===a.axis&&e!=="r"&&o&&i.length){const c=a._reversePixels?Hue:n2;if(s){if(r._sharedOptions){const u=i[0],d=typeof u.getRange=="function"&&u.getRange(e);if(d){const h=c(i,e,n-d),f=c(i,e,n+d);return{lo:h.lo,hi:f.hi}}}}else{const u=c(i,e,n);if(l){const{vScale:d}=r._cachedMeta,{_parsed:h}=t,f=h.slice(0,u.lo+1).reverse().findIndex(m=>!Wt(m[d.axis]));u.lo-=Math.max(0,f);const p=h.slice(u.hi).findIndex(m=>!Wt(m[d.axis]));u.hi+=Math.max(0,p)}return u}}return{lo:0,hi:i.length-1}}function fy(t,e,n,s,r){const i=t.getSortedVisibleDatasetMetas(),o=n[e];for(let a=0,l=i.length;a<l;++a){const{index:c,data:u}=i[a],{lo:d,hi:h}=ohe(i[a],e,o,r);for(let f=d;f<=h;++f){const p=u[f];p.skip||s(p,c,f)}}}function ahe(t){const e=t.indexOf("x")!==-1,n=t.indexOf("y")!==-1;return function(s,r){const i=e?Math.abs(s.x-r.x):0,o=n?Math.abs(s.y-r.y):0;return Math.sqrt(Math.pow(i,2)+Math.pow(o,2))}}function RC(t,e,n,s,r){const i=[];return!r&&!t.isPointInArea(e)||fy(t,n,e,function(a,l,c){!r&&!_h(a,t.chartArea,0)||a.inRange(e.x,e.y,s)&&i.push({element:a,datasetIndex:l,index:c})},!0),i}function lhe(t,e,n,s){let r=[];function i(o,a,l){const{startAngle:c,endAngle:u}=o.getProps(["startAngle","endAngle"],s),{angle:d}=xH(o,{x:e.x,y:e.y});Lb(d,c,u)&&r.push({element:o,datasetIndex:a,index:l})}return fy(t,n,e,i),r}function che(t,e,n,s,r,i){let o=[];const a=ahe(n);let l=Number.POSITIVE_INFINITY;function c(u,d,h){const f=u.inRange(e.x,e.y,r);if(s&&!f)return;const p=u.getCenterPoint(r);if(!(!!i||t.isPointInArea(p))&&!f)return;const g=a(e,p);g<l?(o=[{element:u,datasetIndex:d,index:h}],l=g):g===l&&o.push({element:u,datasetIndex:d,index:h})}return fy(t,n,e,c),o}function DC(t,e,n,s,r,i){return!i&&!t.isPointInArea(e)?[]:n==="r"&&!s?lhe(t,e,n,r):che(t,e,n,s,r,i)}function IM(t,e,n,s,r){const i=[],o=n==="x"?"inXRange":"inYRange";let a=!1;return fy(t,n,e,(l,c,u)=>{l[o]&&l[o](e[n],r)&&(i.push({element:l,datasetIndex:c,index:u}),a=a||l.inRange(e.x,e.y,r))}),s&&!a?[]:i}var uhe={evaluateInteractionItems:fy,modes:{index(t,e,n,s){const r=Nu(e,t),i=n.axis||"x",o=n.includeInvisible||!1,a=n.intersect?RC(t,r,i,s,o):DC(t,r,i,!1,s,o),l=[];return a.length?(t.getSortedVisibleDatasetMetas().forEach(c=>{const u=a[0].index,d=c.data[u];d&&!d.skip&&l.push({element:d,datasetIndex:c.index,index:u})}),l):[]},dataset(t,e,n,s){const r=Nu(e,t),i=n.axis||"xy",o=n.includeInvisible||!1;let a=n.intersect?RC(t,r,i,s,o):DC(t,r,i,!1,s,o);if(a.length>0){const l=a[0].datasetIndex,c=t.getDatasetMeta(l).data;a=[];for(let u=0;u<c.length;++u)a.push({element:c[u],datasetIndex:l,index:u})}return a},point(t,e,n,s){const r=Nu(e,t),i=n.axis||"xy",o=n.includeInvisible||!1;return RC(t,r,i,s,o)},nearest(t,e,n,s){const r=Nu(e,t),i=n.axis||"xy",o=n.includeInvisible||!1;return DC(t,r,i,n.intersect,s,o)},x(t,e,n,s){const r=Nu(e,t);return IM(t,r,"x",n.intersect,s)},y(t,e,n,s){const r=Nu(e,t);return IM(t,r,"y",n.intersect,s)}}};const LH=["left","top","right","bottom"];function Hp(t,e){return t.filter(n=>n.pos===e)}function _M(t,e){return t.filter(n=>LH.indexOf(n.pos)===-1&&n.box.axis===e)}function Gp(t,e){return t.sort((n,s)=>{const r=e?s:n,i=e?n:s;return r.weight===i.weight?r.index-i.index:r.weight-i.weight})}function dhe(t){const e=[];let n,s,r,i,o,a;for(n=0,s=(t||[]).length;n<s;++n)r=t[n],{position:i,options:{stack:o,stackWeight:a=1}}=r,e.push({index:n,box:r,pos:i,horizontal:r.isHorizontal(),weight:r.weight,stack:o&&i+o,stackWeight:a});return e}function hhe(t){const e={};for(const n of t){const{stack:s,pos:r,stackWeight:i}=n;if(!s||!LH.includes(r))continue;const o=e[s]||(e[s]={count:0,placed:0,weight:0,size:0});o.count++,o.weight+=i}return e}function fhe(t,e){const n=hhe(t),{vBoxMaxWidth:s,hBoxMaxHeight:r}=e;let i,o,a;for(i=0,o=t.length;i<o;++i){a=t[i];const{fullSize:l}=a.box,c=n[a.stack],u=c&&a.stackWeight/c.weight;a.horizontal?(a.width=u?u*s:l&&e.availableWidth,a.height=r):(a.width=s,a.height=u?u*r:l&&e.availableHeight)}return n}function phe(t){const e=dhe(t),n=Gp(e.filter(c=>c.box.fullSize),!0),s=Gp(Hp(e,"left"),!0),r=Gp(Hp(e,"right")),i=Gp(Hp(e,"top"),!0),o=Gp(Hp(e,"bottom")),a=_M(e,"x"),l=_M(e,"y");return{fullSize:n,leftAndTop:s.concat(i),rightAndBottom:r.concat(l).concat(o).concat(a),chartArea:Hp(e,"chartArea"),vertical:s.concat(r).concat(l),horizontal:i.concat(o).concat(a)}}function EM(t,e,n,s){return Math.max(t[n],e[n])+Math.max(t[s],e[s])}function MH(t,e){t.top=Math.max(t.top,e.top),t.left=Math.max(t.left,e.left),t.bottom=Math.max(t.bottom,e.bottom),t.right=Math.max(t.right,e.right)}function mhe(t,e,n,s){const{pos:r,box:i}=n,o=t.maxPadding;if(!Ft(r)){n.size&&(t[r]-=n.size);const d=s[n.stack]||{size:0,count:1};d.size=Math.max(d.size,n.horizontal?i.height:i.width),n.size=d.size/d.count,t[r]+=n.size}i.getPadding&&MH(o,i.getPadding());const a=Math.max(0,e.outerWidth-EM(o,t,"left","right")),l=Math.max(0,e.outerHeight-EM(o,t,"top","bottom")),c=a!==t.w,u=l!==t.h;return t.w=a,t.h=l,n.horizontal?{same:c,other:u}:{same:u,other:c}}function ghe(t){const e=t.maxPadding;function n(s){const r=Math.max(e[s]-t[s],0);return t[s]+=r,r}t.y+=n("top"),t.x+=n("left"),n("right"),n("bottom")}function yhe(t,e){const n=e.maxPadding;function s(r){const i={left:0,top:0,right:0,bottom:0};return r.forEach(o=>{i[o]=Math.max(e[o],n[o])}),i}return s(t?["left","right"]:["top","bottom"])}function hm(t,e,n,s){const r=[];let i,o,a,l,c,u;for(i=0,o=t.length,c=0;i<o;++i){a=t[i],l=a.box,l.update(a.width||e.w,a.height||e.h,yhe(a.horizontal,e));const{same:d,other:h}=mhe(e,n,a,s);c|=d&&r.length,u=u||h,l.fullSize||r.push(a)}return c&&hm(r,e,n,s)||u}function Rx(t,e,n,s,r){t.top=n,t.left=e,t.right=e+s,t.bottom=n+r,t.width=s,t.height=r}function $M(t,e,n,s){const r=n.padding;let{x:i,y:o}=e;for(const a of t){const l=a.box,c=s[a.stack]||{count:1,placed:0,weight:1},u=a.stackWeight/c.weight||1;if(a.horizontal){const d=e.w*u,h=c.size||l.height;bg(c.start)&&(o=c.start),l.fullSize?Rx(l,r.left,o,n.outerWidth-r.right-r.left,h):Rx(l,e.left+c.placed,o,d,h),c.start=o,c.placed+=d,o=l.bottom}else{const d=e.h*u,h=c.size||l.width;bg(c.start)&&(i=c.start),l.fullSize?Rx(l,i,r.top,h,n.outerHeight-r.bottom-r.top):Rx(l,i,e.top+c.placed,h,d),c.start=i,c.placed+=d,i=l.right}}e.x=i,e.y=o}var rc={addBox(t,e){t.boxes||(t.boxes=[]),e.fullSize=e.fullSize||!1,e.position=e.position||"top",e.weight=e.weight||0,e._layers=e._layers||function(){return[{z:0,draw(n){e.draw(n)}}]},t.boxes.push(e)},removeBox(t,e){const n=t.boxes?t.boxes.indexOf(e):-1;n!==-1&&t.boxes.splice(n,1)},configure(t,e,n){e.fullSize=n.fullSize,e.position=n.position,e.weight=n.weight},update(t,e,n,s){if(!t)return;const r=Cr(t.options.layout.padding),i=Math.max(e-r.width,0),o=Math.max(n-r.height,0),a=phe(t.boxes),l=a.vertical,c=a.horizontal;Kt(t.boxes,m=>{typeof m.beforeLayout=="function"&&m.beforeLayout()});const u=l.reduce((m,g)=>g.box.options&&g.box.options.display===!1?m:m+1,0)||1,d=Object.freeze({outerWidth:e,outerHeight:n,padding:r,availableWidth:i,availableHeight:o,vBoxMaxWidth:i/2/u,hBoxMaxHeight:o/2}),h=Object.assign({},r);MH(h,Cr(s));const f=Object.assign({maxPadding:h,w:i,h:o,x:r.left,y:r.top},r),p=fhe(l.concat(c),d);hm(a.fullSize,f,d,p),hm(l,f,d,p),hm(c,f,d,p)&&hm(l,f,d,p),ghe(f),$M(a.leftAndTop,f,d,p),f.x+=f.w,f.y+=f.h,$M(a.rightAndBottom,f,d,p),t.chartArea={left:f.left,top:f.top,right:f.left+f.w,bottom:f.top+f.h,height:f.h,width:f.w},Kt(a.chartArea,m=>{const g=m.box;Object.assign(g,t.chartArea),g.update(f.w,f.h,{left:0,top:0,right:0,bottom:0})})}};class zH{acquireContext(e,n){}releaseContext(e){return!1}addEventListener(e,n,s){}removeEventListener(e,n,s){}getDevicePixelRatio(){return 1}getMaximumSize(e,n,s,r){return n=Math.max(0,n||e.width),s=s||e.height,{width:n,height:Math.max(0,r?Math.floor(n/r):s)}}isAttached(e){return!0}updateConfig(e){}}class xhe extends zH{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}updateConfig(e){e.options.animation=!1}}const Av="$chartjs",vhe={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},AM=t=>t===null||t==="";function bhe(t,e){const n=t.style,s=t.getAttribute("height"),r=t.getAttribute("width");if(t[Av]={initial:{height:s,width:r,style:{display:n.display,height:n.height,width:n.width}}},n.display=n.display||"block",n.boxSizing=n.boxSizing||"border-box",AM(r)){const i=yM(t,"width");i!==void 0&&(t.width=i)}if(AM(s))if(t.style.height==="")t.height=t.width/(e||2);else{const i=yM(t,"height");i!==void 0&&(t.height=i)}return t}const VH=Ede?{passive:!0}:!1;function whe(t,e,n){t&&t.addEventListener(e,n,VH)}function She(t,e,n){t&&t.canvas&&t.canvas.removeEventListener(e,n,VH)}function khe(t,e){const n=vhe[t.type]||t.type,{x:s,y:r}=Nu(t,e);return{type:n,chart:e,native:t,x:s!==void 0?s:null,y:r!==void 0?r:null}}function Vb(t,e){for(const n of t)if(n===e||n.contains(e))return!0}function Che(t,e,n){const s=t.canvas,r=new MutationObserver(i=>{let o=!1;for(const a of i)o=o||Vb(a.addedNodes,s),o=o&&!Vb(a.removedNodes,s);o&&n()});return r.observe(document,{childList:!0,subtree:!0}),r}function The(t,e,n){const s=t.canvas,r=new MutationObserver(i=>{let o=!1;for(const a of i)o=o||Vb(a.removedNodes,s),o=o&&!Vb(a.addedNodes,s);o&&n()});return r.observe(document,{childList:!0,subtree:!0}),r}const Sg=new Map;let RM=0;function jH(){const t=window.devicePixelRatio;t!==RM&&(RM=t,Sg.forEach((e,n)=>{n.currentDevicePixelRatio!==t&&e()}))}function Nhe(t,e){Sg.size||window.addEventListener("resize",jH),Sg.set(t,e)}function Ihe(t){Sg.delete(t),Sg.size||window.removeEventListener("resize",jH)}function _he(t,e,n){const s=t.canvas,r=s&&t$(s);if(!r)return;const i=SH((a,l)=>{const c=r.clientWidth;n(a,l),c<r.clientWidth&&n()},window),o=new ResizeObserver(a=>{const l=a[0],c=l.contentRect.width,u=l.contentRect.height;c===0&&u===0||i(c,u)});return o.observe(r),Nhe(t,i),o}function OC(t,e,n){n&&n.disconnect(),e==="resize"&&Ihe(t)}function Ehe(t,e,n){const s=t.canvas,r=SH(i=>{t.ctx!==null&&n(khe(i,t))},t);return whe(s,e,r),r}class $he extends zH{acquireContext(e,n){const s=e&&e.getContext&&e.getContext("2d");return s&&s.canvas===e?(bhe(e,n),s):null}releaseContext(e){const n=e.canvas;if(!n[Av])return!1;const s=n[Av].initial;["height","width"].forEach(i=>{const o=s[i];Wt(o)?n.removeAttribute(i):n.setAttribute(i,o)});const r=s.style||{};return Object.keys(r).forEach(i=>{n.style[i]=r[i]}),n.width=n.width,delete n[Av],!0}addEventListener(e,n,s){this.removeEventListener(e,n);const r=e.$proxies||(e.$proxies={}),o={attach:Che,detach:The,resize:_he}[n]||Ehe;r[n]=o(e,n,s)}removeEventListener(e,n){const s=e.$proxies||(e.$proxies={}),r=s[n];if(!r)return;({attach:OC,detach:OC,resize:OC}[n]||She)(e,n,r),s[n]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,n,s,r){return _de(e,n,s,r)}isAttached(e){const n=e&&t$(e);return!!(n&&n.isConnected)}}function Ahe(t){return!e$()||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas?xhe:$he}var rv;let ep=(rv=class{constructor(){Je(this,"x");Je(this,"y");Je(this,"active",!1);Je(this,"options");Je(this,"$animations")}tooltipPosition(e){const{x:n,y:s}=this.getProps(["x","y"],e);return{x:n,y:s}}hasValue(){return Fb(this.x)&&Fb(this.y)}getProps(e,n){const s=this.$animations;if(!n||!s)return this;const r={};return e.forEach(i=>{r[i]=s[i]&&s[i].active()?s[i]._to:this[i]}),r}},Je(rv,"defaults",{}),Je(rv,"defaultRoutes"),rv);function Rhe(t,e){const n=t.options.ticks,s=Dhe(t),r=Math.min(n.maxTicksLimit||s,s),i=n.major.enabled?Phe(e):[],o=i.length,a=i[0],l=i[o-1],c=[];if(o>r)return Fhe(e,c,i,o/r),c;const u=Ohe(i,e,r);if(o>0){let d,h;const f=o>1?Math.round((l-a)/(o-1)):null;for(Dx(e,c,u,Wt(f)?0:a-f,a),d=0,h=o-1;d<h;d++)Dx(e,c,u,i[d],i[d+1]);return Dx(e,c,u,l,Wt(f)?e.length:l+f),c}return Dx(e,c,u),c}function Dhe(t){const e=t.options.offset,n=t._tickSize(),s=t._length/n+(e?0:1),r=t._maxLength/n;return Math.floor(Math.min(s,r))}function Ohe(t,e,n){const s=Lhe(t),r=e.length/n;if(!s)return Math.max(r,1);const i=Vue(s);for(let o=0,a=i.length-1;o<a;o++){const l=i[o];if(l>r)return l}return Math.max(r,1)}function Phe(t){const e=[];let n,s;for(n=0,s=t.length;n<s;n++)t[n].major&&e.push(n);return e}function Fhe(t,e,n,s){let r=0,i=n[0],o;for(s=Math.ceil(s),o=0;o<t.length;o++)o===i&&(e.push(t[o]),r++,i=n[r*s])}function Dx(t,e,n,s,r){const i=Ot(s,0),o=Math.min(Ot(r,t.length),t.length);let a=0,l,c,u;for(n=Math.ceil(n),r&&(l=r-s,n=l/Math.floor(l/n)),u=i;u<0;)a++,u=Math.round(i+a*n);for(c=Math.max(i,0);c<o;c++)c===u&&(e.push(t[c]),a++,u=Math.round(i+a*n))}function Lhe(t){const e=t.length;let n,s;if(e<2)return!1;for(s=t[0],n=1;n<e;++n)if(t[n]-t[n-1]!==s)return!1;return s}const Mhe=t=>t==="left"?"right":t==="right"?"left":t,DM=(t,e,n)=>e==="top"||e==="left"?t[e]+n:t[e]-n,OM=(t,e)=>Math.min(e||t,t);function PM(t,e){const n=[],s=t.length/e,r=t.length;let i=0;for(;i<r;i+=s)n.push(t[Math.floor(i)]);return n}function zhe(t,e,n){const s=t.ticks.length,r=Math.min(e,s-1),i=t._startPixel,o=t._endPixel,a=1e-6;let l=t.getPixelForTick(r),c;if(!(n&&(s===1?c=Math.max(l-i,o-l):e===0?c=(t.getPixelForTick(1)-l)/2:c=(l-t.getPixelForTick(r-1))/2,l+=r<e?c:-c,l<i-a||l>o+a)))return l}function Vhe(t,e){Kt(t,n=>{const s=n.gc,r=s.length/2;let i;if(r>e){for(i=0;i<r;++i)delete n.data[s[i]];s.splice(0,r)}})}function Kp(t){return t.drawTicks?t.tickLength:0}function FM(t,e){if(!t.display)return 0;const n=Gs(t.font,e),s=Cr(t.padding);return(Rn(t.text)?t.text.length:1)*n.lineHeight+s.height}function jhe(t,e){return Rd(t,{scale:e,type:"scale"})}function Bhe(t,e,n){return Rd(t,{tick:n,index:e,type:"tick"})}function Whe(t,e,n){let s=kH(t);return(n&&e!=="right"||!n&&e==="right")&&(s=Mhe(s)),s}function Uhe(t,e,n,s){const{top:r,left:i,bottom:o,right:a,chart:l}=t,{chartArea:c,scales:u}=l;let d=0,h,f,p;const m=o-r,g=a-i;if(t.isHorizontal()){if(f=li(s,i,a),Ft(n)){const y=Object.keys(n)[0],x=n[y];p=u[y].getPixelForValue(x)+m-e}else n==="center"?p=(c.bottom+c.top)/2+m-e:p=DM(t,n,e);h=a-i}else{if(Ft(n)){const y=Object.keys(n)[0],x=n[y];f=u[y].getPixelForValue(x)-g+e}else n==="center"?f=(c.left+c.right)/2-g+e:f=DM(t,n,e);p=li(s,o,r),d=n==="left"?-ns:ns}return{titleX:f,titleY:p,maxWidth:h,rotation:d}}class Dd extends ep{constructor(e){super(),this.id=e.id,this.type=e.type,this.options=void 0,this.ctx=e.ctx,this.chart=e.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}parse(e,n){return e}getUserBounds(){let{_userMin:e,_userMax:n,_suggestedMin:s,_suggestedMax:r}=this;return e=ci(e,Number.POSITIVE_INFINITY),n=ci(n,Number.NEGATIVE_INFINITY),s=ci(s,Number.POSITIVE_INFINITY),r=ci(r,Number.NEGATIVE_INFINITY),{min:ci(e,s),max:ci(n,r),minDefined:Os(e),maxDefined:Os(n)}}getMinMax(e){let{min:n,max:s,minDefined:r,maxDefined:i}=this.getUserBounds(),o;if(r&&i)return{min:n,max:s};const a=this.getMatchingVisibleMetas();for(let l=0,c=a.length;l<c;++l)o=a[l].controller.getMinMax(this,e),r||(n=Math.min(n,o.min)),i||(s=Math.max(s,o.max));return n=i&&n>s?s:n,s=r&&n>s?n:s,{min:ci(n,ci(s,n)),max:ci(s,ci(n,s))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}getLabelItems(e=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(e))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){an(this.options.beforeUpdate,[this])}update(e,n,s){const{beginAtZero:r,grace:i,ticks:o}=this.options,a=o.sampleSize;this.beforeUpdate(),this.maxWidth=e,this.maxHeight=n,this._margins=s=Object.assign({left:0,right:0,top:0,bottom:0},s),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+s.left+s.right:this.height+s.top+s.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=fde(this,i,r),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const l=a<this.ticks.length;this._convertTicksToLabels(l?PM(this.ticks,a):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),o.display&&(o.autoSkip||o.source==="auto")&&(this.ticks=Rhe(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),l&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let e=this.options.reverse,n,s;this.isHorizontal()?(n=this.left,s=this.right):(n=this.top,s=this.bottom,e=!e),this._startPixel=n,this._endPixel=s,this._reversePixels=e,this._length=s-n,this._alignToPixels=this.options.alignToPixels}afterUpdate(){an(this.options.afterUpdate,[this])}beforeSetDimensions(){an(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){an(this.options.afterSetDimensions,[this])}_callHooks(e){this.chart.notifyPlugins(e,this.getContext()),an(this.options[e],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){an(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(e){const n=this.options.ticks;let s,r,i;for(s=0,r=e.length;s<r;s++)i=e[s],i.label=an(n.callback,[i.value,s,e],this)}afterTickToLabelConversion(){an(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){an(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const e=this.options,n=e.ticks,s=OM(this.ticks.length,e.ticks.maxTicksLimit),r=n.minRotation||0,i=n.maxRotation;let o=r,a,l,c;if(!this._isVisible()||!n.display||r>=i||s<=1||!this.isHorizontal()){this.labelRotation=r;return}const u=this._getLabelSizes(),d=u.widest.width,h=u.highest.height,f=Hr(this.chart.width-d,0,this.maxWidth);a=e.offset?this.maxWidth/s:f/(s-1),d+6>a&&(a=f/(s-(e.offset?.5:1)),l=this.maxHeight-Kp(e.grid)-n.padding-FM(e.title,this.chart.options.font),c=Math.sqrt(d*d+h*h),o=GE(Math.min(Math.asin(Hr((u.highest.height+6)/a,-1,1)),Math.asin(Hr(l/c,-1,1))-Math.asin(Hr(h/c,-1,1)))),o=Math.max(r,Math.min(i,o))),this.labelRotation=o}afterCalculateLabelRotation(){an(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){an(this.options.beforeFit,[this])}fit(){const e={width:0,height:0},{chart:n,options:{ticks:s,title:r,grid:i}}=this,o=this._isVisible(),a=this.isHorizontal();if(o){const l=FM(r,n.options.font);if(a?(e.width=this.maxWidth,e.height=Kp(i)+l):(e.height=this.maxHeight,e.width=Kp(i)+l),s.display&&this.ticks.length){const{first:c,last:u,widest:d,highest:h}=this._getLabelSizes(),f=s.padding*2,p=da(this.labelRotation),m=Math.cos(p),g=Math.sin(p);if(a){const y=s.mirror?0:g*d.width+m*h.height;e.height=Math.min(this.maxHeight,e.height+y+f)}else{const y=s.mirror?0:m*d.width+g*h.height;e.width=Math.min(this.maxWidth,e.width+y+f)}this._calculatePadding(c,u,g,m)}}this._handleMargins(),a?(this.width=this._length=n.width-this._margins.left-this._margins.right,this.height=e.height):(this.width=e.width,this.height=this._length=n.height-this._margins.top-this._margins.bottom)}_calculatePadding(e,n,s,r){const{ticks:{align:i,padding:o},position:a}=this.options,l=this.labelRotation!==0,c=a!=="top"&&this.axis==="x";if(this.isHorizontal()){const u=this.getPixelForTick(0)-this.left,d=this.right-this.getPixelForTick(this.ticks.length-1);let h=0,f=0;l?c?(h=r*e.width,f=s*n.height):(h=s*e.height,f=r*n.width):i==="start"?f=n.width:i==="end"?h=e.width:i!=="inner"&&(h=e.width/2,f=n.width/2),this.paddingLeft=Math.max((h-u+o)*this.width/(this.width-u),0),this.paddingRight=Math.max((f-d+o)*this.width/(this.width-d),0)}else{let u=n.height/2,d=e.height/2;i==="start"?(u=0,d=e.height):i==="end"&&(u=n.height,d=0),this.paddingTop=u+o,this.paddingBottom=d+o}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){an(this.options.afterFit,[this])}isHorizontal(){const{axis:e,position:n}=this.options;return n==="top"||n==="bottom"||e==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(e){this.beforeTickToLabelConversion(),this.generateTickLabels(e);let n,s;for(n=0,s=e.length;n<s;n++)Wt(e[n].label)&&(e.splice(n,1),s--,n--);this.afterTickToLabelConversion()}_getLabelSizes(){let e=this._labelSizes;if(!e){const n=this.options.ticks.sampleSize;let s=this.ticks;n<s.length&&(s=PM(s,n)),this._labelSizes=e=this._computeLabelSizes(s,s.length,this.options.ticks.maxTicksLimit)}return e}_computeLabelSizes(e,n,s){const{ctx:r,_longestTextCache:i}=this,o=[],a=[],l=Math.floor(n/OM(n,s));let c=0,u=0,d,h,f,p,m,g,y,x,v,b,k;for(d=0;d<n;d+=l){if(p=e[d].label,m=this._resolveTickFontOptions(d),r.font=g=m.string,y=i[g]=i[g]||{data:{},gc:[]},x=m.lineHeight,v=b=0,!Wt(p)&&!Rn(p))v=Mb(r,y.data,y.gc,v,p),b=x;else if(Rn(p))for(h=0,f=p.length;h<f;++h)k=p[h],!Wt(k)&&!Rn(k)&&(v=Mb(r,y.data,y.gc,v,k),b+=x);o.push(v),a.push(b),c=Math.max(v,c),u=Math.max(b,u)}Vhe(i,n);const C=o.indexOf(c),N=a.indexOf(u),I=$=>({width:o[$]||0,height:a[$]||0});return{first:I(0),last:I(n-1),widest:I(C),highest:I(N),widths:o,heights:a}}getLabelForValue(e){return e}getPixelForValue(e,n){return NaN}getValueForPixel(e){}getPixelForTick(e){const n=this.ticks;return e<0||e>n.length-1?null:this.getPixelForValue(n[e].value)}getPixelForDecimal(e){this._reversePixels&&(e=1-e);const n=this._startPixel+e*this._length;return Uue(this._alignToPixels?mu(this.chart,n,0):n)}getDecimalForPixel(e){const n=(e-this._startPixel)/this._length;return this._reversePixels?1-n:n}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:e,max:n}=this;return e<0&&n<0?n:e>0&&n>0?e:0}getContext(e){const n=this.ticks||[];if(e>=0&&e<n.length){const s=n[e];return s.$context||(s.$context=Bhe(this.getContext(),e,s))}return this.$context||(this.$context=jhe(this.chart.getContext(),this))}_tickSize(){const e=this.options.ticks,n=da(this.labelRotation),s=Math.abs(Math.cos(n)),r=Math.abs(Math.sin(n)),i=this._getLabelSizes(),o=e.autoSkipPadding||0,a=i?i.widest.width+o:0,l=i?i.highest.height+o:0;return this.isHorizontal()?l*s>a*r?a/s:l/r:l*r<a*s?l/s:a/r}_isVisible(){const e=this.options.display;return e!=="auto"?!!e:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(e){const n=this.axis,s=this.chart,r=this.options,{grid:i,position:o,border:a}=r,l=i.offset,c=this.isHorizontal(),d=this.ticks.length+(l?1:0),h=Kp(i),f=[],p=a.setContext(this.getContext()),m=p.display?p.width:0,g=m/2,y=function(W){return mu(s,W,m)};let x,v,b,k,C,N,I,$,A,P,F,V;if(o==="top")x=y(this.bottom),N=this.bottom-h,$=x-g,P=y(e.top)+g,V=e.bottom;else if(o==="bottom")x=y(this.top),P=e.top,V=y(e.bottom)-g,N=x+g,$=this.top+h;else if(o==="left")x=y(this.right),C=this.right-h,I=x-g,A=y(e.left)+g,F=e.right;else if(o==="right")x=y(this.left),A=e.left,F=y(e.right)-g,C=x+g,I=this.left+h;else if(n==="x"){if(o==="center")x=y((e.top+e.bottom)/2+.5);else if(Ft(o)){const W=Object.keys(o)[0],q=o[W];x=y(this.chart.scales[W].getPixelForValue(q))}P=e.top,V=e.bottom,N=x+g,$=N+h}else if(n==="y"){if(o==="center")x=y((e.left+e.right)/2);else if(Ft(o)){const W=Object.keys(o)[0],q=o[W];x=y(this.chart.scales[W].getPixelForValue(q))}C=x-g,I=C-h,A=e.left,F=e.right}const z=Ot(r.ticks.maxTicksLimit,d),B=Math.max(1,Math.ceil(d/z));for(v=0;v<d;v+=B){const W=this.getContext(v),q=i.setContext(W),M=a.setContext(W),G=q.lineWidth,ne=q.color,ie=M.dash||[],de=M.dashOffset,he=q.tickWidth,pe=q.tickColor,me=q.tickBorderDash||[],ye=q.tickBorderDashOffset;b=zhe(this,v,l),b!==void 0&&(k=mu(s,b,G),c?C=I=A=F=k:N=$=P=V=k,f.push({tx1:C,ty1:N,tx2:I,ty2:$,x1:A,y1:P,x2:F,y2:V,width:G,color:ne,borderDash:ie,borderDashOffset:de,tickWidth:he,tickColor:pe,tickBorderDash:me,tickBorderDashOffset:ye}))}return this._ticksLength=d,this._borderValue=x,f}_computeLabelItems(e){const n=this.axis,s=this.options,{position:r,ticks:i}=s,o=this.isHorizontal(),a=this.ticks,{align:l,crossAlign:c,padding:u,mirror:d}=i,h=Kp(s.grid),f=h+u,p=d?-u:f,m=-da(this.labelRotation),g=[];let y,x,v,b,k,C,N,I,$,A,P,F,V="middle";if(r==="top")C=this.bottom-p,N=this._getXAxisLabelAlignment();else if(r==="bottom")C=this.top+p,N=this._getXAxisLabelAlignment();else if(r==="left"){const B=this._getYAxisLabelAlignment(h);N=B.textAlign,k=B.x}else if(r==="right"){const B=this._getYAxisLabelAlignment(h);N=B.textAlign,k=B.x}else if(n==="x"){if(r==="center")C=(e.top+e.bottom)/2+f;else if(Ft(r)){const B=Object.keys(r)[0],W=r[B];C=this.chart.scales[B].getPixelForValue(W)+f}N=this._getXAxisLabelAlignment()}else if(n==="y"){if(r==="center")k=(e.left+e.right)/2-f;else if(Ft(r)){const B=Object.keys(r)[0],W=r[B];k=this.chart.scales[B].getPixelForValue(W)}N=this._getYAxisLabelAlignment(h).textAlign}n==="y"&&(l==="start"?V="top":l==="end"&&(V="bottom"));const z=this._getLabelSizes();for(y=0,x=a.length;y<x;++y){v=a[y],b=v.label;const B=i.setContext(this.getContext(y));I=this.getPixelForTick(y)+i.labelOffset,$=this._resolveTickFontOptions(y),A=$.lineHeight,P=Rn(b)?b.length:1;const W=P/2,q=B.color,M=B.textStrokeColor,G=B.textStrokeWidth;let ne=N;o?(k=I,N==="inner"&&(y===x-1?ne=this.options.reverse?"left":"right":y===0?ne=this.options.reverse?"right":"left":ne="center"),r==="top"?c==="near"||m!==0?F=-P*A+A/2:c==="center"?F=-z.highest.height/2-W*A+A:F=-z.highest.height+A/2:c==="near"||m!==0?F=A/2:c==="center"?F=z.highest.height/2-W*A:F=z.highest.height-P*A,d&&(F*=-1),m!==0&&!B.showLabelBackdrop&&(k+=A/2*Math.sin(m))):(C=I,F=(1-P)*A/2);let ie;if(B.showLabelBackdrop){const de=Cr(B.backdropPadding),he=z.heights[y],pe=z.widths[y];let me=F-de.top,ye=0-de.left;switch(V){case"middle":me-=he/2;break;case"bottom":me-=he;break}switch(N){case"center":ye-=pe/2;break;case"right":ye-=pe;break;case"inner":y===x-1?ye-=pe:y>0&&(ye-=pe/2);break}ie={left:ye,top:me,width:pe+de.width,height:he+de.height,color:B.backdropColor}}g.push({label:b,font:$,textOffset:F,options:{rotation:m,color:q,strokeColor:M,strokeWidth:G,textAlign:ne,textBaseline:V,translation:[k,C],backdrop:ie}})}return g}_getXAxisLabelAlignment(){const{position:e,ticks:n}=this.options;if(-da(this.labelRotation))return e==="top"?"left":"right";let r="center";return n.align==="start"?r="left":n.align==="end"?r="right":n.align==="inner"&&(r="inner"),r}_getYAxisLabelAlignment(e){const{position:n,ticks:{crossAlign:s,mirror:r,padding:i}}=this.options,o=this._getLabelSizes(),a=e+i,l=o.widest.width;let c,u;return n==="left"?r?(u=this.right+i,s==="near"?c="left":s==="center"?(c="center",u+=l/2):(c="right",u+=l)):(u=this.right-a,s==="near"?c="right":s==="center"?(c="center",u-=l/2):(c="left",u=this.left)):n==="right"?r?(u=this.left+i,s==="near"?c="right":s==="center"?(c="center",u-=l/2):(c="left",u-=l)):(u=this.left+a,s==="near"?c="left":s==="center"?(c="center",u+=l/2):(c="right",u=this.right)):c="right",{textAlign:c,x:u}}_computeLabelArea(){if(this.options.ticks.mirror)return;const e=this.chart,n=this.options.position;if(n==="left"||n==="right")return{top:0,left:this.left,bottom:e.height,right:this.right};if(n==="top"||n==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:e.width}}drawBackground(){const{ctx:e,options:{backgroundColor:n},left:s,top:r,width:i,height:o}=this;n&&(e.save(),e.fillStyle=n,e.fillRect(s,r,i,o),e.restore())}getLineWidthForValue(e){const n=this.options.grid;if(!this._isVisible()||!n.display)return 0;const r=this.ticks.findIndex(i=>i.value===e);return r>=0?n.setContext(this.getContext(r)).lineWidth:0}drawGrid(e){const n=this.options.grid,s=this.ctx,r=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e));let i,o;const a=(l,c,u)=>{!u.width||!u.color||(s.save(),s.lineWidth=u.width,s.strokeStyle=u.color,s.setLineDash(u.borderDash||[]),s.lineDashOffset=u.borderDashOffset,s.beginPath(),s.moveTo(l.x,l.y),s.lineTo(c.x,c.y),s.stroke(),s.restore())};if(n.display)for(i=0,o=r.length;i<o;++i){const l=r[i];n.drawOnChartArea&&a({x:l.x1,y:l.y1},{x:l.x2,y:l.y2},l),n.drawTicks&&a({x:l.tx1,y:l.ty1},{x:l.tx2,y:l.ty2},{color:l.tickColor,width:l.tickWidth,borderDash:l.tickBorderDash,borderDashOffset:l.tickBorderDashOffset})}}drawBorder(){const{chart:e,ctx:n,options:{border:s,grid:r}}=this,i=s.setContext(this.getContext()),o=s.display?i.width:0;if(!o)return;const a=r.setContext(this.getContext(0)).lineWidth,l=this._borderValue;let c,u,d,h;this.isHorizontal()?(c=mu(e,this.left,o)-o/2,u=mu(e,this.right,a)+a/2,d=h=l):(d=mu(e,this.top,o)-o/2,h=mu(e,this.bottom,a)+a/2,c=u=l),n.save(),n.lineWidth=i.width,n.strokeStyle=i.color,n.beginPath(),n.moveTo(c,d),n.lineTo(u,h),n.stroke(),n.restore()}drawLabels(e){if(!this.options.ticks.display)return;const s=this.ctx,r=this._computeLabelArea();r&&qE(s,r);const i=this.getLabelItems(e);for(const o of i){const a=o.options,l=o.font,c=o.label,u=o.textOffset;Nf(s,c,0,u,l,a)}r&&XE(s)}drawTitle(){const{ctx:e,options:{position:n,title:s,reverse:r}}=this;if(!s.display)return;const i=Gs(s.font),o=Cr(s.padding),a=s.align;let l=i.lineHeight/2;n==="bottom"||n==="center"||Ft(n)?(l+=o.bottom,Rn(s.text)&&(l+=i.lineHeight*(s.text.length-1))):l+=o.top;const{titleX:c,titleY:u,maxWidth:d,rotation:h}=Uhe(this,l,n,a);Nf(e,s.text,0,0,i,{color:s.color,maxWidth:d,rotation:h,textAlign:Whe(a,n,r),textBaseline:"middle",translation:[c,u]})}draw(e){this._isVisible()&&(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}_layers(){const e=this.options,n=e.ticks&&e.ticks.z||0,s=Ot(e.grid&&e.grid.z,-1),r=Ot(e.border&&e.border.z,0);return!this._isVisible()||this.draw!==Dd.prototype.draw?[{z:n,draw:i=>{this.draw(i)}}]:[{z:s,draw:i=>{this.drawBackground(),this.drawGrid(i),this.drawTitle()}},{z:r,draw:()=>{this.drawBorder()}},{z:n,draw:i=>{this.drawLabels(i)}}]}getMatchingVisibleMetas(e){const n=this.chart.getSortedVisibleDatasetMetas(),s=this.axis+"AxisID",r=[];let i,o;for(i=0,o=n.length;i<o;++i){const a=n[i];a[s]===this.id&&(!e||a.type===e)&&r.push(a)}return r}_resolveTickFontOptions(e){const n=this.options.ticks.setContext(this.getContext(e));return Gs(n.font)}_maxDigits(){const e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}}class Ox{constructor(e,n,s){this.type=e,this.scope=n,this.override=s,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){const n=Object.getPrototypeOf(e);let s;Khe(n)&&(s=this.register(n));const r=this.items,i=e.id,o=this.scope+"."+i;if(!i)throw new Error("class does not have id: "+e);return i in r||(r[i]=e,Hhe(e,o,s),this.override&&Un.override(e.id,e.overrides)),o}get(e){return this.items[e]}unregister(e){const n=this.items,s=e.id,r=this.scope;s in n&&delete n[s],r&&s in Un[r]&&(delete Un[r][s],this.override&&delete yd[s])}}function Hhe(t,e,n){const s=vg(Object.create(null),[n?Un.get(n):{},Un.get(e),t.defaults]);Un.set(e,s),t.defaultRoutes&&Ghe(e,t.defaultRoutes),t.descriptors&&Un.describe(e,t.descriptors)}function Ghe(t,e){Object.keys(e).forEach(n=>{const s=n.split("."),r=s.pop(),i=[t].concat(s).join("."),o=e[n].split("."),a=o.pop(),l=o.join(".");Un.route(i,r,l,a)})}function Khe(t){return"id"in t&&"defaults"in t}class qhe{constructor(){this.controllers=new Ox(Bh,"datasets",!0),this.elements=new Ox(ep,"elements"),this.plugins=new Ox(Object,"plugins"),this.scales=new Ox(Dd,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...e){this._each("register",e)}remove(...e){this._each("unregister",e)}addControllers(...e){this._each("register",e,this.controllers)}addElements(...e){this._each("register",e,this.elements)}addPlugins(...e){this._each("register",e,this.plugins)}addScales(...e){this._each("register",e,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(...e){this._each("unregister",e,this.controllers)}removeElements(...e){this._each("unregister",e,this.elements)}removePlugins(...e){this._each("unregister",e,this.plugins)}removeScales(...e){this._each("unregister",e,this.scales)}_each(e,n,s){[...n].forEach(r=>{const i=s||this._getRegistryForType(r);s||i.isForType(r)||i===this.plugins&&r.id?this._exec(e,i,r):Kt(r,o=>{const a=s||this._getRegistryForType(o);this._exec(e,a,o)})})}_exec(e,n,s){const r=HE(e);an(s["before"+r],[],s),n[e](s),an(s["after"+r],[],s)}_getRegistryForType(e){for(let n=0;n<this._typedRegistries.length;n++){const s=this._typedRegistries[n];if(s.isForType(e))return s}return this.plugins}_get(e,n,s){const r=n.get(e);if(r===void 0)throw new Error('"'+e+'" is not a registered '+s+".");return r}}var Qo=new qhe;class Xhe{constructor(){this._init=[]}notify(e,n,s,r){n==="beforeInit"&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install"));const i=r?this._descriptors(e).filter(r):this._descriptors(e),o=this._notify(i,e,n,s);return n==="afterDestroy"&&(this._notify(i,e,"stop"),this._notify(this._init,e,"uninstall")),o}_notify(e,n,s,r){r=r||{};for(const i of e){const o=i.plugin,a=o[s],l=[n,r,i.options];if(an(a,l,o)===!1&&r.cancelable)return!1}return!0}invalidate(){Wt(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;const n=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),n}_createDescriptors(e,n){const s=e&&e.config,r=Ot(s.options&&s.options.plugins,{}),i=Yhe(s);return r===!1&&!n?[]:Qhe(e,i,r,n)}_notifyStateChanges(e){const n=this._oldCache||[],s=this._cache,r=(i,o)=>i.filter(a=>!o.some(l=>a.plugin.id===l.plugin.id));this._notify(r(n,s),e,"stop"),this._notify(r(s,n),e,"start")}}function Yhe(t){const e={},n=[],s=Object.keys(Qo.plugins.items);for(let i=0;i<s.length;i++)n.push(Qo.getPlugin(s[i]));const r=t.plugins||[];for(let i=0;i<r.length;i++){const o=r[i];n.indexOf(o)===-1&&(n.push(o),e[o.id]=!0)}return{plugins:n,localIds:e}}function Zhe(t,e){return!e&&t===!1?null:t===!0?{}:t}function Qhe(t,{plugins:e,localIds:n},s,r){const i=[],o=t.getContext();for(const a of e){const l=a.id,c=Zhe(s[l],r);c!==null&&i.push({plugin:a,options:Jhe(t.config,{plugin:a,local:n[l]},c,o)})}return i}function Jhe(t,{plugin:e,local:n},s,r){const i=t.pluginScopeKeys(e),o=t.getOptionScopes(s,i);return n&&e.defaults&&o.push(e.defaults),t.createResolver(o,r,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function i2(t,e){const n=Un.datasets[t]||{};return((e.datasets||{})[t]||{}).indexAxis||e.indexAxis||n.indexAxis||"x"}function efe(t,e){let n=t;return t==="_index_"?n=e:t==="_value_"&&(n=e==="x"?"y":"x"),n}function tfe(t,e){return t===e?"_index_":"_value_"}function LM(t){if(t==="x"||t==="y"||t==="r")return t}function nfe(t){if(t==="top"||t==="bottom")return"x";if(t==="left"||t==="right")return"y"}function o2(t,...e){if(LM(t))return t;for(const n of e){const s=n.axis||nfe(n.position)||t.length>1&&LM(t[0].toLowerCase());if(s)return s}throw new Error(`Cannot determine type of '${t}' axis. Please provide 'axis' or 'position' option.`)}function MM(t,e,n){if(n[e+"AxisID"]===t)return{axis:e}}function sfe(t,e){if(e.data&&e.data.datasets){const n=e.data.datasets.filter(s=>s.xAxisID===t||s.yAxisID===t);if(n.length)return MM(t,"x",n[0])||MM(t,"y",n[0])}return{}}function rfe(t,e){const n=yd[t.type]||{scales:{}},s=e.scales||{},r=i2(t.type,e),i=Object.create(null);return Object.keys(s).forEach(o=>{const a=s[o];if(!Ft(a))return console.error(`Invalid scale configuration for scale: ${o}`);if(a._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${o}`);const l=o2(o,a,sfe(o,t),Un.scales[a.type]),c=tfe(l,r),u=n.scales||{};i[o]=jm(Object.create(null),[{axis:l},a,u[l],u[c]])}),t.data.datasets.forEach(o=>{const a=o.type||t.type,l=o.indexAxis||i2(a,e),u=(yd[a]||{}).scales||{};Object.keys(u).forEach(d=>{const h=efe(d,l),f=o[h+"AxisID"]||h;i[f]=i[f]||Object.create(null),jm(i[f],[{axis:h},s[f],u[d]])})}),Object.keys(i).forEach(o=>{const a=i[o];jm(a,[Un.scales[a.type],Un.scale])}),i}function BH(t){const e=t.options||(t.options={});e.plugins=Ot(e.plugins,{}),e.scales=rfe(t,e)}function WH(t){return t=t||{},t.datasets=t.datasets||[],t.labels=t.labels||[],t}function ife(t){return t=t||{},t.data=WH(t.data),BH(t),t}const zM=new Map,UH=new Set;function Px(t,e){let n=zM.get(t);return n||(n=e(),zM.set(t,n),UH.add(n)),n}const qp=(t,e,n)=>{const s=gd(e,n);s!==void 0&&t.add(s)};class ofe{constructor(e){this._config=ife(e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=WH(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){const e=this._config;this.clearCache(),BH(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return Px(e,()=>[[`datasets.${e}`,""]])}datasetAnimationScopeKeys(e,n){return Px(`${e}.transition.${n}`,()=>[[`datasets.${e}.transitions.${n}`,`transitions.${n}`],[`datasets.${e}`,""]])}datasetElementScopeKeys(e,n){return Px(`${e}-${n}`,()=>[[`datasets.${e}.elements.${n}`,`datasets.${e}`,`elements.${n}`,""]])}pluginScopeKeys(e){const n=e.id,s=this.type;return Px(`${s}-plugin-${n}`,()=>[[`plugins.${n}`,...e.additionalOptionScopes||[]]])}_cachedScopes(e,n){const s=this._scopeCache;let r=s.get(e);return(!r||n)&&(r=new Map,s.set(e,r)),r}getOptionScopes(e,n,s){const{options:r,type:i}=this,o=this._cachedScopes(e,s),a=o.get(n);if(a)return a;const l=new Set;n.forEach(u=>{e&&(l.add(e),u.forEach(d=>qp(l,e,d))),u.forEach(d=>qp(l,r,d)),u.forEach(d=>qp(l,yd[i]||{},d)),u.forEach(d=>qp(l,Un,d)),u.forEach(d=>qp(l,s2,d))});const c=Array.from(l);return c.length===0&&c.push(Object.create(null)),UH.has(n)&&o.set(n,c),c}chartOptionScopes(){const{options:e,type:n}=this;return[e,yd[n]||{},Un.datasets[n]||{},{type:n},Un,s2]}resolveNamedOptions(e,n,s,r=[""]){const i={$shared:!0},{resolver:o,subPrefixes:a}=VM(this._resolverCache,e,r);let l=o;if(lfe(o,n)){i.$shared=!1,s=Lc(s)?s():s;const c=this.createResolver(e,s,a);l=If(o,s,c)}for(const c of n)i[c]=l[c];return i}createResolver(e,n,s=[""],r){const{resolver:i}=VM(this._resolverCache,e,s);return Ft(n)?If(i,n,void 0,r):i}}function VM(t,e,n){let s=t.get(e);s||(s=new Map,t.set(e,s));const r=n.join();let i=s.get(r);return i||(i={resolver:ZE(e,n),subPrefixes:n.filter(a=>!a.toLowerCase().includes("hover"))},s.set(r,i)),i}const afe=t=>Ft(t)&&Object.getOwnPropertyNames(t).some(e=>Lc(t[e]));function lfe(t,e){const{isScriptable:n,isIndexable:s}=_H(t);for(const r of e){const i=n(r),o=s(r),a=(o||i)&&t[r];if(i&&(Lc(a)||afe(a))||o&&Rn(a))return!0}return!1}var cfe="4.5.0";const ufe=["top","bottom","left","right","chartArea"];function jM(t,e){return t==="top"||t==="bottom"||ufe.indexOf(t)===-1&&e==="x"}function BM(t,e){return function(n,s){return n[t]===s[t]?n[e]-s[e]:n[t]-s[t]}}function WM(t){const e=t.chart,n=e.options.animation;e.notifyPlugins("afterRender"),an(n&&n.onComplete,[t],e)}function dfe(t){const e=t.chart,n=e.options.animation;an(n&&n.onProgress,[t],e)}function HH(t){return e$()&&typeof t=="string"?t=document.getElementById(t):t&&t.length&&(t=t[0]),t&&t.canvas&&(t=t.canvas),t}const Rv={},UM=t=>{const e=HH(t);return Object.values(Rv).filter(n=>n.canvas===e).pop()};function hfe(t,e,n){const s=Object.keys(t);for(const r of s){const i=+r;if(i>=e){const o=t[r];delete t[r],(n>0||i>e)&&(t[i+n]=o)}}}function ffe(t,e,n,s){return!n||t.type==="mouseout"?null:s?e:t}var Dl;let p1=(Dl=class{static register(...e){Qo.add(...e),HM()}static unregister(...e){Qo.remove(...e),HM()}constructor(e,n){const s=this.config=new ofe(n),r=HH(e),i=UM(r);if(i)throw new Error("Canvas is already in use. Chart with ID '"+i.id+"' must be destroyed before the canvas with ID '"+i.canvas.id+"' can be reused.");const o=s.createResolver(s.chartOptionScopes(),this.getContext());this.platform=new(s.platform||Ahe(r)),this.platform.updateConfig(s);const a=this.platform.acquireContext(r,o.aspectRatio),l=a&&a.canvas,c=l&&l.height,u=l&&l.width;if(this.id=Rue(),this.ctx=a,this.canvas=l,this.width=u,this.height=c,this._options=o,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new Xhe,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=que(d=>this.update(d),o.resizeDelay||0),this._dataChanges=[],Rv[this.id]=this,!a||!l){console.error("Failed to create chart: can't acquire context from the given item");return}Wa.listen(this,"complete",WM),Wa.listen(this,"progress",dfe),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:n},width:s,height:r,_aspectRatio:i}=this;return Wt(e)?n&&i?i:r?s/r:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}get registry(){return Qo}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():gM(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return hM(this.canvas,this.ctx),this}stop(){return Wa.stop(this),this}resize(e,n){Wa.running(this)?this._resizeBeforeDraw={width:e,height:n}:this._resize(e,n)}_resize(e,n){const s=this.options,r=this.canvas,i=s.maintainAspectRatio&&this.aspectRatio,o=this.platform.getMaximumSize(r,e,n,i),a=s.devicePixelRatio||this.platform.getDevicePixelRatio(),l=this.width?"resize":"attach";this.width=o.width,this.height=o.height,this._aspectRatio=this.aspectRatio,gM(this,a,!0)&&(this.notifyPlugins("resize",{size:o}),an(s.onResize,[this,o],this),this.attached&&this._doResize(l)&&this.render())}ensureScalesHaveIDs(){const n=this.options.scales||{};Kt(n,(s,r)=>{s.id=r})}buildOrUpdateScales(){const e=this.options,n=e.scales,s=this.scales,r=Object.keys(s).reduce((o,a)=>(o[a]=!1,o),{});let i=[];n&&(i=i.concat(Object.keys(n).map(o=>{const a=n[o],l=o2(o,a),c=l==="r",u=l==="x";return{options:a,dposition:c?"chartArea":u?"bottom":"left",dtype:c?"radialLinear":u?"category":"linear"}}))),Kt(i,o=>{const a=o.options,l=a.id,c=o2(l,a),u=Ot(a.type,o.dtype);(a.position===void 0||jM(a.position,c)!==jM(o.dposition))&&(a.position=o.dposition),r[l]=!0;let d=null;if(l in s&&s[l].type===u)d=s[l];else{const h=Qo.getScale(u);d=new h({id:l,type:u,ctx:this.ctx,chart:this}),s[d.id]=d}d.init(a,e)}),Kt(r,(o,a)=>{o||delete s[a]}),Kt(s,o=>{rc.configure(this,o,o.options),rc.addBox(this,o)})}_updateMetasets(){const e=this._metasets,n=this.data.datasets.length,s=e.length;if(e.sort((r,i)=>r.index-i.index),s>n){for(let r=n;r<s;++r)this._destroyDatasetMeta(r);e.splice(n,s-n)}this._sortedMetasets=e.slice(0).sort(BM("order","index"))}_removeUnreferencedMetasets(){const{_metasets:e,data:{datasets:n}}=this;e.length>n.length&&delete this._stacks,e.forEach((s,r)=>{n.filter(i=>i===s._dataset).length===0&&this._destroyDatasetMeta(r)})}buildOrUpdateControllers(){const e=[],n=this.data.datasets;let s,r;for(this._removeUnreferencedMetasets(),s=0,r=n.length;s<r;s++){const i=n[s];let o=this.getDatasetMeta(s);const a=i.type||this.config.type;if(o.type&&o.type!==a&&(this._destroyDatasetMeta(s),o=this.getDatasetMeta(s)),o.type=a,o.indexAxis=i.indexAxis||i2(a,this.options),o.order=i.order||0,o.index=s,o.label=""+i.label,o.visible=this.isDatasetVisible(s),o.controller)o.controller.updateIndex(s),o.controller.linkScales();else{const l=Qo.getController(a),{datasetElementType:c,dataElementType:u}=Un.datasets[a];Object.assign(l,{dataElementType:Qo.getElement(u),datasetElementType:c&&Qo.getElement(c)}),o.controller=new l(this,s),e.push(o.controller)}}return this._updateMetasets(),e}_resetElements(){Kt(this.data.datasets,(e,n)=>{this.getDatasetMeta(n).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const n=this.config;n.update();const s=this._options=n.createResolver(n.chartOptionScopes(),this.getContext()),r=this._animationsDisabled=!s.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0})===!1)return;const i=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let o=0;for(let c=0,u=this.data.datasets.length;c<u;c++){const{controller:d}=this.getDatasetMeta(c),h=!r&&i.indexOf(d)===-1;d.buildOrUpdateElements(h),o=Math.max(+d.getMaxOverflow(),o)}o=this._minPadding=s.layout.autoPadding?o:0,this._updateLayout(o),r||Kt(i,c=>{c.reset()}),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(BM("z","_idx"));const{_active:a,_lastEvent:l}=this;l?this._eventHandler(l,!0):a.length&&this._updateHoverStyles(a,a,!0),this.render()}_updateScales(){Kt(this.scales,e=>{rc.removeBox(this,e)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const e=this.options,n=new Set(Object.keys(this._listeners)),s=new Set(e.events);(!sM(n,s)||!!this._responsiveListeners!==e.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:e}=this,n=this._getUniformDataChanges()||[];for(const{method:s,start:r,count:i}of n){const o=s==="_removeElements"?-i:i;hfe(e,r,o)}}_getUniformDataChanges(){const e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];const n=this.data.datasets.length,s=i=>new Set(e.filter(o=>o[0]===i).map((o,a)=>a+","+o.splice(1).join(","))),r=s(0);for(let i=1;i<n;i++)if(!sM(r,s(i)))return;return Array.from(r).map(i=>i.split(",")).map(i=>({method:i[1],start:+i[2],count:+i[3]}))}_updateLayout(e){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;rc.update(this,this.width,this.height,e);const n=this.chartArea,s=n.width<=0||n.height<=0;this._layers=[],Kt(this.boxes,r=>{s&&r.position==="chartArea"||(r.configure&&r.configure(),this._layers.push(...r._layers()))},this),this._layers.forEach((r,i)=>{r._idx=i}),this.notifyPlugins("afterLayout")}_updateDatasets(e){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})!==!1){for(let n=0,s=this.data.datasets.length;n<s;++n)this.getDatasetMeta(n).controller.configure();for(let n=0,s=this.data.datasets.length;n<s;++n)this._updateDataset(n,Lc(e)?e({datasetIndex:n}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,n){const s=this.getDatasetMeta(e),r={meta:s,index:e,mode:n,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",r)!==!1&&(s.controller._update(n),r.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",r))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(Wa.has(this)?this.attached&&!Wa.running(this)&&Wa.start(this):(this.draw(),WM({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){const{width:s,height:r}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(s,r)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const n=this._layers;for(e=0;e<n.length&&n[e].z<=0;++e)n[e].draw(this.chartArea);for(this._drawDatasets();e<n.length;++e)n[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const n=this._sortedMetasets,s=[];let r,i;for(r=0,i=n.length;r<i;++r){const o=n[r];(!e||o.visible)&&s.push(o)}return s}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const e=this.getSortedVisibleDatasetMetas();for(let n=e.length-1;n>=0;--n)this._drawDataset(e[n]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const n=this.ctx,s={meta:e,index:e.index,cancelable:!0},r=Dde(this,e);this.notifyPlugins("beforeDatasetDraw",s)!==!1&&(r&&qE(n,r),e.controller.draw(),r&&XE(n),s.cancelable=!1,this.notifyPlugins("afterDatasetDraw",s))}isPointInArea(e){return _h(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,n,s,r){const i=uhe.modes[n];return typeof i=="function"?i(this,e,s,r):[]}getDatasetMeta(e){const n=this.data.datasets[e],s=this._metasets;let r=s.filter(i=>i&&i._dataset===n).pop();return r||(r={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:n&&n.order||0,index:e,_dataset:n,_parsed:[],_sorted:!1},s.push(r)),r}getContext(){return this.$context||(this.$context=Rd(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const n=this.data.datasets[e];if(!n)return!1;const s=this.getDatasetMeta(e);return typeof s.hidden=="boolean"?!s.hidden:!n.hidden}setDatasetVisibility(e,n){const s=this.getDatasetMeta(e);s.hidden=!n}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,n,s){const r=s?"show":"hide",i=this.getDatasetMeta(e),o=i.controller._resolveAnimations(void 0,r);bg(n)?(i.data[n].hidden=!s,this.update()):(this.setDatasetVisibility(e,s),o.update(i,{visible:s}),this.update(a=>a.datasetIndex===e?r:void 0))}hide(e,n){this._updateVisibility(e,n,!1)}show(e,n){this._updateVisibility(e,n,!0)}_destroyDatasetMeta(e){const n=this._metasets[e];n&&n.controller&&n.controller._destroy(),delete this._metasets[e]}_stop(){let e,n;for(this.stop(),Wa.remove(this),e=0,n=this.data.datasets.length;e<n;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:e,ctx:n}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),hM(e,n),this.platform.releaseContext(n),this.canvas=null,this.ctx=null),delete Rv[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...e){return this.canvas.toDataURL(...e)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const e=this._listeners,n=this.platform,s=(i,o)=>{n.addEventListener(this,i,o),e[i]=o},r=(i,o,a)=>{i.offsetX=o,i.offsetY=a,this._eventHandler(i)};Kt(this.options.events,i=>s(i,r))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const e=this._responsiveListeners,n=this.platform,s=(l,c)=>{n.addEventListener(this,l,c),e[l]=c},r=(l,c)=>{e[l]&&(n.removeEventListener(this,l,c),delete e[l])},i=(l,c)=>{this.canvas&&this.resize(l,c)};let o;const a=()=>{r("attach",a),this.attached=!0,this.resize(),s("resize",i),s("detach",o)};o=()=>{this.attached=!1,r("resize",i),this._stop(),this._resize(0,0),s("attach",a)},n.isAttached(this.canvas)?a():o()}unbindEvents(){Kt(this._listeners,(e,n)=>{this.platform.removeEventListener(this,n,e)}),this._listeners={},Kt(this._responsiveListeners,(e,n)=>{this.platform.removeEventListener(this,n,e)}),this._responsiveListeners=void 0}updateHoverStyle(e,n,s){const r=s?"set":"remove";let i,o,a,l;for(n==="dataset"&&(i=this.getDatasetMeta(e[0].datasetIndex),i.controller["_"+r+"DatasetHoverStyle"]()),a=0,l=e.length;a<l;++a){o=e[a];const c=o&&this.getDatasetMeta(o.datasetIndex).controller;c&&c[r+"HoverStyle"](o.element,o.datasetIndex,o.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const n=this._active||[],s=e.map(({datasetIndex:i,index:o})=>{const a=this.getDatasetMeta(i);if(!a)throw new Error("No dataset found at index "+i);return{datasetIndex:i,element:a.data[o],index:o}});!Db(s,n)&&(this._active=s,this._lastEvent=null,this._updateHoverStyles(s,n))}notifyPlugins(e,n,s){return this._plugins.notify(this,e,n,s)}isPluginEnabled(e){return this._plugins._cache.filter(n=>n.plugin.id===e).length===1}_updateHoverStyles(e,n,s){const r=this.options.hover,i=(l,c)=>l.filter(u=>!c.some(d=>u.datasetIndex===d.datasetIndex&&u.index===d.index)),o=i(n,e),a=s?e:i(e,n);o.length&&this.updateHoverStyle(o,r.mode,!1),a.length&&r.mode&&this.updateHoverStyle(a,r.mode,!0)}_eventHandler(e,n){const s={event:e,replay:n,cancelable:!0,inChartArea:this.isPointInArea(e)},r=o=>(o.options.events||this.options.events).includes(e.native.type);if(this.notifyPlugins("beforeEvent",s,r)===!1)return;const i=this._handleEvent(e,n,s.inChartArea);return s.cancelable=!1,this.notifyPlugins("afterEvent",s,r),(i||s.changed)&&this.render(),this}_handleEvent(e,n,s){const{_active:r=[],options:i}=this,o=n,a=this._getActiveElements(e,r,s,o),l=Mue(e),c=ffe(e,this._lastEvent,s,l);s&&(this._lastEvent=null,an(i.onHover,[e,a,this],this),l&&an(i.onClick,[e,a,this],this));const u=!Db(a,r);return(u||n)&&(this._active=a,this._updateHoverStyles(a,r,n)),this._lastEvent=c,u}_getActiveElements(e,n,s,r){if(e.type==="mouseout")return[];if(!s)return n;const i=this.options.hover;return this.getElementsAtEventForMode(e,i.mode,i,r)}},Je(Dl,"defaults",Un),Je(Dl,"instances",Rv),Je(Dl,"overrides",yd),Je(Dl,"registry",Qo),Je(Dl,"version",cfe),Je(Dl,"getChart",UM),Dl);function HM(){return Kt(p1.instances,t=>t._plugins.invalidate())}function pfe(t,e,n){const{startAngle:s,x:r,y:i,outerRadius:o,innerRadius:a,options:l}=e,{borderWidth:c,borderJoinStyle:u}=l,d=Math.min(c/o,hi(s-n));if(t.beginPath(),t.arc(r,i,o-c/2,s+d/2,n-d/2),a>0){const h=Math.min(c/a,hi(s-n));t.arc(r,i,a+c/2,n-h/2,s+h/2,!0)}else{const h=Math.min(c/2,o*hi(s-n));if(u==="round")t.arc(r,i,h,n-tn/2,s+tn/2,!0);else if(u==="bevel"){const f=2*h*h,p=-f*Math.cos(n+tn/2)+r,m=-f*Math.sin(n+tn/2)+i,g=f*Math.cos(s+tn/2)+r,y=f*Math.sin(s+tn/2)+i;t.lineTo(p,m),t.lineTo(g,y)}}t.closePath(),t.moveTo(0,0),t.rect(0,0,t.canvas.width,t.canvas.height),t.clip("evenodd")}function mfe(t,e,n){const{startAngle:s,pixelMargin:r,x:i,y:o,outerRadius:a,innerRadius:l}=e;let c=r/a;t.beginPath(),t.arc(i,o,a,s-c,n+c),l>r?(c=r/l,t.arc(i,o,l,n+c,s-c,!0)):t.arc(i,o,r,n+ns,s-ns),t.closePath(),t.clip()}function gfe(t){return YE(t,["outerStart","outerEnd","innerStart","innerEnd"])}function yfe(t,e,n,s){const r=gfe(t.options.borderRadius),i=(n-e)/2,o=Math.min(i,s*e/2),a=l=>{const c=(n-Math.min(i,l))*s/2;return Hr(l,0,Math.min(i,c))};return{outerStart:a(r.outerStart),outerEnd:a(r.outerEnd),innerStart:Hr(r.innerStart,0,o),innerEnd:Hr(r.innerEnd,0,o)}}function eh(t,e,n,s){return{x:n+t*Math.cos(e),y:s+t*Math.sin(e)}}function jb(t,e,n,s,r,i){const{x:o,y:a,startAngle:l,pixelMargin:c,innerRadius:u}=e,d=Math.max(e.outerRadius+s+n-c,0),h=u>0?u+s+n+c:0;let f=0;const p=r-l;if(s){const B=u>0?u-s:0,W=d>0?d-s:0,q=(B+W)/2,M=q!==0?p*q/(q+s):p;f=(p-M)/2}const m=Math.max(.001,p*d-n/tn)/d,g=(p-m)/2,y=l+g+f,x=r-g-f,{outerStart:v,outerEnd:b,innerStart:k,innerEnd:C}=yfe(e,h,d,x-y),N=d-v,I=d-b,$=y+v/N,A=x-b/I,P=h+k,F=h+C,V=y+k/P,z=x-C/F;if(t.beginPath(),i){const B=($+A)/2;if(t.arc(o,a,d,$,B),t.arc(o,a,d,B,A),b>0){const G=eh(I,A,o,a);t.arc(G.x,G.y,b,A,x+ns)}const W=eh(F,x,o,a);if(t.lineTo(W.x,W.y),C>0){const G=eh(F,z,o,a);t.arc(G.x,G.y,C,x+ns,z+Math.PI)}const q=(x-C/h+(y+k/h))/2;if(t.arc(o,a,h,x-C/h,q,!0),t.arc(o,a,h,q,y+k/h,!0),k>0){const G=eh(P,V,o,a);t.arc(G.x,G.y,k,V+Math.PI,y-ns)}const M=eh(N,y,o,a);if(t.lineTo(M.x,M.y),v>0){const G=eh(N,$,o,a);t.arc(G.x,G.y,v,y-ns,$)}}else{t.moveTo(o,a);const B=Math.cos($)*d+o,W=Math.sin($)*d+a;t.lineTo(B,W);const q=Math.cos(A)*d+o,M=Math.sin(A)*d+a;t.lineTo(q,M)}t.closePath()}function xfe(t,e,n,s,r){const{fullCircles:i,startAngle:o,circumference:a}=e;let l=e.endAngle;if(i){jb(t,e,n,s,l,r);for(let c=0;c<i;++c)t.fill();isNaN(a)||(l=o+(a%Wn||Wn))}return jb(t,e,n,s,l,r),t.fill(),l}function vfe(t,e,n,s,r){const{fullCircles:i,startAngle:o,circumference:a,options:l}=e,{borderWidth:c,borderJoinStyle:u,borderDash:d,borderDashOffset:h,borderRadius:f}=l,p=l.borderAlign==="inner";if(!c)return;t.setLineDash(d||[]),t.lineDashOffset=h,p?(t.lineWidth=c*2,t.lineJoin=u||"round"):(t.lineWidth=c,t.lineJoin=u||"bevel");let m=e.endAngle;if(i){jb(t,e,n,s,m,r);for(let g=0;g<i;++g)t.stroke();isNaN(a)||(m=o+(a%Wn||Wn))}p&&mfe(t,e,m),l.selfJoin&&m-o>=tn&&f===0&&u!=="miter"&&pfe(t,e,m),i||(jb(t,e,n,s,m,r),t.stroke())}class fm extends ep{constructor(n){super();Je(this,"circumference");Je(this,"endAngle");Je(this,"fullCircles");Je(this,"innerRadius");Je(this,"outerRadius");Je(this,"pixelMargin");Je(this,"startAngle");this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,n&&Object.assign(this,n)}inRange(n,s,r){const i=this.getProps(["x","y"],r),{angle:o,distance:a}=xH(i,{x:n,y:s}),{startAngle:l,endAngle:c,innerRadius:u,outerRadius:d,circumference:h}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],r),f=(this.options.spacing+this.options.borderWidth)/2,p=Ot(h,c-l),m=Lb(o,l,c)&&l!==c,g=p>=Wn||m,y=Fu(a,u+f,d+f);return g&&y}getCenterPoint(n){const{x:s,y:r,startAngle:i,endAngle:o,innerRadius:a,outerRadius:l}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],n),{offset:c,spacing:u}=this.options,d=(i+o)/2,h=(a+l+u+c)/2;return{x:s+Math.cos(d)*h,y:r+Math.sin(d)*h}}tooltipPosition(n){return this.getCenterPoint(n)}draw(n){const{options:s,circumference:r}=this,i=(s.offset||0)/4,o=(s.spacing||0)/2,a=s.circular;if(this.pixelMargin=s.borderAlign==="inner"?.33:0,this.fullCircles=r>Wn?Math.floor(r/Wn):0,r===0||this.innerRadius<0||this.outerRadius<0)return;n.save();const l=(this.startAngle+this.endAngle)/2;n.translate(Math.cos(l)*i,Math.sin(l)*i);const c=1-Math.sin(Math.min(tn,r||0)),u=i*c;n.fillStyle=s.backgroundColor,n.strokeStyle=s.borderColor,xfe(n,this,u,o,a),vfe(n,this,u,o,a),n.restore()}}Je(fm,"id","arc"),Je(fm,"defaults",{borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0,selfJoin:!1}),Je(fm,"defaultRoutes",{backgroundColor:"backgroundColor"}),Je(fm,"descriptors",{_scriptable:!0,_indexable:n=>n!=="borderDash"});function GH(t,e){const{x:n,y:s,base:r,width:i,height:o}=t.getProps(["x","y","base","width","height"],e);let a,l,c,u,d;return t.horizontal?(d=o/2,a=Math.min(n,r),l=Math.max(n,r),c=s-d,u=s+d):(d=i/2,a=n-d,l=n+d,c=Math.min(s,r),u=Math.max(s,r)),{left:a,top:c,right:l,bottom:u}}function ic(t,e,n,s){return t?0:Hr(e,n,s)}function bfe(t,e,n){const s=t.options.borderWidth,r=t.borderSkipped,i=IH(s);return{t:ic(r.top,i.top,0,n),r:ic(r.right,i.right,0,e),b:ic(r.bottom,i.bottom,0,n),l:ic(r.left,i.left,0,e)}}function wfe(t,e,n){const{enableBorderRadius:s}=t.getProps(["enableBorderRadius"]),r=t.options.borderRadius,i=Ju(r),o=Math.min(e,n),a=t.borderSkipped,l=s||Ft(r);return{topLeft:ic(!l||a.top||a.left,i.topLeft,0,o),topRight:ic(!l||a.top||a.right,i.topRight,0,o),bottomLeft:ic(!l||a.bottom||a.left,i.bottomLeft,0,o),bottomRight:ic(!l||a.bottom||a.right,i.bottomRight,0,o)}}function Sfe(t){const e=GH(t),n=e.right-e.left,s=e.bottom-e.top,r=bfe(t,n/2,s/2),i=wfe(t,n/2,s/2);return{outer:{x:e.left,y:e.top,w:n,h:s,radius:i},inner:{x:e.left+r.l,y:e.top+r.t,w:n-r.l-r.r,h:s-r.t-r.b,radius:{topLeft:Math.max(0,i.topLeft-Math.max(r.t,r.l)),topRight:Math.max(0,i.topRight-Math.max(r.t,r.r)),bottomLeft:Math.max(0,i.bottomLeft-Math.max(r.b,r.l)),bottomRight:Math.max(0,i.bottomRight-Math.max(r.b,r.r))}}}}function PC(t,e,n,s){const r=e===null,i=n===null,a=t&&!(r&&i)&&GH(t,s);return a&&(r||Fu(e,a.left,a.right))&&(i||Fu(n,a.top,a.bottom))}function kfe(t){return t.topLeft||t.topRight||t.bottomLeft||t.bottomRight}function Cfe(t,e){t.rect(e.x,e.y,e.w,e.h)}function FC(t,e,n={}){const s=t.x!==n.x?-e:0,r=t.y!==n.y?-e:0,i=(t.x+t.w!==n.x+n.w?e:0)-s,o=(t.y+t.h!==n.y+n.h?e:0)-r;return{x:t.x+s,y:t.y+r,w:t.w+i,h:t.h+o,radius:t.radius}}class Dv extends ep{constructor(e){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,e&&Object.assign(this,e)}draw(e){const{inflateAmount:n,options:{borderColor:s,backgroundColor:r}}=this,{inner:i,outer:o}=Sfe(this),a=kfe(o.radius)?wg:Cfe;e.save(),(o.w!==i.w||o.h!==i.h)&&(e.beginPath(),a(e,FC(o,n,i)),e.clip(),a(e,FC(i,-n,o)),e.fillStyle=s,e.fill("evenodd")),e.beginPath(),a(e,FC(i,n)),e.fillStyle=r,e.fill(),e.restore()}inRange(e,n,s){return PC(this,e,n,s)}inXRange(e,n){return PC(this,e,null,n)}inYRange(e,n){return PC(this,null,e,n)}getCenterPoint(e){const{x:n,y:s,base:r,horizontal:i}=this.getProps(["x","y","base","horizontal"],e);return{x:i?(n+r)/2:n,y:i?s:(s+r)/2}}getRange(e){return e==="x"?this.width/2:this.height/2}}Je(Dv,"id","bar"),Je(Dv,"defaults",{borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0}),Je(Dv,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});const GM=(t,e)=>{let{boxHeight:n=e,boxWidth:s=e}=t;return t.usePointStyle&&(n=Math.min(n,e),s=t.pointStyleWidth||Math.min(s,e)),{boxWidth:s,boxHeight:n,itemHeight:Math.max(e,n)}},Tfe=(t,e)=>t!==null&&e!==null&&t.datasetIndex===e.datasetIndex&&t.index===e.index;class KM extends ep{constructor(e){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,n,s){this.maxWidth=e,this.maxHeight=n,this._margins=s,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const e=this.options.labels||{};let n=an(e.generateLabels,[this.chart],this)||[];e.filter&&(n=n.filter(s=>e.filter(s,this.chart.data))),e.sort&&(n=n.sort((s,r)=>e.sort(s,r,this.chart.data))),this.options.reverse&&n.reverse(),this.legendItems=n}fit(){const{options:e,ctx:n}=this;if(!e.display){this.width=this.height=0;return}const s=e.labels,r=Gs(s.font),i=r.size,o=this._computeTitleHeight(),{boxWidth:a,itemHeight:l}=GM(s,i);let c,u;n.font=r.string,this.isHorizontal()?(c=this.maxWidth,u=this._fitRows(o,i,a,l)+10):(u=this.maxHeight,c=this._fitCols(o,r,a,l)+10),this.width=Math.min(c,e.maxWidth||this.maxWidth),this.height=Math.min(u,e.maxHeight||this.maxHeight)}_fitRows(e,n,s,r){const{ctx:i,maxWidth:o,options:{labels:{padding:a}}}=this,l=this.legendHitBoxes=[],c=this.lineWidths=[0],u=r+a;let d=e;i.textAlign="left",i.textBaseline="middle";let h=-1,f=-u;return this.legendItems.forEach((p,m)=>{const g=s+n/2+i.measureText(p.text).width;(m===0||c[c.length-1]+g+2*a>o)&&(d+=u,c[c.length-(m>0?0:1)]=0,f+=u,h++),l[m]={left:0,top:f,row:h,width:g,height:r},c[c.length-1]+=g+a}),d}_fitCols(e,n,s,r){const{ctx:i,maxHeight:o,options:{labels:{padding:a}}}=this,l=this.legendHitBoxes=[],c=this.columnSizes=[],u=o-e;let d=a,h=0,f=0,p=0,m=0;return this.legendItems.forEach((g,y)=>{const{itemWidth:x,itemHeight:v}=Nfe(s,n,i,g,r);y>0&&f+v+2*a>u&&(d+=h+a,c.push({width:h,height:f}),p+=h+a,m++,h=f=0),l[y]={left:p,top:f,col:m,width:x,height:v},h=Math.max(h,x),f+=v+a}),d+=h,c.push({width:h,height:f}),d}adjustHitBoxes(){if(!this.options.display)return;const e=this._computeTitleHeight(),{legendHitBoxes:n,options:{align:s,labels:{padding:r},rtl:i}}=this,o=jh(i,this.left,this.width);if(this.isHorizontal()){let a=0,l=li(s,this.left+r,this.right-this.lineWidths[a]);for(const c of n)a!==c.row&&(a=c.row,l=li(s,this.left+r,this.right-this.lineWidths[a])),c.top+=this.top+e+r,c.left=o.leftForLtr(o.x(l),c.width),l+=c.width+r}else{let a=0,l=li(s,this.top+e+r,this.bottom-this.columnSizes[a].height);for(const c of n)c.col!==a&&(a=c.col,l=li(s,this.top+e+r,this.bottom-this.columnSizes[a].height)),c.top=l,c.left+=this.left+r,c.left=o.leftForLtr(o.x(c.left),c.width),l+=c.height+r}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const e=this.ctx;qE(e,this),this._draw(),XE(e)}}_draw(){const{options:e,columnSizes:n,lineWidths:s,ctx:r}=this,{align:i,labels:o}=e,a=Un.color,l=jh(e.rtl,this.left,this.width),c=Gs(o.font),{padding:u}=o,d=c.size,h=d/2;let f;this.drawTitle(),r.textAlign=l.textAlign("left"),r.textBaseline="middle",r.lineWidth=.5,r.font=c.string;const{boxWidth:p,boxHeight:m,itemHeight:g}=GM(o,d),y=function(C,N,I){if(isNaN(p)||p<=0||isNaN(m)||m<0)return;r.save();const $=Ot(I.lineWidth,1);if(r.fillStyle=Ot(I.fillStyle,a),r.lineCap=Ot(I.lineCap,"butt"),r.lineDashOffset=Ot(I.lineDashOffset,0),r.lineJoin=Ot(I.lineJoin,"miter"),r.lineWidth=$,r.strokeStyle=Ot(I.strokeStyle,a),r.setLineDash(Ot(I.lineDash,[])),o.usePointStyle){const A={radius:m*Math.SQRT2/2,pointStyle:I.pointStyle,rotation:I.rotation,borderWidth:$},P=l.xPlus(C,p/2),F=N+h;NH(r,A,P,F,o.pointStyleWidth&&p)}else{const A=N+Math.max((d-m)/2,0),P=l.leftForLtr(C,p),F=Ju(I.borderRadius);r.beginPath(),Object.values(F).some(V=>V!==0)?wg(r,{x:P,y:A,w:p,h:m,radius:F}):r.rect(P,A,p,m),r.fill(),$!==0&&r.stroke()}r.restore()},x=function(C,N,I){Nf(r,I.text,C,N+g/2,c,{strikethrough:I.hidden,textAlign:l.textAlign(I.textAlign)})},v=this.isHorizontal(),b=this._computeTitleHeight();v?f={x:li(i,this.left+u,this.right-s[0]),y:this.top+u+b,line:0}:f={x:this.left+u,y:li(i,this.top+b+u,this.bottom-n[0].height),line:0},RH(this.ctx,e.textDirection);const k=g+u;this.legendItems.forEach((C,N)=>{r.strokeStyle=C.fontColor,r.fillStyle=C.fontColor;const I=r.measureText(C.text).width,$=l.textAlign(C.textAlign||(C.textAlign=o.textAlign)),A=p+h+I;let P=f.x,F=f.y;l.setWidth(this.width),v?N>0&&P+A+u>this.right&&(F=f.y+=k,f.line++,P=f.x=li(i,this.left+u,this.right-s[f.line])):N>0&&F+k>this.bottom&&(P=f.x=P+n[f.line].width+u,f.line++,F=f.y=li(i,this.top+b+u,this.bottom-n[f.line].height));const V=l.x(P);if(y(V,F,C),P=Xue($,P+p+h,v?P+A:this.right,e.rtl),x(l.x(P),F,C),v)f.x+=A+u;else if(typeof C.text!="string"){const z=c.lineHeight;f.y+=KH(C,z)+u}else f.y+=k}),DH(this.ctx,e.textDirection)}drawTitle(){const e=this.options,n=e.title,s=Gs(n.font),r=Cr(n.padding);if(!n.display)return;const i=jh(e.rtl,this.left,this.width),o=this.ctx,a=n.position,l=s.size/2,c=r.top+l;let u,d=this.left,h=this.width;if(this.isHorizontal())h=Math.max(...this.lineWidths),u=this.top+c,d=li(e.align,d,this.right-h);else{const p=this.columnSizes.reduce((m,g)=>Math.max(m,g.height),0);u=c+li(e.align,this.top,this.bottom-p-e.labels.padding-this._computeTitleHeight())}const f=li(a,d,d+h);o.textAlign=i.textAlign(kH(a)),o.textBaseline="middle",o.strokeStyle=n.color,o.fillStyle=n.color,o.font=s.string,Nf(o,n.text,f,u,s)}_computeTitleHeight(){const e=this.options.title,n=Gs(e.font),s=Cr(e.padding);return e.display?n.lineHeight+s.height:0}_getLegendItemAt(e,n){let s,r,i;if(Fu(e,this.left,this.right)&&Fu(n,this.top,this.bottom)){for(i=this.legendHitBoxes,s=0;s<i.length;++s)if(r=i[s],Fu(e,r.left,r.left+r.width)&&Fu(n,r.top,r.top+r.height))return this.legendItems[s]}return null}handleEvent(e){const n=this.options;if(!Efe(e.type,n))return;const s=this._getLegendItemAt(e.x,e.y);if(e.type==="mousemove"||e.type==="mouseout"){const r=this._hoveredItem,i=Tfe(r,s);r&&!i&&an(n.onLeave,[e,r,this],this),this._hoveredItem=s,s&&!i&&an(n.onHover,[e,s,this],this)}else s&&an(n.onClick,[e,s,this],this)}}function Nfe(t,e,n,s,r){const i=Ife(s,t,e,n),o=_fe(r,s,e.lineHeight);return{itemWidth:i,itemHeight:o}}function Ife(t,e,n,s){let r=t.text;return r&&typeof r!="string"&&(r=r.reduce((i,o)=>i.length>o.length?i:o)),e+n.size/2+s.measureText(r).width}function _fe(t,e,n){let s=t;return typeof e.text!="string"&&(s=KH(e,n)),s}function KH(t,e){const n=t.text?t.text.length:0;return e*n}function Efe(t,e){return!!((t==="mousemove"||t==="mouseout")&&(e.onHover||e.onLeave)||e.onClick&&(t==="click"||t==="mouseup"))}var $fe={id:"legend",_element:KM,start(t,e,n){const s=t.legend=new KM({ctx:t.ctx,options:n,chart:t});rc.configure(t,s,n),rc.addBox(t,s)},stop(t){rc.removeBox(t,t.legend),delete t.legend},beforeUpdate(t,e,n){const s=t.legend;rc.configure(t,s,n),s.options=n},afterUpdate(t){const e=t.legend;e.buildLabels(),e.adjustHitBoxes()},afterEvent(t,e){e.replay||t.legend.handleEvent(e.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(t,e,n){const s=e.datasetIndex,r=n.chart;r.isDatasetVisible(s)?(r.hide(s),e.hidden=!0):(r.show(s),e.hidden=!1)},onHover:null,onLeave:null,labels:{color:t=>t.chart.options.color,boxWidth:40,padding:10,generateLabels(t){const e=t.data.datasets,{labels:{usePointStyle:n,pointStyle:s,textAlign:r,color:i,useBorderRadius:o,borderRadius:a}}=t.legend.options;return t._getSortedDatasetMetas().map(l=>{const c=l.controller.getStyle(n?0:void 0),u=Cr(c.borderWidth);return{text:e[l.index].label,fillStyle:c.backgroundColor,fontColor:i,hidden:!l.visible,lineCap:c.borderCapStyle,lineDash:c.borderDash,lineDashOffset:c.borderDashOffset,lineJoin:c.borderJoinStyle,lineWidth:(u.width+u.height)/4,strokeStyle:c.borderColor,pointStyle:s||c.pointStyle,rotation:c.rotation,textAlign:r||c.textAlign,borderRadius:o&&(a||c.borderRadius),datasetIndex:l.index}},this)}},title:{color:t=>t.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:t=>!t.startsWith("on"),labels:{_scriptable:t=>!["generateLabels","filter","sort"].includes(t)}}};const pm={average(t){if(!t.length)return!1;let e,n,s=new Set,r=0,i=0;for(e=0,n=t.length;e<n;++e){const a=t[e].element;if(a&&a.hasValue()){const l=a.tooltipPosition();s.add(l.x),r+=l.y,++i}}return i===0||s.size===0?!1:{x:[...s].reduce((a,l)=>a+l)/s.size,y:r/i}},nearest(t,e){if(!t.length)return!1;let n=e.x,s=e.y,r=Number.POSITIVE_INFINITY,i,o,a;for(i=0,o=t.length;i<o;++i){const l=t[i].element;if(l&&l.hasValue()){const c=l.getCenterPoint(),u=Wue(e,c);u<r&&(r=u,a=l)}}if(a){const l=a.tooltipPosition();n=l.x,s=l.y}return{x:n,y:s}}};function Yo(t,e){return e&&(Rn(e)?Array.prototype.push.apply(t,e):t.push(e)),t}function Ua(t){return(typeof t=="string"||t instanceof String)&&t.indexOf(`
`)>-1?t.split(`
`):t}function Afe(t,e){const{element:n,datasetIndex:s,index:r}=e,i=t.getDatasetMeta(s).controller,{label:o,value:a}=i.getLabelAndValue(r);return{chart:t,label:o,parsed:i.getParsed(r),raw:t.data.datasets[s].data[r],formattedValue:a,dataset:i.getDataset(),dataIndex:r,datasetIndex:s,element:n}}function qM(t,e){const n=t.chart.ctx,{body:s,footer:r,title:i}=t,{boxWidth:o,boxHeight:a}=e,l=Gs(e.bodyFont),c=Gs(e.titleFont),u=Gs(e.footerFont),d=i.length,h=r.length,f=s.length,p=Cr(e.padding);let m=p.height,g=0,y=s.reduce((b,k)=>b+k.before.length+k.lines.length+k.after.length,0);if(y+=t.beforeBody.length+t.afterBody.length,d&&(m+=d*c.lineHeight+(d-1)*e.titleSpacing+e.titleMarginBottom),y){const b=e.displayColors?Math.max(a,l.lineHeight):l.lineHeight;m+=f*b+(y-f)*l.lineHeight+(y-1)*e.bodySpacing}h&&(m+=e.footerMarginTop+h*u.lineHeight+(h-1)*e.footerSpacing);let x=0;const v=function(b){g=Math.max(g,n.measureText(b).width+x)};return n.save(),n.font=c.string,Kt(t.title,v),n.font=l.string,Kt(t.beforeBody.concat(t.afterBody),v),x=e.displayColors?o+2+e.boxPadding:0,Kt(s,b=>{Kt(b.before,v),Kt(b.lines,v),Kt(b.after,v)}),x=0,n.font=u.string,Kt(t.footer,v),n.restore(),g+=p.width,{width:g,height:m}}function Rfe(t,e){const{y:n,height:s}=e;return n<s/2?"top":n>t.height-s/2?"bottom":"center"}function Dfe(t,e,n,s){const{x:r,width:i}=s,o=n.caretSize+n.caretPadding;if(t==="left"&&r+i+o>e.width||t==="right"&&r-i-o<0)return!0}function Ofe(t,e,n,s){const{x:r,width:i}=n,{width:o,chartArea:{left:a,right:l}}=t;let c="center";return s==="center"?c=r<=(a+l)/2?"left":"right":r<=i/2?c="left":r>=o-i/2&&(c="right"),Dfe(c,t,e,n)&&(c="center"),c}function XM(t,e,n){const s=n.yAlign||e.yAlign||Rfe(t,n);return{xAlign:n.xAlign||e.xAlign||Ofe(t,e,n,s),yAlign:s}}function Pfe(t,e){let{x:n,width:s}=t;return e==="right"?n-=s:e==="center"&&(n-=s/2),n}function Ffe(t,e,n){let{y:s,height:r}=t;return e==="top"?s+=n:e==="bottom"?s-=r+n:s-=r/2,s}function YM(t,e,n,s){const{caretSize:r,caretPadding:i,cornerRadius:o}=t,{xAlign:a,yAlign:l}=n,c=r+i,{topLeft:u,topRight:d,bottomLeft:h,bottomRight:f}=Ju(o);let p=Pfe(e,a);const m=Ffe(e,l,c);return l==="center"?a==="left"?p+=c:a==="right"&&(p-=c):a==="left"?p-=Math.max(u,h)+r:a==="right"&&(p+=Math.max(d,f)+r),{x:Hr(p,0,s.width-e.width),y:Hr(m,0,s.height-e.height)}}function Fx(t,e,n){const s=Cr(n.padding);return e==="center"?t.x+t.width/2:e==="right"?t.x+t.width-s.right:t.x+s.left}function ZM(t){return Yo([],Ua(t))}function Lfe(t,e,n){return Rd(t,{tooltip:e,tooltipItems:n,type:"tooltip"})}function QM(t,e){const n=e&&e.dataset&&e.dataset.tooltip&&e.dataset.tooltip.callbacks;return n?t.override(n):t}const qH={beforeTitle:Va,title(t){if(t.length>0){const e=t[0],n=e.chart.data.labels,s=n?n.length:0;if(this&&this.options&&this.options.mode==="dataset")return e.dataset.label||"";if(e.label)return e.label;if(s>0&&e.dataIndex<s)return n[e.dataIndex]}return""},afterTitle:Va,beforeBody:Va,beforeLabel:Va,label(t){if(this&&this.options&&this.options.mode==="dataset")return t.label+": "+t.formattedValue||t.formattedValue;let e=t.dataset.label||"";e&&(e+=": ");const n=t.formattedValue;return Wt(n)||(e+=n),e},labelColor(t){const n=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{borderColor:n.borderColor,backgroundColor:n.backgroundColor,borderWidth:n.borderWidth,borderDash:n.borderDash,borderDashOffset:n.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(t){const n=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{pointStyle:n.pointStyle,rotation:n.rotation}},afterLabel:Va,afterBody:Va,beforeFooter:Va,footer:Va,afterFooter:Va};function Pr(t,e,n,s){const r=t[e].call(n,s);return typeof r>"u"?qH[e].call(n,s):r}class a2 extends ep{constructor(e){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=e.chart,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const e=this._cachedAnimations;if(e)return e;const n=this.chart,s=this.options.setContext(this.getContext()),r=s.enabled&&n.options.animation&&s.animations,i=new OH(this.chart,r);return r._cacheable&&(this._cachedAnimations=Object.freeze(i)),i}getContext(){return this.$context||(this.$context=Lfe(this.chart.getContext(),this,this._tooltipItems))}getTitle(e,n){const{callbacks:s}=n,r=Pr(s,"beforeTitle",this,e),i=Pr(s,"title",this,e),o=Pr(s,"afterTitle",this,e);let a=[];return a=Yo(a,Ua(r)),a=Yo(a,Ua(i)),a=Yo(a,Ua(o)),a}getBeforeBody(e,n){return ZM(Pr(n.callbacks,"beforeBody",this,e))}getBody(e,n){const{callbacks:s}=n,r=[];return Kt(e,i=>{const o={before:[],lines:[],after:[]},a=QM(s,i);Yo(o.before,Ua(Pr(a,"beforeLabel",this,i))),Yo(o.lines,Pr(a,"label",this,i)),Yo(o.after,Ua(Pr(a,"afterLabel",this,i))),r.push(o)}),r}getAfterBody(e,n){return ZM(Pr(n.callbacks,"afterBody",this,e))}getFooter(e,n){const{callbacks:s}=n,r=Pr(s,"beforeFooter",this,e),i=Pr(s,"footer",this,e),o=Pr(s,"afterFooter",this,e);let a=[];return a=Yo(a,Ua(r)),a=Yo(a,Ua(i)),a=Yo(a,Ua(o)),a}_createItems(e){const n=this._active,s=this.chart.data,r=[],i=[],o=[];let a=[],l,c;for(l=0,c=n.length;l<c;++l)a.push(Afe(this.chart,n[l]));return e.filter&&(a=a.filter((u,d,h)=>e.filter(u,d,h,s))),e.itemSort&&(a=a.sort((u,d)=>e.itemSort(u,d,s))),Kt(a,u=>{const d=QM(e.callbacks,u);r.push(Pr(d,"labelColor",this,u)),i.push(Pr(d,"labelPointStyle",this,u)),o.push(Pr(d,"labelTextColor",this,u))}),this.labelColors=r,this.labelPointStyles=i,this.labelTextColors=o,this.dataPoints=a,a}update(e,n){const s=this.options.setContext(this.getContext()),r=this._active;let i,o=[];if(!r.length)this.opacity!==0&&(i={opacity:0});else{const a=pm[s.position].call(this,r,this._eventPosition);o=this._createItems(s),this.title=this.getTitle(o,s),this.beforeBody=this.getBeforeBody(o,s),this.body=this.getBody(o,s),this.afterBody=this.getAfterBody(o,s),this.footer=this.getFooter(o,s);const l=this._size=qM(this,s),c=Object.assign({},a,l),u=XM(this.chart,s,c),d=YM(s,c,u,this.chart);this.xAlign=u.xAlign,this.yAlign=u.yAlign,i={opacity:1,x:d.x,y:d.y,width:l.width,height:l.height,caretX:a.x,caretY:a.y}}this._tooltipItems=o,this.$context=void 0,i&&this._resolveAnimations().update(this,i),e&&s.external&&s.external.call(this,{chart:this.chart,tooltip:this,replay:n})}drawCaret(e,n,s,r){const i=this.getCaretPosition(e,s,r);n.lineTo(i.x1,i.y1),n.lineTo(i.x2,i.y2),n.lineTo(i.x3,i.y3)}getCaretPosition(e,n,s){const{xAlign:r,yAlign:i}=this,{caretSize:o,cornerRadius:a}=s,{topLeft:l,topRight:c,bottomLeft:u,bottomRight:d}=Ju(a),{x:h,y:f}=e,{width:p,height:m}=n;let g,y,x,v,b,k;return i==="center"?(b=f+m/2,r==="left"?(g=h,y=g-o,v=b+o,k=b-o):(g=h+p,y=g+o,v=b-o,k=b+o),x=g):(r==="left"?y=h+Math.max(l,u)+o:r==="right"?y=h+p-Math.max(c,d)-o:y=this.caretX,i==="top"?(v=f,b=v-o,g=y-o,x=y+o):(v=f+m,b=v+o,g=y+o,x=y-o),k=v),{x1:g,x2:y,x3:x,y1:v,y2:b,y3:k}}drawTitle(e,n,s){const r=this.title,i=r.length;let o,a,l;if(i){const c=jh(s.rtl,this.x,this.width);for(e.x=Fx(this,s.titleAlign,s),n.textAlign=c.textAlign(s.titleAlign),n.textBaseline="middle",o=Gs(s.titleFont),a=s.titleSpacing,n.fillStyle=s.titleColor,n.font=o.string,l=0;l<i;++l)n.fillText(r[l],c.x(e.x),e.y+o.lineHeight/2),e.y+=o.lineHeight+a,l+1===i&&(e.y+=s.titleMarginBottom-a)}}_drawColorBox(e,n,s,r,i){const o=this.labelColors[s],a=this.labelPointStyles[s],{boxHeight:l,boxWidth:c}=i,u=Gs(i.bodyFont),d=Fx(this,"left",i),h=r.x(d),f=l<u.lineHeight?(u.lineHeight-l)/2:0,p=n.y+f;if(i.usePointStyle){const m={radius:Math.min(c,l)/2,pointStyle:a.pointStyle,rotation:a.rotation,borderWidth:1},g=r.leftForLtr(h,c)+c/2,y=p+l/2;e.strokeStyle=i.multiKeyBackground,e.fillStyle=i.multiKeyBackground,fM(e,m,g,y),e.strokeStyle=o.borderColor,e.fillStyle=o.backgroundColor,fM(e,m,g,y)}else{e.lineWidth=Ft(o.borderWidth)?Math.max(...Object.values(o.borderWidth)):o.borderWidth||1,e.strokeStyle=o.borderColor,e.setLineDash(o.borderDash||[]),e.lineDashOffset=o.borderDashOffset||0;const m=r.leftForLtr(h,c),g=r.leftForLtr(r.xPlus(h,1),c-2),y=Ju(o.borderRadius);Object.values(y).some(x=>x!==0)?(e.beginPath(),e.fillStyle=i.multiKeyBackground,wg(e,{x:m,y:p,w:c,h:l,radius:y}),e.fill(),e.stroke(),e.fillStyle=o.backgroundColor,e.beginPath(),wg(e,{x:g,y:p+1,w:c-2,h:l-2,radius:y}),e.fill()):(e.fillStyle=i.multiKeyBackground,e.fillRect(m,p,c,l),e.strokeRect(m,p,c,l),e.fillStyle=o.backgroundColor,e.fillRect(g,p+1,c-2,l-2))}e.fillStyle=this.labelTextColors[s]}drawBody(e,n,s){const{body:r}=this,{bodySpacing:i,bodyAlign:o,displayColors:a,boxHeight:l,boxWidth:c,boxPadding:u}=s,d=Gs(s.bodyFont);let h=d.lineHeight,f=0;const p=jh(s.rtl,this.x,this.width),m=function(I){n.fillText(I,p.x(e.x+f),e.y+h/2),e.y+=h+i},g=p.textAlign(o);let y,x,v,b,k,C,N;for(n.textAlign=o,n.textBaseline="middle",n.font=d.string,e.x=Fx(this,g,s),n.fillStyle=s.bodyColor,Kt(this.beforeBody,m),f=a&&g!=="right"?o==="center"?c/2+u:c+2+u:0,b=0,C=r.length;b<C;++b){for(y=r[b],x=this.labelTextColors[b],n.fillStyle=x,Kt(y.before,m),v=y.lines,a&&v.length&&(this._drawColorBox(n,e,b,p,s),h=Math.max(d.lineHeight,l)),k=0,N=v.length;k<N;++k)m(v[k]),h=d.lineHeight;Kt(y.after,m)}f=0,h=d.lineHeight,Kt(this.afterBody,m),e.y-=i}drawFooter(e,n,s){const r=this.footer,i=r.length;let o,a;if(i){const l=jh(s.rtl,this.x,this.width);for(e.x=Fx(this,s.footerAlign,s),e.y+=s.footerMarginTop,n.textAlign=l.textAlign(s.footerAlign),n.textBaseline="middle",o=Gs(s.footerFont),n.fillStyle=s.footerColor,n.font=o.string,a=0;a<i;++a)n.fillText(r[a],l.x(e.x),e.y+o.lineHeight/2),e.y+=o.lineHeight+s.footerSpacing}}drawBackground(e,n,s,r){const{xAlign:i,yAlign:o}=this,{x:a,y:l}=e,{width:c,height:u}=s,{topLeft:d,topRight:h,bottomLeft:f,bottomRight:p}=Ju(r.cornerRadius);n.fillStyle=r.backgroundColor,n.strokeStyle=r.borderColor,n.lineWidth=r.borderWidth,n.beginPath(),n.moveTo(a+d,l),o==="top"&&this.drawCaret(e,n,s,r),n.lineTo(a+c-h,l),n.quadraticCurveTo(a+c,l,a+c,l+h),o==="center"&&i==="right"&&this.drawCaret(e,n,s,r),n.lineTo(a+c,l+u-p),n.quadraticCurveTo(a+c,l+u,a+c-p,l+u),o==="bottom"&&this.drawCaret(e,n,s,r),n.lineTo(a+f,l+u),n.quadraticCurveTo(a,l+u,a,l+u-f),o==="center"&&i==="left"&&this.drawCaret(e,n,s,r),n.lineTo(a,l+d),n.quadraticCurveTo(a,l,a+d,l),n.closePath(),n.fill(),r.borderWidth>0&&n.stroke()}_updateAnimationTarget(e){const n=this.chart,s=this.$animations,r=s&&s.x,i=s&&s.y;if(r||i){const o=pm[e.position].call(this,this._active,this._eventPosition);if(!o)return;const a=this._size=qM(this,e),l=Object.assign({},o,this._size),c=XM(n,e,l),u=YM(e,l,c,n);(r._to!==u.x||i._to!==u.y)&&(this.xAlign=c.xAlign,this.yAlign=c.yAlign,this.width=a.width,this.height=a.height,this.caretX=o.x,this.caretY=o.y,this._resolveAnimations().update(this,u))}}_willRender(){return!!this.opacity}draw(e){const n=this.options.setContext(this.getContext());let s=this.opacity;if(!s)return;this._updateAnimationTarget(n);const r={width:this.width,height:this.height},i={x:this.x,y:this.y};s=Math.abs(s)<.001?0:s;const o=Cr(n.padding),a=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;n.enabled&&a&&(e.save(),e.globalAlpha=s,this.drawBackground(i,e,r,n),RH(e,n.textDirection),i.y+=o.top,this.drawTitle(i,e,n),this.drawBody(i,e,n),this.drawFooter(i,e,n),DH(e,n.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,n){const s=this._active,r=e.map(({datasetIndex:a,index:l})=>{const c=this.chart.getDatasetMeta(a);if(!c)throw new Error("Cannot find a dataset at index "+a);return{datasetIndex:a,element:c.data[l],index:l}}),i=!Db(s,r),o=this._positionChanged(r,n);(i||o)&&(this._active=r,this._eventPosition=n,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(e,n,s=!0){if(n&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const r=this.options,i=this._active||[],o=this._getActiveElements(e,i,n,s),a=this._positionChanged(o,e),l=n||!Db(o,i)||a;return l&&(this._active=o,(r.enabled||r.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,n))),l}_getActiveElements(e,n,s,r){const i=this.options;if(e.type==="mouseout")return[];if(!r)return n.filter(a=>this.chart.data.datasets[a.datasetIndex]&&this.chart.getDatasetMeta(a.datasetIndex).controller.getParsed(a.index)!==void 0);const o=this.chart.getElementsAtEventForMode(e,i.mode,i,s);return i.reverse&&o.reverse(),o}_positionChanged(e,n){const{caretX:s,caretY:r,options:i}=this,o=pm[i.position].call(this,e,n);return o!==!1&&(s!==o.x||r!==o.y)}}Je(a2,"positioners",pm);var Mfe={id:"tooltip",_element:a2,positioners:pm,afterInit(t,e,n){n&&(t.tooltip=new a2({chart:t,options:n}))},beforeUpdate(t,e,n){t.tooltip&&t.tooltip.initialize(n)},reset(t,e,n){t.tooltip&&t.tooltip.initialize(n)},afterDraw(t){const e=t.tooltip;if(e&&e._willRender()){const n={tooltip:e};if(t.notifyPlugins("beforeTooltipDraw",{...n,cancelable:!0})===!1)return;e.draw(t.ctx),t.notifyPlugins("afterTooltipDraw",n)}},afterEvent(t,e){if(t.tooltip){const n=e.replay;t.tooltip.handleEvent(e.event,n,e.inChartArea)&&(e.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(t,e)=>e.bodyFont.size,boxWidth:(t,e)=>e.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:qH},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:t=>t!=="filter"&&t!=="itemSort"&&t!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};const zfe=(t,e,n,s)=>(typeof e=="string"?(n=t.push(e)-1,s.unshift({index:n,label:e})):isNaN(e)&&(n=null),n);function Vfe(t,e,n,s){const r=t.indexOf(e);if(r===-1)return zfe(t,e,n,s);const i=t.lastIndexOf(e);return r!==i?n:r}const jfe=(t,e)=>t===null?null:Hr(Math.round(t),0,e);function JM(t){const e=this.getLabels();return t>=0&&t<e.length?e[t]:t}class l2 extends Dd{constructor(e){super(e),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(e){const n=this._addedLabels;if(n.length){const s=this.getLabels();for(const{index:r,label:i}of n)s[r]===i&&s.splice(r,1);this._addedLabels=[]}super.init(e)}parse(e,n){if(Wt(e))return null;const s=this.getLabels();return n=isFinite(n)&&s[n]===e?n:Vfe(s,e,Ot(n,e),this._addedLabels),jfe(n,s.length-1)}determineDataLimits(){const{minDefined:e,maxDefined:n}=this.getUserBounds();let{min:s,max:r}=this.getMinMax(!0);this.options.bounds==="ticks"&&(e||(s=0),n||(r=this.getLabels().length-1)),this.min=s,this.max=r}buildTicks(){const e=this.min,n=this.max,s=this.options.offset,r=[];let i=this.getLabels();i=e===0&&n===i.length-1?i:i.slice(e,n+1),this._valueRange=Math.max(i.length-(s?0:1),1),this._startValue=this.min-(s?.5:0);for(let o=e;o<=n;o++)r.push({value:o});return r}getLabelForValue(e){return JM.call(this,e)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(e){return typeof e!="number"&&(e=this.parse(e)),e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getPixelForTick(e){const n=this.ticks;return e<0||e>n.length-1?null:this.getPixelForValue(n[e].value)}getValueForPixel(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}getBasePixel(){return this.bottom}}Je(l2,"id","category"),Je(l2,"defaults",{ticks:{callback:JM}});function Bfe(t,e){const n=[],{bounds:r,step:i,min:o,max:a,precision:l,count:c,maxTicks:u,maxDigits:d,includeBounds:h}=t,f=i||1,p=u-1,{min:m,max:g}=e,y=!Wt(o),x=!Wt(a),v=!Wt(c),b=(g-m)/(d+1);let k=iM((g-m)/p/f)*f,C,N,I,$;if(k<1e-14&&!y&&!x)return[{value:m},{value:g}];$=Math.ceil(g/k)-Math.floor(m/k),$>p&&(k=iM($*k/p/f)*f),Wt(l)||(C=Math.pow(10,l),k=Math.ceil(k*C)/C),r==="ticks"?(N=Math.floor(m/k)*k,I=Math.ceil(g/k)*k):(N=m,I=g),y&&x&&i&&Bue((a-o)/i,k/1e3)?($=Math.round(Math.min((a-o)/k,u)),k=(a-o)/$,N=o,I=a):v?(N=y?o:N,I=x?a:I,$=c-1,k=(I-N)/$):($=(I-N)/k,Ev($,Math.round($),k/1e3)?$=Math.round($):$=Math.ceil($));const A=Math.max(oM(k),oM(N));C=Math.pow(10,Wt(l)?A:l),N=Math.round(N*C)/C,I=Math.round(I*C)/C;let P=0;for(y&&(h&&N!==o?(n.push({value:o}),N<o&&P++,Ev(Math.round((N+P*k)*C)/C,o,e3(o,b,t))&&P++):N<o&&P++);P<$;++P){const F=Math.round((N+P*k)*C)/C;if(x&&F>a)break;n.push({value:F})}return x&&h&&I!==a?n.length&&Ev(n[n.length-1].value,a,e3(a,b,t))?n[n.length-1].value=a:n.push({value:a}):(!x||I===a)&&n.push({value:I}),n}function e3(t,e,{horizontal:n,minRotation:s}){const r=da(s),i=(n?Math.sin(r):Math.cos(r))||.001,o=.75*e*(""+t).length;return Math.min(e/i,o)}class Bb extends Dd{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(e,n){return Wt(e)||(typeof e=="number"||e instanceof Number)&&!isFinite(+e)?null:+e}handleTickRangeOptions(){const{beginAtZero:e}=this.options,{minDefined:n,maxDefined:s}=this.getUserBounds();let{min:r,max:i}=this;const o=l=>r=n?r:l,a=l=>i=s?i:l;if(e){const l=wc(r),c=wc(i);l<0&&c<0?a(0):l>0&&c>0&&o(0)}if(r===i){let l=i===0?1:Math.abs(i*.05);a(i+l),e||o(r-l)}this.min=r,this.max=i}getTickLimit(){const e=this.options.ticks;let{maxTicksLimit:n,stepSize:s}=e,r;return s?(r=Math.ceil(this.max/s)-Math.floor(this.min/s)+1,r>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${s} would result generating up to ${r} ticks. Limiting to 1000.`),r=1e3)):(r=this.computeTickLimit(),n=n||11),n&&(r=Math.min(n,r)),r}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const e=this.options,n=e.ticks;let s=this.getTickLimit();s=Math.max(2,s);const r={maxTicks:s,bounds:e.bounds,min:e.min,max:e.max,precision:n.precision,step:n.stepSize,count:n.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:n.minRotation||0,includeBounds:n.includeBounds!==!1},i=this._range||this,o=Bfe(r,i);return e.bounds==="ticks"&&yH(o,this,"value"),e.reverse?(o.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),o}configure(){const e=this.ticks;let n=this.min,s=this.max;if(super.configure(),this.options.offset&&e.length){const r=(s-n)/Math.max(e.length-1,1)/2;n-=r,s+=r}this._startValue=n,this._endValue=s,this._valueRange=s-n}getLabelForValue(e){return d1(e,this.chart.options.locale,this.options.ticks.format)}}class c2 extends Bb{determineDataLimits(){const{min:e,max:n}=this.getMinMax(!0);this.min=Os(e)?e:0,this.max=Os(n)?n:1,this.handleTickRangeOptions()}computeTickLimit(){const e=this.isHorizontal(),n=e?this.width:this.height,s=da(this.options.ticks.minRotation),r=(e?Math.sin(s):Math.cos(s))||.001,i=this._resolveTickFontOptions(0);return Math.ceil(n/Math.min(40,i.lineHeight/r))}getPixelForValue(e){return e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getValueForPixel(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}}Je(c2,"id","linear"),Je(c2,"defaults",{ticks:{callback:h1.formatters.numeric}});const kg=t=>Math.floor(sc(t)),yu=(t,e)=>Math.pow(10,kg(t)+e);function t3(t){return t/Math.pow(10,kg(t))===1}function n3(t,e,n){const s=Math.pow(10,n),r=Math.floor(t/s);return Math.ceil(e/s)-r}function Wfe(t,e){const n=e-t;let s=kg(n);for(;n3(t,e,s)>10;)s++;for(;n3(t,e,s)<10;)s--;return Math.min(s,kg(t))}function Ufe(t,{min:e,max:n}){e=ci(t.min,e);const s=[],r=kg(e);let i=Wfe(e,n),o=i<0?Math.pow(10,Math.abs(i)):1;const a=Math.pow(10,i),l=r>i?Math.pow(10,r):0,c=Math.round((e-l)*o)/o,u=Math.floor((e-l)/a/10)*a*10;let d=Math.floor((c-u)/Math.pow(10,i)),h=ci(t.min,Math.round((l+u+d*Math.pow(10,i))*o)/o);for(;h<n;)s.push({value:h,major:t3(h),significand:d}),d>=10?d=d<15?15:20:d++,d>=20&&(i++,d=2,o=i>=0?1:o),h=Math.round((l+u+d*Math.pow(10,i))*o)/o;const f=ci(t.max,h);return s.push({value:f,major:t3(f),significand:d}),s}class s3 extends Dd{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(e,n){const s=Bb.prototype.parse.apply(this,[e,n]);if(s===0){this._zero=!0;return}return Os(s)&&s>0?s:null}determineDataLimits(){const{min:e,max:n}=this.getMinMax(!0);this.min=Os(e)?Math.max(0,e):null,this.max=Os(n)?Math.max(0,n):null,this.options.beginAtZero&&(this._zero=!0),this._zero&&this.min!==this._suggestedMin&&!Os(this._userMin)&&(this.min=e===yu(this.min,0)?yu(this.min,-1):yu(this.min,0)),this.handleTickRangeOptions()}handleTickRangeOptions(){const{minDefined:e,maxDefined:n}=this.getUserBounds();let s=this.min,r=this.max;const i=a=>s=e?s:a,o=a=>r=n?r:a;s===r&&(s<=0?(i(1),o(10)):(i(yu(s,-1)),o(yu(r,1)))),s<=0&&i(yu(r,-1)),r<=0&&o(yu(s,1)),this.min=s,this.max=r}buildTicks(){const e=this.options,n={min:this._userMin,max:this._userMax},s=Ufe(n,this);return e.bounds==="ticks"&&yH(s,this,"value"),e.reverse?(s.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),s}getLabelForValue(e){return e===void 0?"0":d1(e,this.chart.options.locale,this.options.ticks.format)}configure(){const e=this.min;super.configure(),this._startValue=sc(e),this._valueRange=sc(this.max)-sc(e)}getPixelForValue(e){return(e===void 0||e===0)&&(e=this.min),e===null||isNaN(e)?NaN:this.getPixelForDecimal(e===this.min?0:(sc(e)-this._startValue)/this._valueRange)}getValueForPixel(e){const n=this.getDecimalForPixel(e);return Math.pow(10,this._startValue+n*this._valueRange)}}Je(s3,"id","logarithmic"),Je(s3,"defaults",{ticks:{callback:h1.formatters.logarithmic,major:{enabled:!0}}});function u2(t){const e=t.ticks;if(e.display&&t.display){const n=Cr(e.backdropPadding);return Ot(e.font&&e.font.size,Un.font.size)+n.height}return 0}function Hfe(t,e,n){return n=Rn(n)?n:[n],{w:ide(t,e.string,n),h:n.length*e.lineHeight}}function r3(t,e,n,s,r){return t===s||t===r?{start:e-n/2,end:e+n/2}:t<s||t>r?{start:e-n,end:e}:{start:e,end:e+n}}function Gfe(t){const e={l:t.left+t._padding.left,r:t.right-t._padding.right,t:t.top+t._padding.top,b:t.bottom-t._padding.bottom},n=Object.assign({},e),s=[],r=[],i=t._pointLabels.length,o=t.options.pointLabels,a=o.centerPointLabels?tn/i:0;for(let l=0;l<i;l++){const c=o.setContext(t.getPointLabelContext(l));r[l]=c.padding;const u=t.getPointPosition(l,t.drawingArea+r[l],a),d=Gs(c.font),h=Hfe(t.ctx,d,t._pointLabels[l]);s[l]=h;const f=hi(t.getIndexAngle(l)+a),p=Math.round(GE(f)),m=r3(p,u.x,h.w,0,180),g=r3(p,u.y,h.h,90,270);Kfe(n,e,f,m,g)}t.setCenterPoint(e.l-n.l,n.r-e.r,e.t-n.t,n.b-e.b),t._pointLabelItems=Yfe(t,s,r)}function Kfe(t,e,n,s,r){const i=Math.abs(Math.sin(n)),o=Math.abs(Math.cos(n));let a=0,l=0;s.start<e.l?(a=(e.l-s.start)/i,t.l=Math.min(t.l,e.l-a)):s.end>e.r&&(a=(s.end-e.r)/i,t.r=Math.max(t.r,e.r+a)),r.start<e.t?(l=(e.t-r.start)/o,t.t=Math.min(t.t,e.t-l)):r.end>e.b&&(l=(r.end-e.b)/o,t.b=Math.max(t.b,e.b+l))}function qfe(t,e,n){const s=t.drawingArea,{extra:r,additionalAngle:i,padding:o,size:a}=n,l=t.getPointPosition(e,s+r+o,i),c=Math.round(GE(hi(l.angle+ns))),u=Jfe(l.y,a.h,c),d=Zfe(c),h=Qfe(l.x,a.w,d);return{visible:!0,x:l.x,y:u,textAlign:d,left:h,top:u,right:h+a.w,bottom:u+a.h}}function Xfe(t,e){if(!e)return!0;const{left:n,top:s,right:r,bottom:i}=t;return!(_h({x:n,y:s},e)||_h({x:n,y:i},e)||_h({x:r,y:s},e)||_h({x:r,y:i},e))}function Yfe(t,e,n){const s=[],r=t._pointLabels.length,i=t.options,{centerPointLabels:o,display:a}=i.pointLabels,l={extra:u2(i)/2,additionalAngle:o?tn/r:0};let c;for(let u=0;u<r;u++){l.padding=n[u],l.size=e[u];const d=qfe(t,u,l);s.push(d),a==="auto"&&(d.visible=Xfe(d,c),d.visible&&(c=d))}return s}function Zfe(t){return t===0||t===180?"center":t<180?"left":"right"}function Qfe(t,e,n){return n==="right"?t-=e:n==="center"&&(t-=e/2),t}function Jfe(t,e,n){return n===90||n===270?t-=e/2:(n>270||n<90)&&(t-=e),t}function epe(t,e,n){const{left:s,top:r,right:i,bottom:o}=n,{backdropColor:a}=e;if(!Wt(a)){const l=Ju(e.borderRadius),c=Cr(e.backdropPadding);t.fillStyle=a;const u=s-c.left,d=r-c.top,h=i-s+c.width,f=o-r+c.height;Object.values(l).some(p=>p!==0)?(t.beginPath(),wg(t,{x:u,y:d,w:h,h:f,radius:l}),t.fill()):t.fillRect(u,d,h,f)}}function tpe(t,e){const{ctx:n,options:{pointLabels:s}}=t;for(let r=e-1;r>=0;r--){const i=t._pointLabelItems[r];if(!i.visible)continue;const o=s.setContext(t.getPointLabelContext(r));epe(n,o,i);const a=Gs(o.font),{x:l,y:c,textAlign:u}=i;Nf(n,t._pointLabels[r],l,c+a.lineHeight/2,a,{color:o.color,textAlign:u,textBaseline:"middle"})}}function XH(t,e,n,s){const{ctx:r}=t;if(n)r.arc(t.xCenter,t.yCenter,e,0,Wn);else{let i=t.getPointPosition(0,e);r.moveTo(i.x,i.y);for(let o=1;o<s;o++)i=t.getPointPosition(o,e),r.lineTo(i.x,i.y)}}function npe(t,e,n,s,r){const i=t.ctx,o=e.circular,{color:a,lineWidth:l}=e;!o&&!s||!a||!l||n<0||(i.save(),i.strokeStyle=a,i.lineWidth=l,i.setLineDash(r.dash||[]),i.lineDashOffset=r.dashOffset,i.beginPath(),XH(t,n,o,s),i.closePath(),i.stroke(),i.restore())}function spe(t,e,n){return Rd(t,{label:n,index:e,type:"pointLabel"})}class Lx extends Bb{constructor(e){super(e),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){const e=this._padding=Cr(u2(this.options)/2),n=this.width=this.maxWidth-e.width,s=this.height=this.maxHeight-e.height;this.xCenter=Math.floor(this.left+n/2+e.left),this.yCenter=Math.floor(this.top+s/2+e.top),this.drawingArea=Math.floor(Math.min(n,s)/2)}determineDataLimits(){const{min:e,max:n}=this.getMinMax(!1);this.min=Os(e)&&!isNaN(e)?e:0,this.max=Os(n)&&!isNaN(n)?n:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/u2(this.options))}generateTickLabels(e){Bb.prototype.generateTickLabels.call(this,e),this._pointLabels=this.getLabels().map((n,s)=>{const r=an(this.options.pointLabels.callback,[n,s],this);return r||r===0?r:""}).filter((n,s)=>this.chart.getDataVisibility(s))}fit(){const e=this.options;e.display&&e.pointLabels.display?Gfe(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(e,n,s,r){this.xCenter+=Math.floor((e-n)/2),this.yCenter+=Math.floor((s-r)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(e,n,s,r))}getIndexAngle(e){const n=Wn/(this._pointLabels.length||1),s=this.options.startAngle||0;return hi(e*n+da(s))}getDistanceFromCenterForValue(e){if(Wt(e))return NaN;const n=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-e)*n:(e-this.min)*n}getValueForDistanceFromCenter(e){if(Wt(e))return NaN;const n=e/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-n:this.min+n}getPointLabelContext(e){const n=this._pointLabels||[];if(e>=0&&e<n.length){const s=n[e];return spe(this.getContext(),e,s)}}getPointPosition(e,n,s=0){const r=this.getIndexAngle(e)-ns+s;return{x:Math.cos(r)*n+this.xCenter,y:Math.sin(r)*n+this.yCenter,angle:r}}getPointPositionForValue(e,n){return this.getPointPosition(e,this.getDistanceFromCenterForValue(n))}getBasePosition(e){return this.getPointPositionForValue(e||0,this.getBaseValue())}getPointLabelPosition(e){const{left:n,top:s,right:r,bottom:i}=this._pointLabelItems[e];return{left:n,top:s,right:r,bottom:i}}drawBackground(){const{backgroundColor:e,grid:{circular:n}}=this.options;if(e){const s=this.ctx;s.save(),s.beginPath(),XH(this,this.getDistanceFromCenterForValue(this._endValue),n,this._pointLabels.length),s.closePath(),s.fillStyle=e,s.fill(),s.restore()}}drawGrid(){const e=this.ctx,n=this.options,{angleLines:s,grid:r,border:i}=n,o=this._pointLabels.length;let a,l,c;if(n.pointLabels.display&&tpe(this,o),r.display&&this.ticks.forEach((u,d)=>{if(d!==0||d===0&&this.min<0){l=this.getDistanceFromCenterForValue(u.value);const h=this.getContext(d),f=r.setContext(h),p=i.setContext(h);npe(this,f,l,o,p)}}),s.display){for(e.save(),a=o-1;a>=0;a--){const u=s.setContext(this.getPointLabelContext(a)),{color:d,lineWidth:h}=u;!h||!d||(e.lineWidth=h,e.strokeStyle=d,e.setLineDash(u.borderDash),e.lineDashOffset=u.borderDashOffset,l=this.getDistanceFromCenterForValue(n.reverse?this.min:this.max),c=this.getPointPosition(a,l),e.beginPath(),e.moveTo(this.xCenter,this.yCenter),e.lineTo(c.x,c.y),e.stroke())}e.restore()}}drawBorder(){}drawLabels(){const e=this.ctx,n=this.options,s=n.ticks;if(!s.display)return;const r=this.getIndexAngle(0);let i,o;e.save(),e.translate(this.xCenter,this.yCenter),e.rotate(r),e.textAlign="center",e.textBaseline="middle",this.ticks.forEach((a,l)=>{if(l===0&&this.min>=0&&!n.reverse)return;const c=s.setContext(this.getContext(l)),u=Gs(c.font);if(i=this.getDistanceFromCenterForValue(this.ticks[l].value),c.showLabelBackdrop){e.font=u.string,o=e.measureText(a.label).width,e.fillStyle=c.backdropColor;const d=Cr(c.backdropPadding);e.fillRect(-o/2-d.left,-i-u.size/2-d.top,o+d.width,u.size+d.height)}Nf(e,a.label,0,-i,u,{color:c.color,strokeColor:c.textStrokeColor,strokeWidth:c.textStrokeWidth})}),e.restore()}drawTitle(){}}Je(Lx,"id","radialLinear"),Je(Lx,"defaults",{display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:h1.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback(e){return e},padding:5,centerPointLabels:!1}}),Je(Lx,"defaultRoutes",{"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"}),Je(Lx,"descriptors",{angleLines:{_fallback:"grid"}});const m1={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},Br=Object.keys(m1);function i3(t,e){return t-e}function o3(t,e){if(Wt(e))return null;const n=t._adapter,{parser:s,round:r,isoWeekday:i}=t._parseOpts;let o=e;return typeof s=="function"&&(o=s(o)),Os(o)||(o=typeof s=="string"?n.parse(o,s):n.parse(o)),o===null?null:(r&&(o=r==="week"&&(Fb(i)||i===!0)?n.startOf(o,"isoWeek",i):n.startOf(o,r)),+o)}function a3(t,e,n,s){const r=Br.length;for(let i=Br.indexOf(t);i<r-1;++i){const o=m1[Br[i]],a=o.steps?o.steps:Number.MAX_SAFE_INTEGER;if(o.common&&Math.ceil((n-e)/(a*o.size))<=s)return Br[i]}return Br[r-1]}function rpe(t,e,n,s,r){for(let i=Br.length-1;i>=Br.indexOf(n);i--){const o=Br[i];if(m1[o].common&&t._adapter.diff(r,s,o)>=e-1)return o}return Br[n?Br.indexOf(n):0]}function ipe(t){for(let e=Br.indexOf(t)+1,n=Br.length;e<n;++e)if(m1[Br[e]].common)return Br[e]}function l3(t,e,n){if(!n)t[e]=!0;else if(n.length){const{lo:s,hi:r}=KE(n,e),i=n[s]>=e?n[s]:n[r];t[i]=!0}}function ope(t,e,n,s){const r=t._adapter,i=+r.startOf(e[0].value,s),o=e[e.length-1].value;let a,l;for(a=i;a<=o;a=+r.add(a,1,s))l=n[a],l>=0&&(e[l].major=!0);return e}function c3(t,e,n){const s=[],r={},i=e.length;let o,a;for(o=0;o<i;++o)a=e[o],r[a]=o,s.push({value:a,major:!1});return i===0||!n?s:ope(t,s,r,n)}class Wb extends Dd{constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e,n={}){const s=e.time||(e.time={}),r=this._adapter=new ihe._date(e.adapters.date);r.init(n),jm(s.displayFormats,r.formats()),this._parseOpts={parser:s.parser,round:s.round,isoWeekday:s.isoWeekday},super.init(e),this._normalized=n.normalized}parse(e,n){return e===void 0?null:o3(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const e=this.options,n=this._adapter,s=e.time.unit||"day";let{min:r,max:i,minDefined:o,maxDefined:a}=this.getUserBounds();function l(c){!o&&!isNaN(c.min)&&(r=Math.min(r,c.min)),!a&&!isNaN(c.max)&&(i=Math.max(i,c.max))}(!o||!a)&&(l(this._getLabelBounds()),(e.bounds!=="ticks"||e.ticks.source!=="labels")&&l(this.getMinMax(!1))),r=Os(r)&&!isNaN(r)?r:+n.startOf(Date.now(),s),i=Os(i)&&!isNaN(i)?i:+n.endOf(Date.now(),s)+1,this.min=Math.min(r,i-1),this.max=Math.max(r+1,i)}_getLabelBounds(){const e=this.getLabelTimestamps();let n=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY;return e.length&&(n=e[0],s=e[e.length-1]),{min:n,max:s}}buildTicks(){const e=this.options,n=e.time,s=e.ticks,r=s.source==="labels"?this.getLabelTimestamps():this._generate();e.bounds==="ticks"&&r.length&&(this.min=this._userMin||r[0],this.max=this._userMax||r[r.length-1]);const i=this.min,o=this.max,a=Gue(r,i,o);return this._unit=n.unit||(s.autoSkip?a3(n.minUnit,this.min,this.max,this._getLabelCapacity(i)):rpe(this,a.length,n.minUnit,this.min,this.max)),this._majorUnit=!s.major.enabled||this._unit==="year"?void 0:ipe(this._unit),this.initOffsets(r),e.reverse&&a.reverse(),c3(this,a,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(e=>+e.value))}initOffsets(e=[]){let n=0,s=0,r,i;this.options.offset&&e.length&&(r=this.getDecimalForValue(e[0]),e.length===1?n=1-r:n=(this.getDecimalForValue(e[1])-r)/2,i=this.getDecimalForValue(e[e.length-1]),e.length===1?s=i:s=(i-this.getDecimalForValue(e[e.length-2]))/2);const o=e.length<3?.5:.25;n=Hr(n,0,o),s=Hr(s,0,o),this._offsets={start:n,end:s,factor:1/(n+1+s)}}_generate(){const e=this._adapter,n=this.min,s=this.max,r=this.options,i=r.time,o=i.unit||a3(i.minUnit,n,s,this._getLabelCapacity(n)),a=Ot(r.ticks.stepSize,1),l=o==="week"?i.isoWeekday:!1,c=Fb(l)||l===!0,u={};let d=n,h,f;if(c&&(d=+e.startOf(d,"isoWeek",l)),d=+e.startOf(d,c?"day":o),e.diff(s,n,o)>1e5*a)throw new Error(n+" and "+s+" are too far apart with stepSize of "+a+" "+o);const p=r.ticks.source==="data"&&this.getDataTimestamps();for(h=d,f=0;h<s;h=+e.add(h,a,o),f++)l3(u,h,p);return(h===s||r.bounds==="ticks"||f===1)&&l3(u,h,p),Object.keys(u).sort(i3).map(m=>+m)}getLabelForValue(e){const n=this._adapter,s=this.options.time;return s.tooltipFormat?n.format(e,s.tooltipFormat):n.format(e,s.displayFormats.datetime)}format(e,n){const r=this.options.time.displayFormats,i=this._unit,o=n||r[i];return this._adapter.format(e,o)}_tickFormatFunction(e,n,s,r){const i=this.options,o=i.ticks.callback;if(o)return an(o,[e,n,s],this);const a=i.time.displayFormats,l=this._unit,c=this._majorUnit,u=l&&a[l],d=c&&a[c],h=s[n],f=c&&d&&h&&h.major;return this._adapter.format(e,r||(f?d:u))}generateTickLabels(e){let n,s,r;for(n=0,s=e.length;n<s;++n)r=e[n],r.label=this._tickFormatFunction(r.value,n,e)}getDecimalForValue(e){return e===null?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){const n=this._offsets,s=this.getDecimalForValue(e);return this.getPixelForDecimal((n.start+s)*n.factor)}getValueForPixel(e){const n=this._offsets,s=this.getDecimalForPixel(e)/n.factor-n.end;return this.min+s*(this.max-this.min)}_getLabelSize(e){const n=this.options.ticks,s=this.ctx.measureText(e).width,r=da(this.isHorizontal()?n.maxRotation:n.minRotation),i=Math.cos(r),o=Math.sin(r),a=this._resolveTickFontOptions(0).size;return{w:s*i+a*o,h:s*o+a*i}}_getLabelCapacity(e){const n=this.options.time,s=n.displayFormats,r=s[n.unit]||s.millisecond,i=this._tickFormatFunction(e,0,c3(this,[e],this._majorUnit),r),o=this._getLabelSize(i),a=Math.floor(this.isHorizontal()?this.width/o.w:this.height/o.h)-1;return a>0?a:1}getDataTimestamps(){let e=this._cache.data||[],n,s;if(e.length)return e;const r=this.getMatchingVisibleMetas();if(this._normalized&&r.length)return this._cache.data=r[0].controller.getAllParsedValues(this);for(n=0,s=r.length;n<s;++n)e=e.concat(r[n].controller.getAllParsedValues(this));return this._cache.data=this.normalize(e)}getLabelTimestamps(){const e=this._cache.labels||[];let n,s;if(e.length)return e;const r=this.getLabels();for(n=0,s=r.length;n<s;++n)e.push(o3(this,r[n]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return bH(e.sort(i3))}}Je(Wb,"id","time"),Je(Wb,"defaults",{bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}});function Mx(t,e,n){let s=0,r=t.length-1,i,o,a,l;n?(e>=t[s].pos&&e<=t[r].pos&&({lo:s,hi:r}=n2(t,"pos",e)),{pos:i,time:a}=t[s],{pos:o,time:l}=t[r]):(e>=t[s].time&&e<=t[r].time&&({lo:s,hi:r}=n2(t,"time",e)),{time:i,pos:a}=t[s],{time:o,pos:l}=t[r]);const c=o-i;return c?a+(l-a)*(e-i)/c:a}class u3 extends Wb{constructor(e){super(e),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const e=this._getTimestampsForTable(),n=this._table=this.buildLookupTable(e);this._minPos=Mx(n,this.min),this._tableRange=Mx(n,this.max)-this._minPos,super.initOffsets(e)}buildLookupTable(e){const{min:n,max:s}=this,r=[],i=[];let o,a,l,c,u;for(o=0,a=e.length;o<a;++o)c=e[o],c>=n&&c<=s&&r.push(c);if(r.length<2)return[{time:n,pos:0},{time:s,pos:1}];for(o=0,a=r.length;o<a;++o)u=r[o+1],l=r[o-1],c=r[o],Math.round((u+l)/2)!==c&&i.push({time:c,pos:o/(a-1)});return i}_generate(){const e=this.min,n=this.max;let s=super.getDataTimestamps();return(!s.includes(e)||!s.length)&&s.splice(0,0,e),(!s.includes(n)||s.length===1)&&s.push(n),s.sort((r,i)=>r-i)}_getTimestampsForTable(){let e=this._cache.all||[];if(e.length)return e;const n=this.getDataTimestamps(),s=this.getLabelTimestamps();return n.length&&s.length?e=this.normalize(n.concat(s)):e=n.length?n:s,e=this._cache.all=e,e}getDecimalForValue(e){return(Mx(this._table,e)-this._minPos)/this._tableRange}getValueForPixel(e){const n=this._offsets,s=this.getDecimalForPixel(e)/n.factor-n.end;return Mx(this._table,s*this._tableRange+this._minPos,!0)}}Je(u3,"id","timeseries"),Je(u3,"defaults",Wb.defaults);const YH="label";function d3(t,e){typeof t=="function"?t(e):t&&(t.current=e)}function ape(t,e){const n=t.options;n&&e&&Object.assign(n,e)}function ZH(t,e){t.labels=e}function QH(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:YH;const s=[];t.datasets=e.map(r=>{const i=t.datasets.find(o=>o[n]===r[n]);return!i||!r.data||s.includes(i)?{...r}:(s.push(i),Object.assign(i,r),i)})}function lpe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:YH;const n={labels:[],datasets:[]};return ZH(n,t.labels),QH(n,t.datasets,e),n}function cpe(t,e){const{height:n=150,width:s=300,redraw:r=!1,datasetIdKey:i,type:o,data:a,options:l,plugins:c=[],fallbackContent:u,updateMode:d,...h}=t,f=D.useRef(null),p=D.useRef(null),m=()=>{f.current&&(p.current=new p1(f.current,{type:o,data:lpe(a,i),options:l&&{...l},plugins:c}),d3(e,p.current))},g=()=>{d3(e,null),p.current&&(p.current.destroy(),p.current=null)};return D.useEffect(()=>{!r&&p.current&&l&&ape(p.current,l)},[r,l]),D.useEffect(()=>{!r&&p.current&&ZH(p.current.config.data,a.labels)},[r,a.labels]),D.useEffect(()=>{!r&&p.current&&a.datasets&&QH(p.current.config.data,a.datasets,i)},[r,a.datasets]),D.useEffect(()=>{p.current&&(r?(g(),setTimeout(m)):p.current.update(d))},[r,l,a.labels,a.datasets,d]),D.useEffect(()=>{p.current&&(g(),setTimeout(m))},[o]),D.useEffect(()=>(m(),()=>g()),[]),et.createElement("canvas",{ref:f,role:"img",height:n,width:s,...h},u)}const upe=D.forwardRef(cpe);function JH(t,e){return p1.register(e),D.forwardRef((n,s)=>et.createElement(upe,{...n,ref:s,type:t}))}const dpe=JH("bar",$v),hpe=JH("pie",r2),fpe=(t,e,n,s)=>{if(n==="length"||n==="prototype"||n==="arguments"||n==="caller")return;const r=Object.getOwnPropertyDescriptor(t,n),i=Object.getOwnPropertyDescriptor(e,n);!ppe(r,i)&&s||Object.defineProperty(t,n,i)},ppe=function(t,e){return t===void 0||t.configurable||t.writable===e.writable&&t.enumerable===e.enumerable&&t.configurable===e.configurable&&(t.writable||t.value===e.value)},mpe=(t,e)=>{const n=Object.getPrototypeOf(e);n!==Object.getPrototypeOf(t)&&Object.setPrototypeOf(t,n)},gpe=(t,e)=>`/* Wrapped ${t}*/
${e}`,ype=Object.getOwnPropertyDescriptor(Function.prototype,"toString"),xpe=Object.getOwnPropertyDescriptor(Function.prototype.toString,"name"),vpe=(t,e,n)=>{const s=n===""?"":`with ${n.trim()}() `,r=gpe.bind(null,s,e.toString());Object.defineProperty(r,"name",xpe);const{writable:i,enumerable:o,configurable:a}=ype;Object.defineProperty(t,"toString",{value:r,writable:i,enumerable:o,configurable:a})};function bpe(t,e,{ignoreNonConfigurable:n=!1}={}){const{name:s}=t;for(const r of Reflect.ownKeys(e))fpe(t,e,r,n);return mpe(t,e),vpe(t,e,s),t}const wpe=new WeakMap,h3=new WeakMap;function e6(t,{cacheKey:e,cache:n=new Map,maxAge:s}={}){if(s===0)return t;if(typeof s=="number"){if(s>2147483647)throw new TypeError("The `maxAge` option cannot exceed 2147483647.");if(s<0)throw new TypeError("The `maxAge` option should not be a negative number.")}const r=function(...i){var u;const o=e?e(i):i[0],a=n.get(o);if(a)return a.data;const l=t.apply(this,i),c=typeof s=="function"?s(...i):s;if(n.set(o,{data:l,maxAge:c?Date.now()+c:Number.POSITIVE_INFINITY}),c&&c>0&&c!==Number.POSITIVE_INFINITY){const d=setTimeout(()=>{n.delete(o)},c);(u=d.unref)==null||u.call(d);const h=h3.get(t)??new Set;h.add(d),h3.set(t,h)}return l};return bpe(r,t,{ignoreNonConfigurable:!0}),wpe.set(r,n),r}function Spe(t){return typeof t=="string"}function kpe(t,e,n){return n.indexOf(t)===e}function Cpe(t){return t.toLowerCase()===t}function f3(t){return t.indexOf(",")===-1?t:t.split(",")}function d2(t){if(!t)return t;if(t==="C"||t==="posix"||t==="POSIX")return"en-US";if(t.indexOf(".")!==-1){var e=t.split(".")[0],n=e===void 0?"":e;return d2(n)}if(t.indexOf("@")!==-1){var s=t.split("@")[0],n=s===void 0?"":s;return d2(n)}if(t.indexOf("-")===-1||!Cpe(t))return t;var r=t.split("-"),i=r[0],o=r[1],a=o===void 0?"":o;return"".concat(i,"-").concat(a.toUpperCase())}function Tpe(t){var e=t===void 0?{}:t,n=e.useFallbackLocale,s=n===void 0?!0:n,r=e.fallbackLocale,i=r===void 0?"en-US":r,o=[];if(typeof navigator<"u"){for(var a=navigator.languages||[],l=[],c=0,u=a;c<u.length;c++){var d=u[c];l=l.concat(f3(d))}var h=navigator.language,f=h&&f3(h);o=o.concat(l,f)}return s&&o.push(i),o.filter(Spe).map(d2).filter(kpe)}var Npe=e6(Tpe,{cacheKey:JSON.stringify});function Ipe(t){return Npe(t)[0]||null}var t6=e6(Ipe,{cacheKey:JSON.stringify});function bl(t,e,n){return function(r,i=n){const o=t(r)+i;return e(o)}}function py(t){return function(n){return new Date(t(n).getTime()-1)}}function my(t,e){return function(s){return[t(s),e(s)]}}function Nn(t){if(t instanceof Date)return t.getFullYear();if(typeof t=="number")return t;const e=Number.parseInt(t,10);if(typeof t=="string"&&!Number.isNaN(e))return e;throw new Error(`Failed to get year from date: ${t}.`)}function Qc(t){if(t instanceof Date)return t.getMonth();throw new Error(`Failed to get month from date: ${t}.`)}function g1(t){if(t instanceof Date)return t.getDate();throw new Error(`Failed to get year from date: ${t}.`)}function tp(t){const e=Nn(t),n=e+(-e+1)%100,s=new Date;return s.setFullYear(n,0,1),s.setHours(0,0,0,0),s}const _pe=bl(Nn,tp,-100),n6=bl(Nn,tp,100),s$=py(n6),Epe=bl(Nn,s$,-100),s6=my(tp,s$);function Jc(t){const e=Nn(t),n=e+(-e+1)%10,s=new Date;return s.setFullYear(n,0,1),s.setHours(0,0,0,0),s}const r6=bl(Nn,Jc,-10),r$=bl(Nn,Jc,10),y1=py(r$),i6=bl(Nn,y1,-10),o6=my(Jc,y1);function np(t){const e=Nn(t),n=new Date;return n.setFullYear(e,0,1),n.setHours(0,0,0,0),n}const a6=bl(Nn,np,-1),i$=bl(Nn,np,1),x1=py(i$),l6=bl(Nn,x1,-1),$pe=my(np,x1);function o$(t,e){return function(s,r=e){const i=Nn(s),o=Qc(s)+r,a=new Date;return a.setFullYear(i,o,1),a.setHours(0,0,0,0),t(a)}}function Od(t){const e=Nn(t),n=Qc(t),s=new Date;return s.setFullYear(e,n,1),s.setHours(0,0,0,0),s}const c6=o$(Od,-1),a$=o$(Od,1),gy=py(a$),u6=o$(gy,-1),Ape=my(Od,gy);function Rpe(t,e){return function(s,r=e){const i=Nn(s),o=Qc(s),a=g1(s)+r,l=new Date;return l.setFullYear(i,o,a),l.setHours(0,0,0,0),t(l)}}function yy(t){const e=Nn(t),n=Qc(t),s=g1(t),r=new Date;return r.setFullYear(e,n,s),r.setHours(0,0,0,0),r}const Dpe=Rpe(yy,1),l$=py(Dpe),Ope=my(yy,l$);function d6(t){return g1(gy(t))}var Hs={GREGORY:"gregory",HEBREW:"hebrew",ISLAMIC:"islamic",ISO_8601:"iso8601"},Ppe={gregory:["en-CA","en-US","es-AR","es-BO","es-CL","es-CO","es-CR","es-DO","es-EC","es-GT","es-HN","es-MX","es-NI","es-PA","es-PE","es-PR","es-SV","es-VE","pt-BR"],hebrew:["he","he-IL"],islamic:["ar","ar-AE","ar-BH","ar-DZ","ar-EG","ar-IQ","ar-JO","ar-KW","ar-LY","ar-OM","ar-QA","ar-SA","ar-SD","ar-SY","ar-YE","dv","dv-MV","ps","ps-AR"]},c$=[0,1,2,3,4,5,6],LC=new Map;function Fpe(t){return function(n,s){var r=n||t6();LC.has(r)||LC.set(r,new Map);var i=LC.get(r);return i.has(t)||i.set(t,new Intl.DateTimeFormat(r||void 0,t).format),i.get(t)(s)}}function Lpe(t){var e=new Date(t);return new Date(e.setHours(12))}function Pd(t){return function(e,n){return Fpe(t)(e,Lpe(n))}}var Mpe={day:"numeric"},zpe={day:"numeric",month:"long",year:"numeric"},Vpe={month:"long"},jpe={month:"long",year:"numeric"},Bpe={weekday:"short"},Wpe={weekday:"long"},Upe={year:"numeric"},Hpe=Pd(Mpe),Gpe=Pd(zpe),Kpe=Pd(Vpe),h6=Pd(jpe),qpe=Pd(Bpe),Xpe=Pd(Wpe),v1=Pd(Upe),Ype=c$[0],Zpe=c$[5],p3=c$[6];function Cg(t,e){e===void 0&&(e=Hs.ISO_8601);var n=t.getDay();switch(e){case Hs.ISO_8601:return(n+6)%7;case Hs.ISLAMIC:return(n+1)%7;case Hs.HEBREW:case Hs.GREGORY:return n;default:throw new Error("Unsupported calendar type.")}}function Qpe(t){var e=tp(t);return Nn(e)}function Jpe(t){var e=Jc(t);return Nn(e)}function h2(t,e){e===void 0&&(e=Hs.ISO_8601);var n=Nn(t),s=Qc(t),r=t.getDate()-Cg(t,e);return new Date(n,s,r)}function eme(t,e){e===void 0&&(e=Hs.ISO_8601);var n=e===Hs.GREGORY?Hs.GREGORY:Hs.ISO_8601,s=h2(t,e),r=Nn(t)+1,i,o;do i=new Date(r,0,n===Hs.ISO_8601?4:1),o=h2(i,e),r-=1;while(t<o);return Math.round((s.getTime()-o.getTime())/(864e5*7))+1}function td(t,e){switch(t){case"century":return tp(e);case"decade":return Jc(e);case"year":return np(e);case"month":return Od(e);case"day":return yy(e);default:throw new Error("Invalid rangeType: ".concat(t))}}function tme(t,e){switch(t){case"century":return _pe(e);case"decade":return r6(e);case"year":return a6(e);case"month":return c6(e);default:throw new Error("Invalid rangeType: ".concat(t))}}function f6(t,e){switch(t){case"century":return n6(e);case"decade":return r$(e);case"year":return i$(e);case"month":return a$(e);default:throw new Error("Invalid rangeType: ".concat(t))}}function nme(t,e){switch(t){case"decade":return r6(e,-100);case"year":return a6(e,-10);case"month":return c6(e,-12);default:throw new Error("Invalid rangeType: ".concat(t))}}function sme(t,e){switch(t){case"decade":return r$(e,100);case"year":return i$(e,10);case"month":return a$(e,12);default:throw new Error("Invalid rangeType: ".concat(t))}}function p6(t,e){switch(t){case"century":return s$(e);case"decade":return y1(e);case"year":return x1(e);case"month":return gy(e);case"day":return l$(e);default:throw new Error("Invalid rangeType: ".concat(t))}}function rme(t,e){switch(t){case"century":return Epe(e);case"decade":return i6(e);case"year":return l6(e);case"month":return u6(e);default:throw new Error("Invalid rangeType: ".concat(t))}}function ime(t,e){switch(t){case"decade":return i6(e,-100);case"year":return l6(e,-10);case"month":return u6(e,-12);default:throw new Error("Invalid rangeType: ".concat(t))}}function m3(t,e){switch(t){case"century":return s6(e);case"decade":return o6(e);case"year":return $pe(e);case"month":return Ape(e);case"day":return Ope(e);default:throw new Error("Invalid rangeType: ".concat(t))}}function ome(t,e,n){var s=[e,n].sort(function(r,i){return r.getTime()-i.getTime()});return[td(t,s[0]),p6(t,s[1])]}function m6(t,e,n){return n.map(function(s){return(e||v1)(t,s)}).join(" – ")}function ame(t,e,n){return m6(t,e,s6(n))}function g6(t,e,n){return m6(t,e,o6(n))}function lme(t){return t.getDay()===new Date().getDay()}function y6(t,e){e===void 0&&(e=Hs.ISO_8601);var n=t.getDay();switch(e){case Hs.ISLAMIC:case Hs.HEBREW:return n===Zpe||n===p3;case Hs.ISO_8601:case Hs.GREGORY:return n===p3||n===Ype;default:throw new Error("Unsupported calendar type.")}}var Xo="react-calendar__navigation";function cme(t){var e=t.activeStartDate,n=t.drillUp,s=t.formatMonthYear,r=s===void 0?h6:s,i=t.formatYear,o=i===void 0?v1:i,a=t.locale,l=t.maxDate,c=t.minDate,u=t.navigationAriaLabel,d=u===void 0?"":u,h=t.navigationAriaLive,f=t.navigationLabel,p=t.next2AriaLabel,m=p===void 0?"":p,g=t.next2Label,y=g===void 0?"»":g,x=t.nextAriaLabel,v=x===void 0?"":x,b=t.nextLabel,k=b===void 0?"›":b,C=t.prev2AriaLabel,N=C===void 0?"":C,I=t.prev2Label,$=I===void 0?"«":I,A=t.prevAriaLabel,P=A===void 0?"":A,F=t.prevLabel,V=F===void 0?"‹":F,z=t.setActiveStartDate,B=t.showDoubleView,W=t.view,q=t.views,M=q.indexOf(W)>0,G=W!=="century",ne=tme(W,e),ie=G?nme(W,e):void 0,de=f6(W,e),he=G?sme(W,e):void 0,pe=function(){if(ne.getFullYear()<0)return!0;var Me=rme(W,e);return c&&c>=Me}(),me=G&&function(){if(ie.getFullYear()<0)return!0;var Me=ime(W,e);return c&&c>=Me}(),ye=l&&l<de,Ce=G&&l&&l<he;function Le(){z(ne,"prev")}function Re(){z(ie,"prev2")}function Ze(){z(de,"next")}function tt(){z(he,"next2")}function mt(Me){var wt=function(){switch(W){case"century":return ame(a,o,Me);case"decade":return g6(a,o,Me);case"year":return o(a,Me);case"month":return r(a,Me);default:throw new Error("Invalid view: ".concat(W,"."))}}();return f?f({date:Me,label:wt,locale:a||t6()||void 0,view:W}):wt}function Xe(){var Me="".concat(Xo,"__label");return S.jsxs("button",{"aria-label":d,"aria-live":h,className:Me,disabled:!M,onClick:n,style:{flexGrow:1},type:"button",children:[S.jsx("span",{className:"".concat(Me,"__labelText ").concat(Me,"__labelText--from"),children:mt(e)}),B?S.jsxs(S.Fragment,{children:[S.jsx("span",{className:"".concat(Me,"__divider"),children:" – "}),S.jsx("span",{className:"".concat(Me,"__labelText ").concat(Me,"__labelText--to"),children:mt(de)})]}):null]})}return S.jsxs("div",{className:Xo,children:[$!==null&&G?S.jsx("button",{"aria-label":N,className:"".concat(Xo,"__arrow ").concat(Xo,"__prev2-button"),disabled:me,onClick:Re,type:"button",children:$}):null,V!==null&&S.jsx("button",{"aria-label":P,className:"".concat(Xo,"__arrow ").concat(Xo,"__prev-button"),disabled:pe,onClick:Le,type:"button",children:V}),Xe(),k!==null&&S.jsx("button",{"aria-label":v,className:"".concat(Xo,"__arrow ").concat(Xo,"__next-button"),disabled:ye,onClick:Ze,type:"button",children:k}),y!==null&&G?S.jsx("button",{"aria-label":m,className:"".concat(Xo,"__arrow ").concat(Xo,"__next2-button"),disabled:Ce,onClick:tt,type:"button",children:y}):null]})}var Eh=globalThis&&globalThis.__assign||function(){return Eh=Object.assign||function(t){for(var e,n=1,s=arguments.length;n<s;n++){e=arguments[n];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}return t},Eh.apply(this,arguments)},ume=globalThis&&globalThis.__rest||function(t,e){var n={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(n[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,s=Object.getOwnPropertySymbols(t);r<s.length;r++)e.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(t,s[r])&&(n[s[r]]=t[s[r]]);return n};function g3(t){return"".concat(t,"%")}function u$(t){var e=t.children,n=t.className,s=t.count,r=t.direction,i=t.offset,o=t.style,a=t.wrap,l=ume(t,["children","className","count","direction","offset","style","wrap"]);return S.jsx("div",Eh({className:n,style:Eh({display:"flex",flexDirection:r,flexWrap:a?"wrap":"nowrap"},o)},l,{children:D.Children.map(e,function(c,u){var d=i&&u===0?g3(100*i/s):null;return D.cloneElement(c,Eh(Eh({},c.props),{style:{flexBasis:g3(100/s),flexShrink:0,flexGrow:0,overflow:"hidden",marginLeft:d,marginInlineStart:d,marginInlineEnd:0}}))})}))}function dme(t,e,n){return e&&e>t?e:n&&n<t?n:t}function Tg(t,e){return e[0]<=t&&e[1]>=t}function hme(t,e){return t[0]<=e[0]&&t[1]>=e[1]}function x6(t,e){return Tg(t[0],e)||Tg(t[1],e)}function y3(t,e,n){var s=x6(e,t),r=[];if(s){r.push(n);var i=Tg(t[0],e),o=Tg(t[1],e);i&&r.push("".concat(n,"Start")),o&&r.push("".concat(n,"End")),i&&o&&r.push("".concat(n,"BothEnds"))}return r}function fme(t){return Array.isArray(t)?t[0]!==null&&t[1]!==null:t!==null}function pme(t){if(!t)throw new Error("args is required");var e=t.value,n=t.date,s=t.hover,r="react-calendar__tile",i=[r];if(!n)return i;var o=new Date,a=function(){if(Array.isArray(n))return n;var f=t.dateType;if(!f)throw new Error("dateType is required when date is not an array of two dates");return m3(f,n)}();if(Tg(o,a)&&i.push("".concat(r,"--now")),!e||!fme(e))return i;var l=function(){if(Array.isArray(e))return e;var f=t.valueType;if(!f)throw new Error("valueType is required when value is not an array of two dates");return m3(f,e)}();hme(l,a)?i.push("".concat(r,"--active")):x6(l,a)&&i.push("".concat(r,"--hasActive"));var c=y3(l,a,"".concat(r,"--range"));i.push.apply(i,c);var u=Array.isArray(e)?e:[e];if(s&&u.length===1){var d=s>l[0]?[l[0],s]:[s,l[0]],h=y3(d,a,"".concat(r,"--hover"));i.push.apply(i,h)}return i}function b1(t){for(var e=t.className,n=t.count,s=n===void 0?3:n,r=t.dateTransform,i=t.dateType,o=t.end,a=t.hover,l=t.offset,c=t.renderTile,u=t.start,d=t.step,h=d===void 0?1:d,f=t.value,p=t.valueType,m=[],g=u;g<=o;g+=h){var y=r(g);m.push(c({classes:pme({date:y,dateType:i,hover:a,value:f,valueType:p}),date:y}))}return S.jsx(u$,{className:e,count:s,offset:l,wrap:!0,children:m})}function w1(t){var e=t.activeStartDate,n=t.children,s=t.classes,r=t.date,i=t.formatAbbr,o=t.locale,a=t.maxDate,l=t.maxDateTransform,c=t.minDate,u=t.minDateTransform,d=t.onClick,h=t.onMouseOver,f=t.style,p=t.tileClassName,m=t.tileContent,g=t.tileDisabled,y=t.view,x=D.useMemo(function(){var b={activeStartDate:e,date:r,view:y};return typeof p=="function"?p(b):p},[e,r,p,y]),v=D.useMemo(function(){var b={activeStartDate:e,date:r,view:y};return typeof m=="function"?m(b):m},[e,r,m,y]);return S.jsxs("button",{className:qf(s,x),disabled:c&&u(c)>r||a&&l(a)<r||(g==null?void 0:g({activeStartDate:e,date:r,view:y})),onClick:d?function(b){return d(r,b)}:void 0,onFocus:h?function(){return h(r)}:void 0,onMouseOver:h?function(){return h(r)}:void 0,style:f,type:"button",children:[i?S.jsx("abbr",{"aria-label":i(o,r),children:n}):n,v]})}var f2=globalThis&&globalThis.__assign||function(){return f2=Object.assign||function(t){for(var e,n=1,s=arguments.length;n<s;n++){e=arguments[n];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}return t},f2.apply(this,arguments)},mme=globalThis&&globalThis.__rest||function(t,e){var n={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(n[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,s=Object.getOwnPropertySymbols(t);r<s.length;r++)e.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(t,s[r])&&(n[s[r]]=t[s[r]]);return n},MC="react-calendar__century-view__decades__decade";function gme(t){var e=t.classes,n=e===void 0?[]:e,s=t.currentCentury,r=t.formatYear,i=r===void 0?v1:r,o=mme(t,["classes","currentCentury","formatYear"]),a=o.date,l=o.locale,c=[];return n&&c.push.apply(c,n),MC&&c.push(MC),tp(a).getFullYear()!==s&&c.push("".concat(MC,"--neighboringCentury")),S.jsx(w1,f2({},o,{classes:c,maxDateTransform:y1,minDateTransform:Jc,view:"century",children:g6(l,i,a)}))}var p2=globalThis&&globalThis.__assign||function(){return p2=Object.assign||function(t){for(var e,n=1,s=arguments.length;n<s;n++){e=arguments[n];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}return t},p2.apply(this,arguments)},x3=globalThis&&globalThis.__rest||function(t,e){var n={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(n[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,s=Object.getOwnPropertySymbols(t);r<s.length;r++)e.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(t,s[r])&&(n[s[r]]=t[s[r]]);return n};function yme(t){var e=t.activeStartDate,n=t.hover,s=t.showNeighboringCentury,r=t.value,i=t.valueType,o=x3(t,["activeStartDate","hover","showNeighboringCentury","value","valueType"]),a=Qpe(e),l=a+(s?119:99);return S.jsx(b1,{className:"react-calendar__century-view__decades",dateTransform:Jc,dateType:"decade",end:l,hover:n,renderTile:function(c){var u=c.date,d=x3(c,["date"]);return S.jsx(gme,p2({},o,d,{activeStartDate:e,currentCentury:a,date:u}),u.getTime())},start:a,step:10,value:r,valueType:i})}var m2=globalThis&&globalThis.__assign||function(){return m2=Object.assign||function(t){for(var e,n=1,s=arguments.length;n<s;n++){e=arguments[n];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}return t},m2.apply(this,arguments)};function xme(t){function e(){return S.jsx(yme,m2({},t))}return S.jsx("div",{className:"react-calendar__century-view",children:e()})}var g2=globalThis&&globalThis.__assign||function(){return g2=Object.assign||function(t){for(var e,n=1,s=arguments.length;n<s;n++){e=arguments[n];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}return t},g2.apply(this,arguments)},vme=globalThis&&globalThis.__rest||function(t,e){var n={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(n[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,s=Object.getOwnPropertySymbols(t);r<s.length;r++)e.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(t,s[r])&&(n[s[r]]=t[s[r]]);return n},zC="react-calendar__decade-view__years__year";function bme(t){var e=t.classes,n=e===void 0?[]:e,s=t.currentDecade,r=t.formatYear,i=r===void 0?v1:r,o=vme(t,["classes","currentDecade","formatYear"]),a=o.date,l=o.locale,c=[];return n&&c.push.apply(c,n),zC&&c.push(zC),Jc(a).getFullYear()!==s&&c.push("".concat(zC,"--neighboringDecade")),S.jsx(w1,g2({},o,{classes:c,maxDateTransform:x1,minDateTransform:np,view:"decade",children:i(l,a)}))}var y2=globalThis&&globalThis.__assign||function(){return y2=Object.assign||function(t){for(var e,n=1,s=arguments.length;n<s;n++){e=arguments[n];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}return t},y2.apply(this,arguments)},v3=globalThis&&globalThis.__rest||function(t,e){var n={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(n[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,s=Object.getOwnPropertySymbols(t);r<s.length;r++)e.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(t,s[r])&&(n[s[r]]=t[s[r]]);return n};function wme(t){var e=t.activeStartDate,n=t.hover,s=t.showNeighboringDecade,r=t.value,i=t.valueType,o=v3(t,["activeStartDate","hover","showNeighboringDecade","value","valueType"]),a=Jpe(e),l=a+(s?11:9);return S.jsx(b1,{className:"react-calendar__decade-view__years",dateTransform:np,dateType:"year",end:l,hover:n,renderTile:function(c){var u=c.date,d=v3(c,["date"]);return S.jsx(bme,y2({},o,d,{activeStartDate:e,currentDecade:a,date:u}),u.getTime())},start:a,value:r,valueType:i})}var x2=globalThis&&globalThis.__assign||function(){return x2=Object.assign||function(t){for(var e,n=1,s=arguments.length;n<s;n++){e=arguments[n];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}return t},x2.apply(this,arguments)};function Sme(t){function e(){return S.jsx(wme,x2({},t))}return S.jsx("div",{className:"react-calendar__decade-view",children:e()})}var v2=globalThis&&globalThis.__assign||function(){return v2=Object.assign||function(t){for(var e,n=1,s=arguments.length;n<s;n++){e=arguments[n];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}return t},v2.apply(this,arguments)},kme=globalThis&&globalThis.__rest||function(t,e){var n={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(n[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,s=Object.getOwnPropertySymbols(t);r<s.length;r++)e.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(t,s[r])&&(n[s[r]]=t[s[r]]);return n},b3=globalThis&&globalThis.__spreadArray||function(t,e,n){if(n||arguments.length===2)for(var s=0,r=e.length,i;s<r;s++)(i||!(s in e))&&(i||(i=Array.prototype.slice.call(e,0,s)),i[s]=e[s]);return t.concat(i||Array.prototype.slice.call(e))},Cme="react-calendar__year-view__months__month";function Tme(t){var e=t.classes,n=e===void 0?[]:e,s=t.formatMonth,r=s===void 0?Kpe:s,i=t.formatMonthYear,o=i===void 0?h6:i,a=kme(t,["classes","formatMonth","formatMonthYear"]),l=a.date,c=a.locale;return S.jsx(w1,v2({},a,{classes:b3(b3([],n,!0),[Cme],!1),formatAbbr:o,maxDateTransform:gy,minDateTransform:Od,view:"year",children:r(c,l)}))}var b2=globalThis&&globalThis.__assign||function(){return b2=Object.assign||function(t){for(var e,n=1,s=arguments.length;n<s;n++){e=arguments[n];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}return t},b2.apply(this,arguments)},w3=globalThis&&globalThis.__rest||function(t,e){var n={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(n[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,s=Object.getOwnPropertySymbols(t);r<s.length;r++)e.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(t,s[r])&&(n[s[r]]=t[s[r]]);return n};function Nme(t){var e=t.activeStartDate,n=t.hover,s=t.value,r=t.valueType,i=w3(t,["activeStartDate","hover","value","valueType"]),o=0,a=11,l=Nn(e);return S.jsx(b1,{className:"react-calendar__year-view__months",dateTransform:function(c){var u=new Date;return u.setFullYear(l,c,1),Od(u)},dateType:"month",end:a,hover:n,renderTile:function(c){var u=c.date,d=w3(c,["date"]);return S.jsx(Tme,b2({},i,d,{activeStartDate:e,date:u}),u.getTime())},start:o,value:s,valueType:r})}var w2=globalThis&&globalThis.__assign||function(){return w2=Object.assign||function(t){for(var e,n=1,s=arguments.length;n<s;n++){e=arguments[n];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}return t},w2.apply(this,arguments)};function Ime(t){function e(){return S.jsx(Nme,w2({},t))}return S.jsx("div",{className:"react-calendar__year-view",children:e()})}var S2=globalThis&&globalThis.__assign||function(){return S2=Object.assign||function(t){for(var e,n=1,s=arguments.length;n<s;n++){e=arguments[n];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}return t},S2.apply(this,arguments)},_me=globalThis&&globalThis.__rest||function(t,e){var n={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(n[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,s=Object.getOwnPropertySymbols(t);r<s.length;r++)e.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(t,s[r])&&(n[s[r]]=t[s[r]]);return n},zx="react-calendar__month-view__days__day";function Eme(t){var e=t.calendarType,n=t.classes,s=n===void 0?[]:n,r=t.currentMonthIndex,i=t.formatDay,o=i===void 0?Hpe:i,a=t.formatLongDate,l=a===void 0?Gpe:a,c=_me(t,["calendarType","classes","currentMonthIndex","formatDay","formatLongDate"]),u=c.date,d=c.locale,h=[];return s&&h.push.apply(h,s),zx&&h.push(zx),y6(u,e)&&h.push("".concat(zx,"--weekend")),u.getMonth()!==r&&h.push("".concat(zx,"--neighboringMonth")),S.jsx(w1,S2({},c,{classes:h,formatAbbr:l,maxDateTransform:l$,minDateTransform:yy,view:"month",children:o(d,u)}))}var k2=globalThis&&globalThis.__assign||function(){return k2=Object.assign||function(t){for(var e,n=1,s=arguments.length;n<s;n++){e=arguments[n];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}return t},k2.apply(this,arguments)},S3=globalThis&&globalThis.__rest||function(t,e){var n={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(n[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,s=Object.getOwnPropertySymbols(t);r<s.length;r++)e.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(t,s[r])&&(n[s[r]]=t[s[r]]);return n};function $me(t){var e=t.activeStartDate,n=t.calendarType,s=t.hover,r=t.showFixedNumberOfWeeks,i=t.showNeighboringMonth,o=t.value,a=t.valueType,l=S3(t,["activeStartDate","calendarType","hover","showFixedNumberOfWeeks","showNeighboringMonth","value","valueType"]),c=Nn(e),u=Qc(e),d=r||i,h=Cg(e,n),f=d?0:h,p=(d?-h:0)+1,m=function(){if(r)return p+6*7-1;var g=d6(e);if(i){var y=new Date;y.setFullYear(c,u,g),y.setHours(0,0,0,0);var x=7-Cg(y,n)-1;return g+x}return g}();return S.jsx(b1,{className:"react-calendar__month-view__days",count:7,dateTransform:function(g){var y=new Date;return y.setFullYear(c,u,g),yy(y)},dateType:"day",hover:s,end:m,renderTile:function(g){var y=g.date,x=S3(g,["date"]);return S.jsx(Eme,k2({},l,x,{activeStartDate:e,calendarType:n,currentMonthIndex:u,date:y}),y.getTime())},offset:f,start:p,value:o,valueType:a})}var v6="react-calendar__month-view__weekdays",VC="".concat(v6,"__weekday");function Ame(t){for(var e=t.calendarType,n=t.formatShortWeekday,s=n===void 0?qpe:n,r=t.formatWeekday,i=r===void 0?Xpe:r,o=t.locale,a=t.onMouseLeave,l=new Date,c=Od(l),u=Nn(c),d=Qc(c),h=[],f=1;f<=7;f+=1){var p=new Date(u,d,f-Cg(c,e)),m=i(o,p);h.push(S.jsx("div",{className:qf(VC,lme(p)&&"".concat(VC,"--current"),y6(p,e)&&"".concat(VC,"--weekend")),children:S.jsx("abbr",{"aria-label":m,title:m,children:s(o,p).replace(".","")})},f))}return S.jsx(u$,{className:v6,count:7,onFocus:a,onMouseOver:a,children:h})}var Ub=globalThis&&globalThis.__assign||function(){return Ub=Object.assign||function(t){for(var e,n=1,s=arguments.length;n<s;n++){e=arguments[n];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}return t},Ub.apply(this,arguments)},k3=globalThis&&globalThis.__rest||function(t,e){var n={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(n[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,s=Object.getOwnPropertySymbols(t);r<s.length;r++)e.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(t,s[r])&&(n[s[r]]=t[s[r]]);return n},C3="react-calendar__tile";function Rme(t){var e=t.onClickWeekNumber,n=t.weekNumber,s=S.jsx("span",{children:n});if(e){var r=t.date,i=t.onClickWeekNumber,o=t.weekNumber,a=k3(t,["date","onClickWeekNumber","weekNumber"]);return S.jsx("button",Ub({},a,{className:C3,onClick:function(l){return i(o,r,l)},type:"button",children:s}))}else{t.date,t.onClickWeekNumber,t.weekNumber;var a=k3(t,["date","onClickWeekNumber","weekNumber"]);return S.jsx("div",Ub({},a,{className:C3,children:s}))}}function Dme(t){var e=t.activeStartDate,n=t.calendarType,s=t.onClickWeekNumber,r=t.onMouseLeave,i=t.showFixedNumberOfWeeks,o=function(){if(i)return 6;var c=d6(e),u=Cg(e,n),d=c-(7-u);return 1+Math.ceil(d/7)}(),a=function(){for(var c=Nn(e),u=Qc(e),d=g1(e),h=[],f=0;f<o;f+=1)h.push(h2(new Date(c,u,d+f*7),n));return h}(),l=a.map(function(c){return eme(c,n)});return S.jsx(u$,{className:"react-calendar__month-view__weekNumbers",count:o,direction:"column",onFocus:r,onMouseOver:r,style:{flexBasis:"calc(100% * (1 / 8)",flexShrink:0},children:l.map(function(c,u){var d=a[u];if(!d)throw new Error("date is not defined");return S.jsx(Rme,{date:d,onClickWeekNumber:s,weekNumber:c},c)})})}var C2=globalThis&&globalThis.__assign||function(){return C2=Object.assign||function(t){for(var e,n=1,s=arguments.length;n<s;n++){e=arguments[n];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}return t},C2.apply(this,arguments)},Ome=globalThis&&globalThis.__rest||function(t,e){var n={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(n[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,s=Object.getOwnPropertySymbols(t);r<s.length;r++)e.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(t,s[r])&&(n[s[r]]=t[s[r]]);return n};function Pme(t){if(t)for(var e=0,n=Object.entries(Ppe);e<n.length;e++){var s=n[e],r=s[0],i=s[1];if(i.includes(t))return r}return Hs.ISO_8601}function Fme(t){var e=t.activeStartDate,n=t.locale,s=t.onMouseLeave,r=t.showFixedNumberOfWeeks,i=t.calendarType,o=i===void 0?Pme(n):i,a=t.formatShortWeekday,l=t.formatWeekday,c=t.onClickWeekNumber,u=t.showWeekNumbers,d=Ome(t,["calendarType","formatShortWeekday","formatWeekday","onClickWeekNumber","showWeekNumbers"]);function h(){return S.jsx(Ame,{calendarType:o,formatShortWeekday:a,formatWeekday:l,locale:n,onMouseLeave:s})}function f(){return u?S.jsx(Dme,{activeStartDate:e,calendarType:o,onClickWeekNumber:c,onMouseLeave:s,showFixedNumberOfWeeks:r}):null}function p(){return S.jsx($me,C2({calendarType:o},d))}var m="react-calendar__month-view";return S.jsx("div",{className:qf(m,u?"".concat(m,"--weekNumbers"):""),children:S.jsxs("div",{style:{display:"flex",alignItems:"flex-end"},children:[f(),S.jsxs("div",{style:{flexGrow:1,width:"100%"},children:[h(),p()]})]})})}var $h=globalThis&&globalThis.__assign||function(){return $h=Object.assign||function(t){for(var e,n=1,s=arguments.length;n<s;n++){e=arguments[n];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}return t},$h.apply(this,arguments)},Vx="react-calendar",Ov=["century","decade","year","month"],Lme=["decade","year","month","day"],d$=new Date;d$.setFullYear(1,0,1);d$.setHours(0,0,0,0);var Mme=new Date(864e13);function mm(t){return t instanceof Date?t:new Date(t)}function b6(t,e){return Ov.slice(Ov.indexOf(t),Ov.indexOf(e)+1)}function zme(t,e,n){var s=b6(e,n);return s.indexOf(t)!==-1}function h$(t,e,n){return t&&zme(t,e,n)?t:n}function w6(t){var e=Ov.indexOf(t);return Lme[e]}function Vme(t,e){var n=Array.isArray(t)?t[e]:t;if(!n)return null;var s=mm(n);if(Number.isNaN(s.getTime()))throw new Error("Invalid date: ".concat(t));return s}function S6(t,e){var n=t.value,s=t.minDate,r=t.maxDate,i=t.maxDetail,o=Vme(n,e);if(!o)return null;var a=w6(i),l=function(){switch(e){case 0:return td(a,o);case 1:return p6(a,o);default:throw new Error("Invalid index value: ".concat(e))}}();return dme(l,s,r)}var f$=function(t){return S6(t,0)},k6=function(t){return S6(t,1)},jme=function(t){return[f$,k6].map(function(e){return e(t)})};function C6(t){var e=t.maxDate,n=t.maxDetail,s=t.minDate,r=t.minDetail,i=t.value,o=t.view,a=h$(o,r,n),l=f$({value:i,minDate:s,maxDate:e,maxDetail:n})||new Date;return td(a,l)}function Bme(t){var e=t.activeStartDate,n=t.defaultActiveStartDate,s=t.defaultValue,r=t.defaultView,i=t.maxDate,o=t.maxDetail,a=t.minDate,l=t.minDetail,c=t.value,u=t.view,d=h$(u,l,o),h=e||n;return h?td(d,h):C6({maxDate:i,maxDetail:o,minDate:a,minDetail:l,value:c||s,view:u||r})}function jC(t){return t&&(!Array.isArray(t)||t.length===1)}function jx(t,e){return t instanceof Date&&e instanceof Date&&t.getTime()===e.getTime()}var Wme=D.forwardRef(function(e,n){var s=e.activeStartDate,r=e.allowPartialRange,i=e.calendarType,o=e.className,a=e.defaultActiveStartDate,l=e.defaultValue,c=e.defaultView,u=e.formatDay,d=e.formatLongDate,h=e.formatMonth,f=e.formatMonthYear,p=e.formatShortWeekday,m=e.formatWeekday,g=e.formatYear,y=e.goToRangeStartOnSelect,x=y===void 0?!0:y,v=e.inputRef,b=e.locale,k=e.maxDate,C=k===void 0?Mme:k,N=e.maxDetail,I=N===void 0?"month":N,$=e.minDate,A=$===void 0?d$:$,P=e.minDetail,F=P===void 0?"century":P,V=e.navigationAriaLabel,z=e.navigationAriaLive,B=e.navigationLabel,W=e.next2AriaLabel,q=e.next2Label,M=e.nextAriaLabel,G=e.nextLabel,ne=e.onActiveStartDateChange,ie=e.onChange,de=e.onClickDay,he=e.onClickDecade,pe=e.onClickMonth,me=e.onClickWeekNumber,ye=e.onClickYear,Ce=e.onDrillDown,Le=e.onDrillUp,Re=e.onViewChange,Ze=e.prev2AriaLabel,tt=e.prev2Label,mt=e.prevAriaLabel,Xe=e.prevLabel,Me=e.returnValue,wt=Me===void 0?"start":Me,it=e.selectRange,At=e.showDoubleView,Vt=e.showFixedNumberOfWeeks,_n=e.showNavigation,K=_n===void 0?!0:_n,re=e.showNeighboringCentury,ce=e.showNeighboringDecade,ke=e.showNeighboringMonth,xe=ke===void 0?!0:ke,ve=e.showWeekNumbers,Oe=e.tileClassName,ut=e.tileContent,St=e.tileDisabled,hn=e.value,ri=e.view,_s=D.useState(a),Tl=_s[0],ms=_s[1],Ai=D.useState(null),Nl=Ai[0],uu=Ai[1],du=D.useState(Array.isArray(l)?l.map(function(yt){return yt!==null?mm(yt):null}):l!=null?mm(l):null),Ho=du[0],Fa=du[1],Il=D.useState(c),U0=Il[0],bp=Il[1],Es=s||Tl||Bme({activeStartDate:s,defaultActiveStartDate:a,defaultValue:l,defaultView:c,maxDate:C,maxDetail:I,minDate:A,minDetail:F,value:hn,view:ri}),js=function(){var yt=function(){return it&&jC(Ho)?Ho:hn!==void 0?hn:Ho}();return yt?Array.isArray(yt)?yt.map(function(Xt){return Xt!==null?mm(Xt):null}):yt!==null?mm(yt):null:null}(),Ri=w6(I),Jt=h$(ri||U0,F,I),ii=b6(F,I),Gd=it?Nl:null,_l=ii.indexOf(Jt)<ii.length-1,H0=ii.indexOf(Jt)>0,La=D.useCallback(function(yt){var Xt=function(){switch(wt){case"start":return f$;case"end":return k6;case"range":return jme;default:throw new Error("Invalid returnValue.")}}();return Xt({maxDate:C,maxDetail:I,minDate:A,value:yt})},[C,I,A,wt]),wp=D.useCallback(function(yt,Xt){ms(yt);var En={action:Xt,activeStartDate:yt,value:js,view:Jt};ne&&!jx(Es,yt)&&ne(En)},[Es,ne,js,Jt]),Rr=D.useCallback(function(yt,Xt){var En=function(){switch(Jt){case"century":return he;case"decade":return ye;case"year":return pe;case"month":return de;default:throw new Error("Invalid view: ".concat(Jt,"."))}}();En&&En(yt,Xt)},[de,he,pe,ye,Jt]),po=D.useCallback(function(yt,Xt){if(_l){Rr(yt,Xt);var En=ii[ii.indexOf(Jt)+1];if(!En)throw new Error("Attempted to drill down from the lowest view.");ms(yt),bp(En);var hr={action:"drillDown",activeStartDate:yt,value:js,view:En};ne&&!jx(Es,yt)&&ne(hr),Re&&Jt!==En&&Re(hr),Ce&&Ce(hr)}},[Es,_l,ne,Rr,Ce,Re,js,Jt,ii]),Kd=D.useCallback(function(){if(H0){var yt=ii[ii.indexOf(Jt)-1];if(!yt)throw new Error("Attempted to drill up from the highest view.");var Xt=td(yt,Es);ms(Xt),bp(yt);var En={action:"drillUp",activeStartDate:Xt,value:js,view:yt};ne&&!jx(Es,Xt)&&ne(En),Re&&Jt!==yt&&Re(En),Le&&Le(En)}},[Es,H0,ne,Le,Re,js,Jt,ii]),fn=D.useCallback(function(yt,Xt){var En=js;Rr(yt,Xt);var hr=it&&!jC(En),fr;if(it)if(hr)fr=td(Ri,yt);else{if(!En)throw new Error("previousValue is required");if(Array.isArray(En))throw new Error("previousValue must not be an array");fr=ome(Ri,En,yt)}else fr=La(yt);var Xd=!it||hr||x?C6({maxDate:C,maxDetail:I,minDate:A,minDetail:F,value:fr,view:Jt}):null;Xt.persist(),ms(Xd),Fa(fr);var oi={action:"onChange",activeStartDate:Xd,value:fr,view:Jt};if(ne&&!jx(Es,Xd)&&ne(oi),ie)if(it){var Oi=jC(fr);if(!Oi)ie(fr||null,Xt);else if(r){if(Array.isArray(fr))throw new Error("value must not be an array");ie([fr||null,null],Xt)}}else ie(fr||null,Xt)},[Es,r,La,x,C,I,A,F,ne,ie,Rr,it,js,Ri,Jt]);function Di(yt){uu(yt)}function hu(){uu(null)}D.useImperativeHandle(n,function(){return{activeStartDate:Es,drillDown:po,drillUp:Kd,onChange:fn,setActiveStartDate:wp,value:js,view:Jt}},[Es,po,Kd,fn,wp,js,Jt]);function G0(yt){var Xt=yt?f6(Jt,Es):td(Jt,Es),En=_l?po:fn,hr={activeStartDate:Xt,hover:Gd,locale:b,maxDate:C,minDate:A,onClick:En,onMouseOver:it?Di:void 0,tileClassName:Oe,tileContent:ut,tileDisabled:St,value:js,valueType:Ri};switch(Jt){case"century":return S.jsx(xme,$h({formatYear:g,showNeighboringCentury:re},hr));case"decade":return S.jsx(Sme,$h({formatYear:g,showNeighboringDecade:ce},hr));case"year":return S.jsx(Ime,$h({formatMonth:h,formatMonthYear:f},hr));case"month":return S.jsx(Fme,$h({calendarType:i,formatDay:u,formatLongDate:d,formatShortWeekday:p,formatWeekday:m,onClickWeekNumber:me,onMouseLeave:it?hu:void 0,showFixedNumberOfWeeks:typeof Vt<"u"?Vt:At,showNeighboringMonth:xe,showWeekNumbers:ve},hr));default:throw new Error("Invalid view: ".concat(Jt,"."))}}function qd(){return K?S.jsx(cme,{activeStartDate:Es,drillUp:Kd,formatMonthYear:f,formatYear:g,locale:b,maxDate:C,minDate:A,navigationAriaLabel:V,navigationAriaLive:z,navigationLabel:B,next2AriaLabel:W,next2Label:q,nextAriaLabel:M,nextLabel:G,prev2AriaLabel:Ze,prev2Label:tt,prevAriaLabel:mt,prevLabel:Xe,setActiveStartDate:wp,showDoubleView:At,view:Jt,views:ii}):null}var Sp=Array.isArray(js)?js:[js];return S.jsxs("div",{className:qf(Vx,it&&Sp.length===1&&"".concat(Vx,"--selectRange"),At&&"".concat(Vx,"--doubleView"),o),ref:v,children:[qd(),S.jsxs("div",{className:"".concat(Vx,"__viewContainer"),onBlur:it?hu:void 0,onMouseLeave:it?hu:void 0,children:[G0(),At?G0(!0):null]})]})});const Ume=Wme;var T6={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},T3=et.createContext&&et.createContext(T6),Hme=["attr","size","title"];function Gme(t,e){if(t==null)return{};var n=Kme(t,e),s,r;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)s=i[r],!(e.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(t,s)&&(n[s]=t[s])}return n}function Kme(t,e){if(t==null)return{};var n={};for(var s in t)if(Object.prototype.hasOwnProperty.call(t,s)){if(e.indexOf(s)>=0)continue;n[s]=t[s]}return n}function Hb(){return Hb=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},Hb.apply(this,arguments)}function N3(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,s)}return n}function Gb(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?N3(Object(n),!0).forEach(function(s){qme(t,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):N3(Object(n)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(n,s))})}return t}function qme(t,e,n){return e=Xme(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Xme(t){var e=Yme(t,"string");return typeof e=="symbol"?e:e+""}function Yme(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var s=n.call(t,e||"default");if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function N6(t){return t&&t.map((e,n)=>et.createElement(e.tag,Gb({key:n},e.attr),N6(e.child)))}function S1(t){return e=>et.createElement(Zme,Hb({attr:Gb({},t.attr)},e),N6(t.child))}function Zme(t){var e=n=>{var{attr:s,size:r,title:i}=t,o=Gme(t,Hme),a=r||n.size||"1em",l;return n.className&&(l=n.className),t.className&&(l=(l?l+" ":"")+t.className),et.createElement("svg",Hb({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},n.attr,s,o,{className:l,style:Gb(Gb({color:t.color||n.color},n.style),t.style),height:a,width:a,xmlns:"http://www.w3.org/2000/svg"}),i&&et.createElement("title",null,i),t.children)};return T3!==void 0?et.createElement(T3.Consumer,null,n=>e(n)):e(T6)}function Qme(t){return S1({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"8",r:"7"},child:[]},{tag:"polyline",attr:{points:"8.21 13.89 7 23 12 20 17 23 15.79 13.88"},child:[]}]})(t)}function Jme(t){return S1({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"},child:[]},{tag:"line",attr:{x1:"16",y1:"2",x2:"16",y2:"6"},child:[]},{tag:"line",attr:{x1:"8",y1:"2",x2:"8",y2:"6"},child:[]},{tag:"line",attr:{x1:"3",y1:"10",x2:"21",y2:"10"},child:[]}]})(t)}function ege(t){return S1({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"},child:[]},{tag:"polyline",attr:{points:"22 4 12 14.01 9 11.01"},child:[]}]})(t)}function tge(t){return S1({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"23 6 13.5 15.5 8.5 10.5 1 18"},child:[]},{tag:"polyline",attr:{points:"17 6 23 6 23 12"},child:[]}]})(t)}p1.register(fm,Mfe,$fe,l2,c2,Dv);const nge=()=>{try{const t=localStorage.getItem("user");if(!t)return null;const e=JSON.parse(t);return(e==null?void 0:e.id)??null}catch{return null}},sge=async t=>{const n=await fetch(`http://localhost:5000/api/progress/${t}`);if(!n.ok)throw new Error("Failed to fetch user progress");return n.json()},rge=async t=>{const n=await fetch(`http://localhost:5000/api/progress/stats/${t}`);if(!n.ok)throw new Error("Failed to fetch streak stats");return n.json()},ige=async()=>{const e=await fetch("http://localhost:5000/api/routines");if(!e.ok)throw new Error("Failed to fetch routines");return e.json()},oge=t=>{const e=t.map(i=>({...i,d:new Date(i.completedAt)})).sort((i,o)=>i.d.getTime()-o.d.getTime());let n=0,s=0,r=null;return e.forEach(i=>{const o=i.d;if(r){const a=Math.round((o.getTime()-r.getTime())/864e5);a===1?n++:a===0||(n=1)}else n=1;s=Math.max(s,n),r=o}),{currentStreak:n,longestStreak:s}},age=(t,e)=>{const n=new Set(t.map(i=>i.routineId)),s=e.length,r=e.filter(i=>n.has(i.id)).length;return s>0?Math.min(Math.round(r/s*100),100):0},lge=t=>{const e=Array(7).fill(0),n=new Date;return t.forEach(s=>{const r=new Date(s.completedAt),i=Math.floor((n.getTime()-r.getTime())/(1e3*60*60*24));i>=0&&i<7&&(e[6-i]+=1)}),e},cge=()=>{const[t,e]=D.useState(new Date),[,n]=ti(),s=nge();D.useEffect(()=>{s||n("/login")},[s,n]);const{data:r,isLoading:i}=Zu({queryKey:["userProgress",s],queryFn:()=>sge(s),enabled:!!s}),{data:o,isLoading:a}=Zu({queryKey:["streakStats",s],queryFn:()=>rge(s),enabled:!!s}),{data:l,isLoading:c}=Zu({queryKey:["routines"],queryFn:ige}),u=D.useMemo(()=>r?oge(r):{currentStreak:0,longestStreak:0},[r]),d=D.useMemo(()=>age(r||[],l||[]),[r,l]),h=D.useMemo(()=>lge(r||[]),[r]),f=v=>new Date(Date.UTC(v.getFullYear(),v.getMonth(),v.getDate())).toISOString().slice(0,10),p=D.useMemo(()=>new Set((r||[]).map(v=>f(new Date(v.completedAt)))),[r]),m={labels:["Completed","Remaining"],datasets:[{data:[d,100-d],backgroundColor:["#10B981","#E5E7EB"],borderWidth:0,borderRadius:5}]},g={labels:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],datasets:[{label:"Routines Completed",data:h,backgroundColor:"#3B82F6",borderRadius:6,borderSkipped:!1}]},y=[{title:"Current Streak",value:`${(o==null?void 0:o.currentStreak)??u.currentStreak} days`,icon:S.jsx(tge,{className:"text-blue-500"})},{title:"Longest Streak",value:`${(o==null?void 0:o.longestStreak)??u.longestStreak} days`,icon:S.jsx(Qme,{className:"text-yellow-500"})},{title:"Completion Rate",value:`${d}%`,icon:S.jsx(ege,{className:"text-green-500"})}],x=({date:v,view:b})=>{if(b!=="month")return null;const k=f(v);return p.has(k)?S.jsx("div",{className:"absolute bottom-1 left-1/2 transform -translate-x-1/2",children:S.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"})}):null};return i||c||a?S.jsx("div",{children:"Loading..."}):S.jsx("div",{className:"min-h-screen bg-gray-50 p-4 md:p-8 relative",children:S.jsxs(We.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},className:"max-w-6xl mx-auto",children:[S.jsx("div",{className:"flex justify-between items-center mb-8",children:S.jsx("button",{onClick:()=>n("/"),className:"bg-blue-500 text-white px-4 py-2 rounded-lg shadow-sm hover:bg-blue-600 transition",children:"Back to Home"})}),S.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-8",children:[S.jsxs("div",{children:[S.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Streak Progress"}),S.jsx("p",{className:"text-gray-600",children:"Track your consistency and build better habits"})]}),S.jsx("div",{className:"mt-4 md:mt-0 bg-white p-3 rounded-lg shadow-sm border border-gray-200",children:S.jsxs("div",{className:"flex items-center space-x-2",children:[S.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full animate-pulse"}),S.jsx("span",{className:"text-sm font-medium",children:"Active streak"}),o!=null&&o.isFirstOfMonth?S.jsx("span",{className:"ml-3 text-xs px-2 py-1 rounded-full bg-green-100 text-green-700 border border-green-200",children:"First of Month"}):null]})})]}),S.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-8",children:y.map((v,b)=>S.jsx(We.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:b*.1},className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100",children:S.jsxs("div",{className:"flex items-center justify-between",children:[S.jsxs("div",{children:[S.jsx("p",{className:"text-sm font-medium text-gray-500",children:v.title}),S.jsx("p",{className:"text-2xl font-bold mt-1 text-gray-900",children:v.value})]}),S.jsx("div",{className:"text-3xl p-3 rounded-full bg-gray-50",children:v.icon})]})},v.title))}),S.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8 mb-8",children:[S.jsxs(We.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.5},className:"lg:col-span-2 bg-white p-6 rounded-xl shadow-sm border border-gray-100",children:[S.jsxs("div",{className:"flex items-center mb-4",children:[S.jsx(Jme,{className:"text-gray-500 mr-2"}),S.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Activity Calendar"})]}),S.jsx(Ume,{onChange:v=>e(v),value:t,tileContent:x,className:"border-0",prev2Label:null,next2Label:null})]}),S.jsxs(We.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.5},className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100",children:[S.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Monthly Completion"}),S.jsx("div",{className:"h-64",children:S.jsx(hpe,{data:m,options:{plugins:{legend:{position:"bottom",labels:{usePointStyle:!0,padding:20}},tooltip:{callbacks:{label:function(v){return`${v.label}: ${v.raw}%`}}}},cutout:"70%"}})}),S.jsx("div",{className:"mt-4 text-center",children:S.jsx("p",{className:"text-sm text-gray-600",children:"You're on track to beat last month's record!"})})]})]}),S.jsxs(We.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100 mb-8",children:[S.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-6",children:"Weekly Performance"}),S.jsx("div",{className:"h-80",children:S.jsx(dpe,{data:g,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{callbacks:{label:function(v){return`${v.raw} routine${v.raw!==1?"s":""} completed`}}}},scales:{y:{beginAtZero:!0,ticks:{precision:0},grid:{drawOnChartArea:!1}},x:{grid:{display:!1,drawOnChartArea:!1}}}}})})]}),S.jsx(We.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.3,duration:.5},className:"bg-gradient-to-r from-blue-500 to-blue-600 p-6 rounded-xl text-white",children:S.jsxs("blockquote",{className:"text-center",children:[S.jsx("p",{className:"text-xl italic mb-2",children:'"Consistency is the key to mastery. Small daily improvements lead to stunning results."'}),S.jsx("footer",{className:"text-blue-100",children:"— Robin Sharma"})]})})]})})};function uge(){const[t,e]=D.useState(()=>{const N=localStorage.getItem("user");return N?JSON.parse(N):null}),[n,s]=D.useState(!1),[r,i]=D.useState(!1),[o,a]=D.useState(""),[l,c]=D.useState(""),[u,d]=D.useState("idle"),[,h]=ti(),[f,p]=D.useState(null),[m,g]=D.useState(!1),[y,x]=D.useState(null),[v,b]=D.useState(!1);D.useEffect(()=>{t||h("/login")},[t,h]),D.useEffect(()=>{(async()=>{if(t!=null&&t.id)try{g(!0);const A=await fetch(`http://localhost:5000/api/progress/stats/${t.id}`);if(A.ok){const P=await A.json();p(P)}}catch{}finally{g(!1)}})(),(async()=>{if(t!=null&&t.id)try{b(!0);const A=await fetch(`http://localhost:5000/api/progress/daily/${t.id}`);if(A.ok){const P=await A.json();x(P)}}catch{}finally{b(!1)}})()},[t==null?void 0:t.id]);const k=async()=>{if(!(t!=null&&t.username)||!(t!=null&&t.email))return;(await fetch("http://localhost:5000/api/auth/signup/request-code",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:t.username,email:t.email,purpose:"password-change"})})).ok?(i(!0),d("otp")):alert("Failed to send OTP")},C=async()=>{if(!(t!=null&&t.username)||!(t!=null&&t.email)||!o||!l)return;(await fetch("http://localhost:5000/api/auth/signup/verify",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:t.username,email:t.email,code:o,password:l,purpose:"password-change"})})).ok?(d("done"),alert("Password changed successfully!")):alert("Failed to verify OTP or change password")};return t?S.jsx("div",{className:"min-h-screen bg-gray-50 p-4 md:p-8",children:S.jsxs("div",{className:"max-w-4xl mx-auto",children:[S.jsx("div",{className:"flex justify-between items-center mb-8",children:S.jsx("button",{onClick:()=>h("/"),className:"bg-blue-500 text-white px-4 py-2 rounded-lg shadow-sm hover:bg-blue-600 transition",children:"Back to Home"})}),S.jsx(Qn,{className:"bg-white rounded-3xl shadow-lg mb-8",children:S.jsxs(Jn,{className:"p-8",children:[S.jsx("h3",{className:"font-bold text-2xl mb-6",children:"Profile Information"}),S.jsxs("div",{className:"space-y-4",children:[S.jsxs("p",{children:[S.jsx("strong",{children:"Username:"})," ",t.username||"N/A"]}),S.jsxs("p",{children:[S.jsx("strong",{children:"Email:"})," ",t.email||"N/A"]}),n?S.jsxs("div",{className:"space-y-4 mt-4",children:[u==="idle"&&S.jsx(lt,{onClick:k,children:"Request OTP to Email"}),u==="otp"&&S.jsxs("div",{children:[S.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Enter OTP"}),S.jsx(aa,{value:o,onChange:N=>a(N.target.value),className:"mt-1"}),S.jsx("label",{className:"block text-sm font-medium text-gray-700 mt-4",children:"New Password"}),S.jsx(aa,{type:"password",value:l,onChange:N=>c(N.target.value),className:"mt-1"}),S.jsx(lt,{onClick:C,className:"mt-4",children:"Set New Password"})]}),u==="done"&&S.jsx("div",{className:"text-green-600 font-semibold",children:"Password changed successfully!"})]}):S.jsx(lt,{onClick:()=>s(!0),className:"mt-4",children:"Change Password"})]})]})}),S.jsx(Qn,{className:"bg-white rounded-3xl shadow-lg",children:S.jsxs(Jn,{className:"p-8",children:[S.jsx("h3",{className:"font-bold text-2xl mb-6",children:"Streak Progress"}),S.jsx(cge,{})]})})]})}):null}var dge={};(function(){var t;function e(w){var T=0;return function(){return T<w.length?{done:!1,value:w[T++]}:{done:!0}}}var n=typeof Object.defineProperties=="function"?Object.defineProperty:function(w,T,_){return w==Array.prototype||w==Object.prototype||(w[T]=_.value),w};function s(w){w=[typeof globalThis=="object"&&globalThis,w,typeof window=="object"&&window,typeof self=="object"&&self,typeof $o=="object"&&$o];for(var T=0;T<w.length;++T){var _=w[T];if(_&&_.Math==Math)return _}throw Error("Cannot find global object")}var r=s(this);function i(w,T){if(T)e:{var _=r;w=w.split(".");for(var R=0;R<w.length-1;R++){var j=w[R];if(!(j in _))break e;_=_[j]}w=w[w.length-1],R=_[w],T=T(R),T!=R&&T!=null&&n(_,w,{configurable:!0,writable:!0,value:T})}}i("Symbol",function(w){function T(H){if(this instanceof T)throw new TypeError("Symbol is not a constructor");return new _(R+(H||"")+"_"+j++,H)}function _(H,U){this.h=H,n(this,"description",{configurable:!0,writable:!0,value:U})}if(w)return w;_.prototype.toString=function(){return this.h};var R="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",j=0;return T}),i("Symbol.iterator",function(w){if(w)return w;w=Symbol("Symbol.iterator");for(var T="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),_=0;_<T.length;_++){var R=r[T[_]];typeof R=="function"&&typeof R.prototype[w]!="function"&&n(R.prototype,w,{configurable:!0,writable:!0,value:function(){return o(e(this))}})}return w});function o(w){return w={next:w},w[Symbol.iterator]=function(){return this},w}function a(w){var T=typeof Symbol<"u"&&Symbol.iterator&&w[Symbol.iterator];return T?T.call(w):{next:e(w)}}function l(w){if(!(w instanceof Array)){w=a(w);for(var T,_=[];!(T=w.next()).done;)_.push(T.value);w=_}return w}var c=typeof Object.assign=="function"?Object.assign:function(w,T){for(var _=1;_<arguments.length;_++){var R=arguments[_];if(R)for(var j in R)Object.prototype.hasOwnProperty.call(R,j)&&(w[j]=R[j])}return w};i("Object.assign",function(w){return w||c});var u=typeof Object.create=="function"?Object.create:function(w){function T(){}return T.prototype=w,new T},d;if(typeof Object.setPrototypeOf=="function")d=Object.setPrototypeOf;else{var h;e:{var f={a:!0},p={};try{p.__proto__=f,h=p.a;break e}catch{}h=!1}d=h?function(w,T){if(w.__proto__=T,w.__proto__!==T)throw new TypeError(w+" is not extensible");return w}:null}var m=d;function g(w,T){if(w.prototype=u(T.prototype),w.prototype.constructor=w,m)m(w,T);else for(var _ in T)if(_!="prototype")if(Object.defineProperties){var R=Object.getOwnPropertyDescriptor(T,_);R&&Object.defineProperty(w,_,R)}else w[_]=T[_];w.za=T.prototype}function y(){this.m=!1,this.j=null,this.i=void 0,this.h=1,this.v=this.s=0,this.l=null}function x(w){if(w.m)throw new TypeError("Generator is already running");w.m=!0}y.prototype.u=function(w){this.i=w};function v(w,T){w.l={ma:T,na:!0},w.h=w.s||w.v}y.prototype.return=function(w){this.l={return:w},this.h=this.v};function b(w,T,_){return w.h=_,{value:T}}function k(w){this.h=new y,this.i=w}function C(w,T){x(w.h);var _=w.h.j;return _?N(w,"return"in _?_.return:function(R){return{value:R,done:!0}},T,w.h.return):(w.h.return(T),I(w))}function N(w,T,_,R){try{var j=T.call(w.h.j,_);if(!(j instanceof Object))throw new TypeError("Iterator result "+j+" is not an object");if(!j.done)return w.h.m=!1,j;var H=j.value}catch(U){return w.h.j=null,v(w.h,U),I(w)}return w.h.j=null,R.call(w.h,H),I(w)}function I(w){for(;w.h.h;)try{var T=w.i(w.h);if(T)return w.h.m=!1,{value:T.value,done:!1}}catch(_){w.h.i=void 0,v(w.h,_)}if(w.h.m=!1,w.h.l){if(T=w.h.l,w.h.l=null,T.na)throw T.ma;return{value:T.return,done:!0}}return{value:void 0,done:!0}}function $(w){this.next=function(T){return x(w.h),w.h.j?T=N(w,w.h.j.next,T,w.h.u):(w.h.u(T),T=I(w)),T},this.throw=function(T){return x(w.h),w.h.j?T=N(w,w.h.j.throw,T,w.h.u):(v(w.h,T),T=I(w)),T},this.return=function(T){return C(w,T)},this[Symbol.iterator]=function(){return this}}function A(w){function T(R){return w.next(R)}function _(R){return w.throw(R)}return new Promise(function(R,j){function H(U){U.done?R(U.value):Promise.resolve(U.value).then(T,_).then(H,j)}H(w.next())})}function P(w){return A(new $(new k(w)))}i("Promise",function(w){function T(U){this.i=0,this.j=void 0,this.h=[],this.u=!1;var te=this.l();try{U(te.resolve,te.reject)}catch(ae){te.reject(ae)}}function _(){this.h=null}function R(U){return U instanceof T?U:new T(function(te){te(U)})}if(w)return w;_.prototype.i=function(U){if(this.h==null){this.h=[];var te=this;this.j(function(){te.m()})}this.h.push(U)};var j=r.setTimeout;_.prototype.j=function(U){j(U,0)},_.prototype.m=function(){for(;this.h&&this.h.length;){var U=this.h;this.h=[];for(var te=0;te<U.length;++te){var ae=U[te];U[te]=null;try{ae()}catch(be){this.l(be)}}}this.h=null},_.prototype.l=function(U){this.j(function(){throw U})},T.prototype.l=function(){function U(be){return function(Ne){ae||(ae=!0,be.call(te,Ne))}}var te=this,ae=!1;return{resolve:U(this.I),reject:U(this.m)}},T.prototype.I=function(U){if(U===this)this.m(new TypeError("A Promise cannot resolve to itself"));else if(U instanceof T)this.L(U);else{e:switch(typeof U){case"object":var te=U!=null;break e;case"function":te=!0;break e;default:te=!1}te?this.F(U):this.s(U)}},T.prototype.F=function(U){var te=void 0;try{te=U.then}catch(ae){this.m(ae);return}typeof te=="function"?this.M(te,U):this.s(U)},T.prototype.m=function(U){this.v(2,U)},T.prototype.s=function(U){this.v(1,U)},T.prototype.v=function(U,te){if(this.i!=0)throw Error("Cannot settle("+U+", "+te+"): Promise already settled in state"+this.i);this.i=U,this.j=te,this.i===2&&this.K(),this.H()},T.prototype.K=function(){var U=this;j(function(){if(U.D()){var te=r.console;typeof te<"u"&&te.error(U.j)}},1)},T.prototype.D=function(){if(this.u)return!1;var U=r.CustomEvent,te=r.Event,ae=r.dispatchEvent;return typeof ae>"u"?!0:(typeof U=="function"?U=new U("unhandledrejection",{cancelable:!0}):typeof te=="function"?U=new te("unhandledrejection",{cancelable:!0}):(U=r.document.createEvent("CustomEvent"),U.initCustomEvent("unhandledrejection",!1,!0,U)),U.promise=this,U.reason=this.j,ae(U))},T.prototype.H=function(){if(this.h!=null){for(var U=0;U<this.h.length;++U)H.i(this.h[U]);this.h=null}};var H=new _;return T.prototype.L=function(U){var te=this.l();U.T(te.resolve,te.reject)},T.prototype.M=function(U,te){var ae=this.l();try{U.call(te,ae.resolve,ae.reject)}catch(be){ae.reject(be)}},T.prototype.then=function(U,te){function ae(Qe,De){return typeof Qe=="function"?function(at){try{be(Qe(at))}catch(kt){Ne(kt)}}:De}var be,Ne,ot=new T(function(Qe,De){be=Qe,Ne=De});return this.T(ae(U,be),ae(te,Ne)),ot},T.prototype.catch=function(U){return this.then(void 0,U)},T.prototype.T=function(U,te){function ae(){switch(be.i){case 1:U(be.j);break;case 2:te(be.j);break;default:throw Error("Unexpected state: "+be.i)}}var be=this;this.h==null?H.i(ae):this.h.push(ae),this.u=!0},T.resolve=R,T.reject=function(U){return new T(function(te,ae){ae(U)})},T.race=function(U){return new T(function(te,ae){for(var be=a(U),Ne=be.next();!Ne.done;Ne=be.next())R(Ne.value).T(te,ae)})},T.all=function(U){var te=a(U),ae=te.next();return ae.done?R([]):new T(function(be,Ne){function ot(at){return function(kt){Qe[at]=kt,De--,De==0&&be(Qe)}}var Qe=[],De=0;do Qe.push(void 0),De++,R(ae.value).T(ot(Qe.length-1),Ne),ae=te.next();while(!ae.done)})},T});function F(w,T){w instanceof String&&(w+="");var _=0,R=!1,j={next:function(){if(!R&&_<w.length){var H=_++;return{value:T(H,w[H]),done:!1}}return R=!0,{done:!0,value:void 0}}};return j[Symbol.iterator]=function(){return j},j}i("Array.prototype.keys",function(w){return w||function(){return F(this,function(T){return T})}}),i("Array.prototype.fill",function(w){return w||function(T,_,R){var j=this.length||0;for(0>_&&(_=Math.max(0,j+_)),(R==null||R>j)&&(R=j),R=Number(R),0>R&&(R=Math.max(0,j+R)),_=Number(_||0);_<R;_++)this[_]=T;return this}});function V(w){return w||Array.prototype.fill}i("Int8Array.prototype.fill",V),i("Uint8Array.prototype.fill",V),i("Uint8ClampedArray.prototype.fill",V),i("Int16Array.prototype.fill",V),i("Uint16Array.prototype.fill",V),i("Int32Array.prototype.fill",V),i("Uint32Array.prototype.fill",V),i("Float32Array.prototype.fill",V),i("Float64Array.prototype.fill",V),i("Object.is",function(w){return w||function(T,_){return T===_?T!==0||1/T===1/_:T!==T&&_!==_}}),i("Array.prototype.includes",function(w){return w||function(T,_){var R=this;R instanceof String&&(R=String(R));var j=R.length;for(_=_||0,0>_&&(_=Math.max(_+j,0));_<j;_++){var H=R[_];if(H===T||Object.is(H,T))return!0}return!1}}),i("String.prototype.includes",function(w){return w||function(T,_){if(this==null)throw new TypeError("The 'this' value for String.prototype.includes must not be null or undefined");if(T instanceof RegExp)throw new TypeError("First argument to String.prototype.includes must not be a regular expression");return this.indexOf(T,_||0)!==-1}});var z=this||self;function B(w,T){w=w.split(".");var _=z;w[0]in _||typeof _.execScript>"u"||_.execScript("var "+w[0]);for(var R;w.length&&(R=w.shift());)w.length||T===void 0?_[R]&&_[R]!==Object.prototype[R]?_=_[R]:_=_[R]={}:_[R]=T}function W(w){var T;e:{if((T=z.navigator)&&(T=T.userAgent))break e;T=""}return T.indexOf(w)!=-1}var q=Array.prototype.map?function(w,T){return Array.prototype.map.call(w,T,void 0)}:function(w,T){for(var _=w.length,R=Array(_),j=typeof w=="string"?w.split(""):w,H=0;H<_;H++)H in j&&(R[H]=T.call(void 0,j[H],H,w));return R},M={},G=null;function ne(w){var T=w.length,_=3*T/4;_%3?_=Math.floor(_):"=.".indexOf(w[T-1])!=-1&&(_="=.".indexOf(w[T-2])!=-1?_-2:_-1);var R=new Uint8Array(_),j=0;return ie(w,function(H){R[j++]=H}),j!==_?R.subarray(0,j):R}function ie(w,T){function _(ae){for(;R<w.length;){var be=w.charAt(R++),Ne=G[be];if(Ne!=null)return Ne;if(!/^[\s\xa0]*$/.test(be))throw Error("Unknown base64 encoding at char: "+be)}return ae}de();for(var R=0;;){var j=_(-1),H=_(0),U=_(64),te=_(64);if(te===64&&j===-1)break;T(j<<2|H>>4),U!=64&&(T(H<<4&240|U>>2),te!=64&&T(U<<6&192|te))}}function de(){if(!G){G={};for(var w="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),T=["+/=","+/","-_=","-_.","-_"],_=0;5>_;_++){var R=w.concat(T[_].split(""));M[_]=R;for(var j=0;j<R.length;j++){var H=R[j];G[H]===void 0&&(G[H]=j)}}}}var he=typeof Uint8Array<"u",pe=!(W("Trident")||W("MSIE"))&&typeof z.btoa=="function";function me(w){if(!pe){var T;T===void 0&&(T=0),de(),T=M[T];for(var _=Array(Math.floor(w.length/3)),R=T[64]||"",j=0,H=0;j<w.length-2;j+=3){var U=w[j],te=w[j+1],ae=w[j+2],be=T[U>>2];U=T[(U&3)<<4|te>>4],te=T[(te&15)<<2|ae>>6],ae=T[ae&63],_[H++]=be+U+te+ae}switch(be=0,ae=R,w.length-j){case 2:be=w[j+1],ae=T[(be&15)<<2]||R;case 1:w=w[j],_[H]=T[w>>2]+T[(w&3)<<4|be>>4]+ae+R}return _.join("")}for(T="";10240<w.length;)T+=String.fromCharCode.apply(null,w.subarray(0,10240)),w=w.subarray(10240);return T+=String.fromCharCode.apply(null,w),btoa(T)}var ye=RegExp("[-_.]","g");function Ce(w){switch(w){case"-":return"+";case"_":return"/";case".":return"=";default:return""}}function Le(w){if(!pe)return ne(w);ye.test(w)&&(w=w.replace(ye,Ce)),w=atob(w);for(var T=new Uint8Array(w.length),_=0;_<w.length;_++)T[_]=w.charCodeAt(_);return T}var Re;function Ze(){return Re||(Re=new Uint8Array(0))}var tt={},mt=typeof Uint8Array.prototype.slice=="function",Xe=0,Me=0;function wt(w){var T=0>w;w=Math.abs(w);var _=w>>>0;w=Math.floor((w-_)/4294967296),T&&(_=a(At(_,w)),T=_.next().value,w=_.next().value,_=T),Xe=_>>>0,Me=w>>>0}var it=typeof BigInt=="function";function At(w,T){return T=~T,w?w=~w+1:T+=1,[w,T]}function Vt(w,T){this.i=w>>>0,this.h=T>>>0}function _n(w){if(!w)return K||(K=new Vt(0,0));if(!/^-?\d+$/.test(w))return null;if(16>w.length)wt(Number(w));else if(it)w=BigInt(w),Xe=Number(w&BigInt(4294967295))>>>0,Me=Number(w>>BigInt(32)&BigInt(4294967295));else{var T=+(w[0]==="-");Me=Xe=0;for(var _=w.length,R=T,j=(_-T)%6+T;j<=_;R=j,j+=6)R=Number(w.slice(R,j)),Me*=1e6,Xe=1e6*Xe+R,4294967296<=Xe&&(Me+=Xe/4294967296|0,Xe%=4294967296);T&&(T=a(At(Xe,Me)),w=T.next().value,T=T.next().value,Xe=w,Me=T)}return new Vt(Xe,Me)}var K;function re(w,T){return Error("Invalid wire type: "+w+" (at position "+T+")")}function ce(){return Error("Failed to read varint, encoding is invalid.")}function ke(w,T){return Error("Tried to read past the end of the data "+T+" > "+w)}function xe(){throw Error("Invalid UTF8")}function ve(w,T){return T=String.fromCharCode.apply(null,T),w==null?T:w+T}var Oe=void 0,ut,St=typeof TextDecoder<"u",hn,ri=typeof TextEncoder<"u",_s;function Tl(w){if(w!==tt)throw Error("illegal external caller")}function ms(w,T){if(Tl(T),this.V=w,w!=null&&w.length===0)throw Error("ByteString should be constructed with non-empty values")}function Ai(){return _s||(_s=new ms(null,tt))}function Nl(w){Tl(tt);var T=w.V;return T=T==null||he&&T!=null&&T instanceof Uint8Array?T:typeof T=="string"?Le(T):null,T==null?T:w.V=T}function uu(w){if(typeof w=="string")return{buffer:Le(w),C:!1};if(Array.isArray(w))return{buffer:new Uint8Array(w),C:!1};if(w.constructor===Uint8Array)return{buffer:w,C:!1};if(w.constructor===ArrayBuffer)return{buffer:new Uint8Array(w),C:!1};if(w.constructor===ms)return{buffer:Nl(w)||Ze(),C:!0};if(w instanceof Uint8Array)return{buffer:new Uint8Array(w.buffer,w.byteOffset,w.byteLength),C:!1};throw Error("Type not convertible to a Uint8Array, expected a Uint8Array, an ArrayBuffer, a base64 encoded string, a ByteString or an Array of numbers")}function du(w,T){this.i=null,this.m=!1,this.h=this.j=this.l=0,Ho(this,w,T)}function Ho(w,T,_){_=_===void 0?{}:_,w.S=_.S===void 0?!1:_.S,T&&(T=uu(T),w.i=T.buffer,w.m=T.C,w.l=0,w.j=w.i.length,w.h=w.l)}du.prototype.reset=function(){this.h=this.l};function Fa(w,T){if(w.h=T,T>w.j)throw ke(w.j,T)}function Il(w){var T=w.i,_=w.h,R=T[_++],j=R&127;if(R&128&&(R=T[_++],j|=(R&127)<<7,R&128&&(R=T[_++],j|=(R&127)<<14,R&128&&(R=T[_++],j|=(R&127)<<21,R&128&&(R=T[_++],j|=R<<28,R&128&&T[_++]&128&&T[_++]&128&&T[_++]&128&&T[_++]&128&&T[_++]&128)))))throw ce();return Fa(w,_),j}function U0(w,T){if(0>T)throw Error("Tried to read a negative byte length: "+T);var _=w.h,R=_+T;if(R>w.j)throw ke(T,w.j-_);return w.h=R,_}var bp=[];function Es(){this.h=[]}Es.prototype.length=function(){return this.h.length},Es.prototype.end=function(){var w=this.h;return this.h=[],w};function js(w,T,_){for(;0<_||127<T;)w.h.push(T&127|128),T=(T>>>7|_<<25)>>>0,_>>>=7;w.h.push(T)}function Ri(w,T){for(;127<T;)w.h.push(T&127|128),T>>>=7;w.h.push(T)}function Jt(w,T){if(bp.length){var _=bp.pop();Ho(_,w,T),w=_}else w=new du(w,T);this.h=w,this.j=this.h.h,this.i=this.l=-1,this.setOptions(T)}Jt.prototype.setOptions=function(w){w=w===void 0?{}:w,this.ca=w.ca===void 0?!1:w.ca},Jt.prototype.reset=function(){this.h.reset(),this.j=this.h.h,this.i=this.l=-1};function ii(w){var T=w.h;if(T.h==T.j)return!1;w.j=w.h.h;var _=Il(w.h)>>>0;if(T=_>>>3,_&=7,!(0<=_&&5>=_))throw re(_,w.j);if(1>T)throw Error("Invalid field number: "+T+" (at position "+w.j+")");return w.l=T,w.i=_,!0}function Gd(w){switch(w.i){case 0:if(w.i!=0)Gd(w);else e:{w=w.h;for(var T=w.h,_=T+10,R=w.i;T<_;)if(!(R[T++]&128)){Fa(w,T);break e}throw ce()}break;case 1:w=w.h,Fa(w,w.h+8);break;case 2:w.i!=2?Gd(w):(T=Il(w.h)>>>0,w=w.h,Fa(w,w.h+T));break;case 5:w=w.h,Fa(w,w.h+4);break;case 3:T=w.l;do{if(!ii(w))throw Error("Unmatched start-group tag: stream EOF");if(w.i==4){if(w.l!=T)throw Error("Unmatched end-group tag");break}Gd(w)}while(1);break;default:throw re(w.i,w.j)}}var _l=[];function H0(){this.j=[],this.i=0,this.h=new Es}function La(w,T){T.length!==0&&(w.j.push(T),w.i+=T.length)}function wp(w,T){if(T=T.R){La(w,w.h.end());for(var _=0;_<T.length;_++)La(w,Nl(T[_])||Ze())}}var Rr=typeof Symbol=="function"&&typeof Symbol()=="symbol"?Symbol():void 0;function po(w,T){return Rr?w[Rr]|=T:w.A!==void 0?w.A|=T:(Object.defineProperties(w,{A:{value:T,configurable:!0,writable:!0,enumerable:!1}}),T)}function Kd(w,T){Rr?w[Rr]&&(w[Rr]&=~T):w.A!==void 0&&(w.A&=~T)}function fn(w){var T;return Rr?T=w[Rr]:T=w.A,T??0}function Di(w,T){Rr?w[Rr]=T:w.A!==void 0?w.A=T:Object.defineProperties(w,{A:{value:T,configurable:!0,writable:!0,enumerable:!1}})}function hu(w){return po(w,1),w}function G0(w,T){Di(T,(w|0)&-51)}function qd(w,T){Di(T,(w|18)&-41)}var Sp={};function yt(w){return w!==null&&typeof w=="object"&&!Array.isArray(w)&&w.constructor===Object}var Xt,En=[];Di(En,23),Xt=Object.freeze(En);function hr(w){if(fn(w.o)&2)throw Error("Cannot mutate an immutable Message")}function fr(w){var T=w.length;(T=T?w[T-1]:void 0)&&yt(T)?T.g=1:(T={},w.push((T.g=1,T)))}function Xd(w){var T=w.i+w.G;return w.B||(w.B=w.o[T]={})}function oi(w,T){return T===-1?null:T>=w.i?w.B?w.B[T]:void 0:w.o[T+w.G]}function Oi(w,T,_,R){hr(w),kp(w,T,_,R)}function kp(w,T,_,R){w.j&&(w.j=void 0),T>=w.i||R?Xd(w)[T]=_:(w.o[T+w.G]=_,(w=w.B)&&T in w&&delete w[T])}function gk(w,T,_,R){var j=oi(w,T);Array.isArray(j)||(j=Xt);var H=fn(j);if(H&1||hu(j),R)H&2||po(j,2),_&1||Object.freeze(j);else{R=!(_&2);var U=H&2;_&1||!U?R&&H&16&&!U&&Kd(j,16):(j=hu(Array.prototype.slice.call(j)),kp(w,T,j))}return j}function yk(w,T){var _=oi(w,T),R=_==null?_:typeof _=="number"||_==="NaN"||_==="Infinity"||_==="-Infinity"?Number(_):void 0;return R!=null&&R!==_&&kp(w,T,R),R}function PD(w,T,_,R,j){w.h||(w.h={});var H=w.h[_],U=gk(w,_,3,j);if(!H){var te=U;H=[];var ae=!!(fn(w.o)&16);U=!!(fn(te)&2);var be=te;!j&&U&&(te=Array.prototype.slice.call(te));for(var Ne=U,ot=0;ot<te.length;ot++){var Qe=te[ot],De=T,at=!1;if(at=at===void 0?!1:at,Qe=Array.isArray(Qe)?new De(Qe):at?new De:void 0,Qe!==void 0){De=Qe.o;var kt=at=fn(De);U&&(kt|=2),ae&&(kt|=16),kt!=at&&Di(De,kt),De=kt,Ne=Ne||!!(2&De),H.push(Qe)}}return w.h[_]=H,ae=fn(te),T=ae|33,T=Ne?T&-9:T|8,ae!=T&&(Ne=te,Object.isFrozen(Ne)&&(Ne=Array.prototype.slice.call(Ne)),Di(Ne,T),te=Ne),be!==te&&kp(w,_,te),(j||R&&U)&&po(H,2),R&&Object.freeze(H),H}return j||(j=Object.isFrozen(H),R&&!j?Object.freeze(H):!R&&j&&(H=Array.prototype.slice.call(H),w.h[_]=H)),H}function xk(w,T,_){var R=!!(fn(w.o)&2);if(T=PD(w,T,_,R,R),w=gk(w,_,3,R),!(R||fn(w)&8)){for(R=0;R<T.length;R++){if(_=T[R],fn(_.o)&2){var j=jD(_,!1);j.j=_}else j=_;_!==j&&(T[R]=j,w[R]=j.o)}po(w,8)}return T}function Go(w,T,_){if(_!=null&&typeof _!="number")throw Error("Value of float/double field must be a number|null|undefined, found "+typeof _+": "+_);Oi(w,T,_)}function FD(w,T,_,R,j){hr(w);var H=PD(w,_,T,!1,!1);return _=R??new _,w=gk(w,T,2,!1),j!=null?(H.splice(j,0,_),w.splice(j,0,_.o)):(H.push(_),w.push(_.o)),_.C()&&Kd(w,8),_}function K0(w,T){return w??T}function Ko(w,T,_){return _=_===void 0?0:_,K0(yk(w,T),_)}var q0;function A7(w){switch(typeof w){case"number":return isFinite(w)?w:String(w);case"object":if(w)if(Array.isArray(w)){if(fn(w)&128)return w=Array.prototype.slice.call(w),fr(w),w}else{if(he&&w!=null&&w instanceof Uint8Array)return me(w);if(w instanceof ms){var T=w.V;return T==null?"":typeof T=="string"?T:w.V=me(T)}}}return w}function LD(w,T,_,R){if(w!=null){if(Array.isArray(w))w=vk(w,T,_,R!==void 0);else if(yt(w)){var j={},H;for(H in w)j[H]=LD(w[H],T,_,R);w=j}else w=T(w,R);return w}}function vk(w,T,_,R){var j=fn(w);R=R?!!(j&16):void 0,w=Array.prototype.slice.call(w);for(var H=0;H<w.length;H++)w[H]=LD(w[H],T,_,R);return _(j,w),w}function R7(w){return w.ja===Sp?w.toJSON():A7(w)}function D7(w,T){w&128&&fr(T)}function MD(w,T,_){if(_=_===void 0?qd:_,w!=null){if(he&&w instanceof Uint8Array)return w.length?new ms(new Uint8Array(w),tt):Ai();if(Array.isArray(w)){var R=fn(w);return R&2?w:T&&!(R&32)&&(R&16||R===0)?(Di(w,R|2),w):(w=vk(w,MD,R&4?qd:_,!0),T=fn(w),T&4&&T&2&&Object.freeze(w),w)}return w.ja===Sp?VD(w):w}}function zD(w,T,_,R,j,H,U){if(w=w.h&&w.h[_]){if(R=fn(w),R&2?R=w:(H=q(w,VD),qd(R,H),Object.freeze(H),R=H),hr(T),U=R==null?Xt:hu([]),R!=null){for(H=!!R.length,w=0;w<R.length;w++){var te=R[w];H=H&&!(fn(te.o)&2),U[w]=te.o}H=(H?8:0)|1,w=fn(U),(w&H)!==H&&(Object.isFrozen(U)&&(U=Array.prototype.slice.call(U)),Di(U,w|H)),T.h||(T.h={}),T.h[_]=R}else T.h&&(T.h[_]=void 0);kp(T,_,U,j)}else Oi(T,_,MD(R,H,U),j)}function VD(w){return fn(w.o)&2||(w=jD(w,!0),po(w.o,2)),w}function jD(w,T){var _=w.o,R=[];po(R,16);var j=w.constructor.h;if(j&&R.push(j),j=w.B,j){R.length=_.length,R.fill(void 0,R.length,_.length);var H={};R[R.length-1]=H}fn(_)&128&&fr(R),T=T||w.C()?qd:G0,H=w.constructor,q0=R,R=new H(R),q0=void 0,w.R&&(R.R=w.R.slice()),H=!!(fn(_)&16);for(var U=j?_.length-1:_.length,te=0;te<U;te++)zD(w,R,te-w.G,_[te],!1,H,T);if(j)for(var ae in j)zD(w,R,+ae,j[ae],!0,H,T);return R}function Dr(w,T,_){w==null&&(w=q0),q0=void 0;var R=this.constructor.i||0,j=0<R,H=this.constructor.h,U=!1;if(w==null){w=H?[H]:[];var te=48,ae=!0;j&&(R=0,te|=128),Di(w,te)}else{if(!Array.isArray(w)||H&&H!==w[0])throw Error();var be=te=po(w,0);if((ae=(16&be)!==0)&&((U=(32&be)!==0)||(be|=32)),j){if(128&be)R=0;else if(0<w.length){var Ne=w[w.length-1];if(yt(Ne)&&"g"in Ne){R=0,be|=128,delete Ne.g;var ot=!0,Qe;for(Qe in Ne){ot=!1;break}ot&&w.pop()}}}else if(128&be)throw Error();te!==be&&Di(w,be)}this.G=(H?0:-1)-R,this.h=void 0,this.o=w;e:{if(H=this.o.length,R=H-1,H&&(H=this.o[R],yt(H))){this.B=H,this.i=R-this.G;break e}T!==void 0&&-1<T?(this.i=Math.max(T,R+1-this.G),this.B=void 0):this.i=Number.MAX_VALUE}if(!j&&this.B&&"g"in this.B)throw Error('Unexpected "g" flag in sparse object of message that is not a group type.');if(_){T=ae&&!U&&!0,j=this.i;var De;for(ae=0;ae<_.length;ae++)U=_[ae],U<j?(U+=this.G,(R=w[U])?BD(R,T):w[U]=Xt):(De||(De=Xd(this)),(R=De[U])?BD(R,T):De[U]=Xt)}}Dr.prototype.toJSON=function(){return vk(this.o,R7,D7)},Dr.prototype.C=function(){return!!(fn(this.o)&2)};function BD(w,T){if(Array.isArray(w)){var _=fn(w),R=1;!T||_&2||(R|=16),(_&R)!==R&&Di(w,_|R)}}Dr.prototype.ja=Sp,Dr.prototype.toString=function(){return this.o.toString()};function WD(w,T,_){if(_){var R={},j;for(j in _){var H=_[j],U=H.ra;U||(R.J=H.xa||H.oa.W,H.ia?(R.aa=qD(H.ia),U=function(te){return function(ae,be,Ne){return te.J(ae,be,Ne,te.aa)}}(R)):H.ka?(R.Z=XD(H.da.P,H.ka),U=function(te){return function(ae,be,Ne){return te.J(ae,be,Ne,te.Z)}}(R)):U=R.J,H.ra=U),U(T,w,H.da),R={J:R.J,aa:R.aa,Z:R.Z}}}wp(T,w)}var X0=Symbol();function UD(w,T,_){return w[X0]||(w[X0]=function(R,j){return T(R,j,_)})}function HD(w){var T=w[X0];if(!T){var _=wk(w);T=function(R,j){return YD(R,j,_)},w[X0]=T}return T}function O7(w){var T=w.ia;if(T)return HD(T);if(T=w.wa)return UD(w.da.P,T,w.ka)}function P7(w){var T=O7(w),_=w.da,R=w.oa.U;return T?function(j,H){return R(j,H,_,T)}:function(j,H){return R(j,H,_)}}function GD(w,T){var _=w[T];return typeof _=="function"&&_.length===0&&(_=_(),w[T]=_),Array.isArray(_)&&(Tp in _||Cp in _||0<_.length&&typeof _[0]=="function")?_:void 0}function KD(w,T,_,R,j,H){T.P=w[0];var U=1;if(w.length>U&&typeof w[U]!="number"){var te=w[U++];_(T,te)}for(;U<w.length;){_=w[U++];for(var ae=U+1;ae<w.length&&typeof w[ae]!="number";)ae++;switch(te=w[U++],ae-=U,ae){case 0:R(T,_,te);break;case 1:(ae=GD(w,U))?(U++,j(T,_,te,ae)):R(T,_,te,w[U++]);break;case 2:ae=U++,ae=GD(w,ae),j(T,_,te,ae,w[U++]);break;case 3:H(T,_,te,w[U++],w[U++],w[U++]);break;case 4:H(T,_,te,w[U++],w[U++],w[U++],w[U++]);break;default:throw Error("unexpected number of binary field arguments: "+ae)}}return T}var Y0=Symbol();function qD(w){var T=w[Y0];if(!T){var _=bk(w);T=function(R,j){return ZD(R,j,_)},w[Y0]=T}return T}function XD(w,T){var _=w[Y0];return _||(_=function(R,j){return WD(R,j,T)},w[Y0]=_),_}var Cp=Symbol();function F7(w,T){w.push(T)}function L7(w,T,_){w.push(T,_.W)}function M7(w,T,_,R){var j=qD(R),H=bk(R).P,U=_.W;w.push(T,function(te,ae,be){return U(te,ae,be,H,j)})}function z7(w,T,_,R,j,H){var U=XD(R,H),te=_.W;w.push(T,function(ae,be,Ne){return te(ae,be,Ne,R,U)})}function bk(w){var T=w[Cp];return T||(T=KD(w,w[Cp]=[],F7,L7,M7,z7),Tp in w&&Cp in w&&(w.length=0),T)}var Tp=Symbol();function V7(w,T){w[0]=T}function j7(w,T,_,R){var j=_.U;w[T]=R?function(H,U,te){return j(H,U,te,R)}:j}function B7(w,T,_,R,j){var H=_.U,U=HD(R),te=wk(R).P;w[T]=function(ae,be,Ne){return H(ae,be,Ne,te,U,j)}}function W7(w,T,_,R,j,H,U){var te=_.U,ae=UD(R,j,H);w[T]=function(be,Ne,ot){return te(be,Ne,ot,R,ae,U)}}function wk(w){var T=w[Tp];return T||(T=KD(w,w[Tp]={},V7,j7,B7,W7),Tp in w&&Cp in w&&(w.length=0),T)}function YD(w,T,_){for(;ii(T)&&T.i!=4;){var R=T.l,j=_[R];if(!j){var H=_[0];H&&(H=H[R])&&(j=_[R]=P7(H))}if(!j||!j(T,w,R)){j=T,R=w,H=j.j,Gd(j);var U=j;if(!U.ca){if(j=U.h.h-H,U.h.h=H,U=U.h,j==0)j=Ai();else{if(H=U0(U,j),U.S&&U.m)j=U.i.subarray(H,H+j);else{U=U.i;var te=H;j=H+j,j=te===j?Ze():mt?U.slice(te,j):new Uint8Array(U.subarray(te,j))}j=j.length==0?Ai():new ms(j,tt)}(H=R.R)?H.push(j):R.R=[j]}}}return w}function ZD(w,T,_){for(var R=_.length,j=R%2==1,H=j?1:0;H<R;H+=2)(0,_[H+1])(T,w,_[H]);WD(w,T,j?_[0]:void 0)}function Np(w,T){return{U:w,W:T}}var mo=Np(function(w,T,_){if(w.i!==5)return!1;w=w.h;var R=w.i,j=w.h,H=R[j],U=R[j+1],te=R[j+2];return R=R[j+3],Fa(w,w.h+4),U=(H<<0|U<<8|te<<16|R<<24)>>>0,w=2*(U>>31)+1,H=U>>>23&255,U&=8388607,Oi(T,_,H==255?U?NaN:1/0*w:H==0?w*Math.pow(2,-149)*U:w*Math.pow(2,H-150)*(U+Math.pow(2,23))),!0},function(w,T,_){if(T=yk(T,_),T!=null){Ri(w.h,8*_+5),w=w.h;var R=+T;R===0?0<1/R?Xe=Me=0:(Me=0,Xe=2147483648):isNaN(R)?(Me=0,Xe=2147483647):(R=(_=0>R?-2147483648:0)?-R:R,34028234663852886e22<R?(Me=0,Xe=(_|2139095040)>>>0):11754943508222875e-54>R?(R=Math.round(R/Math.pow(2,-149)),Me=0,Xe=(_|R)>>>0):(T=Math.floor(Math.log(R)/Math.LN2),R*=Math.pow(2,-T),R=Math.round(8388608*R),16777216<=R&&++T,Me=0,Xe=(_|T+127<<23|R&8388607)>>>0)),_=Xe,w.h.push(_>>>0&255),w.h.push(_>>>8&255),w.h.push(_>>>16&255),w.h.push(_>>>24&255)}}),U7=Np(function(w,T,_){if(w.i!==0)return!1;var R=w.h,j=0,H=w=0,U=R.i,te=R.h;do{var ae=U[te++];j|=(ae&127)<<H,H+=7}while(32>H&&ae&128);for(32<H&&(w|=(ae&127)>>4),H=3;32>H&&ae&128;H+=7)ae=U[te++],w|=(ae&127)<<H;if(Fa(R,te),128>ae)R=j>>>0,ae=w>>>0,(w=ae&2147483648)&&(R=~R+1>>>0,ae=~ae>>>0,R==0&&(ae=ae+1>>>0)),R=4294967296*ae+(R>>>0);else throw ce();return Oi(T,_,w?-R:R),!0},function(w,T,_){T=oi(T,_),T!=null&&(typeof T=="string"&&_n(T),T!=null&&(Ri(w.h,8*_),typeof T=="number"?(w=w.h,wt(T),js(w,Xe,Me)):(_=_n(T),js(w.h,_.i,_.h))))}),H7=Np(function(w,T,_){return w.i!==0?!1:(Oi(T,_,Il(w.h)),!0)},function(w,T,_){if(T=oi(T,_),T!=null&&T!=null)if(Ri(w.h,8*_),w=w.h,_=T,0<=_)Ri(w,_);else{for(T=0;9>T;T++)w.h.push(_&127|128),_>>=7;w.h.push(1)}}),QD=Np(function(w,T,_){if(w.i!==2)return!1;var R=Il(w.h)>>>0;w=w.h;var j=U0(w,R);if(w=w.i,St){var H=w,U;(U=ut)||(U=ut=new TextDecoder("utf-8",{fatal:!0})),w=j+R,H=j===0&&w===H.length?H:H.subarray(j,w);try{var te=U.decode(H)}catch(ot){if(Oe===void 0){try{U.decode(new Uint8Array([128]))}catch{}try{U.decode(new Uint8Array([97])),Oe=!0}catch{Oe=!1}}throw!Oe&&(ut=void 0),ot}}else{te=j,R=te+R,j=[];for(var ae=null,be,Ne;te<R;)be=w[te++],128>be?j.push(be):224>be?te>=R?xe():(Ne=w[te++],194>be||(Ne&192)!==128?(te--,xe()):j.push((be&31)<<6|Ne&63)):240>be?te>=R-1?xe():(Ne=w[te++],(Ne&192)!==128||be===224&&160>Ne||be===237&&160<=Ne||((H=w[te++])&192)!==128?(te--,xe()):j.push((be&15)<<12|(Ne&63)<<6|H&63)):244>=be?te>=R-2?xe():(Ne=w[te++],(Ne&192)!==128||(be<<28)+(Ne-144)>>30||((H=w[te++])&192)!==128||((U=w[te++])&192)!==128?(te--,xe()):(be=(be&7)<<18|(Ne&63)<<12|(H&63)<<6|U&63,be-=65536,j.push((be>>10&1023)+55296,(be&1023)+56320))):xe(),8192<=j.length&&(ae=ve(ae,j),j.length=0);te=ve(ae,j)}return Oi(T,_,te),!0},function(w,T,_){if(T=oi(T,_),T!=null){var R=!1;if(R=R===void 0?!1:R,ri){if(R&&/(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])/.test(T))throw Error("Found an unpaired surrogate");T=(hn||(hn=new TextEncoder)).encode(T)}else{for(var j=0,H=new Uint8Array(3*T.length),U=0;U<T.length;U++){var te=T.charCodeAt(U);if(128>te)H[j++]=te;else{if(2048>te)H[j++]=te>>6|192;else{if(55296<=te&&57343>=te){if(56319>=te&&U<T.length){var ae=T.charCodeAt(++U);if(56320<=ae&&57343>=ae){te=1024*(te-55296)+ae-56320+65536,H[j++]=te>>18|240,H[j++]=te>>12&63|128,H[j++]=te>>6&63|128,H[j++]=te&63|128;continue}else U--}if(R)throw Error("Found an unpaired surrogate");te=65533}H[j++]=te>>12|224,H[j++]=te>>6&63|128}H[j++]=te&63|128}}T=j===H.length?H:H.subarray(0,j)}Ri(w.h,8*_+2),Ri(w.h,T.length),La(w,w.h.end()),La(w,T)}}),JD=Np(function(w,T,_,R,j){if(w.i!==2)return!1;T=FD(T,_,R),_=w.h.j,R=Il(w.h)>>>0;var H=w.h.h+R,U=H-_;if(0>=U&&(w.h.j=H,j(T,w,void 0,void 0,void 0),U=H-w.h.h),U)throw Error("Message parsing ended unexpectedly. Expected to read "+(R+" bytes, instead read "+(R-U)+" bytes, either the data ended unexpectedly or the message misreported its own length"));return w.h.h=H,w.h.j=_,!0},function(w,T,_,R,j){if(T=xk(T,R,_),T!=null)for(R=0;R<T.length;R++){var H=w;Ri(H.h,8*_+2);var U=H.h.end();La(H,U),U.push(H.i),H=U,j(T[R],w),U=w;var te=H.pop();for(te=U.i+U.h.length()-te;127<te;)H.push(te&127|128),te>>>=7,U.i++;H.push(te),U.i++}});function Sk(w){return function(T,_){e:{if(_l.length){var R=_l.pop();R.setOptions(_),Ho(R.h,T,_),T=R}else T=new Jt(T,_);try{var j=wk(w),H=YD(new j.P,T,j);break e}finally{j=T.h,j.i=null,j.m=!1,j.l=0,j.j=0,j.h=0,j.S=!1,T.l=-1,T.i=-1,100>_l.length&&_l.push(T)}H=void 0}return H}}function kk(w){return function(){var T=new H0;ZD(this,T,bk(w)),La(T,T.h.end());for(var _=new Uint8Array(T.i),R=T.j,j=R.length,H=0,U=0;U<j;U++){var te=R[U];_.set(te,H),H+=te.length}return T.j=[_],_}}function Yd(w){Dr.call(this,w)}g(Yd,Dr);var eO=[Yd,1,H7,2,mo,3,QD,4,QD];Yd.prototype.l=kk(eO);function Ck(w){Dr.call(this,w,-1,G7)}g(Ck,Dr),Ck.prototype.addClassification=function(w,T){return FD(this,1,Yd,w,T),this};var G7=[1],K7=Sk([Ck,1,JD,eO]);function Ip(w){Dr.call(this,w)}g(Ip,Dr);var tO=[Ip,1,mo,2,mo,3,mo,4,mo,5,mo];Ip.prototype.l=kk(tO);function nO(w){Dr.call(this,w,-1,q7)}g(nO,Dr);var q7=[1],X7=Sk([nO,1,JD,tO]);function Z0(w){Dr.call(this,w)}g(Z0,Dr);var sO=[Z0,1,mo,2,mo,3,mo,4,mo,5,mo,6,U7],Y7=Sk(sO);Z0.prototype.l=kk(sO);function rO(w,T,_){if(_=w.createShader(_===0?w.VERTEX_SHADER:w.FRAGMENT_SHADER),w.shaderSource(_,T),w.compileShader(_),!w.getShaderParameter(_,w.COMPILE_STATUS))throw Error(`Could not compile WebGL shader.

`+w.getShaderInfoLog(_));return _}function Z7(w){return xk(w,Yd,1).map(function(T){var _=oi(T,1);return{index:_??0,qa:Ko(T,2),label:oi(T,3)!=null?K0(oi(T,3),""):void 0,displayName:oi(T,4)!=null?K0(oi(T,4),""):void 0}})}function Q7(w){return{x:Ko(w,1),y:Ko(w,2),z:Ko(w,3),visibility:yk(w,4)!=null?Ko(w,4):void 0}}function Tk(w){return xk(X7(w),Ip,1).map(Q7)}function Nk(w,T){this.i=w,this.h=T,this.m=0}function iO(w,T,_){return J7(w,T),typeof w.h.canvas.transferToImageBitmap=="function"?Promise.resolve(w.h.canvas.transferToImageBitmap()):_?Promise.resolve(w.h.canvas):typeof createImageBitmap=="function"?createImageBitmap(w.h.canvas):(w.j===void 0&&(w.j=document.createElement("canvas")),new Promise(function(R){w.j.height=w.h.canvas.height,w.j.width=w.h.canvas.width,w.j.getContext("2d",{}).drawImage(w.h.canvas,0,0,w.h.canvas.width,w.h.canvas.height),R(w.j)}))}function J7(w,T){var _=w.h;if(w.s===void 0){var R=rO(_,`
  attribute vec2 aVertex;
  attribute vec2 aTex;
  varying vec2 vTex;
  void main(void) {
    gl_Position = vec4(aVertex, 0.0, 1.0);
    vTex = aTex;
  }`,0),j=rO(_,`
  precision mediump float;
  varying vec2 vTex;
  uniform sampler2D sampler0;
  void main(){
    gl_FragColor = texture2D(sampler0, vTex);
  }`,1),H=_.createProgram();if(_.attachShader(H,R),_.attachShader(H,j),_.linkProgram(H),!_.getProgramParameter(H,_.LINK_STATUS))throw Error(`Could not compile WebGL program.

`+_.getProgramInfoLog(H));R=w.s=H,_.useProgram(R),j=_.getUniformLocation(R,"sampler0"),w.l={O:_.getAttribLocation(R,"aVertex"),N:_.getAttribLocation(R,"aTex"),ya:j},w.v=_.createBuffer(),_.bindBuffer(_.ARRAY_BUFFER,w.v),_.enableVertexAttribArray(w.l.O),_.vertexAttribPointer(w.l.O,2,_.FLOAT,!1,0,0),_.bufferData(_.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,1,1,-1]),_.STATIC_DRAW),_.bindBuffer(_.ARRAY_BUFFER,null),w.u=_.createBuffer(),_.bindBuffer(_.ARRAY_BUFFER,w.u),_.enableVertexAttribArray(w.l.N),_.vertexAttribPointer(w.l.N,2,_.FLOAT,!1,0,0),_.bufferData(_.ARRAY_BUFFER,new Float32Array([0,1,0,0,1,0,1,1]),_.STATIC_DRAW),_.bindBuffer(_.ARRAY_BUFFER,null),_.uniform1i(j,0)}R=w.l,_.useProgram(w.s),_.canvas.width=T.width,_.canvas.height=T.height,_.viewport(0,0,T.width,T.height),_.activeTexture(_.TEXTURE0),w.i.bindTexture2d(T.glName),_.enableVertexAttribArray(R.O),_.bindBuffer(_.ARRAY_BUFFER,w.v),_.vertexAttribPointer(R.O,2,_.FLOAT,!1,0,0),_.enableVertexAttribArray(R.N),_.bindBuffer(_.ARRAY_BUFFER,w.u),_.vertexAttribPointer(R.N,2,_.FLOAT,!1,0,0),_.bindFramebuffer(_.DRAW_FRAMEBUFFER?_.DRAW_FRAMEBUFFER:_.FRAMEBUFFER,null),_.clearColor(0,0,0,0),_.clear(_.COLOR_BUFFER_BIT),_.colorMask(!0,!0,!0,!0),_.drawArrays(_.TRIANGLE_FAN,0,4),_.disableVertexAttribArray(R.O),_.disableVertexAttribArray(R.N),_.bindBuffer(_.ARRAY_BUFFER,null),w.i.bindTexture2d(0)}function eY(w){this.h=w}var tY=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,9,1,7,0,65,0,253,15,26,11]);function nY(w,T){return T+w}function oO(w,T){window[w]=T}function sY(w){var T=document.createElement("script");return T.setAttribute("src",w),T.setAttribute("crossorigin","anonymous"),new Promise(function(_){T.addEventListener("load",function(){_()},!1),T.addEventListener("error",function(){_()},!1),document.body.appendChild(T)})}function rY(){return P(function(w){switch(w.h){case 1:return w.s=2,b(w,WebAssembly.instantiate(tY),4);case 4:w.h=3,w.s=0;break;case 2:return w.s=0,w.l=null,w.return(!1);case 3:return w.return(!0)}})}function Ik(w){if(this.h=w,this.listeners={},this.l={},this.L={},this.s={},this.v={},this.M=this.u=this.ga=!0,this.I=Promise.resolve(),this.fa="",this.D={},this.locateFile=w&&w.locateFile||nY,typeof window=="object")var T=window.location.pathname.toString().substring(0,window.location.pathname.toString().lastIndexOf("/"))+"/";else if(typeof location<"u")T=location.pathname.toString().substring(0,location.pathname.toString().lastIndexOf("/"))+"/";else throw Error("solutions can only be loaded on a web page or in a web worker");if(this.ha=T,w.options){T=a(Object.keys(w.options));for(var _=T.next();!_.done;_=T.next()){_=_.value;var R=w.options[_].default;R!==void 0&&(this.l[_]=typeof R=="function"?R():R)}}}t=Ik.prototype,t.close=function(){return this.j&&this.j.delete(),Promise.resolve()};function iY(w){var T,_,R,j,H,U,te,ae,be,Ne,ot;return P(function(Qe){switch(Qe.h){case 1:return w.ga?(T=w.h.files===void 0?[]:typeof w.h.files=="function"?w.h.files(w.l):w.h.files,b(Qe,rY(),2)):Qe.return();case 2:if(_=Qe.i,typeof window=="object")return oO("createMediapipeSolutionsWasm",{locateFile:w.locateFile}),oO("createMediapipeSolutionsPackedAssets",{locateFile:w.locateFile}),U=T.filter(function(De){return De.data!==void 0}),te=T.filter(function(De){return De.data===void 0}),ae=Promise.all(U.map(function(De){var at=Q0(w,De.url);if(De.path!==void 0){var kt=De.path;at=at.then(function(pn){return w.overrideFile(kt,pn),Promise.resolve(pn)})}return at})),be=Promise.all(te.map(function(De){return De.simd===void 0||De.simd&&_||!De.simd&&!_?sY(w.locateFile(De.url,w.ha)):Promise.resolve()})).then(function(){var De,at,kt;return P(function(pn){if(pn.h==1)return De=window.createMediapipeSolutionsWasm,at=window.createMediapipeSolutionsPackedAssets,kt=w,b(pn,De(at),2);kt.i=pn.i,pn.h=0})}),Ne=function(){return P(function(De){return w.h.graph&&w.h.graph.url?De=b(De,Q0(w,w.h.graph.url),0):(De.h=0,De=void 0),De})}(),b(Qe,Promise.all([be,ae,Ne]),7);if(typeof importScripts!="function")throw Error("solutions can only be loaded on a web page or in a web worker");return R=T.filter(function(De){return De.simd===void 0||De.simd&&_||!De.simd&&!_}).map(function(De){return w.locateFile(De.url,w.ha)}),importScripts.apply(null,l(R)),j=w,b(Qe,createMediapipeSolutionsWasm(Module),6);case 6:j.i=Qe.i,w.m=new OffscreenCanvas(1,1),w.i.canvas=w.m,H=w.i.GL.createContext(w.m,{antialias:!1,alpha:!1,va:typeof WebGL2RenderingContext<"u"?2:1}),w.i.GL.makeContextCurrent(H),Qe.h=4;break;case 7:if(w.m=document.createElement("canvas"),ot=w.m.getContext("webgl2",{}),!ot&&(ot=w.m.getContext("webgl",{}),!ot))return alert("Failed to create WebGL canvas context when passing video frame."),Qe.return();w.K=ot,w.i.canvas=w.m,w.i.createContext(w.m,!0,!0,{});case 4:w.j=new w.i.SolutionWasm,w.ga=!1,Qe.h=0}})}function oY(w){var T,_,R,j,H,U,te,ae;return P(function(be){if(be.h==1){if(w.h.graph&&w.h.graph.url&&w.fa===w.h.graph.url)return be.return();if(w.u=!0,!w.h.graph||!w.h.graph.url){be.h=2;return}return w.fa=w.h.graph.url,b(be,Q0(w,w.h.graph.url),3)}for(be.h!=2&&(T=be.i,w.j.loadGraph(T)),_=a(Object.keys(w.D)),R=_.next();!R.done;R=_.next())j=R.value,w.j.overrideFile(j,w.D[j]);if(w.D={},w.h.listeners)for(H=a(w.h.listeners),U=H.next();!U.done;U=H.next())te=U.value,uY(w,te);ae=w.l,w.l={},w.setOptions(ae),be.h=0})}t.reset=function(){var w=this;return P(function(T){w.j&&(w.j.reset(),w.s={},w.v={}),T.h=0})},t.setOptions=function(w,T){var _=this;if(T=T||this.h.options){for(var R=[],j=[],H={},U=a(Object.keys(w)),te=U.next();!te.done;H={X:H.X,Y:H.Y},te=U.next())if(te=te.value,!(te in this.l&&this.l[te]===w[te])){this.l[te]=w[te];var ae=T[te];ae!==void 0&&(ae.onChange&&(H.X=ae.onChange,H.Y=w[te],R.push(function(be){return function(){var Ne;return P(function(ot){if(ot.h==1)return b(ot,be.X(be.Y),2);Ne=ot.i,Ne===!0&&(_.u=!0),ot.h=0})}}(H))),ae.graphOptionXref&&(te=Object.assign({},{calculatorName:"",calculatorIndex:0},ae.graphOptionXref,{valueNumber:ae.type===1?w[te]:0,valueBoolean:ae.type===0?w[te]:!1,valueString:ae.type===2?w[te]:""}),j.push(te)))}(R.length!==0||j.length!==0)&&(this.u=!0,this.H=(this.H===void 0?[]:this.H).concat(j),this.F=(this.F===void 0?[]:this.F).concat(R))}};function aY(w){var T,_,R,j,H,U,te;return P(function(ae){switch(ae.h){case 1:if(!w.u)return ae.return();if(!w.F){ae.h=2;break}T=a(w.F),_=T.next();case 3:if(_.done){ae.h=5;break}return R=_.value,b(ae,R(),4);case 4:_=T.next(),ae.h=3;break;case 5:w.F=void 0;case 2:if(w.H){for(j=new w.i.GraphOptionChangeRequestList,H=a(w.H),U=H.next();!U.done;U=H.next())te=U.value,j.push_back(te);w.j.changeOptions(j),j.delete(),w.H=void 0}w.u=!1,ae.h=0}})}t.initialize=function(){var w=this;return P(function(T){return T.h==1?b(T,iY(w),2):T.h!=3?b(T,oY(w),3):b(T,aY(w),0)})};function Q0(w,T){var _,R;return P(function(j){return T in w.L?j.return(w.L[T]):(_=w.locateFile(T,""),R=fetch(_).then(function(H){return H.arrayBuffer()}),w.L[T]=R,j.return(R))})}t.overrideFile=function(w,T){this.j?this.j.overrideFile(w,T):this.D[w]=T},t.clearOverriddenFiles=function(){this.D={},this.j&&this.j.clearOverriddenFiles()},t.send=function(w,T){var _=this,R,j,H,U,te,ae,be,Ne,ot;return P(function(Qe){switch(Qe.h){case 1:return _.h.inputs?(R=1e3*(T??performance.now()),b(Qe,_.I,2)):Qe.return();case 2:return b(Qe,_.initialize(),3);case 3:for(j=new _.i.PacketDataList,H=a(Object.keys(w)),U=H.next();!U.done;U=H.next())if(te=U.value,ae=_.h.inputs[te]){e:{var De=w[te];switch(ae.type){case"video":var at=_.s[ae.stream];if(at||(at=new Nk(_.i,_.K),_.s[ae.stream]=at),at.m===0&&(at.m=at.i.createTexture()),typeof HTMLVideoElement<"u"&&De instanceof HTMLVideoElement)var kt=De.videoWidth,pn=De.videoHeight;else typeof HTMLImageElement<"u"&&De instanceof HTMLImageElement?(kt=De.naturalWidth,pn=De.naturalHeight):(kt=De.width,pn=De.height);pn={glName:at.m,width:kt,height:pn},kt=at.h,kt.canvas.width=pn.width,kt.canvas.height=pn.height,kt.activeTexture(kt.TEXTURE0),at.i.bindTexture2d(at.m),kt.texImage2D(kt.TEXTURE_2D,0,kt.RGBA,kt.RGBA,kt.UNSIGNED_BYTE,De),at.i.bindTexture2d(0),at=pn;break e;case"detections":for(at=_.s[ae.stream],at||(at=new eY(_.i),_.s[ae.stream]=at),at.data||(at.data=new at.h.DetectionListData),at.data.reset(De.length),pn=0;pn<De.length;++pn){kt=De[pn];var on=at.data,Bs=on.setBoundingBox,Pi=pn,Or=kt.la,Mt=new Z0;if(Go(Mt,1,Or.sa),Go(Mt,2,Or.ta),Go(Mt,3,Or.height),Go(Mt,4,Or.width),Go(Mt,5,Or.rotation),Oi(Mt,6,Or.pa),Or=Mt.l(),Bs.call(on,Pi,Or),kt.ea)for(on=0;on<kt.ea.length;++on){Mt=kt.ea[on],Bs=at.data,Pi=Bs.addNormalizedLandmark,Or=pn,Mt=Object.assign({},Mt,{visibility:Mt.visibility?Mt.visibility:0});var Ws=new Ip;Go(Ws,1,Mt.x),Go(Ws,2,Mt.y),Go(Ws,3,Mt.z),Mt.visibility&&Go(Ws,4,Mt.visibility),Mt=Ws.l(),Pi.call(Bs,Or,Mt)}if(kt.ba)for(on=0;on<kt.ba.length;++on)Bs=at.data,Pi=Bs.addClassification,Or=pn,Mt=kt.ba[on],Ws=new Yd,Go(Ws,2,Mt.qa),Mt.index&&Oi(Ws,1,Mt.index),Mt.label&&Oi(Ws,3,Mt.label),Mt.displayName&&Oi(Ws,4,Mt.displayName),Mt=Ws.l(),Pi.call(Bs,Or,Mt)}at=at.data;break e;default:at={}}}switch(be=at,Ne=ae.stream,ae.type){case"video":j.pushTexture2d(Object.assign({},be,{stream:Ne,timestamp:R}));break;case"detections":ot=be,ot.stream=Ne,ot.timestamp=R,j.pushDetectionList(ot);break;default:throw Error("Unknown input config type: '"+ae.type+"'")}}return _.j.send(j),b(Qe,_.I,4);case 4:j.delete(),Qe.h=0}})};function lY(w,T,_){var R,j,H,U,te,ae,be,Ne,ot,Qe,De,at,kt,pn;return P(function(on){switch(on.h){case 1:if(!_)return on.return(T);for(R={},j=0,H=a(Object.keys(_)),U=H.next();!U.done;U=H.next())te=U.value,ae=_[te],typeof ae!="string"&&ae.type==="texture"&&T[ae.stream]!==void 0&&++j;1<j&&(w.M=!1),be=a(Object.keys(_)),U=be.next();case 2:if(U.done){on.h=4;break}if(Ne=U.value,ot=_[Ne],typeof ot=="string")return kt=R,pn=Ne,b(on,cY(w,Ne,T[ot]),14);if(Qe=T[ot.stream],ot.type==="detection_list"){if(Qe){for(var Bs=Qe.getRectList(),Pi=Qe.getLandmarksList(),Or=Qe.getClassificationsList(),Mt=[],Ws=0;Ws<Bs.size();++Ws){var El=Y7(Bs.get(Ws)),dY=Ko(El,1),hY=Ko(El,2),fY=Ko(El,3),pY=Ko(El,4),mY=Ko(El,5,0),J0=void 0;J0=J0===void 0?0:J0,El={la:{sa:dY,ta:hY,height:fY,width:pY,rotation:mY,pa:K0(oi(El,6),J0)},ea:Tk(Pi.get(Ws)),ba:Z7(K7(Or.get(Ws)))},Mt.push(El)}Bs=Mt}else Bs=[];R[Ne]=Bs,on.h=7;break}if(ot.type==="proto_list"){if(Qe){for(Bs=Array(Qe.size()),Pi=0;Pi<Qe.size();Pi++)Bs[Pi]=Qe.get(Pi);Qe.delete()}else Bs=[];R[Ne]=Bs,on.h=7;break}if(Qe===void 0){on.h=3;break}if(ot.type==="float_list"){R[Ne]=Qe,on.h=7;break}if(ot.type==="proto"){R[Ne]=Qe,on.h=7;break}if(ot.type!=="texture")throw Error("Unknown output config type: '"+ot.type+"'");return De=w.v[Ne],De||(De=new Nk(w.i,w.K),w.v[Ne]=De),b(on,iO(De,Qe,w.M),13);case 13:at=on.i,R[Ne]=at;case 7:ot.transform&&R[Ne]&&(R[Ne]=ot.transform(R[Ne])),on.h=3;break;case 14:kt[pn]=on.i;case 3:U=be.next(),on.h=2;break;case 4:return on.return(R)}})}function cY(w,T,_){var R;return P(function(j){return typeof _=="number"||_ instanceof Uint8Array||_ instanceof w.i.Uint8BlobList?j.return(_):_ instanceof w.i.Texture2dDataOut?(R=w.v[T],R||(R=new Nk(w.i,w.K),w.v[T]=R),j.return(iO(R,_,w.M))):j.return(void 0)})}function uY(w,T){for(var _=T.name||"$",R=[].concat(l(T.wants)),j=new w.i.StringList,H=a(T.wants),U=H.next();!U.done;U=H.next())j.push_back(U.value);H=w.i.PacketListener.implement({onResults:function(te){for(var ae={},be=0;be<T.wants.length;++be)ae[R[be]]=te.get(be);var Ne=w.listeners[_];Ne&&(w.I=lY(w,ae,T.outs).then(function(ot){ot=Ne(ot);for(var Qe=0;Qe<T.wants.length;++Qe){var De=ae[R[Qe]];typeof De=="object"&&De.hasOwnProperty&&De.hasOwnProperty("delete")&&De.delete()}ot&&(w.I=ot)}))}}),w.j.attachMultiListener(j,H),j.delete()}t.onResults=function(w,T){this.listeners[T||"$"]=w},B("Solution",Ik),B("OptionType",{BOOL:0,NUMBER:1,ua:2,0:"BOOL",1:"NUMBER",2:"STRING"});function aO(w){switch(w===void 0&&(w=0),w){case 1:return"pose_landmark_full.tflite";case 2:return"pose_landmark_heavy.tflite";default:return"pose_landmark_lite.tflite"}}function lO(w){var T=this;w=w||{},this.h=new Ik({locateFile:w.locateFile,files:function(_){return[{url:"pose_solution_packed_assets_loader.js"},{simd:!1,url:"pose_solution_wasm_bin.js"},{simd:!0,url:"pose_solution_simd_wasm_bin.js"},{data:!0,url:aO(_.modelComplexity)}]},graph:{url:"pose_web.binarypb"},listeners:[{wants:["pose_landmarks","world_landmarks","segmentation_mask","image_transformed"],outs:{image:{type:"texture",stream:"image_transformed"},poseLandmarks:{type:"proto",stream:"pose_landmarks",transform:Tk},poseWorldLandmarks:{type:"proto",stream:"world_landmarks",transform:Tk},segmentationMask:{type:"texture",stream:"segmentation_mask"}}}],inputs:{image:{type:"video",stream:"input_frames_gpu"}},options:{useCpuInference:{type:0,graphOptionXref:{calculatorType:"InferenceCalculator",fieldName:"use_cpu_inference"},default:typeof window!="object"||window.navigator===void 0?!1:"iPad Simulator;iPhone Simulator;iPod Simulator;iPad;iPhone;iPod".split(";").includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document},selfieMode:{type:0,graphOptionXref:{calculatorType:"GlScalerCalculator",calculatorIndex:1,fieldName:"flip_horizontal"}},modelComplexity:{type:1,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorModelComplexity",fieldName:"int_value"},onChange:function(_){var R,j,H;return P(function(U){return U.h==1?(R=aO(_),j="third_party/mediapipe/modules/pose_landmark/"+R,b(U,Q0(T.h,R),2)):(H=U.i,T.h.overrideFile(j,H),U.return(!0))})}},smoothLandmarks:{type:0,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorSmoothLandmarks",fieldName:"bool_value"}},enableSegmentation:{type:0,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorEnableSegmentation",fieldName:"bool_value"}},smoothSegmentation:{type:0,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorSmoothSegmentation",fieldName:"bool_value"}},minDetectionConfidence:{type:1,graphOptionXref:{calculatorType:"TensorsToDetectionsCalculator",calculatorName:"poselandmarkgpu__posedetectiongpu__TensorsToDetectionsCalculator",fieldName:"min_score_thresh"}},minTrackingConfidence:{type:1,graphOptionXref:{calculatorType:"ThresholdingCalculator",calculatorName:"poselandmarkgpu__poselandmarkbyroigpu__tensorstoposelandmarksandsegmentation__ThresholdingCalculator",fieldName:"threshold"}}}})}t=lO.prototype,t.reset=function(){this.h.reset()},t.close=function(){return this.h.close(),Promise.resolve()},t.onResults=function(w){this.h.onResults(w)},t.initialize=function(){var w=this;return P(function(T){return b(T,w.h.initialize(),0)})},t.send=function(w,T){var _=this;return P(function(R){return b(R,_.h.send(w,T),0)})},t.setOptions=function(w){this.h.setOptions(w)},B("Pose",lO),B("POSE_CONNECTIONS",[[0,1],[1,2],[2,3],[3,7],[0,4],[4,5],[5,6],[6,8],[9,10],[11,12],[11,13],[13,15],[15,17],[15,19],[15,21],[17,19],[12,14],[14,16],[16,18],[16,20],[16,22],[18,20],[11,23],[12,24],[23,24],[23,25],[24,26],[25,27],[26,28],[27,29],[28,30],[29,31],[30,32],[27,31],[28,32]]),B("POSE_LANDMARKS",{NOSE:0,LEFT_EYE_INNER:1,LEFT_EYE:2,LEFT_EYE_OUTER:3,RIGHT_EYE_INNER:4,RIGHT_EYE:5,RIGHT_EYE_OUTER:6,LEFT_EAR:7,RIGHT_EAR:8,LEFT_RIGHT:9,RIGHT_LEFT:10,LEFT_SHOULDER:11,RIGHT_SHOULDER:12,LEFT_ELBOW:13,RIGHT_ELBOW:14,LEFT_WRIST:15,RIGHT_WRIST:16,LEFT_PINKY:17,RIGHT_PINKY:18,LEFT_INDEX:19,RIGHT_INDEX:20,LEFT_THUMB:21,RIGHT_THUMB:22,LEFT_HIP:23,RIGHT_HIP:24,LEFT_KNEE:25,RIGHT_KNEE:26,LEFT_ANKLE:27,RIGHT_ANKLE:28,LEFT_HEEL:29,RIGHT_HEEL:30,LEFT_FOOT_INDEX:31,RIGHT_FOOT_INDEX:32}),B("POSE_LANDMARKS_LEFT",{LEFT_EYE_INNER:1,LEFT_EYE:2,LEFT_EYE_OUTER:3,LEFT_EAR:7,LEFT_RIGHT:9,LEFT_SHOULDER:11,LEFT_ELBOW:13,LEFT_WRIST:15,LEFT_PINKY:17,LEFT_INDEX:19,LEFT_THUMB:21,LEFT_HIP:23,LEFT_KNEE:25,LEFT_ANKLE:27,LEFT_HEEL:29,LEFT_FOOT_INDEX:31}),B("POSE_LANDMARKS_RIGHT",{RIGHT_EYE_INNER:4,RIGHT_EYE:5,RIGHT_EYE_OUTER:6,RIGHT_EAR:8,RIGHT_LEFT:10,RIGHT_SHOULDER:12,RIGHT_ELBOW:14,RIGHT_WRIST:16,RIGHT_PINKY:18,RIGHT_INDEX:20,RIGHT_THUMB:22,RIGHT_HIP:24,RIGHT_KNEE:26,RIGHT_ANKLE:28,RIGHT_HEEL:30,RIGHT_FOOT_INDEX:32}),B("POSE_LANDMARKS_NEUTRAL",{NOSE:0}),B("VERSION","0.5.1675469404")}).call($o);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hge=1e-7,fge=1e-4;class I6{constructor(e,n){this.backend=e,this.dataMover=n,this.data=new WeakMap,this.dataIdsCount=0}get(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}set(e,n){this.dataIdsCount++,this.data.set(e,n)}has(e){return this.data.has(e)}delete(e){return this.dataIdsCount--,this.data.delete(e)}numDataIds(){return this.dataIdsCount}}class p${refCount(e){return ai("refCount")}incRef(e){return ai("incRef")}timerAvailable(){return!0}time(e){return ai("time")}read(e){return ai("read")}readSync(e){return ai("readSync")}readToGPU(e,n){return ai("readToGPU")}numDataIds(){return ai("numDataIds")}disposeData(e,n){return ai("disposeData")}write(e,n,s){return ai("write")}move(e,n,s,r,i){return ai("move")}memory(){return ai("memory")}floatPrecision(){return ai("floatPrecision")}epsilon(){return this.floatPrecision()===32?hge:fge}dispose(){return ai("dispose")}}function ai(t){throw new Error(`'${t}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pge(t){let e=t.length,n=0;for(;e>0;)n=Math.random()*e|0,e--,lh(t,e,n)}function xd(t,e,n){return Math.max(t,Math.min(e,n))}function m$(t){return t%2===0?t:t+1}function lh(t,e,n){const s=t[e];t[e]=t[n],t[n]=s}function mge(t){let e=0;for(let n=0;n<t.length;n++)e+=t[n];return e}function O(t,e){if(!t)throw new Error(typeof e=="string"?e:e())}function ni(t,e,n=""){O(Et(t,e),()=>n+` Shapes ${t} and ${e} must match`)}function sp(t){O(t!=null,()=>"The input to the tensor constructor must be a non-null value.")}function _f(t,e=[],n=!1){if(e==null&&(e=[]),Array.isArray(t)||_a(t)&&!n)for(let s=0;s<t.length;++s)_f(t[s],e,n);else e.push(t);return e}function le(t){if(t.length===0)return 1;let e=t[0];for(let n=1;n<t.length;n++)e*=t[n];return e}function Et(t,e){if(t===e)return!0;if(t==null||e==null||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function Ef(t){return t%1===0}function T2(t){const e=Math.ceil(Math.sqrt(t));return[e,Math.ceil(t/e)]}function Wh(t,e){return e<=t.length?t:t+" ".repeat(e-t.length)}function I3(t,e=r=>0,n,s=setTimeout){return new Promise((r,i)=>{let o=0;const a=()=>{if(t()){r();return}o++;const l=e(o);if(n!=null&&o>=n){i();return}s(a,l)};a()})}function _6(t,e){let n=1,s=-1;for(let i=0;i<t.length;++i)if(t[i]>=0)n*=t[i];else if(t[i]===-1){if(s!==-1)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${s} and dim ${i}`);s=i}else if(t[i]<0)throw Error(`Shapes can not be < 0. Found ${t[i]} at dim ${i}`);if(s===-1){if(e>0&&e!==n)throw Error(`Size(${e}) must match the product of shape ${t}`);return t}if(n===0)throw Error(`Cannot infer the missing size in [${t}] when there are 0 elements`);if(e%n!==0)throw Error(`The implicit shape can't be a fractional number. Got ${e} / ${n}`);const r=t.slice();return r[s]=e/n,r}function bt(t,e){const n=e.length;return t=t==null?e.map((s,r)=>r):[].concat(t),O(t.every(s=>s>=-n&&s<n),()=>`All values in axis param must be in range [-${n}, ${n}) but got axis ${t}`),O(t.every(s=>Ef(s)),()=>`All values in axis param must be integers but got axis ${t}`),t.map(s=>s<0?n+s:s)}function eu(t,e){const n=[],s=[],r=e!=null&&Array.isArray(e)&&e.length===0,i=e==null||r?null:bt(e,t).sort();let o=0;for(let a=0;a<t.length;++a){if(i!=null){if(i[o]===a&&t[a]!==1)throw new Error(`Can't squeeze axis ${a} since its dim '${t[a]}' is not 1`);(i[o]==null||i[o]>a)&&t[a]===1&&(n.push(t[a]),s.push(a)),i[o]<=a&&o++}t[a]!==1&&(n.push(t[a]),s.push(a))}return{newShape:n,keptDims:s}}function Cs(t,e){let n=null;if(t==null||t==="float32")n=new Float32Array(e);else if(t==="int32")n=new Int32Array(e);else if(t==="bool")n=new Uint8Array(e);else throw new Error(`Unknown data type ${t}`);return n}function ws(t,e){let n=null;if(t==null||t==="float32")n=new Float32Array(e);else if(t==="int32")n=new Int32Array(e);else if(t==="bool")n=new Uint8Array(e);else if(t==="string")n=new Array(e);else throw new Error(`Unknown data type ${t}`);return n}function gge(t,e){for(let n=0;n<t.length;n++){const s=t[n];if(isNaN(s)||!isFinite(s))throw Error(`A tensor of type ${e} being uploaded contains ${s}.`)}}function yge(t){return t==="bool"||t==="complex64"||t==="float32"||t==="int32"||t==="string"}function E6(t,e){return!(e==="complex64"||e==="float32"&&t!=="complex64"||e==="int32"&&t!=="float32"&&t!=="complex64"||e==="bool"&&t==="bool")}function _a(t){return t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray}function N2(t){if(t==="float32"||t==="int32")return 4;if(t==="complex64")return 8;if(t==="bool")return 1;throw new Error(`Unknown dtype ${t}`)}function xge(t){if(t==null)return 0;let e=0;return t.forEach(n=>e+=n.length),e}function xy(t){return typeof t=="string"||t instanceof String}function vge(t){return typeof t=="boolean"}function I2(t){return typeof t=="number"}function vy(t){return Array.isArray(t)?vy(t[0]):t instanceof Float32Array?"float32":t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray?"int32":I2(t)?"float32":xy(t)?"string":vge(t)?"bool":"float32"}function _2(t){return!!(t&&t.constructor&&t.call&&t.apply)}function E2(t,e){for(let n=e;n<t;++n)if(t%n===0)return n;return t}function Ye(t){const e=t.length;if(e<2)return[];const n=new Array(e-1);n[e-2]=t[e-1];for(let s=e-3;s>=0;--s)n[s]=n[s+1]*t[s+1];return n}function $6(t,e,n,s=!1){const r=new Array;if(e.length===1){const i=e[0]*(s?2:1);for(let o=0;o<i;o++)r[o]=n[t+o]}else{const i=e[0],o=e.slice(1),a=o.reduce((l,c)=>l*c)*(s?2:1);for(let l=0;l<i;l++)r[l]=$6(t+l*a,o,n,s)}return r}function so(t,e,n=!1){if(t.length===0)return e[0];const s=t.reduce((r,i)=>r*i)*(n?2:1);if(s===0)return[];if(s!==e.length)throw new Error(`[${t}] does not match the input size ${e.length}${n?" for a complex tensor":""}.`);return $6(0,t,e,n)}function g$(t,e){const n=Xs(t,e);for(let s=0;s<n.length;s++)n[s]=1;return n}function Xs(t,e){if(e==null||e==="float32"||e==="complex64")return new Float32Array(t);if(e==="int32")return new Int32Array(t);if(e==="bool")return new Uint8Array(t);throw new Error(`Unknown data type ${e}`)}function A6(t,e){const n=t.reduce((s,r)=>s*r,1);if(e==null||e==="float32")return so(t,new Float32Array(n));if(e==="int32")return so(t,new Int32Array(n));if(e==="bool")return so(t,new Uint8Array(n));throw new Error(`Unknown data type ${e}`)}function R6(t){t.forEach(e=>{O(Number.isInteger(e)&&e>=0,()=>`Tensor must have a shape comprised of positive integers but got shape [${t}].`)})}function ba(t,e,n){if(e===0)return 0;if(e===1)return t[0];let s=t[t.length-1];for(let r=0;r<t.length-1;++r)s+=n[r]*t[r];return s}function rp(t,e,n){if(e===0)return[];if(e===1)return[t];const s=new Array(e);for(let r=0;r<s.length-1;++r)s[r]=Math.floor(t/n[r]),t-=s[r]*n[r];return s[s.length-1]=t,s}function $f(t){return t&&t.then&&typeof t.then=="function"}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _3="tfjsflags";class bge{constructor(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=wge,this.populateURLFlags()}setPlatform(e,n){this.platform!=null&&(oe().getBool("IS_TEST")||oe().getBool("PROD")||console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${e}.`)),this.platformName=e,this.platform=n}registerFlag(e,n,s){if(this.flagRegistry[e]={evaluationFn:n,setHook:s},this.urlFlags[e]!=null){const r=this.urlFlags[e];oe().getBool("IS_TEST")||oe().getBool("PROD")||console.warn(`Setting feature override from URL ${e}: ${r}.`),this.set(e,r)}}async getAsync(e){return e in this.flags?this.flags[e]:(this.flags[e]=await this.evaluateFlag(e),this.flags[e])}get(e){if(e in this.flags)return this.flags[e];const n=this.evaluateFlag(e);if($f(n))throw new Error(`Flag ${e} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[e]=n,this.flags[e]}getNumber(e){return this.get(e)}getBool(e){return this.get(e)}getFlags(){return this.flags}get features(){return this.flags}set(e,n){if(this.flagRegistry[e]==null)throw new Error(`Cannot set flag ${e} as it has not been registered.`);this.flags[e]=n,this.flagRegistry[e].setHook!=null&&this.flagRegistry[e].setHook(n)}evaluateFlag(e){if(this.flagRegistry[e]==null)throw new Error(`Cannot evaluate flag '${e}': no evaluation function found.`);return this.flagRegistry[e].evaluationFn()}setFlags(e){this.flags=Object.assign({},e)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(typeof this.global>"u"||typeof this.global.location>"u"||typeof this.global.location.search>"u")return;const e=this.getQueryParams(this.global.location.search);_3 in e&&e[_3].split(",").forEach(s=>{const[r,i]=s.split(":");this.urlFlags[r]=kge(r,i)})}}function wge(t){const e={};return t.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(n,...s)=>(Sge(e,s[0],s[1]),s.join("="))),e}function Sge(t,e,n){t[decodeURIComponent(e)]=decodeURIComponent(n||"")}function kge(t,e){if(e=e.toLowerCase(),e==="true"||e==="false")return e==="true";if(`${+e}`===e)return+e;throw new Error(`Could not parse value flag value ${e} for flag ${t}.`)}function oe(){return D6}let D6=null;function Cge(t){D6=t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let BC;function O6(){if(BC==null){let t;if(typeof window<"u")t=window;else if(typeof global<"u")t=global;else if(typeof process<"u")t=process;else if(typeof self<"u")t=self;else throw new Error("Could not find a global object");BC=t}return BC}function Tge(){const t=O6();return t._tfGlobals==null&&(t._tfGlobals=new Map),t._tfGlobals}function y$(t,e){const n=Tge();if(n.has(t))return n.get(t);{const s=e();return n.set(t,s),n.get(t)}}const k1="Abs",by="Acos",wy="Acosh",ip="Add",C1="AddN",x$="All",v$="Any",T1="ArgMax",N1="ArgMin",Sy="Asin",ky="Asinh",Cy="Atan",Ty="Atanh",Ny="Atan2",I1="AvgPool",b$="AvgPoolGrad",_1="AvgPool3D",w$="AvgPool3DGrad",E1="BatchMatMul",$1="BatchToSpaceND",S$="Bincount",Nge="BroadcastTo",k$="BroadcastArgs",Iy="Cast",_y="Ceil",Ey="ClipByValue",C$="Complex",A1="ComplexAbs",R1="Concat",D1="Conv2D",T$="Conv2DBackpropFilter",O1="Conv2DBackpropInput",P1="Conv3D",N$="Conv3DBackpropFilterV2",I$="Conv3DBackpropInputV2",$y="Cos",Ay="Cosh",_$="Cumprod",F1="Cumsum",E$="CropAndResize",$$="DenseBincount",A$="DepthToSpace",L1="DepthwiseConv2dNative",R$="DepthwiseConv2dNativeBackpropFilter",D$="DepthwiseConv2dNativeBackpropInput",O$="Diag",M1="Dilation2D",$2="Dilation2DBackpropInput",A2="Dilation2DBackpropFilter",Ry="RealDiv",P$="Einsum",Dy="Elu",F$="EluGrad",Oy="Erf",z1="Equal",Py="Exp",V1="ExpandDims",Fy="Expm1",L$="FFT",M$="Fill",z$="FlipLeftRight",Ly="Floor",My="FloorDiv",j1="FusedBatchNorm",B1="GatherV2",V$="GatherNd",W1="Greater",zy="GreaterEqual",Vy="Identity",j$="IFFT",B$="Imag",jy="IsFinite",By="IsInf",Wy="IsNan",U1="LeakyRelu",H1="Less",G1="LessEqual",W$="LinSpace",Uy="Log",Hy="Log1p",K1="LogicalAnd",q1="LogicalNot",X1="LogicalOr",Ige="LogSoftmax",Y1="LRN",U$="LRNGrad",Z1="Max",Gy="Maximum",Q1="MaxPool",H$="MaxPoolGrad",J1="MaxPool3D",G$="MaxPool3DGrad",K$="MaxPoolWithArgmax",eS="Mean",tS="Min",Ky="Minimum",nS="MirrorPad",qy="Mod",q$="Multinomial",Xy="Multiply",sS="Neg",rS="NotEqual",X$="NonMaxSuppressionV3",Y$="NonMaxSuppressionV4",Z$="NonMaxSuppressionV5",iS="OnesLike",oS="OneHot",aS="Pack",lS="PadV2",Yy="Pow",cS="Prelu",uS="Prod",Q$="RaggedGather",J$="RaggedTensorToTensor",eA="Range",tA="Real",Zy="Reciprocal",Qy="Relu",dS="Reshape",hS="ResizeNearestNeighbor",nA="ResizeNearestNeighborGrad",fS="ResizeBilinear",sA="ResizeBilinearGrad",Jy="Relu6",pS="Reverse",e0="Round",t0="Rsqrt",rA="ScatterNd",iA="SearchSorted",mS="Select",n0="Selu",gS="Slice",s0="Sin",r0="Sinh",i0="Sign",o0="Sigmoid",a0="Softplus",l0="Sqrt",yS="Sum",xS="SpaceToBatchND",vS="SplitV",bS="Softmax",oA="SparseFillEmptyRows",aA="SparseReshape",lA="SparseSegmentMean",cA="SparseSegmentSum",uA="SparseToDense",c0="SquaredDifference",dA="Square",hA="StridedSlice",fA="StringNGrams",pA="StringSplit",mA="StringToHashBucketFast",u0="Sub",d0="Tan",h0="Tanh",f0="Tile",gA="TopK",yA="Transform",Uh="Transpose",xA="Unique",wS="Unpack",SS="UnsortedSegmentSum",kS="ZerosLike",p0="Step",R2="FromPixels",vA="RotateWithOffset",Kb="_FusedMatMul",qb="FusedConv2D",Xb="FusedDepthwiseConv2D";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pi(...t){oe().getBool("IS_TEST")||oe().getBool("PROD")||console.warn(...t)}function _ge(...t){oe().getBool("IS_TEST")||oe().getBool("PROD")||console.log(...t)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yb=y$("kernelRegistry",()=>new Map),D2=y$("gradRegistry",()=>new Map);function O2(t,e){const n=F6(t,e);return Yb.get(n)}function E3(t){return D2.get(t)}function $3(t){const e=Yb.entries(),n=[];for(;;){const{done:s,value:r}=e.next();if(s)break;const[i,o]=r,[a]=i.split("_");a===t&&n.push(o)}return n}function P6(t){const{kernelName:e,backendName:n}=t,s=F6(e,n);Yb.has(s)&&pi(`The kernel '${e}' for backend '${n}' is already registered`),Yb.set(s,t)}function Ege(t){const{kernelName:e}=t;D2.has(e)&&oe().getBool("DEBUG")&&pi(`Overriding the gradient for '${e}'`),D2.set(e,t)}function F6(t,e){return`${e}_${t}`}var L6=un,Yi=null;try{Yi=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function un(t,e,n){this.low=t|0,this.high=e|0,this.unsigned=!!n}un.prototype.__isLong__;Object.defineProperty(un.prototype,"__isLong__",{value:!0});function si(t){return(t&&t.__isLong__)===!0}un.isLong=si;var A3={},R3={};function Fd(t,e){var n,s,r;return e?(t>>>=0,(r=0<=t&&t<256)&&(s=R3[t],s)?s:(n=dn(t,(t|0)<0?-1:0,!0),r&&(R3[t]=n),n)):(t|=0,(r=-128<=t&&t<128)&&(s=A3[t],s)?s:(n=dn(t,t<0?-1:0,!1),r&&(A3[t]=n),n))}un.fromInt=Fd;function Zi(t,e){if(isNaN(t))return e?Lu:Qi;if(e){if(t<0)return Lu;if(t>=M6)return j6}else{if(t<=-O3)return Gr;if(t+1>=O3)return V6}return t<0?Zi(-t,e).neg():dn(t%Af|0,t/Af|0,e)}un.fromNumber=Zi;function dn(t,e,n){return new un(t,e,n)}un.fromBits=dn;var Zb=Math.pow;function bA(t,e,n){if(t.length===0)throw Error("empty string");if(t==="NaN"||t==="Infinity"||t==="+Infinity"||t==="-Infinity")return Qi;if(typeof e=="number"?(n=e,e=!1):e=!!e,n=n||10,n<2||36<n)throw RangeError("radix");var s;if((s=t.indexOf("-"))>0)throw Error("interior hyphen");if(s===0)return bA(t.substring(1),e,n).neg();for(var r=Zi(Zb(n,8)),i=Qi,o=0;o<t.length;o+=8){var a=Math.min(8,t.length-o),l=parseInt(t.substring(o,o+a),n);if(a<8){var c=Zi(Zb(n,a));i=i.mul(c).add(Zi(l))}else i=i.mul(r),i=i.add(Zi(l))}return i.unsigned=e,i}un.fromString=bA;function Wo(t,e){return typeof t=="number"?Zi(t,e):typeof t=="string"?bA(t,e):dn(t.low,t.high,typeof e=="boolean"?e:t.unsigned)}un.fromValue=Wo;var D3=65536,$ge=1<<24,Af=D3*D3,M6=Af*Af,O3=M6/2,P3=Fd($ge),Qi=Fd(0);un.ZERO=Qi;var Lu=Fd(0,!0);un.UZERO=Lu;var Ah=Fd(1);un.ONE=Ah;var z6=Fd(1,!0);un.UONE=z6;var P2=Fd(-1);un.NEG_ONE=P2;var V6=dn(-1,2147483647,!1);un.MAX_VALUE=V6;var j6=dn(-1,-1,!0);un.MAX_UNSIGNED_VALUE=j6;var Gr=dn(0,-2147483648,!1);un.MIN_VALUE=Gr;var Ie=un.prototype;Ie.toInt=function(){return this.unsigned?this.low>>>0:this.low};Ie.toNumber=function(){return this.unsigned?(this.high>>>0)*Af+(this.low>>>0):this.high*Af+(this.low>>>0)};Ie.toString=function(e){if(e=e||10,e<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(Gr)){var n=Zi(e),s=this.div(n),r=s.mul(n).sub(this);return s.toString(e)+r.toInt().toString(e)}else return"-"+this.neg().toString(e);for(var i=Zi(Zb(e,6),this.unsigned),o=this,a="";;){var l=o.div(i),c=o.sub(l.mul(i)).toInt()>>>0,u=c.toString(e);if(o=l,o.isZero())return u+a;for(;u.length<6;)u="0"+u;a=""+u+a}};Ie.getHighBits=function(){return this.high};Ie.getHighBitsUnsigned=function(){return this.high>>>0};Ie.getLowBits=function(){return this.low};Ie.getLowBitsUnsigned=function(){return this.low>>>0};Ie.getNumBitsAbs=function(){if(this.isNegative())return this.eq(Gr)?64:this.neg().getNumBitsAbs();for(var e=this.high!=0?this.high:this.low,n=31;n>0&&!(e&1<<n);n--);return this.high!=0?n+33:n+1};Ie.isZero=function(){return this.high===0&&this.low===0};Ie.eqz=Ie.isZero;Ie.isNegative=function(){return!this.unsigned&&this.high<0};Ie.isPositive=function(){return this.unsigned||this.high>=0};Ie.isOdd=function(){return(this.low&1)===1};Ie.isEven=function(){return(this.low&1)===0};Ie.equals=function(e){return si(e)||(e=Wo(e)),this.unsigned!==e.unsigned&&this.high>>>31===1&&e.high>>>31===1?!1:this.high===e.high&&this.low===e.low};Ie.eq=Ie.equals;Ie.notEquals=function(e){return!this.eq(e)};Ie.neq=Ie.notEquals;Ie.ne=Ie.notEquals;Ie.lessThan=function(e){return this.comp(e)<0};Ie.lt=Ie.lessThan;Ie.lessThanOrEqual=function(e){return this.comp(e)<=0};Ie.lte=Ie.lessThanOrEqual;Ie.le=Ie.lessThanOrEqual;Ie.greaterThan=function(e){return this.comp(e)>0};Ie.gt=Ie.greaterThan;Ie.greaterThanOrEqual=function(e){return this.comp(e)>=0};Ie.gte=Ie.greaterThanOrEqual;Ie.ge=Ie.greaterThanOrEqual;Ie.compare=function(e){if(si(e)||(e=Wo(e)),this.eq(e))return 0;var n=this.isNegative(),s=e.isNegative();return n&&!s?-1:!n&&s?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1};Ie.comp=Ie.compare;Ie.negate=function(){return!this.unsigned&&this.eq(Gr)?Gr:this.not().add(Ah)};Ie.neg=Ie.negate;Ie.add=function(e){si(e)||(e=Wo(e));var n=this.high>>>16,s=this.high&65535,r=this.low>>>16,i=this.low&65535,o=e.high>>>16,a=e.high&65535,l=e.low>>>16,c=e.low&65535,u=0,d=0,h=0,f=0;return f+=i+c,h+=f>>>16,f&=65535,h+=r+l,d+=h>>>16,h&=65535,d+=s+a,u+=d>>>16,d&=65535,u+=n+o,u&=65535,dn(h<<16|f,u<<16|d,this.unsigned)};Ie.subtract=function(e){return si(e)||(e=Wo(e)),this.add(e.neg())};Ie.sub=Ie.subtract;Ie.multiply=function(e){if(this.isZero())return Qi;if(si(e)||(e=Wo(e)),Yi){var n=Yi.mul(this.low,this.high,e.low,e.high);return dn(n,Yi.get_high(),this.unsigned)}if(e.isZero())return Qi;if(this.eq(Gr))return e.isOdd()?Gr:Qi;if(e.eq(Gr))return this.isOdd()?Gr:Qi;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(P3)&&e.lt(P3))return Zi(this.toNumber()*e.toNumber(),this.unsigned);var s=this.high>>>16,r=this.high&65535,i=this.low>>>16,o=this.low&65535,a=e.high>>>16,l=e.high&65535,c=e.low>>>16,u=e.low&65535,d=0,h=0,f=0,p=0;return p+=o*u,f+=p>>>16,p&=65535,f+=i*u,h+=f>>>16,f&=65535,f+=o*c,h+=f>>>16,f&=65535,h+=r*u,d+=h>>>16,h&=65535,h+=i*c,d+=h>>>16,h&=65535,h+=o*l,d+=h>>>16,h&=65535,d+=s*u+r*c+i*l+o*a,d&=65535,dn(f<<16|p,d<<16|h,this.unsigned)};Ie.mul=Ie.multiply;Ie.divide=function(e){if(si(e)||(e=Wo(e)),e.isZero())throw Error("division by zero");if(Yi){if(!this.unsigned&&this.high===-2147483648&&e.low===-1&&e.high===-1)return this;var n=(this.unsigned?Yi.div_u:Yi.div_s)(this.low,this.high,e.low,e.high);return dn(n,Yi.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?Lu:Qi;var s,r,i;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return Lu;if(e.gt(this.shru(1)))return z6;i=Lu}else{if(this.eq(Gr)){if(e.eq(Ah)||e.eq(P2))return Gr;if(e.eq(Gr))return Ah;var o=this.shr(1);return s=o.div(e).shl(1),s.eq(Qi)?e.isNegative()?Ah:P2:(r=this.sub(e.mul(s)),i=s.add(r.div(e)),i)}else if(e.eq(Gr))return this.unsigned?Lu:Qi;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();i=Qi}for(r=this;r.gte(e);){s=Math.max(1,Math.floor(r.toNumber()/e.toNumber()));for(var a=Math.ceil(Math.log(s)/Math.LN2),l=a<=48?1:Zb(2,a-48),c=Zi(s),u=c.mul(e);u.isNegative()||u.gt(r);)s-=l,c=Zi(s,this.unsigned),u=c.mul(e);c.isZero()&&(c=Ah),i=i.add(c),r=r.sub(u)}return i};Ie.div=Ie.divide;Ie.modulo=function(e){if(si(e)||(e=Wo(e)),Yi){var n=(this.unsigned?Yi.rem_u:Yi.rem_s)(this.low,this.high,e.low,e.high);return dn(n,Yi.get_high(),this.unsigned)}return this.sub(this.div(e).mul(e))};Ie.mod=Ie.modulo;Ie.rem=Ie.modulo;Ie.not=function(){return dn(~this.low,~this.high,this.unsigned)};Ie.and=function(e){return si(e)||(e=Wo(e)),dn(this.low&e.low,this.high&e.high,this.unsigned)};Ie.or=function(e){return si(e)||(e=Wo(e)),dn(this.low|e.low,this.high|e.high,this.unsigned)};Ie.xor=function(e){return si(e)||(e=Wo(e)),dn(this.low^e.low,this.high^e.high,this.unsigned)};Ie.shiftLeft=function(e){return si(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?dn(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):dn(0,this.low<<e-32,this.unsigned)};Ie.shl=Ie.shiftLeft;Ie.shiftRight=function(e){return si(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?dn(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):dn(this.high>>e-32,this.high>=0?0:-1,this.unsigned)};Ie.shr=Ie.shiftRight;Ie.shiftRightUnsigned=function(e){if(si(e)&&(e=e.toInt()),e&=63,e===0)return this;var n=this.high;if(e<32){var s=this.low;return dn(s>>>e|n<<32-e,n>>>e,this.unsigned)}else return e===32?dn(n,0,this.unsigned):dn(n>>>e-32,0,this.unsigned)};Ie.shru=Ie.shiftRightUnsigned;Ie.shr_u=Ie.shiftRightUnsigned;Ie.toSigned=function(){return this.unsigned?dn(this.low,this.high,!1):this};Ie.toUnsigned=function(){return this.unsigned?this:dn(this.low,this.high,!0)};Ie.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()};Ie.toBytesLE=function(){var e=this.high,n=this.low;return[n&255,n>>>8&255,n>>>16&255,n>>>24,e&255,e>>>8&255,e>>>16&255,e>>>24]};Ie.toBytesBE=function(){var e=this.high,n=this.low;return[e>>>24,e>>>16&255,e>>>8&255,e&255,n>>>24,n>>>16&255,n>>>8&255,n&255]};un.fromBytes=function(e,n,s){return s?un.fromBytesLE(e,n):un.fromBytesBE(e,n)};un.fromBytesLE=function(e,n){return new un(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,n)};un.fromBytesBE=function(e,n){return new un(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],n)};const B6=Iw(L6),Age=KV({__proto__:null,default:B6},[L6]);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _u=B6||Age;function CS(t){return _u.fromString(t,!0,16)}const W6=CS("c3a5c85c97cb3127"),Iu=CS("b492b66fbe98f273"),sr=CS("9ae16a3b2f90404f");function F2(t){return t.xor(t.shru(47))}function U6(t,e,n){const s=t.slice(e,e+n);return _u.fromBytes(Array.from(s),!0,!0)}function en(t,e){return U6(t,e,8)}function F3(t,e){return U6(t,e,4)}function vs(t,e){return e===0?t:t.shru(e).or(t.shl(64-e))}function Sc(t,e,n=CS("9ddfea08eb382d69")){let s=t.xor(e).mul(n);s=s.xor(s.shru(47));let r=e.xor(s).mul(n);return r=r.xor(r.shru(47)),r=r.mul(n),r}function Rge(t,e,n,s,r,i){r=r.add(t),i=vs(i.add(r).add(s),21);const o=r;return r=r.add(e),r=r.add(n),i=i.add(vs(r,44)),[r.add(s),i.add(o)]}function Bx(t,e,n,s){return Rge(en(t,e),en(t,e+8),en(t,e+16),en(t,e+24),n,s)}function Dge(t,e=t.length){if(e>=8){const n=sr.add(e*2),s=en(t,0).add(sr),r=en(t,e-8),i=vs(r,37).mul(n).add(s),o=vs(s,25).add(r).mul(n);return Sc(i,o,n)}if(e>=4){const n=sr.add(e*2),s=F3(t,0);return Sc(s.shl(3).add(e),F3(t,e-4),n)}if(e>0){const n=t[0],s=t[e>>1],r=t[e-1],i=n+(s<<8),o=e+(r<<2);return F2(sr.mul(i).xor(W6.mul(o))).mul(sr)}return sr}function Oge(t,e=t.length){const n=sr.add(e*2),s=en(t,0).mul(Iu),r=en(t,8),i=en(t,e-8).mul(n),o=en(t,e-16).mul(sr);return Sc(vs(s.add(r),43).add(vs(i,30)).add(o),s.add(vs(r.add(sr),18)).add(i),n)}function Pge(t,e=t.length){const n=sr.add(e*2),s=en(t,0).mul(sr),r=en(t,8),i=en(t,e-8).mul(n),o=en(t,e-16).mul(sr),a=vs(s.add(r),43).add(vs(i,30)).add(o),l=Sc(a,s.add(vs(r.add(sr),18)).add(i),n),c=en(t,16).mul(n),u=en(t,24),d=a.add(en(t,e-32)).mul(n),h=l.add(en(t,e-24)).mul(n);return Sc(vs(c.add(u),43).add(vs(d,30)).add(h),c.add(vs(u.add(s),18)).add(d),n)}function Fge(t,e=t.length){const n=_u.fromNumber(81,!0);if(e<=32)return e<=16?Dge(t,e):Oge(t,e);if(e<=64)return Pge(t,e);let s=n,r=n.mul(Iu).add(113),i=F2(r.mul(sr).add(113)).mul(sr),o=[_u.UZERO,_u.UZERO],a=[_u.UZERO,_u.UZERO];s=s.mul(sr).add(en(t,0));let l=0;const c=(e-1>>6)*64,u=c+(e-1&63)-63;do s=vs(s.add(r).add(o[0]).add(en(t,l+8)),37).mul(Iu),r=vs(r.add(o[1]).add(en(t,l+48)),42).mul(Iu),s=s.xor(a[1]),r=r.add(o[0]).add(en(t,l+40)),i=vs(i.add(a[0]),33).mul(Iu),o=Bx(t,l,o[1].mul(Iu),s.add(a[0])),a=Bx(t,l+32,i.add(a[1]),r.add(en(t,l+16))),[i,s]=[s,i],l+=64;while(l!==c);const d=Iu.add(i.and(255).shl(1));return l=u,a[0]=a[0].add(e-1&63),o[0]=o[0].add(a[0]),a[0]=a[0].add(o[0]),s=vs(s.add(r).add(o[0]).add(en(t,l+8)),37).mul(d),r=vs(r.add(o[1]).add(en(t,l+48)),42).mul(d),s=s.xor(a[1].mul(9)),r=r.add(o[0].mul(9).add(en(t,l+40))),i=vs(i.add(a[0]),33).mul(d),o=Bx(t,l,o[1].mul(d),s.add(a[0])),a=Bx(t,l+32,i.add(a[1]),r.add(en(t,l+16))),[i,s]=[s,i],Sc(Sc(o[0],a[0],d).add(F2(r).mul(W6)).add(i),Sc(o[1],a[1],d).add(s),d)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tu(t,e){return e==="string"?kc(t):Ld([t],e)}function Lge(t,e){return t instanceof Float32Array&&e==="float32"||t instanceof Int32Array&&e==="int32"||t instanceof Uint8Array&&e==="bool"}function Ld(t,e){if(e==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(t)&&(t=_f(t)),oe().getBool("DEBUG")&&gge(t,e),Lge(t,e))return t;if(e==null||e==="float32"||e==="complex64")return new Float32Array(t);if(e==="int32")return new Int32Array(t);if(e==="bool"){const n=new Uint8Array(t.length);for(let s=0;s<n.length;++s)Math.round(t[s])!==0&&(n[s]=1);return n}else throw new Error(`Unknown data type ${e}`)}function vr(){return oe().platform.now()}function kc(t,e="utf-8"){return e=e||"utf-8",oe().platform.encode(t,e)}function Mc(t,e="utf-8"){return e=e||"utf-8",oe().platform.decode(t,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Mge{constructor(e,n){this.backendTimer=e,this.logger=n,n==null&&(this.logger=new Vge)}profileKernel(e,n,s){let r;const i=()=>{r=s()};let o;const a=vr();if(this.backendTimer.timerAvailable())o=this.backendTimer.time(i);else{i();for(const c of r)c.dataSync();o=Promise.resolve({kernelMs:vr()-a})}if(oe().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let c=0;c<r.length;c++){const u=r[c];u.data().then(d=>{zge(d,u.dtype,e)})}return{kernelName:e,outputs:r,inputs:n,timeMs:o.then(c=>c.kernelMs),extraInfo:o.then(c=>c.getExtraProfileInfo!=null?c.getExtraProfileInfo():"")}}logKernelProfile(e){const{kernelName:n,outputs:s,timeMs:r,inputs:i,extraInfo:o}=e;s.forEach(a=>{Promise.all([a.data(),r,o]).then(l=>{this.logger.logKernelProfile(n,a,l[0],l[1],i,l[2])})})}}function zge(t,e,n){if(e!=="float32")return!1;for(let s=0;s<t.length;s++){const r=t[s];if(isNaN(r)||!isFinite(r))return console.warn(`Found ${r} in the result of '${n}'`),!0}return!1}class Vge{logKernelProfile(e,n,s,r,i,o){const a=typeof r=="number"?Wh(`${r}ms`,9):r.error,l=Wh(e,25),c=n.rank,u=n.size,d=Wh(n.shape.toString(),14);let h="";for(const f in i){const p=i[f];if(p!=null){const m=p.shape||n.shape,g=m.length;h+=`${f}: ${g}D ${g>0?m:""} `}}console.log(`%c${l}	%c${a}	%c${c}D ${d}	%c${u}	%c${h}	%c${o}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jge(t,e,n){const s={},r={};for(let l=0;l<e.length;l++)s[e[l].id]=!0;for(let l=0;l<t.length;l++){const c=t[l],u=c.inputs;for(const d in u){const h=u[d];let f=!1;for(let p=0;p<e.length;p++)if(s[h.id]){c.outputs.forEach(m=>s[m.id]=!0),f=!0,r[c.id]=!0;break}if(f)break}}const i={};i[n.id]=!0;const o={};for(let l=t.length-1;l>=0;l--){const c=t[l],u=c.inputs;for(let d=0;d<c.outputs.length;d++)if(i[c.outputs[d].id]){for(const h in u)i[u[h].id]=!0,o[c.id]=!0;break}}const a=[];for(let l=0;l<t.length;l++){const c=t[l];if(r[c.id]&&o[c.id]){const u={};for(const h in c.inputs){const f=c.inputs[h];s[f.id]&&(u[h]=f)}const d=Object.assign({},c);d.inputs=u,d.outputs=c.outputs,a.push(d)}}return a}function Bge(t,e,n,s){for(let r=e.length-1;r>=0;r--){const i=e[r],o=[];if(i.outputs.forEach(l=>{const c=t[l.id];c!=null?o.push(c):o.push(null)}),i.gradient==null)throw new Error(`Cannot compute gradient: gradient function not found for ${i.kernelName}.`);const a=i.gradient(o);for(const l in i.inputs){if(!(l in a))throw new Error(`Cannot backprop through input ${l}. Available gradients found: ${Object.keys(a)}.`);const c=n(()=>a[l]());if(c.dtype!=="float32")throw new Error(`Error in gradient for op ${i.kernelName}. The gradient of input ${l} must have 'float32' dtype, but has '${c.dtype}'`);const u=i.inputs[l];if(!Et(c.shape,u.shape))throw new Error(`Error in gradient for op ${i.kernelName}. The gradient of input '${l}' has shape '${c.shape}', which does not match the shape of the input '${u.shape}'`);if(t[u.id]==null)t[u.id]=c;else{const d=t[u.id];t[u.id]=s(d,c),d.dispose()}}}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const L3=20,Xp=3,WC=7;function Wge(t,e,n,s){const r=Ye(e),i=Uge(t,e,n,r),o=e.length,a=Pv(t,e,n,r,i),l=["Tensor"];return s&&(l.push(`  dtype: ${n}`),l.push(`  rank: ${o}`),l.push(`  shape: [${e}]`),l.push("  values:")),l.push(a.map(c=>"    "+c).join(`
`)),l.join(`
`)}function Uge(t,e,n,s){const r=le(e),i=s[s.length-1],o=new Array(i).fill(0),a=e.length,l=n==="complex64"?ym(t):t;if(a>1)for(let c=0;c<r/i;c++){const u=c*i;for(let d=0;d<i;d++)o[d]=Math.max(o[d],gm(l[u+d],0,n).length)}return o}function gm(t,e,n){let s;return Array.isArray(t)?s=`${parseFloat(t[0].toFixed(WC))} + ${parseFloat(t[1].toFixed(WC))}j`:xy(t)?s=`'${t}'`:n==="bool"?s=H6(t):s=parseFloat(t.toFixed(WC)).toString(),Wh(s,e)}function H6(t){return t===0?"false":"true"}function Pv(t,e,n,s,r,i=!0){const o=n==="complex64"?2:1,a=e[0],l=e.length;if(l===0){if(n==="complex64"){const m=ym(t);return[gm(m[0],0,n)]}return n==="bool"?[H6(t[0])]:[t[0].toString()]}if(l===1){if(a>L3){const g=Xp*o;let y=Array.from(t.slice(0,g)),x=Array.from(t.slice((a-Xp)*o,a*o));return n==="complex64"&&(y=ym(y),x=ym(x)),["["+y.map((v,b)=>gm(v,r[b],n)).join(", ")+", ..., "+x.map((v,b)=>gm(v,r[a-Xp+b],n)).join(", ")+"]"]}return["["+(n==="complex64"?ym(t):Array.from(t)).map((g,y)=>gm(g,r[y],n)).join(", ")+"]"]}const c=e.slice(1),u=s.slice(1),d=s[0]*o,h=[];if(a>L3){for(let m=0;m<Xp;m++){const g=m*d,y=g+d;h.push(...Pv(t.slice(g,y),c,n,u,r,!1))}h.push("...");for(let m=a-Xp;m<a;m++){const g=m*d,y=g+d;h.push(...Pv(t.slice(g,y),c,n,u,r,m===a-1))}}else for(let m=0;m<a;m++){const g=m*d,y=g+d;h.push(...Pv(t.slice(g,y),c,n,u,r,m===a-1))}const f=l===2?",":"";h[0]="["+h[0]+f;for(let m=1;m<h.length-1;m++)h[m]=" "+h[m]+f;let p=`,
`;for(let m=2;m<l;m++)p+=`
`;return h[h.length-1]=" "+h[h.length-1]+"]"+(i?"":p),h}function ym(t){const e=[];for(let n=0;n<t.length;n+=2)e.push([t[n],t[n+1]]);return e}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ks{constructor(e,n,s){if(this.dtype=n,this.shape=e.slice(),this.size=le(e),s!=null){const r=s.length;O(r===this.size,()=>`Length of values '${r}' does not match the size inferred by the shape '${this.size}'.`)}if(n==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=s||ws(n,this.size),this.strides=Ye(e)}set(e,...n){n.length===0&&(n=[0]),O(n.length===this.rank,()=>`The number of provided coordinates (${n.length}) must match the rank (${this.rank})`);const s=this.locToIndex(n);this.values[s]=e}get(...e){e.length===0&&(e=[0]);let n=0;for(const r of e){if(r<0||r>=this.shape[n]){const i=`Requested out of range element at ${e}.   Buffer shape=${this.shape}`;throw new Error(i)}n++}let s=e[e.length-1];for(let r=0;r<e.length-1;++r)s+=this.strides[r]*e[r];return this.values[s]}locToIndex(e){if(this.rank===0)return 0;if(this.rank===1)return e[0];let n=e[e.length-1];for(let s=0;s<e.length-1;++s)n+=this.strides[s]*e[s];return n}indexToLoc(e){if(this.rank===0)return[];if(this.rank===1)return[e];const n=new Array(this.shape.length);for(let s=0;s<n.length-1;++s)n[s]=Math.floor(e/this.strides[s]),e-=n[s]*this.strides[s];return n[n.length-1]=e,n}get rank(){return this.shape.length}toTensor(){return To().makeTensor(this.values,this.shape,this.dtype)}}let To=null,ch=null;function Hge(t){To=t}function Gge(t){ch=t}class Yt{constructor(e,n,s,r){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=n||"float32",this.size=le(e),this.strides=Ye(e),this.dataId=s,this.id=r,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const e=await this.data();return ch.buffer(this.shape,this.dtype,e)}bufferSync(){return ch.buffer(this.shape,this.dtype,this.dataSync())}async array(){const e=await this.data();return so(this.shape,e,this.dtype==="complex64")}arraySync(){return so(this.shape,this.dataSync(),this.dtype==="complex64")}async data(){this.throwIfDisposed();const e=To().read(this.dataId);if(this.dtype==="string"){const n=await e;try{return n.map(s=>Mc(s))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return e}dataToGPU(e){return this.throwIfDisposed(),To().readToGPU(this.dataId,e)}dataSync(){this.throwIfDisposed();const e=To().readSync(this.dataId);if(this.dtype==="string")try{return e.map(n=>Mc(n))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}async bytes(){this.throwIfDisposed();const e=await To().read(this.dataId);return this.dtype==="string"?e:new Uint8Array(e.buffer)}dispose(){this.isDisposed||(To().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(e=!1){return ch.print(this,e)}clone(){return this.throwIfDisposed(),ch.clone(this)}toString(e=!1){const n=this.dataSync();return Wge(n,this.shape,this.dtype,e)}cast(e){return this.throwIfDisposed(),ch.cast(this,e)}variable(e=!0,n,s){return this.throwIfDisposed(),To().makeVariable(this,e,n,s)}}Object.defineProperty(Yt,Symbol.hasInstance,{value:t=>!!t&&t.data!=null&&t.dataSync!=null&&t.throwIfDisposed!=null});function ue(){return y$("Tensor",()=>Yt)}ue();class Qb extends Yt{constructor(e,n,s,r){super(e.shape,e.dtype,e.dataId,r),this.trainable=n,this.name=s}assign(e){if(e.dtype!==this.dtype)throw new Error(`dtype of the new value (${e.dtype}) and previous value (${this.dtype}) must match`);if(!Et(e.shape,this.shape))throw new Error(`shape of the new value (${e.shape}) and previous value (${this.shape}) must match`);To().disposeTensor(this),this.dataId=e.dataId,To().incRef(this,null)}dispose(){To().disposeVariable(this),this.isDisposedInternal=!0}}Object.defineProperty(Qb,Symbol.hasInstance,{value:t=>t instanceof Yt&&t.assign!=null&&t.assign instanceof Function});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var M3;(function(t){t.R0="R0",t.R1="R1",t.R2="R2",t.R3="R3",t.R4="R4",t.R5="R5",t.R6="R6"})(M3||(M3={}));var L2;(function(t){t.float32="float32",t.int32="int32",t.bool="int32",t.complex64="complex64"})(L2||(L2={}));var M2;(function(t){t.float32="float32",t.int32="int32",t.bool="bool",t.complex64="complex64"})(M2||(M2={}));var z2;(function(t){t.float32="float32",t.int32="float32",t.bool="float32",t.complex64="complex64"})(z2||(z2={}));var V2;(function(t){t.float32="complex64",t.int32="complex64",t.bool="complex64",t.complex64="complex64"})(V2||(V2={}));const Kge={float32:z2,int32:L2,bool:M2,complex64:V2};function Zr(t,e){if(t==="string"||e==="string"){if(t==="string"&&e==="string")return"string";throw new Error(`Can not upcast ${t} with ${e}`)}return Kge[t][e]}function wA(t){return Zr(t,"int32")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mn(t,e){if(t.dtype===e.dtype)return[t,e];const n=Zr(t.dtype,e.dtype);return[t.cast(n),e.cast(n)]}function qge(t,e){O(t.dtype===e.dtype,()=>`The dtypes of the first(${t.dtype}) and second(${e.dtype}) input must match`)}function G6(t){const e=[];return K6(t,e,new Set),e}function K6(t,e,n){if(t==null)return;if(t instanceof Yt){e.push(t);return}if(!Xge(t))return;const s=t;for(const r in s){const i=s[r];n.has(i)||(n.add(i),K6(i,e,n))}}function Xge(t){return Array.isArray(t)||typeof t=="object"}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UC(t){return t.kernelName!=null}class z3{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(e=>e.name)))}}}dispose(){for(const e in this.registeredVariables)this.registeredVariables[e].dispose()}}class Rf{constructor(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new z3}async ready(){if(this.pendingBackendInit!=null)return this.pendingBackendInit.then(()=>{});if(this.backendInstance!=null)return;const e=this.getSortedBackends();for(let n=0;n<e.length;n++){const s=e[n];if(await this.initializeBackend(s).success){await this.setBackend(s);return}}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(this.pendingBackendInit!=null)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(this.backendInstance==null){const{name:e,asyncInit:n}=this.initializeBackendsAndReturnBest();if(n)throw new Error(`The highest priority backend '${e}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(e)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(e){if(!(e in this.registry))if(e in this.registryFactory){const{asyncInit:n}=this.initializeBackend(e);if(n)return null}else return null;return this.registry[e]}findBackendFactory(e){return e in this.registryFactory?this.registryFactory[e].factory:null}registerBackend(e,n,s=1){return e in this.registryFactory?(pi(`${e} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[e]={factory:n,priority:s},!0)}async setBackend(e){if(this.registryFactory[e]==null)throw new Error(`Backend name '${e}' not found in registry`);if(this.backendName=e,this.registry[e]==null){this.backendInstance=null;const{success:n,asyncInit:s}=this.initializeBackend(e);if(!(s?await n:n))return!1}return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new Mge(this.backendInstance),!0}setupRegisteredKernels(){$3(this.backendName).forEach(n=>{n.setupFunc!=null&&n.setupFunc(this.backendInstance)})}disposeRegisteredKernels(e){$3(e).forEach(s=>{s.disposeFunc!=null&&s.disposeFunc(this.registry[e])})}initializeBackend(e){const n=this.registryFactory[e];if(n==null)throw new Error(`Cannot initialize backend ${e}, no registration found.`);try{const s=n.factory();if(s&&!(s instanceof p$)&&typeof s.then=="function"){const r=++this.pendingBackendInitId,i=s.then(o=>r<this.pendingBackendInitId?!1:(this.registry[e]=o,this.pendingBackendInit=null,!0)).catch(o=>(r<this.pendingBackendInitId||(this.pendingBackendInit=null,pi(`Initialization of backend ${e} failed`),pi(o.stack||o.message)),!1));return this.pendingBackendInit=i,{success:i,asyncInit:!0}}else return this.registry[e]=s,{success:!0,asyncInit:!1}}catch(s){return pi(`Initialization of backend ${e} failed`),pi(s.stack||s.message),{success:!1,asyncInit:!1}}}removeBackend(e){if(!(e in this.registryFactory))throw new Error(`${e} backend not found in registry`);this.backendName===e&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((e,n)=>this.registryFactory[n].priority-this.registryFactory[e].priority)}initializeBackendsAndReturnBest(){const e=this.getSortedBackends();for(let n=0;n<e.length;n++){const s=e[n],{success:r,asyncInit:i}=this.initializeBackend(s);if(i||r)return{name:s,asyncInit:i}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(e,n){const s=this.state.tensorInfo.get(n),r=s.backend,i=this.readSync(n),o=r.refCount(n);r.disposeData(n,!0),s.backend=e,e.move(n,i,s.shape,s.dtype,o),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(e,n){let s=null;if(n==null){if(typeof e!="function")throw new Error("Please provide a function to tidy()");n=e}else{if(typeof e!="string"&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof n!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");s=e}let r;return this.scopedRun(()=>this.startScope(s),()=>this.endScope(r),()=>(r=n(),r instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),r))}scopedRun(e,n,s){e();try{const r=s();return n(),r}catch(r){throw n(),r}}nextTensorId(){return Rf.nextTensorId++}nextVariableId(){return Rf.nextVariableId++}clone(e){const n=Z.runKernel(Vy,{x:e}),s={x:e},r=o=>({x:()=>{const a="float32",l={x:o},c={dtype:a};return Z.runKernel(Iy,l,c)}}),i=[];return this.addTapeNode(this.state.activeScope.name,s,[n],r,i,{}),n}runKernel(e,n,s){if(this.backendName==null&&this.backend,!(O2(e,this.backendName)!=null))throw new Error(`Kernel '${e}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:e,inputs:n,attrs:s})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(e,n,s){const r=this.backend.numDataIds();let i=0;s.forEach(l=>{i+=l.dtype==="complex64"?3:1});const o=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],a=r-n-i-o;if(a>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${a} data ids) after running '${e}'`)}runKernelFunc(e){let n,s=[];const r=this.isTapeOn(),i=this.state.numBytes,o=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);let a;this.backendName==null&&this.backend;let l;const c=UC(e)?e.kernelName:this.state.activeScope!=null?this.state.activeScope.name:"";if(UC(e)){const{kernelName:p,inputs:m,attrs:g}=e;this.backendName==null&&this.backend;const y=O2(p,this.backendName);O(y!=null,()=>`Cannot find registered kernel '${p}' for backend '${this.backendName}'`),a=()=>{const x=this.backend.numDataIds();l=y.kernelFunc({inputs:m,attrs:g,backend:this.backend});const v=Array.isArray(l)?l:[l];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(p,x,v);const b=v.map(k=>k.rank!=null?k:this.makeTensorFromTensorInfo(k));if(r){const k=this.getTensorsForGradient(p,m,b);s=this.saveTensorsForBackwardMode(k)}return b}}else{const{forwardFunc:p}=e,m=g=>{r&&(s=g.map(y=>this.keep(this.clone(y))))};a=()=>{const g=this.backend.numDataIds();l=this.tidy(()=>p(this.backend,m));const y=Array.isArray(l)?l:[l];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(c,g,y),y}}const{inputs:u,attrs:d}=e,h=UC(e)?null:e.backwardsFunc;let f;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{!this.ENV.getBool("DEBUG")&&!this.state.profiling?n=a():(f=this.profiler.profileKernel(c,u,()=>a()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(f),n=f.outputs)}),r&&this.addTapeNode(c,u,n,h,s,d),this.state.profiling&&this.state.activeProfile.kernels.push({name:c,bytesAdded:this.state.numBytes-i,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-o,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(u).map(p=>u[p]!=null?u[p].shape:null),outputShapes:n.map(p=>p.shape),kernelTimeMs:f.timeMs,extraInfo:f.extraInfo}),Array.isArray(l)?n:n[0]}saveTensorsForBackwardMode(e){return e.map(s=>this.keep(this.clone(s)))}getTensorsForGradient(e,n,s){const r=E3(e);if(r!=null){const i=r.inputsToSave||[],o=r.outputsToSave||[];let a;r.saveAllInputs?(O(Array.isArray(n),()=>"saveAllInputs is true, expected inputs to be an array."),a=Object.keys(n).map(c=>n[c])):a=i.map(c=>n[c]);const l=s.filter((c,u)=>o[u]);return a.concat(l)}return[]}makeTensor(e,n,s,r){if(e==null)throw new Error("Values passed to engine.makeTensor() are null");s=s||"float32",r=r||this.backend;let i=e;s==="string"&&xy(e[0])&&(i=e.map(l=>kc(l)));const o=r.write(i,n,s),a=new Yt(n,s,o,this.nextTensorId());if(this.trackTensor(a,r),s==="string"){const l=this.state.tensorInfo.get(o),c=xge(i);this.state.numBytes+=c-l.bytes,l.bytes=c}return a}makeTensorFromDataId(e,n,s,r){s=s||"float32";const i={dataId:e,shape:n,dtype:s};return this.makeTensorFromTensorInfo(i,r)}makeTensorFromTensorInfo(e,n){const{dataId:s,shape:r,dtype:i}=e,o=new Yt(r,i,s,this.nextTensorId());return this.trackTensor(o,n),o}makeVariable(e,n=!0,s,r){s=s||this.nextVariableId().toString(),r!=null&&r!==e.dtype&&(e=e.cast(r));const i=new Qb(e,n,s,this.nextTensorId());if(this.state.registeredVariables[i.name]!=null)throw new Error(`Variable with name ${i.name} was already registered`);return this.state.registeredVariables[i.name]=i,this.incRef(i,this.backend),i}trackTensor(e,n){this.state.numTensors++,e.dtype==="string"&&this.state.numStringTensors++;let s=0;e.dtype!=="complex64"&&e.dtype!=="string"&&(s=e.size*N2(e.dtype)),this.state.numBytes+=s,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:n||this.backend,dtype:e.dtype,shape:e.shape,bytes:s})),e instanceof Qb||this.track(e)}incRef(e,n){this.trackTensor(e,n),this.backend.incRef(e.dataId)}removeDataId(e,n){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===n&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)}disposeTensor(e){if(!this.state.tensorInfo.has(e.dataId))return;const n=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,e.dtype==="string"&&(this.state.numStringTensors--,this.state.numBytes-=n.bytes),e.dtype!=="complex64"&&e.dtype!=="string"){const s=e.size*N2(e.dtype);this.state.numBytes-=s}n.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,n.backend)}disposeVariables(){for(const e in this.state.registeredVariables){const n=this.state.registeredVariables[e];this.disposeVariable(n)}}disposeVariable(e){this.disposeTensor(e),this.state.registeredVariables[e.name]!=null&&delete this.state.registeredVariables[e.name]}memory(){const e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,e.reasons==null&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}async profile(e){this.state.profiling=!0;const n=this.state.numBytes,s=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(r=>r.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-n,this.state.activeProfile.newTensors=this.state.numTensors-s;for(const r of this.state.activeProfile.kernels)r.kernelTimeMs=await r.kernelTimeMs,r.extraInfo=await r.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&this.state.kernelDepth===0}addTapeNode(e,n,s,r,i,o){const a={id:this.state.nextTapeNodeId++,kernelName:e,inputs:n,outputs:s,saved:i},l=E3(e);l!=null&&(r=l.gradFunc),r!=null&&(a.gradient=c=>(c=c.map((u,d)=>{if(u==null){const h=s[d],f=Xs(h.size,h.dtype);return this.makeTensor(f,h.shape,h.dtype)}return u}),r(c.length>1?c:c[0],i,o))),this.state.activeTape.push(a)}keep(e){return e.kept=!0,e}startTape(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(e){const n={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(n.name=e),this.state.scopeStack.push(n),this.state.activeScope=n}endScope(e){const n=G6(e),s=new Set(n.map(i=>i.id));for(let i=0;i<this.state.activeScope.track.length;i++){const o=this.state.activeScope.track[i];!o.kept&&!s.has(o.id)&&o.dispose()}const r=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach(i=>{!i.kept&&i.scopeId===r.id&&this.track(i)})}gradients(e,n,s,r=!1){if(O(n.length>0,()=>"gradients() received an empty list of xs."),s!=null&&s.dtype!=="float32")throw new Error(`dy must have 'float32' dtype, but has '${s.dtype}'`);const i=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",e));O(i instanceof Yt,()=>"The result y returned by f() must be a tensor.");const o=jge(this.state.activeTape,n,i);if(!r&&o.length===0&&n.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{const a={};a[i.id]=s??Yge(i.shape),Bge(a,o,c=>this.tidy(c),Zge);const l=n.map(c=>a[c.id]);return this.state.gradientDepth===0&&(this.state.activeTape.forEach(c=>{for(const u of c.saved)u.dispose()}),this.state.activeTape=null),{value:i,grads:l}})}customGrad(e){return O(_2(e),()=>"The f passed in customGrad(f) must be a function."),(...n)=>{O(n.every(a=>a instanceof Yt),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");let s;const r={};n.forEach((a,l)=>{r[l]=a});const i=(a,l)=>(s=e(...n,l),O(s.value instanceof Yt,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),O(_2(s.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),s.value),o=(a,l)=>{const c=s.gradFunc(a,l),u=Array.isArray(c)?c:[c];O(u.length===n.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),O(u.every(h=>h instanceof Yt),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");const d={};return u.forEach((h,f)=>{d[f]=()=>h}),d};return this.runKernelFunc({forwardFunc:i,backwardsFunc:o,inputs:r})}}readSync(e){return this.state.tensorInfo.get(e).backend.readSync(e)}read(e){return this.state.tensorInfo.get(e).backend.read(e)}readToGPU(e,n){return this.state.tensorInfo.get(e).backend.readToGPU(e,n)}async time(e){const n=vr(),s=await this.backend.time(e);return s.wallMs=vr()-n,s}track(e){return this.state.activeScope!=null&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new z3;for(const e in this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}Rf.nextTensorId=0;Rf.nextVariableId=0;function Yge(t){const e=g$(le(t),"float32");return Z.makeTensor(e,t,"float32")}function q6(){const t=O6();if(t._tfengine==null){const e=new bge(t);t._tfengine=new Rf(e)}return Cge(t._tfengine.ENV),Hge(()=>t._tfengine),t._tfengine}const Z=q6();function Zge(t,e){const n={a:t,b:e};return Z.runKernel(ip,n)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qge(){return typeof navigator<"u"&&navigator!=null}function X6(t){if(t||Qge()){if(t||(t=navigator),t.product==="ReactNative")return!0;const e=t.userAgent||t.vendor||(typeof window<"u"?window.opera:"");if(!e){const n=t;return n.userAgentData&&n.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}return!1}function Y6(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qr=oe();Qr.registerFlag("DEBUG",()=>!1,t=>{t&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")});Qr.registerFlag("IS_BROWSER",()=>Y6());Qr.registerFlag("IS_NODE",()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u");Qr.registerFlag("IS_CHROME",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor));Qr.registerFlag("PROD",()=>!1);Qr.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>Qr.getBool("DEBUG"));Qr.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0);Qr.registerFlag("IS_TEST",()=>!1);Qr.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>!0);Qr.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1);Qr.registerFlag("ENGINE_COMPILE_ONLY",()=>!1);Qr.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",()=>!1);Qr.registerFlag("USE_SETTIMEOUTCUSTOM",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nu(t,e){let n=t;if(_a(t))return e==="string"?[]:[t.length];if(!Array.isArray(t))return[];const s=[];for(;Array.isArray(n)||_a(n)&&e!=="string";)s.push(n.length),n=n[0];return Array.isArray(t)&&oe().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&Z6(t,s,[]),s}function Z6(t,e,n){if(n=n||[],!Array.isArray(t)&&!_a(t)){O(e.length===0,()=>`Element arr[${n.join("][")}] is a primitive, but should be an array/TypedArray of ${e[0]} elements`);return}O(e.length>0,()=>`Element arr[${n.join("][")}] should be a primitive, but is an array of ${t.length} elements`),O(t.length===e[0],()=>`Element arr[${n.join("][")}] should have ${e[0]} elements, but has ${t.length} elements`);const s=e.slice(1);for(let r=0;r<t.length;++r)Z6(t[r],s,n.concat(r))}function V3(t,e,n,s){if(t!=="string_or_numeric"){if(t==null)throw new Error("Expected dtype cannot be null.");if(t!=="numeric"&&t!==e||t==="numeric"&&e==="string")throw new Error(`Argument '${n}' passed to '${s}' must be ${t} tensor, but got ${e} tensor`)}}function L(t,e,n,s="numeric"){if(t instanceof Yt)return V3(s,t.dtype,e,n),t;let r=vy(t);if(r!=="string"&&["bool","int32","float32"].indexOf(s)>=0&&(r=s),V3(s,r,e,n),t==null||!_a(t)&&!Array.isArray(t)&&typeof t!="number"&&typeof t!="boolean"&&typeof t!="string"){const l=t==null?"null":t.constructor.name;throw new Error(`Argument '${e}' passed to '${n}' must be a Tensor or TensorLike, but got '${l}'`)}const i=nu(t,r);!_a(t)&&!Array.isArray(t)&&(t=[t]);const a=r!=="string"?Ld(t,r):_f(t,[],!0);return Z.makeTensor(a,i,r)}function Jb(t,e,n,s="numeric"){if(!Array.isArray(t))throw new Error(`Argument ${e} passed to ${n} must be a \`Tensor[]\` or \`TensorLike[]\``);return t.map((i,o)=>L(i,`${e}[${o}]`,n,s))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Q6="__op";function X(t){const e=Object.keys(t);if(e.length!==1)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${e.length} keys.`);let n=e[0];const s=t[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n=n+Q6;const r=(...i)=>{Z.startScope(n);try{const o=s(...i);return $f(o)&&console.error("Cannot return a Promise inside of tidy."),Z.endScope(o),o}catch(o){throw Z.endScope(null),o}};return Object.defineProperty(r,"name",{value:n,configurable:!0}),r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jge(t,e){const n=L(t,"real","complex"),s=L(e,"imag","complex");ni(n.shape,s.shape,`real and imag shapes, ${n.shape} and ${s.shape}, must match in call to tf.complex().`);const r={real:n,imag:s};return Z.runKernel(C$,r)}const zc=X({complex_:Jge});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function su(t,e,n,s){if(s==null&&(s=vy(t)),s==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!_a(t)&&!Array.isArray(t)&&typeof t!="number"&&typeof t!="boolean"&&typeof t!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(e!=null){R6(e);const r=le(e),i=le(n);O(r===i,()=>`Based on the provided shape, [${e}], the tensor should have ${r} values but has ${i}`);for(let o=0;o<n.length;++o){const a=n[o],l=o===n.length-1?a!==le(e.slice(o)):!0;O(n[o]===e[o]||!l,()=>`Error creating a new Tensor. Inferred shape (${n}) does not match the provided shape (${e}). `)}}return!_a(t)&&!Array.isArray(t)&&(t=[t]),e=e||n,t=s!=="string"?Ld(t,s):_f(t,[],!0),Z.makeTensor(t,e,s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wa(t,e,n){const s=nu(t,n);return su(t,e,s,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const j2={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ew=4;async function B2(t,e){const n=[],s=[],r=Array.isArray(t)?t.map(o=>o.name):Object.keys(t);for(let o=0;o<r.length;++o){const a=r[o],l=Array.isArray(t)?t[o].tensor:t[a];if(l.dtype!=="float32"&&l.dtype!=="int32"&&l.dtype!=="bool"&&l.dtype!=="string"&&l.dtype!=="complex64")throw new Error(`Unsupported dtype in weight '${a}': ${l.dtype}`);const c={name:a,shape:l.shape,dtype:l.dtype};if(l.dtype==="string"){const u=new Promise(async d=>{const h=await l.bytes(),f=h.reduce((g,y)=>g+y.length,0)+ew*h.length,p=new Uint8Array(f);let m=0;for(let g=0;g<h.length;g++){const y=h[g],x=new Uint8Array(new Uint32Array([y.length]).buffer);p.set(x,m),m+=ew,p.set(y,m),m+=y.length}d(p)});s.push(u)}else s.push(l.data());e!=null&&(c.group=e),n.push(c)}const i=await Promise.all(s);return{data:eye(i),specs:n}}function SA(t,e){const n={};let s,r=0;for(const i of e){const o=i.name,a=i.dtype,l=i.shape,c=le(l);let u;if("quantization"in i){const d=i.quantization;if(d.dtype==="uint8"||d.dtype==="uint16"){if(!("min"in d&&"scale"in d))throw new Error(`Weight ${i.name} with quantization ${d.dtype} doesn't have corresponding metadata min and scale.`)}else if(d.dtype==="float16"){if(a!=="float32")throw new Error(`Weight ${i.name} is quantized with ${d.dtype} which only supports weights of type float32 not ${a}.`)}else throw new Error(`Weight ${i.name} has unknown quantization dtype ${d.dtype}. Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.`);const h=j2[d.dtype],f=t.slice(r,r+c*h),p=d.dtype==="uint8"?new Uint8Array(f):new Uint16Array(f);if(a==="float32")if(d.dtype==="uint8"||d.dtype==="uint16"){u=new Float32Array(p.length);for(let m=0;m<p.length;m++){const g=p[m];u[m]=g*d.scale+d.min}}else if(d.dtype==="float16")s===void 0&&(s=oye()),u=s(p);else throw new Error(`Unsupported quantization type ${d.dtype} for weight type float32.`);else if(a==="int32"){if(d.dtype!=="uint8"&&d.dtype!=="uint16")throw new Error(`Unsupported quantization type ${d.dtype} for weight type int32.`);u=new Int32Array(p.length);for(let m=0;m<p.length;m++){const g=p[m];u[m]=Math.round(g*d.scale+d.min)}}else throw new Error(`Unsupported dtype in weight '${o}': ${a}`);r+=c*h}else if(a==="string"){const d=le(i.shape);u=[];for(let h=0;h<d;h++){const f=new Uint32Array(t.slice(r,r+ew))[0];r+=ew;const p=new Uint8Array(t.slice(r,r+f));u.push(p),r+=f}}else{const d=j2[a],h=t.slice(r,r+c*d);if(a==="float32")u=new Float32Array(h);else if(a==="int32")u=new Int32Array(h);else if(a==="bool")u=new Uint8Array(h);else if(a==="complex64"){u=new Float32Array(h);const f=new Float32Array(u.length/2),p=new Float32Array(u.length/2);for(let y=0;y<f.length;y++)f[y]=u[y*2],p[y]=u[y*2+1];const m=wa(f,l,"float32"),g=wa(p,l,"float32");n[o]=zc(m,g),m.dispose(),g.dispose()}else throw new Error(`Unsupported dtype in weight '${o}': ${a}`);r+=c*d}a!=="complex64"&&(n[o]=wa(u,l,a))}return n}function eye(t){if(t===null)throw new Error(`Invalid input value: ${JSON.stringify(t)}`);let e=0;const n=[];t.forEach(i=>{if(e+=i.byteLength,n.push(i.byteLength===i.buffer.byteLength?i:new i.constructor(i)),!(i instanceof Float32Array||i instanceof Int32Array||i instanceof Uint8Array))throw new Error(`Unsupported TypedArray subtype: ${i.constructor.name}`)});const s=new Uint8Array(e);let r=0;return n.forEach(i=>{s.set(new Uint8Array(i.buffer),r),r+=i.byteLength}),s.buffer}const kA=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function j3(t){return kA?Buffer.byteLength(t):new Blob([t]).size}function tye(t){if(kA)return Buffer.from(t).toString("base64");const e=new Uint8Array(t);let n="";for(let s=0,r=e.length;s<r;s++)n+=String.fromCharCode(e[s]);return btoa(n)}function nye(t){if(kA){const s=Buffer.from(t,"base64");return s.buffer.slice(s.byteOffset,s.byteOffset+s.byteLength)}const e=atob(t),n=new Uint8Array(e.length);for(let s=0;s<e.length;++s)n.set([e.charCodeAt(s)],s);return n.buffer}function TS(t){if(t.length===1)return t[0];let e=0;t.forEach(r=>{e+=r.byteLength});const n=new Uint8Array(e);let s=0;return t.forEach(r=>{n.set(new Uint8Array(r),s),s+=r.byteLength}),n.buffer}function B3(t){const e="/";for(t=t.trim();t.endsWith(e);)t=t.slice(0,t.length-1);const n=t.split(e);return n[n.length-1]}function J6(t,e){const n={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:e};return t.signature!=null&&(n.signature=t.signature),t.userDefinedMetadata!=null&&(n.userDefinedMetadata=t.userDefinedMetadata),t.modelInitializer!=null&&(n.modelInitializer=t.modelInitializer),t.trainingConfig!=null&&(n.trainingConfig=t.trainingConfig),n}function eG(t,e,n){const s={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy};if(t.trainingConfig!=null&&(s.trainingConfig=t.trainingConfig),t.weightsManifest!=null){if(!e)throw new Error("modelJSON has weightsManifest but weightSpecs is null");if(!n)throw new Error("modelJSON has weightsManifest but weightData is null");s.weightSpecs=e,s.weightData=n}return t.signature!=null&&(s.signature=t.signature),t.userDefinedMetadata!=null&&(s.userDefinedMetadata=t.userDefinedMetadata),t.modelInitializer!=null&&(s.modelInitializer=t.modelInitializer),s}async function CA(t,e){let n,s;return t.weightsManifest!=null&&([n,s]=await e(t.weightsManifest)),eG(t,n,s)}function m0(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:t.modelTopology==null?0:j3(JSON.stringify(t.modelTopology)),weightSpecsBytes:t.weightSpecs==null?0:j3(JSON.stringify(t.weightSpecs)),weightDataBytes:t.weightData==null?0:t.weightData.byteLength}}function tG(t){const e=[];for(const n of t)e.push(...n.weights);return e}function sye(){const t=n=>{let s=n<<13,r=0;for(;!(s&8388608);)r-=8388608,s<<=1;return s&=-8388609,r+=947912704,s|r},e=new Uint32Array(2048);e[0]=0;for(let n=1;n<1024;n++)e[n]=t(n);for(let n=1024;n<2048;n++)e[n]=939524096+(n-1024<<13);return e}function rye(){const t=new Uint32Array(64);t[0]=0,t[31]=1199570944,t[32]=2147483648,t[63]=3347054592;for(let e=1;e<31;e++)t[e]=e<<23;for(let e=33;e<63;e++)t[e]=2147483648+(e-32<<23);return t}function iye(){const t=new Uint32Array(64);for(let e=0;e<64;e++)t[e]=1024;return t[0]=t[32]=0,t}function oye(){const t=sye(),e=rye(),n=iye();return s=>{const r=new ArrayBuffer(4*s.length),i=new Uint32Array(r);for(let o=0;o<s.length;o++){const a=s[o],l=t[n[a>>10]+(a&1023)]+e[a>>10];i[o]=l}return new Float32Array(r)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class wn{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return wn.instance==null&&(wn.instance=new wn),wn.instance}static registerSaveRouter(e){wn.getInstance().saveRouters.push(e)}static registerLoadRouter(e){wn.getInstance().loadRouters.push(e)}static getSaveHandlers(e){return wn.getHandlers(e,"save")}static getLoadHandlers(e,n){return wn.getHandlers(e,"load",n)}static getHandlers(e,n,s){const r=[];return(n==="load"?wn.getInstance().loadRouters:wn.getInstance().saveRouters).forEach(o=>{const a=o(e,s);a!==null&&r.push(a)}),r}}const aye=t=>wn.registerSaveRouter(t),lye=t=>wn.registerLoadRouter(t),nG=t=>wn.getSaveHandlers(t),sG=(t,e)=>wn.getLoadHandlers(t,e);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const W2="tensorflowjs",U2=1,Mu="models_store",oc="model_info_store";function rG(){if(!oe().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const t=typeof window>"u"?self:window,e=t.indexedDB||t.mozIndexedDB||t.webkitIndexedDB||t.msIndexedDB||t.shimIndexedDB;if(e==null)throw new Error("The current browser does not appear to support IndexedDB.");return e}function H2(t){const e=t.result;e.createObjectStore(Mu,{keyPath:"modelPath"}),e.createObjectStore(oc,{keyPath:"modelPath"})}class vd{constructor(e){if(this.indexedDB=rG(),e==null||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,e)}async load(){return this.databaseAction(this.modelPath)}databaseAction(e,n){return new Promise((s,r)=>{const i=this.indexedDB.open(W2,U2);i.onupgradeneeded=()=>H2(i),i.onsuccess=()=>{const o=i.result;if(n==null){const a=o.transaction(Mu,"readonly"),c=a.objectStore(Mu).get(this.modelPath);c.onsuccess=()=>{if(c.result==null)return o.close(),r(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));s(c.result.modelArtifacts)},c.onerror=u=>(o.close(),r(c.error)),a.oncomplete=()=>o.close()}else{const a=m0(n),l=o.transaction(oc,"readwrite");let c=l.objectStore(oc);const u=c.put({modelPath:this.modelPath,modelArtifactsInfo:a});let d;u.onsuccess=()=>{d=o.transaction(Mu,"readwrite");const f=d.objectStore(Mu).put({modelPath:this.modelPath,modelArtifacts:n,modelArtifactsInfo:a});f.onsuccess=()=>s({modelArtifactsInfo:a}),f.onerror=p=>{c=l.objectStore(oc);const m=c.delete(this.modelPath);m.onsuccess=()=>(o.close(),r(f.error)),m.onerror=g=>(o.close(),r(f.error))}},u.onerror=h=>(o.close(),r(u.error)),l.oncomplete=()=>{d==null?o.close():d.oncomplete=()=>o.close()}}},i.onerror=o=>r(i.error)})}}vd.URL_SCHEME="indexeddb://";const iG=t=>oe().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(vd.URL_SCHEME)?cye(t.slice(vd.URL_SCHEME.length)):null;wn.registerSaveRouter(iG);wn.registerLoadRouter(iG);function cye(t){return new vd(t)}function uye(t){return t.startsWith(vd.URL_SCHEME)?t.slice(vd.URL_SCHEME.length):t}class dye{constructor(){this.indexedDB=rG()}async listModels(){return new Promise((e,n)=>{const s=this.indexedDB.open(W2,U2);s.onupgradeneeded=()=>H2(s),s.onsuccess=()=>{const r=s.result,i=r.transaction(oc,"readonly"),a=i.objectStore(oc).getAll();a.onsuccess=()=>{const l={};for(const c of a.result)l[c.modelPath]=c.modelArtifactsInfo;e(l)},a.onerror=l=>(r.close(),n(a.error)),i.oncomplete=()=>r.close()},s.onerror=r=>n(s.error)})}async removeModel(e){return e=uye(e),new Promise((n,s)=>{const r=this.indexedDB.open(W2,U2);r.onupgradeneeded=()=>H2(r),r.onsuccess=()=>{const i=r.result,o=i.transaction(oc,"readwrite"),a=o.objectStore(oc),l=a.get(e);let c;l.onsuccess=()=>{if(l.result==null)return i.close(),s(new Error(`Cannot find model with path '${e}' in IndexedDB.`));{const u=a.delete(e),d=()=>{c=i.transaction(Mu,"readwrite");const f=c.objectStore(Mu).delete(e);f.onsuccess=()=>n(l.result.modelArtifactsInfo),f.onerror=p=>s(l.error)};u.onsuccess=d,u.onerror=h=>(d(),i.close(),s(l.error))}},l.onerror=u=>(i.close(),s(l.error)),o.oncomplete=()=>{c==null?i.close():c.oncomplete=()=>i.close()}},r.onerror=i=>s(r.error)})}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const el="/",uh="tensorflowjs_models",oG="info",hye="model_topology",fye="weight_specs",pye="weight_data",mye="model_metadata";function aG(t){return{info:[uh,t,oG].join(el),topology:[uh,t,hye].join(el),weightSpecs:[uh,t,fye].join(el),weightData:[uh,t,pye].join(el),modelMetadata:[uh,t,mye].join(el)}}function lG(t){for(const e of Object.values(t))window.localStorage.removeItem(e)}function gye(t){const e=t.split(el);if(e.length<3)throw new Error(`Invalid key format: ${t}`);return e.slice(1,e.length-1).join(el)}function yye(t){return t.startsWith(bd.URL_SCHEME)?t.slice(bd.URL_SCHEME.length):t}class bd{constructor(e){if(!oe().getBool("IS_BROWSER")||typeof window>"u"||typeof window.localStorage>"u")throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,e==null||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=aG(this.modelPath)}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const n=JSON.stringify(e.modelTopology),s=JSON.stringify(e.weightSpecs),r=m0(e);try{this.LS.setItem(this.keys.info,JSON.stringify(r)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,s),this.LS.setItem(this.keys.weightData,tye(e.weightData));const i={format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,signature:e.signature!=null?e.signature:void 0,userDefinedMetadata:e.userDefinedMetadata!=null?e.userDefinedMetadata:void 0,modelInitializer:e.modelInitializer!=null?e.modelInitializer:void 0,trainingConfig:e.trainingConfig!=null?e.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(i)),{modelArtifactsInfo:r}}catch{throw lG(this.keys),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${r.modelTopologyBytes}, weightSpecsBytes=${r.weightSpecsBytes}, weightDataBytes=${r.weightDataBytes}.`)}}}async load(){const e=JSON.parse(this.LS.getItem(this.keys.info));if(e==null)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if(e.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const n={},s=JSON.parse(this.LS.getItem(this.keys.topology));if(s==null)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);n.modelTopology=s;const r=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(r==null)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);n.weightSpecs=r;const i=this.LS.getItem(this.keys.modelMetadata);if(i!=null){const a=JSON.parse(i);n.format=a.format,n.generatedBy=a.generatedBy,n.convertedBy=a.convertedBy,a.signature!=null&&(n.signature=a.signature),a.userDefinedMetadata!=null&&(n.userDefinedMetadata=a.userDefinedMetadata),a.modelInitializer!=null&&(n.modelInitializer=a.modelInitializer),a.trainingConfig!=null&&(n.trainingConfig=a.trainingConfig)}const o=this.LS.getItem(this.keys.weightData);if(o==null)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return n.weightData=nye(o),n}}bd.URL_SCHEME="localstorage://";const cG=t=>oe().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(bd.URL_SCHEME)?xye(t.slice(bd.URL_SCHEME.length)):null;wn.registerSaveRouter(cG);wn.registerLoadRouter(cG);function xye(t){return new bd(t)}class vye{constructor(){O(oe().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),O(typeof window>"u"||typeof window.localStorage<"u",()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}async listModels(){const e={},n=uh+el,s=el+oG;for(let r=0;r<this.LS.length;++r){const i=this.LS.key(r);if(i.startsWith(n)&&i.endsWith(s)){const o=gye(i);e[o]=JSON.parse(this.LS.getItem(i))}}return e}async removeModel(e){e=yye(e);const n=aG(e);if(this.LS.getItem(n.info)==null)throw new Error(`Cannot find model at path '${e}'`);const s=JSON.parse(this.LS.getItem(n.info));return lG(n),s}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hh="://";class tr{constructor(){this.managers={}}static getInstance(){return tr.instance==null&&(tr.instance=new tr),tr.instance}static registerManager(e,n){O(e!=null,()=>"scheme must not be undefined or null."),e.endsWith(Hh)&&(e=e.slice(0,e.indexOf(Hh))),O(e.length>0,()=>"scheme must not be an empty string.");const s=tr.getInstance();O(s.managers[e]==null,()=>`A model store manager is already registered for scheme '${e}'.`),s.managers[e]=n}static getManager(e){const n=tr.getInstance().managers[e];if(n==null)throw new Error(`Cannot find model manager for scheme '${e}'`);return n}static getSchemes(){return Object.keys(tr.getInstance().managers)}}function Fv(t){if(t.indexOf(Hh)===-1)throw new Error(`The url string provided does not contain a scheme. Supported schemes are: ${tr.getSchemes().join(",")}`);return{scheme:t.split(Hh)[0],path:t.split(Hh)[1]}}async function uG(t,e,n=!1){O(t!==e,()=>`Old path and new path are the same: '${t}'`);const s=wn.getLoadHandlers(t);O(s.length>0,()=>`Copying failed because no load handler is found for source URL ${t}.`),O(s.length<2,()=>`Copying failed because more than one (${s.length}) load handlers for source URL ${t}.`);const r=s[0],i=wn.getSaveHandlers(e);O(i.length>0,()=>`Copying failed because no save handler is found for destination URL ${e}.`),O(i.length<2,()=>`Copying failed because more than one (${s.length}) save handlers for destination URL ${e}.`);const o=i[0],a=Fv(t).scheme,l=Fv(t).path,c=a===Fv(t).scheme,u=await r.load();n&&c&&await tr.getManager(a).removeModel(l);const d=await o.save(u);return n&&!c&&await tr.getManager(a).removeModel(l),d.modelArtifactsInfo}async function bye(){const t=tr.getSchemes(),e={};for(const n of t){const s=await tr.getManager(n).listModels();for(const r in s){const i=n+Hh+r;e[i]=s[r]}}return e}async function wye(t){const e=Fv(t);return tr.getManager(e.scheme).removeModel(e.path)}async function Sye(t,e){return uG(t,e,!1)}async function kye(t,e){return uG(t,e,!0)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Cye{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(e,n){return fetch(e,n)}now(){return performance.now()}encode(e,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Browser's encoder only supports utf-8, but got ${n}`);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}decode(e,n){return new TextDecoder(n).decode(e)}setTimeoutCustom(e,n){if(!window||!oe().getBool("USE_SETTIMEOUTCUSTOM")){setTimeout(e,n);return}this.functionRefs.push(e),setTimeout(()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")},n),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",s=>{if(s.source===window&&s.data.name===this.messageName){s.stopPropagation();const r=this.functionRefs[s.data.index];r(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0)}},!0))}}if(oe().get("IS_BROWSER")){oe().setPlatform("browser",new Cye);try{tr.registerManager(bd.URL_SCHEME,new vye)}catch{}try{tr.registerManager(vd.URL_SCHEME,new dye)}catch{}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tye={importFetch:()=>require("node-fetch")};let HC;class Nye{constructor(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}fetch(e,n){return oe().global.fetch!=null?oe().global.fetch(e,n):(HC==null&&(HC=Tye.importFetch()),HC(e,n))}now(){const e=process.hrtime();return e[0]*1e3+e[1]/1e6}encode(e,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Node built-in encoder only supports utf-8, but got ${n}`);return this.textEncoder.encode(e)}decode(e,n){return e.length===0?"":new this.util.TextDecoder(n).decode(e)}}oe().get("IS_NODE")&&!oe().get("IS_BROWSER")&&oe().setPlatform("node",new Nye);/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gt(t,e="float32",n){return e=e||"float32",R6(t),new ks(t,e,n)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Iye(t,e){const n=L(t,"x","cast");if(!yge(e))throw new Error(`Failed to cast to unknown dtype ${e}`);if(e==="string"&&n.dtype!=="string"||e!=="string"&&n.dtype==="string")throw new Error("Only strings can be casted to strings");const s={x:n},r={dtype:e};return Z.runKernel(Iy,s,r)}const Te=X({cast_:Iye});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _ye(t){const n={x:L(t,"x","clone","string_or_numeric")};return Z.runKernel(Vy,n)}const ll=X({clone_:_ye});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dG(t,e=!1){console.log(t.toString(e))}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q6();const Eye={buffer:gt,cast:Te,clone:ll,print:dG};Gge(Eye);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $ye="model",Aye=".json",Rye=".weights.bin";function W3(t){return new Promise(e=>setTimeout(e)).then(t)}class wd{constructor(e){if(!oe().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");e.startsWith(wd.URL_SCHEME)&&(e=e.slice(wd.URL_SCHEME.length)),(e==null||e.length===0)&&(e=$ye),this.modelJsonFileName=e+Aye,this.weightDataFileName=e+Rye}async save(e){if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");const n=window.URL.createObjectURL(new Blob([e.weightData],{type:"application/octet-stream"}));if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{const s=[{paths:["./"+this.weightDataFileName],weights:e.weightSpecs}],r=J6(e,s),i=window.URL.createObjectURL(new Blob([JSON.stringify(r)],{type:"application/json"})),o=this.modelJsonAnchor==null?document.createElement("a"):this.modelJsonAnchor;if(o.download=this.modelJsonFileName,o.href=i,await W3(()=>o.dispatchEvent(new MouseEvent("click"))),e.weightData!=null){const a=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor;a.download=this.weightDataFileName,a.href=n,await W3(()=>a.dispatchEvent(new MouseEvent("click")))}return{modelArtifactsInfo:m0(e)}}}}wd.URL_SCHEME="downloads://";class Dye{constructor(e){if(e==null||e.length<1)throw new Error(`When calling browserFiles, at least 1 file is required, but received ${e}`);this.jsonFile=e[0],this.weightsFiles=e.slice(1)}async load(){return new Promise((e,n)=>{const s=new FileReader;s.onload=r=>{const i=JSON.parse(r.target.result),o=i.modelTopology;if(o==null){n(new Error(`modelTopology field is missing from file ${this.jsonFile.name}`));return}if(i.weightsManifest==null){n(new Error(`weightManifest field is missing from file ${this.jsonFile.name}`));return}if(this.weightsFiles.length===0){e({modelTopology:o});return}const l=CA(i,c=>this.loadWeights(c));e(l)},s.onerror=r=>n(`Failed to read model topology and weights manifest JSON from file '${this.jsonFile.name}'. BrowserFiles supports loading Keras-style tf.Model artifacts only.`),s.readAsText(this.jsonFile)})}loadWeights(e){const n=[],s=[];for(const o of e)n.push(...o.weights),s.push(...o.paths);const r=this.checkManifestAndWeightFiles(e),i=s.map(o=>this.loadWeightsFile(o,r[o]));return Promise.all(i).then(o=>[n,TS(o)])}loadWeightsFile(e,n){return new Promise((s,r)=>{const i=new FileReader;i.onload=o=>{const a=o.target.result;s(a)},i.onerror=o=>r(`Failed to weights data from file of path '${e}'.`),i.readAsArrayBuffer(n)})}checkManifestAndWeightFiles(e){const n=[],s=this.weightsFiles.map(i=>B3(i.name)),r={};for(const i of e)i.paths.forEach(o=>{const a=B3(o);if(n.indexOf(a)!==-1)throw new Error(`Duplicate file basename found in weights manifest: '${a}'`);if(n.push(a),s.indexOf(a)===-1)throw new Error(`Weight file with basename '${a}' is not provided.`);r[o]=this.weightsFiles[s.indexOf(a)]});if(n.length!==this.weightsFiles.length)throw new Error(`Mismatch in the number of files in weights manifest (${n.length}) and the number of weight files provided (${this.weightsFiles.length}).`);return r}}const Oye=t=>oe().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(wd.URL_SCHEME)?Pye(t.slice(wd.URL_SCHEME.length)):null;wn.registerSaveRouter(Oye);function Pye(t="model"){return new wd(t)}function Fye(t){return new Dye(t)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U3(t,e,n,s){o(t),n=n??0,s=s??1,a(n,s);let r=0;const i=l=>(l.then(c=>{const u=n+ ++r/t.length*(s-n);return e(u),c}),l);function o(l){O(l!=null&&Array.isArray(l)&&l.length>0,()=>"promises must be a none empty array")}function a(l,c){O(l>=0&&l<=1,()=>`Progress fraction must be in range [0, 1], but got startFraction ${l}`),O(c>=0&&c<=1,()=>`Progress fraction must be in range [0, 1], but got endFraction ${c}`),O(c>=l,()=>`startFraction must be no more than endFraction, but got startFraction ${l} and endFraction ${c}`)}return Promise.all(t.map(i))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function hG(t,e){e==null&&(e={});const n=e.fetchFunc==null?oe().platform.fetch:e.fetchFunc,s=t.map(d=>n(d,e.requestInit,{isBinary:!0})),r=0,i=.5,a=(e.onProgress==null?await Promise.all(s):await U3(s,e.onProgress,r,i)).map(d=>d.arrayBuffer()),l=.5,c=1;return e.onProgress==null?await Promise.all(a):await U3(a,e.onProgress,l,c)}async function Lye(t,e="",n,s){return fG(o=>hG(o,{requestInit:s}))(t,e,n)}function fG(t){return async(e,n="",s)=>{const r=e.map(()=>!1),i={},o=s!=null?s.map(()=>!1):[],a=[];if(e.forEach((f,p)=>{let m=0;f.weights.forEach(g=>{const y="quantization"in g?g.quantization.dtype:g.dtype,x=j2[y]*le(g.shape),v=()=>{r[p]=!0,i[p]==null&&(i[p]=[]),i[p].push({manifestEntry:g,groupOffset:m,sizeBytes:x})};s!=null?s.forEach((b,k)=>{b===g.name&&(v(),o[k]=!0)}):v(),a.push(g.name),m+=x})}),!o.every(f=>f)){const f=s.filter((p,m)=>!o[m]);throw new Error(`Could not find weights in manifest with names: ${f.join(", ")}. 
Manifest JSON has weights with names: ${a.join(", ")}.`)}const l=r.reduce((f,p,m)=>(p&&f.push(m),f),[]),c=[];l.forEach(f=>{e[f].paths.forEach(p=>{const m=n+(n.endsWith("/")?"":"/")+p;c.push(m)})});const u=await t(c),d={};let h=0;return l.forEach(f=>{const p=e[f].paths.length;let m=0;for(let b=0;b<p;b++)m+=u[h+b].byteLength;const g=new ArrayBuffer(m),y=new Uint8Array(g);let x=0;for(let b=0;b<p;b++){const k=new Uint8Array(u[h+b]);y.set(k,x),x+=k.byteLength}i[f].forEach(b=>{const k=g.slice(b.groupOffset,b.groupOffset+b.sizeBytes),C=SA(k,[b.manifestEntry]);for(const N in C)d[N]=C[N]}),h+=p}),d}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mye="application/octet-stream",zye="application/json";class TA{constructor(e,n){if(this.DEFAULT_METHOD="POST",n==null&&(n={}),this.weightPathPrefix=n.weightPathPrefix,this.onProgress=n.onProgress,this.weightUrlConverter=n.weightUrlConverter,n.fetchFunc!=null?(O(typeof n.fetchFunc=="function",()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"),this.fetch=n.fetchFunc):this.fetch=oe().platform.fetch,O(e!=null&&e.length>0,()=>"URL path for http must not be null, undefined or empty."),Array.isArray(e)&&O(e.length===2,()=>`URL paths for http must have a length of 2, (actual length is ${e.length}).`),this.path=e,n.requestInit!=null&&n.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=n.requestInit||{}}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");const n=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);n.body=new FormData;const s=[{paths:["./model.weights.bin"],weights:e.weightSpecs}],r=J6(e,s);n.body.append("model.json",new Blob([JSON.stringify(r)],{type:zye}),"model.json"),e.weightData!=null&&n.body.append("model.weights.bin",new Blob([e.weightData],{type:Mye}),"model.weights.bin");const i=await this.fetch(this.path,n);if(i.ok)return{modelArtifactsInfo:m0(e),responses:[i]};throw new Error(`BrowserHTTPRequest.save() failed due to HTTP response status ${i.status}.`)}async load(){const e=await this.fetch(this.path,this.requestInit);if(!e.ok)throw new Error(`Request to ${this.path} failed with status code ${e.status}. Please verify this URL points to the model JSON of the model to load.`);let n;try{n=await e.json()}catch{let o=`Failed to parse model JSON of response from ${this.path}.`;throw this.path.endsWith(".pb")?o+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":o+=" Please make sure the server is serving valid JSON for this request.",new Error(o)}const s=n.modelTopology,r=n.weightsManifest;if(s==null&&r==null)throw new Error(`The JSON from HTTP path ${this.path} contains neither model topology or manifest for weights.`);return CA(n,i=>this.loadWeights(i))}async loadWeights(e){const n=Array.isArray(this.path)?this.path[1]:this.path,[s,r]=Vye(n),i=this.weightPathPrefix||s,o=tG(e),a=[],l=[];for(const u of e)for(const d of u.paths)this.weightUrlConverter!=null?l.push(this.weightUrlConverter(d)):a.push(i+d+r);this.weightUrlConverter&&a.push(...await Promise.all(l));const c=await hG(a,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress});return[o,TS(c)]}}TA.URL_SCHEME_REGEX=/^https?:\/\//;function Vye(t){const e=t.lastIndexOf("/"),n=t.lastIndexOf("?"),s=t.substring(0,e),r=n>e?t.substring(n):"";return[s+"/",r]}function G2(t){return t.match(TA.URL_SCHEME_REGEX)!=null}const pG=(t,e)=>{if(typeof fetch>"u"&&(e==null||e.fetchFunc==null))return null;{let n=!0;if(Array.isArray(t)?n=t.every(s=>G2(s)):n=G2(t),n)return NA(t,e)}return null};wn.registerSaveRouter(pG);wn.registerLoadRouter(pG);function NA(t,e){return new TA(t,e)}function mG(t,e){return NA(t,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class GC{constructor(e){this.modelArtifacts=e}load(){return this.modelArtifacts}}class gG{constructor(e){this.saveHandler=e}save(e){return this.saveHandler(e)}}class jye{constructor(e){e.load&&(this.load=()=>Promise.resolve(e.load())),e.save&&(this.save=n=>Promise.resolve(e.save(n)))}}function Bye(t,e,n,s){const r=arguments;return new jye(yG(...r))}function yG(t,e,n,s){return arguments.length===1?t.modelTopology!=null||t.weightSpecs!=null?new GC(t):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new GC({modelTopology:t})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new GC({modelTopology:t,weightSpecs:e,weightData:n,trainingConfig:s}))}function Wye(t){return new gG(t)}function Uye(t){return new gG(t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xG=Object.freeze(Object.defineProperty({__proto__:null,browserFiles:Fye,browserHTTPRequest:mG,concatenateArrayBuffers:TS,copyModel:Sye,decodeWeights:SA,encodeWeights:B2,fromMemory:Bye,fromMemorySync:yG,getLoadHandlers:sG,getModelArtifactsForJSON:CA,getModelArtifactsForJSONSync:eG,getModelArtifactsInfoForJSON:m0,getSaveHandlers:nG,getWeightSpecs:tG,http:NA,isHTTPScheme:G2,listModels:bye,loadWeights:Lye,moveModel:kye,registerLoadRouter:lye,registerSaveRouter:aye,removeModel:wye,weightsLoaderFactory:fG,withSaveHandler:Wye,withSaveHandlerSync:Uye},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hye(t,e,n=!1,s=!1){let r=L(t,"a","matMul"),i=L(e,"b","matMul");[r,i]=Mn(r,i);const o={a:r,b:i},a={transposeA:n,transposeB:s};return Z.runKernel(E1,o,a)}const Ct=X({matMul_:Hye});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gye(t,e,n=1,s=0,r="int32"){if(e<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${e}`);const o={indices:L(t,"indices","oneHot","int32")},a={dtype:r,depth:e,onValue:n,offValue:s};return Z.runKernel(oS,o,a)}const IA=X({oneHot_:Gye});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vl(){return Z}function K2(){return Z.memory()}function se(t,e){return Z.tidy(t,e)}function rt(t){G6(t).forEach(n=>n.dispose())}function Ps(t){return Z.keep(t)}function q2(){return Z.backendName}function vG(t,e,n=1){return Z.registerBackend(t,e,n)}function Kye(){return Z.backend}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qye(t){const n={input:L(t,"input","imag")};return Z.runKernel(B$,n)}const NS=X({imag_:qye});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xye(t){const n={x:L(t,"x","neg")};return Z.runKernel(sS,n)}const vn=X({neg_:Xye});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yye(t){const n={input:L(t,"input","real")};return Z.runKernel(tA,n)}const Ng=X({real_:Yye});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zye(t,e,n){const s=L(t,"x","transpose");if(e==null&&(e=s.shape.map((o,a)=>a).reverse()),O(s.rank===e.length,()=>`Error in transpose: rank of input ${s.rank} must match length of perm ${e}.`),e.forEach(o=>{O(o>=0&&o<s.rank,()=>`All entries in 'perm' must be between 0 and ${s.rank-1} but got ${e}`)}),s.rank<=1)return s.clone();const r={x:s},i={perm:e};return s.dtype==="complex64"?se(()=>{let o=Ng(s),a=NS(s);return o=Z.runKernel(Uh,{x:o},i),a=Z.runKernel(Uh,{x:a},i),n&&(a=vn(a)),zc(o,a)}):Z.runKernel(Uh,r,i)}const Nt=X({transpose_:Zye});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Df(t,e){const n=t.length,s=[];for(let r=0;r<n;r++){const i=n-1-r,o=t[i]||1;(e[e.length-1-r]||1)>1&&o===1&&s.unshift(i)}return s}function ps(t,e){const n=[];for(let s=0;s<e.length;s++){const r=t[t.length-s-1],i=e.length-s-1,o=e[i];(r==null||r===1&&o>1)&&n.unshift(i)}return n}function ct(t,e){const n=[],s=Math.max(t.length,e.length);for(let r=0;r<s;r++){let i=t[t.length-r-1];i==null&&(i=1);let o=e[e.length-r-1];if(o==null&&(o=1),i===1)n.unshift(o);else if(o===1)n.unshift(i);else if(i!==o){const a=`Operands could not be broadcast together with shapes ${t} and ${e}.`;throw Error(a)}else n.unshift(i)}return n}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bG(t,e,n){if(sp(t),e!=null&&e.length!==3)throw new Error("tensor3d() requires shape to have three numbers");const s=nu(t,n);if(s.length!==3&&s.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(s.length===1&&e==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return su(t,e,s,n)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let xu;function Qye(t,e=3){if(e>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(t==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");let n=!1,s=!1,r=!1,i=!1,o=!1,a=!1;if(t.data instanceof Uint8Array)n=!0;else if(typeof ImageData<"u"&&t instanceof ImageData)s=!0;else if(typeof HTMLVideoElement<"u"&&t instanceof HTMLVideoElement)r=!0;else if(typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement)i=!0;else if(t.getContext!=null)o=!0;else if(typeof ImageBitmap<"u"&&t instanceof ImageBitmap)a=!0;else throw new Error(`pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was ${t.constructor.name}`);if(O2(R2,Z.backendName)!=null){const p={pixels:t},m={numChannels:e};return Z.runKernel(R2,p,m)}const[c,u]=r?[t.videoWidth,t.videoHeight]:[t.width,t.height];let d;if(o)d=t.getContext("2d").getImageData(0,0,c,u).data;else if(s||n)d=t.data;else if(i||r||a){if(xu==null)if(typeof document>"u")if(typeof OffscreenCanvas<"u"&&typeof OffscreenCanvasRenderingContext2D<"u")xu=new OffscreenCanvas(1,1).getContext("2d");else throw new Error("Cannot parse input in current context. Reason: OffscreenCanvas Context2D rendering is not supported.");else xu=document.createElement("canvas").getContext("2d",{willReadFrequently:!0});xu.canvas.width=c,xu.canvas.height=u,xu.drawImage(t,0,0,c,u),d=xu.getImageData(0,0,c,u).data}let h;if(e===4)h=new Int32Array(d);else{const p=c*u;h=new Int32Array(p*e);for(let m=0;m<p;m++)for(let g=0;g<e;++g)h[m*e+g]=d[m*4+g]}return bG(h,[u,c,e],"int32")}const Jye=X({fromPixels_:Qye});function _A(t,e){const n=t.shape.length,s=e.shape.length;if(n<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${n}.`);if(s<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${s}.`);if(e.dtype!=="int32")throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${e.dtype}.`);if(e.shape[s-1]>n)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${e.shape[s-1]} vs. ${n}`);if(le(t.shape)===0)throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${t.shape}.`);const r=e.shape,i=r[r.length-1];let o=1;for(let d=0;d<r.length-1;++d)o*=r[d];const a=t.shape,l=r.slice();l.pop();let c=1;for(let d=i;d<n;++d)c*=a[d],l.push(a[d]);const u=[...Ye(t.shape).map(d=>d/c),1].slice(0,i);return[l,o,c,u]}function wG(t,e,n){const s=e.rank>1?e.shape[e.rank-1]:1,r=e.rank>1?e.rank-1:1,i=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${n.shape}, indices.shape: ${e.shape}, shape: ${t}, sliceDim: ${s}, and batchDim: ${r}.`;if(n.rank<r)throw new Error(i+` update.rank < ${r}. `);if(t.length<s+(n.rank-r))throw new Error(i+` Output shape length < ${s+(n.rank-r)}`);if(n.rank!==r+t.length-s)throw new Error(i+` update.rank != ${r+t.length-s}`);for(let o=0;o<r;++o)if(n.shape[o]!==e.shape[o])throw new Error(i+` updates.shape[${o}] (${n.shape[o]}) != indices.shape[${o}] (${e.shape[o]}).`);for(let o=0;o<n.rank-r;++o)if(n.shape[o+r]!==t[o+s])throw new Error(i+` updates.shape[${o+r}] (${n.shape[o+r]}) != shape[${o+r}] (${t[o+r]})`)}function SG(t,e,n){if(e.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${e.rank}.`);if(t.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${t.rank}.`);if(e.dtype!=="int32")throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${e.dtype}`);if(n.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${n}`);if(n.length===0){if(e.size===0)throw new Error(`Indices specified for empty output. indices shape: ${e.shape}`);if(t.size===0)throw new Error(`Updates specified for empty output. updates shape: ${t.shape}`)}wG(n,e,t)}function g0(t,e,n){const s=e.shape.length,r=s>1?e.shape[s-1]:1,i=n.length;let o=1;for(let d=r;d<i;++d)o*=n[d];const a=r<1?1:r,l=le(e.shape)/a,c=[...Ye(n.slice(0,r)),1],u=le(n);return{sliceRank:r,numUpdates:l,sliceSize:o,strides:c,outputSize:u}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const X2=-2,e0e=-1;function EA(t,e,n){const s=t.shape.length;O(s===e.length,()=>`Error in slice${s}D: Length of begin ${e} must match the rank of the array (${s}).`),O(s===n.length,()=>`Error in slice${s}D: Length of size ${n} must match the rank of the array (${s}).`);for(let r=0;r<s;++r)O(e[r]+n[r]<=t.shape[r],()=>`Error in slice${s}D: begin[${r}] + size[${r}] (${e[r]+n[r]}) would overflow input.shape[${r}] (${t.shape[r]})`)}function t0e(t){const e=[];let n=0;for(;t>0;)t&1&&e.push(n),t/=2,n++;return e}function $A(t,e,n){const s=[];for(let r=0;r<t.length;r++)s[r]=Math.ceil((e[r]-t[r])/n[r]);return s}function kG(t,e,n,s){const r=[...t];for(let i=r.length;i<s.length;i++)r.push(1);for(let i=0;i<n;i++)i===0?r[e]=1:(r.splice(e,0,1),r.pop());return r}function CG(t,e,n){return n<=t?n:n-(e-1)}function TG(t,e){const n=[];for(let s=0;s<t;s++)n.push(e+s);return n}function n0e(t,e,n,s,r,i,o,a,l){const c=t.length;let u=new Array(c),d=new Array(c),h=new Array(c);if(e.length&&n>0){const f=e[0],p=n+1;u=NG(o,f,p,s,t),d=IG(a,f,p,r,t),h=kG(i,f,p,t)}else for(let f=0;f<c;f++)u[f]=EG(o,s,i,t,f,l),d[f]=$G(a,r,i,t,f,l),h[f]=_G(i,f,l);return{begin:u,end:d,strides:h}}function NG(t,e,n,s,r){const i=[...r],o=TG(n,e);for(let a=0;a<i.length;a++)if(o.indexOf(a)>-1)i[a]=0;else{const l=CG(e,n,a);let c=s[l];t&1<<l&&(c=0),i[a]=c}return i}function IG(t,e,n,s,r){const i=[...r],o=TG(n,e);for(let a=0;a<i.length;a++)if(o.indexOf(a)>-1)i[a]=Number.MAX_SAFE_INTEGER;else{const l=CG(e,n,a);let c=s[l];t&1<<l&&(c=Number.MAX_SAFE_INTEGER),i[a]=c}for(let a=0;a<i.length;a++){const l=r[a];i[a]<0&&(i[a]+=l),i[a]=xd(0,i[a],r[a])}return i}function _G(t,e,n){let s=t[e];return(n&1<<e||s==null)&&(s=1),s}function EG(t,e,n,s,r,i){let o=e[r];const a=n[r]||1;(t&1<<r||i&1<<r||o==null)&&(a>0?o=Number.MIN_SAFE_INTEGER:o=Number.MAX_SAFE_INTEGER);const l=s[r];return o<0&&(o+=l),o=xd(0,o,l-1),o}function $G(t,e,n,s,r,i){let o=e[r];const a=n[r]||1;(t&1<<r||i&1<<r||o==null)&&(a>0?o=Number.MAX_SAFE_INTEGER:o=Number.MIN_SAFE_INTEGER);const l=s[r];return o<0&&(o+=l),a>0?o=xd(0,o,l):o=xd(-1,o,l-1),o}function AA(t,e,n){let s=n.length;for(let r=0;r<n.length;r++)if(n[r]>1){s=r;break}for(let r=s+1;r<n.length;r++)if(e[r]>0||n[r]!==t[r])return!1;return!0}function RA(t,e){let n=t.length>0?t[t.length-1]:1;for(let s=0;s<t.length-1;s++)n+=t[s]*e[s];return n}function IS(t,e,n){let s;const r=t.shape.length;typeof e=="number"?s=[e,...new Array(r-1).fill(0)]:e.length<r?s=e.concat(new Array(r-e.length).fill(0)):s=e.slice(),s.forEach(o=>{O(o!==-1,()=>"slice() does not support negative begin indexing.")});let i;return n==null?i=new Array(r).fill(-1):typeof n=="number"?i=[n,...new Array(r-1).fill(-1)]:n.length<r?i=n.concat(new Array(r-n.length).fill(-1)):i=n,i=i.map((o,a)=>o>=0?o:(O(o===-1,()=>`Negative size values should be exactly -1 but got ${o} for the slice() size at index ${a}.`),t.shape[a]-s[a])),[s,i]}function DA(t,e,n,s,r,i,o,a,l){let c;if(s==null?(c=new Array(e.length),c.fill(1)):c=s,o!=null&&o&o-1)throw new Error("Multiple ellipses in slice is not allowed.");let u=!1;const d={dims:c.length,numAddAxisAfterEllipsis:0,begin:e.slice(),end:n.slice(),strides:c.slice(),beginMask:r,endMask:i,ellipsisMask:o,newAxisMask:a,shrinkAxisMask:l};for(let v=0;v<d.dims;v++)u&&1<<v&a&&d.numAddAxisAfterEllipsis++,1<<v&o&&(u=!0);u||(d.ellipsisMask|=1<<d.dims,d.dims++);const h={dims:t.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};s0e(d,h);let f=!0,p=!0,m=!0;const g=[],y=[];for(let v=0;v<t.length;++v){if(h.strides[v]===0)throw Error(`strides[${v}] must be non-zero`);const b=!!(h.shrinkAxisMask&1<<v),k=t[v];if(k===-1){g.push(b?1:-1);continue}const C=[h.beginMask&1<<v,h.endMask&1<<v],N=[h.strides[v]>0?0:-1,h.strides[v]>0?k:k-1];if(b&&h.strides[v]<=0)throw Error("only stride 1 allowed on non-range indexing.");m=m&&h.strides[v]===1;const I=!!(h.beginMask&1<<v&&h.endMask&1<<v);if(h.beginValid&&h.endValid){if(b){const F=h.begin[v]<0?k+h.begin[v]:h.begin[v];if(h.begin[v]=F,h.end[v]=h.begin[v]+1,F<0||F>=k)throw Error(`slice index ${h.begin[v]} of dimension ${v} out of bounds.`)}else h.begin[v]=H3(h.begin[v],0,h.strides[v],k,C,N),h.end[v]=H3(h.end[v],1,h.strides[v],k,C,N);const P=h.strides[v]===1&&h.begin[v]===0&&h.end[v]===k;f=f&&P,p=p&&(v===0&&h.strides[v]===1||P)}else f=f&&h.strides[v]===1&&I,p=p&&(v===0&&h.strides[v]===1||I);let $,A=!1;if(h.beginValid&&h.endValid?($=h.end[v]-h.begin[v],A=!0):b?($=1,A=!0):I&&k>=0&&(h.strides[v]<0?$=-k:$=k,A=!0),A){let P;$===0||$<0!=h.strides[v]<0?P=0:P=Math.trunc($/h.strides[v])+($%h.strides[v]!==0?1:0),g.push(P)}else g.push(-1)}for(let v=0;v<h.finalShapeGatherIndices.length;++v){const b=h.finalShapeGatherIndices[v];b>=0?y.push(g[b]):b===X2&&y.push(1)}return{finalShapeSparse:y.filter((v,b)=>h.finalShapeGatherIndices[b]!==X2),finalShape:y,isIdentity:f,sliceDim0:p,isSimpleSlice:m,begin:h.begin,end:h.end,strides:h.strides}}function s0e(t,e){e.beginMask=0,e.endMask=0,e.shrinkAxisMask=0;let n=0;e.beginValid=t.begin!=null,e.endValid=t.end!=null,e.begin=new Array(e.dims),e.end=new Array(e.dims),e.strides=new Array(e.dims),e.finalShapeGatherIndices=[],e.finalShapeGatherIndicesSparse=[],e.inputShapeGatherIndicesSparse=new Array(e.dims);for(let s=0;s<t.dims;s++)if(1<<s&t.ellipsisMask){const r=Math.min(e.dims-(t.dims-s)+1+t.numAddAxisAfterEllipsis,e.dims);for(;n<r;n++)e.begin[n]=0,e.end[n]=0,e.strides[n]=1,e.beginMask|=1<<n,e.endMask|=1<<n,e.finalShapeGatherIndices.push(n),e.finalShapeGatherIndicesSparse.push(-1),e.inputShapeGatherIndicesSparse[n]=s}else if(1<<s&t.newAxisMask)e.finalShapeGatherIndices.push(X2),e.finalShapeGatherIndicesSparse.push(-1);else{if(n===e.begin.length)throw Error(`Index out of range using input dim ${n}; input has only ${e.dims} dims, ${e.begin.length}.`);t.begin!=null&&(e.begin[n]=t.begin[s]),t.end!=null&&(e.end[n]=t.end[s]),e.strides[n]=t.strides[s],t.beginMask&1<<s&&(e.beginMask|=1<<n),t.endMask&1<<s&&(e.endMask|=1<<n),t.shrinkAxisMask&1<<s?(e.finalShapeGatherIndices.push(e0e),e.finalShapeGatherIndicesSparse.push(-1),e.shrinkAxisMask|=1<<n):(e.finalShapeGatherIndices.push(n),e.finalShapeGatherIndicesSparse.push(s)),e.inputShapeGatherIndicesSparse[n]=s,n++}}function H3(t,e,n,s,r,i){if(r[e])return n>0?i[e]:i[e+1&1];{const o=t<0?s+t:t;return o<i[0]?i[0]:o>i[1]?i[1]:o}}const r0e=Object.freeze(Object.defineProperty({__proto__:null,assertParamsValid:EA,computeFlatOffset:RA,computeOutShape:$A,getNormalizedAxes:n0e,isSliceContinous:AA,maskToAxes:t0e,parseSliceParams:IS,sliceInfo:DA,startForAxis:EG,startIndicesWithElidedDims:NG,stopForAxis:$G,stopIndicesWithElidedDims:IG,stridesForAxis:_G,stridesWithElidedDims:kG},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class op{getClassName(){return this.constructor.className}static fromConfig(e,n){return new e(n)}}class qi{constructor(){this.classNameMap={}}static getMap(){return qi.instance==null&&(qi.instance=new qi),qi.instance}static register(e){qi.getMap().classNameMap[e.className]=[e,e.fromConfig]}}function ge(t){O(t.className!=null,()=>"Class being registered does not have the static className property defined."),O(typeof t.className=="string",()=>"className is required to be a string, but got type "+typeof t.className),O(t.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),qi.register(t)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i0e(t,e){let n=L(t,"a","add"),s=L(e,"b","add");[n,s]=Mn(n,s);const r={a:n,b:s};return Z.runKernel(ip,r)}const fe=X({add_:i0e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o0e(t,e){let n=L(t,"a","floorDiv"),s=L(e,"b","floorDiv");[n,s]=Mn(n,s);const r={a:n,b:s};return Z.runKernel(My,r)}const OA=X({floorDiv_:o0e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a0e(t,e){let n=L(t,"a","div"),s=L(e,"b","div");if([n,s]=Mn(n,s),n.dtype==="int32"&&s.dtype==="int32")return OA(n,s);const r={a:n,b:s},i={};return Z.runKernel(Ry,r,i)}const $e=X({div_:a0e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l0e(t,e){let n=L(t,"a","mul"),s=L(e,"b","mul");[n,s]=Mn(n,s);const r={a:n,b:s};return Z.runKernel(Xy,r)}const Y=X({mul_:l0e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function c0e(t){const e=L(t,"x","abs");if(e.dtype==="complex64"){const n={x:e};return Z.runKernel(A1,n)}else{const n={x:e};return Z.runKernel(k1,n)}}const os=X({abs_:c0e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u0e(t){const n={x:L(t,"x","acos")};return Z.runKernel(by,n)}const AG=X({acos_:u0e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d0e(t){const n={x:L(t,"x","acosh")};return Z.runKernel(wy,n)}const RG=X({acosh_:d0e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h0e(t){O(Array.isArray(t),()=>"The argument passed to tf.addN() must be a list of tensors"),O(t.length>=1,()=>`Must pass at least one tensor to tf.addN(), but got ${t.length}`);const e=t.map((r,i)=>L(r,`tensors${i}`,"addN")),n=e[0];e.forEach(r=>{if(r.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),e.forEach(r=>{if(!Et(r.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});const s=e;return Z.runKernel(C1,s)}const f0e=X({addN_:h0e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p0e(t,e=null,n=!1){const r={x:L(t,"x","all","bool")},i={axis:e,keepDims:n};return Z.runKernel(x$,r,i)}const PA=X({all_:p0e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m0e(t,e=null,n=!1){const r={x:L(t,"x","any","bool")},i={axis:e,keepDims:n};return Z.runKernel(v$,r,i)}const tw=X({any_:m0e});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g0e(t,e=0){const s={x:L(t,"x","argMax")},r={axis:e};return Z.runKernel(T1,s,r)}const Sd=X({argMax_:g0e});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y0e(t,e=0){const s={x:L(t,"x","argMin")},r={axis:e};return Z.runKernel(N1,s,r)}const DG=X({argMin_:y0e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function x0e(t){const n={x:L(t,"x","asin")};return Z.runKernel(Sy,n)}const OG=X({asin_:x0e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v0e(t){const n={x:L(t,"x","asinh")};return Z.runKernel(ky,n)}const PG=X({asinh_:v0e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b0e(t){const n={x:L(t,"x","atan")};return Z.runKernel(Cy,n)}const FG=X({atan_:b0e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w0e(t,e){let n=L(t,"a","atan2"),s=L(e,"b","atan2");[n,s]=Mn(n,s);const r={a:n,b:s};return Z.runKernel(Ny,r)}const LG=X({atan2_:w0e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S0e(t){const n={x:L(t,"x","atanh")};return Z.runKernel(Ty,n)}const MG=X({atanh_:S0e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y0(t,e,n,s,r="NHWC",i){const o=t[3],a=[...e,o],l=Sl(r);return Ts(t,a,n,i,s,null,null,l)}function uo(t,e,n,s,r,i,o="channelsLast"){const[a,l]=nw(e);let c;if(o==="channelsLast")c=[a,l,t[3],t[3]];else if(o==="channelsFirst")c=[a,l,t[1],t[1]];else throw new Error(`Unknown dataFormat ${o}`);return Ts(t,c,n,s,r,i,!1,o)}function wl(t,e,n,s,r,i,o="NDHWC"){const[a,l,c]=Y2(e);let u,d;if(o==="NDHWC")d="channelsLast",u=[a,l,c,t[4],t[4]];else if(o==="NCDHW")d="channelsFirst",u=[a,l,c,t[1],t[1]];else throw new Error(`Unknown dataFormat ${o}`);return ru(t,u,n,s,r,!1,d,i)}function Ts(t,e,n,s,r,i,o=!1,a="channelsLast"){let[l,c,u,d]=[-1,-1,-1,-1];if(a==="channelsLast")[l,c,u,d]=t;else if(a==="channelsFirst")[l,d,c,u]=t;else throw new Error(`Unknown dataFormat ${a}`);const[h,f,,p]=e,[m,g]=nw(n),[y,x]=nw(s),v=Gh(h,y),b=Gh(f,x),{padInfo:k,outHeight:C,outWidth:N}=T0e(r,c,u,m,g,v,b,i,a),I=o?p*d:p;let $;return a==="channelsFirst"?$=[l,I,C,N]:a==="channelsLast"&&($=[l,C,N,I]),{batchSize:l,dataFormat:a,inHeight:c,inWidth:u,inChannels:d,outHeight:C,outWidth:N,outChannels:I,padInfo:k,strideHeight:m,strideWidth:g,filterHeight:h,filterWidth:f,effectiveFilterHeight:v,effectiveFilterWidth:b,dilationHeight:y,dilationWidth:x,inShape:t,outShape:$,filterShape:e}}function ru(t,e,n,s,r,i=!1,o="channelsLast",a){let[l,c,u,d,h]=[-1,-1,-1,-1,-1];if(o==="channelsLast")[l,c,u,d,h]=t;else if(o==="channelsFirst")[l,h,c,u,d]=t;else throw new Error(`Unknown dataFormat ${o}`);const[f,p,m,,g]=e,[y,x,v]=Y2(n),[b,k,C]=Y2(s),N=Gh(f,b),I=Gh(p,k),$=Gh(m,C),{padInfo:A,outDepth:P,outHeight:F,outWidth:V}=N0e(r,c,u,d,y,x,v,N,I,$,a),z=i?g*h:g;let B;return o==="channelsFirst"?B=[l,z,P,F,V]:o==="channelsLast"&&(B=[l,P,F,V,z]),{batchSize:l,dataFormat:o,inDepth:c,inHeight:u,inWidth:d,inChannels:h,outDepth:P,outHeight:F,outWidth:V,outChannels:z,padInfo:A,strideDepth:y,strideHeight:x,strideWidth:v,filterDepth:f,filterHeight:p,filterWidth:m,effectiveFilterDepth:N,effectiveFilterHeight:I,effectiveFilterWidth:$,dilationDepth:b,dilationHeight:k,dilationWidth:C,inShape:t,outShape:B,filterShape:e}}function k0e(t,e,n,s,r){s==null&&(s=FA(t,e,n));const i=t[0],o=t[1],a=nd((i-e+2*s)/n+1,r),l=nd((o-e+2*s)/n+1,r);return[a,l]}function C0e(t,e,n,s,r,i){r==null&&(r=FA(t,e,s));const o=t[0],a=t[1],l=t[2],c=nd((o-e+2*r)/s+1,i),u=nd((a-e+2*r)/s+1,i),d=nd((l-e+2*r)/s+1,i);return[c,u,d,n]}function FA(t,e,n,s=1){const r=Gh(e,s);return Math.floor((t[0]*(n-1)-n+r)/2)}function nw(t){return typeof t=="number"?[t,t,t]:t.length===2?[t[0],t[1],1]:t}function Y2(t){return typeof t=="number"?[t,t,t]:t}function Gh(t,e){return e<=1?t:t+(t-1)*(e-1)}function T0e(t,e,n,s,r,i,o,a,l){let c,u,d;if(typeof t=="number"){c={top:t,bottom:t,left:t,right:t,type:t===0?"VALID":"NUMBER"};const f=k0e([e,n],i,s,t,a);u=f[0],d=f[1]}else if(t==="same"){u=Math.ceil(e/s),d=Math.ceil(n/r);const h=Math.max(0,(u-1)*s+i-e),f=Math.max(0,(d-1)*r+o-n),p=Math.floor(h/2),m=h-p,g=Math.floor(f/2),y=f-g;c={top:p,bottom:m,left:g,right:y,type:"SAME"}}else if(t==="valid")c={top:0,bottom:0,left:0,right:0,type:"VALID"},u=Math.ceil((e-i+1)/s),d=Math.ceil((n-o+1)/r);else if(typeof t=="object"){const h=l==="channelsLast"?t[1][0]:t[2][0],f=l==="channelsLast"?t[1][1]:t[2][1],p=l==="channelsLast"?t[2][0]:t[3][0],m=l==="channelsLast"?t[2][1]:t[3][1];c={top:h,bottom:f,left:p,right:m,type:h===0&&f===0&&p===0&&m===0?"VALID":"EXPLICIT"},u=nd((e-i+h+f)/s+1,a),d=nd((n-o+p+m)/r+1,a)}else throw Error(`Unknown padding parameter: ${t}`);return{padInfo:c,outHeight:u,outWidth:d}}function N0e(t,e,n,s,r,i,o,a,l,c,u){let d,h,f,p;if(typeof t=="number"){d={top:t,bottom:t,left:t,right:t,front:t,back:t,type:t===0?"VALID":"NUMBER"};const g=C0e([e,n,s,1],a,1,r,t,u);h=g[0],f=g[1],p=g[2]}else if(t==="same"){h=Math.ceil(e/r),f=Math.ceil(n/i),p=Math.ceil(s/o);const m=(h-1)*r+a-e,g=(f-1)*i+l-n,y=(p-1)*o+c-s,x=Math.floor(m/2),v=m-x,b=Math.floor(g/2),k=g-b,C=Math.floor(y/2),N=y-C;d={top:b,bottom:k,left:C,right:N,front:x,back:v,type:"SAME"}}else if(t==="valid")d={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},h=Math.ceil((e-a+1)/r),f=Math.ceil((n-l+1)/i),p=Math.ceil((s-c+1)/o);else throw Error(`Unknown padding parameter: ${t}`);return{padInfo:d,outDepth:h,outHeight:f,outWidth:p}}function nd(t,e){if(!e)return Math.trunc(t);switch(e){case"round":return Math.round(t);case"ceil":return Math.ceil(t);case"floor":return Math.floor(t);default:throw new Error(`Unknown roundingMode ${e}`)}}function Vc(t){const[e,n,s]=nw(t);return e===1&&n===1&&s===1}function Ms(t,e){return Vc(t)||Vc(e)}function Sl(t){if(t==="NHWC")return"channelsLast";if(t==="NCHW")return"channelsFirst";throw new Error(`Unknown dataFormat ${t}`)}function cr(t,e,n){if(n!=null){if(typeof e=="string")throw Error(`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${e}.`);if(typeof e=="number")O(Ef(e),()=>`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${e}.`);else if(typeof e=="object")e.forEach(s=>{s.forEach(r=>{O(Ef(r),()=>`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${r}.`)})});else throw Error(`Error in ${t}: Unknown padding parameter: ${e}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I0e(t,e){const s={x:L(t,"x","reshape","string_or_numeric")},r={shape:e};return Z.runKernel(dS,s,r)}const Q=X({reshape_:I0e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _0e(t,e,n,s,r){const i=L(t,"x","avgPool","float32"),o=1;O(Ms(n,o),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`);let a=i,l=!1;i.rank===3&&(l=!0,a=Q(i,[1,i.shape[0],i.shape[1],i.shape[2]])),O(a.rank===4,()=>`Error in avgPool: x must be rank 4 but got rank ${a.rank}.`),cr("avgPool",s,r);const c={x:a},u={filterSize:e,strides:n,pad:s,dimRoundingMode:r};let d=Z.runKernel(I1,c,u);return d=Te(d,i.dtype),l?Q(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const _S=X({avgPool_:_0e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E0e(t,e,n,s,r,i="NDHWC"){const o=L(t,"x","avgPool3d","float32");let a=o,l=!1;o.rank===4&&(l=!0,a=Q(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),O(a.rank===5,()=>`Error in avgPool3d: x must be rank 5 but got rank ${a.rank}.`),O(i==="NDHWC",()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${i}`),cr("avgPool3d",s,r);const c={x:a},u={filterSize:e,strides:n,pad:s,dimRoundingMode:r,dataFormat:i};let d=Z.runKernel(_1,c,u);return d=Te(d,a.dtype),l?Q(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const zG=X({avgPool3d_:E0e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $0e(t,e=0){O(t.length>=1,()=>"Pass at least one tensor to concat");const n=Jb(t,"tensors","concat","string_or_numeric");if(n[0].dtype==="complex64"&&n.forEach(i=>{if(i.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype ${i.dtype}. `)}),n.length===1)return ll(n[0]);const s=n,r={axis:e};return Z.runKernel(R1,s,r)}const Cn=X({concat_:$0e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A0e(t){const n={x:L(t,"x","sigmoid","float32")};return Z.runKernel(o0,n)}const bi=X({sigmoid_:A0e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R0e(t,e,n){const s=L(t,"x","slice","string_or_numeric");if(s.rank===0)throw new Error("Slicing scalar is not possible");const r={x:s},i={begin:e,size:n};return Z.runKernel(gS,r,i)}const st=X({slice_:R0e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function D0e(t){const n={x:L(t,"x","tanh","float32")};return Z.runKernel(h0,n)}const Of=X({tanh_:D0e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O0e(t,e,n,s,r,i){const o=L(t,"forgetBias","basicLSTMCell"),a=L(e,"lstmKernel","basicLSTMCell"),l=L(n,"lstmBias","basicLSTMCell"),c=L(s,"data","basicLSTMCell"),u=L(r,"c","basicLSTMCell"),d=L(i,"h","basicLSTMCell"),h=Cn([c,d],1),f=Ct(h,a),p=fe(f,l),m=p.shape[0],g=p.shape[1]/4,y=[m,g],x=st(p,[0,0],y),v=st(p,[0,g],y),b=st(p,[0,g*2],y),k=st(p,[0,g*3],y),C=fe(Y(bi(x),Of(v)),Y(u,bi(fe(o,b)))),N=Y(Of(C),bi(k));return[C,N]}const P0e=X({basicLSTMCell_:O0e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F0e(t,e,n){const s=L(t,"x","batchToSpaceND"),r=e.reduce((a,l)=>a*l);O(s.rank>=1+e.length,()=>`input rank is ${s.rank} but should be > than blockShape.length ${e.length}`),O(n.length===e.length,()=>`crops.length is ${n.length} but should be equal to blockShape.length  ${e.length}`),O(s.shape[0]%r===0,()=>`input tensor batch is ${s.shape[0]} but is not divisible by the product of the elements of blockShape ${e.join(" * ")} === ${r}`);const i={x:s},o={blockShape:e,crops:n};return Z.runKernel($1,i,o)}const ES=X({batchToSpaceND_:F0e});function L0e(t){let e;return t.rank===0||t.rank===1?e=Q(t,[1,1,1,t.size]):t.rank===2?e=Q(t,[1,1,t.shape[0],t.shape[1]]):t.rank===3?e=Q(t,[1,t.shape[0],t.shape[1],t.shape[2]]):e=t,e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M0e(t,e,n,s,r,i){i==null&&(i=.001);const o=L(t,"x","batchNorm"),a=L(e,"mean","batchNorm"),l=L(n,"variance","batchNorm");let c;r!=null&&(c=L(r,"scale","batchNorm"));let u;s!=null&&(u=L(s,"offset","batchNorm")),O(a.rank===l.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),O(u==null||a.rank===u.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),O(c==null||a.rank===c.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");const h={x:L0e(o),scale:c,offset:u,mean:a,variance:l},f={varianceEpsilon:i},p=Z.runKernel(j1,h,f);return Q(p,o.shape)}const x0=X({batchNorm_:M0e});function z0e(t,e,n,s,r,i){const o=L(t,"x","batchNorm"),a=L(e,"mean","batchNorm"),l=L(n,"variance","batchNorm");let c;r!=null&&(c=L(r,"scale","batchNorm"));let u;return s!=null&&(u=L(s,"offset","batchNorm")),O(o.rank===2,()=>`Error in batchNorm2D: x must be rank 2 but got rank ${o.rank}.`),O(a.rank===2||a.rank===1,()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${a.rank}.`),O(l.rank===2||l.rank===1,()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${l.rank}.`),c!=null&&O(c.rank===2||c.rank===1,()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${c.rank}.`),u!=null&&O(u.rank===2||u.rank===1,()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${u.rank}.`),x0(o,a,l,u,c,i)}const VG=X({batchNorm2d_:z0e});function V0e(t,e,n,s,r,i){const o=L(t,"x","batchNorm"),a=L(e,"mean","batchNorm"),l=L(n,"variance","batchNorm");let c;r!=null&&(c=L(r,"scale","batchNorm"));let u;return s!=null&&(u=L(s,"offset","batchNorm")),O(o.rank===3,()=>`Error in batchNorm3D: x must be rank 3 but got rank ${o.rank}.`),O(a.rank===3||a.rank===1,()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${a.rank}.`),O(l.rank===3||l.rank===1,()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${l.rank}.`),c!=null&&O(c.rank===3||c.rank===1,()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${c.rank}.`),u!=null&&O(u.rank===3||u.rank===1,()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${u.rank}.`),x0(o,a,l,u,c,i)}const jG=X({batchNorm3d_:V0e});function j0e(t,e,n,s,r,i){const o=L(t,"x","batchNorm"),a=L(e,"mean","batchNorm"),l=L(n,"variance","batchNorm");let c;r!=null&&(c=L(r,"scale","batchNorm"));let u;return s!=null&&(u=L(s,"offset","batchNorm")),O(o.rank===4,()=>`Error in batchNorm4D: x must be rank 4 but got rank ${o.rank}.`),O(a.rank===4||a.rank===1,()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${a.rank}.`),O(l.rank===4||l.rank===1,()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${l.rank}.`),c!=null&&O(c.rank===4||c.rank===1,()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${c.rank}.`),u!=null&&O(u.rank===4||u.rank===1,()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${u.rank}.`),x0(o,a,l,u,c,i)}const BG=X({batchNorm4d_:j0e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B0e(t,e,n){const s=L(t,"x","bincount"),r=L(e,"weights","bincount");O(s.dtype==="int32",()=>`Error in bincount: input dtype must be int32, but got ${s.dtype}`),O(n>=0,()=>`size must be non-negative, but got ${n}.`),O(r.size===s.size||r.size===0,()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${s.shape}, weights shape: ${r.shape}.`);const i={x:s,weights:r},o={size:n};return Z.runKernel(S$,i,o)}const WG=X({bincount_:B0e});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W0e(t,e){const n=L(t,"s0","broadcastArgs","int32"),s=L(e,"s1","broadcastArgs","int32");if(n.rank!==1)throw new Error(`broadcastArgs(): first input must be a vector (rank=1). Has rank ${n.rank}`);if(s.rank!==1)throw new Error(`broadcastArgs(): second input must be a vector (rank=1). Has rank ${s.rank}`);const r={s0:n,s1:s};return Z.runKernel(k$,r)}const U0e=X({broadcastArgs_:W0e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H0e(t,e){let n=L(t,"broadcastTo","x");const s=n.shape;if(e.some(c=>!(c>0)||c%1!==0))throw new Error(`broadcastTo(): Invalid broadcast shape [${e}].`);if(e.length<n.rank)throw new Error(`broadcastTo(): shape.length=${e.length} < input.rank=${n.rank}.`);if(e.length>n.rank){const c=n.shape.slice();for(;c.length<e.length;)c.unshift(1);n=Q(n,c)}const r=n.shape,i=Array.from(e);for(let c=e.length-1;c>=0;c--)if(r[c]===e[c])i[c]=1;else if(n.shape[c]!==1)throw new Error(`broadcastTo(): [${s}] cannot be broadcast to [${e}].`);if(i.map((c,u)=>c>1?u:-1).filter(c=>c>=0).length===0)return ll(n);const a={x:n},l={reps:i};return Z.runKernel(f0,a,l)}const Cc=X({broadcastTo_:H0e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G0e(t){const n={x:L(t,"x","ceil","float32")};return Z.runKernel(_y,n)}const UG=X({ceil_:G0e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ap(t,e,n){const s={shape:t,value:e,dtype:n};return Z.runKernel(M$,{},s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K0e(t,e,n){const s=L(t,"x","clipByValue");if(O(e<=n,()=>`Error in clip: min (${e}) must be less than or equal to max (${n}).`),e===n)return ap(s.shape,e,s.dtype);const r={x:s},i={clipValueMin:e,clipValueMax:n};return Z.runKernel(Ey,r,i)}const Tr=X({clipByValue_:K0e});function q0e(t){return Cn(t,0)}const HG=X({concat1d_:q0e});function X0e(t,e){return Cn(t,e)}const GG=X({concat2d_:X0e});function Y0e(t,e){return Cn(t,e)}const KG=X({concat3d_:Y0e});function Z0e(t,e){return Cn(t,e)}const qG=X({concat4d_:Z0e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q0e(t,e,n,s,r="NHWC",i=[1,1],o){const a=L(t,"x","conv2d","float32"),l=L(e,"filter","conv2d","float32");let c=a,u=!1;a.rank===3&&(u=!0,c=Q(a,[1,a.shape[0],a.shape[1],a.shape[2]])),O(c.rank===4,()=>`Error in conv2d: input must be rank 4, but got rank ${c.rank}.`),O(l.rank===4,()=>`Error in conv2d: filter must be rank 4, but got rank ${l.rank}.`),cr("conv2d",s,o);const d=r==="NHWC"?c.shape[3]:c.shape[1];O(d===l.shape[2],()=>`Error in conv2d: depth of input (${d}) must match input depth for filter ${l.shape[2]}.`),O(Ms(n,i),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`);const h={x:c,filter:l},f={strides:n,pad:s,dataFormat:r,dilations:i,dimRoundingMode:o},p=Z.runKernel(D1,h,f);return u?Q(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const jc=X({conv2d_:Q0e});function J0e(t,e,n,s,r="NWC",i=1,o){const a=L(t,"x","conv1d"),l=L(e,"filter","conv1d");let c=a,u=!1;a.rank===2&&(u=!0,c=Q(a,[1,a.shape[0],a.shape[1]])),O(c.rank===3,()=>`Error in conv1d: input must be rank 3, but got rank ${c.rank}.`),O(l.rank===3,()=>`Error in conv1d: filter must be rank 3, but got rank ${l.rank}.`),cr("conv1d",s,o),O(c.shape[2]===l.shape[1],()=>`Error in conv1d: depth of input (${c.shape[2]}) must match input depth for filter ${l.shape[1]}.`),O(Ms(n,i),()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${n} and dilation '${i}'`),O(r==="NWC",()=>`Error in conv1d: got dataFormat of ${r} but only NWC is currently supported.`);const d=Q(l,[1,l.shape[0],l.shape[1],l.shape[2]]),h=Q(c,[c.shape[0],1,c.shape[1],c.shape[2]]),g=jc(h,d,[1,n],s,"NHWC",[1,i],o);return u?Q(g,[g.shape[2],g.shape[3]]):Q(g,[g.shape[0],g.shape[2],g.shape[3]])}const LA=X({conv1d_:J0e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function exe(t,e,n,s,r,i="NHWC",o){O(t.length===e.rank,()=>`Length of inShape (${t.length}) and rank of dy (${e.rank}) must match`);let a=t,l=e,c=!1;e.rank===3&&(c=!0,l=Q(e,[1,e.shape[0],e.shape[1],e.shape[2]]),a=[1,t[0],t[1],t[2]]),O(a.length===4,()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${a.length}.`),O(l.rank===4,()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${l.rank}`),O(n.rank===4,()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${n.rank}`);const u=i==="NHWC"?a[3]:a[1],d=i==="NHWC"?l.shape[3]:l.shape[1];O(u===n.shape[2],()=>`Error in conv2dDerInput: depth of input (${u}) must match input depth for filter ${n.shape[2]}.`),O(d===n.shape[3],()=>`Error in conv2dDerInput: depth of output (${d}) must match output depth for filter ${n.shape[3]}.`),cr("conv2dDerInput",r,o);const h={dy:l,filter:n},f={strides:s,pad:r,dataFormat:i,dimRoundingMode:o,inputShape:a},p=Z.runKernel(O1,h,f);return c?Q(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const MA=X({conv2DBackpropInput_:exe});function txe(t,e,n,s,r,i){const o=L(t,"x","conv2dTranspose"),a=L(e,"filter","conv2dTranspose");return MA(n,o,a,s,r,"NHWC",i)}const zA=X({conv2dTranspose_:txe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nxe(t,e,n,s,r="NDHWC",i=[1,1,1]){const o=L(t,"x","conv3d"),a=L(e,"filter","conv3d");let l=o,c=!1;o.rank===4&&(c=!0,l=Q(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),O(l.rank===5,()=>`Error in conv3d: input must be rank 5, but got rank ${l.rank}.`),O(a.rank===5,()=>`Error in conv3d: filter must be rank 5, but got rank ${a.rank}.`),O(l.shape[4]===a.shape[3],()=>`Error in conv3d: depth of input (${l.shape[4]}) must match input depth for filter ${a.shape[3]}.`),O(Ms(n,i),()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`),O(r==="NDHWC",()=>`Error in conv3d: got dataFormat of ${r} but only NDHWC is currently supported.`);const u={x:l,filter:a},d={strides:n,pad:s,dataFormat:r,dilations:i},h=Z.runKernel(P1,u,d);return c?Q(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}const XG=X({conv3d_:nxe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sxe(t,e,n,s,r){O(t.length===e.rank,()=>`Length of inShape (${t.length}) and rank of dy (${e.rank}) must match`);let i=t,o=e,a=!1;e.rank===4&&(a=!0,o=Q(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]),i=[1,t[0],t[1],t[2],t[3]]);const l=i[4],c=o.shape[4];O(i.length===5,()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${i.length}.`),O(o.rank===5,()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${o.rank}`),O(n.rank===5,()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${n.rank}`),O(l===n.shape[3],()=>`Error in conv3dDerInput: depth of input (${l}) must match input depth for filter ${n.shape[3]}.`),O(c===n.shape[4],()=>`Error in conv3dDerInput: depth of output (${c}) must match output depth for filter ${n.shape[4]}.`);const u={dy:o,filter:n},d={pad:r,strides:s,inputShape:i},h=Z.runKernel(I$,u,d);return a?Q(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}const YG=X({conv3DBackpropInput_:sxe});function rxe(t,e,n,s,r){const i=L(t,"x","conv3dTranspose"),o=L(e,"filter","conv3dTranspose");return YG(n,i,o,s,r)}const ZG=X({conv3dTranspose_:rxe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ixe(t){const n={x:L(t,"x","cos","float32")};return Z.runKernel($y,n)}const $S=X({cos_:ixe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oxe(t){const n={x:L(t,"x","cosh","float32")};return Z.runKernel(Ay,n)}const VA=X({cosh_:oxe});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function axe(t,e=0,n=!1,s=!1){const i={x:L(t,"x","cumprod")},o={axis:e,exclusive:n,reverse:s};return Z.runKernel(_$,i,o)}const sw=X({cumprod_:axe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lxe(t,e=0,n=!1,s=!1){const i={x:L(t,"x","cumsum")},o={axis:e,exclusive:n,reverse:s};return Z.runKernel(F1,i,o)}const jA=X({cumsum_:lxe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cxe(t,e,n,s=!1){const r=L(t,"x","denseBincount"),i=L(e,"weights","denseBincount");O(r.dtype==="int32",()=>`Error in denseBincount: input dtype must be int32, but got ${r.dtype}`),O(r.rank<=2,()=>`Error in denseBincount: input must be at most rank 2, but got rank ${r.rank}.`),O(n>=0,()=>`size must be non-negative, but got ${n}.`),O(i.size===r.size||i.size===0,()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${r.shape}, weights shape: ${i.shape}.`);const o={x:r,weights:i},a={size:n,binaryOutput:s};return Z.runKernel($$,o,a)}const uxe=X({denseBincount_:cxe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dxe(t,e,n="NHWC"){const s=L(t,"x","depthToSpace","float32"),r=n==="NHWC"?s.shape[1]:s.shape[2],i=n==="NHWC"?s.shape[2]:s.shape[3],o=n==="NHWC"?s.shape[3]:s.shape[1];O(e>1,()=>`blockSize should be > 1 for depthToSpace, but was: ${e}`),O(r*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${r} and ${e}  for depthToSpace with input shape
    ${s.shape}`),O(i*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${i} and ${e} for depthToSpace with input shape
        ${s.shape}`),O(o%(e*e)===0,()=>`Dimension size must be evenly divisible by ${e*e} but is ${o} for depthToSpace with input shape ${s.shape}`);const a={x:s},l={blockSize:e,dataFormat:n};return Z.runKernel(A$,a,l)}const QG=X({depthToSpace_:dxe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hxe(t,e,n,s,r="NHWC",i=[1,1],o){const a=L(t,"x","depthwiseConv2d","float32"),l=L(e,"filter","depthwiseConv2d","float32");let c=a,u=!1;a.rank===3&&(u=!0,c=Q(a,[1,a.shape[0],a.shape[1],a.shape[2]])),O(c.rank===4,()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${c.rank}.`),O(l.rank===4,()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${l.rank}.`);const d=r==="NHWC"?c.shape[3]:c.shape[1];O(d===l.shape[2],()=>`Error in depthwiseConv2d: number of input channels (${d}) must match the inChannels dimension in filter ${l.shape[2]}.`),cr("depthwiseConv2d",s,o);const h={x:c,filter:l},f={strides:n,pad:s,dataFormat:r,dilations:i,dimRoundingMode:o},p=Z.runKernel(L1,h,f);return u?Q(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const v0=X({depthwiseConv2d_:hxe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fxe(t){const n={x:L(t,"x","diag")};return Z.runKernel(O$,n)}const pxe=X({diag_:fxe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mxe(t,e,n,s,r=[1,1],i="NHWC"){const o=L(t,"x","dilation2d"),a=L(e,"filter","dilation2d");O(o.rank===3||o.rank===4,()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${o.rank}.`),O(a.rank===3,()=>`Error in dilation2d: filter must be rank 3, but got rank ${a.rank}.`),O(i==="NHWC",()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${i}`);let l=o,c=!1;o.rank===3&&(l=Q(o,[1,o.shape[0],o.shape[1],o.shape[2]]),c=!0);const u={x:l,filter:a},d={strides:n,pad:s,dilations:r},h=Z.runKernel(M1,u,d);return c?Q(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const JG=X({dilation2d_:mxe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gxe(t,e){let n=L(t,"a","equal","string_or_numeric"),s=L(e,"b","equal","string_or_numeric");[n,s]=Mn(n,s),ct(n.shape,s.shape);const r={a:n,b:s};return Z.runKernel(z1,r)}const Mo=X({equal_:gxe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yxe(t,e,n){const s=L(e,"a","where"),r=L(n,"b","where"),i=L(t,"condition","where","bool"),o=ct(ct(i.shape,s.shape),r.shape),a=Cc(i,o),l=Cc(s,o),c=Cc(r,o),u={condition:a,t:l,e:c};return Z.runKernel(mS,u)}const Nr=X({where_:yxe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xxe(t){const n={x:L(t,"x","zerosLike")};return Z.runKernel(kS,n)}const _t=X({zerosLike_:xxe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vxe(t,e){let n=L(t,"a","div"),s=L(e,"b","div");[n,s]=Mn(n,s);const r=$e(n,s),i=_t(r),o=Mo(s,i);return Nr(o,i,r)}const e8=X({divNoNan_:vxe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bxe(t,e){const n=L(t,"t1","dot"),s=L(e,"t2","dot");O((n.rank===1||n.rank===2)&&(s.rank===1||s.rank===2),()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${n.rank} and ${s.rank}.`);const r=n.rank===1?n.size:n.shape[1],i=s.rank===1?s.size:s.shape[0];if(O(r===i,()=>`Error in dot: inner dimensions of inputs must match, but got ${r} and ${i}.`),n.rank===1&&s.rank===1){const o=Q(n,[1,-1]),a=Q(s,[-1,1]),l=Ct(o,a);return Q(l,[])}else if(n.rank===1&&s.rank===2){const o=Q(n,[1,-1]),a=Q(s,[s.shape[0],s.shape[1]]),l=Ct(o,a);return Q(l,[l.size])}else if(n.rank===2&&s.rank===1){const o=Q(s,[-1,1]),a=Ct(n,o);return Q(a,[a.size])}else{const o=Q(s,[s.shape[0],s.shape[1]]);return Ct(n,o)}}const t8=X({dot_:bxe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wxe(t,...e){const n=e.map((r,i)=>L(r,`tensors${i}`,"einsum")),s={equation:t};return Z.runKernel(P$,n,s)}const Sxe=X({einsum_:wxe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kxe(t){const n={x:L(t,"x","elu","float32")};return Z.runKernel(Dy,n)}const b0=X({elu_:kxe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cxe(t){let e=L(t,"x","erf");O(e.dtype==="int32"||e.dtype==="float32",()=>"Input dtype must be `int32` or `float32`."),e.dtype==="int32"&&(e=Te(e,"float32"));const n={x:e};return Z.runKernel(Oy,n)}const n8=X({erf_:Cxe});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BA(t,e){for(let n=0;n<t.length;++n)if(t[t.length-n-1]!==e-1-n)return!1;return!0}function s8(t,e,n){const s=t.length+e.length,r=[];let i=0,o=0;for(let a=0;a<s;a++)n.indexOf(a)===-1?r.push(t[i++]):r.push(e[o++]);return r}function Ns(t,e){const n=[],s=t.length;for(let i=0;i<s;i++)e.indexOf(i)===-1&&n.push(t[i]);const r=e.map(i=>t[i]);return[n,r]}function Hn(t,e){const n=e.map(s=>1);return s8(t,n,e)}function zs(t,e,n){O(BA(e,n),()=>`${t} supports only inner-most axes for now. Got axes ${e} and rank-${n} input.`)}function In(t,e){if(BA(t,e))return null;const n=[];for(let s=0;s<e;++s)t.indexOf(s)===-1&&n.push(s);return t.forEach(s=>n.push(s)),n}function iu(t){return t.map((e,n)=>[n,e]).sort((e,n)=>e[1]-n[1]).map(e=>e[0])}function Gn(t,e){const n=[];for(let s=e-t;s<e;++s)n.push(s);return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Txe(t,e=null,n=!1){const r={x:L(t,"x","max")},i={reductionIndices:e,keepDims:n};return Z.runKernel(Z1,r,i)}const ro=X({max_:Txe});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nxe(t,e=null,n=!1){const r={x:L(t,"x","min")},i={axis:e,keepDims:n};return Z.runKernel(tS,r,i)}const rw=X({min_:Nxe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ixe(t,e){let n=L(t,"base","pow"),s=L(e,"exp","pow");[n,s]=Mn(n,s);const r={a:n,b:s};return Z.runKernel(Yy,r)}const Bc=X({pow_:Ixe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ge(t,e){if((_a(t)&&e!=="string"||Array.isArray(t))&&e!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(e==="string"&&_a(t)&&!(t instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return su(t,[],[],e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _xe(t){const n={x:L(t,"x","sqrt","float32")};return Z.runKernel(l0,n)}const Ys=X({sqrt_:_xe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Exe(t){const e=L(t,"x","square"),n={};return Z.runKernel("Square",{x:e},n)}const Zt=X({square_:Exe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $xe(t,e=null,n=!1){let s=L(t,"x","sum");s.dtype==="bool"&&(s=Te(s,"int32"));const r={x:s},i={axis:e,keepDims:n};return Z.runKernel(yS,r,i)}const Be=X({sum_:$xe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Axe(t,e="euclidean",n=null,s=!1){t=L(t,"x","norm");const r=r8(t,e,n);let i=r.shape;if(s){const o=bt(n,t.shape);i=Hn(r.shape,o)}return Q(r,i)}function r8(t,e,n=null){if(t.rank===0)return os(t);if(t.rank!==1&&n===null)return r8(Q(t,[-1]),e,n);if(t.rank===1||typeof n=="number"||Array.isArray(n)&&n.length===1){if(e===1)return Be(os(t),n);if(e===1/0)return ro(os(t),n);if(e===-1/0)return rw(os(t),n);if(e==="euclidean"||e===2)return Ys(Be(Bc(os(t),Ge(2,"int32")),n));throw new Error(`Error in norm: invalid ord value: ${e}`)}if(Array.isArray(n)&&n.length===2){if(e===1)return ro(Be(os(t),n[0]),n[1]-1);if(e===1/0)return ro(Be(os(t),n[1]),n[0]);if(e===-1/0)return rw(Be(os(t),n[1]),n[0]);if(e==="fro"||e==="euclidean")return Ys(Be(Zt(t),n));throw new Error(`Error in norm: invalid ord value: ${e}`)}throw new Error(`Error in norm: invalid axis: ${n}`)}const kd=X({norm_:Axe});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rxe(t,e=null,n=!1){return kd(t,"euclidean",e,n)}const i8=X({euclideanNorm_:Rxe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dxe(t){const n={x:L(t,"x","exp")};return Z.runKernel(Py,n)}const Ir=X({exp_:Dxe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oxe(t,e=0){const n=L(t,"x","expandDims","string_or_numeric");O(e<=n.rank,()=>"Axis must be <= rank of the tensor");const s={input:n},r={dim:e};return Z.runKernel(V1,s,r)}const as=X({expandDims_:Oxe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pxe(t){const n={x:L(t,"x","expm1")};return Z.runKernel(Fy,n)}const o8=X({expm1_:Pxe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fxe(t,e){const n=L(t,"x","tile","string_or_numeric");O(n.rank===e.length,()=>`Error in transpose: rank of input ${n.rank} must match length of reps ${e}.`);const s={x:n},r={reps:e};return Z.runKernel(f0,s,r)}const Ji=X({tile_:Fxe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lxe(t,e,n,s="float32"){e==null&&(e=t);const r=gt([t,e],s),i=t<=e?t:e;for(let a=0;a<i;++a)r.set(1,a,a);const o=Q(r.toTensor(),[t,e]);if(n==null)return o;if(n.length===1)return Ji(as(o,0),[n[0],1,1]);if(n.length===2)return Ji(as(as(o,0),0),[n[0],n[1],1,1]);if(n.length===3)return Ji(as(as(as(o,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${n.length}D.`)}const WA=X({eye_:Lxe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mxe(t){const n={x:L(t,"x","floor","float32")};return Z.runKernel(Ly,n)}const w0=X({floor_:Mxe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zxe(t,e,n=0,s=0){const r=L(t,"x","gather"),i=L(e,"indices","gather","int32"),o={x:r,indices:i},a={axis:n,batchDims:s};return Z.runKernel(B1,o,a)}const Tc=X({gather_:zxe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vxe(t,e){let n=L(t,"a","greater","string_or_numeric"),s=L(e,"b","greater","string_or_numeric");[n,s]=Mn(n,s),ct(n.shape,s.shape);const r={a:n,b:s};return Z.runKernel(W1,r)}const Ei=X({greater_:Vxe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jxe(t,e){let n=L(t,"a","greaterEqual","string_or_numeric"),s=L(e,"b","greaterEqual","string_or_numeric");[n,s]=Mn(n,s),ct(n.shape,s.shape);const r={a:n,b:s};return Z.runKernel(zy,r)}const Md=X({greaterEqual_:jxe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bxe(t){const n={x:L(t,"x","isFinite")};return Z.runKernel(jy,n)}const a8=X({isFinite_:Bxe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wxe(t){const n={x:L(t,"x","isInf")};return Z.runKernel(By,n)}const l8=X({isInf_:Wxe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uxe(t){const n={x:L(t,"x","isNaN")};return Z.runKernel(Wy,n)}const c8=X({isNaN_:Uxe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hxe(t,e=.2){const s={x:L(t,"x","leakyRelu")},r={alpha:e};return Z.runKernel(U1,s,r)}const AS=X({leakyRelu_:Hxe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gxe(t,e){let n=L(t,"a","less","string_or_numeric"),s=L(e,"b","less","string_or_numeric");[n,s]=Mn(n,s),ct(n.shape,s.shape);const r={a:n,b:s};return Z.runKernel(H1,r)}const UA=X({less_:Gxe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kxe(t,e){let n=L(t,"a","lessEqual","string_or_numeric"),s=L(e,"b","lessEqual","string_or_numeric");[n,s]=Mn(n,s),ct(n.shape,s.shape);const r={a:n,b:s};return Z.runKernel(G1,r)}const zd=X({lessEqual_:Kxe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qxe(t,e,n){if(n<=0)throw new Error("The number of values should be positive.");const s={start:t,stop:e,num:n};return Z.runKernel(W$,{},s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xxe(t,e=5,n=1,s=1,r=.5){const i=L(t,"x","localResponseNormalization");O(i.rank===4||i.rank===3,()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank ${i.rank}.`),O(Ef(e),()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${e}.`);let o=i,a=!1;i.rank===3&&(a=!0,o=Q(i,[1,i.shape[0],i.shape[1],i.shape[2]]));const l={x:o},c={depthRadius:e,bias:n,alpha:s,beta:r},u=Z.runKernel(Y1,l,c);return a?Q(u,[u.shape[1],u.shape[2],u.shape[3]]):u}const u8=X({localResponseNormalization_:Xxe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yxe(t){const n={x:L(t,"x","log","float32")};return Z.runKernel(Uy,n)}const Ti=X({log_:Yxe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zxe(t){const n={x:L(t,"x","log1p")};return Z.runKernel(Hy,n)}const RS=X({log1p_:Zxe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qxe(t,e){O(_2(t),()=>"The f passed in variableGrads(f) must be a function"),O(e==null||Array.isArray(e)&&e.every(c=>c instanceof Qb),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");const n=e!=null;if(!n){e=[];for(const c in Z.registeredVariables)e.push(Z.registeredVariables[c])}const s=n?e.filter(c=>!c.trainable):null,r=e.length;e=e.filter(c=>c.trainable),O(e.length>0,()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${r} variables is trainable.`);const i=!0,{value:o,grads:a}=Z.gradients(t,e,null,i);O(a.some(c=>c!=null),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),O(o.rank===0,()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${o.rank} tensor`);const l={};return e.forEach((c,u)=>{a[u]!=null&&(l[c.name]=a[u])}),s!=null&&s.forEach(c=>l[c.name]=null),{value:o,grads:l}}function yl(t){return Z.customGrad(t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jxe(t){const n={x:L(t,"x","softplus")};return Z.runKernel(a0,n)}const lp=X({softplus_:Jxe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eve(t){const e=L(t,"x","logSigmoid");return yl(s=>({value:vn(lp(vn(s))),gradFunc:o=>Y(o,bi(vn(s)))}))(e)}const d8=X({logSigmoid_:eve});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tve(t,e){let n=L(t,"a","sub"),s=L(e,"b","sub");[n,s]=Mn(n,s);const r={a:n,b:s};return Z.runKernel(u0,r)}const Ae=X({sub_:tve});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nve(t,e=-1){const n=L(t,"logits","logSoftmax");if(e===-1&&(e=n.rank-1),e!==n.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and axis was ${e}`);return yl((r,i)=>{const a=ro(r,e,!0),l=Ae(r,a),c=Ae(Te(l,"float32"),Ti(Be(Ir(l),e,!0)));return i([c]),{value:c,gradFunc:(d,h)=>{const[f]=h,p=!0,m=Ir(f);return Ae(d,Y(Be(d,e,p),m))}}})(n)}const HA=X({logSoftmax_:nve});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sve(t,e=null,n=!1){const s=L(t,"x","logSumExp"),r=bt(e,s.shape),i=ro(s,r,!0),o=Ae(s,i),a=Ir(o),l=Be(a,r),c=Ti(l),u=fe(Q(i,c.shape),c);if(n){const d=Hn(u.shape,r);return Q(u,d)}return u}const GA=X({logSumExp_:sve});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rve(t,e){const n=L(t,"a","logicalAnd","bool"),s=L(e,"b","logicalAnd","bool");ct(n.shape,s.shape);const r={a:n,b:s};return Z.runKernel(K1,r)}const Ea=X({logicalAnd_:rve});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ive(t){const n={x:L(t,"x","logicalNot","bool")};return Z.runKernel(q1,n)}const DS=X({logicalNot_:ive});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ove(t,e){const n=L(t,"a","logicalOr","bool"),s=L(e,"b","logicalOr","bool");ct(n.shape,s.shape);const r={a:n,b:s};return Z.runKernel(X1,r)}const KA=X({logicalOr_:ove});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ave(t,e){const n=L(t,"a","logicalXor","bool"),s=L(e,"b","logicalXor","bool");return ct(n.shape,s.shape),Ea(KA(t,e),DS(Ea(t,e)))}const h8=X({logicalXor_:ave});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wx=2147483648;function lve(t,e,n="left"){const s=L(t,"sortedSequence","searchSorted"),r=L(e,"values","searchSorted"),i=s.shape[s.shape.length-1],o=r.shape[r.shape.length-1],a=Q(s,[-1,i]),l=Q(r,[-1,o]);if(a.rank<2)throw new Error("Sorted input argument must be at least 2-dimensional");if(a.shape[0]!==l.shape[0])throw new Error("Leading dimension of 'sortedSequence' and 'values' must match.");if(le(l.shape)>=Wx)throw new Error(`values tensor size must less than ${Wx}`);if(a.shape[1]>=Wx)throw new Error(`trailing dim_size must less than ${Wx} for int32 output type, was ${a.shape[1]}`);const c={sortedSequence:a,values:l},u={side:n};return Z.runKernel(iA,c,u)}const qA=X({searchSorted_:lve});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cve(t,e){return qA(t,e,"left")}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uve(t,e,n,s,r){const i=L(t,"x","maxPool"),o=1;let a=i,l=!1;i.rank===3&&(l=!0,a=Q(i,[1,i.shape[0],i.shape[1],i.shape[2]])),O(a.rank===4,()=>`Error in maxPool: input must be rank 4 but got rank ${a.rank}.`),O(Ms(n,o),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`),cr("maxPool",s,r);const c={x:a},u={filterSize:e,strides:n,pad:s,dimRoundingMode:r},d=Z.runKernel(Q1,c,u);return l?Q(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const OS=X({maxPool_:uve});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dve(t,e=[1,1,1],n,s,r,i="NDHWC"){const o=L(t,"x","maxPool3d");let a=o,l=!1;o.rank===4&&(l=!0,a=Q(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),O(a.rank===5,()=>`Error in maxPool3d: x must be rank 5 but got rank ${a.rank}.`),O(i==="NDHWC",()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${i}`),cr("maxPool3d",s,r);const c={x:a},u={filterSize:e,strides:n,pad:s,dimRoundingMode:r,dataFormat:i},d=Z.runKernel(J1,c,u);return l?Q(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const f8=X({maxPool3d_:dve});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hve(t,e,n,s,r=!1){const o={x:L(t,"x","maxPoolWithArgmax")},a={filterSize:e,strides:n,pad:s,includeBatchInIndex:r},l=Z.runKernel(K$,o,a);return{result:l[0],indexes:l[1]}}const fve=X({maxPoolWithArgmax_:hve});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pve(t,e){let n=L(t,"a","maximum"),s=L(e,"b","maximum");[n,s]=Mn(n,s),n.dtype==="bool"&&(n=Te(n,"int32"),s=Te(s,"int32")),ct(n.shape,s.shape);const r={a:n,b:s};return Z.runKernel(Gy,r)}const Oa=X({maximum_:pve});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mve(t,e=null,n=!1){const r={x:L(t,"x","mean")},i={axis:e,keepDims:n};return Z.runKernel(eS,r,i)}const Dn=X({mean_:mve});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function es(t,e="float32"){if(e==="complex64"){const s=es(t,"float32"),r=es(t,"float32");return zc(s,r)}const n=Xs(le(t),e);return Z.makeTensor(n,t,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gi(t,e="float32"){if(e==="complex64"){const s=gi(t,"float32"),r=es(t,"float32");return zc(s,r)}const n=g$(le(t),e);return Z.makeTensor(n,t,e)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gve(t,e,{indexing:n="xy"}={}){if(n!=="xy"&&n!=="ij")throw new TypeError(`${n} is not a valid third argument to meshgrid`);if(t===void 0)return[];let s=L(t,"x","meshgrid",t instanceof Yt?t.dtype:"float32");if(e===void 0)return[s];let r=L(e,"y","meshgrid",e instanceof Yt?e.dtype:"float32");const i=le(s.shape),o=le(r.shape);return n==="xy"?(s=Q(s,[1,-1]),r=Q(r,[-1,1]),[Ct(gi([o,1],s.dtype),s),Ct(r,gi([1,i],r.dtype))]):(s=Q(s,[-1,1]),r=Q(r,[1,-1]),[Ct(s,gi([1,o],s.dtype)),Ct(gi([i,1],r.dtype),r)])}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yve(t,e){let n=L(t,"a","minimum"),s=L(e,"b","minimum");[n,s]=Mn(n,s),n.dtype==="bool"&&(n=Te(n,"int32"),s=Te(s,"int32")),ct(n.shape,s.shape);const r={a:n,b:s};return Z.runKernel(Ky,r)}const S0=X({minimum_:yve});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xve(t,e,n){O(n==="reflect"||n==="symmetric",()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${n}.`);const s=L(t,"x","mirrorPad");if(s.rank===0)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");O(e.length===s.rank,()=>`Padding doesn't match input. Must be ${s.rank}. Got ${e.length}.`);const r=n==="reflect"?1:0;for(let a=0;a<s.rank;a++)O(e[a].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),O(e[a][0]>=0&&e[a][0]<=s.shape[a]-r&&e[a][1]>=0&&e[a][1]<=s.shape[a]-r,()=>`Padding in dimension ${a} cannot be greater than or equal to ${s.shape[a]-r} or less than 0 for input of shape ${s.shape}`);const i={paddings:e,mode:n},o={x:s};return Z.runKernel(nS,o,i)}const p8=X({mirrorPad_:xve});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vve(t,e){let n=L(t,"a","mod"),s=L(e,"b","mod");[n,s]=Mn(n,s);const r={a:n,b:s};return Z.runKernel(qy,r)}const m8=X({mod_:vve});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bve(t,e=null,n=!1){t=L(t,"x","moments");const s=bt(e,t.shape),r=Dn(t,s,n);let i=r.shape;n||(i=Hn(r.shape,s));const o=Zt(Ae(Te(t,"float32"),Q(r,i))),a=Dn(o,s,n);return{mean:r,variance:a}}const PS=X({moments_:bve});function wve(t,e,n,s){const r=L(e,"data","multiRNNCell"),i=Jb(n,"c","multiRNNCell"),o=Jb(s,"h","multiRNNCell");let a=r;const l=[];for(let d=0;d<t.length;d++){const h=t[d](a,i[d],o[d]);l.push(h[0]),l.push(h[1]),a=h[1]}const c=[],u=[];for(let d=0;d<l.length;d+=2)c.push(l[d]),u.push(l[d+1]);return[c,u]}const Sve=X({multiRNNCell_:wve});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kve(t,e,n,s=!1){const r=L(t,"logits","multinomial"),i=r.size,o=r.rank;if(i<2)throw new Error(`Error in multinomial: you need at least 2 outcomes, but got ${i}.`);if(o>2)throw new Error(`Rank of probabilities must be 1 or 2, but is ${o}`);n=n||Math.random();const l={logits:o===1?Q(r,[1,-1]):r},c={numSamples:e,seed:n,normalized:s},u=Z.runKernel(q$,l,c);return o===1?Q(u,[u.size]):u}const Cve=X({multinomial_:kve});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tve(t,e){let n=L(t,"a","notEqual","string_or_numeric"),s=L(e,"b","notEqual","string_or_numeric");[n,s]=Mn(n,s),ct(n.shape,s.shape);const r={a:n,b:s};return Z.runKernel(rS,r)}const Pf=X({notEqual_:Tve});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nve(t){const n={x:L(t,"x","onesLike")};return Z.runKernel(iS,n)}const Ni=X({onesLike_:Nve});function Ive(t,e){const n=L(t,"v1","outerProduct"),s=L(e,"v2","outerProduct");O(n.rank===1&&s.rank===1,()=>`Error in outerProduct: inputs must be rank 1, but got ranks ${n.rank} and ${s.rank}.`);const r=Q(n,[-1,1]),i=Q(s,[1,-1]);return Ct(r,i)}const _ve=X({outerProduct_:Ive});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Eve(t,e,n=0){const s=L(t,"x","pad");if(s.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const r={paddings:e,constantValue:n},i={x:s};return Z.runKernel(lS,i,r)}const $a=X({pad_:Eve});function $ve(t,e,n=0){return O(e.length===2,()=>"Invalid number of paddings. Must be length of 2."),$a(t,[e],n)}const Ave=X({pad1d_:$ve});function Rve(t,e,n=0){return O(e.length===2&&e[0].length===2&&e[1].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),$a(t,e,n)}const Dve=X({pad2d_:Rve});function Ove(t,e,n=0){return O(e.length===3&&e[0].length===2&&e[1].length===2&&e[2].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),$a(t,e,n)}const Pve=X({pad3d_:Ove});function Fve(t,e,n=0){return O(e.length===4&&e[0].length===2&&e[1].length===2&&e[2].length===2&&e[3].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),$a(t,e,n)}const Lve=X({pad4d_:Fve});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mve(t,e,n){const s=L(t,"x","spaceToBatchND");O(s.rank>=1+e.length,()=>`input rank ${s.rank} should be > than [blockShape] ${e.length}`),O(n.length===e.length,()=>`paddings.shape[0] ${n.length} must be equal to [blockShape] ${e.length}`),O(s.shape.reduce((o,a,l)=>l>0&&l<=e.length?o&&(a+n[l-1][0]+n[l-1][1])%e[l-1]===0:o,!0),()=>`input spatial dimensions ${s.shape.slice(1)} with paddings ${n.toString()} must be divisible by blockShapes ${e.toString()}`);const r={x:s},i={blockShape:e,paddings:n};return Z.runKernel(xS,r,i)}const FS=X({spaceToBatchND_:Mve});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zve(t,e,n,s,r,i,o){r==null&&(r=[1,1]),i==null&&(i=1),s===0&&(s="valid");const a=L(t,"x","maxPool");let l=a,c=!1;a.rank===3&&(c=!0,l=Q(a,[1,a.shape[0],a.shape[1],a.shape[2]])),O(Ms(i,r),()=>`Error in pool: Either strides or dilations must be 1. Got strides ${i} and dilations '${r}'`);const u=uo(l.shape,e,i,r,s),d=[u.dilationHeight,u.dilationWidth];let h;s==="same"?h=jve([u.filterHeight,u.filterWidth],d):h=[[0,0],[0,0]];const f=d[0]===1&&d[1]===1,[p,m]=Vve([u.inHeight,u.inWidth],d,h),g=f?s:"valid",y=f?l:FS(l,d,p),v=(n==="avg"?()=>_S(y,e,i,g,o):()=>OS(y,e,i,g,o))(),b=f?v:ES(v,d,m);return c?Q(b,[b.shape[1],b.shape[2],b.shape[3]]):b}function Vve(t,e,n){const s=n.map(u=>u[0]),r=n.map(u=>u[1]),i=t.concat(s,r),o=e.map((u,d)=>(u-i[d]%u)%u),a=r.map((u,d)=>u+o[d]),l=e.map((u,d)=>[s[d],a[d]]),c=e.map((u,d)=>[0,o[d]]);return[l,c]}function jve(t,e){const s=t.map((o,a)=>o+(o-1)*(e[a]-1)).map(o=>o-1),r=s.map(o=>Math.floor(o/2)),i=s.map((o,a)=>o-r[a]);return s.map((o,a)=>[r[a],i[a]])}const g8=X({pool_:zve});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bve(t,e){const n=L(t,"x","prelu"),s=L(e,"alpha","prelu"),r={x:n,alpha:s};return Z.runKernel(cS,r)}const LS=X({prelu_:Bve});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wve(t,e=null,n=!1){let s=L(t,"x","prod");s.dtype==="bool"&&(s=Te(s,"int32"));const r={x:s},i={axis:e,keepDims:n};return Z.runKernel(uS,r,i)}const y8=X({prod_:Wve});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uve(t,e,n,s){const r=t.map((u,d)=>L(u,`tensors${d}`,"raggedGather","int32")),i=L(e,"paramsDenseValues","raggedGather"),o=L(n,"indices","raggedGather","int32"),a={paramsNestedSplits:r,paramsDenseValues:i,indices:o},l={outputRaggedRank:s},c=Z.runKernel(Q$,a,l);return{outputNestedSplits:c.slice(0,c.length-1),outputDenseValues:c[c.length-1]}}const Hve=X({raggedGather_:Uve});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gve(t,e,n,s,r){const i=L(t,"shape","raggedTensorToTensor","int32"),o=L(e,"values","raggedTensorToTensor"),a=L(n,"defaultValue","raggedTensorToTensor",o.dtype),l=s.map((d,h)=>L(d,`tensors${h}`,"raggedTensorToTensor","int32")),c={shape:i,values:o,defaultValue:a,rowPartitionTensors:l},u={rowPartitionTypes:r};return Z.runKernel(J$,c,u)}const Kve=X({raggedTensorToTensor_:Gve});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qve(t,e,n){const s=le(t);let r=null;if(n==null||n==="float32")r=new Float32Array(s);else if(n==="int32")r=new Int32Array(s);else if(n==="bool")r=new Uint8Array(s);else throw new Error(`Unknown data type ${n}`);for(let i=0;i<s;i++)r[i]=e();return Z.makeTensor(r,t,n)}const Xve=X({rand_:qve});var XA={exports:{}};XA.exports;(function(t){(function(e,n,s){function r(l){var c=this,u=a();c.next=function(){var d=2091639*c.s0+c.c*23283064365386963e-26;return c.s0=c.s1,c.s1=c.s2,c.s2=d-(c.c=d|0)},c.c=1,c.s0=u(" "),c.s1=u(" "),c.s2=u(" "),c.s0-=u(l),c.s0<0&&(c.s0+=1),c.s1-=u(l),c.s1<0&&(c.s1+=1),c.s2-=u(l),c.s2<0&&(c.s2+=1),u=null}function i(l,c){return c.c=l.c,c.s0=l.s0,c.s1=l.s1,c.s2=l.s2,c}function o(l,c){var u=new r(l),d=c&&c.state,h=u.next;return h.int32=function(){return u.next()*4294967296|0},h.double=function(){return h()+(h()*2097152|0)*11102230246251565e-32},h.quick=h,d&&(typeof d=="object"&&i(d,u),h.state=function(){return i(u,{})}),h}function a(){var l=4022871197,c=function(u){u=String(u);for(var d=0;d<u.length;d++){l+=u.charCodeAt(d);var h=.02519603282416938*l;l=h>>>0,h-=l,h*=l,l=h>>>0,h-=l,l+=h*4294967296}return(l>>>0)*23283064365386963e-26};return c}n&&n.exports?n.exports=o:s&&s.amd?s(function(){return o}):this.alea=o})($o,t,!1)})(XA);var Yve=XA.exports,YA={exports:{}};YA.exports;(function(t){(function(e,n,s){function r(a){var l=this,c="";l.x=0,l.y=0,l.z=0,l.w=0,l.next=function(){var d=l.x^l.x<<11;return l.x=l.y,l.y=l.z,l.z=l.w,l.w^=l.w>>>19^d^d>>>8},a===(a|0)?l.x=a:c+=a;for(var u=0;u<c.length+64;u++)l.x^=c.charCodeAt(u)|0,l.next()}function i(a,l){return l.x=a.x,l.y=a.y,l.z=a.z,l.w=a.w,l}function o(a,l){var c=new r(a),u=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var h=c.next()>>>11,f=(c.next()>>>0)/4294967296,p=(h+f)/(1<<21);while(p===0);return p},d.int32=c.next,d.quick=d,u&&(typeof u=="object"&&i(u,c),d.state=function(){return i(c,{})}),d}n&&n.exports?n.exports=o:s&&s.amd?s(function(){return o}):this.xor128=o})($o,t,!1)})(YA);var Zve=YA.exports,ZA={exports:{}};ZA.exports;(function(t){(function(e,n,s){function r(a){var l=this,c="";l.next=function(){var d=l.x^l.x>>>2;return l.x=l.y,l.y=l.z,l.z=l.w,l.w=l.v,(l.d=l.d+362437|0)+(l.v=l.v^l.v<<4^(d^d<<1))|0},l.x=0,l.y=0,l.z=0,l.w=0,l.v=0,a===(a|0)?l.x=a:c+=a;for(var u=0;u<c.length+64;u++)l.x^=c.charCodeAt(u)|0,u==c.length&&(l.d=l.x<<10^l.x>>>4),l.next()}function i(a,l){return l.x=a.x,l.y=a.y,l.z=a.z,l.w=a.w,l.v=a.v,l.d=a.d,l}function o(a,l){var c=new r(a),u=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var h=c.next()>>>11,f=(c.next()>>>0)/4294967296,p=(h+f)/(1<<21);while(p===0);return p},d.int32=c.next,d.quick=d,u&&(typeof u=="object"&&i(u,c),d.state=function(){return i(c,{})}),d}n&&n.exports?n.exports=o:s&&s.amd?s(function(){return o}):this.xorwow=o})($o,t,!1)})(ZA);var Qve=ZA.exports,QA={exports:{}};QA.exports;(function(t){(function(e,n,s){function r(a){var l=this;l.next=function(){var u=l.x,d=l.i,h,f;return h=u[d],h^=h>>>7,f=h^h<<24,h=u[d+1&7],f^=h^h>>>10,h=u[d+3&7],f^=h^h>>>3,h=u[d+4&7],f^=h^h<<7,h=u[d+7&7],h=h^h<<13,f^=h^h<<9,u[d]=f,l.i=d+1&7,f};function c(u,d){var h,f=[];if(d===(d|0))f[0]=d;else for(d=""+d,h=0;h<d.length;++h)f[h&7]=f[h&7]<<15^d.charCodeAt(h)+f[h+1&7]<<13;for(;f.length<8;)f.push(0);for(h=0;h<8&&f[h]===0;++h);for(h==8?f[7]=-1:f[h],u.x=f,u.i=0,h=256;h>0;--h)u.next()}c(l,a)}function i(a,l){return l.x=a.x.slice(),l.i=a.i,l}function o(a,l){a==null&&(a=+new Date);var c=new r(a),u=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var h=c.next()>>>11,f=(c.next()>>>0)/4294967296,p=(h+f)/(1<<21);while(p===0);return p},d.int32=c.next,d.quick=d,u&&(u.x&&i(u,c),d.state=function(){return i(c,{})}),d}n&&n.exports?n.exports=o:s&&s.amd?s(function(){return o}):this.xorshift7=o})($o,t,!1)})(QA);var Jve=QA.exports,JA={exports:{}};JA.exports;(function(t){(function(e,n,s){function r(a){var l=this;l.next=function(){var u=l.w,d=l.X,h=l.i,f,p;return l.w=u=u+1640531527|0,p=d[h+34&127],f=d[h=h+1&127],p^=p<<13,f^=f<<17,p^=p>>>15,f^=f>>>12,p=d[h]=p^f,l.i=h,p+(u^u>>>16)|0};function c(u,d){var h,f,p,m,g,y=[],x=128;for(d===(d|0)?(f=d,d=null):(d=d+"\0",f=0,x=Math.max(x,d.length)),p=0,m=-32;m<x;++m)d&&(f^=d.charCodeAt((m+32)%d.length)),m===0&&(g=f),f^=f<<10,f^=f>>>15,f^=f<<4,f^=f>>>13,m>=0&&(g=g+1640531527|0,h=y[m&127]^=f+g,p=h==0?p+1:0);for(p>=128&&(y[(d&&d.length||0)&127]=-1),p=127,m=4*128;m>0;--m)f=y[p+34&127],h=y[p=p+1&127],f^=f<<13,h^=h<<17,f^=f>>>15,h^=h>>>12,y[p]=f^h;u.w=g,u.X=y,u.i=p}c(l,a)}function i(a,l){return l.i=a.i,l.w=a.w,l.X=a.X.slice(),l}function o(a,l){a==null&&(a=+new Date);var c=new r(a),u=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var h=c.next()>>>11,f=(c.next()>>>0)/4294967296,p=(h+f)/(1<<21);while(p===0);return p},d.int32=c.next,d.quick=d,u&&(u.X&&i(u,c),d.state=function(){return i(c,{})}),d}n&&n.exports?n.exports=o:s&&s.amd?s(function(){return o}):this.xor4096=o})($o,t,!1)})(JA);var ebe=JA.exports,eR={exports:{}};eR.exports;(function(t){(function(e,n,s){function r(a){var l=this,c="";l.next=function(){var d=l.b,h=l.c,f=l.d,p=l.a;return d=d<<25^d>>>7^h,h=h-f|0,f=f<<24^f>>>8^p,p=p-d|0,l.b=d=d<<20^d>>>12^h,l.c=h=h-f|0,l.d=f<<16^h>>>16^p,l.a=p-d|0},l.a=0,l.b=0,l.c=-1640531527,l.d=1367130551,a===Math.floor(a)?(l.a=a/4294967296|0,l.b=a|0):c+=a;for(var u=0;u<c.length+20;u++)l.b^=c.charCodeAt(u)|0,l.next()}function i(a,l){return l.a=a.a,l.b=a.b,l.c=a.c,l.d=a.d,l}function o(a,l){var c=new r(a),u=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var h=c.next()>>>11,f=(c.next()>>>0)/4294967296,p=(h+f)/(1<<21);while(p===0);return p},d.int32=c.next,d.quick=d,u&&(typeof u=="object"&&i(u,c),d.state=function(){return i(c,{})}),d}n&&n.exports?n.exports=o:s&&s.amd?s(function(){return o}):this.tychei=o})($o,t,!1)})(eR);var tbe=eR.exports,x8={exports:{}};const nbe={},sbe=Object.freeze(Object.defineProperty({__proto__:null,default:nbe},Symbol.toStringTag,{value:"Module"})),rbe=xY(sbe);(function(t){(function(e,n,s){var r=256,i=6,o=52,a="random",l=s.pow(r,i),c=s.pow(2,o),u=c*2,d=r-1,h;function f(b,k,C){var N=[];k=k==!0?{entropy:!0}:k||{};var I=y(g(k.entropy?[b,v(n)]:b??x(),3),N),$=new p(N),A=function(){for(var P=$.g(i),F=l,V=0;P<c;)P=(P+V)*r,F*=r,V=$.g(1);for(;P>=u;)P/=2,F/=2,V>>>=1;return(P+V)/F};return A.int32=function(){return $.g(4)|0},A.quick=function(){return $.g(4)/4294967296},A.double=A,y(v($.S),n),(k.pass||C||function(P,F,V,z){return z&&(z.S&&m(z,$),P.state=function(){return m($,{})}),V?(s[a]=P,F):P})(A,I,"global"in k?k.global:this==s,k.state)}function p(b){var k,C=b.length,N=this,I=0,$=N.i=N.j=0,A=N.S=[];for(C||(b=[C++]);I<r;)A[I]=I++;for(I=0;I<r;I++)A[I]=A[$=d&$+b[I%C]+(k=A[I])],A[$]=k;(N.g=function(P){for(var F,V=0,z=N.i,B=N.j,W=N.S;P--;)F=W[z=d&z+1],V=V*r+W[d&(W[z]=W[B=d&B+F])+(W[B]=F)];return N.i=z,N.j=B,V})(r)}function m(b,k){return k.i=b.i,k.j=b.j,k.S=b.S.slice(),k}function g(b,k){var C=[],N=typeof b,I;if(k&&N=="object")for(I in b)try{C.push(g(b[I],k-1))}catch{}return C.length?C:N=="string"?b:b+"\0"}function y(b,k){for(var C=b+"",N,I=0;I<C.length;)k[d&I]=d&(N^=k[d&I]*19)+C.charCodeAt(I++);return v(k)}function x(){try{var b;return h&&(b=h.randomBytes)?b=b(r):(b=new Uint8Array(r),(e.crypto||e.msCrypto).getRandomValues(b)),v(b)}catch{var k=e.navigator,C=k&&k.plugins;return[+new Date,e,C,e.screen,v(n)]}}function v(b){return String.fromCharCode.apply(0,b)}if(y(s.random(),n),t.exports){t.exports=f;try{h=rbe}catch{}}else s["seed"+a]=f})(typeof self<"u"?self:$o,[],Math)})(x8);var ibe=x8.exports,obe=Yve,abe=Zve,lbe=Qve,cbe=Jve,ube=ebe,dbe=tbe,Vd=ibe;Vd.alea=obe;Vd.xor128=abe;Vd.xorwow=lbe;Vd.xorshift7=cbe;Vd.xor4096=ube;Vd.tychei=dbe;var MS=Vd;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tR{constructor(e,n,s,r,i){this.mean=e,this.stdDev=n,this.dtype=s,this.nextVal=NaN,this.truncated=r,this.truncated&&(this.upper=this.mean+this.stdDev*2,this.lower=this.mean-this.stdDev*2);const o=i||Math.random();this.random=MS.alea(o.toString())}nextValue(){if(!isNaN(this.nextVal)){const r=this.nextVal;return this.nextVal=NaN,r}let e,n,s=!1;for(;!s;){let r,i,o;do r=2*this.random()-1,i=2*this.random()-1,o=r*r+i*i;while(o>=1||o===0);const a=Math.sqrt(-2*Math.log(o)/o);e=this.mean+this.stdDev*r*a,n=this.mean+this.stdDev*i*a,(!this.truncated||this.isValidTruncated(e))&&(s=!0)}return(!this.truncated||this.isValidTruncated(n))&&(this.nextVal=this.convertValue(n)),this.convertValue(e)}convertValue(e){return this.dtype==null||this.dtype==="float32"?e:Math.round(e)}isValidTruncated(e){return e<=this.upper&&e>=this.lower}}class hbe{constructor(e,n,s,r){this.alpha=e,this.beta=1/n,this.dtype=s;const i=r||Math.random();this.randu=MS.alea(i.toString()),this.randn=new tR(0,1,s,!1,this.randu()),e<1?this.d=e+2/3:this.d=e-1/3,this.c=1/Math.sqrt(9*this.d)}nextValue(){let e,n,s,r,i,o;for(;;){do r=this.randn.nextValue(),o=1+this.c*r;while(o<=0);if(o*=o*o,e=r*r,n=1-.331*e*e,s=.5*e+this.d*(1-o+Math.log(o)),i=this.randu(),i<n||Math.log(i)<s)break}return o=1/this.beta*this.d*o,this.alpha<1&&(o*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(o)}convertValue(e){return this.dtype==="float32"?e:Math.round(e)}}class fbe{constructor(e=0,n=1,s,r){if(this.canReturnFloat=()=>this.dtype==null||this.dtype==="float32",this.min=e,this.range=n-e,this.dtype=s,r==null&&(r=Math.random()),typeof r=="number"&&(r=r.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${e} - ${n} <= 1 and dtype is not float`);this.random=MS.alea(r)}convertValue(e){return this.canReturnFloat()?e:Math.round(e)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pbe(t,e,n=1,s="float32",r){if(n==null&&(n=1),s==null&&(s="float32"),s!=="float32"&&s!=="int32")throw new Error(`Unsupported data type ${s}`);const i=new hbe(e,n,s,r),o=gt(t,s);for(let a=0;a<o.values.length;a++)o.values[a]=i.nextValue();return o.toTensor()}const mbe=X({randomGamma_:pbe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gbe(t,e=0,n=1,s,r){if(s!=null&&s==="bool")throw new Error(`Unsupported data type ${s}`);const i=new tR(e,n,s,!1,r),o=gt(t,s);for(let a=0;a<o.values.length;a++)o.values[a]=i.nextValue();return o.toTensor()}const nR=X({randomNormal_:gbe});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ybe(t,e,n){if(e!=null&&e==="bool")throw new Error(`Unsupported data type ${e}`);return nR(t,0,1,e,n)}const xbe=X({randomStandardNormal_:ybe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vbe(t,e=0,n=1,s="float32",r){const i=gt(t,s),o=new fbe(e,n,null,r);for(let a=0;a<i.values.length;a++)i.values[a]=o.nextValue();return i.toTensor()}const k0=X({randomUniform_:vbe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ig(t,e,n=1,s="float32"){if(n===0)throw new Error("Cannot have a step of zero");const r={start:t,stop:e,step:n,dtype:s};return Z.runKernel(eA,{},r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bbe(t){const n={x:L(t,"x","reciprocal")};return Z.runKernel(Zy,n)}const v8=X({reciprocal_:bbe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wbe(t){const n={x:L(t,"x","relu")};return Z.runKernel(Qy,n)}const Pa=X({relu_:wbe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sbe(t){const n={x:L(t,"x","relu6")};return Z.runKernel(Jy,n)}const sR=X({relu6_:Sbe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kbe(t,e){const s={x:L(t,"x","reverse")},r={dims:e};return Z.runKernel(pS,s,r)}const ao=X({reverse_:kbe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cbe(t){const e=L(t,"x","reverse");return O(e.rank===1,()=>`Error in reverse1D: x must be rank 1 but got rank ${e.rank}.`),ao(e,0)}const Tbe=X({reverse1d_:Cbe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nbe(t,e){const n=L(t,"x","reverse");return O(n.rank===2,()=>`Error in reverse2D: x must be rank 2 but got rank ${n.rank}.`),ao(n,e)}const Ibe=X({reverse2d_:Nbe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _be(t,e){const n=L(t,"x","reverse");return O(n.rank===3,()=>`Error in reverse3D: x must be rank 3 but got rank ${n.rank}.`),ao(n,e)}const Ebe=X({reverse3d_:_be});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $be(t,e){const n=L(t,"x","reverse");return O(n.rank===4,()=>`Error in reverse4D: x must be rank 4 but got rank ${n.rank}.`),ao(n,e)}const Abe=X({reverse4d_:$be});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rbe(t){const n={x:L(t,"x","round")};return Z.runKernel(e0,n)}const rR=X({round_:Rbe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dbe(t){const n={x:L(t,"x","rsqrt","float32")};return Z.runKernel(t0,n)}const iR=X({rsqrt_:Dbe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Obe(t){const n={x:L(t,"x","selu")};return Z.runKernel(n0,n)}const oR=X({selu_:Obe});function Pbe(t,e,n,s,r,i=[1,1],o="NHWC"){const a=L(t,"x","separableConv2d"),l=L(e,"depthwiseFilter","separableConv2d"),c=L(n,"pointwiseFilter","separableConv2d");let u=a,d=!1;if(a.rank===3&&(d=!0,u=Q(a,[1,a.shape[0],a.shape[1],a.shape[2]])),o==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");O(u.rank===4,()=>`Error in separableConv2d: input must be rank 4, but got rank ${u.rank}.`),O(l.rank===4,()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${l.rank}.`),O(c.rank===4,()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${l.rank}.`),O(c.shape[0]===1,()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${c.shape[0]}.`),O(c.shape[1]===1,()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${c.shape[1]}.`);const h=l.shape[2],f=l.shape[3];O(c.shape[2]===h*f,()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${h*f}, but got ${c.shape[2]}.`);const p=v0(u,l,s,r,o,i),g=jc(p,c,1,"valid",o);return d?Q(g,[g.shape[1],g.shape[2],g.shape[3]]):g}const aR=X({separableConv2d_:Pbe});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function Fbe(t,e){const n=L(t,"x","setdiff1d"),s=L(e,"y","setdiff1d");O(n.dtype===s.dtype,()=>`x and y should have the same dtype, but got x (${n.dtype}) and y (${s.dtype}).`),O(n.rank===1,()=>`x should be 1D tensor, but got x (${n.shape}).`),O(s.rank===1,()=>`y should be 1D tensor, but got y (${s.shape}).`);const r=await n.data(),i=await s.data(),o=new Set(i);let a=0;for(let u=0;u<r.length;u++)o.has(r[u])||a++;const l=new ks([a],n.dtype),c=new ks([a],"int32");for(let u=0,d=0;u<r.length;u++)o.has(r[u])||(l.values[d]=r[u],c.values[d]=u,d++);return[l.toTensor(),c.toTensor()]}const Lbe=Fbe;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mbe(t){const n={x:L(t,"x","sign")};return Z.runKernel(i0,n)}const b8=X({sign_:Mbe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zbe(t){const n={x:L(t,"x","sin","float32")};return Z.runKernel(s0,n)}const lR=X({sin_:zbe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vbe(t){const n={x:L(t,"x","sinh")};return Z.runKernel(r0,n)}const cR=X({sinh_:Vbe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jbe(t,e,n){const s=L(t,"x","slice1d");return O(s.rank===1,()=>`slice1d expects a rank-1 tensor, but got a rank-${s.rank} tensor`),st(s,[e],[n])}const zS=X({slice1d_:jbe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bbe(t,e,n){const s=L(t,"x","slice2d");return O(s.rank===2,()=>`slice2d expects a rank-2 tensor, but got a rank-${s.rank} tensor`),st(s,e,n)}const uR=X({slice2d_:Bbe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wbe(t,e,n){const s=L(t,"x","slice3d");return O(s.rank===3,()=>`slice3d expects a rank-3 tensor, but got a rank-${s.rank} tensor`),st(s,e,n)}const VS=X({slice3d_:Wbe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ube(t,e,n){const s=L(t,"x","slice4d");return O(s.rank===4,()=>`slice4d expects a rank-4 tensor, but got a rank-${s.rank} tensor`),st(s,e,n)}const _g=X({slice4d_:Ube});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hbe(t,e=-1){const n=L(t,"logits","softmax","float32");if(e===-1&&(e=n.rank-1),e!==n.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and dim was ${e}`);const s={logits:n},r={dim:e};return Z.runKernel(bS,s,r)}const jS=X({softmax_:Hbe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gbe(t){O(t.dtype==="complex64",()=>`The dtype for tf.spectral.fft() must be complex64 but got ${t.dtype}.`);const e={input:t};return Z.runKernel(L$,e)}const BS=X({fft_:Gbe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kbe(t){O(t.dtype==="complex64",()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${t.dtype}.`);const e={input:t};return Z.runKernel(j$,e)}const Eg=X({ifft_:Kbe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qbe(t){const e=t.shape[t.shape.length-1],n=t.size/e;let s;if(e<=2){const r=Q(t,[n,e]);s=Eg(r)}else{const r=[n,2*(e-1)],i=Q(Ng(t),[n,e]),o=Q(NS(t),[n,e]),a=ao(st(i,[0,1],[n,e-2]),1),l=Y(ao(st(o,[0,1],[n,e-2]),1),Ge(-1)),c=Cn([i,a],1),u=Cn([o,l],1),d=Q(zc(c,u),[r[0],r[1]]);s=Eg(d)}if(s=Ng(s),t.rank===3&&t.shape[0]!==0){const r=s,i=t.shape[0];s=Q(s,[i,s.shape[0]/i,s.shape[1]]),r.dispose()}return s}const dR=X({irfft_:qbe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xbe(t,e,n=0){const r={x:L(t,"x","split")},i={numOrSizeSplits:e,axis:n};return Z.runKernel(vS,r,i)}const Yr=X({split_:Xbe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ybe(t,e){O(t.dtype==="float32",()=>`The dtype for rfft() must be real value but got ${t.dtype}`);let n=t.shape[t.shape.length-1];const s=t.size/n;let r;if(e!=null&&e<n){const p=t.shape.map(g=>0),m=t.shape.map(g=>g);m[t.shape.length-1]=e,r=st(t,p,m),n=e}else if(e!=null&&e>n){const p=t.shape.map(m=>m);p[t.shape.length-1]=e-n,r=Cn([t,es(p)],t.shape.length-1),n=e}else r=t;const i=_t(r),o=Q(zc(r,i),[s,n]),a=BS(o),l=Math.floor(n/2)+1,c=Ng(a),u=NS(a),d=Yr(c,[l,n-l],c.shape.length-1),h=Yr(u,[l,n-l],u.shape.length-1),f=r.shape.slice();return f[r.shape.length-1]=l,Q(zc(d[0],h[0]),f)}const WS=X({rfft_:Ybe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zbe(t,e){let n=L(t,"a","squaredDifference"),s=L(e,"b","squaredDifference");[n,s]=Mn(n,s),ct(n.shape,s.shape);const r={a:n,b:s},i={};return Z.runKernel(c0,r,i)}const hR=X({squaredDifference_:Zbe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qbe(t,e){const n=L(t,"x","squeeze","string_or_numeric");return Q(n,eu(n.shape,e).newShape)}const Bt=X({squeeze_:Qbe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jbe(t,e=0){const n=Jb(t,"tensors","stack","string_or_numeric");O(n.length>=1,()=>"Pass at least one tensor to tf.stack"),n.length>0&&O(e<=n[0].rank,()=>"Axis must be <= rank of the tensor");const s=n,r={axis:e};return Z.runKernel(aS,s,r)}const lo=X({stack_:Jbe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ewe(t,e=0){const s={x:L(t,"x","step")},r={alpha:e};return Z.runKernel(p0,s,r)}const cp=X({step_:ewe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function twe(t,e,n,s,r=0,i=0,o=0,a=0,l=0){const u={x:L(t,"x","stridedSlice","string_or_numeric")},d={begin:e,end:n,strides:s,beginMask:r,endMask:i,ellipsisMask:o,newAxisMask:a,shrinkAxisMask:l};return Z.runKernel(hA,u,d)}const w8=X({stridedSlice_:twe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nwe(t){const n={x:L(t,"x","tan","float32")};return Z.runKernel(d0,n)}const S8=X({tan_:nwe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cs(t,e){sp(t);const n=nu(t,e);if(n.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return su(t,null,n,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cl(t,e,n){if(sp(t),e!=null&&e.length!==2)throw new Error("tensor2d() requires shape to have two numbers");const s=nu(t,n);if(s.length!==2&&s.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(s.length===1&&e==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return su(t,e,s,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function swe(t,e,n){if(sp(t),e!=null&&e.length!==4)throw new Error("tensor4d() requires shape to have four numbers");const s=nu(t,n);if(s.length!==4&&s.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(s.length===1&&e==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return su(t,e,s,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rwe(t,e,n){if(sp(t),e!=null&&e.length!==5)throw new Error("tensor5d() requires shape to have five numbers");const s=nu(t,n);if(s.length!==5&&s.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(s.length===1&&e==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return su(t,e,s,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iwe(t,e,n){if(sp(t),e!=null&&e.length!==6)throw new Error("tensor6d() requires shape to have six numbers");const s=nu(t,n);if(s.length!==6&&s.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(s.length===1&&e==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return e=e||s,su(t,e,s,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function owe(t,e=1,n=!0){const s=L(t,"x","topk");if(s.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");const r=s.shape[s.shape.length-1];if(e<0)throw new Error(`'k' passed to topk() must be >= 0 but got ${e}`);if(e>r)throw new Error(`'k' passed to topk() must be <= the last dimension (${r}) but got ${e}`);const i={x:s},o={k:e,sorted:n},[a,l]=Z.runKernel(gA,i,o);return{values:a,indices:l}}const k8=X({topk_:owe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function awe(t,e=0,n=1,s,r){if(s!=null&&s==="bool")throw new Error("Unsupported data type $ { dtype }");const i=new tR(e,n,s,!0,r),o=gt(t,s);for(let a=0;a<o.values.length;a++)o.values[a]=i.nextValue();return o.toTensor()}const fR=X({truncatedNormal_:awe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lwe(t,e=0){const n=L(t,"x","unique","string_or_numeric");O(n.rank>0,()=>"The input tensor must be at least 1D");const s={x:n},r={axis:e},[i,o]=Z.runKernel(xA,s,r);return{values:i,indices:o}}const C8=X({unique_:lwe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cwe(t,e,n){const s=L(t,"x","unsortedSegmentSum"),r=L(e,"segmentIds","unsortedSegmentSum","int32");O(Ef(n),()=>"numSegments must be of dtype int");const i={x:s,segmentIds:r},o={numSegments:n};return Z.runKernel(SS,i,o)}const pR=X({unsortedSegmentSum_:cwe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uwe(t,e=0){const n=L(t,"x","unstack","string_or_numeric");O(e>=-n.shape.length&&e<n.shape.length,()=>`Axis = ${e} is not in [-${n.shape.length}, ${n.shape.length})`);const s={value:n},r={axis:e};return Z.runKernel(wS,s,r)}const zo=X({unstack_:uwe});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dwe(t,e){return qA(t,e,"right")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T8(t,e=!0,n,s){return Z.makeVariable(t,e,n,s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mR(t,e){const n=[];for(let i=0;i<e.length;i++)e[i]&&n.push(i);const s=gt(t,"int32"),r=gt([n.length,t.length],"int32");for(let i=0;i<n.length;i++){const o=s.indexToLoc(n[i]),a=i*t.length;r.values.set(o,a)}return r.toTensor()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function hwe(t){const e=L(t,"condition","whereAsync","bool"),n=await e.data(),s=mR(e.shape,n);return t!==e&&e.dispose(),s}const N8=hwe;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function fwe(t,e,n){const s=L(t,"tensor","boolMask"),r=L(e,"mask","boolMask","bool"),i=n??0,o=r.rank,a=s.shape;O(o>0,()=>"mask cannot be scalar"),ni(a.slice(i,i+o),r.shape,"mask's shape must match the first K dimensions of tensor's shape,");let l=1;for(let m=i;m<i+o;m++)l*=a[m];const c=a.slice(0,i).concat([l],a.slice(i+o)),u=Q(s,c),d=Q(r,[-1]),h=await N8(d),f=Bt(h,[1]),p=Tc(u,f,i);return t!==s&&s.dispose(),e!==r&&r.dispose(),f.dispose(),u.dispose(),d.dispose(),h.dispose(),p}const pwe=fwe;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mwe(t,e,n,s,r=!0){const i=L(t,"v","movingAverage"),o=L(e,"x","movingAverage"),a=L(n,"decay","movingAverage");qge(i,o),O(Et(i.shape,o.shape),()=>"Shape mismatch in v and x");const l=Ge(1),c=Ae(l,a);let u=Y(Ae(o,i),c);if(r){O(s!=null,()=>"When using zeroDebias: true, step is required.");const d=L(s,"step","movingAverage");u=$e(u,Ae(l,Bc(a,d)))}return fe(i,u)}const gwe=X({movingAverage_:mwe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ywe(t,e,n){const s=L(t,"indices","scatterND","int32"),r=L(e,"updates","scatterND");SG(r,s,n);const i={indices:s,updates:r},o={shape:n};return Z.runKernel(rA,i,o)}const xwe=X({scatterND_:ywe});function vwe(t,e,n,s){if(t.dtype!=="int32")throw new Error(`tf.sparseToDense() expects the indices to be int32 type, but the dtype was ${t.dtype}.`);if(t.rank>2)throw new Error(`sparseIndices should be a scalar, vector, or matrix, but got shape ${t.shape}.`);const r=t.rank>0?t.shape[0]:1,i=t.rank>1?t.shape[1]:1;if(n.length!==i)throw new Error(`outputShape has incorrect number of elements:, ${n.length}, should be: ${i}.`);const o=e.size;if(!(e.rank===0||e.rank===1&&o===r))throw new Error(`sparseValues has incorrect shape ${e.shape}, should be [] or [${r}]`);if(e.dtype!==s.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bwe(t,e,n,s=0){const r=L(t,"sparseIndices","sparseToDense","int32"),i=L(e,"sparseValues","sparseToDense","string_or_numeric"),o=L(s,"defaultValue","sparseToDense",i.dtype);vwe(r,i,n,o);const a={sparseIndices:r,sparseValues:i,defaultValue:o},l={outputShape:n};return Z.runKernel(uA,a,l)}const wwe=X({sparseToDense_:bwe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Swe(t,e){const n=L(e,"indices","gatherND","int32"),r={params:L(t,"x","gatherND","string_or_numeric"),indices:n};return Z.runKernel(V$,r)}const kwe=X({gatherND_:Swe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cwe(t,e){if(e==null)return t.shape.slice();if(Et(t.shape,e))return e;if(t.shape.length===e.length){const n=[];for(let s=0;s<t.shape.length;s++)e[s]==null&&t.shape[s]!=null?n.push(t.shape[s]):n.push(e[s]);return n}return e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Twe(t,e,n,s){const r=L(t,"x","dropout");if(O(r.dtype==="float32",()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${r.dtype} tensor instead.`),O(e>=0&&e<1,()=>`rate must be a float in the range [0, 1), but got ${e}.`),e===0)return t instanceof Yt?r.clone():r;const i=Cwe(r,n),o=1-e,a=$e(w0(fe(k0(i,0,1,"float32",s),o)),o);return Y(r,a)}const I8=X({dropout_:Twe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _8(t){return Math.floor(Math.pow(2,Math.ceil(Math.log(t)/Math.log(2))))}function gR(t,e,n){const s=1-t%2,r=new Float32Array(t);for(let i=0;i<t;++i){const o=2*Math.PI*i/(t+s-1);r[i]=e-n*Math.cos(o)}return cs(r,"float32")}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function Nwe(t,e,n=1){const s=L(t,"predictions","inTopK"),r=L(e,"targets","inTopK");O(s.rank>1,()=>`inTopK() expects the predictions to be of rank 2 or higher, but got ${s.rank}`),O(s.rank-1===r.rank,()=>`predictions rank should be 1 larger than targets rank, but got predictions rank ${s.rank} and targets rank ${r.rank}`),ni(s.shape.slice(0,s.shape.length-1),r.shape,"predictions's shape should be align with the targets' shape, except the last dimension.");const i=s.shape[s.shape.length-1];O(n>0&&n<=i,()=>`'k' passed to inTopK() must be > 0 && <= the predictions last dimension (${i}), but got ${n}`);const o=await s.data(),a=await r.data(),[l,c]=[o.length/i,i],u=Cs("bool",l);for(let d=0;d<l;d++){const h=d*c,f=o.subarray(h,h+c),p=[];for(let m=0;m<f.length;m++)p.push({value:f[m],index:m});p.sort((m,g)=>g.value-m.value),u[d]=0;for(let m=0;m<n;m++)if(p[m].index===a[d]){u[d]=1;break}}return t!==s&&s.dispose(),e!==r&&r.dispose(),wa(u,r.shape,"bool")}const Iwe=Nwe;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _we(t,e,n,s,r,i="NHWC",o){let a=t;t.rank===3&&(a=Q(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let l=e;l.rank===3&&(l=Q(e,[1,e.shape[0],e.shape[1],e.shape[2]])),O(a.rank===4,()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${a.shape}.`),O(l.rank===4,()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${l.shape}.`),O(n.length===4,()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${n}.`);const c=i==="NHWC"?a.shape[3]:a.shape[1],u=i==="NHWC"?l.shape[3]:l.shape[1];O(c===n[2],()=>`Error in conv2dDerFilter: depth of input ${c}) must match input depth in filter (${n[2]}.`),O(u===n[3],()=>`Error in conv2dDerFilter: depth of dy (${u}) must match output depth for filter (${n[3]}).`),cr("conv2dDerFilter",r,o);const d={x:a,dy:l},h={strides:s,pad:r,dataFormat:i,dimRoundingMode:o,filterShape:n};return Z.runKernel(T$,d,h)}const yR=X({conv2DBackpropFilter_:_we});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function US(t,e,n){if(n==null||n==="linear")return t;if(n==="relu")return Y(t,cp(e));throw new Error(`Cannot compute gradient for fused activation ${n}.`)}function HS(t,e){let n=e;const s=ps(t.shape,e.shape);return s.length>0&&(n=Be(n,s)),Q(n,t.shape)}function GS(t,e,n,s){if(e==="linear")return t;if(e==="relu")return Pa(t);if(e==="elu")return b0(t);if(e==="relu6")return sR(t);if(e==="prelu")return LS(t,n);if(e==="leakyrelu")return AS(t,s);if(e==="sigmoid")return bi(t);throw new Error(`Unknown fused activation ${e}.`)}const KS=(t,e)=>!(t>0)||e==="linear";/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ewe({x:t,filter:e,strides:n,pad:s,dataFormat:r="NHWC",dilations:i=[1,1],dimRoundingMode:o,bias:a,activation:l="linear",preluActivationWeights:c,leakyreluAlpha:u}){if(l=l||"linear",KS(Z.state.gradientDepth,l)===!1){O(r==="NHWC",()=>`Error in fused conv2d: got dataFormat of ${r} but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.`);let C=jc(t,e,n,s,r,i,o);return a!=null&&(C=fe(C,a)),GS(C,l,c,u)}const d=L(t,"x","conv2d","float32"),h=L(e,"filter","conv2d","float32");let f=d,p=!1;d.rank===3&&(p=!0,f=Q(d,[1,d.shape[0],d.shape[1],d.shape[2]])),O(f.rank===4,()=>`Error in fused conv2d: input must be rank 4, but got rank ${f.rank}.`),O(h.rank===4,()=>`Error in fused conv2d: filter must be rank 4, but got rank ${h.rank}.`),cr("fused conv2d",s,o);const m=r==="NHWC"?f.shape[3]:f.shape[1];O(h.shape[2]===m,()=>`Error in conv2d: depth of input (${m}) must match input depth for filter ${h.shape[2]}.`),O(Ms(n,i),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`);const g=Ts(f.shape,h.shape,n,i,s,o);let y;a!=null&&(y=L(a,"bias","fused conv2d"),[y]=Mn(y,d),r==="NHWC"?ct(g.outShape,y.shape):(O(y.shape.length<=1,()=>`Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-${y.shape.length}.`),O(y.shape.length===0||y.shape[0]===g.outChannels||y.shape[0]===1,()=>`Error in fused conv2d: bias shape (${y.shape}) is not compatible with the number of output channels (${g.outChannels})`)));let x;if(c!=null){const C=c.shape;if(O(C.length<=1||C.length===3,()=>`Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-${C.length}.`),C.length===1)O(C[0]===1||C[0]===g.outChannels,()=>`Error in fused conv2d: PReLU activation weights (${C}) is not compatible with the number of output channels (${g.outChannels}).`);else if(C.length===3)try{ct(C,g.outShape)}catch{const I=`Error in fused conv2d: PReLU activation weights (${C}) is not compatible with the output shape of the conv2d (${g.outShape}).`;throw Error(I)}x=L(c,"prelu weights","fused conv2d")}const v=(C,N)=>{O(r==="NHWC",()=>`Error in gradient of fused conv2D: got dataFormat of ${r} but only NHWC is currently supported.`);const[I,$,A,P]=N,F=US(C,A,l);O(Vc(i),()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${i}'`);const V=MA($.shape,F,I,n,s),z=yR($,F,I.shape,n,s),B=[V,z];if(P!=null){const W=HS(P,F);B.push(W)}return B},b={x:f,filter:h,bias:y,preluActivationWeights:x},k={strides:n,pad:s,dataFormat:r,dilations:i,dimRoundingMode:o,activation:l,leakyreluAlpha:u};return a==null?yl((N,I,$)=>{let A=Z.runKernel(qb,b,k);return $([I,N,A]),p&&(A=Q(A,[A.shape[1],A.shape[2],A.shape[3]])),{value:A,gradFunc:v}})(f,h):yl((N,I,$,A)=>{let P=Z.runKernel(qb,b,k);return A([I,N,P,$]),p&&(P=Q(P,[P.shape[1],P.shape[2],P.shape[3]])),{value:P,gradFunc:v}})(f,h,y)}const E8=X({fusedConv2d_:Ewe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $we(t,e,n,s,r,i=[1,1],o){let a=t;t.rank===3&&(a=Q(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let l=e;l.rank===3&&(l=Q(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const c={x:a,dy:l},u={strides:s,pad:r,dimRoundingMode:o,dilations:i,filterShape:n};return Z.runKernel(R$,c,u)}const $8=X({depthwiseConv2dNativeBackpropFilter_:$we});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Awe(t,e,n,s,r,i=[1,1],o){let a=e,l=!1;e.rank===3&&(l=!0,a=Q(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const c={dy:a,filter:n},u={strides:s,pad:r,dimRoundingMode:o,dilations:i,inputShape:t},d=Z.runKernel(D$,c,u);return l?Q(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const A8=X({depthwiseConv2dNativeBackpropInput_:Awe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rwe({x:t,filter:e,strides:n,pad:s,dataFormat:r="NHWC",dilations:i=[1,1],dimRoundingMode:o,bias:a,activation:l="linear",preluActivationWeights:c,leakyreluAlpha:u}){if(KS(Z.state.gradientDepth,l)===!1){let k=v0(t,e,n,s,r,i,o);return a!=null&&(k=fe(k,a)),GS(k,l,c,u)}const d=L(t,"x","depthwiseConv2d","float32"),h=L(e,"filter","depthwiseConv2d","float32");let f=d,p=!1;d.rank===3&&(p=!0,f=Q(d,[1,d.shape[0],d.shape[1],d.shape[2]])),O(f.rank===4,()=>`Error in fused depthwiseConv2d: input must be rank 4, but got rank ${f.rank}.`),O(h.rank===4,()=>`Error in fused depthwiseConv2d: filter must be rank 4, but got rank ${h.rank}.`),O(f.shape[3]===h.shape[2],()=>`Error in fused depthwiseConv2d: number of input channels (${f.shape[3]}) must match the inChannels dimension in filter ${h.shape[2]}.`),i==null&&(i=[1,1]),O(Ms(n,i),()=>`Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`),cr("fused depthwiseConv2d",s,o);const m=Ts(f.shape,h.shape,n,i,s,o,!0);let g;a!=null&&(g=L(a,"bias","fused conv2d"),[g]=Mn(g,d),ct(m.outShape,g.shape));let y;c!=null&&(y=L(c,"prelu weights","fused depthwiseConv2d"));const x=(k,C)=>{O(Vc(i),()=>`Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '${i}'`);const[N,I,$,A]=C,P=US(k,$,l),F=A8(I.shape,P,N,n,s,i,o),V=$8(I,P,N.shape,n,s,i,o);if(A!=null){const z=HS(g,P);return[F,V,z]}return[F,V]},v={x:f,filter:h,bias:g,preluActivationWeights:y},b={strides:n,pad:s,dataFormat:r,dilations:i,dimRoundingMode:o,activation:l,leakyreluAlpha:u};return a==null?yl((C,N,I)=>{let $=Z.runKernel(Xb,v,b);return I([N,C,$]),p&&($=Q($,[$.shape[1],$.shape[2],$.shape[3]])),{value:$,gradFunc:x}})(f,h):yl((C,N,I,$)=>{let A=Z.runKernel(Xb,v,b);return $([N,C,A,I]),p&&(A=Q(A,[A.shape[1],A.shape[2],A.shape[3]])),{value:A,gradFunc:x}})(f,h,g)}const Dwe=X({fusedDepthwiseConv2d_:Rwe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Owe({a:t,b:e,transposeA:n=!1,transposeB:s=!1,bias:r,activation:i="linear",preluActivationWeights:o,leakyreluAlpha:a=.2}){if(KS(Z.state.gradientDepth,i)===!1){let P=Ct(t,e,n,s);return r!=null&&(P=fe(P,r)),GS(P,i,o,a)}let l=L(t,"a","fused matMul"),c=L(e,"b","fused matMul");[l,c]=Mn(l,c);const u=n?l.shape[l.rank-2]:l.shape[l.rank-1],d=s?c.shape[c.rank-1]:c.shape[c.rank-2],h=n?l.shape[l.rank-1]:l.shape[l.rank-2],f=s?c.shape[c.rank-2]:c.shape[c.rank-1],p=l.shape.slice(0,-2),m=c.shape.slice(0,-2),g=le(p),y=le(m);O(u===d,()=>`Error in fused matMul: inner shapes (${u}) and (${d}) of Tensors with shapes ${l.shape} and ${c.shape} and transposeA=${n} and transposeB=${s} must match.`);const v=ct(l.shape.slice(0,-2),c.shape.slice(0,-2)).concat([h,f]),b=n?Q(l,[g,u,h]):Q(l,[g,h,u]),k=s?Q(c,[y,f,d]):Q(c,[y,d,f]);let C;r!=null&&(C=L(r,"bias","fused matMul"),[C]=Mn(C,l),ct(v,C.shape));let N;o!=null&&(N=L(o,"prelu weights","fused matMul"));const I=(P,F)=>{const[V,z,B,W]=F,q=US(Q(P,B.shape),B,i);let M,G;if(!n&&!s?(M=Ct(q,z,!1,!0),G=Ct(V,q,!0,!1)):!n&&s?(M=Ct(q,z,!1,!1),G=Ct(q,V,!0,!1)):n&&!s?(M=Ct(z,q,!1,!0),G=Ct(V,q,!1,!1)):(M=Ct(z,q,!0,!0),G=Ct(q,V,!0,!0)),r!=null){const ne=HS(W,q);return[M,G,ne]}else return[M,G]},$={a:b,b:k,bias:C,preluActivationWeights:N},A={transposeA:n,transposeB:s,activation:i,leakyreluAlpha:a};return r==null?yl((F,V,z)=>{const B=Z.runKernel(Kb,$,A);return z([F,V,B]),{value:Q(B,v),gradFunc:I}})(b,k):yl((F,V,z,B)=>{const W=Z.runKernel(Kb,$,A);return B([F,V,W,z]),{value:Q(W,v),gradFunc:I}})(b,k,C)}const Z2=X({fusedMatMul_:Owe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pwe=Object.freeze(Object.defineProperty({__proto__:null,conv2d:E8,depthwiseConv2d:Dwe,matMul:Z2},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fwe(t){return gR(t,.54,.46)}const Lwe=X({hammingWindow_:Fwe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mwe(t){return gR(t,.5,.5)}const R8=X({hannWindow_:Mwe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zwe(t,e,n,s=!1,r=0){let i=0;const o=[];for(;i+e<=t.size;)o.push(st(t,i,e)),i+=n;if(s)for(;i<t.size;){const a=i+e-t.size,l=Cn([st(t,i,e-a),ap([a],r)]);o.push(l),i+=n}return o.length===0?cl([],[0,e]):Q(Cn(o),[o.length,e])}const D8=X({frame_:zwe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vwe(t,e,n,s,r=R8){s==null&&(s=_8(e));const i=D8(t,e,n),o=Y(i,r(e));return WS(o,s)}const jwe=X({stft_:Vwe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bwe(t,e,n,s,r="bilinear",i=0){const o=L(t,"image","cropAndResize"),a=L(e,"boxes","cropAndResize","float32"),l=L(n,"boxInd","cropAndResize","int32"),c=a.shape[0];O(o.rank===4,()=>`Error in cropAndResize: image must be rank 4,but got rank ${o.rank}.`),O(a.rank===2&&a.shape[1]===4,()=>`Error in cropAndResize: boxes must be have size [${c},4] but had shape ${a.shape}.`),O(l.rank===1&&l.shape[0]===c,()=>`Error in cropAndResize: boxInd must be have size [${c}] but had shape ${a.shape}.`),O(s.length===2,()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${s.length}.`),O(s[0]>=1&&s[1]>=1,()=>`cropSize must be atleast [1,1], but was ${s}`),O(r==="bilinear"||r==="nearest",()=>`method must be bilinear or nearest, but was ${r}`);const u={image:o,boxes:a,boxInd:l},d={method:r,extrapolationValue:i,cropSize:s};return Z.runKernel(E$,u,d)}const Wwe=X({cropAndResize_:Bwe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uwe(t){const e=L(t,"image","flipLeftRight","float32");O(e.rank===4,()=>`Error in flipLeftRight: image must be rank 4,but got rank ${e.rank}.`);const n={image:e};return Z.runKernel(z$,n,{})}const Hwe=X({flipLeftRight_:Uwe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gwe(t){const e=L(t,"image","grayscaleToRGB"),n=e.rank-1,s=e.shape[n];O(e.rank>=2,()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${e.rank}.`),O(s===1,()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${s}.`);const r=new Array(e.rank);return r.fill(1,0,n),r[n]=3,Ji(e,r)}const Kwe=X({grayscaleToRGB_:Gwe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qwe(t,e,n=0,s=.5){const r=L(t,"image","rotateWithOffset","float32");O(r.rank===4,()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${r.rank}.`);const i={image:r},o={radians:e,fillValue:n,center:s};return Z.runKernel(vA,i,o)}const Xwe=X({rotateWithOffset_:qwe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function up(t,e,n,s,r,i){s==null&&(s=.5),r==null&&(r=Number.NEGATIVE_INFINITY),i==null&&(i=0);const o=t.shape[0];return n=Math.min(n,o),O(0<=s&&s<=1,()=>`iouThreshold must be in [0, 1], but was '${s}'`),O(t.rank===2,()=>`boxes must be a 2D tensor, but was of rank '${t.rank}'`),O(t.shape[1]===4,()=>`boxes must have 4 columns, but 2nd dimension was ${t.shape[1]}`),O(e.rank===1,()=>"scores must be a 1D tensor"),O(e.shape[0]===o,()=>`scores has incompatible shape with boxes. Expected ${o}, but was ${e.shape[0]}`),O(0<=i&&i<=1,()=>`softNmsSigma must be in [0, 1], but was '${i}'`),{maxOutputSize:n,iouThreshold:s,scoreThreshold:r,softNmsSigma:i}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ywe(t,e,n,s=.5,r=Number.NEGATIVE_INFINITY){const i=L(t,"boxes","nonMaxSuppression","float32"),o=L(e,"scores","nonMaxSuppression","float32"),a=up(i,o,n,s,r);n=a.maxOutputSize,s=a.iouThreshold,r=a.scoreThreshold;const l={maxOutputSize:n,iouThreshold:s,scoreThreshold:r};return Z.runKernel(X$,{boxes:i,scores:o},l)}const Zwe=X({nonMaxSuppression_:Ywe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qwe(t,e,n){const s=Jwe(t,e,n),r=s<0?-(s+1):s;t.splice(r,0,e)}function Jwe(t,e,n){return t1e(t,e,n||e1e)}function e1e(t,e){return t>e?1:t<e?-1:0}function t1e(t,e,n){let s=0,r=t.length,i=0,o=!1;for(;s<r;){i=s+(r-s>>>1);const a=n(e,t[i]);a>0?s=i+1:(r=i,o=!a)}return o?s:-s-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xR(t,e,n,s,r){return wR(t,e,n,s,r,0)}function vR(t,e,n,s,r,i){return wR(t,e,n,s,r,0,!1,i,!0)}function bR(t,e,n,s,r,i){return wR(t,e,n,s,r,i,!0)}function wR(t,e,n,s,r,i,o=!1,a=!1,l=!1){const c=[];for(let g=0;g<e.length;g++)e[g]>r&&c.push({score:e[g],boxIndex:g,suppressBeginIndex:0});c.sort(G3);const u=i>0?-.5/i:0,d=[],h=[];for(;d.length<n&&c.length>0;){const g=c.pop(),{score:y,boxIndex:x,suppressBeginIndex:v}=g;if(y<r)break;let b=!1;for(let k=d.length-1;k>=v;--k){const C=n1e(t,x,d[k]);if(C>=s){b=!0;break}if(g.score=g.score*s1e(s,u,C),g.score<=r)break}g.suppressBeginIndex=d.length,b||(g.score===y?(d.push(x),h.push(g.score)):g.score>r&&Qwe(c,g,G3))}const f=d.length,p=n-f;a&&p>0&&(d.push(...new Array(p).fill(0)),h.push(...new Array(p).fill(0)));const m={selectedIndices:d};return o&&(m.selectedScores=h),l&&(m.validOutputs=f),m}function n1e(t,e,n){const s=t.subarray(e*4,e*4+4),r=t.subarray(n*4,n*4+4),i=Math.min(s[0],s[2]),o=Math.min(s[1],s[3]),a=Math.max(s[0],s[2]),l=Math.max(s[1],s[3]),c=Math.min(r[0],r[2]),u=Math.min(r[1],r[3]),d=Math.max(r[0],r[2]),h=Math.max(r[1],r[3]),f=(a-i)*(l-o),p=(d-c)*(h-u);if(f<=0||p<=0)return 0;const m=Math.max(i,c),g=Math.max(o,u),y=Math.min(a,d),x=Math.min(l,h),v=Math.max(y-m,0)*Math.max(x-g,0);return v/(f+p-v)}function s1e(t,e,n){const s=Math.exp(e*n*n);return n<=t?s:0}function G3(t,e){return t.score-e.score||t.score===e.score&&e.boxIndex-t.boxIndex}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function r1e(t,e,n,s=.5,r=Number.NEGATIVE_INFINITY){const i=L(t,"boxes","nonMaxSuppressionAsync"),o=L(e,"scores","nonMaxSuppressionAsync"),a=up(i,o,n,s,r);n=a.maxOutputSize,s=a.iouThreshold,r=a.scoreThreshold;const l=await Promise.all([i.data(),o.data()]),c=l[0],u=l[1],{selectedIndices:d}=xR(c,u,n,s,r);return i!==t&&i.dispose(),o!==e&&o.dispose(),cs(d,"int32")}const i1e=r1e;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o1e(t,e,n,s=.5,r=Number.NEGATIVE_INFINITY,i=0){const o=L(t,"boxes","nonMaxSuppression"),a=L(e,"scores","nonMaxSuppression"),l=up(o,a,n,s,r,i);n=l.maxOutputSize,s=l.iouThreshold,r=l.scoreThreshold,i=l.softNmsSigma;const c={boxes:o,scores:a},u={maxOutputSize:n,iouThreshold:s,scoreThreshold:r,softNmsSigma:i},d=Z.runKernel(Z$,c,u);return{selectedIndices:d[0],selectedScores:d[1]}}const a1e=X({nonMaxSuppressionWithScore_:o1e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function l1e(t,e,n,s=.5,r=Number.NEGATIVE_INFINITY,i=0){const o=L(t,"boxes","nonMaxSuppressionAsync"),a=L(e,"scores","nonMaxSuppressionAsync"),l=up(o,a,n,s,r,i);n=l.maxOutputSize,s=l.iouThreshold,r=l.scoreThreshold,i=l.softNmsSigma;const c=await Promise.all([o.data(),a.data()]),u=c[0],d=c[1],{selectedIndices:h,selectedScores:f}=bR(u,d,n,s,r,i);return o!==t&&o.dispose(),a!==e&&a.dispose(),{selectedIndices:cs(h,"int32"),selectedScores:cs(f)}}const c1e=l1e;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u1e(t,e,n,s=.5,r=Number.NEGATIVE_INFINITY,i=!1){const o=L(t,"boxes","nonMaxSuppression"),a=L(e,"scores","nonMaxSuppression"),l=up(o,a,n,s,r,null),c=l.maxOutputSize,u=l.iouThreshold,d=l.scoreThreshold,h={boxes:o,scores:a},f={maxOutputSize:c,iouThreshold:u,scoreThreshold:d,padToMaxOutputSize:i},p=Z.runKernel(Y$,h,f);return{selectedIndices:p[0],validOutputs:p[1]}}const d1e=X({nonMaxSuppressionPadded_:u1e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function h1e(t,e,n,s=.5,r=Number.NEGATIVE_INFINITY,i=!1){const o=L(t,"boxes","nonMaxSuppressionAsync"),a=L(e,"scores","nonMaxSuppressionAsync"),l=up(o,a,n,s,r,null),c=l.maxOutputSize,u=l.iouThreshold,d=l.scoreThreshold,[h,f]=await Promise.all([o.data(),a.data()]),{selectedIndices:p,validOutputs:m}=vR(h,f,c,u,d,i);return o!==t&&o.dispose(),a!==e&&a.dispose(),{selectedIndices:cs(p,"int32"),validOutputs:Ge(m,"int32")}}const f1e=h1e;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p1e(t,e,n=!1,s=!1){const r=L(t,"images","resizeBilinear");O(r.rank===3||r.rank===4,()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${r.rank}.`),O(e.length===2,()=>`Error in resizeBilinear: new shape must 2D, but got shape ${e}.`),O(s===!1||n===!1,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let i=r,o=!1;r.rank===3&&(o=!0,i=Q(r,[1,r.shape[0],r.shape[1],r.shape[2]]));const a={images:i},l={alignCorners:n,halfPixelCenters:s,size:e},c=Z.runKernel(fS,a,l);return o?Q(c,[c.shape[1],c.shape[2],c.shape[3]]):c}const O8=X({resizeBilinear_:p1e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m1e(t,e,n=!1,s=!1){const r=L(t,"images","resizeNearestNeighbor");O(r.rank===3||r.rank===4,()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${r.rank}.`),O(e.length===2,()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${e}.`),O(r.dtype==="float32"||r.dtype==="int32",()=>"`images` must have `int32` or `float32` as dtype"),O(s===!1||n===!1,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let i=r,o=!1;r.rank===3&&(o=!0,i=Q(r,[1,r.shape[0],r.shape[1],r.shape[2]]));const a={images:i},l={alignCorners:n,halfPixelCenters:s,size:e},c=Z.runKernel(hS,a,l);return o?Q(c,[c.shape[1],c.shape[2],c.shape[3]]):c}const P8=X({resizeNearestNeighbor_:m1e});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g1e(t,e="binary",n=!1,s=.5){const r=L(t,"image","threshold"),i=.2989,o=.587,a=.114,l=r.shape[0]*r.shape[1];let c=Y(cs([s]),255),u,d,h,f;if(O(r.rank===3,()=>`Error in threshold: image must be rank 3,but got rank ${r.rank}.`),O(r.shape[2]===3||r.shape[2]===1,()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${r.shape[2]}.`),O(r.dtype==="int32"||r.dtype==="float32",()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${r.dtype}.`),O(e==="otsu"||e==="binary",()=>`Method must be binary or otsu, but was ${e}`),r.shape[2]===3){[u,d,h]=Yr(r,[1,1,1],-1);const g=Y(u,i),y=Y(d,o),x=Y(h,a);f=fe(fe(g,y),x)}else f=t;if(e==="otsu"){const g=WG(Te(rR(f),"int32"),wa([]),256);c=y1e(g,l)}const p=n?zd(f,c):Ei(f,c);return Te(Y(p,255),"int32")}function y1e(t,e){let n=cs([-1]),s=cs([0]),r=cs([0]),i,o,a,l,c,u;for(let d=0;d<t.size-1;d++){i=st(t,0,d+1),o=st(t,d+1),c=$e(Be(i),e),u=$e(Be(o),e);const h=Be(Y(i,Ig(0,i.size)));a=$e(h,Be(i));const f=ap(o.shape,i.size),p=fe(Ig(0,o.size),f),m=Y(o,p);l=$e(Be(m),Be(o));const g=Ae(a,l),y=Ae(a,l),x=Y(c,u);r=Y(Y(x,g),y);const v=Ei(r,s);s=Nr(v,r,s),n=Nr(v,cs([d]),n)}return n}const x1e=X({threshold_:g1e});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v1e(t,e,n="nearest",s="constant",r=0,i){const o=L(t,"image","transform","float32"),a=L(e,"transforms","transform","float32");O(o.rank===4,()=>`Error in transform: image must be rank 4,but got rank ${o.rank}.`),O(a.rank===2&&(a.shape[0]===o.shape[0]||a.shape[0]===1)&&a.shape[1]===8,()=>"Error in transform: Input transform should be batch x 8 or 1 x 8"),O(i==null||i.length===2,()=>`Error in transform: outputShape must be [height, width] or null, but got ${i}.`);const l={image:o,transforms:a},c={interpolation:n,fillMode:s,fillValue:r,outputShape:i};return Z.runKernel(yA,l,c)}const b1e=X({transform_:v1e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w1e(t,e,n){O(e%1===0,()=>`bandPart(): numLower must be an integer, got ${e}.`),O(n%1===0,()=>`bandPart(): numUpper must be an integer, got ${n}.`);const s=L(t,"a","bandPart");O(s.rank>=2,()=>`bandPart(): Rank must be at least 2, got ${s.rank}.`);const r=s.shape,[i,o]=s.shape.slice(-2);if(!(e<=i))throw new Error(`bandPart(): numLower (${e}) must not be greater than the number of rows (${i}).`);if(!(n<=o))throw new Error(`bandPart(): numUpper (${n}) must not be greater than the number of columns (${o}).`);e<0&&(e=i),n<0&&(n=o);const a=Q(Ig(0,i,1,"int32"),[-1,1]),l=Ig(0,o,1,"int32"),c=Ae(a,l),u=Ea(zd(c,Ge(+e,"int32")),Md(c,Ge(-n,"int32"))),d=es([i,o],s.dtype);return Q(lo(zo(Q(s,[-1,i,o])).map(h=>Nr(u,h,d))),r)}const S1e=X({bandPart_:w1e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k1e(t){let e;if(Array.isArray(t)){e=!1,O(t!=null&&t.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");const r=t[0].shape[0];for(let i=1;i<t.length;++i)O(t[i].shape[0]===r,()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${t[i].shape[0]} vs. ${r})`)}else e=!0,t=Yr(t,t.shape[0],0).map(r=>Bt(r,[0]));O(t.length<=t[0].shape[0],()=>`Gram-Schmidt: Number of vectors (${t.length}) exceeds number of dimensions (${t[0].shape[0]}).`);const n=[],s=t;for(let r=0;r<t.length;++r)n.push(Z.tidy(()=>{let i=s[r];if(r>0)for(let o=0;o<r;++o){const a=Y(Be(Y(n[o],i)),n[o]);i=Ae(i,a)}return $e(i,kd(i,"euclidean"))}));return e?lo(n,0):n}const C1e=X({gramSchmidt_:k1e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T1e(t,e=!1){if(O(t.rank>=2,()=>`qr() requires input tensor to have a rank >= 2, but got rank ${t.rank}`),t.rank===2)return K3(t,e);{const n=t.shape.slice(0,t.shape.length-2).reduce((l,c)=>l*c),s=zo(Q(t,[n,t.shape[t.shape.length-2],t.shape[t.shape.length-1]]),0),r=[],i=[];s.forEach(l=>{const[c,u]=K3(l,e);r.push(c),i.push(u)});const o=Q(lo(r,0),t.shape),a=Q(lo(i,0),t.shape);return[o,a]}}function K3(t,e=!1){return Z.tidy(()=>{O(t.shape.length===2,()=>`qr2d() requires a 2D Tensor, but got a ${t.shape.length}D Tensor.`);const n=t.shape[0],s=t.shape[1];let r=WA(n),i=ll(t);const o=cl([[1]],[1,1]);let a=ll(o);const l=n>=s?s:n;for(let c=0;c<l;++c){const u=i,d=a,h=r;[a,i,r]=Z.tidy(()=>{const f=st(i,[c,c],[n-c,1]),p=kd(f),m=st(i,[c,c],[1,1]),g=Nr(Ei(m,0),cl([[-1]]),cl([[1]])),y=Ae(m,Y(g,p)),x=$e(f,y);x.shape[0]===1?a=ll(o):a=Cn([o,st(x,[1,0],[x.shape[0]-1,x.shape[1]])],0);const v=vn($e(Ct(g,y),p)),b=st(i,[c,0],[n-c,s]),k=Y(v,a),C=Nt(a);if(c===0)i=Ae(b,Ct(k,Ct(C,b)));else{const $=Ae(b,Ct(k,Ct(C,b)));i=Cn([st(i,[0,0],[c,s]),$],0)}const N=Nt(k),I=st(r,[0,c],[n,r.shape[1]-c]);if(c===0)r=Ae(I,Ct(Ct(I,a),N));else{const $=Ae(I,Ct(Ct(I,a),N));r=Cn([st(r,[0,0],[n,c]),$],1)}return[a,i,r]}),rt([u,d,h])}return!e&&n>s&&(r=st(r,[0,0],[n,s]),i=st(i,[0,0],[s,s])),[r,i]})}const N1e=X({qr_:T1e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var wr;(function(t){t[t.NONE=0]="NONE",t[t.MEAN=1]="MEAN",t[t.SUM=2]="SUM",t[t.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(wr||(wr={}));function I1e(t,e,n=wr.SUM_BY_NONZERO_WEIGHTS){const s=L(t,"losses","computeWeightedLoss");let r=null;e!=null&&(r=L(e,"weights","computeWeightedLoss"));const i=r==null?s:Y(s,r);if(n===wr.NONE)return i;if(n===wr.SUM)return Be(i);if(n===wr.MEAN){if(r==null)return Dn(i);{const o=s.size/r.size,a=$e(Be(i),Be(r));return o>1?$e(a,Ge(o)):a}}if(n===wr.SUM_BY_NONZERO_WEIGHTS){if(r==null)return $e(Be(i),Ge(s.size));{const o=Y(r,gi(s.shape)),a=Te(Be(Pf(o,Ge(0))),"float32");return $e(Be(i),a)}}throw Error(`Unknown reduction: ${n}`)}const kl=X({computeWeightedLoss_:I1e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _1e(t,e,n,s=wr.SUM_BY_NONZERO_WEIGHTS){const r=L(t,"labels","absoluteDifference"),i=L(e,"predictions","absoluteDifference");let o=null;n!=null&&(o=L(n,"weights","absoluteDifference")),ni(r.shape,i.shape,"Error in absoluteDifference: ");const a=os(Ae(r,i));return kl(a,o,s)}const E1e=X({absoluteDifference_:_1e});function $1e(t,e,n,s,r=wr.SUM_BY_NONZERO_WEIGHTS){const i=L(t,"labels","cosineDistance"),o=L(e,"predictions","cosineDistance");let a=null;s!=null&&(a=L(s,"weights","cosineDistance")),ni(i.shape,o.shape,"Error in cosineDistance: ");const l=Ge(1),c=Ae(l,Be(Y(i,o),n,!0));return kl(c,a,r)}const A1e=X({cosineDistance_:$1e});function R1e(t,e,n,s=wr.SUM_BY_NONZERO_WEIGHTS){let r=L(t,"labels","hingeLoss");const i=L(e,"predictions","hingeLoss");let o=null;n!=null&&(o=L(n,"weights","hingeLoss")),ni(r.shape,i.shape,"Error in hingeLoss: ");const a=Ge(1);r=Ae(Y(Ge(2),r),a);const l=Pa(Ae(a,Y(r,i)));return kl(l,o,s)}const D1e=X({hingeLoss_:R1e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O1e(t,e,n,s=1,r=wr.SUM_BY_NONZERO_WEIGHTS){const i=L(t,"labels","huberLoss"),o=L(e,"predictions","huberLoss");let a=null;n!=null&&(a=L(n,"weights","huberLoss")),ni(i.shape,o.shape,"Error in huberLoss: ");const l=Ge(s),c=os(Ae(o,i)),u=S0(c,l),d=Ae(c,u),h=fe(Y(Ge(.5),Zt(u)),Y(l,d));return kl(h,a,r)}const P1e=X({huberLoss_:O1e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F1e(t,e,n,s=1e-7,r=wr.SUM_BY_NONZERO_WEIGHTS){const i=L(t,"labels","logLoss"),o=L(e,"predictions","logLoss");let a=null;n!=null&&(a=L(n,"weights","logLoss")),ni(i.shape,o.shape,"Error in logLoss: ");const l=Ge(1),c=Ge(s),u=vn(Y(i,Ti(fe(o,c)))),d=Y(Ae(l,i),Ti(fe(Ae(l,o),c))),h=Ae(u,d);return kl(h,a,r)}const L1e=X({logLoss_:F1e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M1e(t,e,n,s=wr.SUM_BY_NONZERO_WEIGHTS){const r=L(t,"labels","meanSquaredError"),i=L(e,"predictions","meanSquaredError");let o=null;n!=null&&(o=L(n,"weights","meanSquaredError")),ni(r.shape,i.shape,"Error in meanSquaredError: ");const a=hR(r,i);return kl(a,o,s)}const z1e=X({meanSquaredError_:M1e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V1e(t,e){const n=L(t,"labels","sigmoidCrossEntropyWithLogits"),s=L(e,"logits","sigmoidCrossEntropyWithLogits");ni(n.shape,s.shape,"Error in sigmoidCrossEntropyWithLogits: ");const r=Pa(s),i=Y(s,n),o=RS(Ir(vn(os(s))));return fe(Ae(r,i),o)}function j1e(t,e,n,s=0,r=wr.SUM_BY_NONZERO_WEIGHTS){let i=L(t,"multiClassLabels","sigmoidCrossEntropy");const o=L(e,"logits","sigmoidCrossEntropy");let a=null;if(n!=null&&(a=L(n,"weights","sigmoidCrossEntropy")),ni(i.shape,o.shape,"Error in sigmoidCrossEntropy: "),s>0){const c=Ge(s),u=Ge(1),d=Ge(.5);i=fe(Y(i,Ae(u,c)),Y(d,c))}const l=V1e(i,o);return kl(l,a,r)}const B1e=X({sigmoidCrossEntropy_:j1e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W1e(t,e,n=-1){if(n===-1&&(n=e.rank-1),n!==e.rank-1)throw Error(`Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank ${e.rank} and dim was ${n}`);return yl((r,i,o)=>{const l=GA(i,[n],!0),c=Ae(Te(i,"float32"),l);o([r,c]);const u=vn(Y(c,r));return{value:Be(u,[n]),gradFunc:(f,p)=>{const[m,g]=p,y=Hn(f.shape,[n]);return[Y(Q(f,y),Ae(Te(m,"float32"),Ir(g))),Y(Q(f,y),Ae(Ir(g),Te(m,"float32")))]}}})(t,e)}function U1e(t,e,n,s=0,r=wr.SUM_BY_NONZERO_WEIGHTS){let i=L(t,"onehotLabels","softmaxCrossEntropy");const o=L(e,"logits","softmaxCrossEntropy");let a=null;if(n!=null&&(a=L(n,"weights","softmaxCrossEntropy")),ni(i.shape,o.shape,"Error in softmaxCrossEntropy: "),s>0){const c=Ge(s),u=Ge(1),d=Ge(i.shape[1]);i=fe(Y(i,Ae(u,c)),$e(c,d))}const l=W1e(i,o);return kl(l,a,r)}const H1e=X({softmaxCrossEntropy_:U1e});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G1e(t,e,n,s){const r=L(t,"indices","sparseFillEmptyRows","int32"),i=L(e,"values","sparseFillEmptyRows"),o=L(n,"denseShape","sparseFillEmptyRows","int32"),a=L(s,"defaultValue","sparseFillEmptyRows",i.dtype);if(r.rank!==2)throw new Error(`Indices should be Tensor2D but received shape
        ${r.shape}`);if(i.rank!==1)throw new Error(`Values should be Tensor1D but received shape ${i.shape}`);if(o.rank!==1)throw new Error(`Dense shape should be Tensor1D but received shape ${o.shape}`);if(a.rank!==0)throw new Error(`Default value should be a scalar but received shape ${a.shape}`);const l={indices:r,values:i,denseShape:o,defaultValue:a},c=Z.runKernel(oA,l);return{outputIndices:c[0],outputValues:c[1],emptyRowIndicator:c[2],reverseIndexMap:c[3]}}const K1e=X({sparseFillEmptyRows_:G1e});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function q1e(t,e,n){const s=L(t,"inputIndices","sparseReshape","int32"),r=L(e,"inputShape","sparseReshape","int32"),i=L(n,"newShape","sparseReshape","int32");if(s.rank!==2)throw new Error(`Input indices should be Tensor2D but received shape
        ${s.shape}`);if(r.rank!==1)throw new Error(`Input shape should be Tensor1D but received shape ${r.shape}`);if(i.rank!==1)throw new Error(`New shape should be Tensor1D but received shape ${i.shape}`);const o={inputIndices:s,inputShape:r,newShape:i},a=Z.runKernel(aA,o);return{outputIndices:a[0],outputShape:a[1]}}const X1e=X({sparseReshape_:q1e});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y1e(t,e,n){const s=L(t,"data","sparseSegmentMean"),r=L(e,"indices","sparseSegmentMean","int32"),i=L(n,"segmentIds","sparseSegmentMean","int32");if(s.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
          ${r.shape}`);if(i.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
          ${i.shape}`);const o={data:s,indices:r,segmentIds:i};return Z.runKernel(lA,o)}const Z1e=X({sparseSegmentMean_:Y1e});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q1e(t,e,n){const s=L(t,"data","sparseSegmentSum"),r=L(e,"indices","sparseSegmentSum","int32"),i=L(n,"segmentIds","sparseSegmentSum","int32");if(s.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
         ${r.shape}`);if(i.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
         ${i.shape}`);const o={data:s,indices:r,segmentIds:i};return Z.runKernel(cA,o)}const J1e=X({sparseSegmentSum_:Q1e});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eSe(t,e,n,s,r,i,o,a){const l=L(t,"data","stringNGrams","string");if(l.dtype!=="string")throw new Error("Data must be of datatype string");if(l.shape.length!==1)throw new Error(`Data must be a vector, saw: ${l.shape}`);const c=L(e,"dataSplits","stringNGrams");if(c.dtype!=="int32")throw new Error("Data splits must be of datatype int32");const u={separator:n,nGramWidths:s,leftPad:r,rightPad:i,padWidth:o,preserveShortSequences:a},d={data:l,dataSplits:c},h=Z.runKernel(fA,d,u);return{nGrams:h[0],nGramsSplits:h[1]}}const tSe=X({stringNGrams_:eSe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nSe(t,e,n=!0){const s=L(t,"input","stringSplit","string"),r=L(e,"delimiter","stringSplit","string");if(s.rank!==1)throw new Error(`Input should be Tensor1D but received shape ${s.shape}`);if(r.rank!==0)throw new Error(`Delimiter should be a scalar but received shape ${r.shape}`);const i={skipEmpty:n},o={input:s,delimiter:r},a=Z.runKernel(pA,o,i);return{indices:a[0],values:a[1],shape:a[2]}}const sSe=X({stringSplit_:nSe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rSe(t,e){const n=L(t,"input","stringToHashBucketFast","string"),s={numBuckets:e};if(e<=0)throw new Error("Number of buckets must be at least 1");const r={input:n};return Z.runKernel(mA,r,s)}const iSe=X({stringToHashBucketFast_:rSe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oSe={fft:BS,ifft:Eg,rfft:WS,irfft:dR},aSe={hammingWindow:Lwe,hannWindow:R8,frame:D8,stft:jwe},ha={flipLeftRight:Hwe,grayscaleToRGB:Kwe,resizeNearestNeighbor:P8,resizeBilinear:O8,rotateWithOffset:Xwe,cropAndResize:Wwe,nonMaxSuppression:Zwe,nonMaxSuppressionAsync:i1e,nonMaxSuppressionWithScore:a1e,nonMaxSuppressionWithScoreAsync:c1e,nonMaxSuppressionPadded:d1e,nonMaxSuppressionPaddedAsync:f1e,threshold:x1e,transform:b1e},F8={bandPart:S1e,gramSchmidt:C1e,qr:N1e},lSe={absoluteDifference:E1e,computeWeightedLoss:kl,cosineDistance:A1e,hingeLoss:D1e,huberLoss:P1e,logLoss:L1e,meanSquaredError:z1e,sigmoidCrossEntropy:B1e,softmaxCrossEntropy:H1e},cSe={sparseFillEmptyRows:K1e,sparseReshape:X1e,sparseSegmentMean:Z1e,sparseSegmentSum:J1e},uSe={stringNGrams:tSe,stringSplit:sSe,stringToHashBucketFast:iSe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ou extends op{minimize(e,n=!1,s){const{value:r,grads:i}=this.computeGradients(e,s);if(s!=null){const o=s.map(a=>({name:a.name,tensor:i[a.name]}));this.applyGradients(o)}else this.applyGradients(i);return rt(i),n?r:(r.dispose(),null)}get iterations(){return this.iterations_==null&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(e,n){return Qxe(e,n)}dispose(){this.iterations_!=null&&rt(this.iterations_)}async saveIterations(){return this.iterations_==null&&(this.iterations_=0),{name:"iter",tensor:Ge(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(e){throw new Error(`setWeights() is not implemented for this optimizer class ${this.getClassName()}`)}async extractIterations(e){return this.iterations_=(await e[0].tensor.data())[0],e.slice(1)}}Object.defineProperty(ou,Symbol.hasInstance,{value:t=>t.minimize!=null&&t.computeGradients!=null&&t.applyGradients!=null});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class SR extends ou{constructor(e,n,s=null){super(),this.learningRate=e,this.rho=n,this.epsilon=s,this.accumulatedGrads=[],this.accumulatedUpdates=[],s==null&&(this.epsilon=Z.backend.epsilon())}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const i=Z.registeredVariables[s],o=!1;this.accumulatedGrads[r]==null&&(this.accumulatedGrads[r]={originalName:`${s}/accum_grad`,variable:se(()=>_t(i).variable(o))}),this.accumulatedUpdates[r]==null&&(this.accumulatedUpdates[r]={originalName:`${s}/accum_var`,variable:se(()=>_t(i).variable(o))});const a=Array.isArray(e)?e[r].tensor:e[s];if(a==null)return;const l=this.accumulatedGrads[r].variable,c=this.accumulatedUpdates[r].variable;se(()=>{const u=fe(Y(l,this.rho),Y(Zt(a),1-this.rho)),d=Y($e(Ys(fe(c,this.epsilon)),Ys(fe(l,this.epsilon))),a),h=fe(Y(c,this.rho),Y(Zt(d),1-this.rho));l.assign(u),c.assign(h);const f=fe(Y(d,-this.learningRate),i);i.assign(f)})}),this.incrementIterations()}dispose(){this.accumulatedUpdates!=null&&(rt(this.accumulatedGrads.map(e=>e.variable)),rt(this.accumulatedUpdates.map(e=>e.variable)))}async getWeights(){const e=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=e.length/2,s=!1;this.accumulatedGrads=e.slice(0,n).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.accumulatedUpdates=e.slice(n,n*2).map(r=>({originalName:r.name,variable:r.tensor.variable(s)}))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(e,n){return new e(n.learningRate,n.rho,n.epsilon)}}SR.className="Adadelta";ge(SR);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class kR extends ou{constructor(e,n=.1){super(),this.learningRate=e,this.initialAccumulatorValue=n,this.accumulatedGrads=[]}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const i=Z.registeredVariables[s];this.accumulatedGrads[r]==null&&(this.accumulatedGrads[r]={originalName:`${s}/accumulator`,variable:se(()=>ap(i.shape,this.initialAccumulatorValue).variable(!1))});const o=Array.isArray(e)?e[r].tensor:e[s];if(o==null)return;const a=this.accumulatedGrads[r].variable;se(()=>{const l=fe(a,Zt(o));a.assign(l);const c=fe(Y($e(o,Ys(fe(l,Z.backend.epsilon()))),-this.learningRate),i);i.assign(c)})}),this.incrementIterations()}dispose(){this.accumulatedGrads!=null&&rt(this.accumulatedGrads.map(e=>e.variable))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=!1;this.accumulatedGrads=e.map(s=>({originalName:s.name,variable:s.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(e,n){return new e(n.learningRate,n.initialAccumulatorValue)}}kR.className="Adagrad";ge(kR);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class CR extends ou{constructor(e,n,s,r=null){super(),this.learningRate=e,this.beta1=n,this.beta2=s,this.epsilon=r,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],se(()=>{this.accBeta1=Ge(n).variable(),this.accBeta2=Ge(s).variable()}),r==null&&(this.epsilon=Z.backend.epsilon())}applyGradients(e){const n=Array.isArray(e)?e.map(s=>s.name):Object.keys(e);se(()=>{const s=Ae(1,this.accBeta1),r=Ae(1,this.accBeta2);n.forEach((i,o)=>{const a=Z.registeredVariables[i],l=!1;this.accumulatedFirstMoment[o]==null&&(this.accumulatedFirstMoment[o]={originalName:`${i}/m`,variable:se(()=>_t(a).variable(l))}),this.accumulatedSecondMoment[o]==null&&(this.accumulatedSecondMoment[o]={originalName:`${i}/v`,variable:se(()=>_t(a).variable(l))});const c=Array.isArray(e)?e[o].tensor:e[i];if(c==null)return;const u=this.accumulatedFirstMoment[o].variable,d=this.accumulatedSecondMoment[o].variable,h=fe(Y(u,this.beta1),Y(c,1-this.beta1)),f=fe(Y(d,this.beta2),Y(Zt(c),1-this.beta2)),p=$e(h,s),m=$e(f,r);u.assign(h),d.assign(f);const g=fe(Y($e(p,fe(Ys(m),this.epsilon)),-this.learningRate),a);a.assign(g)}),this.accBeta1.assign(Y(this.accBeta1,this.beta1)),this.accBeta2.assign(Y(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&rt(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedSecondMoment!=null&&rt(this.accumulatedSecondMoment.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e),se(()=>{this.accBeta1.assign(Bc(this.beta1,this.iterations_+1)),this.accBeta2.assign(Bc(this.beta2,this.iterations_+1))});const n=e.length/2,s=!1;this.accumulatedFirstMoment=e.slice(0,n).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.accumulatedSecondMoment=e.slice(n,n*2).map(r=>({originalName:r.name,variable:r.tensor.variable(s)}))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(e,n){return new e(n.learningRate,n.beta1,n.beta2,n.epsilon)}}CR.className="Adam";ge(CR);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class TR extends ou{constructor(e,n,s,r=null,i=0){super(),this.learningRate=e,this.beta1=n,this.beta2=s,this.epsilon=r,this.decay=i,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],se(()=>{this.iteration=Ge(0).variable(),this.accBeta1=Ge(n).variable()}),r==null&&(this.epsilon=Z.backend.epsilon())}applyGradients(e){const n=Array.isArray(e)?e.map(s=>s.name):Object.keys(e);se(()=>{const s=Ae(1,this.accBeta1),r=$e(-this.learningRate,fe(Y(this.iteration,this.decay),1));n.forEach((i,o)=>{const a=Z.registeredVariables[i],l=!1;this.accumulatedFirstMoment[o]==null&&(this.accumulatedFirstMoment[o]={originalName:`${i}/m`,variable:_t(a).variable(l)}),this.accumulatedWeightedInfNorm[o]==null&&(this.accumulatedWeightedInfNorm[o]={originalName:`${i}/v`,variable:_t(a).variable(l)});const c=Array.isArray(e)?e[o].tensor:e[i];if(c==null)return;const u=this.accumulatedFirstMoment[o].variable,d=this.accumulatedWeightedInfNorm[o].variable,h=fe(Y(u,this.beta1),Y(c,1-this.beta1)),f=Y(d,this.beta2),p=os(c),m=Oa(f,p);u.assign(h),d.assign(m);const g=fe(Y($e(r,s),$e(h,fe(m,this.epsilon))),a);a.assign(g)}),this.iteration.assign(fe(this.iteration,1)),this.accBeta1.assign(Y(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&rt(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedWeightedInfNorm!=null&&rt(this.accumulatedWeightedInfNorm.map(e=>e.variable))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(e){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(e,n){return new e(n.learningRate,n.beta1,n.beta2,n.epsilon,n.decay)}}TR.className="Adamax";ge(TR);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class qS extends ou{constructor(e){super(),this.learningRate=e,this.setLearningRate(e)}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const i=Array.isArray(e)?e[r].tensor:e[s];if(i==null)return;const o=Z.registeredVariables[s];se(()=>{const a=fe(Y(this.c,i),o);o.assign(a)})}),this.incrementIterations()}setLearningRate(e){this.learningRate=e,this.c!=null&&this.c.dispose(),this.c=Ps(Ge(-e))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(e){if(e=await this.extractIterations(e),e.length!==0)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(e,n){return new e(n.learningRate)}}qS.className="SGD";ge(qS);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class NR extends qS{constructor(e,n,s=!1){super(e),this.learningRate=e,this.momentum=n,this.useNesterov=s,this.accumulations=[],this.m=Ge(this.momentum)}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const i=Z.registeredVariables[s];this.accumulations[r]==null&&(this.accumulations[r]={originalName:`${s}/momentum`,variable:se(()=>_t(i).variable(!1))});const o=this.accumulations[r].variable,a=Array.isArray(e)?e[r].tensor:e[s];a!=null&&se(()=>{let l;const c=fe(Y(this.m,o),a);this.useNesterov?l=fe(Y(this.c,fe(a,Y(c,this.m))),i):l=fe(Y(this.c,c),i),o.assign(c),i.assign(l)})}),this.incrementIterations()}dispose(){this.m.dispose(),this.accumulations!=null&&rt(this.accumulations.map(e=>e.variable))}setMomentum(e){this.momentum=e}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=!1;this.accumulations=e.map(s=>({originalName:s.name,variable:s.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(e,n){return new e(n.learningRate,n.momentum,n.useNesterov)}}NR.className="Momentum";ge(NR);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class IR extends ou{constructor(e,n=.9,s=0,r=null,i=!1){if(super(),this.learningRate=e,this.decay=n,this.momentum=s,this.epsilon=r,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=i,r==null&&(this.epsilon=Z.backend.epsilon()),e==null)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const i=Z.registeredVariables[s],o=!1;this.accumulatedMeanSquares[r]==null&&(this.accumulatedMeanSquares[r]={originalName:`${s}/rms`,variable:se(()=>_t(i).variable(o))}),this.accumulatedMoments[r]==null&&(this.accumulatedMoments[r]={originalName:`${s}/momentum`,variable:se(()=>_t(i).variable(o))}),this.accumulatedMeanGrads[r]==null&&this.centered&&(this.accumulatedMeanGrads[r]={originalName:`${s}/mg`,variable:se(()=>_t(i).variable(o))});const a=Array.isArray(e)?e[r].tensor:e[s];if(a==null)return;const l=this.accumulatedMeanSquares[r].variable,c=this.accumulatedMoments[r].variable;se(()=>{const u=fe(Y(l,this.decay),Y(Zt(a),1-this.decay));if(this.centered){const d=this.accumulatedMeanGrads[r].variable,h=fe(Y(d,this.decay),Y(a,1-this.decay)),f=$e(Y(a,this.learningRate),Ys(Ae(u,fe(Zt(h),this.epsilon)))),p=fe(Y(c,this.momentum),f);l.assign(u),d.assign(h),c.assign(p);const m=Ae(i,p);i.assign(m)}else{const d=fe(Y(l,this.decay),Y(Zt(a),1-this.decay)),h=fe(Y(c,this.momentum),$e(Y(a,this.learningRate),Ys(fe(d,this.epsilon))));l.assign(d),c.assign(h);const f=Ae(i,h);i.assign(f)}})}),this.incrementIterations()}dispose(){this.accumulatedMeanSquares!=null&&rt(this.accumulatedMeanSquares.map(e=>e.variable)),this.accumulatedMeanGrads!=null&&this.centered&&rt(this.accumulatedMeanGrads.map(e=>e.variable)),this.accumulatedMoments!=null&&rt(this.accumulatedMoments.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&e.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=this.centered?e.length/3:e.length/2,s=!1;this.accumulatedMeanSquares=e.slice(0,n).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.accumulatedMoments=e.slice(n,n*2).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.centered&&(this.accumulatedMeanGrads=e.slice(n*2,n*3).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(e,n){return new e(n.learningRate,n.decay,n.momentum,n.epsilon,n.centered)}}IR.className="RMSProp";ge(IR);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class vu{static sgd(e){return new qS(e)}static momentum(e,n,s=!1){return new NR(e,n,s)}static rmsprop(e,n=.9,s=0,r=null,i=!1){return new IR(e,n,s,r,i)}static adam(e=.001,n=.9,s=.999,r=null){return new CR(e,n,s,r)}static adadelta(e=.001,n=.95,s=null){return new SR(e,n,s)}static adamax(e=.002,n=.9,s=.999,r=null,i=0){return new TR(e,n,s,r,i)}static adagrad(e,n=.1){return new kR(e,n)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const th={sgd:vu.sgd,momentum:vu.momentum,adadelta:vu.adadelta,adagrad:vu.adagrad,rmsprop:vu.rmsprop,adamax:vu.adamax,adam:vu.adam};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dSe=(()=>typeof requestAnimationFrame<"u"?requestAnimationFrame:typeof setImmediate<"u"?setImmediate:t=>t())();function L8(){return new Promise(t=>dSe(()=>t()))}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _R(t,e){const n=t[0].length;t.forEach((r,i)=>{O(r.length===n,()=>`Error in concat${n}D: rank of tensors[${i}] must be the same as the rank of the rest (${n})`)}),O(e>=0&&e<n,()=>`Error in concat${n}D: axis must be between 0 and ${n-1}.`);const s=t[0];t.forEach((r,i)=>{for(let o=0;o<n;o++)O(o===e||r[o]===s[o],()=>`Error in concat${n}D: Shape of tensors[${i}] (${r}) does not match the shape of the rest (${s}) along the non-concatenated axis ${i}.`)})}function Sa(t,e){const n=t[0].slice();for(let s=1;s<t.length;s++)n[e]+=t[s][e];return n}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var No;(function(t){t[t.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",t[t.VALUE_ROWIDS=1]="VALUE_ROWIDS",t[t.ROW_LENGTHS=2]="ROW_LENGTHS",t[t.ROW_SPLITS=3]="ROW_SPLITS",t[t.ROW_LIMITS=4]="ROW_LIMITS",t[t.ROW_STARTS=5]="ROW_STARTS"})(No||(No={}));function M8(t,e,n){let s=new Array;if(n==null&&e==null)return s;if(e==null)for(;s.length<t+n.length;)s.push(-1);else s=e.slice();if(n==null)return s;if(t+n.length!==s.length)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.rank = ${t+n.length}, but shape.rank = ${s.length}`);for(let r=1;r<n.length;++r){const i=n[r],o=s[s.length-n.length+r],a=s[o];if(i>=0)if(a>=0){if(a!==i)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.shape[${r+t}] = ${i} but shape[${r+t}] = ${a}`)}else s[o]=i}return s}function z8(t){const e={FIRST_DIM_SIZE:No.FIRST_DIM_SIZE,VALUE_ROWIDS:No.VALUE_ROWIDS,ROW_LENGTHS:No.ROW_LENGTHS,ROW_SPLITS:No.ROW_SPLITS,ROW_LIMITS:No.ROW_LIMITS,ROW_STARTS:No.ROW_STARTS},n=[];for(const s of t)if(s in e)n.push(e[s]);else break;return n}function V8(t){return t.length===0?0:t[0]===No.FIRST_DIM_SIZE?t.length-1:t.length}function j8(t,e){if(t==null||e==null)return;const n=t.length,s=e.length;if(n>=s)throw new Error(`defaultValue.shape=${t} and ragged tensor flatValues.shape=${e}, are incompatible: defaultValue.rank = ${n} must be less than ragged tensor input flatValues.rank = ${s})`);for(let r=0;r<Math.min(n,s-1);++r){const i=t[r],o=e[r+1];if(i>=0&&o>=0&&i!==1&&i!==o)throw new Error(`defaultValue.shape=${t}, and ragged tensor input flatValues.shape=${e} are incompatible: defaultValue.shape[${r-t.length}] = ${i} but ragged tensor input.flatValues.shape[${r-t.length}] = ${o}`)}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ER=30;function XS(t){return t<=ER?t:E2(t,Math.floor(Math.sqrt(t)))}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $R(t,e,n){const s=n*(typeof t=="number"?t:t[0]),r=e*(typeof t=="number"?t:t[1]);return[s,r]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C0(t,e,n,s=!0){let r=[];if(s)r=r.concat(e.slice(0)),r.push(t[0]/n),r=r.concat(t.slice(1));else{r=r.concat(t[0]);const i=e.length;for(let o=0;o<i;++o)r=r.concat([t[o+1]/e[o],e[o]]);r=r.concat(t.slice(i+1))}return r}function T0(t,e,n=!0){const s=[];if(n){s.push(e);for(let r=e+1;r<t;++r)r<=2*e?(s.push(r),s.push(r-(e+1))):s.push(r)}else{const r=[],i=[];for(let o=1;o<t;++o)o>=e*2+1||o%2===1?i.push(o):r.push(o);s.push(...r),s.push(0),s.push(...i)}return s}function N0(t,e,n,s=!0){const r=[];s?r.push(t[0]/n):r.push(t[0]*n);for(let i=1;i<t.length;++i)i<=e.length?s?r.push(e[i-1]*t[i]):r.push(t[i]/e[i-1]):r.push(t[i]);return r}function AR(t,e){const n=[0];for(let s=0;s<e;++s)n.push(t[s][0]);return n}function RR(t,e,n){const s=t.slice(0,1);for(let r=0;r<n;++r)s.push(t[r+1]-e[r][0]-e[r][1]);return s}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YS=1.7580993408473768,ZS=1.0507009873554805;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DR=.3275911,OR=.254829592,PR=-.284496736,FR=1.421413741,LR=-1.453152027,MR=1.061405429;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xl(t,e){if(t.length!==e.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${t.length}, imag: ${e.length}.`);const n=new Float32Array(t.length*2);for(let s=0;s<n.length;s+=2)n[s]=t[s/2],n[s+1]=e[s/2];return n}function B8(t){const e=new Float32Array(t.length/2),n=new Float32Array(t.length/2);for(let s=0;s<t.length;s+=2)e[s/2]=t[s],n[s/2]=t[s+1];return{real:e,imag:n}}function W8(t){const e=Math.ceil(t.length/4),n=new Float32Array(e),s=new Float32Array(e);for(let r=0;r<t.length;r+=4)n[Math.floor(r/4)]=t[r],s[Math.floor(r/4)]=t[r+1];return{real:n,imag:s}}function U8(t){const e=Math.floor(t.length/4),n=new Float32Array(e),s=new Float32Array(e);for(let r=2;r<t.length;r+=4)n[Math.floor(r/4)]=t[r],s[Math.floor(r/4)]=t[r+1];return{real:n,imag:s}}function zR(t,e){const n=t[e*2],s=t[e*2+1];return{real:n,imag:s}}function H8(t,e,n,s){t[s*2]=e,t[s*2+1]=n}function G8(t,e){const n=new Float32Array(t/2),s=new Float32Array(t/2);for(let r=0;r<Math.ceil(t/2);r++){const i=(e?2:-2)*Math.PI*(r/t);n[r]=Math.cos(i),s[r]=Math.sin(i)}return{real:n,imag:s}}function K8(t,e,n){const s=(n?2:-2)*Math.PI*(t/e),r=Math.cos(s),i=Math.sin(s);return{real:r,imag:i}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KC="->",hSe=/->/g,q3=",",X3="...";function VR(t,e){t=t.replace(/\s/g,"");const n=(t.length-t.replace(hSe,"").length)/KC.length;if(n<1)throw new Error("Equations without an arrow are not supported.");if(n>1)throw new Error(`Equation must contain exactly one arrow ("${KC}").`);const[s,r]=t.split(KC);O(s.indexOf(X3)===-1,()=>`The ellipsis notation ("${X3}") is not supported yet.`);const i=s.split(q3),o=i.length;if(e!==o)throw new Error(`Expected ${o} input tensors, received ${e}`);if(o>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");const a=[];for(let h=0;h<r.length;++h){const f=r[h];if(!i.some(p=>p.indexOf(f)!==-1))throw new Error(`Output subscripts contain the label ${f} not present in the input subscripts.`);a.indexOf(f)===-1&&a.push(f)}for(let h=0;h<s.length;++h){const f=s[h];a.indexOf(f)===-1&&f!==q3&&a.push(f)}const l=new Array(i.length);for(let h=0;h<o;++h){if(new Set(i[h].split("")).size!==i[h].length)throw new Error(`Found duplicate axes in input component ${i[h]}. Support for duplicate axes in input is not implemented yet.`);l[h]=[];for(let f=0;f<i[h].length;++f)l[h].push(a.indexOf(i[h][f]))}const c=a.length,u=r.length,d=[];for(let h=u;h<c;++h)d.push(h);return{allDims:a,summedDims:d,idDims:l}}function jR(t,e){let n=new Array(t);n.fill(-1);for(let r=0;r<e.length;++r)n[e[r]]=r;const s=[];for(let r=0;r<t;++r)n[r]===-1&&s.push(r);return n=n.filter(r=>r!==-1),{permutationIndices:n,expandDims:s}}function BR(t,e,n){const s=new Array(t);for(let r=0;r<n.length;++r){const i=n[r].shape;for(let o=0;o<e[r].length;++o)s[e[r][o]]===void 0?s[e[r][o]]=i[o]:O(s[e[r][o]]===i[o],()=>`Expected dimension ${s[e[r][o]]} at axis ${o} of input shaped ${JSON.stringify(i)}, but got dimension ${i[o]}`)}}function WR(t,e){const n=t,s=[];let r=0;t.length===0&&n.push(-1),r=t.length+1;for(let o=0;o<r;++o)s.push([]);const i=[];for(let o=0;o<n.length;++o){const a=n[o],l=fSe(e,a);for(const c of l)i.indexOf(c)===-1&&(s[o].push(c),i.push(c))}return{path:n,steps:s}}function UR(t){return t.every((e,n)=>e===n)}function fSe(t,e){const n=[];for(let s=0;s<t.length;++s)(t[s].length===0||t[s].indexOf(e)!==-1||e===-1)&&n.push(s);return n}function HR(t,e,n=0){let s=[];if(typeof e=="number")O(t.shape[n]%e===0,()=>"Number of splits must evenly divide the axis."),s=new Array(e).fill(t.shape[n]/e);else{const r=e.reduce((o,a)=>(a===-1&&(o+=1),o),0);O(r<=1,()=>"There should be only one negative value in split array.");const i=e.indexOf(-1);if(i!==-1){const o=e.reduce((a,l)=>l>0?a+l:a);e[i]=t.shape[n]-o}O(t.shape[n]===e.reduce((o,a)=>o+a),()=>"The sum of sizes must match the size of the axis dimension."),s=e}return s}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function q8(t){return`Received SparseTensor with denseShape[0] = 0 but
  indices.shape[0] = ${t}`}function X8(t,e){return`indices(${t}, 0) is invalid: ${e} < 0`}function Y8(t,e,n){return`indices(${t}, 0) is invalid: ${e} >= ${n}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z8(t,e){return`only one output dimension may be -1, not both ${t} and ${e}`}function Q8(t,e){return`size ${t} must be non-negative, not ${e}`}function J8(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function eK(t,e){const n=le(t),s=le(e);return`Input to reshape is a SparseTensor with ${n}
  dense values, but the requested shape requires a multiple of ${s}. inputShape=${t} outputShape= ${e}`}function tK(t,e){const n=le(t),s=le(e);return`Input to reshape is a tensor with ${n} dense values, but the requested shape has ${s}. inputShape=${t} outputShape=${e}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q2(){return"segment ids must be >= 0"}function nK(){return"segment ids are not increasing"}function sK(t,e){return`Segment id ${t} out of range [0, ${e}), possibly because segmentIds input is not sorted.`}function rK(t,e,n){return`Bad: indices[${t}] == ${e} out of range [0, ${n})`}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iK(t,e){let n=!1,s;for(t<=ER?(s=t,n=!0):s=E2(t,Math.floor(Math.sqrt(t)));!n;)s>e||s===t?n=!0:s=E2(t,s+1);return s}function oK(t,e,n){const s=[],r=t.length;for(let i=0;i<r;i++)i!==e?s.push(t[i]):s.push(n);return s}function GR(t,e,n,s){const r=e.shape.length,i=t.shape.length;if(s!==0&&(s<-r||s>r))throw new Error(`Expect batchDims in the range of [-${r}, ${r}], but got ${s}`);if(s<0&&(s+=r),s>i)throw new Error(`batchDims (${s}) must be less than rank(x) (
    ${i}).`);if(n<s)throw new Error(`batchDims (${s}) must be less than or equal to axis (${n}).`);for(let d=0;d<s;++d)if(t.shape[d]!==e.shape[d])throw new Error(`x.shape[${d}]: ${t.shape[d]} should be equal to indices.shape[${d}]: ${e.shape[d]}.`);const o=t.shape[n],a=[];let l=1,c=1,u=1;for(let d=0;d<s;++d)a.push(t.shape[d]),l*=t.shape[d];for(let d=s;d<n;d++)a.push(t.shape[d]),c*=t.shape[d];for(let d=s;d<r;d++)a.push(e.shape[d]);for(let d=n+1;d<i;d++)a.push(t.shape[d]),u*=t.shape[d];return{batchSize:l,sliceSize:u,outerSize:c,dimSize:o,outputShape:a}}const pSe=Object.freeze(Object.defineProperty({__proto__:null,collectGatherOpShapeInfo:GR,computeOutShape:oK,segOpComputeOptimalWindowSize:iK},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cd(t){try{return t.map(e=>Mc(e))}catch(e){throw new Error(`Failed to decode encoded string bytes into utf-8, error: ${e}`)}}function aK(t){return t.map(e=>kc(e))}const mSe=Object.freeze(Object.defineProperty({__proto__:null,ERF_A1:OR,ERF_A2:PR,ERF_A3:FR,ERF_A4:LR,ERF_A5:MR,ERF_P:DR,PARALLELIZE_THRESHOLD:ER,get RowPartitionType(){return No},SELU_SCALE:ZS,SELU_SCALEALPHA:YS,applyActivation:GS,assertAndGetBroadcastShape:ct,assertAxesAreInnerMostDims:zs,assertParamsConsistent:_R,assignToTypedArray:H8,axesAreInnerMostDims:BA,calculateShapes:g0,checkEinsumDimSizes:BR,checkPadOnDimRoundingMode:cr,combineLocations:s8,combineRaggedTensorToTensorShapes:M8,complexWithEvenIndex:W8,complexWithOddIndex:U8,computeConv2DInfo:Ts,computeConv3DInfo:ru,computeDefaultPad:FA,computeDilation2DInfo:y0,computeOptimalWindowSize:XS,computeOutAndReduceShapes:Ns,computeOutShape:Sa,computePool2DInfo:uo,computePool3DInfo:wl,convertConv2DDataFormat:Sl,decodeEinsumEquation:VR,eitherStridesOrDilationsAreOne:Ms,expandShapeToKeepDim:Hn,exponent:K8,exponents:G8,fromStringArrayToUint8:aK,fromUint8ToStringArray:Cd,getAxesPermutation:In,getBroadcastDims:Df,getComplexWithIndex:zR,getEinsumComputePath:WR,getEinsumPermutation:jR,getFusedBiasGradient:HS,getFusedDyActivation:US,getImageCenter:$R,getInnerMostAxes:Gn,getPermuted:T0,getRaggedRank:V8,getReductionAxes:ps,getReshaped:C0,getReshapedPermuted:N0,getRowPartitionTypesHelper:z8,getSliceBeginCoords:AR,getSliceSize:RR,getSparseFillEmptyRowsIndicesDenseShapeMismatch:q8,getSparseFillEmptyRowsNegativeIndexErrorMessage:X8,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:Y8,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:J8,getSparseReshapeInputOutputMismatchErrorMessage:tK,getSparseReshapeInputOutputMultipleErrorMessage:eK,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:Z8,getSparseReshapeNegativeOutputDimErrorMessage:Q8,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:rK,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:Q2,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:nK,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:sK,getUndoAxesPermutation:iu,isIdentityPermutation:UR,log:_ge,mergeRealAndImagArrays:xl,prepareAndValidate:_A,prepareSplitSize:HR,segment_util:pSe,shouldFuse:KS,slice_util:r0e,splitRealAndImagArrays:B8,tupleValuesAreOne:Vc,upcastType:Zr,validateDefaultValueShape:j8,validateInput:SG,validateUpdateShape:wG,warn:pi},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gSe=oe();gSe.registerFlag("KEEP_INTERMEDIATE_TENSORS",()=>!1,t=>{t&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var ji;(function(t){t[t.DT_INVALID=0]="DT_INVALID",t[t.DT_FLOAT=1]="DT_FLOAT",t[t.DT_DOUBLE=2]="DT_DOUBLE",t[t.DT_INT32=3]="DT_INT32",t[t.DT_UINT8=4]="DT_UINT8",t[t.DT_INT16=5]="DT_INT16",t[t.DT_INT8=6]="DT_INT8",t[t.DT_STRING=7]="DT_STRING",t[t.DT_COMPLEX64=8]="DT_COMPLEX64",t[t.DT_INT64=9]="DT_INT64",t[t.DT_BOOL=10]="DT_BOOL",t[t.DT_QINT8=11]="DT_QINT8",t[t.DT_QUINT8=12]="DT_QUINT8",t[t.DT_QINT32=13]="DT_QINT32",t[t.DT_BFLOAT16=14]="DT_BFLOAT16",t[t.DT_QINT16=15]="DT_QINT16",t[t.DT_QUINT16=16]="DT_QUINT16",t[t.DT_UINT16=17]="DT_UINT16",t[t.DT_COMPLEX128=18]="DT_COMPLEX128",t[t.DT_HALF=19]="DT_HALF",t[t.DT_RESOURCE=20]="DT_RESOURCE",t[t.DT_VARIANT=21]="DT_VARIANT",t[t.DT_UINT32=22]="DT_UINT32",t[t.DT_UINT64=23]="DT_UINT64",t[t.DT_FLOAT_REF=101]="DT_FLOAT_REF",t[t.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",t[t.DT_INT32_REF=103]="DT_INT32_REF",t[t.DT_UINT8_REF=104]="DT_UINT8_REF",t[t.DT_INT16_REF=105]="DT_INT16_REF",t[t.DT_INT8_REF=106]="DT_INT8_REF",t[t.DT_STRING_REF=107]="DT_STRING_REF",t[t.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",t[t.DT_INT64_REF=109]="DT_INT64_REF",t[t.DT_BOOL_REF=110]="DT_BOOL_REF",t[t.DT_QINT8_REF=111]="DT_QINT8_REF",t[t.DT_QUINT8_REF=112]="DT_QUINT8_REF",t[t.DT_QINT32_REF=113]="DT_QINT32_REF",t[t.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",t[t.DT_QINT16_REF=115]="DT_QINT16_REF",t[t.DT_QUINT16_REF=116]="DT_QUINT16_REF",t[t.DT_UINT16_REF=117]="DT_UINT16_REF",t[t.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",t[t.DT_HALF_REF=119]="DT_HALF_REF",t[t.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",t[t.DT_VARIANT_REF=121]="DT_VARIANT_REF",t[t.DT_UINT32_REF=122]="DT_UINT32_REF",t[t.DT_UINT64_REF=123]="DT_UINT64_REF"})(ji||(ji={}));var Y3;(function(t){(function(e){e[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"})(t.CheckpointFormatVersion||(t.CheckpointFormatVersion={}))})(Y3||(Y3={}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ySe={};function lK(t){return ySe[t]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E(t,e,n,s,r){const i=e.inputParams[t];if(i&&i.inputIndexStart!==void 0){const a=i.inputIndexStart,l=i.inputIndexEnd===0?void 0:i.inputIndexEnd===void 0?a+1:i.inputIndexEnd;if(i.type==="tensor")return rr(e.inputNames[i.inputIndexStart],n,s,r);if(i.type==="tensors")return e.inputNames.slice(a,l).map(h=>rr(h,n,s,r));const c=rr(e.inputNames.slice(a)[0],n,s,r),u=c.dataSync();return i.type==="number"?u[0]:so(c.shape,u)}const o=e.attrParams[t];return o&&o.value}function rr(t,e,n,s){const[r,i]=zr(t);if(s!=null){const a=s.getHashTableHandleByName(r);if(a!=null)return a}const o=n.currentContextIds.find(a=>!!e[iw(r,a)]);return o!==void 0?e[iw(r,o)][i]:void 0}function xSe(t,e,n){return e[iw(t,n.currentContextId)]}function na(t,e){const[n,s,r]=zr(t);return[iw(n,e&&e.currentContextId),s,r]}function iw(t,e){return e?`${t}-${e}`:t}function zr(t){const e=t.split(":");if(e.length===1)return[t,0,void 0];const n=e[0],s=e.length===3?e[1]:void 0,r=Number(e[e.length-1]);return[n,r,s]}function Lv(t,e,n){let s=E("pad",t,e,n);if(s==="explicit"){s=E("explicitPaddings",t,e,n);const r=[[0,0],[0,0],[0,0],[0,0]];for(let i=0;i<4;i++)r[i][0]=s[i*2],r[i][1]=s[i*2+1];return r}return s}function qa(t){return t.kept?t:ll(t)}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vSe=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],bSe=Object.freeze(Object.defineProperty({__proto__:null,json:vSe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wSe=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"clipValueMin",type:"number"},{start:2,name:"clipValueMax",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Prod",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axes",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsNan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],SSe=Object.freeze(Object.defineProperty({__proto__:null,json:wSe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kSe=[{tfOpName:"EmptyTensorList",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"maxNumElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"}]},{tfOpName:"StatelessIf",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"If",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"StatelessWhile",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"While",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"TensorListScatter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListScatterV2",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"},{start:3,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGather",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListSetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListReserve",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListFromTensor",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListStack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"},{tfName:"num_elements",name:"numElements",type:"dtype"}]},{tfOpName:"TensorListSplit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"},{start:2,name:"lengths",type:"number[]"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcat",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcatV2",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPopBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPushBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListLength",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}]},{tfOpName:"TensorListResize",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"size",type:"number"}]}],CSe=Object.freeze(Object.defineProperty({__proto__:null,json:kSe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TSe=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[],notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Dilation2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"rates",name:"dilations",type:"number[]"},{tfName:"padding",name:"pad",type:"string"}]}],NSe=Object.freeze(Object.defineProperty({__proto__:null,json:TSe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ISe=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomStandardNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}],_Se=Object.freeze(Object.defineProperty({__proto__:null,json:ISe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ESe=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV4",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"T_threshold",name:"threshold",type:"dtype",notSupported:!0},{tfName:"pad_to_max_output_size",name:"padToMaxOutputSize",type:"bool"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],$Se=Object.freeze(Object.defineProperty({__proto__:null,json:ESe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ASe=[{tfOpName:"LowerBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]},{tfOpName:"UpperBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"Unique",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"UniqueV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]}],RSe=Object.freeze(Object.defineProperty({__proto__:null,json:ASe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DSe=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}],OSe=Object.freeze(Object.defineProperty({__proto__:null,json:DSe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PSe=[{tfOpName:"HashTable",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"HashTableV2",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"LookupTableImport",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableImportV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFind",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFindV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableSize",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"LookupTableSizeV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]}],FSe=Object.freeze(Object.defineProperty({__proto__:null,json:PSe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LSe=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]},{tfOpName:"ImageProjectiveTransformV3",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"transforms",type:"tensor"},{start:2,name:"outputShape",type:"number[]"},{start:3,name:"fillValue",type:"number"}],attrs:[{tfName:"interpolation",name:"interpolation",type:"string"},{tfName:"fill_mode",name:"fillMode",type:"string"}]}],MSe=Object.freeze(Object.defineProperty({__proto__:null,json:LSe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zSe=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],VSe=Object.freeze(Object.defineProperty({__proto__:null,json:zSe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jSe=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Einsum",category:"matrices",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"equation",name:"equation",type:"string"},{tfName:"N",name:"n",type:"number",defaultValue:2},{tfName:"T",name:"dtype",type:"dtype"}]}],BSe=Object.freeze(Object.defineProperty({__proto__:null,json:jSe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WSe=[{tfOpName:"EuclideanNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",defaultValue:!1}]},{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"SparseToDense",category:"normalization",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!0,notSupported:!0}]}],USe=Object.freeze(Object.defineProperty({__proto__:null,json:WSe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HSe=[{tfOpName:"Bincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}]},{tfOpName:"DenseBincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}],attrs:[{tfName:"binary_output",name:"binaryOutput",type:"bool"}]},{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Cumprod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]},{tfOpName:"Cumsum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]}],GSe=Object.freeze(Object.defineProperty({__proto__:null,json:HSe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KSe=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}],attrs:[{tfName:"batch_dims",name:"batchDims",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool[]"}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]}],qSe=Object.freeze(Object.defineProperty({__proto__:null,json:KSe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XSe=[{tfOpName:"SparseFillEmptyRows",category:"sparse",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"denseShape",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}]},{tfOpName:"SparseReshape",category:"sparse",inputs:[{start:0,name:"inputIndices",type:"tensor"},{start:1,name:"inputShape",type:"tensor"},{start:2,name:"newShape",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SparseSegmentMean",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]},{tfOpName:"SparseSegmentSum",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]}],YSe=Object.freeze(Object.defineProperty({__proto__:null,json:XSe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZSe=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}],QSe=Object.freeze(Object.defineProperty({__proto__:null,json:ZSe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JSe=[{tfOpName:"StringNGrams",category:"string",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"dataSplits",type:"tensor"}],attrs:[{tfName:"separator",name:"separator",type:"string"},{tfName:"ngram_widths",name:"nGramWidths",type:"number[]"},{tfName:"left_pad",name:"leftPad",type:"string"},{tfName:"right_pad",name:"rightPad",type:"string"},{tfName:"pad_width",name:"padWidth",type:"number"},{tfName:"preserve_short_sequences",name:"preserveShortSequences",type:"bool"}],outputs:["ngrams","ngrams_splits"]},{tfOpName:"StringSplit",category:"string",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"delimiter",type:"tensor"}],attrs:[{tfName:"skip_empty",name:"skipEmpty",type:"bool"}],outputs:["indices","values","shape"]},{tfOpName:"StringToHashBucketFast",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"num_buckets",name:"numBuckets",type:"number"}]}],eke=Object.freeze(Object.defineProperty({__proto__:null,json:JSe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tke=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"MirrorPad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"mode",name:"mode",type:"string"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]},{tfOpName:"BroadcastTo",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}],attrs:[]},{tfOpName:"BroadcastArgs",category:"transformation",inputs:[{start:0,name:"s0",type:"tensor"},{start:1,name:"s1",type:"tensor"}],attrs:[]}],nke=Object.freeze(Object.defineProperty({__proto__:null,json:tke},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Z3{static get Instance(){return this._instance||(this._instance=new this)}constructor(){const e=[bSe,SSe,CSe,NSe,_Se,$Se,RSe,OSe,FSe,MSe,VSe,BSe,USe,GSe,qSe,YSe,QSe,eke,nke],n=[].concat(...e.map(s=>s.json));this.opMappers=n.reduce((s,r)=>(s[r.tfOpName]=r,s),{})}transformGraph(e,n={}){const s=e.node,r=[],i=[],o=[],a=s.reduce((m,g)=>(m[g.name]=this.mapNode(g),g.op.startsWith("Placeholder")?r.push(m[g.name]):g.op==="Const"?i.push(m[g.name]):(g.input==null||g.input.length===0)&&o.push(m[g.name]),m),{});let l=[];const c=[];let u={},d={};n!=null&&(u=this.mapSignatureEntries(n.inputs),d=this.mapSignatureEntries(n.outputs));const h=Object.keys(a);h.forEach(m=>{const g=a[m];g.inputNames.forEach((y,x)=>{const[v,,b]=na(y),k=a[v];if(k.outputs!=null){const C=k.outputs.indexOf(b);if(C!==-1){const N=`${v}:${C}`;g.inputNames[x]=N}}g.inputs.push(k),k.children.push(g)})}),Object.keys(d).length===0?h.forEach(m=>{const g=a[m];g.children.length===0&&c.push(g)}):Object.keys(d).forEach(m=>{const[g]=na(m),y=a[g];y!=null&&(y.signatureKey=d[m],c.push(y))}),Object.keys(u).length>0?Object.keys(u).forEach(m=>{const[g]=na(m),y=a[g];y&&(y.signatureKey=u[m],l.push(y))}):l=r;let f={};e.library!=null&&e.library.function!=null&&(f=e.library.function.reduce((m,g)=>(m[g.signature.name]=this.mapFunction(g),m),{}));const p={nodes:a,inputs:l,outputs:c,weights:i,placeholders:r,signature:n,functions:f};return o.length>0&&(p.initNodes=o),p}mapSignatureEntries(e){return Object.keys(e||{}).reduce((n,s)=>(n[e[s].name]=s,n),{})}mapNode(e){const n=lK(e.op)||this.opMappers[e.op]||{};e.attr==null&&(e.attr={});const s={name:e.name,op:e.op,category:n.category,inputNames:(e.input||[]).map(r=>r.startsWith("^")?r.slice(1):r),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:e.attr,outputs:n.outputs};return n.inputs!=null&&(s.inputParams=n.inputs.reduce((r,i)=>(r[i.name]={type:i.type,inputIndexStart:i.start,inputIndexEnd:i.end},r),{})),n.attrs!=null&&(s.attrParams=n.attrs.reduce((r,i)=>{const o=i.type;let a;switch(i.type){case"string":a=J2(e.attr,i.tfName,i.defaultValue),a===void 0&&i.tfDeprecatedName&&(a=J2(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"string[]":a=oI(e.attr,i.tfName,i.defaultValue),a===void 0&&i.tfDeprecatedName&&(a=oI(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"number":a=tI(e.attr,i.tfName,i.defaultValue||0),a===void 0&&i.tfDeprecatedName&&(a=tI(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"number[]":a=iI(e.attr,i.tfName,i.defaultValue),a===void 0&&i.tfDeprecatedName&&(a=iI(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"bool":a=eI(e.attr,i.tfName,i.defaultValue),a===void 0&&i.tfDeprecatedName&&(a=eI(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"bool[]":a=lI(e.attr,i.tfName,i.defaultValue),a===void 0&&i.tfDeprecatedName&&(a=lI(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"shape":a=rI(e.attr,i.tfName,i.defaultValue),a===void 0&&i.tfDeprecatedName&&(a=rI(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"shape[]":a=aI(e.attr,i.tfName,i.defaultValue),a===void 0&&i.tfDeprecatedName&&(a=aI(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"dtype":a=nI(e.attr,i.tfName,i.defaultValue),a===void 0&&i.tfDeprecatedName&&(a=nI(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"dtype[]":a=sI(e.attr,i.tfName,i.defaultValue),a===void 0&&i.tfDeprecatedName&&(a=sI(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"func":a=Q3(e.attr,i.tfName,i.defaultValue),a===void 0&&i.tfDeprecatedName&&(a=Q3(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error(`Unsupported param type: ${i.type} for op: ${e.op}`)}return r[i.name]={value:a,type:o},r},{})),s}mapFunction(e){const n=e.nodeDef,s=[],r=[];let i={};n!=null&&(i=n.reduce((d,h)=>(d[h.name]=this.mapNode(h),h.op==="Const"&&r.push(d[h.name]),d),{}));const o=[],a=[];e.signature.inputArg.forEach(d=>{const[h]=na(d.name),f={name:h,op:"Placeholder",inputs:[],inputNames:[],category:"graph",inputParams:{},attrParams:{dtype:{value:KR(d.type),type:"dtype"}},children:[]};f.signatureKey=d.name,o.push(f),i[h]=f}),Object.keys(i).forEach(d=>{const h=i[d];h.inputNames.forEach((f,p)=>{const[m,,g]=na(f),y=i[m];if(y.outputs!=null){const x=y.outputs.indexOf(g);if(x!==-1){const v=`${m}:${x}`;h.inputNames[p]=v}}h.inputs.push(y),y.children.push(h)})});const c=e.ret;e.signature.outputArg.forEach(d=>{const[h,f]=na(c[d.name]),p=i[h];p!=null&&(p.defaultOutput=f,a.push(p))});const u=this.mapArgsToSignature(e);return{nodes:i,inputs:o,outputs:a,weights:r,placeholders:s,signature:u}}mapArgsToSignature(e){return{methodName:e.signature.name,inputs:e.signature.inputArg.reduce((n,s)=>(n[s.name]=this.mapArgToTensorInfo(s),n),{}),outputs:e.signature.outputArg.reduce((n,s)=>(n[s.name]=this.mapArgToTensorInfo(s,e.ret),n),{})}}mapArgToTensorInfo(e,n){let s=e.name;return n!=null&&(s=n[s]),{name:s,dtype:e.type}}}function ske(t){const e=oe().global;if(typeof e.atob<"u")return e.atob(t);if(typeof Buffer<"u")return new Buffer(t,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}function cK(t,e){const n=Array.isArray(t)?String.fromCharCode.apply(null,t):ske(t);return e?n:n.toLowerCase()}function J2(t,e,n,s=!1){const r=t[e];return r!=null?cK(r.s,s):n}function eI(t,e,n){const s=t[e];return s?s.b:n}function tI(t,e,n){const s=t[e]||{},r=s.i!=null?s.i:s.f!=null?s.f:n;return typeof r=="number"?r:parseInt(r,10)}function KR(t){switch(typeof t=="string"&&(t=ji[t]),t){case ji.DT_FLOAT:case ji.DT_HALF:return"float32";case ji.DT_INT32:case ji.DT_INT64:case ji.DT_INT8:case ji.DT_UINT8:return"int32";case ji.DT_BOOL:return"bool";case ji.DT_DOUBLE:return"float32";case ji.DT_STRING:return"string";default:return null}}function Q3(t,e,n){const s=t[e];return s&&s.func?s.func.name:n}function nI(t,e,n){const s=t[e];return s&&s.type?KR(s.type):n}function sI(t,e,n){const s=t[e];return s&&s.list&&s.list.type?s.list.type.map(r=>KR(r)):n}function uK(t){if(!t.unknownRank)return t.dim!=null?t.dim.map(e=>typeof e.size=="number"?e.size:parseInt(e.size,10)):[]}function rI(t,e,n){const s=t[e];return s&&s.shape?uK(s.shape):n}function iI(t,e,n){const s=t[e];return s?((s.list.f&&s.list.f.length?s.list.f:s.list.i)||[]).map(r=>typeof r=="number"?r:parseInt(r,10)):n}function oI(t,e,n,s=!1){const r=t[e];return r&&r.list&&r.list.s?r.list.s.map(i=>cK(i,s)):n}function aI(t,e,n){const s=t[e];return s&&s.list&&s.list.shape?s.list.shape.map(r=>uK(r)):n}function lI(t,e,n){const s=t[e];return s&&s.list&&s.list.b?s.list.b:n}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class rke{constructor(e,n,s){this.node=e,this.tensorMap=n,this.context=s,this.inputs=[],this.attrs={},this.inputs=e.inputNames.map(r=>this.getInput(r)),e.rawAttrs!=null&&(this.attrs=Object.keys(e.rawAttrs).reduce((r,i)=>(r[i]=this.getAttr(i),r),{}))}getInput(e){return rr(e,this.tensorMap,this.context)}getAttr(e,n){const s=this.node.rawAttrs[e];if(s.tensor!=null)return rr(e,this.tensorMap,this.context);if(s.i!=null||s.f!=null)return tI(this.node.rawAttrs,e,n);if(s.s!=null)return J2(this.node.rawAttrs,e,n);if(s.b!=null)return eI(this.node.rawAttrs,e,n);if(s.shape!=null)return rI(this.node.rawAttrs,e,n);if(s.type!=null)return nI(this.node.rawAttrs,e,n);if(s.list!=null){if(s.list.i!=null||s.list.f!=null)return iI(this.node.rawAttrs,e,n);if(s.list.s!=null)return oI(this.node.rawAttrs,e,n);if(s.list.shape!=null)return aI(this.node.rawAttrs,e,n);if(s.list.b!=null)return lI(this.node.rawAttrs,e,n);if(s.list.type!=null)return sI(this.node.rawAttrs,e,n)}return n}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zs=Object.freeze(Object.defineProperty({__proto__:null,OP_SCOPE_SUFFIX:Q6,abs:os,acos:AG,acosh:RG,add:fe,addN:f0e,all:PA,any:tw,argMax:Sd,argMin:DG,asin:OG,asinh:PG,atan:FG,atan2:LG,atanh:MG,avgPool:_S,avgPool3d:zG,basicLSTMCell:P0e,batchNorm:x0,batchNorm2d:VG,batchNorm3d:jG,batchNorm4d:BG,batchToSpaceND:ES,bincount:WG,booleanMaskAsync:pwe,broadcastArgs:U0e,broadcastTo:Cc,buffer:gt,cast:Te,ceil:UG,clipByValue:Tr,clone:ll,complex:zc,concat:Cn,concat1d:HG,concat2d:GG,concat3d:KG,concat4d:qG,conv1d:LA,conv2d:jc,conv2dTranspose:zA,conv3d:XG,conv3dTranspose:ZG,cos:$S,cosh:VA,cosineWindow:gR,cumprod:sw,cumsum:jA,denseBincount:uxe,depthToSpace:QG,depthwiseConv2d:v0,diag:pxe,dilation2d:JG,div:$e,divNoNan:e8,dot:t8,dropout:I8,einsum:Sxe,elu:b0,enclosingPowerOfTwo:_8,equal:Mo,erf:n8,euclideanNorm:i8,exp:Ir,expandDims:as,expm1:o8,eye:WA,fft:BS,fill:ap,floor:w0,floorDiv:OA,fused:Pwe,gather:Tc,gatherND:kwe,greater:Ei,greaterEqual:Md,ifft:Eg,imag:NS,image:ha,inTopKAsync:Iwe,irfft:dR,isFinite:a8,isInf:l8,isNaN:c8,leakyRelu:AS,less:UA,lessEqual:zd,linalg:F8,linspace:qxe,localResponseNormalization:u8,log:Ti,log1p:RS,logSigmoid:d8,logSoftmax:HA,logSumExp:GA,logicalAnd:Ea,logicalNot:DS,logicalOr:KA,logicalXor:h8,losses:lSe,lowerBound:cve,matMul:Ct,max:ro,maxPool:OS,maxPool3d:f8,maxPoolWithArgmax:fve,maximum:Oa,mean:Dn,meshgrid:gve,min:rw,minimum:S0,mirrorPad:p8,mod:m8,moments:PS,movingAverage:gwe,mul:Y,multiRNNCell:Sve,multinomial:Cve,neg:vn,norm:kd,notEqual:Pf,oneHot:IA,ones:gi,onesLike:Ni,op:X,outerProduct:_ve,pad:$a,pad1d:Ave,pad2d:Dve,pad3d:Pve,pad4d:Lve,pool:g8,pow:Bc,prelu:LS,print:dG,prod:y8,raggedGather:Hve,raggedTensorToTensor:Kve,rand:Xve,randomGamma:mbe,randomNormal:nR,randomStandardNormal:xbe,randomUniform:k0,range:Ig,real:Ng,reciprocal:v8,relu:Pa,relu6:sR,reshape:Q,reverse:ao,reverse1d:Tbe,reverse2d:Ibe,reverse3d:Ebe,reverse4d:Abe,rfft:WS,round:rR,rsqrt:iR,scalar:Ge,scatterND:xwe,searchSorted:qA,selu:oR,separableConv2d:aR,setdiff1dAsync:Lbe,sigmoid:bi,sign:b8,signal:aSe,sin:lR,sinh:cR,slice:st,slice1d:zS,slice2d:uR,slice3d:VS,slice4d:_g,softmax:jS,softplus:lp,spaceToBatchND:FS,sparse:cSe,sparseToDense:wwe,spectral:oSe,split:Yr,sqrt:Ys,square:Zt,squaredDifference:hR,squeeze:Bt,stack:lo,step:cp,stridedSlice:w8,string:uSe,sub:Ae,sum:Be,tan:S8,tanh:Of,tensor:wa,tensor1d:cs,tensor2d:cl,tensor3d:bG,tensor4d:swe,tensor5d:rwe,tensor6d:iwe,tile:Ji,topk:k8,transpose:Nt,truncatedNormal:fR,unique:C8,unsortedSegmentSum:pR,unstack:zo,upperBound:dwe,variable:T8,where:Nr,whereAsync:N8,zeros:es,zerosLike:_t},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ike=(t,e,n,s=Zs)=>{switch(t.op){case"BiasAdd":case"AddV2":case"Add":return[s.add(E("a",t,e,n),E("b",t,e,n))];case"AddN":return[s.addN(E("tensors",t,e,n))];case"FloorMod":case"Mod":return[s.mod(E("a",t,e,n),E("b",t,e,n))];case"Mul":return[s.mul(E("a",t,e,n),E("b",t,e,n))];case"RealDiv":case"Div":return[s.div(E("a",t,e,n),E("b",t,e,n))];case"DivNoNan":return[s.divNoNan(E("a",t,e,n),E("b",t,e,n))];case"FloorDiv":return[s.floorDiv(E("a",t,e,n),E("b",t,e,n))];case"Sub":return[s.sub(E("a",t,e,n),E("b",t,e,n))];case"Minimum":return[s.minimum(E("a",t,e,n),E("b",t,e,n))];case"Maximum":return[s.maximum(E("a",t,e,n),E("b",t,e,n))];case"Pow":return[s.pow(E("a",t,e,n),E("b",t,e,n))];case"SquaredDifference":return[s.squaredDifference(E("a",t,e,n),E("b",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oke=(t,e,n,s=Zs)=>{switch(t.op){case"Abs":case"ComplexAbs":return[s.abs(E("x",t,e,n))];case"Acos":return[s.acos(E("x",t,e,n))];case"Acosh":return[s.acosh(E("x",t,e,n))];case"Asin":return[s.asin(E("x",t,e,n))];case"Asinh":return[s.asinh(E("x",t,e,n))];case"Atan":return[s.atan(E("x",t,e,n))];case"Atan2":return[s.atan2(E("x",t,e,n),E("y",t,e,n))];case"Atanh":return[s.atanh(E("x",t,e,n))];case"Ceil":return[s.ceil(E("x",t,e,n))];case"Complex":return[s.complex(E("real",t,e,n),E("imag",t,e,n))];case"Cos":return[s.cos(E("x",t,e,n))];case"Cosh":return[s.cosh(E("x",t,e,n))];case"Elu":return[s.elu(E("x",t,e,n))];case"Erf":return[s.erf(E("x",t,e,n))];case"Exp":return[s.exp(E("x",t,e,n))];case"Expm1":return[s.expm1(E("x",t,e,n))];case"Floor":return[s.floor(E("x",t,e,n))];case"Log":return[s.log(E("x",t,e,n))];case"Log1p":return[s.log1p(E("x",t,e,n))];case"Imag":return[s.imag(E("x",t,e,n))];case"Neg":return[s.neg(E("x",t,e,n))];case"Reciprocal":return[s.reciprocal(E("x",t,e,n))];case"Real":return[s.real(E("x",t,e,n))];case"Relu":return[s.relu(E("x",t,e,n))];case"Round":return[s.round(E("x",t,e,n))];case"Selu":return[s.selu(E("x",t,e,n))];case"Sigmoid":return[s.sigmoid(E("x",t,e,n))];case"Sin":return[s.sin(E("x",t,e,n))];case"Sign":return[s.sign(E("x",t,e,n))];case"Sinh":return[s.sinh(E("x",t,e,n))];case"Softplus":return[s.softplus(E("x",t,e,n))];case"Sqrt":return[s.sqrt(E("x",t,e,n))];case"Square":return[s.square(E("x",t,e,n))];case"Tanh":return[s.tanh(E("x",t,e,n))];case"Tan":return[s.tan(E("x",t,e,n))];case"ClipByValue":return[s.clipByValue(E("x",t,e,n),E("clipValueMin",t,e,n),E("clipValueMax",t,e,n))];case"Relu6":return[s.relu6(E("x",t,e,n))];case"Rsqrt":return[s.rsqrt(rr(t.inputNames[0],e,n))];case"Prod":return[s.prod(E("x",t,e,n),E("axes",t,e,n))];case"LeakyRelu":return[s.leakyRelu(E("x",t,e,n),E("alpha",t,e,n))];case"Prelu":return[s.prelu(E("x",t,e,n),E("alpha",t,e,n))];case"IsNan":return[s.isNaN(rr(t.inputNames[0],e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ui(t,e,n=""){if(!(typeof t=="number"||typeof e=="number")){O(t.length===e.length,()=>n+` Shapes ${t} and ${e} must match`);for(let s=0;s<t.length;s++){const r=t[s],i=e[s];O(r<0||i<0||r===i,()=>n+` Shapes ${t} and ${e} must match`)}}}function J3(t){return!(typeof t=="number"||t.some(e=>e<0))}function Yp(t,e,n){let s=cI(t,n);const r=!J3(s);if(r&&e.length===0)throw new Error(`Tried to calculate elements of an empty list with non-fully-defined elementShape: ${s}`);if(r&&e.forEach(i=>{s=cI(i.shape,s)}),!J3(s))throw new Error(`Non-fully-defined elementShape: ${s}`);return s}function cI(t,e){if(typeof t=="number")return e;if(typeof e=="number")return t;if(t.length!==e.length)throw new Error(`Incompatible ranks during merge: ${t} vs. ${e}`);const n=[];for(let s=0;s<t.length;++s){const r=t[s],i=e[s];if(r>=0&&i>=0&&r!==i)throw new Error(`Incompatible shape during merge: ${t} vs. ${e}`);n[s]=r>=0?r:i}return n}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ake{constructor(e,n,s,r,i,o,a){this.name=e,this.dtype=n,this.maxSize=s,this.elementShape=r,this.identicalElementShapes=i,this.dynamicSize=o,this.clearAfterRead=a,this.tensors=[],this.closed_=!1,this.idTensor=Ge(0),Ps(this.idTensor)}get id(){return this.idTensor.id}get closed(){return this.closed_}clearAndClose(e){this.tensors.forEach(n=>{(e==null||!e.has(n.tensor.id))&&n.tensor.dispose()}),this.tensors=[],this.closed_=!0,this.idTensor.dispose()}size(){return this.tensors.length}read(e){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(e<0||e>=this.size())throw new Error(`Tried to read from index ${e}, but array size is: ${this.size()}`);const n=this.tensors[e];if(n.cleared)throw new Error(`TensorArray ${this.name}: Could not read index ${e} twice because it was cleared after a previous read (perhaps try setting clear_after_read = false?).`);return this.clearAfterRead&&(n.cleared=!0),n.read=!0,n.tensor}readMany(e){return e.map(n=>this.read(n))}write(e,n){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(e<0||!this.dynamicSize&&e>=this.maxSize)throw new Error(`Tried to write to index ${e}, but array is not resizeable and size is: ${this.maxSize}`);const s=this.tensors[e]||{};if(n.dtype!==this.dtype)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e},
          because the value dtype is ${n.dtype}, but TensorArray dtype is ${this.dtype}.`);if(this.size()===0&&(this.elementShape==null||this.elementShape.length===0)&&(this.elementShape=n.shape),Ui(this.elementShape,n.shape,`TensorArray ${this.name}: Could not write to TensorArray index ${e}.`),s.read)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e}, because it has already been read.`);if(s.written)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e}, because it has already been written.`);s.tensor=n,Ps(n),s.written=!0,this.tensors[e]=s}writeMany(e,n){if(e.length!==n.length)throw new Error(`TensorArray ${this.name}: could not write multiple tensors,because the index size: ${e.length} is not the same as tensors size: ${n.length}.`);e.forEach((s,r)=>this.write(s,n[r]))}gather(e,n){if(n&&n!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but gather requested dtype ${n}`);if(e)e=e.slice(0,this.size());else{e=[];for(let r=0;r<this.size();r++)e.push(r)}if(e.length===0)return wa([],[0].concat(this.elementShape));const s=this.readMany(e);return Ui(this.elementShape,s[0].shape,"TensorArray shape mismatch: "),lo(s,0)}concat(e){if(e&&e!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but concat requested dtype ${e}`);if(this.size()===0)return wa([],[0].concat(this.elementShape));const n=[];for(let r=0;r<this.size();r++)n.push(r);const s=this.readMany(n);return Ui(this.elementShape,s[0].shape,`TensorArray shape mismatch: tensor array shape (${this.elementShape}) vs first tensor shape (${s[0].shape})`),Cn(s,0)}scatter(e,n){if(n.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${n.dtype}`);if(e.length!==n.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${e.length} vs. ${n.shape[0]}`);const s=Math.max(...e);if(!this.dynamicSize&&s>=this.maxSize)throw new Error(`Max index must be < array size (${s}  vs. ${this.maxSize})`);this.writeMany(e,zo(n,0))}split(e,n){if(n.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${n.dtype}`);let s=0;const r=e.map(l=>(s+=l,s));if(s!==n.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${s}, and tensor's shape is: ${n.shape}`);if(!this.dynamicSize&&e.length!==this.maxSize)throw new Error(`TensorArray's size is not equal to the size of lengths (${this.maxSize} vs. ${e.length}), and the TensorArray is not marked as dynamically resizeable`);const i=s===0?0:n.size/s,o=[];se(()=>{n=Q(n,[1,s,i]);for(let l=0;l<e.length;++l){const u=[0,l===0?0:r[l-1],0],d=[1,e[l],i];o[l]=Q(st(n,u,d),this.elementShape)}return o});const a=[];for(let l=0;l<e.length;l++)a[l]=l;this.writeMany(a,o)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Td{constructor(e,n,s,r=-1){this.tensors=e,this.elementShape=n,this.elementDtype=s,e!=null&&e.forEach(i=>{if(s!==i.dtype)throw new Error(`Invalid data types; op elements ${s}, but list elements ${i.dtype}`);Ui(n,i.shape,"TensorList shape mismatch: "),Ps(i)}),this.idTensor=Ge(0),this.maxNumElements=r,Ps(this.idTensor)}get id(){return this.idTensor.id}copy(){return new Td([...this.tensors],this.elementShape,this.elementDtype)}clearAndClose(e){this.tensors.forEach(n=>{(e==null||!e.has(n.id))&&n.dispose()}),this.tensors.length=0,this.idTensor.dispose()}size(){return this.tensors.length}stack(e,n,s=-1){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);if(s!==-1&&this.tensors.length!==s)throw new Error(`Operation expected a list with ${s} elements but got a list with ${this.tensors.length} elements.`);Ui(e,this.elementShape,"TensorList shape mismatch: ");const r=Yp(this.elementShape,this.tensors,e);return se(()=>{const i=this.tensors.map(o=>Q(o,r));return lo(i,0)})}popBack(e,n){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);if(this.size()===0)throw new Error("Trying to pop from an empty list.");const s=Yp(this.elementShape,this.tensors,e),r=this.tensors.pop();return r.kept=!1,Ui(r.shape,e,"TensorList shape mismatch: "),Q(r,s)}pushBack(e){if(e.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${e.dtype}, but list elements ${this.elementDtype}`);if(Ui(e.shape,this.elementShape,"TensorList shape mismatch: "),this.maxNumElements===this.size())throw new Error("Trying to push element into a full list.");Ps(e),this.tensors.push(e)}resize(e){if(e<0)throw new Error(`TensorListResize expects size to be non-negative. Got: ${e}`);if(this.maxNumElements!==-1&&e>this.maxNumElements)throw new Error(`TensorListResize input size ${e} is greater maxNumElement ${this.maxNumElements}.`);const n=new Td([],this.elementShape,this.elementDtype,this.maxNumElements);n.tensors.length=e;for(let s=0;s<Math.min(this.tensors.length,e);++s)n.tensors[s]=this.tensors[s];return n}getItem(e,n,s){if(s!==this.elementDtype)throw new Error(`Invalid data types; op elements ${s}, but list elements ${this.elementDtype}`);if(e<0||e>this.tensors.length)throw new Error(`Trying to access element ${e} in a list with ${this.tensors.length} elements.`);if(this.tensors[e]==null)throw new Error(`element at index ${e} is null.`);Ui(this.tensors[e].shape,n,"TensorList shape mismatch: ");const r=Yp(this.elementShape,this.tensors,n);return Q(this.tensors[e],r)}setItem(e,n){if(n.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n.dtype}, but list elements ${this.elementDtype}`);if(e<0||this.maxNumElements!==-1&&e>=this.maxNumElements)throw new Error(`Trying to set element ${e} in a list with max ${this.maxNumElements} elements.`);Ui(this.elementShape,n.shape,"TensorList shape mismatch: "),Ps(n),this.tensors[e]!=null&&(this.tensors[e].kept=!1),this.tensors[e]=n}gather(e,n,s){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);Ui(this.elementShape,s,"TensorList shape mismatch: "),e=e.slice(0,this.size());const r=Yp(this.elementShape,this.tensors,s);return e.length===0?wa([],[0].concat(r)):se(()=>{const i=e.map(o=>Q(this.tensors[o],r));return lo(i,0)})}concat(e,n){if(e&&e!==this.elementDtype)throw new Error(`TensorList dtype is ${this.elementDtype} but concat requested dtype ${e}`);Ui(this.elementShape,n,"TensorList shape mismatch: ");const s=Yp(this.elementShape,this.tensors,n);return this.size()===0?wa([],[0].concat(s)):se(()=>{const r=this.tensors.map(i=>Q(i,s));return Cn(r,0)})}}function lke(t,e,n){const s=t.dtype;if(t.shape.length<1)throw new Error(`Tensor must be at least a vector, but saw shape: ${t.shape}`);if(t.dtype!==n)throw new Error(`Invalid data types; op elements ${t.dtype}, but list elements ${n}`);const r=t.shape.slice(1);Ui(r,e,"TensorList shape mismatch: ");const i=zo(t);return new Td(i,e,s)}function cke(t,e,n,s){return new Td([],t,e,s)}function uke(t,e,n,s){if(e.length!==t.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${e.length} vs. ${t.shape[0]}`);const r=Math.max(...e);if(s!=null&&s!==-1&&r>=s)throw new Error(`Max index must be < array size (${r}  vs. ${s})`);const i=new Td([],n,t.dtype,s),o=zo(t,0);return e.forEach((a,l)=>{i.setItem(a,o[l])}),i}function dke(t,e,n){let s=0;const r=e.map(u=>(s+=u,s));if(s!==t.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${s}, and tensor's shape is: ${t.shape}`);const i=t.shape.slice(1),o=cI(i,n),a=s===0?0:t.size/s,l=se(()=>{const u=[];t=Q(t,[1,s,a]);for(let d=0;d<e.length;++d){const f=[0,d===0?0:r[d-1],0],p=[1,e[d],a];u[d]=Q(st(t,f,p),o)}return t.dispose(),u}),c=new Td([],n,t.dtype,e.length);for(let u=0;u<l.length;u++)c.setItem(u,l[u]);return c}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hke=async(t,e,n)=>{switch(t.op){case"If":case"StatelessIf":{const s=E("thenBranch",t,e,n),r=E("elseBranch",t,e,n),i=E("cond",t,e,n),o=E("args",t,e,n);return(await i.data())[0]?n.functionMap[s].executeFunctionAsync(o,n.tensorArrayMap,n.tensorListMap):n.functionMap[r].executeFunctionAsync(o,n.tensorArrayMap,n.tensorListMap)}case"While":case"StatelessWhile":{const s=E("body",t,e,n),r=E("cond",t,e,n),i=E("args",t,e,n),o=await n.functionMap[r].executeFunctionAsync(i,n.tensorArrayMap,n.tensorListMap),a=i.map(u=>u.id);let l=await o[0].data();o.forEach(u=>{!u.kept&&a.indexOf(u.id)===-1&&u.dispose()});let c=i;for(;l[0];){const u=c;c=await n.functionMap[s].executeFunctionAsync(c,n.tensorArrayMap,n.tensorListMap);const d=c.map(f=>f.id);u.forEach(f=>{!f.kept&&a.indexOf(f.id)===-1&&d.indexOf(f.id)===-1&&f.dispose()});const h=await n.functionMap[r].executeFunctionAsync(c,n.tensorArrayMap,n.tensorListMap);l=await h[0].data(),h.forEach(f=>{!f.kept&&a.indexOf(f.id)===-1&&d.indexOf(f.id)===-1&&f.dispose()})}return c}case"LoopCond":{const s=E("pred",t,e,n);return[qa(s)]}case"Switch":{const s=E("pred",t,e,n);let r=E("data",t,e,n);return r.kept||(r=qa(r)),(await s.data())[0]?[void 0,r]:[r,void 0]}case"Merge":{const s=t.inputNames.find(r=>rr(r,e,n)!==void 0);if(s){const r=rr(s,e,n);return[qa(r)]}return}case"Enter":{const s=E("frameName",t,e,n),r=E("tensor",t,e,n);return n.enterFrame(s),[qa(r)]}case"Exit":{const s=E("tensor",t,e,n);return n.exitFrame(),[qa(s)]}case"NextIteration":{const s=E("tensor",t,e,n);return n.nextIteration(),[qa(s)]}case"TensorArrayV3":{const s=E("size",t,e,n),r=E("dtype",t,e,n),i=E("elementShape",t,e,n),o=E("dynamicSize",t,e,n),a=E("clearAfterRead",t,e,n),l=E("identicalElementShapes",t,e,n),c=E("name",t,e,n),u=new ake(c,r,s,i,l,o,a);return n.addTensorArray(u),[u.idTensor,Ge(1)]}case"TensorArrayWriteV3":{const s=E("tensorArrayId",t,e,n),r=E("index",t,e,n),i=E("tensor",t,e,n),o=n.getTensorArray(s.id);return o.write(r,i),[o.idTensor]}case"TensorArrayReadV3":{const s=E("tensorArrayId",t,e,n),r=E("index",t,e,n);return[n.getTensorArray(s.id).read(r)]}case"TensorArrayGatherV3":{const s=E("tensorArrayId",t,e,n),r=E("indices",t,e,n),i=E("dtype",t,e,n);return[n.getTensorArray(s.id).gather(r,i)]}case"TensorArrayScatterV3":{const s=E("tensorArrayId",t,e,n),r=E("indices",t,e,n),i=E("tensor",t,e,n),o=n.getTensorArray(s.id);return o.scatter(r,i),[o.idTensor]}case"TensorArrayConcatV3":{const s=E("tensorArrayId",t,e,n),r=n.getTensorArray(s.id),i=E("dtype",t,e,n);return[r.concat(i)]}case"TensorArraySplitV3":{const s=E("tensorArrayId",t,e,n),r=E("tensor",t,e,n),i=E("lengths",t,e,n),o=n.getTensorArray(s.id);return o.split(i,r),[o.idTensor]}case"TensorArraySizeV3":{const s=E("tensorArrayId",t,e,n),r=n.getTensorArray(s.id);return[Ge(r.size(),"int32")]}case"TensorArrayCloseV3":{const s=E("tensorArrayId",t,e,n),r=n.getTensorArray(s.id);return r.clearAndClose(),[r.idTensor]}case"TensorListSetItem":{const s=E("tensorListId",t,e,n),r=E("index",t,e,n),i=E("tensor",t,e,n),o=n.getTensorList(s.id);return o.setItem(r,i),[o.idTensor]}case"TensorListGetItem":{const s=E("tensorListId",t,e,n),r=E("index",t,e,n),i=E("elementShape",t,e,n),o=E("elementDType",t,e,n);return[n.getTensorList(s.id).getItem(r,i,o)]}case"TensorListScatterV2":case"TensorListScatter":{const s=E("indices",t,e,n),r=E("tensor",t,e,n),i=E("elementShape",t,e,n),o=E("numElements",t,e,n),a=uke(r,s,i,o);return n.addTensorList(a),[a.idTensor]}case"TensorListReserve":case"EmptyTensorList":{const s=E("elementShape",t,e,n),r=E("elementDType",t,e,n);let i;t.op==="TensorListReserve"?i="numElements":i="maxNumElements";const o=E(i,t,e,n),a=t.op==="TensorListReserve"?-1:o,l=cke(s,r,o,a);return n.addTensorList(l),[l.idTensor]}case"TensorListGather":{const s=E("tensorListId",t,e,n),r=E("indices",t,e,n),i=E("elementShape",t,e,n),o=E("elementDType",t,e,n);return[n.getTensorList(s.id).gather(r,o,i)]}case"TensorListStack":{const s=E("tensorListId",t,e,n),r=E("elementShape",t,e,n),i=E("elementDType",t,e,n),o=E("numElements",t,e,n);return[n.getTensorList(s.id).stack(r,i,o)]}case"TensorListFromTensor":{const s=E("tensor",t,e,n),r=E("elementShape",t,e,n),i=E("elementDType",t,e,n),o=lke(s,r,i);return n.addTensorList(o),[o.idTensor]}case"TensorListConcat":case"TensorListConcatV2":{const s=E("tensorListId",t,e,n),r=n.getTensorList(s.id),i=E("dtype",t,e,n),o=E("elementShape",t,e,n);return[r.concat(i,o)]}case"TensorListPushBack":{const s=E("tensorListId",t,e,n),r=E("tensor",t,e,n),i=n.getTensorList(s.id);return i.pushBack(r),[i.idTensor]}case"TensorListPopBack":{const s=E("tensorListId",t,e,n),r=E("elementShape",t,e,n),i=E("elementDType",t,e,n);return[n.getTensorList(s.id).popBack(r,i)]}case"TensorListSplit":{const s=E("tensor",t,e,n),r=E("elementShape",t,e,n),i=E("lengths",t,e,n),o=dke(s,i,r);return n.addTensorList(o),[o.idTensor]}case"TensorListLength":{const s=E("tensorListId",t,e,n),r=n.getTensorList(s.id);return[Ge(r.size(),"int32")]}case"TensorListResize":{const s=E("tensorListId",t,e,n),r=E("size",t,e,n),o=n.getTensorList(s.id).resize(r);return n.addTensorList(o),[o.idTensor]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ez(t,e,n){const[s,r]=E("fusedOps",t,e,n),i=s==="biasadd",o=!i,a=r==="prelu",l=s==="fusedbatchnorm",c=E("numArgs",t,e,n);if(i){if(a&&c!==2)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!a&&i&&c!==1)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(l)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported");const u=E("strides",t,e,n),d=Lv(t,e,n),h=E("dataFormat",t,e,n).toUpperCase(),f=E("dilations",t,e,n);let[p,m]=E("args",t,e,n);o&&(m=p,p=void 0);const g=E("leakyreluAlpha",t,e,n);return{stride:u,pad:d,dataFormat:h,dilations:f,biasArg:p,preluArg:m,activationFunc:r,leakyreluAlpha:g}}const fke=(t,e,n,s=Zs)=>{switch(t.op){case"Conv1D":{const r=E("stride",t,e,n),i=E("pad",t,e,n),o=E("dataFormat",t,e,n).toUpperCase(),a=E("dilation",t,e,n);return[s.conv1d(E("x",t,e,n),E("filter",t,e,n),r,i,o,a)]}case"Conv2D":{const r=E("strides",t,e,n),i=Lv(t,e,n),o=E("dataFormat",t,e,n).toUpperCase(),a=E("dilations",t,e,n);return[s.conv2d(E("x",t,e,n),E("filter",t,e,n),[r[1],r[2]],i,o,[a[1],a[2]])]}case"_FusedConv2D":{const{stride:r,pad:i,dataFormat:o,dilations:a,biasArg:l,preluArg:c,activationFunc:u,leakyreluAlpha:d}=ez(t,e,n);return[s.fused.conv2d({x:E("x",t,e,n),filter:E("filter",t,e,n),strides:[r[1],r[2]],pad:i,dataFormat:o,dilations:[a[1],a[2]],bias:l,activation:u,preluActivationWeights:c,leakyreluAlpha:d})]}case"FusedDepthwiseConv2dNative":{const{stride:r,pad:i,dataFormat:o,dilations:a,biasArg:l,preluArg:c,activationFunc:u,leakyreluAlpha:d}=ez(t,e,n);return[s.fused.depthwiseConv2d({x:E("x",t,e,n),filter:E("filter",t,e,n),strides:[r[1],r[2]],pad:i,dataFormat:o,dilations:[a[1],a[2]],bias:l,activation:u,preluActivationWeights:c,leakyreluAlpha:d})]}case"Conv2DBackpropInput":case"Conv2dTranspose":{const r=E("outputShape",t,e,n),i=E("strides",t,e,n),o=Lv(t,e,n);return[s.conv2dTranspose(E("x",t,e,n),E("filter",t,e,n),r,[i[1],i[2]],o)]}case"DepthwiseConv2dNative":case"DepthwiseConv2d":{const r=E("strides",t,e,n),i=Lv(t,e,n),o=E("dilations",t,e,n),a=E("dataFormat",t,e,n).toUpperCase();return[s.depthwiseConv2d(E("input",t,e,n),E("filter",t,e,n),[r[1],r[2]],i,a,[o[1],o[2]])]}case"Conv3D":{const r=E("strides",t,e,n),i=E("pad",t,e,n),o=E("dataFormat",t,e,n).toUpperCase(),a=E("dilations",t,e,n);return[s.conv3d(E("x",t,e,n),E("filter",t,e,n),[r[1],r[2],r[3]],i,o,[a[1],a[2],a[3]])]}case"AvgPool":{const r=E("strides",t,e,n),i=E("pad",t,e,n),o=E("kernelSize",t,e,n);return[s.avgPool(E("x",t,e,n),[o[1],o[2]],[r[1],r[2]],i)]}case"MaxPool":{const r=E("strides",t,e,n),i=E("pad",t,e,n),o=E("kernelSize",t,e,n);return[s.maxPool(E("x",t,e,n),[o[1],o[2]],[r[1],r[2]],i)]}case"MaxPoolWithArgmax":{const r=E("strides",t,e,n),i=E("pad",t,e,n),o=E("kernelSize",t,e,n),a=E("includeBatchInIndex",t,e,n),{result:l,indexes:c}=s.maxPoolWithArgmax(E("x",t,e,n),[o[1],o[2]],[r[1],r[2]],i,a);return[l,c]}case"AvgPool3D":{const r=E("strides",t,e,n),i=E("pad",t,e,n),o=E("kernelSize",t,e,n);return[s.avgPool3d(E("x",t,e,n),[o[1],o[2],o[3]],[r[1],r[2],r[3]],i)]}case"MaxPool3D":{const r=E("strides",t,e,n),i=E("pad",t,e,n),o=E("kernelSize",t,e,n);return[s.maxPool3d(E("x",t,e,n),[o[1],o[2],o[3]],[r[1],r[2],r[3]],i)]}case"Dilation2D":{const r=E("strides",t,e,n),i=E("pad",t,e,n),o=E("dilations",t,e,n),a=r[1],l=r[2],c=o[1],u=o[2];return[s.dilation2d(E("x",t,e,n),E("filter",t,e,n),[a,l],i,[c,u],"NHWC")]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pke=(t,e,n,s=Zs)=>{switch(t.op){case"Fill":{const r=E("shape",t,e,n),i=E("dtype",t,e,n),o=E("value",t,e,n);return[s.fill(r,o,i)]}case"LinSpace":{const r=E("start",t,e,n),i=E("stop",t,e,n),o=E("num",t,e,n);return[s.linspace(r,i,o)]}case"Multinomial":{const r=E("logits",t,e,n),i=E("numSamples",t,e,n),o=E("seed",t,e,n);return[s.multinomial(r,i,o)]}case"OneHot":{const r=E("indices",t,e,n),i=E("depth",t,e,n),o=E("onValue",t,e,n),a=E("offValue",t,e,n),l=E("dtype",t,e,n);return[s.oneHot(r,i,o,a,l)]}case"Ones":return[s.ones(E("shape",t,e,n),E("dtype",t,e,n))];case"OnesLike":return[s.onesLike(E("x",t,e,n))];case"RandomStandardNormal":return[s.randomStandardNormal(E("shape",t,e,n),E("dtype",t,e,n),E("seed",t,e,n))];case"RandomUniform":return[s.randomUniform(E("shape",t,e,n),E("minval",t,e,n),E("maxval",t,e,n),E("dtype",t,e,n))];case"Range":{const r=E("start",t,e,n),i=E("stop",t,e,n),o=E("step",t,e,n);return[s.range(r,i,o,E("dtype",t,e,n))]}case"TruncatedNormal":{const r=E("shape",t,e,n),i=E("mean",t,e,n),o=E("stdDev",t,e,n),a=E("seed",t,e,n);return[s.truncatedNormal(r,i,o,E("dtype",t,e,n),a)]}case"Zeros":return[s.zeros(E("shape",t,e,n),E("dtype",t,e,n))];case"ZerosLike":return[s.zerosLike(E("x",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qC(t,e,n){const s=E("boxes",t,e,n),r=E("scores",t,e,n),i=E("maxOutputSize",t,e,n),o=E("iouThreshold",t,e,n),a=E("scoreThreshold",t,e,n),l=E("softNmsSigma",t,e,n);return{boxes:s,scores:r,maxOutputSize:i,iouThreshold:o,scoreThreshold:a,softNmsSigma:l}}const mke=async(t,e,n,s,r=Zs)=>{switch(t.op){case"NonMaxSuppressionV5":{const{boxes:i,scores:o,maxOutputSize:a,iouThreshold:l,scoreThreshold:c,softNmsSigma:u}=qC(t,e,n),d=await r.image.nonMaxSuppressionWithScoreAsync(i,o,a,l,c,u);return[d.selectedIndices,d.selectedScores]}case"NonMaxSuppressionV4":{const{boxes:i,scores:o,maxOutputSize:a,iouThreshold:l,scoreThreshold:c}=qC(t,e,n),u=E("padToMaxOutputSize",t,e,n),d=await r.image.nonMaxSuppressionPaddedAsync(i,o,a,l,c,u);return[d.selectedIndices,d.validOutputs]}case"NonMaxSuppressionV3":case"NonMaxSuppressionV2":{const{boxes:i,scores:o,maxOutputSize:a,iouThreshold:l,scoreThreshold:c}=qC(t,e,n);return[await r.image.nonMaxSuppressionAsync(i,o,a,l,c)]}case"Where":{const i=r.cast(E("condition",t,e,n),"bool"),o=[await r.whereAsync(i)];return i.dispose(),o}case"ListDiff":return r.setdiff1dAsync(E("x",t,e,n),E("y",t,e,n));default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gke=(t,e,n,s=Zs)=>{switch(t.op){case"LowerBound":{const r=E("sortedSequence",t,e,n),i=E("values",t,e,n);return[s.lowerBound(r,i)]}case"TopKV2":{const r=E("x",t,e,n),i=E("k",t,e,n),o=E("sorted",t,e,n),a=s.topk(r,i,o);return[a.values,a.indices]}case"UpperBound":{const r=E("sortedSequence",t,e,n),i=E("values",t,e,n);return[s.upperBound(r,i)]}case"Unique":{const r=E("x",t,e,n),i=s.unique(r);return[i.values,i.indices]}case"UniqueV2":{const r=E("x",t,e,n),i=E("axis",t,e,n),o=s.unique(r,i);return[o.values,o.indices]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yke=(t,e,n,s=Zs)=>{switch(t.op){case"Const":return e[t.name];case"PlaceholderWithDefault":const r=E("default",t,e,n);return[rr(t.name,e,n)||r];case"Placeholder":return[rr(t.name,e,n)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":{const u=E("x",t,e,n);return[qa(u)]}case"IdentityN":return E("x",t,e,n).map(u=>qa(u));case"Snapshot":const i=E("x",t,e,n);return[qa(i)];case"Shape":return[s.tensor1d(E("x",t,e,n).shape,"int32")];case"ShapeN":return E("x",t,e,n).map(u=>s.tensor1d(u.shape));case"Size":return[s.scalar(E("x",t,e,n).size,"int32")];case"Rank":return[s.scalar(E("x",t,e,n).rank,"int32")];case"NoOp":return[s.scalar(1)];case"Print":const o=E("x",t,e,n),a=E("data",t,e,n),l=E("message",t,e,n),c=E("summarize",t,e,n);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(l);for(let u=0;u<a.length;u++)console.log(Array.prototype.slice.call(a[u].dataSync()).slice(0,c));return[o];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xke{constructor(e,n){this.keyDType=e,this.valueDType=n,this.handle=Ge(0),this.tensorMap=new Map,Ps(this.handle)}get id(){return this.handle.id}clearAndClose(){this.tensorMap.forEach(e=>e.dispose()),this.tensorMap.clear(),this.handle.dispose()}size(){return this.tensorMap.size}tensorSize(){return Ge(this.size(),"int32")}async import(e,n){this.checkKeyAndValueTensor(e,n);const s=await e.data();return this.tensorMap.forEach(r=>r.dispose()),this.tensorMap.clear(),se(()=>{const r=zo(n),i=s.length,o=r.length;O(i===o,()=>`The number of elements doesn't match, keys has ${i} elements, the values has ${o} elements.`);for(let a=0;a<i;a++){const l=s[a],c=r[a];Ps(c),this.tensorMap.set(l,c)}return this.handle})}async find(e,n){this.checkKeyAndValueTensor(e,n);const s=await e.data();return se(()=>{const r=[];for(let i=0;i<s.length;i++){const o=s[i],a=this.findWithDefault(o,n);r.push(a)}return lo(r)})}findWithDefault(e,n){const s=this.tensorMap.get(e);return s??n}checkKeyAndValueTensor(e,n){if(e.dtype!==this.keyDType)throw new Error(`Expect key dtype ${this.keyDType}, but got ${e.dtype}`);if(n.dtype!==this.valueDType)throw new Error(`Expect value dtype ${this.valueDType}, but got ${n.dtype}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vke=async(t,e,n,s)=>{switch(t.op){case"HashTable":case"HashTableV2":{const r=E("keyDType",t,e,n),i=E("valueDType",t,e,n),o=new xke(r,i);return s.addHashTable(t.name,o),[o.handle]}case"LookupTableImport":case"LookupTableImportV2":{const r=E("tableHandle",t,e,n,s),i=E("keys",t,e,n),o=E("values",t,e,n);return[await s.getHashTableById(r.id).import(i,o)]}case"LookupTableFind":case"LookupTableFindV2":{const r=E("tableHandle",t,e,n,s),i=E("keys",t,e,n),o=E("defaultValue",t,e,n);return[await s.getHashTableById(r.id).find(i,o)]}case"LookupTableSize":case"LookupTableSizeV2":{const r=E("tableHandle",t,e,n,s);return[s.getHashTableById(r.id).tensorSize()]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bke=(t,e,n,s=Zs)=>{switch(t.op){case"ResizeBilinear":{const r=E("images",t,e,n),i=E("size",t,e,n),o=E("alignCorners",t,e,n),a=E("halfPixelCenters",t,e,n);return[s.image.resizeBilinear(r,[i[0],i[1]],o,a)]}case"ResizeNearestNeighbor":{const r=E("images",t,e,n),i=E("size",t,e,n),o=E("alignCorners",t,e,n),a=E("halfPixelCenters",t,e,n);return[s.image.resizeNearestNeighbor(r,[i[0],i[1]],o,a)]}case"CropAndResize":{const r=E("image",t,e,n),i=E("boxes",t,e,n),o=E("boxInd",t,e,n),a=E("cropSize",t,e,n),l=E("method",t,e,n),c=E("extrapolationValue",t,e,n);return[s.image.cropAndResize(r,i,o,a,l,c)]}case"ImageProjectiveTransformV3":{const r=E("images",t,e,n),i=E("transforms",t,e,n),o=E("outputShape",t,e,n),a=E("fillValue",t,e,n),l=E("interpolation",t,e,n),c=E("fillMode",t,e,n);return[s.image.transform(r,i,l.toLowerCase(),c.toLowerCase(),a,o)]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wke=(t,e,n,s=Zs)=>{switch(t.op){case"Equal":return[s.equal(E("a",t,e,n),E("b",t,e,n))];case"NotEqual":return[s.notEqual(E("a",t,e,n),E("b",t,e,n))];case"Greater":return[s.greater(E("a",t,e,n),E("b",t,e,n))];case"GreaterEqual":return[s.greaterEqual(E("a",t,e,n),E("b",t,e,n))];case"Less":return[s.less(E("a",t,e,n),E("b",t,e,n))];case"LessEqual":return[s.lessEqual(E("a",t,e,n),E("b",t,e,n))];case"LogicalAnd":return[s.logicalAnd(E("a",t,e,n),E("b",t,e,n))];case"LogicalNot":return[s.logicalNot(E("a",t,e,n))];case"LogicalOr":return[s.logicalOr(E("a",t,e,n),E("b",t,e,n))];case"Select":case"SelectV2":return[s.where(E("condition",t,e,n),E("a",t,e,n),E("b",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ske=(t,e,n,s=Zs)=>{switch(t.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[s.matMul(E("a",t,e,n),E("b",t,e,n),E("transposeA",t,e,n),E("transposeB",t,e,n))];case"Einsum":return[s.einsum(E("equation",t,e,n),...E("tensors",t,e,n))];case"Transpose":return[s.transpose(E("x",t,e,n),E("perm",t,e,n))];case"_FusedMatMul":const[r,i]=E("fusedOps",t,e,n),o=r==="biasadd",a=i==="prelu",l=E("numArgs",t,e,n),c=E("leakyreluAlpha",t,e,n);if(o){if(a&&l!==2)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!a&&l!==1)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}const[u,d]=E("args",t,e,n);return[s.fused.matMul({a:E("a",t,e,n),b:E("b",t,e,n),transposeA:E("transposeA",t,e,n),transposeB:E("transposeB",t,e,n),bias:u,activation:i,preluActivationWeights:d,leakyreluAlpha:c})];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kke=(t,e,n,s=Zs)=>{switch(t.op){case"EuclideanNorm":return[s.euclideanNorm(E("x",t,e,n),E("axis",t,e,n),E("keepDims",t,e,n))];case"FusedBatchNorm":case"FusedBatchNormV2":return[s.batchNorm(E("x",t,e,n),E("mean",t,e,n),E("variance",t,e,n),E("offset",t,e,n),E("scale",t,e,n),E("epsilon",t,e,n))];case"FusedBatchNormV3":return[s.batchNorm(E("x",t,e,n),E("mean",t,e,n),E("variance",t,e,n),E("offset",t,e,n),E("scale",t,e,n),E("epsilon",t,e,n))];case"LRN":return[s.localResponseNormalization(E("x",t,e,n),E("radius",t,e,n),E("bias",t,e,n),E("alpha",t,e,n),E("beta",t,e,n))];case"Softmax":return[s.softmax(E("x",t,e,n))];case"LogSoftmax":return[s.logSoftmax(E("x",t,e,n))];case"SparseToDense":return[s.sparseToDense(E("sparseIndices",t,e,n),E("outputShape",t,e,n),E("sparseValues",t,e,n),E("defaultValue",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cke=(t,e,n,s=Zs)=>{switch(t.op){case"Max":{const a=E("axis",t,e,n),l=E("keepDims",t,e,n);return[s.max(E("x",t,e,n),a,l)]}case"Mean":{const a=E("axis",t,e,n),l=E("keepDims",t,e,n);return[s.mean(E("x",t,e,n),a,l)]}case"Min":{const a=E("axis",t,e,n),l=E("keepDims",t,e,n);return[s.min(E("x",t,e,n),a,l)]}case"Sum":{const a=E("axis",t,e,n),l=E("keepDims",t,e,n);return[s.sum(E("x",t,e,n),a,l)]}case"All":{const a=E("axis",t,e,n),l=E("keepDims",t,e,n);return[s.all(E("x",t,e,n),a,l)]}case"Any":{const a=E("axis",t,e,n),l=E("keepDims",t,e,n);return[s.any(E("x",t,e,n),a,l)]}case"ArgMax":{const a=E("axis",t,e,n);return[s.argMax(E("x",t,e,n),a)]}case"ArgMin":{const a=E("axis",t,e,n);return[s.argMin(E("x",t,e,n),a)]}case"Prod":{const a=E("axis",t,e,n),l=E("keepDims",t,e,n);return[s.prod(E("x",t,e,n),a,l)]}case"Cumprod":{const a=E("axis",t,e,n),l=E("exclusive",t,e,n),c=E("reverse",t,e,n);return[s.cumprod(E("x",t,e,n),a,l,c)]}case"Cumsum":{const a=E("axis",t,e,n),l=E("exclusive",t,e,n),c=E("reverse",t,e,n);return[s.cumsum(E("x",t,e,n),a,l,c)]}case"Bincount":const r=E("x",t,e,n),i=E("weights",t,e,n),o=E("size",t,e,n);return[s.bincount(r,i,o)];case"DenseBincount":{const a=E("x",t,e,n),l=E("weights",t,e,n),c=E("size",t,e,n),u=E("binaryOutput",t,e,n);return[s.denseBincount(a,l,c,u)]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tke=(t,e,n,s=Zs)=>{switch(t.op){case"ConcatV2":case"Concat":{const r=E("n",t,e,n),i=E("axis",t,e,n);let o=E("tensors",t,e,n);return o=o.slice(0,r),[s.concat(o,i)]}case"Gather":{const r=E("x",t,e,n),i=E("indices",t,e,n);return[s.gather(r,s.cast(i,"int32"),0)]}case"GatherV2":{const r=E("axis",t,e,n),i=E("batchDims",t,e,n),o=E("x",t,e,n),a=E("indices",t,e,n);return[s.gather(o,s.cast(a,"int32"),r,i)]}case"Reverse":{const r=E("dims",t,e,n),i=[];for(let a=0;a<r.length;a++)r[a]&&i.push(a);const o=E("x",t,e,n);return[s.reverse(o,i)]}case"ReverseV2":{const r=E("axis",t,e,n),i=E("x",t,e,n);return[s.reverse(i,r)]}case"Slice":{const r=E("begin",t,e,n),i=E("size",t,e,n);return[s.slice(E("x",t,e,n),r,i)]}case"StridedSlice":{const r=E("begin",t,e,n),i=E("end",t,e,n),o=E("strides",t,e,n),a=E("beginMask",t,e,n),l=E("endMask",t,e,n),c=E("ellipsisMask",t,e,n),u=E("newAxisMask",t,e,n),d=E("shrinkAxisMask",t,e,n),h=E("x",t,e,n);return[s.stridedSlice(h,r,i,o,a,l,c,u,d)]}case"Pack":return se(()=>{const r=E("axis",t,e,n),i=E("tensors",t,e,n),o=i[0].shape,a=s.squeeze(i[0]).shape,l=i.map(c=>{const u=Et(c.shape,o);if(!u&&!Et(s.squeeze(c).shape,a))throw new Error("the input tensors shape does not match");return u?c:s.reshape(c,o)});return[s.stack(l,r)]});case"Unpack":{const r=E("axis",t,e,n),i=E("tensor",t,e,n);return s.unstack(i,r)}case"Tile":{const r=E("reps",t,e,n);return[s.tile(E("x",t,e,n),r)]}case"Split":case"SplitV":{const r=E("axis",t,e,n),i=E("numOrSizeSplits",t,e,n),o=E("x",t,e,n);return s.split(o,i,r)}case"ScatterNd":{const r=E("indices",t,e,n),i=E("values",t,e,n),o=E("shape",t,e,n);return[s.scatterND(r,i,o)]}case"GatherNd":{const r=E("x",t,e,n),i=E("indices",t,e,n);return[s.gatherND(r,i)]}case"SparseToDense":{const r=E("sparseIndices",t,e,n),i=E("outputShape",t,e,n),o=E("sparseValues",t,e,n),a=E("defaultValue",t,e,n);return[s.sparseToDense(r,o,i,o.dtype===a.dtype?a:s.cast(a,o.dtype))]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nke=(t,e,n,s=Zs)=>{switch(t.op){case"SparseFillEmptyRows":{const{outputIndices:r,outputValues:i,emptyRowIndicator:o,reverseIndexMap:a}=s.sparse.sparseFillEmptyRows(E("indices",t,e,n),E("values",t,e,n),E("denseShape",t,e,n),E("defaultValue",t,e,n));return[r,i,o,a]}case"SparseReshape":{const{outputIndices:r,outputShape:i}=s.sparse.sparseReshape(E("inputIndices",t,e,n),E("inputShape",t,e,n),E("newShape",t,e,n));return[r,i]}case"SparseSegmentMean":return[s.sparse.sparseSegmentMean(E("data",t,e,n),E("indices",t,e,n),E("segmentIds",t,e,n))];case"SparseSegmentSum":return[s.sparse.sparseSegmentSum(E("data",t,e,n),E("indices",t,e,n),E("segmentIds",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ike=(t,e,n,s=Zs)=>{switch(t.op){case"FFT":return[s.fft(E("x",t,e,n))];case"IFFT":return[s.ifft(E("x",t,e,n))];case"RFFT":return[s.rfft(E("x",t,e,n))];case"IRFFT":return[s.irfft(E("x",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _ke=(t,e,n,s=Zs)=>{switch(t.op){case"StringNGrams":{const{nGrams:r,nGramsSplits:i}=s.string.stringNGrams(E("data",t,e,n),E("dataSplits",t,e,n),E("separator",t,e,n),E("nGramWidths",t,e,n),E("leftPad",t,e,n),E("rightPad",t,e,n),E("padWidth",t,e,n),E("preserveShortSequences",t,e,n));return[r,i]}case"StringSplit":{const{indices:r,values:i,shape:o}=s.string.stringSplit(E("input",t,e,n),E("delimiter",t,e,n),E("skipEmpty",t,e,n));return[r,i,o]}case"StringToHashBucketFast":return[s.string.stringToHashBucketFast(E("input",t,e,n),E("numBuckets",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Eke=(t,e,n,s=Zs)=>{switch(t.op){case"Cast":return[s.cast(E("x",t,e,n),E("dtype",t,e,n))];case"ExpandDims":{const r=E("axis",t,e,n);return[s.expandDims(E("x",t,e,n),r)]}case"Squeeze":{const r=E("axis",t,e,n);return[s.squeeze(E("x",t,e,n),r)]}case"Reshape":return[s.reshape(E("x",t,e,n),E("shape",t,e,n))];case"MirrorPad":return[s.mirrorPad(E("x",t,e,n),E("padding",t,e,n),E("mode",t,e,n))];case"PadV2":case"Pad":return[s.pad(E("x",t,e,n),E("padding",t,e,n),E("constantValue",t,e,n))];case"SpaceToBatchND":{const r=E("blockShape",t,e,n),i=E("paddings",t,e,n);return[s.spaceToBatchND(E("x",t,e,n),r,i)]}case"BatchToSpaceND":{const r=E("blockShape",t,e,n),i=E("crops",t,e,n);return[s.batchToSpaceND(E("x",t,e,n),r,i)]}case"DepthToSpace":{const r=E("blockSize",t,e,n),i=E("dataFormat",t,e,n).toUpperCase();return[s.depthToSpace(E("x",t,e,n),r,i)]}case"BroadcastTo":return[s.broadcastTo(E("x",t,e,n),E("shape",t,e,n))];case"BroadcastArgs":return[s.broadcastArgs(E("s0",t,e,n),E("s1",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tz(t,e,n,s,r=se){const i=((o,a,l)=>{switch(o.category){case"arithmetic":return r(()=>ike(o,a,l));case"basic_math":return r(()=>oke(o,a,l));case"control":return hke(o,a,l);case"convolution":return r(()=>fke(o,a,l));case"creation":return r(()=>pke(o,a,l));case"dynamic":return mke(o,a,l);case"evaluation":return r(()=>gke(o,a,l));case"image":return r(()=>bke(o,a,l));case"graph":return r(()=>yke(o,a,l));case"logical":return r(()=>wke(o,a,l));case"matrices":return r(()=>Ske(o,a,l));case"normalization":return r(()=>kke(o,a,l));case"reduction":return r(()=>Cke(o,a,l));case"slice_join":return r(()=>Tke(o,a,l));case"sparse":return r(()=>Nke(o,a,l));case"spectral":return r(()=>Ike(o,a,l));case"string":return r(()=>_ke(o,a,l));case"transformation":return r(()=>Eke(o,a,l));case"hash_table":return vke(o,a,l,s);case"custom":const c=lK(o.op);if(c&&c.customExecutor)return c.customExecutor(new rke(o,a,l));throw TypeError(`Custom op ${o.op} is not registered.`);default:throw TypeError(`Unknown op '${o.op}'. File an issue at https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()`)}})(t,e,n);return $f(i)?i.then(o=>[].concat(o)):[].concat(i)}class nz{constructor(e={},n={},s={},r={}){this.weightMap=e,this.tensorArrayMap=n,this.tensorListMap=s,this.functionMap=r,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}newFrame(e,n){return{id:e,frameName:n,iterationId:0}}set currentContext(e){this.contexts!==e&&(this.contexts=e,this.generateCurrentContextIds())}get currentContext(){return this.contexts}get currentContextId(){return this._currentContextIds[0]}get currentContextIds(){return this._currentContextIds}generateCurrentContextIds(){const e=[];for(let n=0;n<this.contexts.length-1;n++){const s=this.contexts.slice(0,this.contexts.length-n);e.push(this.contextIdforContexts(s))}e.push(""),this._currentContextIds=e}contextIdforContexts(e){return e?e.map(n=>n.id===0&&n.iterationId===0?"":`${n.frameName}-${n.iterationId}`).join("/"):""}enterFrame(e){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,e)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))}exitFrame(){if(this.contexts&&this.contexts.length>1)this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift();else throw new Error("Cannot exit frame, the context is empty")}nextIteration(){if(this.contexts&&this.contexts.length>0){this.contexts=this.contexts.slice(),this.lastId++;const e=Object.assign({},this.contexts[this.contexts.length-1]);e.iterationId+=1,e.id=this.lastId,this.contexts.splice(-1,1,e),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))}else throw new Error("Cannot increase frame iteration, the context is empty")}getWeight(e){return this.weightMap[e]}addTensorArray(e){this.tensorArrayMap[e.id]=e}getTensorArray(e){return this.tensorArrayMap[e]}addTensorList(e){this.tensorListMap[e.id]=e}getTensorList(e){return this.tensorListMap[e]}dispose(e){for(const n in this.tensorArrayMap)this.tensorArrayMap[n].clearAndClose(e);for(const n in this.tensorListMap)this.tensorListMap[n].clearAndClose(e)}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sz(t,e,n,s){const r=new Set,i=[];let o=null,a=null;const l=new Set,c=Object.keys(t).map(h=>zr(h)[0]);let u=[];s!=null&&(u=s.map(h=>zr(h.name)[0]));const d=[...e];for(;d.length>0;){const h=d.pop();if((dK(h)||Oke(h)||Pke(h))&&o==null&&(o=h,a=o.children.map(f=>f.name).filter(f=>r.has(f))),r.add(h.name),n[h.name]==null&&c.indexOf(h.name)===-1&&u.indexOf(h.name)===-1){if(h.inputs.length===0){i.push(h.name);continue}h.inputs.forEach(f=>{l.has(f.name)||(l.add(f.name),d.push(f))})}}return{inputs:t,outputs:e,usedNodes:r,missingInputs:i,dynamicNode:o,syncInputs:a}}function $ke(t,e,n){const{usedNodes:s,inputs:r}=n,i=[],o=Object.keys(r).map(u=>zr(u)[0]).map(u=>t.nodes[u]),a=t.initNodes;o.forEach(u=>{s.has(u.name)&&i.push(u)}),t.weights.forEach(u=>{s.has(u.name)&&i.push(u)}),a!=null&&a.forEach(u=>{s.has(u.name)&&i.push(u)});const l=new Set,c=[];for(;i.length>0;){const u=i.pop();l.add(u.name),e[u.name]||c.push(u),u.children.forEach(d=>{!l.has(d.name)&&s.has(d.name)&&d.inputs.every(h=>l.has(h.name))&&i.push(d)})}return c}const Ake=["Switch","Merge","Enter","Exit","NextIteration","StatelessIf","StatelessWhile","if","While"],Rke=["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"],Dke=["HashTable","HashTableV2","LookupTableImport","LookupTableImportV2","LookupTableFind","LookupTableFindV2","LookupTableSize","LookupTableSizeV2"];function dK(t){return Ake.indexOf(t.op)>=0}function Oke(t){return Rke.indexOf(t.op)>=0}function Pke(t){return Dke.indexOf(t.op)>=0}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ow{constructor(e,n){this.graph=e,this.parent=n,this.compiledMap=new Map,this._weightMap={},this.SEPERATOR=",",this._functions={},this._functionExecutorMap={},this.intermediateTensors={},this.keepTensorForDebug=!1,this._outputs=e.outputs,this._inputs=e.inputs,this._initNodes=e.initNodes,this._signature=e.signature,this._functions=e.functions,e.functions!=null&&Object.keys(e.functions).forEach(s=>{this._functionExecutorMap[s]=new ow(e.functions[s],this)})}get weightIds(){return this.parent?this.parent.weightIds:this._weightIds}get functionExecutorMap(){return this.parent?this.parent.functionExecutorMap:this._functionExecutorMap}get weightMap(){return this.parent?this.parent.weightMap:this._weightMap}set weightMap(e){const n=Object.keys(e).map(s=>e[s].map(r=>r.id));this._weightIds=[].concat(...n),this._weightMap=e}set resourceManager(e){this._resourceManager=e}get inputs(){return this._inputs.map(e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}))}get outputs(){return this._outputs.map(e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}))}get inputNodes(){return this._inputs.map(e=>e.signatureKey||e.name)}get outputNodes(){return this._outputs.map(e=>{const n=e.signatureKey||e.name;return e.defaultOutput?`${n}:${e.defaultOutput}`:n})}get functions(){return Object.keys(this._functions).reduce((e,n)=>(e[n]=this._functions[n].signature,e),{})}getCompilationKey(e,n){const s=e.map(i=>i.name).sort(),r=n.map(i=>i.name).sort();return s.join(this.SEPERATOR)+"--"+r.join(this.SEPERATOR)}compile(e,n){const s=sz(e,n,this.weightMap,this._initNodes),{missingInputs:r,dynamicNode:i,syncInputs:o}=s;if(i!=null)throw new Error(`This execution contains the node '${i.name}', which has the dynamic op '${i.op}'. Please use model.executeAsync() instead. Alternatively, to avoid the dynamic ops, specify the inputs [${o}]`);if(r.length>0){const a=n.map(c=>c.name),l=Object.keys(e);throw new Error(`Cannot compute the outputs [${a}] from the provided inputs [${l}]. Missing the following inputs: [${r}]`)}return $ke(this.graph,this.weightMap,s)}execute(e,n){e=this.mapInputs(e);const s=Object.keys(e).sort();this.checkInputs(e),this.checkInputShapeAndType(e),n=this.mapOutputs(n),this.checkOutputs(n);const r=s.map(d=>this.graph.nodes[zr(d)[0]]),i=n.map(d=>zr(d)[0]);let o=i.map(d=>this.graph.nodes[d]);this.resetIntermediateTensors(),o.length===0&&(o=this._outputs);const a=this.getCompilationKey(r,o);let l=this.compiledMap.get(a);l==null&&(l=this.compile(e,o),this.compiledMap.set(a,l));const c={},u={};return se(()=>{const d=new nz(this.weightMap,c,u,this.functionExecutorMap),h=Object.assign({},this.weightMap);Object.keys(e).forEach(m=>{const[g,y]=zr(m),x=[];x[y]=e[m],h[g]=x});const f=this.getFrozenTensorIds(h),p={};for(let m=0;m<l.length;m++){const g=l[m];if(!h[g.name]){const y=tz(g,h,d,this._resourceManager);if($f(y))throw new Error(`The execution of the op '${g.op}' returned a promise. Please use model.executeAsync() instead.`);h[g.name]=y,this.checkTensorForDisposal(g.name,g,h,d,f,i,p)}}return this.parent==null&&d.dispose(f),n.map(m=>rr(m,h,d))})}getFrozenTensorIds(e){const n=[].concat.apply([],Object.keys(e).map(s=>e[s]).map(s=>s.map(r=>r.id)));return new Set(n)}checkTensorForDisposal(e,n,s,r,i,o,a){n.category==="control"||o.indexOf(e)!==-1||(s[e].forEach(l=>{l!=null&&(a[l.id]=(a[l.id]||0)+n.children.length)}),n.inputs.forEach(l=>{if(l.category!=="control"){const c=xSe(l.name,s,r);c!=null&&c.forEach(u=>{if(u&&!u.kept&&!i.has(u.id)){const d=a[u.id];if(d===1){if(!this.keepTensorForDebug)u.dispose();else{const[h,f]=na(n.name,r);this.intermediateTensors[h]?this.intermediateTensors[h][f]=u:(this.intermediateTensors[h]=[],this.intermediateTensors[h][f]=u)}delete a[u.id]}else d!=null&&a[u.id]--}})}}))}async executeAsync(e,n){return this._executeAsync(e,n)}disposeIntermediateTensors(){this.intermediateTensors&&(Object.keys(this.intermediateTensors).forEach(e=>this.intermediateTensors[e].forEach(n=>n.dispose())),this.disposeTensorsMap())}disposeTensorsMap(){this.tensorsMap&&Object.keys(this.tensorsMap).forEach(e=>{this.tensorsMap[e].forEach(s=>{s&&!s.kept&&!s.isDisposed&&!this.keepIds.has(s.id)&&s.dispose()})})}getIntermediateTensors(){return this.tensorsMap}resetIntermediateTensors(){for(const e in this.intermediateTensors)this.intermediateTensors[e].forEach(n=>n.dispose()),delete this.intermediateTensors[e]}async _executeAsync(e,n,s=!1,r={},i={}){s||(e=this.mapInputs(e),this.checkInputs(e),this.checkInputShapeAndType(e),n=this.mapOutputs(n),this.checkOutputs(n));try{this.keepTensorForDebug=oe().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(u){console.warn(u.message)}this.resetIntermediateTensors();const o=new nz(this.weightMap,r,i,this.functionExecutorMap);this.tensorsMap=await this.executeWithControlFlow(e,o,n,s);const a=n.map(u=>rr(u,this.tensorsMap,o)),l=a.map(u=>u.id),c=Object.keys(e).map(u=>e[u].id);return this.keepIds=new Set([...l,...c,...this.weightIds]),this.keepTensorForDebug||this.disposeTensorsMap(),this.parent==null&&o.dispose(this.keepIds),a}async executeFunctionAsync(e,n,s){const r=e.reduce((i,o,a)=>(i[this.inputs[a].name]=o,i),{});return this._executeAsync(r,this.outputNodes,!0,n,s)}async executeWithControlFlow(e,n,s,r){const i=Object.keys(e),o=i.map(v=>this.graph.nodes[zr(v)[0]]),a=s.map(v=>zr(v)[0]);let l=a.map(v=>this.graph.nodes[v]);l.length===0&&(l=this._outputs);const{usedNodes:c,missingInputs:u,dynamicNode:d,syncInputs:h}=sz(e,l,this.weightMap,this._initNodes),f=[...o,...this.graph.weights,...this._initNodes||[]].map(v=>({node:v,contexts:n.currentContext})),p=Object.assign({},this.weightMap);Object.keys(e).forEach(v=>{const[b,k]=zr(v),C=[];C[k]=e[v],p[b]=C});const m={},g=this.getFrozenTensorIds(p),y={};for(;f.length>0;){const v=this.processStack(o,f,n,p,y,g,a,m,c);await Promise.all(v)}d==null&&!r&&console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead.");const x=l.filter(v=>!dK(v)&&!rr(v.name,p,n)).map(v=>v.name);if(x.length>0){let v="";throw d!=null&&(v=`Alternatively, to avoid the dynamic ops, use model.execute() and specify the inputs [${h}]`),new Error(`Cannot compute the outputs [${x}] from the provided inputs [${i}]. Consider providing the following inputs: [${u}]. ${v}`)}return p}processStack(e,n,s,r,i,o,a,l,c){const u=[];for(;n.length>0;){const d=n.pop();s.currentContext=d.contexts;let h="";if(d.node.op==="Enter"&&E("isConstant",d.node,r,s)&&([h]=na(d.node.name,s)),r[d.node.name]==null){const f=tz(d.node,r,s,this._resourceManager);h||([h]=na(d.node.name,s));const p=s.currentContext;$f(f)?u.push(f.then(m=>(r[h]=m,s.currentContext=p,this.checkTensorForDisposal(h,d.node,r,s,o,a,l),this.processChildNodes(d.node,n,s,r,i,c),m))):(r[h]=f,this.checkTensorForDisposal(h,d.node,r,s,o,a,l),this.processChildNodes(d.node,n,s,r,i,c))}else this.processChildNodes(d.node,n,s,r,i,c)}return u}processChildNodes(e,n,s,r,i,o){e.children.forEach(a=>{const[l]=na(a.name,s);i[l]||!o.has(a.name)||(a.op==="Merge"?a.inputNames.some(c=>!!rr(c,r,s))&&(i[l]=!0,n.push({contexts:s.currentContext,node:a})):a.inputNames.every(c=>!!rr(c,r,s))&&(i[l]=!0,n.push({contexts:s.currentContext,node:a})))})}dispose(){Object.keys(this.weightMap).forEach(e=>this.weightMap[e].forEach(n=>n.dispose()))}checkInputShapeAndType(e){Object.keys(e).forEach(n=>{const s=e[n],[r]=zr(n),i=this.graph.nodes[r];if(i.attrParams.shape&&i.attrParams.shape.value){const o=i.attrParams.shape.value,a=o.length===s.shape.length&&s.shape.every((l,c)=>o[c]===-1||o[c]===l);O(a,()=>`The shape of dict['${i.name}'] provided in model.execute(dict) must be [${o}], but was [${s.shape}]`)}i.attrParams.dtype&&i.attrParams.dtype.value&&O(s.dtype===i.attrParams.dtype.value,()=>`The dtype of dict['${i.name}'] provided in model.execute(dict) must be ${i.attrParams.dtype.value}, but was ${s.dtype}`)})}mapInputs(e){const n={};for(const s in e)if(this._signature!=null&&this._signature.inputs!=null&&this._signature.inputs[s]!=null){const r=this._signature.inputs[s];n[r.name]=e[s]}else n[s]=e[s];return n}checkInputs(e){const n=Object.keys(e).filter(s=>{const[r]=zr(s);return this.graph.nodes[r]==null});if(n.length>0)throw new Error(`The dict provided in model.execute(dict) has keys: [${n}] that are not part of graph`)}mapOutputs(e){return e.map(n=>this._signature!=null&&this._signature.outputs!=null&&this._signature.outputs[n]!=null?this._signature.outputs[n].name:n,{})}checkOutputs(e){e.forEach(n=>{const[s]=zr(n);if(!this.graph.nodes[s])throw new Error(`The output '${n}' is not found in the graph`)})}}class Fke{constructor(e={},n={}){this.hashTableNameToHandle=e,this.hashTableMap=n}addHashTable(e,n){this.hashTableNameToHandle[e]=n.handle,this.hashTableMap[n.id]=n}getHashTableHandleByName(e){return this.hashTableNameToHandle[e]}getHashTableById(e){return this.hashTableMap[e]}dispose(){for(const e in this.hashTableMap)this.hashTableMap[e].clearAndClose(),delete this.hashTableMap[e];for(const e in this.hashTableNameToHandle)this.hashTableNameToHandle[e].dispose(),delete this.hashTableNameToHandle[e]}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lke="?tfjs-format=file",Mke="model.json";class zke{constructor(e,n={},s=xG){this.modelUrl=e,this.loadOptions=n,this.version="n/a",this.io=s,n==null&&(this.loadOptions={}),this.resourceManager=new Fke}get modelVersion(){return this.version}get inputNodes(){return this.executor.inputNodes}get outputNodes(){return this.executor.outputNodes}get inputs(){return this.executor.inputs}get outputs(){return this.executor.outputs}get weights(){return this.executor.weightMap}get metadata(){return this.artifacts.userDefinedMetadata}get modelSignature(){return this.signature}get modelStructuredOutputKeys(){return this.structuredOutputKeys}findIOHandler(){const e=this.modelUrl;if(e.load!=null)this.handler=e;else if(this.loadOptions.requestInit!=null)this.handler=this.io.browserHTTPRequest(e,this.loadOptions);else{const n=this.io.getLoadHandlers(e,this.loadOptions);if(n.length===0)n.push(this.io.browserHTTPRequest(e,this.loadOptions));else if(n.length>1)throw new Error(`Found more than one (${n.length}) load handlers for URL '${[e]}'`);this.handler=n[0]}}load(){if(this.findIOHandler(),this.handler.load==null)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");const e=this.handler.load();return $f(e)?e.then(n=>this.loadSync(n)):this.loadSync(e)}loadSync(e){this.artifacts=e;const n=this.artifacts.modelTopology;let s=this.artifacts.signature;if(this.artifacts.userDefinedMetadata!=null){const i=this.artifacts.userDefinedMetadata;i.signature!=null&&(s=i.signature),i.structuredOutputKeys!=null&&(this.structuredOutputKeys=i.structuredOutputKeys)}this.signature=s,this.version=`${n.versions.producer}.${n.versions.minConsumer}`;const r=this.io.decodeWeights(this.artifacts.weightData,this.artifacts.weightSpecs);if(this.executor=new ow(Z3.Instance.transformGraph(n,this.signature)),this.executor.weightMap=this.convertTensorMapToTensorsMap(r),this.executor.resourceManager=this.resourceManager,e.modelInitializer!=null&&e.modelInitializer.node!=null){const i=Z3.Instance.transformGraph(e.modelInitializer);this.initializer=new ow(i),this.initializer.weightMap=this.executor.weightMap,this.initializer.resourceManager=this.resourceManager,this.initializer.executeAsync({},[])}return!0}async save(e,n){if(typeof e=="string"){const s=this.io.getSaveHandlers(e);if(s.length===0)throw new Error(`Cannot find any save handlers for URL '${e}'`);if(s.length>1)throw new Error(`Found more than one (${s.length}) save handlers for URL '${e}'`);e=s[0]}if(e.save==null)throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return e.save(this.artifacts)}predict(e,n){const s=this.execute(e,this.outputNodes);if(this.structuredOutputKeys){const r=s instanceof Yt?[s]:s,i={};return r.forEach((o,a)=>i[this.structuredOutputKeys[a]]=o),i}return s}normalizeInputs(e){if(!(e instanceof Yt)&&!Array.isArray(e))return e;if(e=Array.isArray(e)?e:[e],e.length!==this.inputNodes.length)throw new Error(`Input tensor count mismatch,the graph model has ${this.inputNodes.length} placeholders, while there are ${e.length} input tensors.`);return this.inputNodes.reduce((n,s,r)=>(n[s]=e[r],n),{})}normalizeOutputs(e){return e=e||this.outputNodes,Array.isArray(e)?e:[e]}execute(e,n){e=this.normalizeInputs(e),n=this.normalizeOutputs(n);const s=this.executor.execute(e,n);return s.length>1?s:s[0]}async executeAsync(e,n){e=this.normalizeInputs(e),n=this.normalizeOutputs(n);const s=await this.executor.executeAsync(e,n);return s.length>1?s:s[0]}getIntermediateTensors(){return this.executor.getIntermediateTensors()}disposeIntermediateTensors(){this.executor.disposeIntermediateTensors()}convertTensorMapToTensorsMap(e){return Object.keys(e).reduce((n,s)=>(n[s]=[e[s]],n),{})}dispose(){this.executor.dispose(),this.initializer&&this.initializer.dispose(),this.resourceManager.dispose()}}async function Ff(t,e={},n=xG){if(t==null)throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");e==null&&(e={}),e.fromTFHub&&typeof t=="string"&&(t=Vke(t));const s=new zke(t,e,n);return await s.load(),s}function Vke(t){return t.endsWith("/")||(t=t+"/"),`${t}${Mke}${Lke}`}/**
    * @license
    * Copyright 2021 Google LLC. All Rights Reserved.
    * Licensed under the Apache License, Version 2.0 (the "License");
    * you may not use this file except in compliance with the License.
    * You may obtain a copy of the License at
    *
    * http://www.apache.org/licenses/LICENSE-2.0
    *
    * Unless required by applicable law or agreed to in writing, software
    * distributed under the License is distributed on an "AS IS" BASIS,
    * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    * See the License for the specific language governing permissions and
    * limitations under the License.
    * =============================================================================
    */var hK=function(t,e){return(hK=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var r in s)s.hasOwnProperty(r)&&(n[r]=s[r])})(t,e)};function fK(t,e){function n(){this.constructor=t}hK(t,e),t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var ts=function(){return(ts=Object.assign||function(t){for(var e,n=1,s=arguments.length;n<s;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)};function On(t,e,n,s){return new(n||(n=Promise))(function(r,i){function o(c){try{l(s.next(c))}catch(u){i(u)}}function a(c){try{l(s.throw(c))}catch(u){i(u)}}function l(c){var u;c.done?r(c.value):(u=c.value,u instanceof n?u:new n(function(d){d(u)})).then(o,a)}l((s=s.apply(t,e||[])).next())})}function Pn(t,e){var n,s,r,i,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function a(l){return function(c){return function(u){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,s&&(r=2&u[0]?s.return:u[0]?s.throw||((r=s.return)&&r.call(s),0):s.next)&&!(r=r.call(s,u[1])).done)return r;switch(s=0,r&&(u=[2&u[0],r.value]),u[0]){case 0:case 1:r=u;break;case 4:return o.label++,{value:u[1],done:!1};case 5:o.label++,s=u[1],u=[0];continue;case 7:u=o.ops.pop(),o.trys.pop();continue;default:if(r=o.trys,!((r=r.length>0&&r[r.length-1])||u[0]!==6&&u[0]!==2)){o=0;continue}if(u[0]===3&&(!r||u[1]>r[0]&&u[1]<r[3])){o.label=u[1];break}if(u[0]===6&&o.label<r[1]){o.label=r[1],r=u;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(u);break}r[2]&&o.ops.pop(),o.trys.pop();continue}u=e.call(t,o)}catch(d){u=[6,d],s=0}finally{n=r=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([l,c])}}}var Aa=["nose","left_eye","right_eye","left_ear","right_ear","left_shoulder","right_shoulder","left_elbow","right_elbow","left_wrist","right_wrist","left_hip","right_hip","left_knee","right_knee","left_ankle","right_ankle"],$g=["nose","left_eye_inner","left_eye","left_eye_outer","right_eye_inner","right_eye","right_eye_outer","left_ear","right_ear","mouth_left","mouth_right","left_shoulder","right_shoulder","left_elbow","right_elbow","left_wrist","right_wrist","left_pinky","right_pinky","left_index","right_index","left_thumb","right_thumb","left_hip","right_hip","left_knee","right_knee","left_ankle","right_ankle","left_heel","right_heel","left_foot_index","right_foot_index"],XC={runtime:"mediapipe",enableSmoothing:!0,modelType:"full"},jke=function(){function t(e){var n,s=this;switch(this.width=0,this.height=0,this.selfieMode=!1,this.poseSolution=new dge.Pose({locateFile:function(r,i){return e.solutionPath?e.solutionPath.replace(/\/+$/,"")+"/"+r:i+"/"+r}}),e.modelType){case"lite":n=0;break;case"heavy":n=2;break;case"full":default:n=1}this.poseSolution.setOptions({modelComplexity:n,smoothLandmarks:e.enableSmoothing||!0,selfieMode:this.selfieMode}),this.poseSolution.onResults(function(r){s.height=r.image.height,s.width=r.image.width,r.poseLandmarks==null?s.poses=[]:s.poses=[s.translateOutput(r.poseLandmarks,r.poseWorldLandmarks)]})}return t.prototype.translateOutput=function(e,n){var s=this,r={keypoints:e.map(function(i,o){return{x:i.x*s.width,y:i.y*s.height,z:i.z,score:i.visibility,name:$g[o]}})};return n!=null&&(r.keypoints3D=n.map(function(i,o){return{x:i.x,y:i.y,z:i.z,score:i.visibility,name:$g[o]}})),r},t.prototype.estimatePoses=function(e,n,s){return On(this,void 0,void 0,function(){return Pn(this,function(r){switch(r.label){case 0:return n&&n.flipHorizontal&&n.flipHorizontal!==this.selfieMode&&(this.selfieMode=n.flipHorizontal,this.poseSolution.setOptions({selfieMode:this.selfieMode})),[4,this.poseSolution.send({image:e},s)];case 1:return r.sent(),[2,this.poses]}})})},t.prototype.dispose=function(){this.poseSolution.close()},t.prototype.reset=function(){this.poseSolution.reset()},t.prototype.initialize=function(){return this.poseSolution.initialize()},t}();function Bke(t){return On(this,void 0,void 0,function(){var e,n;return Pn(this,function(s){switch(s.label){case 0:return e=function(r){if(r==null)return ts({},XC);var i=ts({},r);return i.runtime="mediapipe",i.enableSmoothing==null&&(i.enableSmoothing=XC.enableSmoothing),i.modelType==null&&(i.modelType=XC.modelType),i}(t),[4,(n=new jke(e)).initialize()];case 1:return s.sent(),[2,n]}})})}function QS(t){return t instanceof Yt?{height:t.shape[0],width:t.shape[1]}:{height:t.height,width:t.width}}function pK(t){return t-2*Math.PI*Math.floor((t+Math.PI)/(2*Math.PI))}function qR(t){return t instanceof Yt?t:Jye(t)}function YC(t,e){O(t.width!==0,function(){return e+" width cannot be 0."}),O(t.height!==0,function(){return e+" height cannot be 0."})}function uI(t,e,n){var s=e.inputResolution,r=e.keepAspectRatio,i=QS(t),o=function(l,c){return c?{xCenter:c.xCenter*l.width,yCenter:c.yCenter*l.height,width:c.width*l.width,height:c.height*l.height,rotation:c.rotation}:{xCenter:.5*l.width,yCenter:.5*l.height,width:l.width,height:l.height,rotation:0}}(i,n),a=function(l,c,u){if(u===void 0&&(u=!1),!u)return{top:0,left:0,right:0,bottom:0};var d=c.height,h=c.width;YC(c,"targetSize"),YC(l,"roi");var f,p,m=d/h,g=l.height/l.width,y=0,x=0;return m>g?(f=l.width,p=l.width*m,x=(1-g/m)/2):(f=l.height/m,p=l.height,y=(1-m/g)/2),l.width=f,l.height=p,{top:x,left:y,right:y,bottom:x}}(o,s,r);return{imageTensor:se(function(){var l=qR(t),c=cl(function(u,d,h,f){YC(f,"inputResolution");var p=1/d.width,m=1/d.height,g=u.xCenter,y=u.yCenter,x=Math.cos(u.rotation),v=Math.sin(u.rotation),b=h?-1:1,k=u.width,C=u.height;return[1/f.width*k*x*b*p*d.width,1/f.height*-C*v*p*d.width,(-.5*k*x*b+.5*C*v+g)*p*d.width,1/f.width*k*v*b*m*d.height,1/f.height*C*x*m*d.height,(-.5*C*x-.5*k*v*b+y)*m*d.height,0,0]}(o,i,!1,s),[1,8]);return ha.transform(as(Te(l,"float32")),c,"bilinear","nearest",0,[s.height,s.width])}),padding:a}}function mK(t){return t!=null&&t.currentTime!=null}var ac=function(){function t(e){this.alpha=e,this.initialized=!1}return t.prototype.apply=function(e,n){var s;return this.initialized?s=n==null?this.storedValue+this.alpha*(e-this.storedValue):this.storedValue+this.alpha*n*Math.asinh((e-this.storedValue)/n):(s=e,this.initialized=!0),this.rawValue=e,this.storedValue=s,s},t.prototype.applyWithAlpha=function(e,n,s){return this.alpha=n,this.apply(e,s)},t.prototype.hasLastRawValue=function(){return this.initialized},t.prototype.lastRawValue=function(){return this.rawValue},t.prototype.reset=function(){this.initialized=!1},t}(),ZC=function(){function t(e){this.frequency=e.frequency,this.minCutOff=e.minCutOff,this.beta=e.beta,this.thresholdCutOff=e.thresholdCutOff,this.thresholdBeta=e.thresholdBeta,this.derivateCutOff=e.derivateCutOff,this.x=new ac(this.getAlpha(this.minCutOff)),this.dx=new ac(this.getAlpha(this.derivateCutOff)),this.lastTimestamp=0}return t.prototype.apply=function(e,n,s){if(e==null)return e;var r=Math.trunc(n);if(this.lastTimestamp>=r)return e;this.lastTimestamp!==0&&r!==0&&(this.frequency=1/(1e-6*(r-this.lastTimestamp))),this.lastTimestamp=r;var i=this.x.hasLastRawValue()?(e-this.x.lastRawValue())*s*this.frequency:0,o=this.dx.applyWithAlpha(i,this.getAlpha(this.derivateCutOff)),a=this.minCutOff+this.beta*Math.abs(o),l=this.thresholdCutOff!=null?this.thresholdCutOff+this.thresholdBeta*Math.abs(o):null;return this.x.applyWithAlpha(e,this.getAlpha(a),l)},t.prototype.getAlpha=function(e){return 1/(1+this.frequency/(2*Math.PI*e))},t}(),dI=function(){function t(e){this.config=e}return t.prototype.apply=function(e,n,s){var r=this;if(e==null)return this.reset(),null;this.initializeFiltersIfEmpty(e);var i=1;if(!this.config.disableValueScaling){if(s<this.config.minAllowedObjectScale)return e.slice();i=1/s}return e.map(function(o,a){var l=ts({},o,{x:r.xFilters[a].apply(o.x,n,i),y:r.yFilters[a].apply(o.y,n,i)});return o.z!=null&&(l.z=r.zFilters[a].apply(o.z,n,i)),l})},t.prototype.reset=function(){this.xFilters=null,this.yFilters=null,this.zFilters=null},t.prototype.initializeFiltersIfEmpty=function(e){var n=this;this.xFilters!=null&&this.xFilters.length===e.length||(this.xFilters=e.map(function(s){return new ZC(n.config)}),this.yFilters=e.map(function(s){return new ZC(n.config)}),this.zFilters=e.map(function(s){return new ZC(n.config)}))},t}();function Wke(t,e){return t.map(function(n){var s=ts({},n,{x:n.x/e.width,y:n.y/e.height});return n.z!=null&&(n.z=n.z/e.width),s})}var QC=function(){function t(e){this.config=e,this.window=[],this.lowPassFilter=new ac(1),this.lastValue=0,this.lastValueScale=1,this.lastTimestamp=-1}return t.prototype.apply=function(e,n,s){if(e==null)return e;var r,i=Math.trunc(n);if(this.lastTimestamp>=i)return e;if(this.lastTimestamp===-1)r=1;else{for(var o=e*s-this.lastValue*this.lastValueScale,a=i-this.lastTimestamp,l=o,c=a,u=(1+this.window.length)*(1e6/30),d=0,h=this.window;d<h.length;d++){var f=h[d];if(c+f.duration>u)break;l+=f.distance,c+=f.duration}var p=l/(1e-6*c);r=1-1/(1+this.config.velocityScale*Math.abs(p)),this.window.unshift({distance:o,duration:a}),this.window.length>this.config.windowSize&&this.window.pop()}return this.lastValue=e,this.lastValueScale=s,this.lastTimestamp=i,this.lowPassFilter.applyWithAlpha(e,r)},t}(),Uke=function(){function t(e){this.config=e}return t.prototype.apply=function(e,n,s){var r=this;if(e==null)return this.reset(),null;var i=1;if(!this.config.disableValueScaling){if(s<this.config.minAllowedObjectScale)return e.slice();i=1/s}return this.initializeFiltersIfEmpty(e),e.map(function(o,a){var l=ts({},o,{x:r.xFilters[a].apply(o.x,n,i),y:r.yFilters[a].apply(o.y,n,i)});return o.z!=null&&(l.z=r.zFilters[a].apply(o.z,n,i)),l})},t.prototype.reset=function(){this.xFilters=null,this.yFilters=null,this.zFilters=null},t.prototype.initializeFiltersIfEmpty=function(e){var n=this;this.xFilters!=null&&this.xFilters.length===e.length||(this.xFilters=e.map(function(s){return new QC(n.config)}),this.yFilters=e.map(function(s){return new QC(n.config)}),this.zFilters=e.map(function(s){return new QC(n.config)}))},t}();function gK(t,e){return t.map(function(n){var s=ts({},n,{x:n.x*e.width,y:n.y*e.height});return n.z!=null&&(s.z=n.z*e.width),s})}var JC=function(){function t(e){if(e.velocityFilter!=null)this.keypointsFilter=new Uke(e.velocityFilter);else{if(e.oneEuroFilter==null)throw new Error("Either configure velocityFilter or oneEuroFilter, but got "+e+".");this.keypointsFilter=new dI(e.oneEuroFilter)}}return t.prototype.apply=function(e,n,s,r,i){if(r===void 0&&(r=!1),e==null)return this.keypointsFilter.reset(),null;var o=i!=null?function(c,u){return(c.width*u.width+c.height*u.height)/2}(i,s):1,a=r?gK(e,s):e,l=this.keypointsFilter.apply(a,n,o);return r?Wke(l,s):l},t}();function hI(t,e){var n=function(s,r,i,o){var a=r-s,l=o-i;if(a===0)throw new Error("Original min and max are both "+s+", range cannot be 0.");var c=l/a;return{scale:c,offset:i-s*c}}(0,255,e[0],e[1]);return se(function(){return fe(Y(t,n.scale),n.offset)})}function eT(t,e,n){var s=n.rotationVectorStartKeypointIndex,r=n.rotationVectorEndKeypointIndex,i=t.locationData,o=i.relativeKeypoints[s].x*e.width,a=i.relativeKeypoints[s].y*e.height,l=i.relativeKeypoints[r].x*e.width,c=i.relativeKeypoints[r].y*e.height,u=2*Math.sqrt((l-o)*(l-o)+(c-a)*(c-a)),d=function(h,f,p){var m,g=h.locationData,y=p.rotationVectorStartKeypointIndex,x=p.rotationVectorEndKeypointIndex;m=p.rotationVectorTargetAngle?p.rotationVectorTargetAngle:Math.PI*p.rotationVectorTargetAngleDegree/180;var v=g.relativeKeypoints[y].x*f.width,b=g.relativeKeypoints[y].y*f.height,k=g.relativeKeypoints[x].x*f.width,C=g.relativeKeypoints[x].y*f.height;return pK(m-Math.atan2(-(C-b),k-v))}(t,e,n);return{xCenter:o/e.width,yCenter:a/e.height,width:u/e.width,height:u/e.height,rotation:d}}function rz(t,e,n,s){return s===1?.5*(t+e):t+(e-t)*n/(s-1)}function Hke(t,e){return se(function(){var n=function(i){return se(function(){var o=st(i,[0,0,0],[1,-1,1]);return[bi(o),st(i,[0,0,1],[1,-1,-1])]})}(e.predict(t)),s=n[0],r=n[1];return{boxes:Bt(r),scores:Bt(s)}})}function iz(t){for(var e={locationData:{relativeKeypoints:[]}},n=Number.MAX_SAFE_INTEGER,s=Number.MIN_SAFE_INTEGER,r=Number.MAX_SAFE_INTEGER,i=Number.MIN_SAFE_INTEGER,o=0;o<t.length;++o){var a=t[o];n=Math.min(n,a.x),s=Math.max(s,a.x),r=Math.min(r,a.y),i=Math.max(i,a.y),e.locationData.relativeKeypoints.push({x:a.x,y:a.y})}return e.locationData.relativeBoundingBox={xMin:n,yMin:r,xMax:s,yMax:i,width:s-n,height:i-r},e}function Gke(t,e,n,s){return On(this,void 0,void 0,function(){var r,i,o,a,l;return Pn(this,function(c){switch(c.label){case 0:return r=cl(t.map(function(u){return[u.locationData.relativeBoundingBox.yMin,u.locationData.relativeBoundingBox.xMin,u.locationData.relativeBoundingBox.yMax,u.locationData.relativeBoundingBox.xMax]})),i=cs(t.map(function(u){return u.score[0]})),[4,ha.nonMaxSuppressionAsync(r,i,e,n,s)];case 1:return[4,(o=c.sent()).array()];case 2:return a=c.sent(),l=t.filter(function(u,d){return a.indexOf(d)>-1}),rt([r,i,o]),[2,l]}})})}function Kke(t,e,n){return On(this,void 0,void 0,function(){var s,r,i,o,a,l,c,u,d,h,f,p,m,g,y,x,v,b,k,C,N,I,$,A;return Pn(this,function(P){switch(P.label){case 0:if(s=Bt(e,[0]),r=s.shape,i=r[0],o=r[1],a=r[2],t.length!==a)throw new Error("Expected heatmap to have same number of channels as the number of landmarks. But got landmarks length: "+t.length+", heatmap length: "+a);return l=[],[4,s.buffer()];case 1:for(c=P.sent(),u=0;u<t.length;u++)if(d=t[u],h=ts({},d),l.push(h),f=Math.trunc(h.x*o),p=Math.trunc(h.y*i),!(f<0||f>=o||p<0||f>=i)){for(m=Math.trunc((n.kernelSize-1)/2),g=Math.max(0,f-m),y=Math.min(o,f+m+1),x=Math.max(0,p-m),v=Math.min(i,p+m+1),b=0,k=0,C=0,N=0,I=x;I<v;++I)for($=g;$<y;++$)A=c.get(I,$,u),b+=A,N=Math.max(N,A),k+=$*A,C+=I*A;N>=n.minConfidenceToRefine&&b>0&&(h.x=k/o/b,h.y=C/i/b)}return s.dispose(),[2,l]}})})}function qke(t,e,n){return On(this,void 0,void 0,function(){var s,r,i,o,a;return Pn(this,function(l){switch(l.label){case 0:return s=t[0],r=t[1],i=function(c,u,d){return se(function(){var h,f,p,m;d.reverseOutputOrder?(f=Bt(st(c,[0,d.boxCoordOffset+0],[-1,1])),h=Bt(st(c,[0,d.boxCoordOffset+1],[-1,1])),m=Bt(st(c,[0,d.boxCoordOffset+2],[-1,1])),p=Bt(st(c,[0,d.boxCoordOffset+3],[-1,1]))):(h=Bt(st(c,[0,d.boxCoordOffset+0],[-1,1])),f=Bt(st(c,[0,d.boxCoordOffset+1],[-1,1])),p=Bt(st(c,[0,d.boxCoordOffset+2],[-1,1])),m=Bt(st(c,[0,d.boxCoordOffset+3],[-1,1]))),f=fe(Y($e(f,d.xScale),u.w),u.x),h=fe(Y($e(h,d.yScale),u.h),u.y),d.applyExponentialOnBoxSize?(p=Y(Ir($e(p,d.hScale)),u.h),m=Y(Ir($e(m,d.wScale)),u.w)):(p=Y($e(p,d.hScale),u.h),m=Y($e(m,d.wScale),u.h));var g=Ae(h,$e(p,2)),y=Ae(f,$e(m,2)),x=fe(h,$e(p,2)),v=fe(f,$e(m,2)),b=Cn([Q(g,[d.numBoxes,1]),Q(y,[d.numBoxes,1]),Q(x,[d.numBoxes,1]),Q(v,[d.numBoxes,1])],1);if(d.numKeypoints)for(var k=0;k<d.numKeypoints;++k){var C=d.keypointCoordOffset+k*d.numValuesPerKeypoint,N=void 0,I=void 0;d.reverseOutputOrder?(N=Bt(st(c,[0,C],[-1,1])),I=Bt(st(c,[0,C+1],[-1,1]))):(I=Bt(st(c,[0,C],[-1,1])),N=Bt(st(c,[0,C+1],[-1,1])));var $=fe(Y($e(N,d.xScale),u.w),u.x),A=fe(Y($e(I,d.yScale),u.h),u.y);b=Cn([b,Q($,[d.numBoxes,1]),Q(A,[d.numBoxes,1])],1)}return b})}(r,e,n),o=se(function(){var c=s;return n.sigmoidScore?(n.scoreClippingThresh!=null&&(c=Tr(s,-n.scoreClippingThresh,n.scoreClippingThresh)),c=bi(c)):c}),[4,Xke(i,o,n)];case 1:return a=l.sent(),rt([i,o]),[2,a]}})})}function Xke(t,e,n){return On(this,void 0,void 0,function(){var s,r,i,o,a,l,c,u,d,h,f,p;return Pn(this,function(m){switch(m.label){case 0:return s=[],[4,t.data()];case 1:return r=m.sent(),[4,e.data()];case 2:for(i=m.sent(),o=0;o<n.numBoxes;++o)if(!(n.minScoreThresh!=null&&i[o]<n.minScoreThresh||(a=o*n.numCoords,l=Yke(r[a+0],r[a+1],r[a+2],r[a+3],i[o],n.flipVertically,o),(c=l.locationData.relativeBoundingBox).width<0||c.height<0))){if(n.numKeypoints>0)for((u=l.locationData).relativeKeypoints=[],d=n.numKeypoints*n.numValuesPerKeypoint,h=0;h<d;h+=n.numValuesPerKeypoint)f=a+n.keypointCoordOffset+h,p={x:r[f+0],y:n.flipVertically?1-r[f+1]:r[f+1]},u.relativeKeypoints.push(p);s.push(l)}return[2,s]}})})}function Yke(t,e,n,s,r,i,o){return{score:[r],ind:o,locationData:{relativeBoundingBox:{xMin:e,yMin:i?1-n:t,xMax:s,yMax:i?1-t:n,width:s-e,height:n-t}}}}function oz(t,e,n,s){return n===void 0&&(n=!1),s===void 0&&(s=!1),On(this,void 0,void 0,function(){var r,i,o,a,l,c,u,d;return Pn(this,function(h){switch(h.label){case 0:return r=t.size,i=r/e.numLandmarks,[4,t.data()];case 1:for(o=h.sent(),a=[],l=0;l<e.numLandmarks;++l)c=l*i,(d={x:0,y:0}).x=n?e.inputImageWidth-o[c]:o[c],i>1&&(d.y=s?e.inputImageHeight-o[c+1]:o[c+1]),i>2&&(d.z=o[c+2]),i>3&&(d.score=(f=o[c+3],1/(1+Math.exp(-f)))),a.push(d);for(u=0;u<a.length;++u)(d=a[u]).x=d.x/e.inputImageWidth,d.y=d.y/e.inputImageHeight,d.z=d.z/e.inputImageWidth/(e.normalizeZ||1);return[2,a]}var f})})}function az(t,e,n){var s=t.width,r=t.height,i=t.rotation;if(n.rotation==null&&n.rotationDegree==null||(i=function(u,d){return d.rotation!=null?u+=d.rotation:d.rotationDegree!=null&&(u+=Math.PI*d.rotationDegree/180),pK(u)}(i,n)),i===0)t.xCenter=t.xCenter+s*n.shiftX,t.yCenter=t.yCenter+r*n.shiftY;else{var o=(e.width*s*n.shiftX*Math.cos(i)-e.height*r*n.shiftY*Math.sin(i))/e.width,a=(e.width*s*n.shiftX*Math.sin(i)+e.height*r*n.shiftY*Math.cos(i))/e.height;t.xCenter=t.xCenter+o,t.yCenter=t.yCenter+a}if(n.squareLong){var l=Math.max(s*e.width,r*e.height);s=l/e.width,r=l/e.height}else if(n.squareShort){var c=Math.min(s*e.width,r*e.height);s=c/e.width,r=c/e.height}return t.width=s*n.scaleX,t.height=r*n.scaleY,t}var lz=function(){function t(e){this.alpha=e.alpha}return t.prototype.apply=function(e){var n=this;if(e==null)return this.visibilityFilters=null,null;this.visibilityFilters!=null&&this.visibilityFilters.length===e.length||(this.visibilityFilters=e.map(function(a){return new ac(n.alpha)}));for(var s=[],r=0;r<e.length;++r){var i=e[r],o=ts({},i);o.score=this.visibilityFilters[r].apply(i.score),s.push(o)}return s},t}(),Zke={reduceBoxesInLowestlayer:!1,interpolatedScaleAspectRatio:1,featureMapHeight:[],featureMapWidth:[],numLayers:5,minScale:.1484375,maxScale:.75,inputSizeHeight:224,inputSizeWidth:224,anchorOffsetX:.5,anchorOffsetY:.5,strides:[8,16,32,32,32],aspectRatios:[1],fixedAnchorSize:!0},Ux={runtime:"tfjs",modelType:"full",enableSmoothing:!0,detectorModelUrl:"https://tfhub.dev/mediapipe/tfjs-model/blazepose_3d/detector/1",landmarkModelUrl:"https://tfhub.dev/mediapipe/tfjs-model/blazepose_3d/landmark/full/1"},Qke={maxPoses:1,flipHorizontal:!1},Jke={applyExponentialOnBoxSize:!1,flipVertically:!1,ignoreClasses:[],numClasses:1,numBoxes:2254,numCoords:12,boxCoordOffset:0,keypointCoordOffset:4,numKeypoints:4,numValuesPerKeypoint:2,sigmoidScore:!0,scoreClippingThresh:100,reverseOutputOrder:!0,xScale:224,yScale:224,hScale:224,wScale:224,minScoreThresh:.5},eCe=-1,tCe=.3,cz={shiftX:0,shiftY:0,scaleX:1.25,scaleY:1.25,squareLong:!0},nCe={inputResolution:{width:224,height:224},keepAspectRatio:!0},sCe={inputResolution:{width:256,height:256},keepAspectRatio:!0},rCe={numLandmarks:39,inputImageWidth:256,inputImageHeight:256},iCe={numLandmarks:39,inputImageWidth:1,inputImageHeight:1},oCe={kernelSize:7,minConfidenceToRefine:.5},uz={alpha:.1},aCe={oneEuroFilter:{frequency:30,minCutOff:.05,beta:80,derivateCutOff:1,minAllowedObjectScale:1e-6}},lCe={oneEuroFilter:{frequency:30,minCutOff:.01,beta:10,derivateCutOff:1,minAllowedObjectScale:1e-6}},cCe={oneEuroFilter:{frequency:30,minCutOff:.1,beta:40,derivateCutOff:1,minAllowedObjectScale:1e-6,disableValueScaling:!0}},uCe=function(){function t(e,n,s,r){this.detectorModel=e,this.landmarkModel=n,this.enableSmoothing=s,this.modelType=r,this.regionOfInterest=null,this.anchors=function(c){for(var u=[],d=0;d<c.numLayers;){for(var h=[],f=[],p=[],m=[],g=d;g<c.strides.length&&c.strides[g]===c.strides[d];){var y=rz(c.minScale,c.maxScale,g,c.strides.length);if(g===0&&c.reduceBoxesInLowestLayer)p.push(1),p.push(2),p.push(.5),m.push(.1),m.push(y),m.push(y);else{for(var x=0;x<c.aspectRatios.length;++x)p.push(c.aspectRatios[x]),m.push(y);if(c.interpolatedScaleAspectRatio>0){var v=g===c.strides.length-1?1:rz(c.minScale,c.maxScale,g+1,c.strides.length);m.push(Math.sqrt(y*v)),p.push(c.interpolatedScaleAspectRatio)}}g++}for(var b=0;b<p.length;++b){var k=Math.sqrt(p[b]);h.push(m[b]/k),f.push(m[b]*k)}var C=0,N=0;if(c.featureMapHeight.length>0)C=c.featureMapHeight[d],N=c.featureMapWidth[d];else{var I=c.strides[d];C=Math.ceil(c.inputSizeHeight/I),N=Math.ceil(c.inputSizeWidth/I)}for(var $=0;$<C;++$)for(var A=0;A<N;++A)for(var P=0;P<h.length;++P){var F={xCenter:(A+c.anchorOffsetX)/N,yCenter:($+c.anchorOffsetY)/C,width:0,height:0};c.fixedAnchorSize?(F.width=1,F.height=1):(F.width=f[P],F.height=h[P]),u.push(F)}d=g}return u}(Zke);var i=cs(this.anchors.map(function(c){return c.width})),o=cs(this.anchors.map(function(c){return c.height})),a=cs(this.anchors.map(function(c){return c.xCenter})),l=cs(this.anchors.map(function(c){return c.yCenter}));this.anchorTensor={x:a,y:l,w:i,h:o}}return t.prototype.estimatePoses=function(e,n,s){return On(this,void 0,void 0,function(){var r,i,o,a,l,c,u,d,h,f,p,m,g,y,x,v,b,k;return Pn(this,function(C){switch(C.label){case 0:return r=function(N){var I;if((I=N==null?Qke:ts({},N)).maxPoses==null&&(I.maxPoses=1),I.maxPoses<=0)throw new Error("Invalid maxPoses "+I.maxPoses+". Should be > 0.");if(I.maxPoses>1)throw new Error("Multi-pose detection is not implemented yet. Please set maxPoses to 1.");return I}(n),e==null?(this.reset(),[2,[]]):(this.maxPoses=r.maxPoses,this.timestamp=s!=null?1e3*s:mK(e)?1e6*e.currentTime:null,i=QS(e),o=se(function(){return Te(qR(e),"float32")}),(a=this.regionOfInterest)!=null?[3,2]:[4,this.detectPose(o)]);case 1:if((l=C.sent()).length===0)return this.reset(),o.dispose(),[2,[]];c=l[0],a=this.poseDetectionToRoi(c,i),C.label=2;case 2:return[4,this.poseLandmarksByRoi(a,o)];case 3:return u=C.sent(),o.dispose(),u==null?(this.reset(),[2,[]]):(d=u.actualLandmarks,h=u.auxiliaryLandmarks,f=u.poseScore,p=u.actualWorldLandmarks,m=this.poseLandmarkFiltering(d,h,p,i),g=m.actualLandmarksFiltered,y=m.auxiliaryLandmarksFiltered,x=m.actualWorldLandmarksFiltered,v=this.poseLandmarksToRoi(y,i),this.regionOfInterest=v,(b=g!=null?gK(g,i):null)!=null&&b.forEach(function(N,I){N.name=$g[I]}),(k=x)!=null&&k.forEach(function(N,I){N.name=$g[I]}),[2,[{score:f,keypoints:b,keypoints3D:k}]])}})})},t.prototype.dispose=function(){this.detectorModel.dispose(),this.landmarkModel.dispose(),rt([this.anchorTensor.x,this.anchorTensor.y,this.anchorTensor.w,this.anchorTensor.h])},t.prototype.reset=function(){this.regionOfInterest=null,this.visibilitySmoothingFilterActual=null,this.visibilitySmoothingFilterAuxiliary=null,this.landmarksSmoothingFilterActual=null,this.landmarksSmoothingFilterAuxiliary=null},t.prototype.detectPose=function(e){return On(this,void 0,void 0,function(){var n,s,r,i,o,a,l,c,u;return Pn(this,function(d){switch(d.label){case 0:return n=uI(e,nCe),s=n.imageTensor,r=n.padding,i=hI(s,[-1,1]),o=Hke(i,this.detectorModel),a=o.boxes,[4,qke([l=o.scores,a],this.anchorTensor,Jke)];case 1:return[4,Gke(d.sent(),this.maxPoses,tCe,eCe)];case 2:return c=d.sent(),u=function(h,f){h===void 0&&(h=[]);for(var p=f.left,m=f.top,g=f.left+f.right,y=f.top+f.bottom,x=0;x<h.length;x++){var v=h[x],b=v.locationData.relativeBoundingBox,k=(b.xMin-p)/(1-g),C=(b.yMin-m)/(1-y),N=b.width/(1-g),I=b.height/(1-y);b.xMin=k,b.yMin=C,b.width=N,b.height=I;for(var $=0;$<v.locationData.relativeKeypoints.length;++$){var A=v.locationData.relativeKeypoints[$],P=(A.x-p)/(1-g),F=(A.y-m)/(1-y);A.x=P,A.y=F}}return h}(c,r),rt([s,i,l,a]),[2,u]}})})},t.prototype.poseDetectionToRoi=function(e,n){return az(eT(e,n,{rotationVectorEndKeypointIndex:1,rotationVectorStartKeypointIndex:0,rotationVectorTargetAngleDegree:90}),n,cz)},t.prototype.poseLandmarksByRoi=function(e,n){return On(this,void 0,void 0,function(){var s,r,i,o,a,l,c,u,d,h,f,p,m,g,y,x,v,b,k,C;return Pn(this,function(N){switch(N.label){case 0:if(s=uI(n,sCe,e),r=s.imageTensor,i=s.padding,o=hI(r,[0,1]),this.modelType!=="lite"&&this.modelType!=="full"&&this.modelType!=="heavy")throw new Error("Model type must be one of lite, full or heavy,but got "+this.modelType);return a=this.landmarkModel.execute(o,["ld_3d","output_poseflag","activation_heatmap","world_3d"]),l=a[0],c=a[1],u=a[2],d=a[3],[4,c.data()];case 1:return(h=N.sent()[0])<.5?(rt(a),rt([r,o]),[2,null]):[4,oz(l,rCe)];case 2:return[4,Kke(f=N.sent(),u,oCe)];case 3:return p=N.sent(),m=function(I,$){var A=$.left,P=$.top,F=$.left+$.right,V=$.top+$.bottom;return I.map(function(z){return ts({},z,{x:(z.x-A)/(1-F),y:(z.y-P)/(1-V),z:z.z/(1-F)})})}(p,i),g=function(I,$,A){A===void 0&&(A={ignoreRotation:!1});for(var P=[],F=0,V=I;F<V.length;F++){var z=V[F],B=z.x-.5,W=z.y-.5,q=A.ignoreRotation?0:$.rotation,M=Math.cos(q)*B-Math.sin(q)*W,G=Math.sin(q)*B+Math.cos(q)*W;M=M*$.width+$.xCenter,G=G*$.height+$.yCenter;var ne=z.z*$.width,ie=ts({},z);ie.x=M,ie.y=G,ie.z=ne,P.push(ie)}return P}(m,e),y=g.slice(0,33),x=g.slice(33,35),[4,oz(d,iCe)];case 4:return v=N.sent(),b=function(I,$,A){A===void 0&&(A=!0);for(var P=[],F=0;F<I.length;F++){var V=ts({},$[F]);A&&(V.score=I[F].score),P.push(V)}return P}(f,v,!0),k=function(I,$){for(var A=[],P=0,F=I;P<F.length;P++){var V=F[P],z=V.x,B=V.y,W=$.rotation,q=Math.cos(W)*z-Math.sin(W)*B,M=Math.sin(W)*z+Math.cos(W)*B,G=ts({},V);G.x=q,G.y=M,A.push(G)}return A}(b,e),C=k.slice(0,33),rt(a),rt([r,o]),[2,{actualLandmarks:y,auxiliaryLandmarks:x,poseScore:h,actualWorldLandmarks:C}]}})})},t.prototype.poseLandmarksToRoi=function(e,n){return az(eT(iz(e),n,{rotationVectorStartKeypointIndex:0,rotationVectorEndKeypointIndex:1,rotationVectorTargetAngleDegree:90}),n,cz)},t.prototype.poseLandmarkFiltering=function(e,n,s,r){var i,o,a;if(this.timestamp!=null&&this.enableSmoothing){var l=eT(iz(n),r,{rotationVectorEndKeypointIndex:0,rotationVectorStartKeypointIndex:1,rotationVectorTargetAngleDegree:90});this.visibilitySmoothingFilterActual==null&&(this.visibilitySmoothingFilterActual=new lz(uz)),i=this.visibilitySmoothingFilterActual.apply(e),this.visibilitySmoothingFilterAuxiliary==null&&(this.visibilitySmoothingFilterAuxiliary=new lz(uz)),o=this.visibilitySmoothingFilterAuxiliary.apply(n),a=this.visibilitySmoothingFilterActual.apply(s),this.landmarksSmoothingFilterActual==null&&(this.landmarksSmoothingFilterActual=new JC(aCe)),i=this.landmarksSmoothingFilterActual.apply(i,this.timestamp,r,!0,l),this.landmarksSmoothingFilterAuxiliary==null&&(this.landmarksSmoothingFilterAuxiliary=new JC(lCe)),o=this.landmarksSmoothingFilterAuxiliary.apply(o,this.timestamp,r,!0,l),this.worldLandmarksSmoothingFilterActual==null&&(this.worldLandmarksSmoothingFilterActual=new JC(cCe)),a=this.worldLandmarksSmoothingFilterActual.apply(s,this.timestamp)}else i=e,o=n,a=s;return{actualLandmarksFiltered:i,auxiliaryLandmarksFiltered:o,actualWorldLandmarksFiltered:a}},t}();function dCe(t){return On(this,void 0,void 0,function(){var e,n,s,r,i,o;return Pn(this,function(a){switch(a.label){case 0:return e=function(l){var c=ts({},l??Ux);if(c.enableSmoothing==null&&(c.enableSmoothing=Ux.enableSmoothing),c.modelType==null&&(c.modelType=Ux.modelType),c.detectorModelUrl==null&&(c.detectorModelUrl=Ux.detectorModelUrl),c.landmarkModelUrl==null)switch(c.modelType){case"lite":c.landmarkModelUrl="https://tfhub.dev/mediapipe/tfjs-model/blazepose_3d/landmark/lite/1";break;case"heavy":c.landmarkModelUrl="https://tfhub.dev/mediapipe/tfjs-model/blazepose_3d/landmark/heavy/1";break;case"full":default:c.landmarkModelUrl="https://tfhub.dev/mediapipe/tfjs-model/blazepose_3d/landmark/full/1"}return c}(t),n=e.detectorModelUrl.indexOf("https://tfhub.dev")>-1,s=e.landmarkModelUrl.indexOf("https://tfhub.dev")>-1,[4,Promise.all([Ff(e.detectorModelUrl,{fromTFHub:n}),Ff(e.landmarkModelUrl,{fromTFHub:s})])];case 1:return r=a.sent(),i=r[0],o=r[1],[2,new uCe(i,o,e.enableSmoothing,e.modelType)]}})})}var sd,ka,yK=function(){function t(e){(function(n){if(n.maxTracks<1)throw new Error("Must specify 'maxTracks' to be at least 1, but encountered "+n.maxTracks);if(n.maxAge<=0)throw new Error("Must specify 'maxAge' to be positive, but encountered "+n.maxAge);if(n.keypointTrackerParams!==void 0){if(n.keypointTrackerParams.keypointConfidenceThreshold<0||n.keypointTrackerParams.keypointConfidenceThreshold>1)throw new Error("Must specify 'keypointConfidenceThreshold' to be in the range [0, 1], but encountered "+n.keypointTrackerParams.keypointConfidenceThreshold);if(n.keypointTrackerParams.minNumberOfKeypoints<1)throw new Error("Must specify 'minNumberOfKeypoints' to be at least 1, but encountered "+n.keypointTrackerParams.minNumberOfKeypoints);for(var s=0,r=n.keypointTrackerParams.keypointFalloff;s<r.length;s++){var i=r[s];if(i<=0)throw new Error("Must specify each keypoint falloff parameterto be positive but encountered "+i)}}})(e),this.tracks=[],this.maxTracks=e.maxTracks,this.maxAge=1e3*e.maxAge,this.minSimilarity=e.minSimilarity,this.nextID=1}return t.prototype.apply=function(e,n){this.filterOldTracks(n);var s=this.computeSimilarity(e);return this.assignTracks(e,s,n),this.updateTracks(n),e},t.prototype.getTracks=function(){return this.tracks.slice()},t.prototype.getTrackIDs=function(){return new Set(this.tracks.map(function(e){return e.id}))},t.prototype.filterOldTracks=function(e){var n=this;this.tracks=this.tracks.filter(function(s){return e-s.lastTimestamp<=n.maxAge})},t.prototype.assignTracks=function(e,n,s){for(var r=Array.from(Array(n[0].length).keys()),i=[],o=0,a=Array.from(Array(e.length).keys());o<a.length;o++){var l=a[o];if(r.length!==0){for(var c=-1,u=-1,d=0,h=r;d<h.length;d++){var f=h[d],p=n[l][f];p>=this.minSimilarity&&p>u&&(c=f,u=p)}if(c>=0){var m=this.tracks[c];m=Object.assign(m,this.createTrack(e[l],s,m.id)),e[l].id=m.id;var g=r.indexOf(c);r.splice(g,1)}else i.push(l)}else i.push(l)}for(var y=0,x=i;y<x.length;y++){l=x[y];var v=this.createTrack(e[l],s);this.tracks.push(v),e[l].id=v.id}},t.prototype.updateTracks=function(e){this.tracks.sort(function(n,s){return s.lastTimestamp-n.lastTimestamp}),this.tracks=this.tracks.slice(0,this.maxTracks)},t.prototype.createTrack=function(e,n,s){var r={id:s||this.nextTrackID(),lastTimestamp:n,keypoints:e.keypoints.slice().map(function(i){return ts({},i)})};return e.box!==void 0&&(r.box=ts({},e.box)),r},t.prototype.nextTrackID=function(){var e=this.nextID;return this.nextID+=1,e},t.prototype.remove=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this.tracks=this.tracks.filter(function(s){return!e.includes(s.id)})},t.prototype.reset=function(){this.tracks=[]},t}(),hCe=function(t){function e(n){return t.call(this,n)||this}return fK(e,t),e.prototype.computeSimilarity=function(n){var s=this;return n.length===0||this.tracks.length===0?[[]]:n.map(function(r){return s.tracks.map(function(i){return s.iou(r,i)})})},e.prototype.iou=function(n,s){var r=Math.max(n.box.xMin,s.box.xMin),i=Math.max(n.box.yMin,s.box.yMin),o=Math.min(n.box.xMax,s.box.xMax),a=Math.min(n.box.yMax,s.box.yMax);if(r>=o||i>=a)return 0;var l=(o-r)*(a-i);return l/(n.box.width*n.box.height+s.box.width*s.box.height-l)},e}(yK),fCe=function(t){function e(n){var s=t.call(this,n)||this;return s.keypointThreshold=n.keypointTrackerParams.keypointConfidenceThreshold,s.keypointFalloff=n.keypointTrackerParams.keypointFalloff,s.minNumKeyoints=n.keypointTrackerParams.minNumberOfKeypoints,s}return fK(e,t),e.prototype.computeSimilarity=function(n){if(n.length===0||this.tracks.length===0)return[[]];for(var s=[],r=0,i=n;r<i.length;r++){for(var o=i[r],a=[],l=0,c=this.tracks;l<c.length;l++){var u=c[l];a.push(this.oks(o,u))}s.push(a)}return s},e.prototype.oks=function(n,s){for(var r=this.area(s.keypoints)+1e-6,i=0,o=0,a=0;a<n.keypoints.length;++a){var l=n.keypoints[a],c=s.keypoints[a];if(!(l.score<this.keypointThreshold||c.score<this.keypointThreshold)){o+=1;var u=Math.pow(l.x-c.x,2)+Math.pow(l.y-c.y,2),d=2*this.keypointFalloff[a];i+=Math.exp(-1*u/(2*r*Math.pow(d,2)))}}return o<this.minNumKeyoints?0:i/o},e.prototype.area=function(n){var s=this,r=n.filter(function(l){return l.score>s.keypointThreshold}),i=Math.min.apply(Math,[1].concat(r.map(function(l){return l.x}))),o=Math.max.apply(Math,[0].concat(r.map(function(l){return l.x}))),a=Math.min.apply(Math,[1].concat(r.map(function(l){return l.y})));return(o-i)*(Math.max.apply(Math,[0].concat(r.map(function(l){return l.y})))-a)},e}(yK);function pCe(t){switch(t){case ka.BlazePose:return $g.reduce(function(e,n,s){return e[n]=s,e},{});case ka.PoseNet:case ka.MoveNet:return Aa.reduce(function(e,n,s){return e[n]=s,e},{});default:throw new Error("Model "+t+" is not supported.")}}(function(t){t.Keypoint="keypoint",t.BoundingBox="boundingBox"})(sd||(sd={})),function(t){t.MoveNet="MoveNet",t.BlazePose="BlazePose",t.PoseNet="PoseNet"}(ka||(ka={}));var dz=["SinglePose.Lightning","SinglePose.Thunder","MultiPose.Lightning"],xK={modelType:"SinglePose.Lightning",enableSmoothing:!0},hz={},fz={frequency:30,minCutOff:2.5,beta:300,derivateCutOff:2.5,thresholdCutOff:.5,thresholdBeta:5,disableValueScaling:!0},tT={maxTracks:18,maxAge:1e3,minSimilarity:.2,keypointTrackerParams:{keypointConfidenceThreshold:.3,keypointFalloff:[.026,.025,.025,.035,.035,.079,.079,.072,.072,.062,.062,.107,.107,.087,.087,.089,.089],minNumberOfKeypoints:4}},pz={maxTracks:18,maxAge:1e3,minSimilarity:.15,trackerParams:{}};function mCe(t,e,n,s){for(var r={},i=0,o=Aa;i<o.length;i++){var a=o[i];r[a]=[e[n[a]].y*s.height,e[n[a]].x*s.width]}if(function(x,v){return(x[v.left_hip].score>.2||x[v.right_hip].score>.2)&&(x[v.left_shoulder].score>.2||x[v.right_shoulder].score>.2)}(e,n)){var l=(r.left_hip[0]+r.right_hip[0])/2,c=(r.left_hip[1]+r.right_hip[1])/2,u=function(x,v,b,k,C){for(var N=["left_shoulder","right_shoulder","left_hip","right_hip"],I=0,$=0,A=0;A<N.length;A++)(B=Math.abs(k-b[N[A]][0]))>I&&(I=B),(W=Math.abs(C-b[N[A]][1]))>$&&($=W);for(var P=0,F=0,V=0,z=Object.keys(b);V<z.length;V++){var B,W,q=z[V];x[v[q]].score<.2||((B=Math.abs(k-b[q][0]))>P&&(P=B),(W=Math.abs(C-b[q][1]))>F&&(F=W))}return[I,$,P,F]}(e,n,r,l,c),d=u[0],h=u[1],f=u[2],p=u[3],m=Math.max(1.9*h,1.9*d,1.2*f,1.2*p),g=[l-(m=Math.min(m,Math.max(c,s.width-c,l,s.height-l))),c-m];if(m>Math.max(s.width,s.height)/2)return fI(t==null,s);var y=2*m;return{yMin:g[0]/s.height,xMin:g[1]/s.width,yMax:(g[0]+y)/s.height,xMax:(g[1]+y)/s.width,height:(g[0]+y)/s.height-g[0]/s.height,width:(g[1]+y)/s.width-g[1]/s.width}}return fI(t==null,s)}function fI(t,e){var n,s,r,i;return t?e.width>e.height?(n=1,s=e.height/e.width,r=0,i=(e.width/2-e.height/2)/e.width):(n=e.width/e.height,s=1,r=(e.height/2-e.width/2)/e.height,i=0):e.width>e.height?(n=e.width/e.height,s=1,r=(e.height/2-e.width/2)/e.height,i=0):(n=1,s=e.height/e.width,r=0,i=(e.width/2-e.height/2)/e.width),{yMin:r,xMin:i,yMax:r+n,xMax:i+s,height:n,width:s}}function gCe(t){var e,n=t==null?xK:ts({},t);if(n.modelType==null)n.modelType="SinglePose.Lightning";else if(dz.indexOf(n.modelType)<0)throw new Error("Invalid architecture "+n.modelType+". Should be one of "+dz);if(n.enableSmoothing==null&&(n.enableSmoothing=!0),n.minPoseScore!=null&&(n.minPoseScore<0||n.minPoseScore>1))throw new Error("minPoseScore should be between 0.0 and 1.0");if(n.multiPoseMaxDimension!=null&&(n.multiPoseMaxDimension%32!=0||n.multiPoseMaxDimension<128||n.multiPoseMaxDimension>512))throw new Error("multiPoseResolution must be a multiple of 32 and between 128 and 512");if(n.modelType==="MultiPose.Lightning"&&n.enableTracking==null&&(n.enableTracking=!0),n.modelType==="MultiPose.Lightning"&&n.enableTracking===!0)if(n.trackerType==null&&(n.trackerType=sd.BoundingBox),n.trackerType===sd.Keypoint)n.trackerConfig!=null?n.trackerConfig=function(s){var r=mz(tT,s);return r.keypointTrackerParams=ts({},tT.keypointTrackerParams),s.keypointTrackerParams!=null&&(s.keypointTrackerParams.keypointConfidenceThreshold!=null&&(r.keypointTrackerParams.keypointConfidenceThreshold=s.keypointTrackerParams.keypointConfidenceThreshold),s.keypointTrackerParams.keypointFalloff!=null&&(r.keypointTrackerParams.keypointFalloff=s.keypointTrackerParams.keypointFalloff),s.keypointTrackerParams.minNumberOfKeypoints!=null&&(r.keypointTrackerParams.minNumberOfKeypoints=s.keypointTrackerParams.minNumberOfKeypoints)),r}(n.trackerConfig):n.trackerConfig=tT;else{if(n.trackerType!==sd.BoundingBox)throw new Error("Tracker type not supported by MoveNet");n.trackerConfig!=null?n.trackerConfig=(e=n.trackerConfig,mz(pz,e)):n.trackerConfig=pz}return n}function mz(t,e){var n={maxTracks:t.maxTracks,maxAge:t.maxAge,minSimilarity:t.minSimilarity};return e.maxTracks!=null&&(n.maxTracks=e.maxTracks),e.maxAge!=null&&(n.maxAge=e.maxAge),e.minSimilarity!=null&&(n.minSimilarity=e.minSimilarity),n}var yCe=function(){function t(e,n){this.moveNetModel=e,this.modelInputResolution={height:0,width:0},this.keypointIndexByName=pCe(ka.MoveNet),n.modelType==="SinglePose.Lightning"?(this.modelInputResolution.width=192,this.modelInputResolution.height=192):n.modelType==="SinglePose.Thunder"&&(this.modelInputResolution.width=256,this.modelInputResolution.height=256),this.multiPoseModel=n.modelType==="MultiPose.Lightning",this.multiPoseModel||(this.keypointFilter=new dI(fz),this.cropRegionFilterYMin=new ac(.9),this.cropRegionFilterXMin=new ac(.9),this.cropRegionFilterYMax=new ac(.9),this.cropRegionFilterXMax=new ac(.9)),this.enableSmoothing=n.enableSmoothing,n.minPoseScore?this.minPoseScore=n.minPoseScore:this.minPoseScore=.25,n.multiPoseMaxDimension?this.multiPoseMaxDimension=n.multiPoseMaxDimension:this.multiPoseMaxDimension=256,this.enableTracking=n.enableTracking,this.multiPoseModel&&this.enableTracking&&(n.trackerType===sd.Keypoint?this.tracker=new fCe(n.trackerConfig):n.trackerType===sd.BoundingBox&&(this.tracker=new hCe(n.trackerConfig)),this.enableSmoothing&&(this.keypointFilterMap=new Map))}return t.prototype.runSinglePersonPoseModel=function(e){return On(this,void 0,void 0,function(){var n,s,r,i,o;return Pn(this,function(a){switch(a.label){case 0:if((n=this.moveNetModel.execute(e)).shape.length!==4||n.shape[0]!==1||n.shape[1]!==1||n.shape[2]!==17||n.shape[3]!==3)throw n.dispose(),new Error("Unexpected output shape from model: ["+n.shape+"]");return q2()==="webgpu"?[3,1]:(s=n.dataSync(),[3,3]);case 1:return[4,n.data()];case 2:s=a.sent(),a.label=3;case 3:for(n.dispose(),r={keypoints:[],score:0},i=0,o=0;o<17;++o)r.keypoints[o]={y:s[3*o],x:s[3*o+1],score:s[3*o+2]},r.keypoints[o].score>.2&&(++i,r.score+=r.keypoints[o].score);return i>0&&(r.score/=i),[2,r]}})})},t.prototype.runMultiPersonPoseModel=function(e){return On(this,void 0,void 0,function(){var n,s,r,i,o,a,l,c;return Pn(this,function(u){switch(u.label){case 0:if((n=this.moveNetModel.execute(e)).shape.length!==3||n.shape[0]!==1||n.shape[2]!==56)throw n.dispose(),new Error("Unexpected output shape from model: ["+n.shape+"]");return q2()==="webgpu"?[3,1]:(s=n.dataSync(),[3,3]);case 1:return[4,n.data()];case 2:s=u.sent(),u.label=3;case 3:for(n.dispose(),r=[],i=s.length/56,o=0;o<i;++o)for(r[o]={keypoints:[]},a=56*o+51,r[o].box={yMin:s[a],xMin:s[a+1],yMax:s[a+2],xMax:s[a+3],width:s[a+3]-s[a+1],height:s[a+2]-s[a]},l=56*o+55,r[o].score=s[l],r[o].keypoints=[],c=0;c<17;++c)r[o].keypoints[c]={y:s[56*o+3*c],x:s[56*o+3*c+1],score:s[56*o+3*c+2]};return[2,r]}})})},t.prototype.estimatePoses=function(e,n,s){return n===void 0&&(n=hz),On(this,void 0,void 0,function(){var r,i,o,a,l,c;return Pn(this,function(u){switch(u.label){case 0:return n=function(d){return d==null?hz:ts({},d)}(n),e==null?(this.reset(),[2,[]]):(s==null?mK(e)&&(s=1e6*e.currentTime):s*=1e3,r=qR(e),i=QS(r),o=as(r,0),e instanceof Yt||r.dispose(),a=[],this.multiPoseModel?[3,2]:[4,this.estimateSinglePose(o,i,s)]);case 1:return a=u.sent(),[3,4];case 2:return[4,this.estimateMultiplePoses(o,i,s)];case 3:a=u.sent(),u.label=4;case 4:for(l=0;l<a.length;++l)for(c=0;c<a[l].keypoints.length;++c)a[l].keypoints[c].name=Aa[c],a[l].keypoints[c].y*=i.height,a[l].keypoints[c].x*=i.width;return[2,a]}})})},t.prototype.estimateSinglePose=function(e,n,s){return On(this,void 0,void 0,function(){var r,i,o,a,l=this;return Pn(this,function(c){switch(c.label){case 0:return this.cropRegion||(this.cropRegion=fI(this.cropRegion==null,n)),r=se(function(){var u=cl([[l.cropRegion.yMin,l.cropRegion.xMin,l.cropRegion.yMax,l.cropRegion.xMax]]),d=es([1],"int32"),h=[l.modelInputResolution.height,l.modelInputResolution.width];return Te(ha.cropAndResize(e,u,d,h,"bilinear",0),"int32")}),e.dispose(),[4,this.runSinglePersonPoseModel(r)];case 1:if(i=c.sent(),r.dispose(),i.score<this.minPoseScore)return this.reset(),[2,[]];for(o=0;o<i.keypoints.length;++o)i.keypoints[o].y=this.cropRegion.yMin+i.keypoints[o].y*this.cropRegion.height,i.keypoints[o].x=this.cropRegion.xMin+i.keypoints[o].x*this.cropRegion.width;return s!=null&&this.enableSmoothing&&(i.keypoints=this.keypointFilter.apply(i.keypoints,s,1)),a=mCe(this.cropRegion,i.keypoints,this.keypointIndexByName,n),this.cropRegion=this.filterCropRegion(a),[2,[i]]}})})},t.prototype.estimateMultiplePoses=function(e,n,s){return On(this,void 0,void 0,function(){var r,i,o,a,l,c,u,d,h,f,p,m=this;return Pn(this,function(g){switch(g.label){case 0:return n.width>n.height?(i=this.multiPoseMaxDimension,o=Math.round(this.multiPoseMaxDimension*n.height/n.width),r=ha.resizeBilinear(e,[o,i]),l=i,c=32*Math.ceil(o/32),a=$a(r,[[0,0],[0,c-o],[0,0],[0,0]])):(i=Math.round(this.multiPoseMaxDimension*n.width/n.height),o=this.multiPoseMaxDimension,r=ha.resizeBilinear(e,[o,i]),l=32*Math.ceil(i/32),c=o,a=$a(r,[[0,0],[0,0],[0,l-i],[0,0]])),r.dispose(),e.dispose(),u=Te(a,"int32"),a.dispose(),[4,this.runMultiPersonPoseModel(u)];case 1:for(d=g.sent(),u.dispose(),d=d.filter(function(y){return y.score>=m.minPoseScore}),f=0;f<d.length;++f)for(h=0;h<d[f].keypoints.length;++h)d[f].keypoints[h].y*=c/o,d[f].keypoints[h].x*=l/i;if(this.enableTracking&&(this.tracker.apply(d,s),this.enableSmoothing)){for(f=0;f<d.length;++f)this.keypointFilterMap.has(d[f].id)||this.keypointFilterMap.set(d[f].id,new dI(fz)),d[f].keypoints=this.keypointFilterMap.get(d[f].id).apply(d[f].keypoints,s,1);p=this.tracker.getTrackIDs(),this.keypointFilterMap.forEach(function(y,x){p.has(x)||m.keypointFilterMap.delete(x)})}return[2,d]}})})},t.prototype.filterCropRegion=function(e){if(e){var n=this.cropRegionFilterYMin.apply(e.yMin),s=this.cropRegionFilterXMin.apply(e.xMin),r=this.cropRegionFilterYMax.apply(e.yMax),i=this.cropRegionFilterXMax.apply(e.xMax);return{yMin:n,xMin:s,yMax:r,xMax:i,height:r-n,width:i-s}}return this.cropRegionFilterYMin.reset(),this.cropRegionFilterXMin.reset(),this.cropRegionFilterYMax.reset(),this.cropRegionFilterXMax.reset(),null},t.prototype.dispose=function(){this.moveNetModel.dispose()},t.prototype.reset=function(){this.cropRegion=null,this.resetFilters()},t.prototype.resetFilters=function(){this.keypointFilter.reset(),this.cropRegionFilterYMin.reset(),this.cropRegionFilterXMin.reset(),this.cropRegionFilterYMax.reset(),this.cropRegionFilterXMax.reset()},t}();function xCe(t){return t===void 0&&(t=xK),On(this,void 0,void 0,function(){var e,n,s,r;return Pn(this,function(i){switch(i.label){case 0:return e=gCe(t),s=!0,e.modelUrl?(s=e.modelUrl.indexOf("https://tfhub.dev")>-1,[4,Ff(e.modelUrl,{fromTFHub:s})]):[3,2];case 1:return n=i.sent(),[3,4];case 2:return r=void 0,e.modelType==="SinglePose.Lightning"?r="https://tfhub.dev/google/tfjs-model/movenet/singlepose/lightning/4":e.modelType==="SinglePose.Thunder"?r="https://tfhub.dev/google/tfjs-model/movenet/singlepose/thunder/4":e.modelType==="MultiPose.Lightning"&&(r="https://tfhub.dev/google/tfjs-model/movenet/multipose/lightning/1"),[4,Ff(r,{fromTFHub:s})];case 3:n=i.sent(),i.label=4;case 4:return q2()==="webgl"&&oe().set("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",0),[2,new yCe(n,e)]}})})}var gz={architecture:"MobileNetV1",outputStride:16,multiplier:.75,inputResolution:{height:257,width:257}},yz=["MobileNetV1","ResNet50"],xz={MobileNetV1:[8,16],ResNet50:[16]},vCe=[8,16,32],vz={MobileNetV1:[.5,.75,1],ResNet50:[1]},bz=[1,2,4],bCe={maxPoses:1,flipHorizontal:!1},wCe={maxPoses:5,flipHorizontal:!1,scoreThreshold:.5,nmsRadius:20},SCe=[-123.15,-115.9,-103.06];function nT(t){return Math.floor(t/2)}var kCe=function(){function t(e,n){this.priorityQueue=new Array(e),this.numberOfElements=-1,this.getElementValue=n}return t.prototype.enqueue=function(e){this.priorityQueue[++this.numberOfElements]=e,this.swim(this.numberOfElements)},t.prototype.dequeue=function(){var e=this.priorityQueue[0];return this.exchange(0,this.numberOfElements--),this.sink(0),this.priorityQueue[this.numberOfElements+1]=null,e},t.prototype.empty=function(){return this.numberOfElements===-1},t.prototype.size=function(){return this.numberOfElements+1},t.prototype.all=function(){return this.priorityQueue.slice(0,this.numberOfElements+1)},t.prototype.max=function(){return this.priorityQueue[0]},t.prototype.swim=function(e){for(;e>0&&this.less(nT(e),e);)this.exchange(e,nT(e)),e=nT(e)},t.prototype.sink=function(e){for(;2*e<=this.numberOfElements;){var n=2*e;if(n<this.numberOfElements&&this.less(n,n+1)&&n++,!this.less(e,n))break;this.exchange(e,n),e=n}},t.prototype.getValueAt=function(e){return this.getElementValue(this.priorityQueue[e])},t.prototype.less=function(e,n){return this.getValueAt(e)<this.getValueAt(n)},t.prototype.exchange=function(e,n){var s=this.priorityQueue[e];this.priorityQueue[e]=this.priorityQueue[n],this.priorityQueue[n]=s},t}();function CCe(t,e,n,s,r,i){for(var o=i.shape,a=o[0],l=o[1],c=!0,u=Math.max(n-r,0),d=Math.min(n+r+1,a),h=u;h<d;++h){for(var f=Math.max(s-r,0),p=Math.min(s+r+1,l),m=f;m<p;++m)if(i.get(h,m,t)>e){c=!1;break}if(!c)break}return c}function TCe(t){return On(this,void 0,void 0,function(){return Pn(this,function(e){return[2,Promise.all(t.map(function(n){return n.buffer()}))]})})}function vK(t,e,n,s){return{y:s.get(t,e,n),x:s.get(t,e,n+17)}}function bK(t,e,n){var s=vK(t.heatmapY,t.heatmapX,t.id,n),r=s.y,i=s.x;return{x:t.heatmapX*e+i,y:t.heatmapY*e+r}}function wK(t,e,n,s){var r=n.x,i=n.y;return t.some(function(o){var a,l,c,u,d,h,f=o.keypoints;return a=i,l=r,c=f[s].y,u=f[s].x,(d=c-a)*d+(h=u-l)*h<=e})}var wz=Aa.reduce(function(t,e,n){return t[e]=n,t},{}),SK=[["nose","left_eye"],["left_eye","left_ear"],["nose","right_eye"],["right_eye","right_ear"],["nose","left_shoulder"],["left_shoulder","left_elbow"],["left_elbow","left_wrist"],["left_shoulder","left_hip"],["left_hip","left_knee"],["left_knee","left_ankle"],["nose","right_shoulder"],["right_shoulder","right_elbow"],["right_elbow","right_wrist"],["right_shoulder","right_hip"],["right_hip","right_knee"],["right_knee","right_ankle"]].map(function(t){var e=t[0],n=t[1];return[wz[e],wz[n]]}),sT=SK.map(function(t){return t[1]}),Sz=SK.map(function(t){return t[0]});function kz(t,e,n){return t<e?e:t>n?n:t}function rT(t,e,n,s){return{y:kz(Math.round(t.y/e),0,n-1),x:kz(Math.round(t.x/e),0,s-1)}}function Cz(t,e){return{x:t.x+e.x,y:t.y+e.y}}function Tz(t,e,n,s,r,i,o,a){a===void 0&&(a=2);for(var l=s.shape,c=l[0],u=l[1],d={y:e.y,x:e.x},h=Cz(d,function(x,v,b){var k=b.shape[2]/2;return{y:b.get(v.y,v.x,x),x:b.get(v.y,v.x,k+x)}}(t,rT(d,i,c,u),o)),f=0;f<a;f++){var p=rT(h,i,c,u),m=vK(p.y,p.x,n,r);h=Cz({x:p.x*i,y:p.y*i},{x:m.x,y:m.y})}var g=rT(h,i,c,u),y=s.get(g.y,g.x,n);return{y:h.y,x:h.x,name:Aa[n],score:y}}function NCe(t,e,n,s,r,i){var o=e.shape[2],a=sT.length,l=new Array(o),c=t.part,u=t.score,d=bK(c,s,n);l[c.id]={score:u,name:Aa[c.id],y:d.y,x:d.x};for(var h=a-1;h>=0;--h){var f=sT[h],p=Sz[h];l[f]&&!l[p]&&(l[p]=Tz(h,l[f],p,e,n,s,i))}for(h=0;h<a;++h)f=Sz[h],p=sT[h],l[f]&&!l[p]&&(l[p]=Tz(h,l[f],p,e,n,s,r));return l}function ICe(t,e,n){return n.reduce(function(s,r,i){var o=r.y,a=r.x,l=r.score;return wK(t,e,{y:o,x:a},i)||(s+=l),s},0)/n.length}function _Ce(t,e,n,s,r,i,o,a){return o===void 0&&(o=.5),a===void 0&&(a=20),On(this,void 0,void 0,function(){var l,c,u,d,h,f,p,m,g,y,x,v;return Pn(this,function(b){switch(b.label){case 0:return[4,TCe([t,e,n,s])];case 1:for(l=b.sent(),c=l[0],u=l[1],d=l[2],h=l[3],f=[],p=function(k,C,N){for(var I=N.shape,$=I[0],A=I[1],P=I[2],F=new kCe($*A*P,function(q){return q.score}),V=0;V<$;++V)for(var z=0;z<A;++z)for(var B=0;B<P;++B){var W=N.get(V,z,B);W<k||CCe(B,W,V,z,C,N)&&F.enqueue({score:W,part:{heatmapY:V,heatmapX:z,id:B}})}return F}(o,1,c),m=a*a;f.length<i&&!p.empty();)g=p.dequeue(),y=bK(g.part,r,u),wK(f,m,y,g.part.id)||(x=NCe(g,c,u,r,d,h),v=ICe(f,m,x),f.push({keypoints:x,score:v}));return[2,f]}})})}function ECe(t){var e=t.shape,n=e[0],s=e[1],r=e[2];return se(function(){var i,o,a=Q(t,[n*s,r]),l=Sd(a,0),c=as($e(l,Ge(s,"int32")),1),u=as((i=l,o=s,se(function(){var d=$e(i,Ge(o,"int32"));return Ae(i,Y(d,Ge(o,"int32")))})),1);return Cn([c,u],1)})}function $Ce(t,e,n){return se(function(){var s=function(r,i){for(var o=[],a=0;a<Aa.length;a++){var l=r.get(a,0).valueOf(),c=r.get(a,1).valueOf(),u=ACe(l,c,a,i),d=u.x,h=u.y;o.push(h),o.push(d)}return cl(o,[Aa.length,2])}(t,n);return fe(Te(Y(t.toTensor(),Ge(e,"int32")),"float32"),s)})}function ACe(t,e,n,s){return{y:s.get(t,e,n),x:s.get(t,e,n+Aa.length)}}function RCe(t,e,n){return On(this,void 0,void 0,function(){var s,r,i,o,a,l,c,u,d,h;return Pn(this,function(f){switch(f.label){case 0:return s=0,r=ECe(t),[4,Promise.all([t.buffer(),e.buffer(),r.buffer()])];case 1:return i=f.sent(),o=i[0],a=i[1],l=i[2],[4,(c=$Ce(l,n,a)).buffer()];case 2:return u=f.sent(),d=Array.from(function(p,m){for(var g=m.shape[0],y=new Float32Array(g),x=0;x<g;x++){var v=m.get(x,0),b=m.get(x,1);y[x]=p.get(v,b,x)}return y}(o,l)),h=d.map(function(p,m){return s+=p,{y:u.get(m,0),x:u.get(m,1),score:p,name:Aa[m]}}),r.dispose(),c.dispose(),[2,{keypoints:h,score:s/h.length}]}})})}function Nz(t,e){return(t-1)%e==0}var Iz="https://storage.googleapis.com/tfjs-models/savedmodel/posenet/mobilenet/",_z="https://storage.googleapis.com/tfjs-models/savedmodel/posenet/resnet50/";function Ez(t,e){return function(n,s){return(n-1)%s==0}(t,e)?t:Math.floor(t/e)*e+1}var $z=function(){function t(e,n){this.posenetModel=e;var s=this.posenetModel.inputs[0].shape;O(s[1]===-1&&s[2]===-1,function(){return"Input shape ["+s[1]+", "+s[2]+"] must both be equal to or -1"});var r,i,o=(r=n.inputResolution,i=n.outputStride,{height:Ez(r.height,i),width:Ez(r.width,i)});(function(a){O(vCe.indexOf(a)>=0,function(){return"outputStride of "+a+" is invalid. It must be either 8 or 16."})})(n.outputStride),function(a,l){O(Nz(a.height,l),function(){return"height of "+a.height+" is invalid for output stride "+l+"."}),O(Nz(a.width,l),function(){return"width of "+a.width+" is invalid for output stride "+l+"."})}(o,n.outputStride),this.inputResolution=o,this.outputStride=n.outputStride,this.architecture=n.architecture}return t.prototype.estimatePoses=function(e,n){return n===void 0&&(n=bCe),On(this,void 0,void 0,function(){var s,r,i,o,a,l,c,u,d,h,f,p,m,g,y;return Pn(this,function(x){switch(x.label){case 0:return s=function(v){var b=v;if(b.maxPoses==null&&(b.maxPoses=1),b.maxPoses<=0)throw new Error("Invalid maxPoses "+b.maxPoses+". Should be > 0.");if(b.maxPoses>1){if((b=ts({},wCe,b)).scoreThreshold<0||b.scoreThreshold>1)throw new Error("Invalid scoreThreshold "+b.scoreThreshold+". Should be in range [0.0, 1.0]");if(b.nmsRadius<=0)throw new Error("Invalid nmsRadius "+b.nmsRadius+".")}return b}(n),e==null?[2,[]]:(this.maxPoses=s.maxPoses,r=uI(e,{inputResolution:this.inputResolution,keepAspectRatio:!0}),i=r.imageTensor,o=r.padding,a=this.architecture==="ResNet50"?fe(i,SCe):hI(i,[-1,1]),l=this.posenetModel.predict(a),this.architecture==="ResNet50"?(c=Bt(l[2],[0]),u=Bt(l[3],[0]),d=Bt(l[0],[0]),h=Bt(l[1],[0])):(c=Bt(l[0],[0]),u=Bt(l[1],[0]),d=Bt(l[2],[0]),h=Bt(l[3],[0])),f=bi(u),this.maxPoses!==1?[3,2]:[4,RCe(f,c,this.outputStride)]);case 1:return m=x.sent(),p=[m],[3,4];case 2:return[4,_Ce(f,c,d,h,this.outputStride,this.maxPoses,s.scoreThreshold,s.nmsRadius)];case 3:p=x.sent(),x.label=4;case 4:return g=QS(e),y=function(v,b,k,C){var N=b.height,I=b.width,$=N/(k.height*(1-C.top-C.bottom)),A=I/(k.width*(1-C.left-C.right)),P=-C.top*k.height,F=-C.left*k.width;if(A===1&&$===1&&P===0&&F===0)return v;for(var V=0,z=v;V<z.length;V++)for(var B=0,W=z[V].keypoints;B<W.length;B++){var q=W[B];q.x=(q.x+F)*A,q.y=(q.y+P)*$}return v}(p,g,this.inputResolution,o),s.flipHorizontal&&(y=function(v,b){for(var k=0,C=v;k<C.length;k++)for(var N=0,I=C[k].keypoints;N<I.length;N++){var $=I[N];$.x=b.width-1-$.x}return v}(y,g)),i.dispose(),a.dispose(),rt(l),c.dispose(),u.dispose(),d.dispose(),h.dispose(),f.dispose(),[2,y]}})})},t.prototype.dispose=function(){this.posenetModel.dispose()},t.prototype.reset=function(){},t}();function DCe(t){return t===void 0&&(t=gz),On(this,void 0,void 0,function(){var e,n,s,r,i;return Pn(this,function(o){switch(o.label){case 0:return(e=function(u){var d=u||gz;if(d.architecture==null&&(d.architecture="MobileNetV1"),yz.indexOf(d.architecture)<0)throw new Error("Invalid architecture "+d.architecture+". Should be one of "+yz);if(d.inputResolution==null&&(d.inputResolution={height:257,width:257}),d.outputStride==null&&(d.outputStride=16),xz[d.architecture].indexOf(d.outputStride)<0)throw new Error("Invalid outputStride "+d.outputStride+". Should be one of "+xz[d.architecture]+" for architecture "+d.architecture+".");if(d.multiplier==null&&(d.multiplier=1),vz[d.architecture].indexOf(d.multiplier)<0)throw new Error("Invalid multiplier "+d.multiplier+". Should be one of "+vz[d.architecture]+" for architecture "+d.architecture+".");if(d.quantBytes==null&&(d.quantBytes=4),bz.indexOf(d.quantBytes)<0)throw new Error("Invalid quantBytes "+d.quantBytes+". Should be one of "+bz+" for architecture "+d.architecture+".");if(d.architecture==="MobileNetV1"&&d.outputStride===32&&d.multiplier!==1)throw new Error("When using an output stride of 32, you must select 1 as the multiplier.");return d}(t)).architecture!=="ResNet50"?[3,2]:(a=e.outputStride,l=e.quantBytes,c="model-stride"+a+".json",n=l===4?_z+"float/"+c:_z+"quant"+l+"/"+c,[4,Ff(e.modelUrl||n)]);case 1:return s=o.sent(),[2,new $z(s,e)];case 2:return r=function(u,d,h){var f={1:"100",.75:"075",.5:"050"},p="model-stride"+u+".json";return h===4?Iz+"float/"+f[d]+"/"+p:Iz+"quant"+h+"/"+f[d]+"/"+p}(e.outputStride,e.multiplier,e.quantBytes),[4,Ff(e.modelUrl||r)];case 3:return i=o.sent(),[2,new $z(i,e)]}var a,l,c})})}function OCe(t,e){return On(this,void 0,void 0,function(){var n,s;return Pn(this,function(r){switch(t){case ka.PoseNet:return[2,DCe(e)];case ka.BlazePose:if(s=void 0,(n=e)!=null){if(n.runtime==="tfjs")return[2,dCe(e)];if(n.runtime==="mediapipe")return[2,Bke(e)];s=n.runtime}throw new Error("Expect modelConfig.runtime to be either 'tfjs' or 'mediapipe', but got "+s);case ka.MoveNet:return[2,xCe(e)];default:throw new Error(t+" is not a supported model name.")}})})}var PCe={modelType:{SINGLEPOSE_LIGHTNING:"SinglePose.Lightning",SINGLEPOSE_THUNDER:"SinglePose.Thunder",MULTIPOSE_LIGHTNING:"MultiPose.Lightning"}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kK={kernelName:k1,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Y(t,cp(Te(n,"float32"),-1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FCe={kernelName:by,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const s=Zt(Te(n,"float32")),r=Ys(Ae(Ge(1),s));return vn($e(t,r))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LCe={kernelName:wy,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const s=Ys(Ae(Zt(Te(n,"float32")),1));return $e(t,s)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MCe={kernelName:ip,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=ct(n.shape,s.shape);return{a:()=>{let a=t;const l=ps(n.shape,r);return l.length>0&&(a=Be(a,l)),Q(a,n.shape)},b:()=>{let a=t;const l=ps(s.shape,r);return l.length>0&&(a=Be(a,l)),Q(a,s.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zCe={kernelName:C1,saveAllInputs:!0,gradFunc:(t,e)=>{const n={};return e.forEach((s,r)=>{n[r]=()=>t.clone()}),n}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VCe={kernelName:T1,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>_t(n)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jCe={kernelName:N1,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>_t(n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BCe={kernelName:Sy,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>$e(t,Ys(Ae(Ge(1),Zt(Te(n,"float32")))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WCe={kernelName:ky,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const s=Ys(fe(Ge(1),Zt(Te(n,"float32"))));return $e(t,s)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UCe={kernelName:Ny,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=ct(n.shape,s.shape);return{a:()=>{const a=fe(Zt(n),Zt(s));let l=Y(t,$e(s,a));const c=ps(n.shape,r);return c.length>0&&(l=Be(l,c)),Q(l,n.shape)},b:()=>{const a=fe(Zt(n),Zt(s));let l=vn(Y(t,$e(n,a)));const c=ps(s.shape,r);return c.length>0&&(l=Be(l,c)),Q(l,s.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HCe={kernelName:Cy,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>$e(t,fe(Zt(Te(n,"float32")),1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GCe={kernelName:Ty,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>$e(t,Ae(Ge(1),Zt(Te(n,"float32"))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KCe(t,e,n,s,r,i){const o=L(t,"dy","avgPool3dGrad"),a=L(e,"input","avgPool3dGrad");let l=o,c=a,u=!1;a.rank===4&&(u=!0,l=Q(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]]),c=Q(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),O(l.rank===5,()=>`Error in avgPool3dGrad: dy must be rank 5 but got rank ${l.rank}.`),O(c.rank===5,()=>`Error in avgPool3dGrad: input must be rank 5 but got rank ${c.rank}.`),cr("avgPool3dGrad",r,i);const d={dy:l,input:c},h={filterSize:n,strides:s,pad:r,dimRoundingMode:i},f=Z.runKernel(w$,d,h);return u?Q(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}const qCe=X({avgPool3dGrad_:KCe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XCe={kernelName:_1,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{filterSize:r,strides:i,pad:o,dimRoundingMode:a}=n;return{x:()=>qCe(t,s,r,i,o,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YCe(t,e,n,s,r){const i=L(t,"dy","avgPoolGrad"),o=L(e,"input","avgPoolGrad");O(o.rank===i.rank,()=>`Rank of input (${o.rank}) does not match rank of dy (${i.rank})`);let a=o,l=i,c=!1;o.rank===3&&(c=!0,a=Q(o,[1,o.shape[0],o.shape[1],o.shape[2]]),l=Q(i,[1,i.shape[0],i.shape[1],i.shape[2]])),O(l.rank===4,()=>`Error in avgPoolGrad: dy must be rank 4 but got rank ${l.rank}.`),O(a.rank===4,()=>`Error in avgPoolGrad: input must be rank 4 but got rank ${a.rank}.`);const u={dy:l,input:a},d={filterSize:n,strides:s,pad:r},h=Z.runKernel(b$,u,d);return c?Q(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const ZCe=X({avgPoolGrad_:YCe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QCe={kernelName:I1,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{filterSize:r,strides:i,pad:o}=n;return{x:()=>ZCe(t,s,r,i,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JCe={kernelName:E1,inputsToSave:["a","b"],gradFunc:(t,e,n)=>{const[s,r]=e,{transposeA:i,transposeB:o}=n;return!i&&!o?{a:()=>Ct(t,r,!1,!0),b:()=>Ct(s,t,!0,!1)}:!i&&o?{a:()=>Ct(t,r,!1,!1),b:()=>Ct(t,s,!0,!1)}:i&&!o?{a:()=>Ct(r,t,!1,!0),b:()=>Ct(s,t,!1,!1)}:{a:()=>Ct(r,t,!0,!0),b:()=>Ct(t,s,!0,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eTe={kernelName:$1,gradFunc:(t,e,n)=>{const{blockShape:s,crops:r}=n;return{x:()=>FS(t,s,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tTe={kernelName:Nge,gradFunc:(t,e,n)=>{const s=n,r=s.inputShape,i=s.shape,o=Array.from(i);for(let l=r.length-1;l>=0;l--)if(r[l]===i[l])o[l]=1;else if(r[l]!==1)throw new Error(`broadcastTo(): [${r}] cannot be broadcast to [${i}].`);const a=[];for(let l=0;l<o.length;l++)o[l]>1&&a.push(l);return{x:()=>Be(t,a,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nTe={kernelName:Iy,gradFunc:t=>({x:()=>t.clone()})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sTe={kernelName:_y,gradFunc:t=>({x:()=>_t(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rTe={kernelName:Ey,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{clipValueMin:r,clipValueMax:i}=n;return{x:()=>Nr(Ea(Md(s,r),zd(s,i)),t,_t(t))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iTe={kernelName:A1,inputsToSave:["x"],gradFunc:kK.gradFunc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oTe={kernelName:R1,saveAllInputs:!0,gradFunc:(t,e,n)=>{const s=e.map(l=>l.shape),{axis:r}=n,i=bt(r,e[0].shape)[0],o=s.map(l=>l[i]);return Yr(t,o,i).map(l=>()=>l)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aTe={kernelName:D1,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const[s,r]=e,{dilations:i,strides:o,pad:a,dataFormat:l}=n;return O(Vc(i),()=>`Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${i}'`),{x:()=>MA(s.shape,t,r,o,a,l),filter:()=>yR(s,t,r.shape,o,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lTe={kernelName:O1,inputsToSave:["dy","filter"],gradFunc:(t,e,n)=>{const[s,r]=e,{strides:i,pad:o,dataFormat:a,dimRoundingMode:l}=n;return{dy:()=>jc(t,r,i,o,a,1,l),filter:()=>yR(t,s,r.shape,i,o,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cTe(t,e,n,s,r){let i=t;t.rank===4&&(i=Q(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]));let o=e;o.rank===4&&(o=Q(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]])),O(i.rank===5,()=>`Error in conv3dDerFilter: input must be rank 5, but got shape ${i.shape}.`),O(o.rank===5,()=>`Error in conv3dDerFilter: dy must be rank 5, but got shape ${o.shape}.`),O(n.length===5,()=>`Error in conv3dDerFilter: filterShape must be length 5, but got ${n}.`),O(i.shape[4]===n[3],()=>`Error in conv3dDerFilter: depth of input ${i.shape[4]}) must match input depth in filter (${n[3]}.`),O(o.shape[4]===n[4],()=>`Error in conv3dDerFilter: depth of dy (${o.shape[4]}) must match output depth for filter (${n[4]}).`);const a={x:i,dy:o},l={strides:s,pad:r,filterShape:n};return Z.runKernel(N$,a,l)}const uTe=X({conv3DBackpropFilter_:cTe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dTe={kernelName:P1,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const{dilations:s,strides:r,pad:i}=n;O(Vc(s),()=>`Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${s}'`);const[o,a]=e;return{x:()=>YG(o.shape,t,a,r,i),filter:()=>uTe(o,t,a.shape,r,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hTe={kernelName:$y,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Y(vn(lR(Te(n,"float32"))),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fTe={kernelName:Ay,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Y(cR(Te(n,"float32")),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pTe={kernelName:F1,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{axis:r,exclusive:i,reverse:o}=n;return{x:()=>{const a=In([r],s.rank);let l=jA(t,r,i,!o);return a!=null&&(l=Nt(l,a)),l}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mTe={kernelName:L1,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const{dilations:s,strides:r,pad:i,dimRoundingMode:o}=n,a=s??[1,1];O(Vc(a),()=>`Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations '${a}'`);const[l,c]=e;return O(l.rank===4,()=>`Error in gradient of depthwiseConv2dNative: input must be rank 4, but got rank ${l.rank}.`),O(c.rank===4,()=>`Error in gradient of depthwiseConv2dNative: filter must be rank 4, but got rank ${c.rank}.`),O(l.shape[3]===c.shape[2],()=>`Error in gradient of depthwiseConv2d: number of input channels (${l.shape[3]}) must match the inChannels dimension in filter ${c.shape[2]}.`),O(Ms(r,a),()=>`Error in gradient of depthwiseConv2d: Either strides or dilations must be  1. Got strides ${r} and dilations '${a}'.`),cr("depthwiseConv2d",i,o),{x:()=>A8(l.shape,t,c,r,i,a,o),filter:()=>$8(l,t,c.shape,r,i,a,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gTe={kernelName:M1,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const[s,r]=e,i={x:s,filter:r,dy:t},o={x:s,filter:r,dy:t};return{x:()=>Z.runKernel($2,i,n),filter:()=>Z.runKernel(A2,o,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yTe={kernelName:Dy,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e,s={dy:t,y:n};return{x:()=>Z.runKernel(F$,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xTe={kernelName:Oy,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e,s=Y(Ir(vn(Zt(n))),2/Math.sqrt(Math.PI));return{x:()=>Y(t,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vTe={kernelName:Py,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Y(t,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bTe={kernelName:V1,inputsToSave:["input"],gradFunc:(t,e)=>{const[n]=e;return{input:()=>Q(t,n.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wTe={kernelName:Fy,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Y(t,Ir(n))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const STe={kernelName:Ly,gradFunc:t=>({x:()=>_t(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kTe={kernelName:My,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=ct(n.shape,s.shape);return{a:()=>{const a=$e(t,Te(s,"float32")),l=ps(n.shape,r);return l.length>0?Q(Be(a,l),n.shape):a},b:()=>{let a=Y(t,Te(n,"float32"));const l=ps(s.shape,r);l.length>0&&(a=Q(Be(a,l),s.shape));const c=Zt(s);return vn($e(a,Te(c,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CTe={kernelName:j1,inputsToSave:["x","mean","variance","scale"],gradFunc:(t,e,n)=>{const{varianceEpsilon:s}=n,[r,i,o,a]=e,l=a??Ge(1),c=ps(i.shape,r.shape),u=[];if(i.rank===1){for(let b=0;b<r.shape.length-1;++b)u.push(r.shape[b]);u.push(1)}const d=Ae(r,i),h=Y(t,l),f=iR(fe(o,Ge(s))),p=Y(Y(Y(f,f),f),Ge(-.5));return{x:()=>i.rank===1?Q(Y(Y(t,Ji(Q(f,[1,1,1,i.shape[0]]),u)),l),r.shape):Q(Y(Y(t,f),l),r.shape),mean:()=>{let b=Y(Y(f,Ge(-1)),h);return i.rank===1&&(b=Be(b,c)),Q(b,i.shape)},variance:()=>{let b=Y(Y(p,d),h);return i.rank===1&&(b=Be(b,c)),Q(b,i.shape)},scale:()=>{const b=Y(d,f);let k=Y(t,b);return i.rank===1&&(k=Be(k,c)),Q(k,i.shape)},offset:()=>{let b=t;return i.rank===1&&(b=Be(b,c)),Q(b,i.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TTe={kernelName:B1,inputsToSave:["x","indices"],gradFunc:(t,e,n)=>{const[s,r]=e,{axis:i}=n,o=bt(i,s.shape)[0];return{x:()=>{const l=s.shape,c=r.size,u=l.slice(0,o),d=u.length,h=l.slice(i,l.length).slice(1),f=h.length,p=Az(0,d),m=Az(d+1,d+1+f),g=Rz([u,[c],h]),y=Q(t,g),x=Q(r,[c]),v=Rz([[d],p,m]),b=Nt(y,v);let k=pR(b,x,s.shape[o]);const C=iu(v);return k=Nt(k,C),k},indices:()=>r}}};function Az(t,e){const n=[];for(let s=t;s<e;++s)n.push(s);return n}function Rz(t){const e=[];for(let n=0;n<t.length;++n)for(let s=0;s<t[n].length;++s)e.push(t[n][s]);return e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NTe={kernelName:zy,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e;return{a:()=>_t(n),b:()=>_t(s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ITe={kernelName:Vy,gradFunc:t=>({x:()=>Te(t,"float32")})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _Te={kernelName:jy,gradFunc:t=>({x:()=>_t(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ETe={kernelName:By,gradFunc:t=>({x:()=>_t(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $Te={kernelName:Wy,gradFunc:t=>({x:()=>_t(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ATe={kernelName:U1,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{alpha:r}=n,i=Ei(s,0);return{x:()=>Nr(i,t,Y(t,r))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RTe={kernelName:Hy,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>$e(t,fe(n,1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DTe={kernelName:Uy,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>$e(t,Te(n,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OTe={kernelName:Ige,inputsToSave:[],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[s]=e,{axis:r}=n;return{logits:()=>{const o=Ir(s);return Ae(t,Y(Be(t,r,!0),o))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PTe(t,e,n,s=5,r=1,i=1,o=.5){const a={x:t,y:e,dy:n},l={depthRadius:s,bias:r,alpha:i,beta:o};return Z.runKernel(U$,a,l)}const FTe=X({localResponseNormalizationBackprop_:PTe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LTe={kernelName:Y1,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[s,r]=e,{depthRadius:i,bias:o,alpha:a,beta:l}=n;return{x:()=>FTe(s,r,t,i,o,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CK(t,e,n,s){return e.rank<n.rank&&(e=Q(e,Hn(e.shape,s))),t.rank<n.rank&&(t=Q(t,Hn(t.shape,s))),{x:()=>Y(t,Te(Mo(n,e),t.dtype))}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dz={kernelName:Z1,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const s=n,{reductionIndices:r}=s,i=e[0],o=e[1],a=bt(r,i.shape),l=CK(t,o,i,a);return{x:()=>l.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MTe={kernelName:Gy,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e;return{a:()=>Y(t,Te(Md(n,s),"float32")),b:()=>Y(t,Te(UA(n,s),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zTe(t,e,n,s,r,i,o){const a=L(t,"dy","maxPool3dGrad"),l=L(e,"input","maxPool3dGrad"),c=L(n,"output","maxPool3dGrad");let u=a,d=l,h=c,f=!1;l.rank===4&&(f=!0,u=Q(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]]),d=Q(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]]),h=Q(c,[1,c.shape[0],c.shape[1],c.shape[2],c.shape[3]])),O(u.rank===5,()=>`Error in maxPool3dGrad: dy must be rank 5 but got rank ${u.rank}.`),O(d.rank===5,()=>`Error in maxPool3dGrad: input must be rank 5 but got rank ${d.rank}.`),O(h.rank===5,()=>`Error in maxPool3dGrad: output must be rank 5 but got rank ${h.rank}.`),cr("maxPool3dGrad",i,o);const p={dy:u,input:d,output:h},m={filterSize:s,strides:r,pad:i,dimRoundingMode:o},g=Z.runKernel(G$,p,m);return f?Q(g,[g.shape[1],g.shape[2],g.shape[3],g.shape[4]]):g}const VTe=X({maxPool3dGrad_:zTe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jTe={kernelName:J1,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[s,r]=e,{filterSize:i,strides:o,pad:a,dimRoundingMode:l}=n;return{x:()=>VTe(t,s,r,i,o,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BTe(t,e,n,s,r,i,o){const a=L(t,"dy","maxPoolGrad"),l=L(e,"input","maxPoolGrad"),c=L(n,"output","maxPoolGrad");O(l.rank===a.rank,()=>`Rank of input (${l.rank}) does not match rank of dy (${a.rank})`),O(a.rank===4,()=>`Error in maxPoolGrad: dy must be rank 4 but got rank ${a.rank}.`),O(l.rank===4,()=>`Error in maxPoolGrad: input must be rank 4 but got rank ${l.rank}.`),cr("maxPoolGrad",i,o);const u={dy:a,input:l,output:c},d={filterSize:s,strides:r,pad:i,dimRoundingMode:o};return Z.runKernel(H$,u,d)}const WTe=X({maxPoolGrad_:BTe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UTe={kernelName:Q1,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[s,r]=e,{filterSize:i,strides:o,pad:a}=n;return{x:()=>WTe(t,s,r,i,o,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HTe={kernelName:eS,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{axis:r}=n,i=bt(r,s.shape),a=Ns(s.shape,i)[1],l=le(a);return{x:()=>{const u=s.shape.slice();i.forEach(f=>{u[f]=1});const d=Q(t,u);return $e(Y(d,gi(s.shape,"float32")),l)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GTe={kernelName:tS,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const s=n,{axis:r}=s,[i,o]=e,a=bt(r,i.shape),l=CK(t,o,i,a);return{x:()=>l.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KTe={kernelName:Ky,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e;return{a:()=>Y(t,Te(zd(n,s),"float32")),b:()=>Y(t,Te(Ei(n,s),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qTe={kernelName:nS,inputsToSave:["x"],gradFunc:(t,e,n)=>{const s=e[0],{paddings:r}=n,i=r.map(o=>o[0]);return{x:()=>st(t,i,s.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XTe={kernelName:qy,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=ct(n.shape,s.shape);return{a:()=>{const a=ps(n.shape,r);return a.length>0?Q(Be(t,a),n.shape):t},b:()=>{const a=Y(t,vn(w0($e(n,s)))),l=ps(s.shape,r);return l.length>0?Q(Be(a,l),s.shape):a}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YTe={kernelName:Xy,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=ct(n.shape,s.shape);return{a:()=>{const a=Y(t,Te(s,"float32")),l=ps(n.shape,r);return l.length>0?Q(Be(a,l),n.shape):a},b:()=>{const a=Y(t,Te(n,"float32")),l=ps(s.shape,r);return l.length>0?Q(Be(a,l),s.shape):a}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZTe={kernelName:sS,gradFunc:t=>({x:()=>vn(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QTe={kernelName:oS,inputsToSave:["indices"],gradFunc:(t,e)=>{const n=e[0];return{indices:()=>es(n.shape,"float32")}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JTe={kernelName:iS,gradFunc:t=>({x:()=>_t(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eNe={kernelName:aS,saveAllInputs:!0,gradFunc:(t,e,n)=>{const{axis:s}=n;return zo(t,s).map(i=>()=>i)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Oz={kernelName:lS,inputsToSave:["x"],gradFunc:(t,e,n)=>{const s=e[0],{paddings:r}=n,i=r.map(o=>o[0]);return{x:()=>st(t,i,s.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tNe={kernelName:Yy,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:(t,e)=>{const[n,s,r]=e,i=n,o=s,a=ct(i.shape,o.shape);return{a:()=>{const u=Te(o,"float32");let d=Y(t,Y(u,Bc(i,Ae(u,Ge(1)))));const h=ps(i.shape,a);return h.length>0&&(d=Be(d,h)),Q(d,i.shape)},b:()=>{const u=Ei(i,0),d=Nr(u,Ti(i),_t(i));let h=Y(t,Y(r,d));const f=ps(o.shape,a);return f.length>0&&(h=Be(h,f)),Q(h,o.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nNe={kernelName:cS,inputsToSave:["x","alpha"],gradFunc:(t,e)=>{const[n,s]=e,r=Ei(n,0);return{x:()=>Nr(r,t,Y(t,s)),alpha:()=>{let i=Nr(r,_t(t),Y(t,n));const o=ps(s.shape,t.shape);return o.length>0&&(i=Be(i,o)),Q(i,s.shape)}}}};/**
 * @license
 * Copyright 2022 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sNe(t,e,n){const s=t.shape.slice();s[n]=1;const r=Q(e,s),i=sw(t,n,!0,!1),o=sw(t,n,!0,!0),a=Y(i,o);return Y(r,a)}function rNe(t,e,n){const s=t.shape.length,r=s-n.length,i=In(n,s);let o=t;i!=null&&(o=Nt(t,i));const a=o.shape.slice(),c=a.splice(s-n.length,n.length).reduce((h,f)=>h*f,1);a.push(c);const u=o.reshape(a);let d=sNe(u,e,r);if(d=d.reshape(o.shape),i!=null){const h=iu(i);d=Nt(d,h)}return d}const iNe={kernelName:uS,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{axis:r}=n;let i=[];return r==null?i=s.shape.map((o,a)=>a):typeof r=="number"?i=[r]:i=r,{x:()=>rNe(s,t,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oNe={kernelName:Ry,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=ct(n.shape,s.shape);return{a:()=>{const a=$e(t,Te(s,"float32")),l=ps(n.shape,r);return l.length>0?Q(Be(a,l),n.shape):a},b:()=>{let a=Y(t,Te(n,"float32"));const l=ps(s.shape,r);l.length>0&&(a=Q(Be(a,l),s.shape));const c=Zt(s);return vn($e(a,Te(c,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aNe={kernelName:Zy,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>$e(t,vn(Zt(n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lNe={kernelName:Jy,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e,s=Y(zd(n,6),cp(n));return{x:()=>Y(t,Te(s,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cNe={kernelName:Qy,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Y(t,Te(cp(n),"float32"))}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uNe={kernelName:dS,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Q(t,n.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dNe={kernelName:fS,inputsToSave:["images"],gradFunc:(t,e,n)=>{const[s]=e,r={dy:t,images:s};return{images:()=>Z.runKernel(sA,r,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hNe={kernelName:hS,inputsToSave:["images"],gradFunc:(t,e,n)=>{const[s]=e,r={dy:t,images:s};return{images:()=>Z.runKernel(nA,r,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fNe={kernelName:pS,gradFunc:(t,e,n)=>{const{dims:s}=n,r=bt(s,t.shape);return{x:()=>ao(t,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pNe={kernelName:e0,gradFunc:t=>({x:()=>_t(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mNe={kernelName:t0,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>vn($e(t,Y(Bc(n,1.5),2)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gNe={kernelName:mS,inputsToSave:["condition"],gradFunc:(t,e)=>{const[n]=e;return{condition:()=>Te(_t(n),"float32"),t:()=>Y(t,Te(n,t.dtype)),e:()=>Y(t,Te(DS(n),t.dtype))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yNe={kernelName:n0,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const s=Ei(n,Ge(0)),r=Ge(YS),i=Ge(ZS),o=Y(t,i),a=Y(Y(t,r),Ir(Te(n,"float32")));return Nr(s,o,a)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xNe={kernelName:o0,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Y(t,Y(n,Ae(Ge(1),n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vNe={kernelName:i0,gradFunc:t=>({x:()=>_t(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bNe={kernelName:s0,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Y($S(Te(n,"float32")),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wNe={kernelName:r0,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Y(VA(Te(n,"float32")),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SNe={kernelName:gS,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{begin:r,size:i}=n,o=s.shape,[a,l]=IS(s,r,i),c=[];for(let u=0;u<t.rank;u++)c.push([a[u],o[u]-a[u]-l[u]]);return{x:()=>$a(t,c)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kNe={kernelName:bS,outputsToSave:[!0],gradFunc:(t,e,n)=>{const[s]=e,{dim:r}=n,i=!0,o=Y(t,s);return{logits:()=>Ae(o,Y(Be(o,[r],i),s))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CNe={kernelName:a0,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Y(t,bi(n))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pz={kernelName:xS,gradFunc:(t,e,n)=>{const{blockShape:s,paddings:r}=n;return{x:()=>ES(t,s,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fz={kernelName:vS,gradFunc:(t,e,n)=>{const{axis:s}=n;return{x:()=>Cn(t,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TNe={kernelName:l0,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>$e(t,Y(Ys(Te(n,"float32")),2))}}};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NNe={kernelName:dA,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Y(t,Y(Te(n,"float32"),2))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const INe={kernelName:c0,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=Ge(2);return{a:()=>Y(t,Y(r,Ae(n,s))),b:()=>Y(t,Y(r,Ae(s,n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _Ne={kernelName:p0,gradFunc:t=>({x:()=>_t(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ENe={kernelName:u0,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=ct(n.shape,s.shape);return{a:()=>{let a=t;const l=ps(n.shape,r);return l.length>0&&(a=Be(a,l)),Q(a,n.shape)},b:()=>{let a=t;const l=ps(s.shape,r);return l.length>0&&(a=Be(a,l)),Q(vn(a),s.shape)}}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $Ne={kernelName:yS,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,r=s.shape.slice(),{axis:i}=n;bt(i,s.shape).forEach(c=>{r[c]=1});const a=Q(t,r),l=Y(a,gi(s.shape,"float32"));return{x:()=>l}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ANe={kernelName:d0,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>$e(t,Zt($S(n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RNe={kernelName:h0,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Y(Ae(Ge(1),Zt(n)),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DNe={kernelName:f0,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{reps:r}=n;return{x:()=>{let o=_t(s);if(s.rank===1)for(let a=0;a<r[0];++a)o=fe(o,st(t,[a*s.shape[0]],[s.shape[0]]));else if(s.rank===2)for(let a=0;a<r[0];++a)for(let l=0;l<r[1];++l)o=fe(o,st(t,[a*s.shape[0],l*s.shape[1]],[s.shape[0],s.shape[1]]));else if(s.rank===3)for(let a=0;a<r[0];++a)for(let l=0;l<r[1];++l)for(let c=0;c<r[2];++c)o=fe(o,st(t,[a*s.shape[0],l*s.shape[1],c*s.shape[2]],[s.shape[0],s.shape[1],s.shape[2]]));else if(s.rank===4)for(let a=0;a<r[0];++a)for(let l=0;l<r[1];++l)for(let c=0;c<r[2];++c)for(let u=0;u<r[3];++u)o=fe(o,st(t,[a*s.shape[0],l*s.shape[1],c*s.shape[2],u*s.shape[3]],[s.shape[0],s.shape[1],s.shape[2],s.shape[3]]));else throw new Error(`Gradient for tile operation is not implemented for rank-${s.rank} tensors yet.`);return o}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ONe={kernelName:Uh,gradFunc:(t,e,n)=>{const s=n,{perm:r}=s,i=iu(r);return{x:()=>Nt(t,i)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PNe={kernelName:wS,gradFunc:(t,e,n)=>{const s=n,{axis:r}=s;return{value:()=>lo(t,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FNe={kernelName:SS,inputsToSave:["segmentIds"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>LNe(t,n)}}};function LNe(t,e){const n=Oa(e,_t(e)),s=Tc(t,n);let r=Md(e,Ge(0,"int32"));const i=s.rank-r.rank;for(let a=0;a<i;++a)r=as(r,a+1);r=Ea(r,gi(s.shape,"bool"));const o=_t(s);return Nr(r,s,o)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MNe={kernelName:kS,gradFunc:t=>({x:()=>_t(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zNe=[kK,FCe,LCe,MCe,zCe,VCe,jCe,BCe,WCe,UCe,HCe,GCe,XCe,QCe,JCe,eTe,tTe,nTe,sTe,rTe,iTe,oTe,lTe,aTe,dTe,hTe,fTe,pTe,mTe,gTe,oNe,yTe,xTe,vTe,bTe,wTe,kTe,STe,CTe,TTe,NTe,ITe,_Te,ETe,$Te,ATe,RTe,DTe,OTe,LTe,Dz,Dz,MTe,jTe,UTe,HTe,GTe,KTe,qTe,XTe,YTe,ZTe,QTe,JTe,eNe,Oz,Oz,tNe,nNe,iNe,aNe,lNe,cNe,uNe,dNe,hNe,fNe,pNe,mNe,gNe,yNe,xNe,vNe,bNe,wNe,SNe,kNe,CNe,Pz,Pz,Fz,Fz,TNe,INe,NNe,_Ne,ENe,$Ne,ANe,RNe,DNe,ONe,PNe,FNe,MNe];for(const t of zNe)Ege(t);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.abs=function(){return this.throwIfDisposed(),os(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.acos=function(){return this.throwIfDisposed(),AG(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.acosh=function(){return this.throwIfDisposed(),RG(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.add=function(t){return this.throwIfDisposed(),fe(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.all=function(t,e){return this.throwIfDisposed(),PA(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.any=function(t,e){return this.throwIfDisposed(),tw(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.argMax=function(t){return this.throwIfDisposed(),Sd(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.argMin=function(t){return this.throwIfDisposed(),DG(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.asScalar=function(){return this.throwIfDisposed(),O(this.size===1,()=>"The array must have only 1 element."),Q(this,[])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.asType=function(t){return this.throwIfDisposed(),Te(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.as1D=function(){return this.throwIfDisposed(),Q(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.as2D=function(t,e){return this.throwIfDisposed(),Q(this,[t,e])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.as3D=function(t,e,n){return this.throwIfDisposed(),Q(this,[t,e,n])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.as4D=function(t,e,n,s){return this.throwIfDisposed(),Q(this,[t,e,n,s])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.as5D=function(t,e,n,s,r){return this.throwIfDisposed(),Q(this,[t,e,n,s,r])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.asin=function(){return this.throwIfDisposed(),OG(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.asinh=function(){return this.throwIfDisposed(),PG(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.atan=function(){return this.throwIfDisposed(),FG(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.atan2=function(t){return this.throwIfDisposed(),LG(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.atanh=function(){return this.throwIfDisposed(),MG(this)};ue().prototype.avgPool=function(t,e,n,s){return this.throwIfDisposed(),_S(this,t,e,n,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.batchToSpaceND=function(t,e){return this.throwIfDisposed(),ES(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.batchNorm=function(t,e,n,s,r){return this.throwIfDisposed(),x0(this,t,e,n,s,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.broadcastTo=function(t){return this.throwIfDisposed(),Cc(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.cast=function(t){return this.throwIfDisposed(),Te(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.ceil=function(){return this.throwIfDisposed(),UG(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.clipByValue=function(t,e){return this.throwIfDisposed(),Tr(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.concat=function(t,e){return this.throwIfDisposed(),t instanceof Yt&&(t=[t]),Cn([this,...t],e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.conv1d=function(t,e,n,s,r,i){return this.throwIfDisposed(),LA(this,t,e,n,s,r,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.conv2dTranspose=function(t,e,n,s,r){return this.throwIfDisposed(),zA(this,t,e,n,s,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.conv2d=function(t,e,n,s,r,i){return this.throwIfDisposed(),jc(this,t,e,n,s,r,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.cos=function(){return this.throwIfDisposed(),$S(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.cosh=function(){return this.throwIfDisposed(),VA(this)};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.cumprod=function(t,e,n){return this.throwIfDisposed(),sw(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.cumsum=function(t,e,n){return this.throwIfDisposed(),jA(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.depthToSpace=function(t,e){return this.throwIfDisposed(),QG(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.depthwiseConv2d=function(t,e,n,s,r,i){return this.throwIfDisposed(),v0(this,t,e,n,s,r,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.dilation2d=function(t,e,n,s,r){return this.throwIfDisposed(),JG(this,t,e,n,s,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.divNoNan=function(t){return this.throwIfDisposed(),e8(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.div=function(t){return this.throwIfDisposed(),$e(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.dot=function(t){return this.throwIfDisposed(),t8(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.elu=function(){return this.throwIfDisposed(),b0(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.equal=function(t){return this.throwIfDisposed(),Mo(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.erf=function(){return this.throwIfDisposed(),n8(this)};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.euclideanNorm=function(t,e){return this.throwIfDisposed(),i8(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.exp=function(){return this.throwIfDisposed(),Ir(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.expandDims=function(t){return this.throwIfDisposed(),as(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.expm1=function(){return this.throwIfDisposed(),o8(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.fft=function(){return this.throwIfDisposed(),BS(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.flatten=function(){return this.throwIfDisposed(),Q(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.floor=function(){return this.throwIfDisposed(),w0(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.floorDiv=function(t){return this.throwIfDisposed(),OA(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.gather=function(t,e){return this.throwIfDisposed(),Tc(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.greaterEqual=function(t){return this.throwIfDisposed(),Md(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.greater=function(t){return this.throwIfDisposed(),Ei(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.ifft=function(){return this.throwIfDisposed(),Eg(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.irfft=function(){return this.throwIfDisposed(),dR(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.isFinite=function(){return this.throwIfDisposed(),a8(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.isInf=function(){return this.throwIfDisposed(),l8(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.isNaN=function(){return this.throwIfDisposed(),c8(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.leakyRelu=function(t){return this.throwIfDisposed(),AS(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.lessEqual=function(t){return this.throwIfDisposed(),zd(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.less=function(t){return this.throwIfDisposed(),UA(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.localResponseNormalization=function(t,e,n,s){return this.throwIfDisposed(),u8(this,t,e,n,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.logSigmoid=function(){return this.throwIfDisposed(),d8(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.logSoftmax=function(t){return this.throwIfDisposed(),HA(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.logSumExp=function(t,e){return this.throwIfDisposed(),GA(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.log=function(){return this.throwIfDisposed(),Ti(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.log1p=function(){return this.throwIfDisposed(),RS(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.logicalAnd=function(t){return this.throwIfDisposed(),Ea(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.logicalNot=function(){return this.throwIfDisposed(),DS(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.logicalOr=function(t){return this.throwIfDisposed(),KA(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.logicalXor=function(t){return this.throwIfDisposed(),h8(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.matMul=function(t,e,n){return this.throwIfDisposed(),Ct(this,t,e,n)};ue().prototype.maxPool=function(t,e,n,s){return this.throwIfDisposed(),OS(this,t,e,n,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.max=function(t,e){return this.throwIfDisposed(),ro(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.maximum=function(t){return this.throwIfDisposed(),Oa(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.mean=function(t,e){return this.throwIfDisposed(),Dn(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.min=function(t,e){return this.throwIfDisposed(),rw(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.minimum=function(t){return this.throwIfDisposed(),S0(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.mirrorPad=function(t,e){return this.throwIfDisposed(),p8(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.mod=function(t){return this.throwIfDisposed(),m8(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.mul=function(t){return this.throwIfDisposed(),Y(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.neg=function(){return this.throwIfDisposed(),vn(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.norm=function(t,e,n){return this.throwIfDisposed(),kd(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.notEqual=function(t){return this.throwIfDisposed(),Pf(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.oneHot=function(t,e=1,n=0){return this.throwIfDisposed(),IA(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.onesLike=function(){return this.throwIfDisposed(),Ni(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.pad=function(t,e){return this.throwIfDisposed(),$a(this,t,e)};ue().prototype.pool=function(t,e,n,s,r,i){return this.throwIfDisposed(),g8(this,t,e,n,s,r,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.pow=function(t){return this.throwIfDisposed(),Bc(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.prelu=function(t){return this.throwIfDisposed(),LS(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.prod=function(t,e){return this.throwIfDisposed(),y8(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.reciprocal=function(){return this.throwIfDisposed(),v8(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.relu=function(){return this.throwIfDisposed(),Pa(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.relu6=function(){return this.throwIfDisposed(),sR(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.reshapeAs=function(t){return this.throwIfDisposed(),Q(this,t.shape)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.reshape=function(t){return this.throwIfDisposed(),Q(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.resizeBilinear=function(t,e,n){return this.throwIfDisposed(),O8(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.resizeNearestNeighbor=function(t,e,n){return this.throwIfDisposed(),P8(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.reverse=function(t){return this.throwIfDisposed(),ao(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.rfft=function(){return this.throwIfDisposed(),WS(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.round=function(){return this.throwIfDisposed(),rR(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.rsqrt=function(){return this.throwIfDisposed(),iR(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.selu=function(){return this.throwIfDisposed(),oR(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.separableConv2d=function(t,e,n,s,r,i){return this.throwIfDisposed(),aR(this,t,e,n,s,r,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.sigmoid=function(){return this.throwIfDisposed(),bi(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.sign=function(){return this.throwIfDisposed(),b8(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.sin=function(){return this.throwIfDisposed(),lR(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.sinh=function(){return this.throwIfDisposed(),cR(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.slice=function(t,e){return this.throwIfDisposed(),st(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.softmax=function(t){return this.throwIfDisposed(),jS(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.softplus=function(){return this.throwIfDisposed(),lp(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.spaceToBatchND=function(t,e){return this.throwIfDisposed(),FS(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.split=function(t,e){return this.throwIfDisposed(),Yr(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.sqrt=function(){return this.throwIfDisposed(),Ys(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.square=function(){return this.throwIfDisposed(),Zt(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.squaredDifference=function(t){return this.throwIfDisposed(),hR(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.squeeze=function(t){return this.throwIfDisposed(),Bt(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.stack=function(t,e){this.throwIfDisposed();const n=t instanceof Yt?[this,t]:[this,...t];return lo(n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.step=function(t){return this.throwIfDisposed(),cp(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.stridedSlice=function(t,e,n,s,r,i,o,a){return this.throwIfDisposed(),w8(this,t,e,n,s,r,i,o,a)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.sub=function(t){return this.throwIfDisposed(),Ae(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.sum=function(t,e){return this.throwIfDisposed(),Be(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.tan=function(){return this.throwIfDisposed(),S8(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.tanh=function(){return this.throwIfDisposed(),Of(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.tile=function(t){return this.throwIfDisposed(),Ji(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.toBool=function(){return this.throwIfDisposed(),Te(this,"bool")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.toFloat=function(){return this.throwIfDisposed(),Te(this,"float32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.toInt=function(){return this.throwIfDisposed(),Te(this,"int32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.topk=function(t,e){return this.throwIfDisposed(),k8(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.transpose=function(t){return this.throwIfDisposed(),Nt(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.unique=function(t){return this.throwIfDisposed(),C8(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.unsortedSegmentSum=function(t,e){return this.throwIfDisposed(),pR(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.unstack=function(t){return this.throwIfDisposed(),zo(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.where=function(t,e){return this.throwIfDisposed(),Nr(t,this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ue().prototype.zerosLike=function(){return this.throwIfDisposed(),_t(this)};/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class sa extends Error{constructor(e){super(e),Object.setPrototypeOf(this,sa.prototype)}}class eo extends Error{constructor(e){super(e),Object.setPrototypeOf(this,eo.prototype)}}class ee extends Error{constructor(e){super(e),Object.setPrototypeOf(this,ee.prototype)}}class ft extends Error{constructor(e){super(e),Object.setPrototypeOf(this,ft.prototype)}}class XR extends Error{constructor(e){super(e),Object.setPrototypeOf(this,XR.prototype)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class TK{constructor(e){this.maxEntries=e||100,this.cache=new Map}get(e){let n;return this.cache.has(e)&&(n=this.cache.get(e),this.cache.delete(e),this.cache.set(e,n)),n}put(e,n){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxEntries){const s=this.cache.keys().next().value;this.cache.delete(s)}this.cache.set(e,n)}getMaxEntries(){return this.maxEntries}setMaxEntries(e){if(e<0)throw new Error(`The maxEntries of LRU caches must be at least 0, but got ${e}.`);if(this.maxEntries>e)for(let n=0;n<this.maxEntries-e;n++){const s=this.cache.keys().next().value;this.cache.delete(s)}this.maxEntries=e}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Nd(t,e){if(Array.isArray(t)){let n=[];for(let s=0;s<e;s++)n=n.concat(t);return n}else{const n=new Array(e);return n.fill(t),n}}function ra(t,e){if(!t)throw new XR(e)}function Lz(t,e){let n=0;for(const s of t)s===e&&n++;return n}function br(t){return t.length===1?t[0]:t}function ln(t){return Array.isArray(t)?t:[t]}function Xa(t){const n=t.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return n[0]!=="_"?n:"private"+n}function Eu(t){return t.length<=1||t.indexOf("_")===-1?t:t.replace(/[_]+(\w|$)/g,(e,n)=>n.toUpperCase())}let Mi={};function YR(t){if(t==null)return null;const e={};return e.className=t.getClassName(),e.config=t.getConfig(),e}function pI(t){if(!(t==null||typeof t!="object"))if(Array.isArray(t))t.forEach(e=>pI(e));else{const e=Object.keys(t);for(const n of e){const s=t[n];s!=null&&typeof s=="object"&&(!Array.isArray(s)&&s.type==="ndarray"&&typeof s.value=="number"?t[n]=s.value:pI(s))}}}function I0(t,e={},n={},s="object",r=!1){if(typeof t=="string"){const i=t;let o;if(i in n)o=n[i];else if(i in Mi)o=Mi[i];else if(o=e[i],o==null)throw new ee(`Unknown ${s}: ${t}. This may be due to one of the following reasons:
1. The ${s} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${s} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);return o}else{const i=t;if(i.className==null||i.config==null)throw new ee(`${s}: Improper config format: ${JSON.stringify(i)}.
'className' and 'config' must set.`);const o=i.className;let a,l;if(o in n?[a,l]=n[o]:o in Mi?[a,l]=Mi.className:o in e&&([a,l]=e[o]),a==null)throw new ee(`Unknown ${s}: ${o}. This may be due to one of the following reasons:
1. The ${s} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${s} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);if(l!=null){const c={};for(const f of Object.keys(Mi))c[f]=Mi[f];for(const f of Object.keys(n))c[f]=n[f];const u=i.config;u.customObjects=c;const d=Object.assign({},Mi);for(const f of Object.keys(n))Mi[f]=n[f];pI(i.config);const h=l(a,i.config,n,r);return Mi=Object.assign({},d),h}else{const c=Object.assign({},Mi);for(const d of Object.keys(n))Mi[d]=n[d];const u=new a(i.config);return Mi=Object.assign({},c),u}}}function VNe(t,e){return t<e?-1:t>e?1:0}function Hx(t,e){return-1*VNe(t,e)}function Nc(t){if(t==null)return t;const e=[];for(const n of t)e.indexOf(n)===-1&&e.push(n);return e}function jNe(t){if(t==null)throw new ee(`Invalid value in obj: ${JSON.stringify(t)}`);for(const e in t)if(t.hasOwnProperty(e))return!1;return!0}function jd(t,e,n){if(n!=null&&t.indexOf(n)<0)throw new ee(`${n} is not a valid ${e}.  Valid values are ${t} or null/undefined.`)}function ZR(t,e,n=0,s=1/0){return ra(n>=0),ra(s>=n),Array.isArray(t)&&t.length>=n&&t.length<=s&&t.every(r=>typeof r===e)}function Ss(t,e){Array.isArray(t)?(O(t.length>0,()=>`${e} is unexpectedly an empty array.`),t.forEach((n,s)=>Ss(n,`element ${s+1} of ${e}`))):O(Number.isInteger(t)&&t>0,()=>`Expected ${e} to be a positive integer, but got ${NK(t)}.`)}function NK(t){return t===null?"null":Array.isArray(t)?"["+t.map(e=>NK(e)).join(",")+"]":typeof t=="string"?`"${t}"`:`${t}`}function BNe(t,e,n){let s=n!=null?n():vr(),r;return(...o)=>{const a=n!=null?n():vr();return a-s<e||(s=a,r=t(...o)),r}}function IK(t){return t==="relu"?"relu":t==="linear"?"linear":t==="elu"?"elu":null}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let WNe=0;function _K(){return WNe++}const Gx={};function JS(t=""){return t in Gx||(Gx[t]=0),Gx[t]+=1,t+Gx[t].toString()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const UNe=["channelsFirst","channelsLast"],HNe=["nearest","bilinear"],GNe=["valid","same","causal"],KNe=["max","avg"],qNe=["sum","mul","concat","ave"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const nh=new Map;function Kn(t){jd(UNe,"DataFormat",t)}function XNe(t){jd(HNe,"InterpolationFormat",t)}function $i(t){jd(GNe,"PaddingMode",t)}function EK(t){jd(KNe,"PoolMode",t)}const Um=[],Mz="/";function rd(t,e){Um.push(t);try{const n=e();return Um.pop(),n}catch(n){throw Um.pop(),n}}function YNe(){return Um.length===0?"":Um.join(Mz)+Mz}function $K(t){if(!RK(t))throw new Error("Not a valid tensor name: '"+t+"'");return YNe()+t}function AK(t){if(!RK(t))throw new Error("Not a valid tensor name: '"+t+"'");nh.has(t)||nh.set(t,0);const e=nh.get(t);if(nh.set(t,nh.get(t)+1),e>0){const n=`${t}_${e}`;return nh.set(n,1),n}else return t}const ZNe=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function RK(t){return!!t.match(ZNe)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function QNe(t){return t===parseInt(t.toString(),10)}function Ic(t,e,n){e==null&&(e=0),n==null&&(n=t.length);let s=1;for(let r=e;r<n;++r)s*=t[r];return s}function Lf(t){if(t.length===0)return Number.NaN;let e=Number.POSITIVE_INFINITY;for(let n=0;n<t.length;n++){const s=t[n];s<e&&(e=s)}return e}function Wc(t){if(t.length===0)return Number.NaN;let e=Number.NEGATIVE_INFINITY;for(let n=0;n<t.length;n++){const s=t[n];s>e&&(e=s)}return e}function Vo(t,e){if(e<t)throw new ee(`end (${e}) < begin (${t}) is forbidden.`);const n=[];for(let s=t;s<e;++s)n.push(s);return n}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let iT;function us(){return iT==null&&(iT=Kye().epsilon()),iT}function jo(){return"channelsLast"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function _0(t,e){return Te(t,e)}function E0(t,e=-1){const n=t.shape.slice();return e<0&&(e=n.length+e+1),n.splice(e,0,1),Q(t,n)}function JNe(t,e){return se(()=>{if(t.shape.length!==2)throw new ee(`repeat() expects a rank-2 tensor, but received a rank-${t.shape.length} tensor.`);const n=E0(t,1);return mI(n,[1,e,1])})}function e2e(t){const e=[Ic(t.shape)];return Q(t,e)}function t2e(t){if(t.rank<=1)throw new ee(`batchFlatten requires a minimum rank of 2. Got rank: ${t.rank}.`);const e=[t.shape[0],Ic(t.shape,1)];return Q(t,e)}function id(t,e,n){return se(()=>{switch(t.rank){case 1:return zS(t,e,n);case 2:return uR(t,[e,0],[n,t.shape[1]]);case 3:return VS(t,[e,0,0],[n,t.shape[1],t.shape[2]]);case 4:return _g(t,[e,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3]]);case 5:return st(t,[e,0,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3],t.shape[4]]);case 6:return st(t,[e,0,0,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3],t.shape[4],t.shape[5]]);default:throw new ee(`sliceAlongFirstAxis() received an unsupported tensor rank: ${t.rank}`)}})}function oT(t,e,n){return se(()=>{switch(t.rank){case 1:return zS(t,e,n);case 2:return uR(t,[0,e],[t.shape[0],n]);case 3:return VS(t,[0,0,e],[t.shape[0],t.shape[1],n]);case 4:return _g(t,[0,0,0,e],[t.shape[0],t.shape[1],t.shape[2],n]);default:throw new ee(`sliceAlongLastAxis() received an unsupported tensor rank: ${t.rank}`)}})}function Kx(t,e,n,s){return se(()=>{switch(t.rank){case 1:return zS(t,e,n);case 2:switch(s){case 1:return id(t,e,n);case 2:return oT(t,e,n);default:throw new ee(`The axis is not within the rank of the tensor ${s}`)}case 3:switch(s){case 1:return id(t,e,n);case 2:return VS(t,[0,e,0],[t.shape[0],n,t.shape[2]]);case 3:return oT(t,e,n);default:throw new ee(`The axis is not within the rank of the tensor ${s}`)}case 4:switch(s){case 1:return id(t,e,n);case 2:return _g(t,[0,e,0,0],[t.shape[0],n,t.shape[2],t.shape[3]]);case 3:return _g(t,[0,0,e,0],[t.shape[0],t.shape[1],n,t.shape[3]]);case 4:return oT(t,e,n);default:throw new ee(`The axis is not within the rank of the tensor ${s}`)}default:throw new ee(`sliceAlongLastAxis() received an unsupported tensor rank: ${t.rank}`)}})}function QR(t,e=-1){let n;return e<0&&(n=t[0].rank,n!==0?e=n:e=0),e===t[0].rank&&(e=-1),Cn(t,e)}function zz(t,e){switch(t.rank){case 1:return HG([t,e]);case 2:return GG([t,e],0);case 3:return KG([t,e],0);case 4:return qG([t,e],0);default:throw new ee(`concatAlongFirstAxis() received an unsupported tensor rank: ${t.rank}`)}}function mI(t,e){if(Array.isArray(e)||(e=[e]),t.rank!==e.length)throw new ee(`The length of input n (${e.length}) does not match the number of dimensions in input x (${t.rank})`);return Ji(t,e)}function ek(t,e=0,n=1,s,r){return nR(t,e,n,s,r)}function Ca(t,e,n,s){if(t.rank<2||e.rank<2)throw new ft(`dot requires both inputs to be rank >= 2 but got x shape = ${t.shape} and y shape = ${e.shape}`);if(e.rank>=3){const r=t.shape.slice(-1)[0],i=e.shape.slice(-2)[0];if(r!==i)throw new ft(`If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = ${t.shape} and  y shape = ${e.shape}`)}if(t.rank===2&&e.rank===2)return Z2({a:t,b:e,transposeA:!1,transposeB:!1,bias:s?gI(t.rank,s,jo()):null,activation:n});{const r=t.shape.slice(),i=r.pop();t=Q(t,[-1,i]);const o=e.shape.slice(),a=o.pop(),l=o.pop(),c=[...o,a],u=Array.from({length:e.rank},(p,m)=>m===0?e.rank-2:m<=e.rank-2?m-1:m);e=Q(Nt(e,u),[l,-1]);const d=[...r,...c];return Q(Z2({a:t,b:e,transposeA:!1,transposeB:!1,bias:s?gI(t.rank,s,jo()):null,activation:n}),d)}}function DK(t,e,n){return se(()=>(Array.isArray(e)?e=cs(e,"int32"):e=Te(e,"int32"),Tc(t,e,n)))}function $0(t){return Y(t,t)}function gI(t,e,n){const s=e.shape;if(e.rank!==1&&e.rank!==t)throw new ee(`Unexpected bias dimensions: ${e.rank}; expected it to be 1 or ${t}`);if(t===5){if(n==="channelsFirst")return s.length===1?Q(e,[1,s[0],1,1,1]):Q(e,[1,s[3],s[0],s[1],s[2]]);if(n==="channelsLast")return s.length===1?Q(e,[1,1,1,1,s[0]]):Q(e,[1].concat(s))}else if(t===4){if(n==="channelsFirst")return s.length===1?Q(e,[1,s[0],1,1]):Q(e,[1,s[2],s[0],s[1]]);if(n==="channelsLast")return s.length===1?Q(e,[1,1,1,s[0]]):Q(e,[1].concat(s))}else if(t===3){if(n==="channelsFirst")return s.length===1?Q(e,[1,s[0],1]):Q(e,[1,s[1],s[0]]);if(n==="channelsLast")return s.length===1?Q(e,[1,1,s[0]]):Q(e,[1].concat(s))}else if(t<3)return e;throw new ee(`Unsupported input rank by biasAdd: ${e.rank}`)}function Uo(t,e,n){return se(()=>(n==null&&(n=jo()),Kn(n),fe(t,gI(t.rank,e,n))))}function n2e(t,e=1){if(e!==1)throw new ft(`Support for alpha values other than 1 (${e}) is not implemented yet.`);return b0(t)}function s2e(t){return se(()=>$e(t,fe(os(t),1)))}function OK(t,e,n,s){return se(()=>I8(t,e,n,s))}function r2e(t){return se(()=>{const e=fe(.5,Y(.2,t));return Tr(e,0,1)})}function A0(t,e,n=!1){return n?t():e()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const i2e=["fanIn","fanOut","fanAvg"],o2e=["normal","uniform","truncatedNormal"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function a2e(t){jd(i2e,"FanMode",t)}function l2e(t){jd(o2e,"Distribution",t)}class ho extends op{fromConfigUsesCustomObjects(){return!1}getConfig(){return{}}}class PK extends ho{apply(e,n){return es(e,n)}}PK.className="Zeros";ge(PK);class JR extends ho{apply(e,n){return gi(e,n)}}JR.className="Ones";ge(JR);class FK extends ho{constructor(e){if(super(),typeof e!="object")throw new ee(`Expected argument of type ConstantConfig but got ${e}`);if(e.value===void 0)throw new ee(`config must have value set but got ${e}`);this.value=e.value}apply(e,n){return se(()=>Y(Ge(this.value),gi(e,n)))}getConfig(){return{value:this.value}}}FK.className="Constant";ge(FK);class LK extends ho{constructor(e){super(),this.DEFAULT_MINVAL=-.05,this.DEFAULT_MAXVAL=.05,this.minval=e.minval||this.DEFAULT_MINVAL,this.maxval=e.maxval||this.DEFAULT_MAXVAL,this.seed=e.seed}apply(e,n){return k0(e,this.minval,this.maxval,n)}getConfig(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}}LK.className="RandomUniform";ge(LK);class MK extends ho{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,n){if(n=n||"float32",n!=="float32"&&n!=="int32")throw new ft(`randomNormal does not support dType ${n}.`);return ek(e,this.mean,this.stddev,n,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}MK.className="RandomNormal";ge(MK);class zK extends ho{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,n){if(n=n||"float32",n!=="float32"&&n!=="int32")throw new ft(`truncatedNormal does not support dType ${n}.`);return fR(e,this.mean,this.stddev,n,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}zK.className="TruncatedNormal";ge(zK);class VK extends ho{constructor(e){super(),this.gain=e.gain!=null?e.gain:1}apply(e,n){return se(()=>{if(e.length!==2||e[0]!==e[1])throw new ee("Identity matrix initializer can only be used for 2D square matrices.");return Y(this.gain,WA(e[0]))})}getConfig(){return{gain:this.gain}}}VK.className="Identity";ge(VK);function c2e(t,e="channelsLast"){let n,s;if(Kn(e),t.length===2)n=t[0],s=t[1];else if([3,4,5].indexOf(t.length)!==-1){if(e==="channelsFirst"){const r=Ic(t,2);n=t[1]*r,s=t[0]*r}else if(e==="channelsLast"){const r=Ic(t,0,t.length-2);n=t[t.length-2]*r,s=t[t.length-1]*r}}else{const r=Ic(t);n=Math.sqrt(r),s=Math.sqrt(r)}return[n,s]}class Jr extends ho{constructor(e){if(super(),e.scale<0)throw new ee(`scale must be a positive float. Got: ${e.scale}`);this.scale=e.scale==null?1:e.scale,this.mode=e.mode==null?"fanIn":e.mode,a2e(this.mode),this.distribution=e.distribution==null?"normal":e.distribution,l2e(this.distribution),this.seed=e.seed}apply(e,n){const s=c2e(e),r=s[0],i=s[1];let o=this.scale;if(this.mode==="fanIn"?o/=Math.max(1,r):this.mode==="fanOut"?o/=Math.max(1,i):o/=Math.max(1,(r+i)/2),this.distribution==="normal"){const a=Math.sqrt(o);if(n=n||"float32",n!=="float32"&&n!=="int32")throw new ft(`${this.getClassName()} does not support dType ${n}.`);return fR(e,0,a,n,this.seed)}else{const a=Math.sqrt(3*o);return k0(e,-a,a,n)}}getConfig(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}}Jr.className="VarianceScaling";ge(Jr);class eD extends Jr{constructor(e){super({scale:1,mode:"fanAvg",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return Jr.className}}eD.className="GlorotUniform";ge(eD);class tD extends Jr{constructor(e){super({scale:1,mode:"fanAvg",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return Jr.className}}tD.className="GlorotNormal";ge(tD);class nD extends Jr{constructor(e){super({scale:2,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return Jr.className}}nD.className="HeNormal";ge(nD);class sD extends Jr{constructor(e){super({scale:2,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return Jr.className}}sD.className="HeUniform";ge(sD);class rD extends Jr{constructor(e){super({scale:1,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return Jr.className}}rD.className="LeCunNormal";ge(rD);class iD extends Jr{constructor(e){super({scale:1,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return Jr.className}}iD.className="LeCunNormal";ge(iD);class jK extends ho{constructor(e){if(super(),this.DEFAULT_GAIN=1,this.gain=e.gain==null?this.DEFAULT_GAIN:e.gain,this.seed=e.seed,this.seed!=null)throw new ft("Random seed is not implemented for Orthogonal Initializer yet.")}apply(e,n){return se(()=>{if(e.length<2)throw new ft("Shape must be at least 2D.");e[0]*e[1]>2e3&&console.warn(`Orthogonal initializer is being called on a matrix with more than 2000 (${e[0]*e[1]}) elements: Slowness may result.`);const s=e[0]>e[1]?[e[1],e[0]]:e,r=ek(s,0,1,"float32");let i=F8.gramSchmidt(r);return e[0]>e[1]&&(i=Nt(i)),Y(this.gain,i)})}getConfig(){return{gain:this.gain,seed:this.seed}}}jK.className="Orthogonal";ge(jK);const Vz={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function jz(t,e={}){return I0(t,qi.getMap().classNameMap,e,"initializer")}function kn(t){return YR(t)}function xn(t){if(typeof t=="string"){const e=t in Vz?Vz[t]:t;if(e==="GlorotNormal")return new tD;if(e==="GlorotUniform")return new eD;if(e==="HeNormal")return new nD;if(e==="HeUniform")return new sD;if(e==="LeCunNormal")return new rD;if(e==="LeCunUniform")return new iD;{const n={};return n.className=e,n.config={},jz(n)}}else return t instanceof ho?t:jz(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function yI(t){return Array.isArray(t)&&Array.isArray(t[0])}function aw(t){return t.length===0?[]:Array.isArray(t[0])?t:[t]}function pt(t){let e;if(Array.isArray(t)){if(t.length!==1)throw new ee(`Expected Tensor length to be 1; got ${t.length}`);e=t[0]}else e=t;return e}function Ut(t){if(Array.isArray(t)&&Array.isArray(t[0])){if(t.length===1)return t=t,t[0];throw new ee(`Expected exactly 1 Shape; got ${t.length}`)}else return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function lw(t){let e=0;for(const n of t)n.shape.length===0?e+=1:e+=n.shape.reduce((s,r)=>s*r);return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Bz="Variable";class u2e{constructor(e,n="float32",s=Bz,r=!0,i=null){this.dtype=n??"float32",this.shape=e.shape,this.id=_K(),s=s??Bz,this.originalName=$K(s),this.name=AK(this.originalName),this.trainable_=r,this.constraint=i,this.val=T8(e,this.trainable_,this.name,this.dtype)}read(){return this.assertNotDisposed(),this.val}write(e){return this.assertNotDisposed(),d2e(this.val,e),this.val.id!==e.id&&(this.val.assign(e),this.constraint!=null&&this.val.assign(this.constraint.apply(this.val))),this}dispose(){this.assertNotDisposed(),this.val.dispose()}assertNotDisposed(){if(this.val.isDisposed)throw new Error(`LayersVariable ${this.name} is already disposed.`)}get trainable(){return this.trainable_}set trainable(e){this.trainable_=e,this.val.trainable=e}}function d2e(t,e){if(t.shape.toString()!==e.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(t.shape)+" vs. "+JSON.stringify(e.shape))}function xI(t){return t.map(e=>e.read())}function oD(t){t.forEach(e=>{e[0].write(e[1])})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class ds{constructor(e){this.dtype=e.dtype,this.shape=e.shape,e.shape!=null?this.ndim=e.shape.length:this.ndim=e.ndim,this.maxNDim=e.maxNDim,this.minNDim=e.minNDim,this.axes=e.axes||{}}}class fa{constructor(e,n,s,r,i,o,a){this.dtype=e,this.shape=n,this.sourceLayer=s,this.inputs=r,this.callArgs=i,this.outputTensorIndex=a,this.id=_K(),o!=null&&(this.originalName=$K(o),this.name=AK(this.originalName)),this.rank=n.length}}let h2e=0,tk=class{constructor(e,n){this.callArgs=n,this.id=h2e++,this.outboundLayer=e.outboundLayer,this.inboundLayers=e.inboundLayers,this.nodeIndices=e.nodeIndices,this.tensorIndices=e.tensorIndices,this.inputTensors=e.inputTensors,this.outputTensors=e.outputTensors,this.inputMasks=e.inputMasks,this.outputMasks=e.outputMasks,this.inputShapes=e.inputShapes,this.outputShapes=e.outputShapes;for(const s of e.inboundLayers)s!=null&&s.outboundNodes.push(this);e.outboundLayer.inboundNodes.push(this)}getConfig(){const e=[];for(const n of this.inboundLayers)n!=null?e.push(n.name):e.push(null);return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:e,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}},f2e=0;class $t extends op{constructor(e={}){super(),this._callHook=null,this._addedWeightNames=[],this._stateful=!1,this.id=f2e++,this.activityRegularizer=null,this.inputSpec=null,this.supportsMasking=!1,this._trainableWeights=[],this._nonTrainableWeights=[],this._losses=[],this._updates=[],this._built=!1,this.inboundNodes=[],this.outboundNodes=[];let n=e.name;if(!n){const s=this.getClassName();n=Xa(s)+"_"+JS(s)}if(this.name=n,this.trainable_=e.trainable==null?!0:e.trainable,e.inputShape!=null||e.batchInputShape!=null){let s;if(e.batchInputShape!=null)s=e.batchInputShape;else if(e.inputShape!=null){let i=null;e.batchSize!=null&&(i=e.batchSize),s=[i].concat(e.inputShape)}this.batchInputShape=s;let r=e.dtype;r==null&&(r=e.inputDType),r==null&&(r="float32"),this.dtype=r}e.weights!=null?this.initialWeights=e.weights:this.initialWeights=null,this._refCount=null,this.fastWeightInitDuringBuild=!1}static nodeKey(e,n){return e.name+"_ib-"+n.toString()}getNodeAtIndex(e,n){if(this.inboundNodes.length===0)throw new eo(`The layer has never been called and thus has no defined ${n}.`);if(this.inboundNodes.length<=e)throw new ee(`Asked to get ${n} at node ${e}, but the layer has only ${this.inboundNodes.length} inbound nodes.`);return this.inboundNodes[e]}getInputAt(e){return br(this.getNodeAtIndex(e,"input").inputTensors)}getOutputAt(e){return br(this.getNodeAtIndex(e,"output").outputTensors)}get input(){if(this.inboundNodes.length>1)throw new sa(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use \`getInputAt(nodeIndex)\` instead.`);if(this.inboundNodes.length===0)throw new sa(`Layer ${this.name} is not connected, no input to return.`);return br(this.getNodeAtIndex(0,"input").inputTensors)}get output(){if(this.inboundNodes.length===0)throw new sa(`Layer ${this.name} has no inbound nodes.`);if(this.inboundNodes.length>1)throw new sa(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use \`getOutputAt(nodeIndex)\` instead.`);return br(this.getNodeAtIndex(0,"output").outputTensors)}get losses(){return this._losses}calculateLosses(){return this.losses.map(e=>e())}get updates(){return this._updates}get built(){return this._built}set built(e){this._built=e}get trainable(){return this.trainable_}set trainable(e){this._trainableWeights.forEach(n=>n.trainable=e),this.trainable_=e}get trainableWeights(){return this.trainable_?this._trainableWeights.filter(e=>e.trainable):[]}set trainableWeights(e){this._trainableWeights=e}get nonTrainableWeights(){return this.trainable?this._trainableWeights.filter(e=>!e.trainable).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)}set nonTrainableWeights(e){this._nonTrainableWeights=e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}get stateful(){return this._stateful}resetStates(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}assertInputCompatibility(e){if(e=ln(e),this.inputSpec==null||this.inputSpec.length===0)return;const n=ln(this.inputSpec);if(e.length!==n.length)throw new ee(`Layer ${this.name} expects ${n.length} inputs, but it received ${e.length} input tensors. Input received: ${e}`);for(let s=0;s<e.length;s++){const r=e[s],i=n[s];if(i==null)continue;const o=r.rank;if(i.ndim!=null&&o!==i.ndim)throw new ee(`Input ${s} is incompatible with layer ${this.name}: expected ndim=${i.ndim}, found ndim=${o}`);if(i.maxNDim!=null&&o>i.maxNDim)throw new ee(`Input ${s} is incompatible with layer ${this.name}: expected max_ndim=${i.maxNDim}, found ndim=${o}`);if(i.minNDim!=null&&o<i.minNDim)throw new ee(`Input ${s} is incompatible with layer ${this.name}: expected min_ndim=${i.minNDim}, found ndim=${o}.`);if(i.dtype!=null&&r.dtype!==i.dtype)throw new ee(`Input ${s} is incompatible with layer ${this.name} : expected dtype=${i.dtype}, found dtype=${r.dtype}.`);if(i.axes){const a=r.shape;for(const l in i.axes){const c=Number(l),u=i.axes[l],d=c>=0?a[c]:a[a.length+c];if(u!=null&&[u,null].indexOf(d)===-1)throw new ee(`Input ${s} is incompatible with layer ${this.name}: expected axis ${c} of input shape to have value ${u} but got shape ${a}.`)}}if(i.shape!=null)for(let a=0;a<i.shape.length;++a){const l=i.shape[a],c=r.shape[a];if(l!=null&&c!=null&&l!==c)throw new ee(`Input ${s} is incompatible with layer ${this.name}: expected shape=${i.shape}, found shape=${r.shape}.`)}}}call(e,n){return e}invokeCallHook(e,n){this._callHook!=null&&this._callHook(e,n)}setCallHook(e){this._callHook=e}clearCallHook(){this._callHook=null}apply(e,n){n=n||{},this.assertNotDisposed();const s=ln(e);let r=!0;for(const o of s)if(!(o instanceof fa)){r=!1;break}let i=!0;for(const o of s)if(o instanceof fa){i=!1;break}if(r===i)throw new ee("Arguments to apply() must be all SymbolicTensors or all Tensors");return rd(this.name,()=>{if(!this.built){this.assertInputCompatibility(e);const o=[];for(const a of ln(e))o.push(a.shape);this.build(br(o)),this.built=!0,this.initialWeights&&this.setWeights(this.initialWeights),this._refCount===null&&i&&(this._refCount=1)}if(this.assertInputCompatibility(e),i){let o=this.call(e,n);const a=ln(o),l=[];for(let c of a)s.indexOf(c)!==-1&&(c=c.clone()),l.push(c);if(o=br(l),this.activityRegularizer!=null)throw new ft("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return o}else{const o=p2e(e),a=this.computeOutputShape(o);let l;const c=m2e(e);if(this.warnOnIncompatibleInputShape(Array.isArray(e)?o[0]:o),a!=null&&a.length>0&&Array.isArray(a[0])?l=a.map((u,d)=>new fa(c,u,this,ln(e),n,this.name,d)):l=new fa(c,a,this,ln(e),n,this.name),this.addInboundNode(e,l,null,null,o,a,n),this._refCount++,this.activityRegularizer!=null)throw new ft("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return l}})}warnOnIncompatibleInputShape(e){if(this.batchInputShape!=null)if(e.length!==this.batchInputShape.length)console.warn(`The rank of the input tensor provided (shape: ${JSON.stringify(e)}) does not match that of the batchInputShape (${JSON.stringify(this.batchInputShape)}) of the layer ${this.name}`);else{let n=!1;this.batchInputShape.forEach((s,r)=>{s!=null&&e[r]!=null&&e[r]!==s&&(n=!0)}),n&&console.warn(`The shape of the input tensor (${JSON.stringify(e)}) does not match the expectation of layer ${this.name}: ${JSON.stringify(this.batchInputShape)}`)}}get outputShape(){if(this.inboundNodes==null||this.inboundNodes.length===0)throw new sa(`The layer ${this.name} has never been called and thus has no defined output shape.`);const e=[];for(const n of this.inboundNodes){const s=JSON.stringify(n.outputShapes);e.indexOf(s)===-1&&e.push(s)}if(e.length===1){const n=this.inboundNodes[0].outputShapes;return Array.isArray(n)&&Array.isArray(n[0])&&n.length===1?n[0]:n}else throw new sa(`The layer ${this.name} has multiple inbound nodes with different output shapes. Hence the notion of "output shape" is ill-defined for the layer.`)}countParams(){if(!this.built)throw new eo(`You tried to call countParams() on ${this.name}, but the layer is not built yet. Build it first by calling build(batchInputShape).`);return lw(this.weights)}build(e){this.built=!0}getWeights(e=!1){return xI(e?this.trainableWeights:this.weights)}setWeights(e){se(()=>{const n=this.weights;if(n.length!==e.length)throw new ee(`You called setWeights(weights) on layer "${this.name}" with a weight list of length ${e.length}, but the layer was expecting ${n.length} weights. Provided weights: ${e}...`);if(n.length===0)return;const s=[],r=xI(n);for(let i=0;i<r.length;++i){const o=r[i],a=n[i],l=e[i];if(!Et(o.shape,l.shape))throw new ee(`Layer weight shape ${o.shape} not compatible with provided weight shape ${l.shape}`);s.push([a,l])}oD(s)})}addWeight(e,n,s,r,i,o,a,l){if(this._addedWeightNames.indexOf(e)!==-1)throw new ee(`Duplicate weight name ${e} for layer ${this.name}`);this._addedWeightNames.push(e),s==null&&(s="float32"),this.fastWeightInitDuringBuild&&(r=l!=null?l():xn("zeros"));const c=r.apply(n,s),u=new u2e(c,s,e,o,a);return c.dispose(),i!=null&&this.addLoss(()=>i.apply(u.read())),o==null&&(o=!0),o?this._trainableWeights.push(u):this._nonTrainableWeights.push(u),u}setFastWeightInitDuringBuild(e){this.fastWeightInitDuringBuild=e}addLoss(e){e==null||Array.isArray(e)&&e.length===0||(e=ln(e),this._losses!==void 0&&this._losses!==null&&this.losses.push(...e))}computeOutputShape(e){return e}computeMask(e,n){if(!this.supportsMasking){if(n!=null)if(Array.isArray(n))n.forEach(s=>{if(s!=null)throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`)});else throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`);return null}return n}addInboundNode(e,n,s,r,i,o,a=null){const l=ln(e);n=ln(n),s=ln(s),r=ln(r),i=aw(i),o=aw(o);const c=[],u=[],d=[];for(const h of l)c.push(h.sourceLayer),u.push(h.nodeIndex),d.push(h.tensorIndex);new tk({outboundLayer:this,inboundLayers:c,nodeIndices:u,tensorIndices:d,inputTensors:l,outputTensors:n,inputMasks:s,outputMasks:r,inputShapes:i,outputShapes:o},a);for(let h=0;h<n.length;h++)n[h].sourceLayer=this,n[h].nodeIndex=this.inboundNodes.length-1,n[h].tensorIndex=h}getConfig(){const e={name:this.name,trainable:this.trainable};return this.batchInputShape!=null&&(e.batchInputShape=this.batchInputShape),this.dtype!=null&&(e.dtype=this.dtype),e}disposeWeights(){return this.weights.forEach(e=>e.dispose()),this.weights.length}assertNotDisposed(){if(this._refCount===0)throw new Error(`Layer '${this.name}' is already disposed.`)}dispose(){if(!this.built)throw new Error(`Cannot dispose Layer ${this.name} because it has not been built yet.`);if(this._refCount===null)throw new Error(`Cannot dispose Layer ${this.name} because it has not been used yet.`);this.assertNotDisposed();let e=0;return--this._refCount===0&&(e=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:e}}}function p2e(t){t=ln(t);const e=[];for(const n of t)e.push(n.shape);return br(e)}function m2e(t){return"float32"}function BK(t,e,n){if((e==null||n!=null&&n>0)&&(e=t.sourceLayer,n=t.nodeIndex),e.inboundNodes.length===0)return[t];{const s=e.inboundNodes[n];if(s.inboundLayers.length===0)return s.inputTensors;{const r=[];for(let i=0;i<s.inboundLayers.length;i++){const o=s.inputTensors[i],a=s.inboundLayers[i],l=s.nodeIndices[i],c=BK(o,a,l);for(const u of c)r.indexOf(u)===-1&&r.push(u)}return r}}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class R0 extends $t{constructor(e){if(super({dtype:e.dtype,name:e.name!=null?e.name:JS("input").toString()}),e.batchSize==null&&(e.batchSize=null),e.sparse==null&&(e.sparse=!1),this.trainable=!1,this.built=!0,this.sparse=e.sparse,e.inputShape!=null&&e.batchInputShape!=null)throw new ee("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");let n=e.batchInputShape;if(n==null){if(e.inputShape==null)throw new ee("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");n=[e.batchSize].concat(e.inputShape)}else if(e.batchSize!=null)throw new ee("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");const s=e.dtype||"float32";this.batchInputShape=n,this.dtype=s,this.inputSpec=[{shape:n}];const r=new fa(this.dtype,this.batchInputShape,this,[],{},this.name);r.nodeIndex=0,r.tensorIndex=0,new tk({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[r],outputTensors:[r],inputMasks:[null],outputMasks:[null],inputShapes:[n],outputShapes:[n]})}apply(e,n){throw new ee(`Cannot pass any input to an InputLayer's apply() method. InputLayer name: ${this.name}`)}dispose(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}getConfig(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}}R0.className="InputLayer";ge(R0);function g2e(t){if(t.batchShape==null&&t.shape==null)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(t.batchShape!=null&&t.shape!=null)throw new ee("Please provide either a `shape` or `batchShape` argument to Input, but not both.");let e=t.batchShape;t.shape!=null&&e==null&&(e=[null].concat(t.shape));let n=t.dtype;return n==null&&(n="float32"),new R0({batchInputShape:e,name:t.name,dtype:n,sparse:t.sparse}).inboundNodes[0].outputTensors[0]}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function y2e(t,e){if(t.dtype==null||t.dtype===e.dtype)return e;try{return Te(e,t.dtype)}catch{throw new ee(`The dtype of the feed (${e.dtype}) can not be cast to the dtype of the key '${t.name}' (${t.dtype}).`)}}class lc{constructor(e){if(this.id2Value={},this.id2Mask={},this.name2Id={},e instanceof lc)for(const n in e.id2Value)this.id2Value[n]=e.id2Value[n],n in e.id2Mask&&(this.id2Mask[n]=e.id2Mask[n]);else{if(e==null)return;for(const n of e)this.add(n.key,n.value)}}add(e,n,s){if(this.id2Value[e.id]==null)this.id2Value[e.id]=y2e(e,n),this.name2Id[e.name]=e.id,s!=null&&(this.id2Mask[e.id]=s);else throw new ee(`Duplicate key: name=${e.name}, id=${e.id}`);return this}addFeed(e){this.add(e.key,e.value)}hasKey(e){return this.id2Value[e.id]!=null}names(){return Object.keys(this.name2Id)}getValue(e){if(e instanceof fa){if(this.id2Value[e.id]==null)throw new ee(`Nonexistent key: ${e.name}`);return this.id2Value[e.id]}else{const n=this.name2Id[e];if(n==null)throw new ee(`Feed dict has no SymbolicTensor name: ${e}`);return this.id2Value[n]}}getMask(e){if(e instanceof fa){if(this.id2Value[e.id]==null)throw new ee(`Nonexistent key: ${e.name}`);return this.id2Mask[e.id]}else{const n=this.name2Id[e];if(n==null)throw new ee(`Feed dict has no SymbolicTensor name: ${e}`);return this.id2Mask[n]}}disposeMasks(){this.id2Mask!=null&&rt(this.id2Mask)}}const cw=new TK,uw=new TK;function x2e(t){cw!=null&&cw.setMaxEntries(t),uw!=null&&uw.setMaxEntries(t)}function xm(t,e,n,s){const r=n==null?!1:n.training,i=Array.isArray(t),o=i?t:[t],a=o.map(p=>p.name),l=[],c=e.names();for(const p of a)c.indexOf(p)!==-1?l.push(e.getValue(p)):l.push(null);s!=null&&(s.maxNumTensors=-1/0,s.minNumTensors=1/0);const u=a.join(",")+"|"+e.names().sort().join(",");let d=cw.get(u),h;if(d==null){const p=v2e(o,e);d=p.sorted,h=p.recipientCounts,cw.put(u,d),uw.put(u,h)}h={},r||Object.assign(h,uw.get(u));const f=new lc(e);for(let p=0;p<d.length;++p){if(s!=null){const $=K2().numTensors;$>s.maxNumTensors&&(s.maxNumTensors=$),$<s.minNumTensors&&(s.minNumTensors=$)}const m=d[p],g=m.sourceLayer;if(g instanceof R0)continue;const y=[],x=[],v=[];let b=!1;for(const $ of m.inputs){const A=f.getValue($),P=f.getMask($);y.push(A),x.push(P),P!=null&&(b=!0),r||(h[$.name]--,h[$.name]===0&&!e.hasKey($)&&a.indexOf($.name)===-1&&!A.isDisposed&&$.sourceLayer.stateful!==!0&&v.push(A))}b&&(n=n||{},n.mask=x[0]);const k=ln(g.apply(y,n));let C=null;g.supportsMasking&&(C=g.computeMask(y,x));const N=w2e(m),I=Array.isArray(N)?N:[N];for(let $=0;$<I.length;++$){f.hasKey(I[$])||f.add(I[$],k[$],Array.isArray(C)?C[0]:C);const A=a.indexOf(I[$].name);A!==-1&&(l[A]=k[$])}r||rt(v)}return f.disposeMasks(),i?l:l[0]}function v2e(t,e){O(t!=null&&t.length>0,()=>"Expected at least one fetch, got none");let n=[],s={};if(t.length===1){const r=Wz(t[0],e);n=r.sorted,s=r.recipientMap}else{const r=new Set;for(const i of t){const{sorted:o,recipientMap:a}=Wz(i,e);for(const l of o)r.has(l.name)||(n.push(l),r.add(l.name));for(const l in a)s[l]==null&&(s[l]=new Set),a[l].forEach(c=>s[l].add(c))}}return{sorted:n,recipientCounts:b2e(s)}}function b2e(t){const e={};for(const n in t)e[n]=t[n].size;return e}function Wz(t,e){const n=new Set,s=[],r={};for(const a of e.names())n.add(a);const i=[],o=[];for(i.push(t);i.length>0;){const a=i[i.length-1];if(n.has(a.name)){i.pop();continue}const l=o[o.length-1]===i.length-1;if(a.inputs.length===0||l)i.pop(),s.push(a),n.add(a.name),l&&o.pop();else{o.push(i.length-1);for(const c of a.inputs)r[c.name]==null&&(r[c.name]=new Set),r[c.name].add(a.name),!n.has(c.name)&&i.push(c)}}return{sorted:s,recipientMap:r}}function w2e(t){let e;if(t.sourceLayer.inboundNodes.length===1)e=t.sourceLayer.output;else{let n=null;for(let s=0;s<t.sourceLayer.inboundNodes.length;++s)for(const r of t.sourceLayer.inboundNodes[s].outputTensors)if(r.id===t.id){n=s;break}e=t.sourceLayer.getOutputAt(n)}return e}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const S2e=oe();S2e.registerFlag("TOPOLOGICAL_SORT_CACHE_MAX_ENTRIES",()=>100,x2e);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function aD(t,e){return se(()=>Ys(Be(Y(t,t),e,!0)))}class D0 extends op{getConfig(){return{}}}class WK extends D0{constructor(e){super(),this.defaultMaxValue=2,this.defaultAxis=0,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return se(()=>{const n=aD(e,this.axis),s=Tr(n,0,this.maxValue);return Y(e,$e(s,fe(us(),n)))})}getConfig(){return{maxValue:this.maxValue,axis:this.axis}}}WK.className="MaxNorm";ge(WK);class UK extends D0{constructor(e){super(),this.defaultAxis=0,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return se(()=>$e(e,fe(us(),aD(e,this.axis))))}getConfig(){return{axis:this.axis}}}UK.className="UnitNorm";ge(UK);class HK extends D0{apply(e){return Pa(e)}}HK.className="NonNeg";ge(HK);class GK extends D0{constructor(e){super(),this.defaultMinValue=0,this.defaultMaxValue=1,this.defaultRate=1,this.defaultAxis=0,this.minValue=e.minValue!=null?e.minValue:this.defaultMinValue,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.rate=e.rate!=null?e.rate:this.defaultRate,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return se(()=>{const n=aD(e,this.axis),s=fe(Y(this.rate,Tr(n,this.minValue,this.maxValue)),Y(1-this.rate,n));return Y(e,$e(s,fe(us(),n)))})}getConfig(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}}GK.className="MinMaxNorm";ge(GK);const Uz={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function hs(t){return YR(t)}function Hz(t,e={}){return I0(t,qi.getMap().classNameMap,e,"constraint")}function fs(t){if(t==null)return null;if(typeof t=="string"){const n={className:t in Uz?Uz[t]:t,config:{}};return Hz(n)}else return t instanceof D0?t:Hz(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */async function bu(t){if(t==null)return;const e=[],n=[],s=[];for(const r in t){const i=t[r];if(typeof i!="number"){const o=i;e.push(o.data()),n.push(r),s.push(o)}}if(e.length>0){const r=await Promise.all(e);for(let i=0;i<r.length;++i)t[n[i]]=r[i][0];rt(s)}}function KK(t){if(t!=null)for(const e in t){const n=t[e];typeof n!="number"&&n.dispose()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var Gz;(function(t){t[t.SILENT=0]="SILENT",t[t.VERBOSE=1]="VERBOSE"})(Gz||(Gz={}));const k2e=125;class Ag{constructor(){this.validationData=null}setParams(e){this.params=e}async onEpochBegin(e,n){}async onEpochEnd(e,n){}async onBatchBegin(e,n){}async onBatchEnd(e,n){}async onTrainBegin(e){}async onTrainEnd(e){}setModel(e){}}class C2e{constructor(e,n=10){e==null&&(e=[]),this.callbacks=e,this.queueLength=n}append(e){this.callbacks.push(e)}setParams(e){for(const n of this.callbacks)n.setParams(e)}setModel(e){for(const n of this.callbacks)n.setModel(e)}async onEpochBegin(e,n){n==null&&(n={});for(const s of this.callbacks)await s.onEpochBegin(e,n)}async onEpochEnd(e,n){n==null&&(n={});for(const s of this.callbacks)await s.onEpochEnd(e,n)}async onBatchBegin(e,n){n==null&&(n={});for(const s of this.callbacks)await s.onBatchBegin(e,n)}async onBatchEnd(e,n){n==null&&(n={});for(const s of this.callbacks)await s.onBatchEnd(e,n)}async onTrainBegin(e){e==null&&(e={});for(const n of this.callbacks)await n.onTrainBegin(e)}async onTrainEnd(e){e==null&&(e={});for(const n of this.callbacks)await n.onTrainEnd(e)}}class T2e extends Ag{constructor(){super()}async onEpochBegin(e){this.seen=0,this.totals={}}async onBatchEnd(e,n){n==null&&(n={});const s=n.size==null?0:n.size;this.seen+=s;for(const r in n){const i=n[r];if(typeof i=="number")this.totals.hasOwnProperty(r)||(this.totals[r]=0),this.totals[r]=this.totals[r]+i*s;else{let o;r in this.totals?o=this.totals[r]:this.totals[r]=0;const a=se(()=>fe(this.totals[r],Y(i,s)));this.totals[r]=a,o!=null&&o.dispose()}}}async onEpochEnd(e,n){if(n!=null)for(const s of this.params.metrics)this.totals[s]!=null&&(typeof this.totals[s]=="number"?n[s]=this.totals[s]/this.seen:se(()=>{const r=Y($e(1,this.seen),this.totals[s]);n[s]=r,this.totals[s].dispose(),Ps(n[s])}))}}class N2e extends Ag{async onTrainBegin(e){this.epoch=[],this.history={}}async onEpochEnd(e,n){n==null&&(n={}),this.epoch.push(e);for(const s in n)this.history[s]==null&&(this.history[s]=[]),this.history[s].push(n[s])}async syncData(){const e=[],n=[],s=[];for(const i in this.history){const o=this.history[i];for(let a=0;a<o.length;++a)if(typeof o[a]!="number"){const l=o[a];e.push(l.data()),n.push(i),s.push(a)}}const r=await Promise.all(e);for(let i=0;i<r.length;++i)this.history[n[i]][s[i]].dispose(),this.history[n[i]][s[i]]=r[i][0]}}class I2e extends Ag{constructor(e,n){if(super(),this.currentEpoch=0,this.nowFunc=e.nowFunc,this.nextFrameFunc=e.nextFrameFunc||L8,this.yieldEvery=n||"auto",this.yieldEvery==="auto"&&(this.yieldEvery=k2e),this.yieldEvery==="never"&&e.onYield!=null)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");I2(this.yieldEvery)&&(this.maybeWait=BNe(this.maybeWait.bind(this),this.yieldEvery,this.nowFunc)),this.trainBegin=e.onTrainBegin,this.trainEnd=e.onTrainEnd,this.epochBegin=e.onEpochBegin,this.epochEnd=e.onEpochEnd,this.batchBegin=e.onBatchBegin,this.batchEnd=e.onBatchEnd,this.yield=e.onYield}async maybeWait(e,n,s){const r=[];this.yield!=null&&(await bu(s),r.push(this.yield(e,n,s))),r.push(this.nextFrameFunc()),await Promise.all(r)}async onEpochBegin(e,n){this.currentEpoch=e,this.epochBegin!=null&&(await bu(n),await this.epochBegin(e,n))}async onEpochEnd(e,n){const s=[];this.epochEnd!=null&&(await bu(n),s.push(this.epochEnd(e,n))),this.yieldEvery==="epoch"&&s.push(this.nextFrameFunc()),await Promise.all(s)}async onBatchBegin(e,n){this.batchBegin!=null&&(await bu(n),await this.batchBegin(e,n))}async onBatchEnd(e,n){const s=[];this.batchEnd!=null&&(await bu(n),s.push(this.batchEnd(e,n))),this.yieldEvery==="batch"?s.push(this.nextFrameFunc()):I2(this.yieldEvery)&&s.push(this.maybeWait(this.currentEpoch,e,n)),await Promise.all(s)}async onTrainBegin(e){this.trainBegin!=null&&(await bu(e),await this.trainBegin(e))}async onTrainEnd(e){this.trainEnd!=null&&(await bu(e),await this.trainEnd(e))}}function qK(t,e){return t==null&&(t={}),t instanceof Ag?[t]:Array.isArray(t)&&t[0]instanceof Ag?t:ln(t).map(s=>new I2e(s,e))}class Bi{constructor(){}static registerCallbackConstructor(e,n){O(e>=0&&Number.isInteger(e),()=>`Verbosity level is expected to be an integer >= 0, but got ${e}`),Bi.checkForDuplicate(n),Bi.constructors[e]==null&&(Bi.constructors[e]=[]),Bi.constructors[e].push(n)}static checkForDuplicate(e){for(const n in Bi.constructors)Bi.constructors[+n].forEach(r=>{if(r===e)throw new ee("Duplicate callback constructor.")})}static clear(){Bi.constructors={}}static createCallbacks(e){const n=[];for(const s in Bi.constructors){const r=+s;e>=r&&n.push(...Bi.constructors[r])}return n.map(s=>new s)}}Bi.constructors={};function XK(t,e,n,s,r,i,o,a,l){const c=new N2e,u=[new T2e,...Bi.createCallbacks(e)];t!=null&&u.push(...t),u.push(c);const d=new C2e(u);return d.setParams({epochs:n,initialEpoch:s,samples:r,steps:i,batchSize:o,verbose:e,doValidation:a,metrics:l}),{callbackList:d,history:c}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Ta(t,e={},n=!1){return I0(t,qi.getMap().classNameMap,e,"layer",n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function dw(t,e){return se(()=>{t.dtype!=="float32"&&(t=Te(t,"float32"));const n=Be($0(t),e,!0),s=ap(n.shape,us()),r=Ys(Oa(n,s));return $e(t,r)})}function nk(t,e){return se(()=>Dn($0(Ae(e,t)),-1))}function lD(t,e){return se(()=>Dn(os(Ae(e,t)),-1))}function cD(t,e){return se(()=>{const n=Ae(t,e),s=Tr(os(t),us(),Number.MAX_VALUE),r=os($e(n,s));return Y(100,Dn(r,-1))})}function _2e(t,e){return se(()=>{const n=Tr(e,us(),Number.MAX_VALUE),s=Ti(fe(1,n)),r=Tr(t,us(),Number.MAX_VALUE),i=Ti(fe(1,r));return Dn($0(Ae(s,i)),-1)})}function E2e(t,e){return se(()=>{const n=Oa(0,Ae(1,Y(t,e)));return Dn($0(n),-1)})}function $2e(t,e){return se(()=>{const n=Oa(0,Ae(1,Y(t,e)));return Dn(n,-1)})}function A2e(t,e){return se(()=>{const n=Be(Y(t,e),-1),s=ro(Y(Ae(1,t),e),-1);return Oa(0,fe(1,Ae(s,n)))})}function R2e(t,e){return se(()=>{const n=Math.log(2),s=Ae(e,t),r=Ae(fe(s,lp(Y(-2,s))),n);return Dn(r,-1)})}function Rg(t,e,n=!1){return se(()=>{if(n)e=jS(e);else{const s=Be(e,e.shape.length-1,!0);e=$e(e,s)}return e=Tr(e,us(),1-us()),vn(Be(Y(Te(t,"float32"),Ti(e)),e.shape.length-1))})}function hw(t,e,n=!1){return se(()=>{const s=Te(w0(e2e(t)),"int32");e=Tr(e,us(),1-us());const r=e.shape,i=Q(IA(s,r[r.length-1]),r);return Rg(i,e,n)})}function D2e(t,e){if(!Et(t.shape,e.shape))throw new ee(`logits and labels must have the same shape, but got shapes ${JSON.stringify(t.shape)} and ${JSON.stringify(e.shape)}`);return se(()=>{const n=Pa(e),s=vn(os(e));return fe(Ae(n,Y(e,t)),RS(Ir(s)))})}function sk(t,e){return se(()=>{let n;return n=Tr(e,us(),1-us()),n=Ti($e(n,Ae(1,n))),Dn(D2e(t,n),-1)})}function O2e(t,e){return se(()=>{const n=Tr(t,us(),1),s=Tr(e,us(),1);return Be(Y(t,Ti($e(n,s))),-1)})}function P2e(t,e){return se(()=>{const n=Ti(fe(us(),e));return Dn(Ae(e,Y(t,n)),-1)})}function YK(t,e){return se(()=>{const n=dw(t,-1),s=dw(e,-1),r=Y(n,s);return vn(Be(r,-1))})}const fw={meanSquaredError:nk,meanAbsoluteError:lD,meanAbsolutePercentageError:cD,meanSquaredLogarithmicError:_2e,squaredHinge:E2e,hinge:$2e,categoricalHinge:A2e,logcosh:R2e,categoricalCrossentropy:Rg,sparseCategoricalCrossentropy:hw,binaryCrossentropy:sk,kullbackLeiblerDivergence:O2e,poisson:P2e,cosineProximity:YK};function aT(t){if(typeof t=="string"){if(t in fw)return fw[t];let e=`Unknown loss ${t}`;throw t.toLowerCase().includes("softmaxcrossentropy")&&(e=`Unknown loss ${t}. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy`),new ee(e)}else return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function ZK(t,e){return se(()=>{const n=Y(.5,Ni(e)),s=_0(Ei(e,n),t.dtype);return Dn(Mo(t,s),-1)})}function QK(t,e){return se(()=>_0(Mo(Sd(t,-1),Sd(e,-1)),"float32"))}function F2e(t,e){return se(()=>Te(Be(Ea(Mo(t,1),Mo(e,1))),"float32"))}function L2e(t,e){return se(()=>Te(Be(Ea(Mo(t,0),Mo(e,1))),"float32"))}function M2e(t,e){return se(()=>{const n=F2e(t,e),s=L2e(t,e),r=fe(n,s);return Te(Nr(Ei(r,0),$e(n,r),0),"float32")})}function z2e(t,e){return sk(t,e)}function V2e(t,e){return t.rank===e.rank&&(t=Bt(t,[t.rank-1])),e=Sd(e,-1),e.dtype!==t.dtype&&(e=Te(e,t.dtype)),Te(Mo(t,e),"float32")}const j2e=nk,B2e=nk,W2e=lD,U2e=lD,H2e=cD,G2e=cD,JK=Rg,K2e=YK,eq=hw,pw={binaryAccuracy:ZK,categoricalAccuracy:QK,precision:M2e,categoricalCrossentropy:JK,sparseCategoricalCrossentropy:eq,mse:j2e,MSE:B2e,mae:W2e,MAE:U2e,mape:H2e,MAPE:G2e,cosine:K2e};function q2e(t){if(typeof t=="string"&&t in pw)return pw[t];if(typeof t!="string"&&t!=null)return t;throw new ee(`Unknown metric ${t}`)}function qx(t){if(ra(t!==null,`Unknown LossOrMetricFn ${t}`),typeof t=="string")return t;{let e;for(const n of Object.keys(fw))if(fw[n]===t){e=n;break}if(e!==void 0)return e;for(const n of Object.keys(pw))if(pw[n]===t){e=n;break}return e!==void 0?e:t.name}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function X2e(t){const e={Adagrad:()=>th.adagrad(.01),Adadelta:()=>th.adadelta(1,.95,us()),Adam:()=>th.adam(.001,.9,.999,us()),Adamax:()=>th.adamax(.002,.9,.999,us(),0),RMSProp:()=>th.rmsprop(.001,.9,0,us()),SGD:()=>th.sgd(.01)};if(e.adagrad=e.Adagrad,e.adadelta=e.Adadelta,e.adam=e.Adam,e.adamax=e.Adamax,e.rmsprop=e.RMSProp,e.sgd=e.SGD,t in e)return e[t]();throw new ee(`Unknown Optimizer ${t}`)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Kz=1*1024*1024;function qz(t,e,n=!1){if(t==null||typeof t!="object"||Object.getPrototypeOf(t)!==Object.prototype||!vI(t))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(n){const s=JSON.stringify(t);s.length>Kz&&console.warn(`User-defined metadata of model "${e}" is too large in size (length=${s.length} when serialized). It is not recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= ${Kz}.`)}}function vI(t){if(t===null)return!0;if(typeof t=="object")if(Object.getPrototypeOf(t)===Object.prototype){const e=Object.keys(t);for(const n of e)if(typeof n!="string"||!vI(t[n]))return!1;return!0}else if(Array.isArray(t)){for(const e of t)if(!vI(e))return!1;return!0}else return!1;else{const e=typeof t;return e==="string"||e==="number"||e==="boolean"}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Y2e(t,e,n,s=console.log){const r=Q2e(t),i=["Layer (type)","Input Shape","Output shape","Param #"];r?(e=e||90,n=n||[.32,.61,.89,1]):(e=e||115,n=n||[.24,.48,.7,.8,1]),n[n.length-1]<=1&&(n=n.map(u=>Math.floor(e*u)));let o;if(!r){i.push("Receives inputs"),o=[];for(const u in t.nodesByDepth)o.push(...t.nodesByDepth[u])}s("_".repeat(e)),mw(i,n,s),s("=".repeat(e));const a=t.layers;for(let u=0;u<a.length;++u)r?J2e(a[u],n,s):eIe(a[u],n,o,s),s((u===a.length-1?"=":"_").repeat(e));t.checkTrainableWeightsConsistency();const l=Z2e(t),c=lw(t.nonTrainableWeights);s(`Total params: ${l+c}`),s(`Trainable params: ${l}`),s(`Non-trainable params: ${c}`),s("_".repeat(e))}function Z2e(t){let e;return t.collectedTrainableWeights!=null?e=lw(t.collectedTrainableWeights):e=lw(t.trainableWeights),e}function Q2e(t){let e=!0;const n=[],s=[];for(const r in t.nodesByDepth)n.push(t.nodesByDepth[r]);for(const r of n){if(r.length>1||r.length===1&&r[0].inboundLayers.length>1){e=!1;break}s.push(...r)}if(e)for(const r of t.layers){let i=!1;for(const o of r.inboundNodes)if(s.indexOf(o)!==-1)if(i){e=!1;break}else i=!0;if(!e)break}return e}function mw(t,e,n=console.log){let s="";for(let r=0;r<t.length;++r)r>0&&(s=s.slice(0,s.length-1)+" "),s+=t[r],s=s.slice(0,e[r]),s+=" ".repeat(e[r]-s.length);n(s)}function J2e(t,e,n){let s,r;try{r=t.inboundNodes.map(l=>JSON.stringify(l.inputShapes)).join(",")}catch{r="multiple"}try{s=JSON.stringify(t.outputShape)}catch{s="multiple"}const i=t.name,o=t.getClassName(),a=[`${i} (${o})`,r,s,t.countParams().toString()];mw(a,e,n)}function eIe(t,e,n,s){let r,i;try{i=t.inboundNodes.map(d=>JSON.stringify(d.inputShapes)).join(",")}catch{i="multiple"}try{r=JSON.stringify(t.outputShape)}catch{r="multiple"}const o=[];for(const d of t.inboundNodes)if(!(n!=null&&n.length>0&&n.indexOf(d)===-1))for(let h=0;h<d.inboundLayers.length;++h){const f=d.inboundLayers[h].name,p=d.nodeIndices[h],m=d.tensorIndices[h];o.push(`${f}[${p}][${m}]`)}const a=t.name,l=t.getClassName(),c=o.length===0?"":o[0],u=[`${a} (${l})`,i,r,t.countParams().toString(),c];mw(u,e,s);for(let d=1;d<o.length;++d)mw(["","","","",o[d]],e,s)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function tq(t,e,n){return(t==="inboundNodes"||t==="outputLayers"||t==="inputLayers")&&e===0&&typeof n=="string"}function gw(t,e){if(t===null)return null;if(typeof t=="string")return Eu(t);if(typeof t=="number"||typeof t=="boolean")return t;if(t instanceof Array){const n=[],s=t.length;for(let r=0;r<s;++r){const i=t[r];tq(e,r,i)?n.push(i):n.push(gw(i,e))}return n}else{const n={};for(const s of Object.keys(t)){const r=t[s];if(s==="name"&&typeof r=="string")n[s]=r;else{const i=Eu(s);n[i]=gw(r,i)}}return n}}function bI(t,e){if(t==null)return null;if(typeof t=="string")return Xa(t);if(typeof t=="number"||typeof t=="boolean")return t;if(t instanceof Array){const n=[],s=t.length;for(let r=0;r<s;++r){const i=t[r];tq(e,r,i)?n.push(i):n.push(bI(i,e))}return n}else{const n={};for(const s of Object.keys(t)){const r=t[s],i=Xa(s);(s==="name"||s==="className")&&typeof r=="string"?n[i]=r:n[i]=bI(r,s)}return n}}/** @license See the LICENSE file. */const nq="3.21.0";/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class vo extends $t{constructor(e){if(super({}),this.containerNodes=new Set,this.name=e.name,this.name==null){const x=this.getClassName().toLowerCase();this.name=JS(x)}if(this.supportsMasking=!1,this.trainable_=!0,Array.isArray(e.inputs)?this.inputs=e.inputs.slice():this.inputs=[e.inputs],Array.isArray(e.outputs)?this.outputs=e.outputs.slice():this.outputs=[e.outputs],Nc(this.inputs).length!==this.inputs.length)throw new ee(`The list of inputs passed to the model is redundant. All inputs should only appear once. Found: ${this.inputs.map(x=>x.name)}`);Nc(this.outputs).length!==this.outputs.length&&console.warn(`The list of outputs passed to the model is redundant. All outputs should only appear once. Found: ${this.outputs.map(x=>x.name)}`),this.inputLayers=[],this.inputLayersNodeIndices=[],this.inputLayersTensorIndices=[],this.outputLayers=[],this.outputLayersNodeIndices=[],this.outputLayersTensorIndices=[],this.layers=[],this.internalContainerRefs=[];for(const x of this.outputs){const v=x.sourceLayer,b=x.nodeIndex,k=x.tensorIndex;this.outputLayers.push(v),this.outputLayersNodeIndices.push(b),this.outputLayersTensorIndices.push(k)}for(const x of this.inputs){const v=x.sourceLayer,b=x.nodeIndex,k=x.tensorIndex;ra(b===0,"input layer has >1 nodes"),ra(k===0,"input layer has >1 tensors"),this.inputLayers.push(v),this.inputLayersNodeIndices.push(b),this.inputLayersTensorIndices.push(k)}this.inputNames=[],this.outputNames=[],this.feedInputShapes=[],this.feedInputNames=[],this.feedOutputNames=[];for(let x=0;x<this.inputLayers.length;x++){const v=this.inputLayers[x];if(!(v instanceof R0))throw new TypeError(`Input layers to a LayersModel must be InputLayer objects. Received inputs: ${e.inputs}. Input ${x} (0-based) originates from layer type ${v.getClassName()}.`);this.inputNames.push(v.name),this.feedInputShapes.push(v.batchInputShape),this.feedInputNames.push(v.name)}for(const x of this.outputLayers)this.outputNames.push(x.name);this.internalInputShapes=this.inputs.map(x=>x.shape),this.internalOutputShapes=this.outputs.map(x=>x.shape);const n={},s={},r={},i={},o={},a=[],l=(x,v,b,k,C,N)=>{(k==null||C==null||N==null)&&(k=x.sourceLayer,C=x.nodeIndex,N=x.tensorIndex);const I=k.inboundNodes[C];if(b.indexOf(I)!==-1)throw new eo(`The tensor ${x.name} at layer "${k.name}" is part of a cycle.`);if(v.indexOf(I)!==-1)return;this.containerNodes.add(vo.nodeKey(k,C)),k.id in o||(o[k.id]=Object.keys(o).length),b.indexOf(I)===-1&&b.push(I);const $=I.inboundLayers.length;for(let A=0;A<$;A++){const P=I.inputTensors[A],F=I.inboundLayers[A],V=I.nodeIndices[A],z=I.tensorIndices[A];l(P,v,b,F,V,z)}for(v.push(I);b.indexOf(I)>=0;)b.splice(b.indexOf(I),1);a.push(I)},c=[],u=[];for(const x of this.outputs)l(x,c,u);const d=a.slice().reverse();for(const x of d){s[x.id]=x,x.id in n||(n[x.id]=0);let v=n[x.id];const b=r[x.outboundLayer.id]==null?0:r[x.outboundLayer.id];v=Math.max(v,b),r[x.outboundLayer.id]=v,i[x.outboundLayer.id]=x.outboundLayer,n[x.id]=v;for(let k=0;k<x.inboundLayers.length;k++){const C=x.inboundLayers[k],N=x.nodeIndices[k],I=C.inboundNodes[N],$=n[I.id]==null?0:n[I.id];n[I.id]=Math.max(v+1,$),s[I.id]=I}}const h={};for(const x in n){const v=n[x];v in h||(h[v]=[]),h[v].push(s[x])}const f={};for(const x in r){const v=r[x];v in f||(f[v]=[]),f[v].push(i[x])}let p=Object.keys(f).map(x=>parseInt(x,10)).sort(Hx);this.layers=[];for(const x of p){const v=f[x];v.sort((b,k)=>{const C=o[b.id],N=o[k.id];return C<N?-1:C>N?1:0});for(const b of v)b instanceof vo&&this.internalContainerRefs.push(b),this.layers.push(b)}this.layersByDepth=f,p=Object.keys(h).map(x=>parseInt(x,10)).sort(Hx);const m=this.inputs.slice(),g=[];for(const x of p)for(const v of h[x]){const b=v.outboundLayer;if(b!=null){for(const k of v.inputTensors)if(m.indexOf(k)===-1)throw new eo(`Graph disconnected: cannot obtain value for tensor ${k} at layer "${b.name}". The following previous layers were accessed without issue: ${g}`);for(const k of v.outputTensors)m.push(k);g.push(b.name)}}this.nodesByDepth=h;const y=this.layers.map(x=>x.name);for(const x of y){const v=y.filter(b=>b===x).length;if(v!==1)throw new eo(`The name "${x}" is used ${v} times in the model. All layer names should be unique. Layer names: `+JSON.stringify(y))}this.outboundNodes=[],this.inboundNodes=[],new tk({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:this.inputs.map(x=>null),outputMasks:this.outputs.map(x=>null),inputShapes:this.inputs.map(x=>x.shape),outputShapes:this.outputs.map(x=>x.shape)}),this.built=!0,this._refCount=1}assertNotDisposed(){if(this._refCount===0)throw new Error(`Container '${this.name}' is already disposed.`)}dispose(){this.assertNotDisposed();const e={refCountAfterDispose:null,numDisposedVariables:0};if(--this._refCount===0){for(const n of this.layers)e.numDisposedVariables+=n.dispose().numDisposedVariables;for(const n of this.internalContainerRefs)e.numDisposedVariables+=n.dispose().numDisposedVariables}return e.refCountAfterDispose=this._refCount,e}get trainable(){return this.trainable_}set trainable(e){this.layers.forEach(n=>{n._trainableWeights.forEach(s=>s.trainable=e)}),this.trainable_=e}get trainableWeights(){if(this._trainableWeights.length>0)throw new ee("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];let e=[];for(const n of this.layers)e=e.concat(n.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const n of this.layers)e.push(...n.nonTrainableWeights);if(!this.trainable){const n=[];for(const s of this.layers)n.push(...s.trainableWeights);return n.concat(e)}return e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}loadWeights(e,n=!0){const s={};let r=0;for(const o of this.layers)for(const a of o.weights){if(s[a.originalName]!=null)throw new ee(`Duplicate weight name: ${a.originalName}`);s[a.originalName]=a,r++}const i=[];for(const o in e){let a=o;if(s[o]==null){const l=o.split("/");a=l.slice(0,-2).concat([l[l.length-1]]).join("/")}if(s[a]!=null)i.push([s[a],e[o]]);else if(n)throw new ee(`Provided weight data has no target variable: ${o}`);delete s[a]}if(n){const o=[];for(const a in s)o.push(a);if(o.length>0)throw new ee(`${o.length} of ${r} weights are not set: ${o}`)}oD(i)}updatedConfig(){const e=this.getConfig(),n={};return n.className=this.getClassName(),n.config=e,n.kerasVersion=`tfjs-layers ${nq}`,n.backend="TensorFlow.js",n}toJSON(e,n=!0){const s=bI(this.updatedConfig());return n?JSON.stringify(s):s}call(e,n){return se(()=>{e=ln(e);const s=new lc;for(let r=0;r<this.inputs.length;++r)s.add(this.inputs[r],e[r]);return xm(this.outputs,s,n)})}computeMask(e,n){return se(()=>{e=ln(e);let s;return n==null?s=Nd(null,e.length):s=ln(n),this.runInternalGraph(e,s)[1]})}computeOutputShape(e){const n=aw(e);if(n.length!==this.inputLayers.length)throw new ee(`Invalid inputShape argument ${e}: model has ${this.inputLayers.length} tensor inputs.`);const s={};for(let a=0;a<n.length;a++){const l=this.inputLayers[a],c=n[a],u=l.name+"_0_0";s[u]=c}const r=Object.keys(this.nodesByDepth).map(a=>parseInt(a,10)).sort(Hx);if(r.length>1)for(const a of r){const l=this.nodesByDepth[a];for(const c of l){const u=c.outboundLayer;if(this.inputLayers.map(m=>m.id).indexOf(u.id)!==-1)continue;const d=[];for(let m=0;m<c.inboundLayers.length;m++){const g=c.inboundLayers[m],y=c.nodeIndices[m],x=c.tensorIndices[m],v=`${g.name}_${y}_${x}`,b=s[v];d.push(b)}const h=u.computeOutputShape(br(d)),f=aw(h),p=u.inboundNodes.indexOf(c);for(let m=0;m<f.length;m++){const g=`${u.name}_${p}_${m}`;s[g]=f[m]}}}const i=[],o=[];for(let a=0;a<this.outputLayers.length;a++){const l=this.outputLayers[a],c=this.outputLayersNodeIndices[a],u=this.outputLayersTensorIndices[a],d=`${l.name}_${c}_${u}`;o.push(d)}for(let a=0;a<o.length;a++){const l=o[a];ra(l in s),i.push(s[l])}return br(i)}runInternalGraph(e,n){n==null&&(n=Nd(null,e.length));const s={};for(let l=0;l<this.inputs.length;++l){const c=this.inputs[l],u=e[l],d=n[l];s[c.id]=[u,d]}const r=Object.keys(this.nodesByDepth).map(l=>parseInt(l,10)).sort(Hx);for(const l of r){const c=this.nodesByDepth[l];for(const u of c){const d=u.outboundLayer,h=u.inputTensors,f=u.outputTensors,p=new Array;for(const m of h)m.id in s&&p.push(s[m.id]);if(p.length===h.length){let m={},g,y,x,v;if(u.callArgs!=null&&(m=u.callArgs),p.length===1){const[b,k]=p[0];m.mask==null&&(m.mask=k),x=ln(d.call(b,m)),v=ln(d.computeMask(b,k)),g=[b],y=[k]}else g=p.map(b=>b[0]),y=p.map(b=>b[1]),m.mask==null&&(m.mask=y),x=ln(d.call(g,m)),v=ln(d.computeMask(g,y));if(d.activityRegularizer)throw new ft("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(let b=0;b<f.length;++b){const k=f[b],C=x[b],N=v[b];s[k.id]=[C,N]}}}}const i=[],o=[],a=[];for(const l of this.outputs){ra(l.id in s,`Could not compute output ${l.name} : ${l.id}`);const[c,u]=s[l.id];a.push(c.shape),i.push(c),o.push(u)}return[i,o,a]}buildNodeConversionMap(e){const n={};let s;for(const r of this.layers){s=r instanceof vo?1:0;for(let i=0;i<r.inboundNodes.length;i++){const o=vo.nodeKey(r,i);this.containerNodes.has(o)&&(n[o]=s,s+=1)}}return n}getLayer(e,n){if(n!=null){if(this.layers.length<=n)throw new ee(`Was asked to retrieve layer at index ${n}, but model only has ${this.layers.length} layer(s).`);return this.layers[n]}else if(e==null)throw new ee("Provide either a layer name or layer index");for(const s of this.layers)if(s.name===e)return s;throw new ee(`No such layer: ${e}`)}calculateLosses(){return se(()=>{const e=[];for(const n of this.layers)for(let s=0;s<n.inboundNodes.length;++s){const r=vo.nodeKey(n,s);this.containerNodes.has(r)&&e.push(...n.calculateLosses())}return e})}getConfig(){const e={name:this.name},n=this.buildNodeConversionMap(this.layers),s=[];for(const o of this.layers){const a=o.getClassName(),l=o.getConfig(),c=[];for(let d=0;d<o.inboundNodes.length;d++){const h=o.inboundNodes[d],f=vo.nodeKey(o,d);let p={};if(this.containerNodes.has(f)){if(h.callArgs)try{JSON.stringify(h.callArgs),p=h.callArgs}catch{console.warn(`Layer ${o.name} was passed non-serializable keyword arguments: ${h.callArgs}. They will not be included in the serialized model (and thus will be missing at deserialization time).`),p={}}if(h.inboundLayers.length>0){const m=[];for(let g=0;g<h.inboundLayers.length;g++){const y=h.inboundLayers[g],x=h.nodeIndices[g],v=h.tensorIndices[g],b=vo.nodeKey(y,x);let k=n[b];k==null&&(k=0),m.push([y.name,k,v,p])}c.push(m)}}}const u={};u.name=o.name,u.className=a,u.config=l,u.inboundNodes=c,s.push(u)}e.layers=s;const r=[];for(let o=0;o<this.inputLayers.length;o++){const a=this.inputLayers[o],l=this.inputLayersNodeIndices[o],c=vo.nodeKey(a,l);if(!this.containerNodes.has(c))continue;let u=n[c];u==null&&(u=0);const d=this.inputLayersTensorIndices[o];r.push([a.name,u,d])}e.inputLayers=r;const i=[];for(let o=0;o<this.outputLayers.length;o++){const a=this.outputLayers[o],l=this.outputLayersNodeIndices[o],c=vo.nodeKey(a,l);if(!this.containerNodes.has(c))continue;let u=n[c];u==null&&(u=0);const d=this.outputLayersTensorIndices[o];i.push([a.name,u,d])}return e.outputLayers=i,e}static fromConfig(e,n,s={},r=!1){const i={},o={};function a(g,y){g.name in o?o[g.name].push(y):o[g.name]=[y]}function l(g,y){const x=[];let v;for(const b of y){const k=b[0],C=b[1],N=b[2];if(v=b[3]==null?{}:b[3],!(k in i)){a(g,y);return}const I=i[k];if(I.inboundNodes.length<=C){a(g,y);return}const $=I.inboundNodes[C];x.push($.outputTensors[N])}x.length>0&&g.apply(br(x),v)}function c(g){const y=g.name,x=Ta(g,n.customObjects!=null?n.customObjects:{});x.setFastWeightInitDuringBuild(r),i[y]=x,g.inboundNodes.forEach(b=>{if(!(b instanceof Array))throw new ee(`Corrupted configuration, expected array for nodeData: ${b}`);a(x,b)})}const u=n.name,d=n.layers;for(const g of d)c(g);for(;!jNe(o);)for(const g of d){const y=i[g.name];if(y.name in o){const x=o[y.name];delete o[y.name];for(const v of x)l(y,v)}}const h=[],f=[],p=n.inputLayers;for(const g of p){const y=g[0],x=g[1],v=g[2];ra(y in i);const k=i[y].inboundNodes[x].outputTensors;h.push(k[v])}const m=n.outputLayers;for(const g of m){const y=g[0],x=g[1],v=g[2];ra(y in i);const k=i[y].inboundNodes[x].outputTensors;f.push(k[v])}return new e({inputs:h,outputs:f,name:u})}get stateful(){if(this._stateful)throw new ee("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(const e of this.layers)if(e.stateful)return!0;return!1}resetStates(){se(()=>{this.layers.forEach(e=>{e.stateful&&e.resetStates()})})}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function tIe(t,e,n){const s=e.length;if(t==null||Array.isArray(t)&&t.length===0)return e.map(r=>null);if(s===1)return Array.isArray(t)&&t.length===1?t:typeof t=="object"&&e[0]in t?[t[e[0]]]:[t];if(Array.isArray(t)){if(t.length!==s)throw new Error(`Provided ${n} is an array of ${t.length} element(s), but the model has ${s} outputs. Make sure a set of weights is provided for each model output.`);return t}else if(typeof t=="object"&&Object.keys(t).length>0&&typeof t[Object.keys(t)[0]]=="object"){const r=[];return e.forEach(i=>{i in t?r.push(t[i]):r.push(null)}),r}else throw new Error(`The model has multiple (${s}) outputs, so ${n} must be either an array with ${s} elements or an object with ${e} keys. Provided ${n} not understood: ${JSON.stringify(t)}`)}function sq(t,e){return tIe(t,e,"classWeight")}async function rq(t,e,n,s){if(e!=null||s!=null)throw new Error("Support sampleWeight is not implemented yet");if(n!=null){const r=se(()=>{if(t.shape.length===1)return ll(t);if(t.shape.length===2){if(t.shape[1]>1)return Sd(t,1);if(t.shape[1]===1)return Q(t,[t.shape[0]]);throw new Error(`Encountered unexpected last-dimension size (${t.shape[1]}) during handling of class weights. The size is expected to be >= 1.`)}else throw new Error(`Unexpected rank of target (y) tensor (${t.rank}) during handling of class weights. The rank is expected to be 1 or 2.`)}),i=Array.from(await r.data());rt(r);const o=[];return i.forEach(a=>{if(n[a]==null)throw new Error(`classWeight must contain all classes in the training data. The class ${a} exists in the data but not in classWeight`);o.push(n[a])}),cs(o,"float32")}else return null}function nIe(t,e){return Y(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const sIe=32;function iq(t,e){let n,s;const r=e;n=r.xs,s=r.ys,O(n!=null&&s!=null,()=>`A Dataset iterator for fitDataset() is expected to generate objects of the form \`{xs: xVal, ys: yVal}\`, where the two values may be \`tf.Tensor\`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates ${e}`);const i=Xz("input",t.inputNames,n),o=Xz("output",t.outputNames,s),a=i[0].shape[0];O(i.length===t.inputs.length,()=>`LayersModel has ${t.inputs.length} inputs, but the dataset provides ${i.length} inputs.  (Expected input keys: ${JSON.stringify(t.inputNames)})`),O(o.length===t.outputs.length,()=>`LayersModel has ${t.outputs.length} outputs, but the dataset provides ${o.length} outputs.  (Expected output keys: ${JSON.stringify(t.outputNames)})`);for(let l=0;l<i.length;l++)O(i[l].shape[0]===a,()=>`Batch size mismatch: input ${t.inputNames[l]} has ${i[l].shape[0]}; expected  ${a} based on input ${t.inputNames[0]}.`);for(let l=0;l<o.length;l++)O(o[l].shape[0]===a,()=>`Batch size mismatch: output ${t.outputNames[l]} has ${o[l].shape[0]}; expected  ${a} based on input ${t.inputNames[0]}.`);return{xs:i,ys:o}}function Xz(t,e,n){if(n instanceof Yt)return[n];if(Array.isArray(n))return O(n.length===e.length,()=>`Received an array of ${n.length} Tensors, but expected ${e.length} to match the ${t} keys ${e}.`),n;{const s=[];for(const r of e){if(n[r]==null)throw new ee(`The feature data generated by the dataset lacks the required ${t} key '${r}'.`);s.push(n[r])}return s}}function rIe(t){if(t.length===3)throw new ft("Validation with sample weights is not implemented yet.");return{xs:t[0],ys:t[1]}}async function iIe(t,e,n){const s=n.batchesPerEpoch!=null;if(O(t.optimizer!=null,()=>"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."),O(n!=null,()=>"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."),O(n.epochs!=null&&n.epochs>0&&Number.isInteger(n.epochs),()=>`For fitDataset(), config.epochs is expected to be a positive integer, but got ${n.epochs}`),O(!s||n.batchesPerEpoch>0&&Number.isInteger(n.batchesPerEpoch),()=>`For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got ${n.batchesPerEpoch}`),O(n.validationSplit==null,()=>"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."),t.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");t.isTraining=!0;try{const r=n.validationData!=null;let i,o;if(r)if(Yz(n.validationData))O(n.validationBatches==null||n.validationBatches>0&&Number.isInteger(n.validationBatches),()=>`For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got ${n.validationBatches}`);else{const g=rIe(n.validationData);i=g.xs,o=g.ys}const a=t.makeTrainFunction(),l=t.getDedupedMetricsNames();let c;r?c=l.slice().concat(l.map(g=>"val_"+g)):c=l.slice();const u=qK(n.callbacks,n.yieldEvery),d=n.verbose==null?1:n.verbose,{callbackList:h,history:f}=XK(u,d,n.epochs,null,null,oIe(e,n),null,r,c);h.setModel(t),t.history=f,await h.onTrainBegin(),t.stopTraining_=!1;let p=n.initialEpoch==null?0:n.initialEpoch,m=await e.iterator();for(;p<n.epochs;){const g={};await h.onEpochBegin(p);let y=0,x=0;for(s||(m=await e.iterator());!s||y<n.batchesPerEpoch;){const v=await m.next();if(s&&v.done){console.warn(`You provided \`batchesPerEpoch\` as ${n.batchesPerEpoch}, but your dataset iterator ran out of data after ${y} batches; interrupting training. Make sure that your dataset can generate at least \`batchesPerEpoch * epochs\` batches (in this case, ${n.batchesPerEpoch*n.epochs} batches). You may need to use the repeat() function when building your dataset.`);break}if(v.value!=null){const{xs:b,ys:k}=iq(t,v.value),C={};C.batch=x,C.size=b[0].shape[0],await h.onBatchBegin(x,C);const N=[];if(n.classWeight!=null){const A=sq(n.classWeight,t.outputNames);for(let P=0;P<A.length;++P)N.push(await rq(k[P],null,A[P]))}const I=b.concat(k).concat(N),$=a(I);rt(I);for(let A=0;A<l.length;++A){const P=l[A],F=$[A];C[P]=F,Ps(F)}await h.onBatchEnd(x,C),KK(C),x++,y++}if(s?y>=n.batchesPerEpoch:v.done){if(r){let b;Yz(n.validationData)?b=ln(await t.evaluateDataset(n.validationData,{batches:n.validationBatches})):b=ln(t.evaluate(i,o,{batchSize:n.validationBatchSize==null?sIe:n.validationBatchSize,verbose:0}));for(let k=0;k<t.metricsNames.length;++k)g[`val_${t.metricsNames[k]}`]=b[k]}break}if(t.stopTraining_)break}if(await h.onEpochEnd(p,g),p++,t.stopTraining_)break}return await h.onTrainEnd(),await t.history.syncData(),t.history}finally{t.isTraining=!1}}function oIe(t,e){let n=null;return e.batchesPerEpoch!=null?n=e.batchesPerEpoch:Number.isFinite(t.size)&&(n=t.size),n}function Yz(t){return typeof t.iterator=="function"}function aIe(t){return typeof t.next=="function"}async function lIe(t,e,n){n=n||{};const s=n.batches!=null,r=t.testFunction;let i=[];if(n.verbose>0)throw new ft("Verbose mode is not implemented yet.");O(!s||n.batches>0&&Number.isInteger(n.batches),()=>`Test loop expects \`batches\` to be a positive integer, but received ${JSON.stringify(n.batches)}`);const o=aIe(e)?e:await e.iterator();let a=0,l=0;for(;!s||l<n.batches;){const c=await o.next();if(i=se(()=>{if(c.value){const{xs:u,ys:d}=iq(t,c.value),h=u.concat(d),f=se(()=>r(h));if(rt(h),l===0)for(let m=0;m<f.length;++m)i.push(Ge(0));const p=h[0].shape[0];for(let m=0;m<f.length;++m){const g=f[m],y=i[m];i[m]=se(()=>fe(i[m],Y(p,g))),l>0&&rt(y)}rt(f),a+=p,++l}return i}),c.done){s&&console.warn(`Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least \`batches\` batches (in this case, ${n.batches} batches). You may need to use the repeat() function when building your dataset.`);break}}for(let c=0;c<i.length;++c){const u=i[c];i[c]=$e(i[c],a),rt(u)}return br(i)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function wI(t){O(t>0&&Number.isInteger(t),()=>`batchSize is required to be a positive integer, but got ${t}`)}function vm(t,e,n){return t==null?[null]:Array.isArray(t)?t.map(s=>id(s,e,n-e)):id(t,e,n-e)}function uD(t,e){return se(()=>t==null?null:Array.isArray(t)?t.map(n=>uD(n,e)):DK(t,e.dtype==="int32"?e:Te(e,"int32")))}function SI(t,e){const n=[];let s=0,r=null;for(;s<t;)r=s+e,r>=t&&(r=t),n.push([s,r]),s=r;return n}async function cIe(t,e,n,s,r,i,o,a,l,c,u,d,h,f,p){r==null&&(r=32),i==null&&(i=1),u==null&&(u=!0),h==null&&(h=0);let m=!1;if(l!=null&&c!=null&&(m=!0),p!=null&&(m=!0,f==null))throw new ee("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");const g=t.checkNumSamples(n,r,f,"steps_per_epoch");let y;g!=null&&(y=Vo(0,g)),o==null&&(o=1);const{callbackList:x,history:v}=XK(a,o,i,h,g,f,r,m,d);x.setModel(t),t.history=v,await x.onTrainBegin(),t.stopTraining_=!1;for(let b=h;b<i;++b){await x.onEpochBegin(b);const k={};if(f!=null)throw new ft("stepsPerEpoch mode is not implemented yet.");{if(u==="batch")throw new ft("batch shuffling is not implemneted yet");u&&pge(y);const C=cs(y),N=SI(g,r);for(let I=0;I<N.length;++I){const $={};if(await x.onBatchBegin(I,$),se(()=>{const A=N[I][0],P=N[I][1],F=id(C,A,P-A);$.batch=I,$.size=P-A;const V=uD(n,F),z=e(V);for(let B=0;B<s.length;++B){const W=s[B],q=z[B];$[W]=q,Ps(q)}if(I===N.length-1&&m){const B=t.testLoop(l,c,r);for(let W=0;W<s.length;++W){const q=s[W],M=B[W];Ps(M),k["val_"+q]=M}}}),await x.onBatchEnd(I,$),KK($),t.stopTraining_)break}C.dispose()}if(await x.onEpochEnd(b,k),t.stopTraining_)break}return await x.onTrainEnd(),await t.history.syncData(),t.history}async function uIe(t,e,n,s={}){if(t.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");t.isTraining=!0;let r,i,o,a,l,c,u,d,h;try{const f=s.batchSize==null?32:s.batchSize;wI(f);const p=!1,m=await t.standardizeUserData(e,n,s.sampleWeight,s.classWeight,p,f);r=m[0],i=m[1],h=m[2];let g=!1,y;if(s.validationData!=null&&s.validationData.length>0){if(g=!0,s.validationData.length===2)l=s.validationData[0],c=s.validationData[1];else throw s.validationData.length===3?new ft("validationData including sample weights is not supported yet."):new ee(`When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; ${s.validationData} is invalid.`);const $=!0,A=await t.standardizeUserData(l,c,null,null,$,f);u=A[0],d=A[1],y=u.concat(d)}else if(s.validationSplit!=null&&s.validationSplit>0&&s.validationSplit<1){g=!0;const $=Math.floor(r[0].shape[0]*(1-s.validationSplit)),A=r[0].shape[0];u=vm(r,$,A),o=r,r=vm(r,0,$),d=vm(i,$,A),a=i,i=vm(i,0,$),y=u.concat(d)}else s.validationSteps!=null&&(g=!0);const x=r.concat(i).concat(h);t.checkTrainableWeightsConsistency();const v=t.makeTrainFunction(),b=t.getDedupedMetricsNames();let k,C;g?(t.makeTestFunction(),k=t.testFunction,C=b.slice().concat(b.map($=>"val_"+$))):(k=null,y=[],C=b.slice());const N=qK(s.callbacks,s.yieldEvery);return await cIe(t,v,x,b,f,s.epochs,s.verbose,N,k,y,s.shuffle,C,s.initialEpoch,null,null)}finally{t.isTraining=!1,Io(r,e),Io(i,n),Io(o,e),Io(a,n),Io(u,l),Io(d,c),h!=null&&rt(h)}}function oq(t){const e=[];t instanceof Yt&&(t=[t]);for(let n=0;n<t.length;++n){const s=t[n];if(s.rank===1)e.push(E0(s,1));else{if(s.rank===0)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");e.push(s)}}return e}function Io(t,e){if(t==null)return;const n=[];if(e instanceof Yt)n.push(e.id);else if(Array.isArray(e))e.forEach(r=>n.push(r.id));else if(e!=null)for(const r in e){const i=e[r];n.push(i.id)}const s=[];if(t instanceof Yt)n.indexOf(t.id)===-1&&s.push(t);else if(Array.isArray(t))t.forEach(r=>{n.indexOf(r.id)===-1&&s.push(r)});else if(t!=null)for(const r in t){const i=t[r];n.indexOf(i.id)===-1&&s.push(i)}s.forEach(r=>{r.isDisposed||r.dispose()})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function dIe(t){return t instanceof Yt}function kI(t){return Array.isArray(t)}function Zz(t){return!dIe(t)&&!kI(t)}function Qz(t,e,n,s=!0,r=""){if(e==null||e.length===0){if(t!=null){let o=!1;if(kI(t)&&t.length>0)o=!0;else if(Zz(t)){for(const a in t)if(t.hasOwnProperty(a)){o=!0;break}}else o=!0;if(o)throw new ee(`Error when checking model ${r} expected no data, but got ${t}`)}return[]}if(t==null)return e.map(o=>null);let i;if(Zz(t)){t=t,i=[];for(const o of e){if(t[o]==null)throw new ee(`No data provided for "${o}". Need data for each key in: ${e}`);i.push(t[o])}}else if(kI(t)){if(t=t,t.length!==e.length)throw new ee(`Error when checking model ${r}: the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see ${e.length} Tensor(s), but instead got the following list of Tensor(s): ${t}`);i=t}else{if(t=t,e.length>1)throw new ee(`The model ${r} expects ${e.length} Tensor(s), but only received one Tensor. Found: Tensor with shape ${t.shape}`);i=[t]}if(i=oq(i),n!=null)for(let o=0;o<e.length;++o){if(n[o]==null)continue;const a=i[o];if(a.shape.length!==n[o].length)throw new ee(`Error when checking ${r}: expected ${e[o]} to have ${n[o].length} dimension(s). but got array with shape ${a.shape}`);for(let l=0;l<n[o].length;++l){if(l===0&&!s)continue;const c=a.shape[l],u=n[o][l];if(u!=null&&u>=0&&c!==u)throw new ee(`${r} expected a batch of elements where each example has shape [${n[o].slice(1,n[o].length)}] (i.e.,tensor shape [*,${n[o].slice(1,n[o].length)}]) but the ${r} received an input with ${a.shape[0]} examples, each with shape [${a.shape.slice(1,a.shape.length)}] (tensor shape [${a.shape}])`)}}return i}function hIe(t,e,n){const s=Nc(t.map(i=>i.shape[0]));s.sort();const r=Nc(e.map(i=>i.shape[0]));if(r.sort(),s.length>1)throw new ee(`All input Tensors (x) should have the same number of samples. Got array shapes: ${JSON.stringify(t.map(i=>i.shape))}`);if(r.length>1)throw new ee(`All target Tensors (y) should have the same number of samples. Got array shapes: ${JSON.stringify(e.map(i=>i.shape))}`);if(s.length>0&&r.length>0&&!Et(s,r))throw new ee(`Input Tensors should have the same number of samples as target Tensors. Found ${s[0]} input sample(s) and ${r[0]} target sample(s).`)}function fIe(t,e,n){const s=[nk,sk,Rg];for(let r=0;r<t.length;++r){const i=t[r],o=e[r],a=n[r];if(o!=null){if(o===Rg&&i.shape[i.shape.length-1]===1)throw new ee(`You are passing a target array of shape ${i.shape} while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].`);if(s.indexOf(o)!==-1){const l=i.shape.slice(1),c=a.slice(1);for(let u=0;u<l.length;++u){const d=l[u],h=c[u];if(h!=null&&d!==h)throw new ee(`A target Tensor with shape ${i.shape} was passed for an output of shape ${a}, while using a loss function that expects targets to have the same shape as the output.`)}}}}}function Jz(t,e,n,s=!0,r=""){let i;if(Array.isArray(t)){if(t.length!==e.length)throw new ee(`Error when checking model ${r}: the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see ${e.length} Tensor(s), but instead got ${t.length} Tensors(s).`);i=t}else{if(e.length>1)throw new ee(`The model expects ${e.length} ${r} Tensors, but only received one Tensor. Found: array with shape ${JSON.stringify(t.shape)}.`);i=[t]}if(n!=null)for(let o=0;o<e.length;++o){if(n[o]==null)continue;const a=i[o];if(a.shape.length!==n[o].length)throw new ee(`Error when checking ${r}: expected ${e[o]} to have ${n[o].length} dimension(s), but got array with shape ${JSON.stringify(a.shape)}`);for(let l=0;l<n[o].length;++l){if(l===0&&!s)continue;const c=a.shape[l],u=n[o][l];if(u!=null&&u!==c)throw new ee(`Error when checking ${r}: expected ${e[o]} to have shape ${JSON.stringify(n[o])} but got array with shape ${JSON.stringify(a.shape)}.`)}}}function pIe(t,e){if(t==null||Array.isArray(t)&&t.length===0)return e.map(s=>[]);let n;if(typeof t=="string"||typeof t=="function")n=[t];else if(Array.isArray(t)||typeof t=="object")n=t;else throw new TypeError(`Type of metrics argument not understood. Expected an string,function, Array, or Object, found: ${t}`);if(Array.isArray(n))return e.map(s=>n);{const s=[];for(const r of e){let i=n.hasOwnProperty(r)?n[r]:[];Array.isArray(i)||(i=[i]),s.push(i)}return s}}const mIe="layers-model";class Kh extends vo{constructor(e){super(e),this.isTraining=!1}summary(e,n,s=console.log){if(!this.built)throw new ee("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");Y2e(this,e,n,s)}compile(e){if(e.loss==null&&(e.loss=[]),this.loss=e.loss,typeof e.optimizer=="string")this.optimizer_=X2e(e.optimizer),this.isOptimizerOwned=!0;else{if(!(e.optimizer instanceof ou))throw new ee("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=e.optimizer,this.isOptimizerOwned=!1}let n=[];if(!Array.isArray(e.loss)&&typeof e.loss!="string"&&typeof e.loss!="function"){e.loss=e.loss;for(const o in e.loss)if(this.outputNames.indexOf(o)===-1)throw new ee(`Unknown entry in loss dictionary: "${o}". Only expected the following keys: ${this.outputNames}`);for(const o of this.outputNames)e.loss[o]==null&&console.warn(`Output "${o}" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to ${o} during training`),n.push(aT(e.loss[o]))}else if(Array.isArray(e.loss)){if(e.loss.length!==this.outputs.length)throw new ee(`When passing an Array as loss, it should have one entry per model output. The model has ${this.outputs.length} output(s), but you passed loss=${e.loss}.`);n=e.loss.map(a=>aT(a))}else{const o=aT(e.loss);this.outputs.forEach(a=>{n.push(o)})}this.lossFunctions=n,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(let o=0;o<this.outputs.length;++o){const a=this.internalOutputShapes[o],l=this.outputNames[o];this.feedOutputNames.push(l),this.feedOutputShapes.push(a),this.feedLossFns.push(this.lossFunctions[o])}const s=[];this.metrics=e.metrics,this.metricsNames=["loss"],this.metricsTensors=[],rd("loss",()=>{for(let o=0;o<this.outputs.length;++o){if(s.indexOf(o)!==-1)continue;const a=this.lossFunctions[o];this.outputs.length>1&&(this.metricsTensors.push([a,o]),this.metricsNames.push(this.outputNames[o]+"_loss"))}});const r=pIe(e.metrics,this.outputNames),i=(o,a,l)=>{this.outputNames.length>1&&(a=this.outputNames[o]+"_"+a),this.metricsNames.push(a),this.metricsTensors.push([l,o])};rd("metric",()=>{for(let o=0;o<this.outputs.length;++o){if(s.indexOf(o)!==-1)continue;const a=r[o];(c=>{const u="";let d,h,f;for(const p of c){if(typeof p=="string"&&["accuracy","acc","crossentropy","ce"].indexOf(p)!==-1){const g=this.internalOutputShapes[o];g[g.length-1]===1||this.lossFunctions[o]===sk?["accuracy","acc"].indexOf(p)!==-1?h=ZK:["crossentropy","ce"].indexOf(p)!==-1&&(h=z2e):this.lossFunctions[o]===hw?["accuracy","acc"].indexOf(p)!==-1?h=V2e:["crossentropy","ce"].indexOf(p)!==-1&&(h=eq):["accuracy","acc"].indexOf(p)!==-1?h=QK:["crossentropy","ce"].indexOf(p)!==-1&&(h=JK);let y;["accuracy","acc"].indexOf(p)!==-1?y="acc":["crossentropy","ce"].indexOf(p)!==-1&&(y="ce"),f=h,d=u+y}else f=q2e(p),d=u+qx(p);let m;rd(d,()=>{m=f}),i(o,d,m)}})(a)}}),this.collectedTrainableWeights=this.trainableWeights}checkTrainableWeightsConsistency(){this.collectedTrainableWeights!=null&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}evaluate(e,n,s={}){const r=s.batchSize==null?32:s.batchSize;wI(r);const i=!0,o=this.standardizeUserDataXY(e,n,i,r);try{const a=o[0].concat(o[1]);this.makeTestFunction();const l=this.testFunction,c=this.testLoop(l,a,r,s.verbose,s.steps);return br(c)}finally{Io(o[0],e),Io(o[1],n)}}async evaluateDataset(e,n){return this.makeTestFunction(),lIe(this,e,n)}checkNumSamples(e,n,s,r="steps"){let i;if(s!=null){if(i=null,n!=null)throw new ee(`If ${r} is set, batchSize must be null or undefined.Got batchSize = ${n}`)}else if(e!=null)Array.isArray(e)?i=e[0].shape[0]:i=e.shape[0];else throw new ee(`Either the input data should have a defined shape, or ${r} shoud be specified.`);return i}execute(e,n){if(Array.isArray(n)&&n.length===0)throw new ee("`outputs` is an empty Array, which is not allowed.");const s=Array.isArray(n),r=s?n:[n],i=this.retrieveSymbolicTensors(r),o=new lc;if(e instanceof Yt&&(e=[e]),Array.isArray(e)){if(e.length!==this.inputs.length)throw new ee(`The number of inputs provided (${e.length}) does not match the number of inputs of this model (${this.inputs.length}).`);for(let l=0;l<this.inputs.length;++l)o.add(this.inputs[l],e[l])}else for(const l of this.inputs){const c=e[l.name];if(c==null)throw new ee(`No value is provided for the model's input ${l.name}`);o.add(l,c)}const a=xm(i,o);return s?a:a[0]}retrieveSymbolicTensors(e){const n=Nd(null,e.length);let s=e.length;for(const r of this.layers){const i=Array.isArray(r.output)?r.output:[r.output],o=i.map(a=>a.name);for(let a=0;a<e.length;++a){const l=o.indexOf(e[a]);if(l!==-1&&(n[a]=i[l],s--),s===0)break}if(s===0)break}if(s>0){const r=[];throw n.forEach((i,o)=>{i==null&&r.push(e[o])}),new ee(`Cannot find SymbolicTensors for output name(s): ${JSON.stringify(r)}`)}return n}predictLoop(e,n=32,s=!1){return se(()=>{const r=this.checkNumSamples(e);if(s)throw new ft("Verbose predictLoop() is not implemented yet.");const i=SI(r,n),o=this.outputs.map(a=>[]);for(let a=0;a<i.length;++a)se(()=>{const c=i[a][0],u=i[a][1],d=vm(e,c,u),h=[];if(Array.isArray(d))for(let p=0;p<d.length;++p)h.push({key:this.inputs[p],value:d[p]});else h.push({key:this.inputs[0],value:d});const f=new lc(h);return xm(this.outputs,f)}).forEach((c,u)=>o[u].push(c));return br(o.map(a=>Cn(a,0)))})}predict(e,n={}){const s=oq(e);Jz(s,this.inputNames,this.feedInputShapes,!1);try{const r=n.batchSize==null?32:n.batchSize;return wI(r),this.predictLoop(s,r)}finally{Io(s,e)}}predictOnBatch(e){Jz(e,this.inputNames,this.feedInputShapes,!0);const n=(Array.isArray(e)?e[0]:e).shape[0];return this.predictLoop(e,n)}standardizeUserDataXY(e,n,s=!0,r){if(this.optimizer_==null)throw new eo("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");const i=[];for(let o=0;o<this.feedOutputShapes.length;++o){const a=this.feedOutputShapes[o];this.feedLossFns[o]===hw?i.push(a.slice(0,a.length-1).concat([1])):i.push(a)}if(e=Qz(e,this.feedInputNames,this.feedInputShapes,!1,"input"),n=Qz(n,this.feedOutputNames,i,!1,"target"),hIe(e,n),fIe(n,this.feedLossFns,this.feedOutputShapes),this.stateful&&r!=null&&r>0&&e[0].shape[0]%r!==0)throw new ee(`In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size ${r}. Found: ${e[0].shape[0]} sample(s).`);return[e,n]}async standardizeUserData(e,n,s,r,i=!0,o){const[a,l]=this.standardizeUserDataXY(e,n,i,o);if(s!=null)throw new Error("sample weight is not supported yet.");let c=null;if(r!=null){const u=sq(r,this.outputNames);c=[];for(let d=0;d<u.length;++d)c.push(await rq(l[d],null,u[d]))}return[a,l,c]}testLoop(e,n,s,r=0,i){return se(()=>{const o=this.checkNumSamples(n,s,i,"steps"),a=[];if(r>0)throw new ft("Verbose mode is not implemented yet.");if(i!=null)throw new ft("steps mode in testLoop() is not implemented yet");{const l=SI(o,s),c=cs(Vo(0,o));for(let u=0;u<l.length;++u){const d=l[u][0],h=l[u][1],f=id(c,d,h-d),p=uD(n,f),m=e(p);if(u===0)for(let g=0;g<m.length;++g)a.push(Ge(0));for(let g=0;g<m.length;++g){const y=m[g];a[g]=fe(a[g],Y(h-d,y))}}for(let u=0;u<a.length;++u)a[u]=$e(a[u],o)}return a})}getDedupedMetricsNames(){const e=this.metricsNames,n=[];for(let s=0;s<e.length;++s){const r=e[s];let i=r;if(Lz(e,r)>1){const o=Lz(e.slice(0,s),r);i+=`_${o}`}n.push(i)}return n}makeTrainFunction(){return e=>{const n=[],s=e.slice(0,this.inputs.length),r=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),i=e.slice(this.inputs.length+this.outputs.length,this.inputs.length+this.outputs.length*2),o=[],a=()=>{const d=[];for(let m=0;m<this.inputs.length;++m)d.push({key:this.inputs[m],value:s[m]});const h=new lc(d),f=xm(this.outputs,h,{training:!0});let p;for(let m=0;m<this.lossFunctions.length;++m){const g=this.lossFunctions[m];let y=g(r[m],f[m]);i[m]!=null&&(y=nIe(y,i[m]));const x=Dn(y);n.push(x),m===0?p=y:p=fe(p,y)}for(let m=0;m<this.metricsTensors.length;++m){let g;if(this.outputs.length>1&&m<this.outputs.length)g=n[m];else{const y=this.metricsTensors[m][0],x=this.metricsTensors[m][1];g=Dn(y(r[x],f[x]))}Ps(g),o.push(g)}return p=Dn(p),this.calculateLosses().forEach(m=>{p=fe(p,m)}),p},l=this.collectedTrainableWeights.map(d=>d.read()),c=!0;return[this.optimizer_.minimize(a,c,l)].concat(o)}}makeTestFunction(){this.testFunction=e=>se(()=>{const n=[];let s;const r=e.slice(0,this.inputs.length),i=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),o=[];for(let c=0;c<this.inputs.length;++c)o.push({key:this.inputs[c],value:r[c]});const a=new lc(o),l=xm(this.outputs,a);for(let c=0;c<this.lossFunctions.length;++c){const u=this.lossFunctions[c],d=Dn(u(i[c],l[c]));c===0?s=d:s=fe(s,d),n.push(s)}for(let c=0;c<this.metricsTensors.length;++c){const u=this.metricsTensors[c][0],d=this.metricsTensors[c][1],h=Dn(u(i[d],l[d]));n.push(h)}return n})}async fit(e,n,s={}){return uIe(this,e,n,s)}async fitDataset(e,n){return iIe(this,e,n)}async trainOnBatch(e,n){const s=await this.standardizeUserData(e,n),r=s[0],i=s[1],a=this.makeTrainFunction()(r.concat(i)),l=[];for(const c of a){const u=await c.data();l.push(u[0])}return rt(a),Io(s[0],e),Io(s[1],n),br(l)}getNamedWeights(e){const n=[],s=e!=null&&e.trainableOnly,r=s?this.trainableWeights:this.weights,i=this.getWeights(s);for(let o=0;o<r.length;++o)s&&!r[o].trainable||n.push({name:r[o].originalName,tensor:i[o]});return n}set stopTraining(e){this.stopTraining_=e}get stopTraining(){return this.stopTraining_}get optimizer(){return this.optimizer_}set optimizer(e){this.optimizer_!==e&&(this.optimizer_=e,this.isOptimizerOwned=!1)}dispose(){const e=super.dispose();if(e.refCountAfterDispose===0&&this.optimizer!=null&&this.isOptimizerOwned){const n=K2().numTensors;this.optimizer_.dispose(),e.numDisposedVariables+=n-K2().numTensors}return e}getLossIdentifiers(){let e;if(typeof this.loss=="string")e=Xa(this.loss);else if(Array.isArray(this.loss)){for(const n of this.loss)if(typeof n!="string")throw new Error("Serialization of non-string loss is not supported.");e=this.loss.map(n=>Xa(n))}else{const n=Object.keys(this.loss);e={};const s=this.loss;for(const r of n)if(typeof s[r]=="string")e[r]=Xa(s[r]);else throw new Error("Serialization of non-string loss is not supported.")}return e}getMetricIdentifiers(){if(typeof this.metrics=="string"||typeof this.metrics=="function")return[Xa(qx(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map(e=>Xa(qx(e)));{const e={};for(const n in this.metrics)e[n]=Xa(qx(this.metrics[n]));return e}}getTrainingConfig(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}loadTrainingConfig(e){if(e.weighted_metrics!=null)throw new Error("Loading weight_metrics is not supported yet.");if(e.loss_weights!=null)throw new Error("Loading loss_weights is not supported yet.");if(e.sample_weight_mode!=null)throw new Error("Loading sample_weight_mode is not supported yet.");const n=gw(e.optimizer_config),s=Ta(n);let r;if(typeof e.loss=="string")r=Eu(e.loss);else if(Array.isArray(e.loss))r=e.loss.map(o=>Eu(o));else if(e.loss!=null){r={};for(const o in e.loss)r[o]=Eu(e.loss[o])}let i;if(Array.isArray(e.metrics))i=e.metrics.map(o=>Eu(o));else if(e.metrics!=null){i={};for(const o in e.metrics)i[o]=Eu(e.metrics[o])}this.compile({loss:r,metrics:i,optimizer:s})}async save(e,n){if(typeof e=="string"){const c=nG(e);if(c.length===0)throw new ee(`Cannot find any save handlers for URL '${e}'`);if(c.length>1)throw new ee(`Found more than one (${c.length}) save handlers for URL '${e}'`);e=c[0]}if(e.save==null)throw new ee("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");const s=await B2(this.getNamedWeights(n)),r=!1,i=null,a={modelTopology:this.toJSON(i,r),format:mIe,generatedBy:`TensorFlow.js tfjs-layers v${nq}`,convertedBy:null};if((n==null?!1:n.includeOptimizer)&&this.optimizer!=null){a.trainingConfig=this.getTrainingConfig();const c="optimizer",{data:u,specs:d}=await B2(await this.optimizer.getWeights(),c);s.specs.push(...d),s.data=TS([s.data,u])}return this.userDefinedMetadata!=null&&(qz(this.userDefinedMetadata,this.name,!0),a.userDefinedMetadata=this.userDefinedMetadata),a.weightData=s.data,a.weightSpecs=s.specs,e.save(a)}setUserDefinedMetadata(e){qz(e,this.name),this.userDefinedMetadata=e}getUserDefinedMetadata(){return this.userDefinedMetadata}}Kh.className="Model";ge(Kh);class aq extends Kh{}aq.className="Functional";ge(aq);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */async function gIe(t,e){if(e==null&&(e={}),typeof t=="string"){const n=sG(t,e);if(n.length===0)n.push(mG(t,e));else if(n.length>1)throw new ee(`Found more than one (${n.length}) load handlers for URL '${t}'`);t=n[0]}return yIe(t,void 0,e)}async function yIe(t,e,n){if(n==null&&(n={}),t.load==null)throw new ee("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");const s=await t.load();let r=s.modelTopology;r.model_config!=null&&(r=r.model_config);const i=n.strict==null?!0:n.strict,o=s.weightData!=null&&s.weightSpecs!=null&&i,a=Ta(gw(r),e,o),l=s.trainingConfig;if(l!=null&&a.loadTrainingConfig(l),s.userDefinedMetadata!=null&&a.setUserDefinedMetadata(s.userDefinedMetadata),s.weightData!=null){if(s.weightSpecs==null)throw new ee("LayersModel artifacts contains weight data, but not weight specs. Therefore loading of weights cannot proceed.");const{modelWeights:c,optimizerWeights:u}=xIe(s.weightData,s.weightSpecs);a.loadWeights(c,i),a.optimizer!=null&&u.length>0&&await a.optimizer.setWeights(u),rt(c),rt(u.map(d=>d.tensor))}return a}function xIe(t,e){const n=SA(t,e),s={},r=[];return e.forEach(i=>{i.group==="optimizer"?r.push({name:i.name,tensor:n[i.name]}):s[i.name]=n[i.name]}),{modelWeights:s,optimizerWeights:r}}class Dg extends Kh{constructor(e){if(super({inputs:[],outputs:[]}),e=e||{},this.trainable=!0,this.built=!1,this.name=e.name!=null?e.name:JS("sequential_"),e.layers!=null)for(const n of e.layers)this.add(n)}checkShape(e){if(e.inboundNodes[0].outputTensors[0].shape.some(s=>s<0))throw new ee(`Negative dimension size caused by adding layer ${e.name} with input shape [${e.inboundNodes[0].inputTensors[0].shape}]`)}add(e){const n=e instanceof Dg||e instanceof Kh;let s;if(n){if(s=e,s.outputs.length!==1)throw new ee("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(s.inputs.length!==1)throw new ee("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(this.outputs.length===0){if(e.inboundNodes.length===0){if(e.batchInputShape==null)throw new ee("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");const r=g2e({batchShape:e.batchInputShape,dtype:e.dtype,name:e.name+"_input"});e.apply(r)}if(n)this.outputs=s.outputs,this.inputs=s.inputs;else{if(e.inboundNodes.length!==1)throw new ee(`A layer added to a Sequential model must not already be connected somewhere else. LayersModel received layer ${e.name} which has ${e.inboundNodes.length} pre-existing inbound connections.`);if(e.inboundNodes[0].outputTensors.length!==1)throw new ee("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[e.inboundNodes[0].outputTensors[0]],this.inputs=BK(this.outputs[0])}this.inboundNodes=[],new tk({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:Nd(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map(r=>r.shape),outputShapes:this.outputs[0].shape})}else{const r=e.apply(this.outputs[0]);if(Array.isArray(r))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[r],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(e),this.built=!1}pop(){if(this.layers.length===0)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),this.layers.length===0)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{const e=this.layers.length-1;this.layers[e].outboundNodes=[],this.outputs=[this.layers[e].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}call(e,n){return this.model==null&&this.build(),this.model.call(e,n)}build(e){if(Ut(e),this.inputs.length===0||this.outputs.length===0)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new Kh({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}countParams(){return this.built||this.build(),super.countParams()}summary(e,n,s=console.log){this.built||this.build(),super.summary(e,n,s)}setWeights(e){this.model==null&&this.build(),this.model.setWeights(e)}evaluate(e,n,s={}){if(!this.built)throw new eo("The model needs to be compiled before being used.");return this.model.evaluate(e,n,s)}async evaluateDataset(e,n){if(!this.built)throw new eo("The model needs to be compiled before being used.");return this.model.evaluateDataset(e,n)}predict(e,n={}){return this.model==null&&this.build(),this.model.predict(e,n)}predictOnBatch(e){return this.model==null&&this.build(),this.model.predictOnBatch(e)}compile(e){this.build(),this.model.compile(e),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}get optimizer(){return this.model==null?void 0:this.model.optimizer}set optimizer(e){this.model.optimizer=e}async fit(e,n,s={}){if(!this.built)throw new eo("The model needs to be compiled before being used.");return this.model.fit(e,n,s)}async fitDataset(e,n){if(!this.built)throw new eo("The model needs to be compiled before being used.");return this.model.fitDataset(e,n)}async trainOnBatch(e,n){return this.model.trainOnBatch(e,n)}static fromConfig(e,n,s={},r=!1){let i,o={};if(n instanceof Array){if(n[0].className==null||n[0].className==="Merge")throw new ee("Legacy serialization format not supported yet.");i=n}else O(n.layers!=null,()=>"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."),i=n.layers,delete n.layers,o=n;const a=new e(o);if(!(a instanceof Dg))throw new ft(`Sequential.fromConfig called on non-Sequential input: ${a}`);for(const l of i){const u=Ta(l,void 0,r);r&&u.setFastWeightInitDuringBuild(!0),a.add(u)}return a}set stopTraining(e){if(this.model==null)throw new ee("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=e}get stopTraining(){if(this.model==null)throw new ee("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining}getConfig(){const e=[];for(const n of this.layers){const s={};s.className=n.getClassName(),s.config=n.getConfig(),e.push(s)}return{name:this.name,layers:e}}}Dg.className="Sequential";ge(Dg);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function vIe(t,e){return e==null&&(e={}),gIe(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let Ar=class extends op{getConfig(){return{}}};class lq extends Ar{apply(e,n=1){return n2e(e,n)}}lq.className="elu";ge(lq);class cq extends Ar{apply(e){return oR(e)}}cq.className="selu";ge(cq);class uq extends Ar{apply(e){return Pa(e)}}uq.className="relu";ge(uq);class dq extends Ar{apply(e){return se(()=>S0(6,Pa(e)))}}dq.className="relu6";ge(dq);class hq extends Ar{apply(e){return e}}hq.className="linear";ge(hq);class fq extends Ar{apply(e){return bi(e)}}fq.className="sigmoid";ge(fq);class pq extends Ar{apply(e){return r2e(e)}}pq.className="hardSigmoid";ge(pq);class mq extends Ar{apply(e){return lp(e)}}mq.className="softplus";ge(mq);class gq extends Ar{apply(e){return s2e(e)}}gq.className="softsign";ge(gq);class yq extends Ar{apply(e){return Of(e)}}yq.className="tanh";ge(yq);let dD=class extends Ar{apply(e,n=-1){return jS(e,n)}};dD.className="softmax";ge(dD);class xq extends Ar{apply(e,n=-1){return HA(e,n)}}xq.className="logSoftmax";ge(xq);class vq extends Ar{apply(e,n=1){return se(()=>Y(bi(Y(e,n)),e))}}vq.className="swish";ge(vq);class bq extends Ar{apply(e){return se(()=>Y(e,Of(lp(e))))}}bq.className="mish";ge(bq);function Uc(t){return t.getClassName()}function lT(t,e={}){return I0(t,qi.getMap().classNameMap,e,"activation")}function Hc(t){if(t==null){const e={};return e.className="linear",e.config={},lT(e)}if(typeof t=="string"){const e={};return e.className=t,e.config={},lT(e)}else return t instanceof Ar?t:lT(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function bIe(t){if(t!=null&&typeof t!="object")throw new Error(`Argument to L1L2 regularizer's constructor is expected to be an object, but received: ${t}`)}class wq extends op{}class Sq extends wq{constructor(e){super(),bIe(e),this.l1=e==null||e.l1==null?.01:e.l1,this.l2=e==null||e.l2==null?.01:e.l2,this.hasL1=this.l1!==0,this.hasL2=this.l2!==0}apply(e){return se(()=>{let n=es([1]);return this.hasL1&&(n=fe(n,Be(Y(this.l1,os(e))))),this.hasL2&&(n=fe(n,Be(Y(this.l2,$0(e))))),Q(n,[])})}getConfig(){return{l1:this.l1,l2:this.l2}}static fromConfig(e,n){return new e({l1:n.l1,l2:n.l2})}}Sq.className="L1L2";ge(Sq);const eV={l1l2:"L1L2"};function Qt(t){return YR(t)}function tV(t,e={}){return I0(t,qi.getMap().classNameMap,e,"regularizer")}function bn(t){if(t==null)return null;if(typeof t=="string"){const n={className:t in eV?eV[t]:t,config:{}};return tV(n)}else return t instanceof wq?t:tV(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class kq extends $t{constructor(e){super(e??{}),this.supportsMasking=!0,e!=null&&(this.maxValue=e.maxValue)}call(e,n){e=pt(e);let s=Pa(e);return this.maxValue!=null&&(s=Tr(s,0,this.maxValue)),s}computeOutputShape(e){return e}getConfig(){const e={maxValue:this.maxValue},n=super.getConfig();return Object.assign(e,n),e}}kq.className="ReLU";ge(kq);class Cq extends $t{constructor(e){super(e??{}),this.DEFAULT_ALPHA=.3,e==null&&(e={}),this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,n){const s=pt(e);return AS(s,this.alpha)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},n=super.getConfig();return Object.assign(e,n),e}}Cq.className="LeakyReLU";ge(Cq);class Tq extends $t{constructor(e){if(super(e??{}),this.DEFAULT_ALPHA_INITIALIZER="zeros",e==null&&(e={}),this.supportsMasking=!0,this.alphaInitializer=xn(e.alphaInitializer||this.DEFAULT_ALPHA_INITIALIZER),this.alphaRegularizer=bn(e.alphaRegularizer),this.alphaConstraint=fs(e.alphaConstraint),e.sharedAxes==null)this.sharedAxes=null;else if(Array.isArray(e.sharedAxes))this.sharedAxes=e.sharedAxes;else if(typeof e.sharedAxes=="number")this.sharedAxes=[e.sharedAxes];else throw new ee(`Expected sharedAxes to be a number or an array of numbers, but got ${e.sharedAxes}`)}build(e){e=Ut(e);const n=e.slice(1);if(this.sharedAxes!=null)for(const r of this.sharedAxes)n[r-1]=1;this.alpha=this.addWeight("alpha",n,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);const s={};if(this.sharedAxes!=null)for(let r=1;r<e.length;++r)s[r]=e[r];this.inputSpec=[new ds({ndim:e.length,axes:s})],this.built=!0}call(e,n){return e=pt(e),LS(e,this.alpha.read())}getConfig(){const e={alphaInitializer:kn(this.alphaInitializer),alphaRegularizer:Qt(this.alphaRegularizer),alphaConstraint:hs(this.alphaConstraint),sharedAxes:this.sharedAxes},n=super.getConfig();return Object.assign(e,n),e}}Tq.className="PReLU";ge(Tq);let Nq=class extends $t{constructor(e){if(super(e??{}),this.DEFAULT_ALPHA=1,e==null&&(e={}),e.alpha!=null&&e.alpha!==this.DEFAULT_ALPHA)throw new ft(`Non-default alpha value (${e.alpha}) is not supported by the ELU layer yet.`);this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,n){const s=pt(e);return b0(s)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},n=super.getConfig();return Object.assign(e,n),e}};Nq.className="ELU";ge(Nq);class Iq extends $t{constructor(e){super(e??{}),this.DEFAULT_THETA=1,e==null&&(e={}),this.theta=e.theta==null?this.DEFAULT_THETA:e.theta}call(e,n){const s=pt(e);return Y(s,Te(Ei(s,this.theta),"float32"))}computeOutputShape(e){return e}getConfig(){const e={theta:this.theta},n=super.getConfig();return Object.assign(e,n),e}}Iq.className="ThresholdedReLU";ge(Iq);class _q extends $t{constructor(e){super(e??{}),this.DEFAULT_AXIS=1,e==null&&(e={}),this.softmax=new dD().apply,this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis}call(e,n){const s=pt(e);return this.softmax(s,this.axis)}computeOutputShape(e){return e}getConfig(){const e={axis:this.axis},n=super.getConfig();return Object.assign(e,n),e}}_q.className="Softmax";ge(_q);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function qh(t,e,n){if(typeof t=="number")return Nd(t,e);if(t.length!==e)throw new ee(`The ${n} argument must be an integer or tuple of ${e} integers. Received: ${t.length} elements.`);for(let s=0;s<e;++s){const r=t[s];if(!QNe(r))throw new ee(`The ${n} argument must be an integer or tuple of ${e} integers. Received: ${JSON.stringify(t)} including a non-integer number ${r}`)}return t}function Do(t,e,n,s,r=1){if(t==null)return t;const i=e+(e-1)*(r-1);let o;return n==="same"?o=t:o=t-i+1,Math.floor((o+s-1)/s)}function ia(t,e,n,s){if(t==null)return null;if(s==="valid")t=t*e+Wc([n-e,0]);else if(s==="same")t=t*e;else throw new ee(`Unsupport padding mode: ${s}.`);return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function hD(t,e){return se(()=>(Kn(e),e==="channelsFirst"?Nt(t,[0,2,3,1]):t))}function Eq(t,e){return se(()=>(Kn(e),e==="channelsFirst"?Nt(t,[0,2,3,4,1]):t))}function wIe(t,e,n,s=1,r="valid",i,o=1){return se(()=>{if(i==null&&(i=jo()),Kn(i),t.shape.length!==3)throw new ee(`The input of a conv1dWithBias operation should be 3, but is ${t.shape.length} instead.`);if(e.shape.length!==3)throw new ee(`The kernel for a conv1dWithBias operation should be 3, but is ${e.shape.length} instead`);if(n!=null&&n.shape.length!==1)throw new ee(`The bias for a conv1dWithBias operation should be 1, but is ${e.shape.length} instead`);if(i==="channelsFirst"&&(t=Nt(t,[0,2,1])),r==="causal")throw new ft("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");let a=LA(t,e,s,r==="same"?"same":"valid","NWC",o);return n!=null&&(a=Uo(a,n)),a})}function nV(t,e,n,s=[1,1],r="valid",i,o,a=null){return se(()=>{if(i==null&&(i=jo()),Kn(i),t.rank!==3&&t.rank!==4)throw new ee(`conv2dWithBiasActivation expects input to be of rank 3 or 4, but received ${t.rank}.`);if(e.rank!==3&&e.rank!==4)throw new ee(`conv2dWithBiasActivation expects kernel to be of rank 3 or 4, but received ${t.rank}.`);let l=hD(t,i);if(r==="causal")throw new ft("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return l=E8({x:l,filter:e,strides:s,pad:r==="same"?"same":"valid",dilations:o,dataFormat:"NHWC",bias:n,activation:a}),i==="channelsFirst"&&(l=Nt(l,[0,3,1,2])),l})}function SIe(t,e,n,s=[1,1,1],r="valid",i,o){return se(()=>{if(i==null&&(i=jo()),Kn(i),t.rank!==4&&t.rank!==5)throw new ee(`conv3dWithBias expects input to be of rank 4 or 5, but received ${t.rank}.`);if(e.rank!==4&&e.rank!==5)throw new ee(`conv3dWithBias expects kernel to be of rank 4 or 5, but received ${t.rank}.`);let a=Eq(t,i);if(r==="causal")throw new ft("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return a=XG(a,e,s,r==="same"?"same":"valid","NDHWC",o),n!=null&&(a=Uo(a,n)),i==="channelsFirst"&&(a=Nt(a,[0,4,1,2,3])),a})}class rk extends $t{constructor(e,n){if(super(n),this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",rk.verifyArgs(n),this.rank=e,Ss(this.rank,"rank"),this.rank!==1&&this.rank!==2&&this.rank!==3)throw new ft(`Convolution layer for rank other than 1, 2, or 3 (${this.rank}) is not implemented yet.`);if(this.kernelSize=qh(n.kernelSize,e,"kernelSize"),this.strides=qh(n.strides==null?1:n.strides,e,"strides"),this.padding=n.padding==null?"valid":n.padding,$i(this.padding),this.dataFormat=n.dataFormat==null?"channelsLast":n.dataFormat,Kn(this.dataFormat),this.activation=Hc(n.activation),this.useBias=n.useBias==null?!0:n.useBias,this.biasInitializer=xn(n.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.biasConstraint=fs(n.biasConstraint),this.biasRegularizer=bn(n.biasRegularizer),this.activityRegularizer=bn(n.activityRegularizer),this.dilationRate=qh(n.dilationRate==null?1:n.dilationRate,e,"dilationRate"),this.rank===1&&Array.isArray(this.dilationRate)&&this.dilationRate.length!==1)throw new ee(`dilationRate must be a number or an array of a single number for 1D convolution, but received ${JSON.stringify(this.dilationRate)}`);if(this.rank===2){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==2)throw new ee(`dilationRate must be a number or array of two numbers for 2D convolution, but received ${JSON.stringify(this.dilationRate)}`)}else if(this.rank===3){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==3)throw new ee(`dilationRate must be a number or array of three numbers for 3D convolution, but received ${JSON.stringify(this.dilationRate)}`)}}static verifyArgs(e){if(ra("kernelSize"in e,"required key 'kernelSize' not in config"),typeof e.kernelSize!="number"&&!ZR(e.kernelSize,"number",1,3))throw new ee(`BaseConv expects config.kernelSize to be number or number[] with length 1, 2, or 3, but received ${JSON.stringify(e.kernelSize)}.`)}getConfig(){const e={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:Uc(this.activation),useBias:this.useBias,biasInitializer:kn(this.biasInitializer),biasRegularizer:Qt(this.biasRegularizer),activityRegularizer:Qt(this.activityRegularizer),biasConstraint:hs(this.biasConstraint)},n=super.getConfig();return Object.assign(e,n),e}}class dp extends rk{constructor(e,n){super(e,n),this.kernel=null,dp.verifyArgs(n),this.filters=n.filters,Ss(this.filters,"filters"),this.kernelInitializer=xn(n.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.kernelConstraint=fs(n.kernelConstraint),this.kernelRegularizer=bn(n.kernelRegularizer)}build(e){e=Ut(e);const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null)throw new ee(`The channel dimension of the input should be defined. Found ${e[n]}`);const s=e[n],r=this.kernelSize.concat([s,this.filters]);this.kernel=this.addWeight("kernel",r,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:{[n]:s}}],this.built=!0}call(e,n){return se(()=>{e=pt(e);let s;const r=this.bias==null?null:this.bias.read(),i=IK(this.activation.getClassName());if(i!=null&&this.rank===2)s=nV(e,this.kernel.read(),r,this.strides,this.padding,this.dataFormat,this.dilationRate,i);else{if(this.rank===1)s=wIe(e,this.kernel.read(),r,this.strides[0],this.padding,this.dataFormat,this.dilationRate[0]);else if(this.rank===2)s=nV(e,this.kernel.read(),r,this.strides,this.padding,this.dataFormat,this.dilationRate);else if(this.rank===3)s=SIe(e,this.kernel.read(),r,this.strides,this.padding,this.dataFormat,this.dilationRate);else throw new ft("convolutions greater than 3D are not implemented yet.");this.activation!=null&&(s=this.activation.apply(s))}return s})}computeOutputShape(e){e=Ut(e);const n=[],s=this.dataFormat==="channelsLast"?e.slice(1,e.length-1):e.slice(2);for(let i=0;i<s.length;++i){const o=Do(s[i],this.kernelSize[i],this.padding,this.strides[i],typeof this.dilationRate=="number"?this.dilationRate:this.dilationRate[i]);n.push(o)}let r=[e[0]];return this.dataFormat==="channelsLast"?(r=r.concat(n),r.push(this.filters)):(r.push(this.filters),r=r.concat(n)),r}getConfig(){const e={filters:this.filters,kernelInitializer:kn(this.kernelInitializer),kernelRegularizer:Qt(this.kernelRegularizer),kernelConstraint:hs(this.kernelConstraint)},n=super.getConfig();return Object.assign(e,n),e}static verifyArgs(e){if(!("filters"in e)||typeof e.filters!="number"||e.filters<1)throw new ee(`Convolution layer expected config.filters to be a 'number' > 0 but got ${JSON.stringify(e.filters)}`)}}class O0 extends dp{constructor(e){super(2,e),O0.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!ZR(e.kernelSize,"number",1,2))throw new ee(`Conv2D expects config.kernelSize to be number or number[] with length 1 or 2, but received ${JSON.stringify(e.kernelSize)}.`)}}O0.className="Conv2D";ge(O0);class P0 extends dp{constructor(e){super(3,e),P0.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!(Array.isArray(e.kernelSize)&&(e.kernelSize.length===1||e.kernelSize.length===3)))throw new ee(`Conv3D expects config.kernelSize to be number or [number, number, number], but received ${JSON.stringify(e.kernelSize)}.`)}}P0.className="Conv3D";ge(P0);class $q extends O0{constructor(e){if(super(e),this.inputSpec=[new ds({ndim:4})],this.padding!=="same"&&this.padding!=="valid")throw new ee(`Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=Ut(e),e.length!==4)throw new ee("Input should have rank 4; Received input shape: "+JSON.stringify(e));const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null)throw new ee("The channel dimension of the inputs should be defined. Found `None`.");const s=e[n],r=this.kernelSize.concat([this.filters,s]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new ds({ndim:4,axes:{[n]:s}})],this.built=!0}call(e,n){return se(()=>{let s=pt(e);if(s.shape.length!==4)throw new ee(`Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${s.shape.length}`);const r=s.shape,i=r[0];let o,a;this.dataFormat==="channelsFirst"?(o=2,a=3):(o=1,a=2);const l=r[o],c=r[a],u=this.kernelSize[0],d=this.kernelSize[1],h=this.strides[0],f=this.strides[1],p=ia(l,h,u,this.padding),m=ia(c,f,d,this.padding),g=[i,p,m,this.filters];this.dataFormat!=="channelsLast"&&(s=Nt(s,[0,2,3,1]));let y=zA(s,this.kernel.read(),g,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(y=Nt(y,[0,3,1,2])),this.bias!=null&&(y=Uo(y,this.bias.read(),this.dataFormat)),this.activation!=null&&(y=this.activation.apply(y)),y})}computeOutputShape(e){e=Ut(e);const n=e.slice();let s,r,i;this.dataFormat==="channelsFirst"?(s=1,r=2,i=3):(s=3,r=1,i=2);const o=this.kernelSize[0],a=this.kernelSize[1],l=this.strides[0],c=this.strides[1];return n[s]=this.filters,n[r]=ia(n[r],l,o,this.padding),n[i]=ia(n[i],c,a,this.padding),n}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}$q.className="Conv2DTranspose";ge($q);class Aq extends P0{constructor(e){if(super(e),this.inputSpec=[new ds({ndim:5})],this.padding!=="same"&&this.padding!=="valid")throw new ee(`Conv3DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=Ut(e),e.length!==5)throw new ee("Input should have rank 5; Received input shape: "+JSON.stringify(e));const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null)throw new ee("The channel dimension of the inputs should be defined. Found `None`.");const s=e[n],r=this.kernelSize.concat([this.filters,s]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new ds({ndim:5,axes:{[n]:s}})],this.built=!0}call(e,n){return se(()=>{let s=pt(e);if(s.shape.length!==5)throw new ee(`Conv3DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${s.shape.length}`);const r=s.shape,i=r[0];let o,a,l;this.dataFormat==="channelsFirst"?(l=2,o=3,a=4):(l=1,o=2,a=3);const c=r[l],u=r[o],d=r[a],h=this.kernelSize[0],f=this.kernelSize[1],p=this.kernelSize[2],m=this.strides[0],g=this.strides[1],y=this.strides[2],x=ia(c,m,h,this.padding),v=ia(u,g,f,this.padding),b=ia(d,y,p,this.padding),k=[i,x,v,b,this.filters];this.dataFormat!=="channelsLast"&&(s=Nt(s,[0,2,3,4,1]));let C=ZG(s,this.kernel.read(),k,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(C=Nt(C,[0,4,1,2,3])),this.bias!==null&&(C=Uo(C,this.bias.read(),this.dataFormat)),this.activation!==null&&(C=this.activation.apply(C)),C})}computeOutputShape(e){e=Ut(e);const n=e.slice();let s,r,i,o;this.dataFormat==="channelsFirst"?(s=1,r=2,i=3,o=4):(s=4,r=1,i=2,o=3);const a=this.kernelSize[0],l=this.kernelSize[1],c=this.kernelSize[2],u=this.strides[0],d=this.strides[1],h=this.strides[2];return n[s]=this.filters,n[r]=ia(n[r],u,a,this.padding),n[i]=ia(n[i],d,l,this.padding),n[o]=ia(n[o],h,c,this.padding),n}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}Aq.className="Conv3DTranspose";ge(Aq);class Rq extends dp{constructor(e,n){if(super(e,n),this.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",this.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",this.depthwiseKernel=null,this.pointwiseKernel=null,n.filters==null)throw new ee("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(n.kernelInitializer!=null||n.kernelRegularizer!=null||n.kernelConstraint!=null)throw new ee("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(n.padding!=null&&n.padding!=="same"&&n.padding!=="valid")throw new ee(`SeparableConv${this.rank}D supports only padding modes: 'same' and 'valid', but received ${JSON.stringify(n.padding)}`);this.depthMultiplier=n.depthMultiplier==null?1:n.depthMultiplier,this.depthwiseInitializer=xn(n.depthwiseInitializer||this.DEFAULT_DEPTHWISE_INITIALIZER),this.depthwiseRegularizer=bn(n.depthwiseRegularizer),this.depthwiseConstraint=fs(n.depthwiseConstraint),this.pointwiseInitializer=xn(n.depthwiseInitializer||this.DEFAULT_POINTWISE_INITIALIZER),this.pointwiseRegularizer=bn(n.pointwiseRegularizer),this.pointwiseConstraint=fs(n.pointwiseConstraint)}build(e){if(e=Ut(e),e.length<this.rank+2)throw new ee(`Inputs to SeparableConv${this.rank}D should have rank ${this.rank+2}, but received input shape: ${JSON.stringify(e)}`);const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null||e[n]<0)throw new ee(`The channel dimension of the inputs should be defined, but found ${JSON.stringify(e[n])}`);const s=e[n],r=this.kernelSize.concat([s,this.depthMultiplier]),i=[];for(let a=0;a<this.rank;++a)i.push(1);i.push(s*this.depthMultiplier,this.filters);const o=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",r,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,o,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",i,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,o,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,o,this.biasConstraint):this.bias=null,this.inputSpec=[new ds({ndim:this.rank+2,axes:{[n]:s}})],this.built=!0}call(e,n){return se(()=>{e=pt(e);let s;if(this.rank===1)throw new ft("1D separable convolution is not implemented yet.");return this.rank===2&&(this.dataFormat==="channelsFirst"&&(e=Nt(e,[0,2,3,1])),s=aR(e,this.depthwiseKernel.read(),this.pointwiseKernel.read(),this.strides,this.padding,this.dilationRate,"NHWC")),this.useBias&&(s=Uo(s,this.bias.read(),this.dataFormat)),this.activation!=null&&(s=this.activation.apply(s)),this.dataFormat==="channelsFirst"&&(s=Nt(s,[0,3,1,2])),s})}getConfig(){const e=super.getConfig();return delete e.rank,delete e.kernelInitializer,delete e.kernelRegularizer,delete e.kernelConstraint,e.depthwiseInitializer=kn(this.depthwiseInitializer),e.pointwiseInitializer=kn(this.pointwiseInitializer),e.depthwiseRegularizer=Qt(this.depthwiseRegularizer),e.pointwiseRegularizer=Qt(this.pointwiseRegularizer),e.depthwiseConstraint=hs(this.depthwiseConstraint),e.pointwiseConstraint=hs(this.pointwiseConstraint),e}}Rq.className="SeparableConv";class Dq extends Rq{constructor(e){super(2,e)}}Dq.className="SeparableConv2D";ge(Dq);class ik extends dp{constructor(e){super(1,e),ik.verifyArgs(e),this.inputSpec=[{ndim:3}]}getConfig(){const e=super.getConfig();return delete e.rank,delete e.dataFormat,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!ZR(e.kernelSize,"number",1,1))throw new ee(`Conv1D expects config.kernelSize to be number or number[] with length 1, but received ${JSON.stringify(e.kernelSize)}.`)}}ik.className="Conv1D";ge(ik);class Oq extends $t{constructor(e){super(e),typeof e.cropping=="number"?this.cropping=[[e.cropping,e.cropping],[e.cropping,e.cropping]]:typeof e.cropping[0]=="number"?this.cropping=[[e.cropping[0],e.cropping[0]],[e.cropping[1],e.cropping[1]]]:this.cropping=e.cropping,this.dataFormat=e.dataFormat===void 0?"channelsLast":e.dataFormat,this.inputSpec=[{ndim:4}]}computeOutputShape(e){return this.dataFormat==="channelsFirst"?[e[0],e[1],e[2]-this.cropping[0][0]-this.cropping[0][1],e[3]-this.cropping[1][0]-this.cropping[1][1]]:[e[0],e[1]-this.cropping[0][0]-this.cropping[0][1],e[2]-this.cropping[1][0]-this.cropping[1][1],e[3]]}call(e,n){return se(()=>{if(e=pt(e),this.dataFormat==="channelsLast"){const s=Kx(e,this.cropping[0][0],e.shape[1]-this.cropping[0][0]-this.cropping[0][1],2);return Kx(s,this.cropping[1][0],e.shape[2]-this.cropping[1][1]-this.cropping[1][0],3)}else{const s=Kx(e,this.cropping[0][0],e.shape[2]-this.cropping[0][0]-this.cropping[0][1],3);return Kx(s,this.cropping[1][0],e.shape[3]-this.cropping[1][1]-this.cropping[1][0],4)}})}getConfig(){const e={cropping:this.cropping,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}Oq.className="Cropping2D";ge(Oq);class Pq extends $t{constructor(e){super(e),this.DEFAULT_SIZE=[2,2],this.inputSpec=[{ndim:4}],this.size=e.size==null?this.DEFAULT_SIZE:e.size,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Kn(this.dataFormat),this.interpolation=e.interpolation==null?"nearest":e.interpolation,XNe(this.interpolation)}computeOutputShape(e){if(this.dataFormat==="channelsFirst"){const n=e[2]==null?null:this.size[0]*e[2],s=e[3]==null?null:this.size[1]*e[3];return[e[0],e[1],n,s]}else{const n=e[1]==null?null:this.size[0]*e[1],s=e[2]==null?null:this.size[1]*e[2];return[e[0],n,s,e[3]]}}call(e,n){return se(()=>{let s=pt(e);const r=s.shape;if(this.dataFormat==="channelsFirst"){s=Nt(s,[0,2,3,1]);const i=this.size[0]*r[2],o=this.size[1]*r[3],a=this.interpolation==="nearest"?ha.resizeNearestNeighbor(s,[i,o]):ha.resizeBilinear(s,[i,o]);return Nt(a,[0,3,1,2])}else{const i=this.size[0]*r[1],o=this.size[1]*r[2];return this.interpolation==="nearest"?ha.resizeNearestNeighbor(s,[i,o]):ha.resizeBilinear(s,[i,o])}})}getConfig(){const e={size:this.size,dataFormat:this.dataFormat,interpolation:this.interpolation},n=super.getConfig();return Object.assign(e,n),e}}Pq.className="UpSampling2D";ge(Pq);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function kIe(t,e,n=[1,1],s="valid",r,i){return se(()=>{r==null&&(r=jo()),Kn(r);let o=hD(t,r);if(t.rank!==4)throw new ee(`Input for depthwiseConv2d is required to be 4-D, but is instead ${t.rank}-D`);if(e.rank!==4)throw new ee(`depthwiseKernel is required to be 4-D, but is instead ${e.rank}-D`);return o=v0(o,e,n,s==="same"?"same":"valid","NHWC",i),r==="channelsFirst"&&(o=Nt(o,[0,3,1,2])),o})}class Fq extends rk{constructor(e){super(2,e),this.depthwiseKernel=null,this.depthMultiplier=e.depthMultiplier==null?1:e.depthMultiplier,this.depthwiseInitializer=xn(e.depthwiseInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.depthwiseConstraint=fs(e.depthwiseConstraint),this.depthwiseRegularizer=bn(e.depthwiseRegularizer)}build(e){if(e=Ut(e),e.length<4)throw new ee(`Inputs to DepthwiseConv2D should have rank 4. Received input shape: ${JSON.stringify(e)}.`);const n=this.dataFormat==="channelsFirst"?1:3;if(e[n]==null||e[n]<0)throw new ee(`The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not (${e[n]}).`);const s=e[n],r=[this.kernelSize[0],this.kernelSize[1],s,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",r,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[s*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,n){return se(()=>{e=pt(e);let s=kIe(e,this.depthwiseKernel.read(),this.strides,this.padding,this.dataFormat,null);return this.useBias&&(s=Uo(s,this.bias.read(),this.dataFormat)),this.activation!=null&&(s=this.activation.apply(s)),s})}computeOutputShape(e){e=Ut(e);const n=this.dataFormat==="channelsFirst"?e[2]:e[1],s=this.dataFormat==="channelsFirst"?e[3]:e[2],r=this.dataFormat==="channelsFirst"?e[1]*this.depthMultiplier:e[3]*this.depthMultiplier,i=Do(n,this.kernelSize[0],this.padding,this.strides[0]),o=Do(s,this.kernelSize[1],this.padding,this.strides[1]);return this.dataFormat==="channelsFirst"?[e[0],r,i,o]:[e[0],i,o,r]}getConfig(){const e=super.getConfig();return e.depthMultiplier=this.depthMultiplier,e.depthwiseInitializer=kn(this.depthwiseInitializer),e.depthwiseRegularizer=Qt(this.depthwiseRegularizer),e.depthwiseConstraint=hs(this.depthwiseRegularizer),e}}Fq.className="DepthwiseConv2D";ge(Fq);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Lq(t,e,n,s){if(Array.isArray(t)){if(e!=null||n!=null)throw new ee("When inputs is an array, neither initialState or constants should be provided");s!=null&&(n=t.slice(t.length-s,t.length),t=t.slice(0,t.length-s)),t.length>1&&(e=t.slice(1,t.length)),t=t[0]}function r(i){return i==null||Array.isArray(i)?i:[i]}return e=r(e),n=r(n),{inputs:t,initialState:e,constants:n}}function Mq(t,e,n,s=!1,r,i,o=!1,a=!1){return se(()=>{const l=e.shape.length;if(l<3)throw new ee(`Input should be at least 3D, but is ${l}D.`);const c=[1,0].concat(Vo(2,l));if(e=Nt(e,c),i!=null)throw new ft("The rnn() functoin of the deeplearn.js backend does not support constants yet.");o&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),r!=null&&(r=Te(Te(r,"bool"),"float32"),r.rank===l-1&&(r=as(r,-1)),r=Nt(r,c)),s&&(e=ao(e,0),r!=null&&(r=ao(r,0)));const u=[];let d,h=n;const f=e.shape[0],p=zo(e);let m;r!=null&&(m=zo(r));for(let y=0;y<f;++y){const x=p[y],v=se(()=>t(x,h));if(r==null)d=v[0],h=v[1];else{const b=se(()=>{const k=m[y],C=Ae(Ni(k),k),N=fe(Y(v[0],k),Y(h[0],C)),I=h.map(($,A)=>fe(Y(v[1][A],k),Y($,C)));return{output:N,newStates:I}});d=b.output,h=b.newStates}a&&u.push(d)}let g;return a&&(g=lo(u,1)),[d,g,h]})}class au extends $t{constructor(e){super(e);let n;if(e.cell==null)throw new ee("cell property is missing for the constructor of RNN.");if(Array.isArray(e.cell)?n=new mD({cells:e.cell}):n=e.cell,n.stateSize==null)throw new ee("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");this.cell=n,this.returnSequences=e.returnSequences==null?!1:e.returnSequences,this.returnState=e.returnState==null?!1:e.returnState,this.goBackwards=e.goBackwards==null?!1:e.goBackwards,this._stateful=e.stateful==null?!1:e.stateful,this.unroll=e.unroll==null?!1:e.unroll,this.supportsMasking=!0,this.inputSpec=[new ds({ndim:3})],this.stateSpec=null,this.states_=null,this.numConstants=null,this.keptStates=[]}getStates(){if(this.states_==null){const e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;return Vo(0,e).map(n=>null)}else return this.states_}setStates(e){this.states_=e}computeOutputShape(e){yI(e)&&(e=e[0]),e=e;let n=this.cell.stateSize;Array.isArray(n)||(n=[n]);const s=n[0];let r;if(this.returnSequences?r=[e[0],e[1],s]:r=[e[0],s],this.returnState){const i=[];for(const o of n)i.push([e[0],o]);return[r].concat(i)}else return r}computeMask(e,n){return se(()=>{Array.isArray(n)&&(n=n[0]);const s=this.returnSequences?n:null;if(this.returnState){const r=this.states.map(i=>null);return[s].concat(r)}else return s})}get states(){if(this.states_==null){const e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,n=[];for(let s=0;s<e;++s)n.push(null);return n}else return this.states_}set states(e){this.states_=e}build(e){if(this.numConstants!=null)throw new ft("Constants support is not implemented in RNN yet.");yI(e)&&(e=e[0]),e=e;const n=this.stateful?e[0]:null,s=e.slice(2);this.inputSpec[0]=new ds({shape:[n,null,...s]});const r=[e[0]].concat(e.slice(2));this.cell.build(r);let i;if(Array.isArray(this.cell.stateSize)?i=this.cell.stateSize:i=[this.cell.stateSize],this.stateSpec!=null){if(!Et(this.stateSpec.map(o=>o.shape[o.shape.length-1]),i))throw new ee(`An initialState was passed that is not compatible with cell.stateSize. Received stateSpec=${this.stateSpec}; However cell.stateSize is ${this.cell.stateSize}`)}else this.stateSpec=i.map(o=>new ds({shape:[null,o]}));this.stateful&&this.resetStates()}resetStates(e,n=!1){se(()=>{if(!this.stateful)throw new sa("Cannot call resetStates() on an RNN Layer that is not stateful.");const s=this.inputSpec[0].shape[0];if(s==null)throw new ee("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.states_==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(r=>es([s,r])):this.states_=[es([s,this.cell.stateSize])];else if(e==null)rt(this.states_),this.keptStates!=null&&(rt(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(r=>es([s,r])):this.states_[0]=es([s,this.cell.stateSize]);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new ee(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);n===!0?this.keptStates.push(this.states_.slice()):rt(this.states_);for(let r=0;r<this.states_.length;++r){const i=e[r],o=Array.isArray(this.cell.stateSize)?this.cell.stateSize[r]:this.cell.stateSize,a=[s,o];if(!Et(i.shape,a))throw new ee(`State ${r} is incompatible with layer ${this.name}: expected shape=${a}, received shape=${i.shape}`);this.states_[r]=i}}this.states_=this.states_.map(r=>Ps(r.clone()))})}apply(e,n){let s=n==null?null:n.initialState,r=n==null?null:n.constants;n==null&&(n={});const i=Lq(e,s,r,this.numConstants);e=i.inputs,s=i.initialState,r=i.constants;let o=[],a=[];if(s!=null){n.initialState=s,o=o.concat(s),this.stateSpec=[];for(const c of s)this.stateSpec.push(new ds({shape:c.shape}));a=a.concat(this.stateSpec)}if(r!=null&&(n.constants=r,o=o.concat(r),this.numConstants=r.length),o[0]instanceof fa){const c=[e].concat(o),u=this.inputSpec.concat(a),d=this.inputSpec;this.inputSpec=u;const h=super.apply(c,n);return this.inputSpec=d,h}else return super.apply(e,n)}call(e,n){return se(()=>{const s=n==null?null:n.mask,r=n==null?null:n.training;let i=n==null?null:n.initialState;e=pt(e),i==null&&(this.stateful?i=this.states_:i=this.getInitialState(e));const o=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;if(i.length!==o)throw new ee(`RNN Layer has ${o} state(s) but was passed ${i.length} initial state(s).`);this.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");const a={training:r},c=Mq((p,m)=>{const g=this.cell.call([p].concat(m),a);return[g[0],g.slice(1)]},e,i,this.goBackwards,s,null,this.unroll,this.returnSequences),u=c[0],d=c[1],h=c[2];this.stateful&&this.resetStates(h,r);const f=this.returnSequences?d:u;return this.returnState?[f].concat(h):f})}getInitialState(e){return se(()=>{let n=es(e.shape);return n=Be(n,[1,2]),n=E0(n),Array.isArray(this.cell.stateSize)?this.cell.stateSize.map(s=>s>1?mI(n,[1,s]):n):this.cell.stateSize>1?[mI(n,[1,this.cell.stateSize])]:[n]})}get trainableWeights(){return this.trainable?this.cell.trainableWeights:[]}get nonTrainableWeights(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.cell!=null&&this.cell.setFastWeightInitDuringBuild(e)}getConfig(){const e=super.getConfig(),n={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};this.numConstants!=null&&(n.numConstants=this.numConstants);const s=this.cell.getConfig();return this.getClassName()===au.className&&(n.cell={className:this.cell.getClassName(),config:s}),Object.assign({},s,e,n)}static fromConfig(e,n,s={}){const r=n.cell,i=Ta(r,s);return new e(Object.assign(n,{cell:i}))}}au.className="RNN";ge(au);class ok extends $t{}class fD extends ok{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,Ss(this.units,"units"),this.activation=Hc(e.activation==null?this.DEFAULT_ACTIVATION:e.activation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=xn(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=xn(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=xn(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=bn(e.kernelRegularizer),this.recurrentRegularizer=bn(e.recurrentRegularizer),this.biasRegularizer=bn(e.biasRegularizer),this.kernelConstraint=fs(e.kernelConstraint),this.recurrentConstraint=fs(e.recurrentConstraint),this.biasConstraint=fs(e.biasConstraint),this.dropout=Lf([1,Wc([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=Lf([1,Wc([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=Ut(e),this.kernel=this.addWeight("kernel",[e[e.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,n){return se(()=>{if(e=e,e.length!==2)throw new ee(`SimpleRNNCell expects 2 input Tensors, got ${e.length}.`);let s=e[1];e=e[0];const r=n.training==null?!1:n.training;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Gc({ones:()=>Ni(e),rate:this.dropout,training:r,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Gc({ones:()=>Ni(s),rate:this.recurrentDropout,training:r,dropoutFunc:this.dropoutFunc}));let i;const o=this.dropoutMask,a=this.recurrentDropoutMask;o!=null?i=Ca(Y(e,o),this.kernel.read()):i=Ca(e,this.kernel.read()),this.bias!=null&&(i=Uo(i,this.bias.read())),a!=null&&(s=Y(s,a));let l=fe(i,Ca(s,this.recurrentKernel.read()));return this.activation!=null&&(l=this.activation.apply(l)),[l,l]})}getConfig(){const e=super.getConfig(),n={units:this.units,activation:Uc(this.activation),useBias:this.useBias,kernelInitializer:kn(this.kernelInitializer),recurrentInitializer:kn(this.recurrentInitializer),biasInitializer:kn(this.biasInitializer),kernelRegularizer:Qt(this.kernelRegularizer),recurrentRegularizer:Qt(this.recurrentRegularizer),biasRegularizer:Qt(this.biasRegularizer),activityRegularizer:Qt(this.activityRegularizer),kernelConstraint:hs(this.kernelConstraint),recurrentConstraint:hs(this.recurrentConstraint),biasConstraint:hs(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign({},e,n)}}fD.className="SimpleRNNCell";ge(fD);class zq extends au{constructor(e){e.cell=new fD(e),super(e)}call(e,n){return se(()=>{this.cell.dropoutMask!=null&&(rt(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(rt(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const s=n==null?null:n.mask,r=n==null?null:n.training,i=n==null?null:n.initialState;return super.call(e,{mask:s,training:r,initialState:i})})}static fromConfig(e,n){return new e(n)}}zq.className="SimpleRNN";ge(zq);class pD extends ok{constructor(e){if(super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.resetAfter)throw new ee("GRUCell does not support reset_after parameter set to true.");this.units=e.units,Ss(this.units,"units"),this.activation=Hc(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=Hc(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=xn(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=xn(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=xn(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=bn(e.kernelRegularizer),this.recurrentRegularizer=bn(e.recurrentRegularizer),this.biasRegularizer=bn(e.biasRegularizer),this.kernelConstraint=fs(e.kernelConstraint),this.recurrentConstraint=fs(e.recurrentConstraint),this.biasConstraint=fs(e.biasConstraint),this.dropout=Lf([1,Wc([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=Lf([1,Wc([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=Ut(e);const n=e[e.length-1];this.kernel=this.addWeight("kernel",[n,this.units*3],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*3],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units*3],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,n){return se(()=>{if(e=e,e.length!==2)throw new ee(`GRUCell expects 2 input Tensors (inputs, h, c), got ${e.length}.`);const s=n.training==null?!1:n.training;let r=e[1];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Gc({ones:()=>Ni(e),rate:this.dropout,training:s,count:3,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Gc({ones:()=>Ni(r),rate:this.recurrentDropout,training:s,count:3,dropoutFunc:this.dropoutFunc}));const i=this.dropoutMask,o=this.recurrentDropoutMask;let a,l,c;0<this.dropout&&this.dropout<1&&(e=Y(e,i[0]));let u=Ca(e,this.kernel.read());this.useBias&&(u=Uo(u,this.bias.read())),0<this.recurrentDropout&&this.recurrentDropout<1&&(r=Y(r,o[0]));const d=this.recurrentKernel.read(),[h,f]=Yr(d,[2*this.units,this.units],d.rank-1),p=Ca(r,h),[m,g,y]=Yr(u,3,u.rank-1),[x,v]=Yr(p,2,p.rank-1);a=this.recurrentActivation.apply(fe(m,x)),l=this.recurrentActivation.apply(fe(g,v));const b=Ca(Y(l,r),f);c=this.activation.apply(fe(y,b));const k=fe(Y(a,r),Y(fe(1,vn(a)),c));return[k,k]})}getConfig(){const e=super.getConfig(),n={units:this.units,activation:Uc(this.activation),recurrentActivation:Uc(this.recurrentActivation),useBias:this.useBias,kernelInitializer:kn(this.kernelInitializer),recurrentInitializer:kn(this.recurrentInitializer),biasInitializer:kn(this.biasInitializer),kernelRegularizer:Qt(this.kernelRegularizer),recurrentRegularizer:Qt(this.recurrentRegularizer),biasRegularizer:Qt(this.biasRegularizer),activityRegularizer:Qt(this.activityRegularizer),kernelConstraint:hs(this.kernelConstraint),recurrentConstraint:hs(this.recurrentConstraint),biasConstraint:hs(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign({},e,n)}}pD.className="GRUCell";ge(pD);class Vq extends au{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new pD(e),super(e)}call(e,n){return se(()=>{this.cell.dropoutMask!=null&&(rt(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(rt(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const s=n==null?null:n.mask,r=n==null?null:n.training,i=n==null?null:n.initialState;return super.call(e,{mask:s,training:r,initialState:i})})}static fromConfig(e,n){return n.implmentation===0&&(n.implementation=1),new e(n)}}Vq.className="GRU";ge(Vq);class ak extends ok{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,Ss(this.units,"units"),this.activation=Hc(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=Hc(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=xn(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=xn(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=xn(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.unitForgetBias=e.unitForgetBias,this.kernelRegularizer=bn(e.kernelRegularizer),this.recurrentRegularizer=bn(e.recurrentRegularizer),this.biasRegularizer=bn(e.biasRegularizer),this.kernelConstraint=fs(e.kernelConstraint),this.recurrentConstraint=fs(e.recurrentConstraint),this.biasConstraint=fs(e.biasConstraint),this.dropout=Lf([1,Wc([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=Lf([1,Wc([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=[this.units,this.units],this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){var n;e=Ut(e);const s=e[e.length-1];this.kernel=this.addWeight("kernel",[s,this.units*4],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*4],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint);let r;if(this.useBias){if(this.unitForgetBias){const i=this.biasInitializer,o=this.units;r=new(n=class extends ho{apply(l,c){const u=i.apply([o]),d=new JR().apply([o]),h=i.apply([o*2]);return zz(zz(u,d),h)}},n.className="CustomInit",n)}else r=this.biasInitializer;this.bias=this.addWeight("bias",[this.units*4],null,r,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}call(e,n){return se(()=>{const s=n.training==null?!1:n.training;if(e=e,e.length!==3)throw new ee(`LSTMCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);let r=e[1];const i=e[2];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Gc({ones:()=>Ni(e),rate:this.dropout,training:s,count:4,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Gc({ones:()=>Ni(r),rate:this.recurrentDropout,training:s,count:4,dropoutFunc:this.dropoutFunc}));const o=this.dropoutMask,a=this.recurrentDropoutMask;let l,c,u,d;0<this.dropout&&this.dropout<1&&(e=Y(e,o[0]));let h=Ca(e,this.kernel.read());0<this.recurrentDropout&&this.recurrentDropout<1&&(r=Y(r,a[0])),h=fe(h,Ca(r,this.recurrentKernel.read())),this.useBias&&(h=Uo(h,this.bias.read()));const[f,p,m,g]=Yr(h,4,h.rank-1);l=this.recurrentActivation.apply(f),c=this.recurrentActivation.apply(p),u=fe(Y(c,i),Y(l,this.activation.apply(m))),d=this.recurrentActivation.apply(g);const y=Y(d,this.activation.apply(u));return[y,y,u]})}getConfig(){const e=super.getConfig(),n={units:this.units,activation:Uc(this.activation),recurrentActivation:Uc(this.recurrentActivation),useBias:this.useBias,kernelInitializer:kn(this.kernelInitializer),recurrentInitializer:kn(this.recurrentInitializer),biasInitializer:kn(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:Qt(this.kernelRegularizer),recurrentRegularizer:Qt(this.recurrentRegularizer),biasRegularizer:Qt(this.biasRegularizer),activityRegularizer:Qt(this.activityRegularizer),kernelConstraint:hs(this.kernelConstraint),recurrentConstraint:hs(this.recurrentConstraint),biasConstraint:hs(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign({},e,n)}}ak.className="LSTMCell";ge(ak);class jq extends au{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new ak(e),super(e)}call(e,n){return se(()=>{this.cell.dropoutMask!=null&&(rt(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(rt(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const s=n==null?null:n.mask,r=n==null?null:n.training,i=n==null?null:n.initialState;return super.call(e,{mask:s,training:r,initialState:i})})}static fromConfig(e,n){return n.implmentation===0&&(n.implementation=1),new e(n)}}jq.className="LSTM";ge(jq);class mD extends ok{constructor(e){super(e),this.cells=e.cells}get stateSize(){const e=[];for(const n of this.cells.slice().reverse())Array.isArray(n.stateSize)?e.push(...n.stateSize):e.push(n.stateSize);return e}call(e,n){return se(()=>{e=e;let s=e.slice(1);const r=[];for(const a of this.cells.slice().reverse())Array.isArray(a.stateSize)?r.push(s.splice(0,a.stateSize.length)):r.push(s.splice(0,1));r.reverse();const i=[];let o;for(let a=0;a<this.cells.length;++a){const l=this.cells[a];s=r[a],a===0?o=[e[0]].concat(s):o=[o[0]].concat(s),o=l.call(o,n),i.push(o.slice(1))}s=[];for(const a of i.slice().reverse())s.push(...a);return[o[0]].concat(s)})}build(e){yI(e)&&(e=e[0]),e=e;let n;this.cells.forEach((s,r)=>{rd(`RNNCell_${r}`,()=>{s.build(e),Array.isArray(s.stateSize)?n=s.stateSize[0]:n=s.stateSize,e=[e[0],n]})}),this.built=!0}getConfig(){const e=super.getConfig(),n=i=>({className:i.getClassName(),config:i.getConfig()}),r={cells:this.cells.map(n)};return Object.assign({},e,r)}static fromConfig(e,n,s={}){const r=[];for(const i of n.cells)r.push(Ta(i,s));return new e({cells:r})}get trainableWeights(){if(!this.trainable)return[];const e=[];for(const n of this.cells)e.push(...n.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const n of this.cells)e.push(...n.nonTrainableWeights);if(!this.trainable){const n=[];for(const s of this.cells)n.push(...s.trainableWeights);return n.concat(e)}return e}getWeights(){const e=[];for(const n of this.cells)e.push(...n.weights);return xI(e)}setWeights(e){const n=[];for(const s of this.cells){const r=s.weights.length,i=e.splice(r);for(let o=0;o<s.weights.length;++o)n.push([s.weights[o],i[o]])}oD(n)}}mD.className="StackedRNNCells";ge(mD);function Gc(t){const{ones:e,rate:n,training:s=!1,count:r=1,dropoutFunc:i}=t,o=()=>i!=null?i(e(),n):OK(e(),n),a=()=>A0(o,e,s);return!r||r<=1?Ps(a().clone()):Array(r).fill(void 0).map(a).map(c=>Ps(c.clone()))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var CIe=globalThis&&globalThis.__rest||function(t,e){var n={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(n[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,s=Object.getOwnPropertySymbols(t);r<s.length;r++)e.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(t,s[r])&&(n[s[r]]=t[s[r]]);return n};class Bq extends au{constructor(e){if(e.unroll)throw new ft("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(e.cell))throw new ft("It is not possible at the moment to stack convolutional cells.");super(e),this.inputSpec=[new ds({ndim:5})]}call(e,n){return se(()=>{if(this.cell.dropoutMask!=null&&(rt(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(rt(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),n&&n.constants)throw new ee("ConvRNN2D cell does not support constants");const s=n==null?null:n.mask,r=n==null?null:n.training,i=n==null?null:n.initialState;return super.call(e,{mask:s,training:r,initialState:i})})}computeOutputShape(e){let n=this.computeSingleOutputShape(e);return this.returnSequences||(n=[n[0],...n.slice(2)]),this.returnState&&(n=[n,...Array(2).fill([e[0],...n.slice(-3)])]),n}getInitialState(e){return se(()=>{const{stateSize:n}=this.cell,s=e.shape,r=this.computeSingleOutputShape(s),i=[r[0],...r.slice(2)],o=es(i);return Array.isArray(n)?Array(n.length).fill(o):[o]})}resetStates(e,n=!1){se(()=>{if(!this.stateful)throw new sa("Cannot call resetStates() on an RNN Layer that is not stateful.");const s=this.inputSpec[0].shape,r=this.computeSingleOutputShape(s),i=[r[0],...r.slice(2)];if(s[0]==null)throw new ee("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.getStates()==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>es(i)):this.states_=[es(i)];else if(e==null)rt(this.states_),this.keptStates!=null&&(rt(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>es(i)):this.states_[0]=es(i);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new ee(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);n?this.keptStates.push(this.states_.slice()):rt(this.states_);for(let a=0;a<this.states_.length;++a){const l=e[a],c=i;if(!Et(l.shape,c))throw new ee(`State ${a} is incompatible with layer ${this.name}: expected shape=${c}, received shape=${l.shape}`);this.states_[a]=l}}this.states_=this.states_.map(a=>Ps(a.clone()))})}computeSingleOutputShape(e){const{dataFormat:n,filters:s,kernelSize:r,padding:i,strides:o,dilationRate:a}=this.cell,l=n==="channelsFirst",c=e[l?3:2],u=e[l?4:3],d=Do(c,r[0],i,o[0],a[0]),h=Do(u,r[1],i,o[1],a[1]);return[...e.slice(0,2),...l?[s,d,h]:[d,h,s]]}}Bq.className="ConvRNN2D";class gD extends ak{constructor(e){const{filters:n,kernelSize:s,strides:r,padding:i,dataFormat:o,dilationRate:a}=e;super(Object.assign({},e,{units:n})),this.filters=n,Ss(this.filters,"filters"),this.kernelSize=qh(s,2,"kernelSize"),this.kernelSize.forEach(l=>Ss(l,"kernelSize")),this.strides=qh(r||1,2,"strides"),this.strides.forEach(l=>Ss(l,"strides")),this.padding=i||"valid",$i(this.padding),this.dataFormat=o||"channelsLast",Kn(this.dataFormat),this.dilationRate=qh(a||1,2,"dilationRate"),this.dilationRate.forEach(l=>Ss(l,"dilationRate"))}build(e){var n;e=Ut(e);const s=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[s]==null)throw new ee(`The channel dimension of the input should be defined. Found ${e[s]}`);const r=e[s],i=4,o=this.kernelSize.concat([r,this.filters*i]);this.kernel=this.addWeight("kernel",o,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);const a=this.kernelSize.concat([this.filters,this.filters*i]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",a,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){let l;if(this.unitForgetBias){const c=this.biasInitializer,u=this.filters;l=new(n=class extends ho{apply(h,f){const p=c.apply([u]),m=gi([u]),g=c.apply([u*2]);return QR([p,m,g])}},n.className="CustomInit",n)}else l=this.biasInitializer;this.bias=this.addWeight("bias",[this.filters*i],null,l,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}call(e,n){return se(()=>{if(e.length!==3)throw new ee(`ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);const s=n.training||!1,r=e[0],i=e[1],o=e[2],a=4;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Gc({ones:()=>Ni(r),rate:this.dropout,training:s,count:a,dropoutFunc:this.dropoutFunc}));const l=this.dropoutMask,c=(ne,ie,de)=>!ie||!ie[de]?ne:Y(ie[de],ne);let u=c(r,l,0),d=c(r,l,1),h=c(r,l,2),f=c(r,l,3);0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Gc({ones:()=>Ni(i),rate:this.recurrentDropout,training:s,count:a,dropoutFunc:this.dropoutFunc}));const p=this.recurrentDropoutMask;let m=c(i,p,0),g=c(i,p,1),y=c(i,p,2),x=c(i,p,3);const v=3,[b,k,C,N]=Yr(this.kernel.read(),a,v),[I,$,A,P]=this.useBias?Yr(this.bias.read(),a):[null,null,null,null];u=this.inputConv(u,b,I,this.padding),d=this.inputConv(d,k,$,this.padding),h=this.inputConv(h,C,A,this.padding),f=this.inputConv(f,N,P,this.padding);const[F,V,z,B]=Yr(this.recurrentKernel.read(),a,v);m=this.recurrentConv(m,F),g=this.recurrentConv(g,V),y=this.recurrentConv(y,z),x=this.recurrentConv(x,B);const W=this.recurrentActivation.apply(fe(u,m)),q=this.recurrentActivation.apply(fe(d,g)),M=fe(Y(q,o),Y(W,this.activation.apply(fe(h,y)))),G=Y(this.recurrentActivation.apply(fe(f,x)),this.activation.apply(M));return[G,G,M]})}getConfig(){const e=super.getConfig(),n=CIe(e,["units"]),s={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign({},n,s)}inputConv(e,n,s,r){const i=jc(e,n,this.strides,r||"valid",this.dataFormat==="channelsFirst"?"NCHW":"NHWC",this.dilationRate);return s?Uo(i,s,this.dataFormat):i}recurrentConv(e,n){return jc(e,n,1,"same",this.dataFormat==="channelsFirst"?"NCHW":"NHWC")}}gD.className="ConvLSTM2DCell";ge(gD);class Wq extends Bq{constructor(e){const n=new gD(e);super(Object.assign({},e,{cell:n}))}static fromConfig(e,n){return new e(n)}}Wq.className="ConvLSTM2D";ge(Wq);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class yD extends $t{constructor(e){super(e),this.rate=Math.max(Math.min(e.rate,1),0),this.noiseShape=e.noiseShape,this.seed=e.seed,this.supportsMasking=!0}getNoiseShape(e){if(this.noiseShape==null)return this.noiseShape;const n=e.shape,s=[];for(let r=0;r<this.noiseShape.length;++r)s.push(this.noiseShape[r]==null?n[r]:this.noiseShape[r]);return s}call(e,n){return se(()=>{this.invokeCallHook(e,n);const s=pt(e);if(0<this.rate&&this.rate<1){const r=n.training==null?!1:n.training,i=this.getNoiseShape(s);return A0(()=>OK(s,this.rate,i,this.seed),()=>s,r)}return e})}getConfig(){const e={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},n=super.getConfig();return Object.assign(e,n),e}dispose(){return super.dispose()}}yD.className="Dropout";ge(yD);class Uq extends yD{constructor(e){super(e),this.inputSpec=[{ndim:3}]}getNoiseShape(e){const n=e.shape;return[n[0],1,n[2]]}}Uq.className="SpatialDropout1D";ge(Uq);class Hq extends $t{constructor(e){if(super(e),this.activation=null,this.useBias=!0,this.kernel=null,this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.batchInputShape==null&&e.inputShape==null&&e.inputDim!=null){let n=null;e.batchSize!=null&&(n=e.batchSize),this.batchInputShape=[n,e.inputDim]}this.units=e.units,Ss(this.units,"units"),this.activation=Hc(e.activation),e.useBias!=null&&(this.useBias=e.useBias),this.kernelInitializer=xn(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.biasInitializer=xn(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelConstraint=fs(e.kernelConstraint),this.biasConstraint=fs(e.biasConstraint),this.kernelRegularizer=bn(e.kernelRegularizer),this.biasRegularizer=bn(e.biasRegularizer),this.activityRegularizer=bn(e.activityRegularizer),this.supportsMasking=!0,this.inputSpec=[{minNDim:2}]}build(e){e=Ut(e);const n=e[e.length-1];this.kernel==null&&(this.kernel=this.addWeight("kernel",[n,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:{[-1]:n}}],this.built=!0}computeOutputShape(e){e=Ut(e);const n=e.slice();return n[n.length-1]=this.units,n}call(e,n){return se(()=>{this.invokeCallHook(e,n);const s=pt(e),r=IK(this.activation.getClassName());let i;return r!=null?i=Ca(s,this.kernel.read(),r,this.bias?this.bias.read():null):(i=Ca(s,this.kernel.read()),this.bias!=null&&(i=Uo(i,this.bias.read())),this.activation!=null&&(i=this.activation.apply(i))),i})}getConfig(){const e={units:this.units,activation:Uc(this.activation),useBias:this.useBias,kernelInitializer:kn(this.kernelInitializer),biasInitializer:kn(this.biasInitializer),kernelRegularizer:Qt(this.kernelRegularizer),biasRegularizer:Qt(this.biasRegularizer),activityRegularizer:Qt(this.activityRegularizer),kernelConstraint:hs(this.kernelConstraint),biasConstraint:hs(this.biasConstraint)},n=super.getConfig();return Object.assign(e,n),e}}Hq.className="Dense";ge(Hq);class Gq extends $t{constructor(e){e=e||{},super(e),this.inputSpec=[{minNDim:3}],this.dataFormat=e.dataFormat}computeOutputShape(e){e=Ut(e);for(const n of e.slice(1))if(n==null)throw new ee(`The shape of the input to "Flatten" is not fully defined (got ${e.slice(1)}). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.`);return[e[0],Ic(e,1)]}call(e,n){return se(()=>{this.invokeCallHook(e,n);let s=pt(e);if(this.dataFormat==="channelsFirst"&&s.rank>1){const r=[0];for(let i=2;i<s.rank;++i)r.push(i);r.push(1),s=Nt(s,r)}return t2e(s)})}getConfig(){const e={};this.dataFormat!=null&&(e.dataFormat=this.dataFormat);const n=super.getConfig();return Object.assign(e,n),e}}Gq.className="Flatten";ge(Gq);class Kq extends $t{constructor(e){super(e),this.supportsMasking=!0,this.activation=Hc(e.activation)}call(e,n){return se(()=>{this.invokeCallHook(e,n);const s=pt(e);return this.activation.apply(s)})}getConfig(){const e={activation:Uc(this.activation)},n=super.getConfig();return Object.assign(e,n),e}}Kq.className="Activation";ge(Kq);class qq extends $t{constructor(e){super(e),this.n=e.n,this.inputSpec=[{ndim:2}]}computeOutputShape(e){return[e[0],this.n,e[1]]}call(e,n){return se(()=>(e=pt(e),JNe(e,this.n)))}getConfig(){const e={n:this.n},n=super.getConfig();return Object.assign(e,n),e}}qq.className="RepeatVector";ge(qq);class Xq extends $t{constructor(e){super(e),this.targetShape=e.targetShape;for(let n=0;n<this.targetShape.length;++n)this.isUnknown(this.targetShape[n])&&(this.targetShape[n]=null)}isUnknown(e){return e<0||e==null}fixUnknownDimension(e,n){const s="Total size of new array must be unchanged.",r=n.slice();let i=1,o=null;for(let l=0;l<r.length;++l){const c=r[l];if(this.isUnknown(c))if(o===null)o=l;else throw new ee("Can only specifiy one unknown dimension.");else i*=c}const a=Ic(e);if(o!==null){if(i===0||a%i!==0)throw new ee(s);r[o]=a/i}else if(a!==i)throw new ee(s);return r}computeOutputShape(e){let n=!1;for(let s=0;s<e.length;++s)if(this.isUnknown(e[s])){n=!0;break}return n?e.slice(0,1).concat(this.targetShape):e.slice(0,1).concat(this.fixUnknownDimension(e.slice(1),this.targetShape))}call(e,n){return se(()=>{this.invokeCallHook(e,n);const s=pt(e),r=s.shape,i=r.slice(0,1).concat(this.fixUnknownDimension(r.slice(1),this.targetShape));return Q(s,i)})}getConfig(){const e={targetShape:this.targetShape},n=super.getConfig();return Object.assign(e,n),e}}Xq.className="Reshape";ge(Xq);class Yq extends $t{constructor(e){if(super(e),e.dims==null)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(e.dims))throw new Error(`Permute constructor requires \`dims\` to be an Array, but received ${e.dims} instead.`);const n=Vo(1,e.dims.length+1);if(!Et(e.dims.slice().sort(),n))throw new Error("Invalid permutation `dims`: "+JSON.stringify(e.dims)+" `dims` must contain consecutive integers starting from 1.");this.dims=e.dims,this.dimsIncludingBatch=[0].concat(this.dims),this.inputSpec=[new ds({ndim:this.dims.length+1})]}computeOutputShape(e){e=Ut(e);const n=e.slice();return this.dims.forEach((s,r)=>{n[r+1]=e[s]}),n}call(e,n){return Nt(pt(e),this.dimsIncludingBatch)}getConfig(){const e={dims:this.dims},n=super.getConfig();return Object.assign(e,n),e}}Yq.className="Permute";ge(Yq);class Zq extends $t{constructor(e){super(e??{}),this.supportsMasking=!0,e!=null?this.maskValue=e.maskValue==null?0:e.maskValue:this.maskValue=0}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={maskValue:this.maskValue};return Object.assign(n,e),n}computeMask(e,n){const s=pt(e),r=-1;return tw(Pf(s,this.maskValue),r)}call(e,n){return se(()=>{this.invokeCallHook(e,n);const s=pt(e),r=-1,i=!0,o=tw(Pf(s,this.maskValue),r,i);return Y(s,Te(o,s.dtype))})}}Zq.className="Masking";ge(Zq);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Qq extends $t{constructor(e){if(super(e),this.embeddings=null,this.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",e.batchInputShape==null&&e.inputShape==null){let n=null;e.batchSize!=null&&(n=e.batchSize),e.inputLength==null?this.batchInputShape=[n,null]:this.batchInputShape=[n].concat(ln(e.inputLength))}this.inputDim=e.inputDim,Ss(this.inputDim,"inputDim"),this.outputDim=e.outputDim,Ss(this.outputDim,"outputDim"),this.embeddingsInitializer=xn(e.embeddingsInitializer||this.DEFAULT_EMBEDDINGS_INITIALIZER),this.embeddingsRegularizer=bn(e.embeddingsRegularizer),this.activityRegularizer=bn(e.activityRegularizer),this.embeddingsConstraint=fs(e.embeddingsConstraint),this.maskZero=e.maskZero,this.supportsMasking=e.maskZero,this.inputLength=e.inputLength}build(e){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}warnOnIncompatibleInputShape(e){}computeMask(e,n){return se(()=>this.maskZero?(e=pt(e),Pf(e,_t(e))):null)}computeOutputShape(e){if(e=Ut(e),this.inputLength==null)return[...e,this.outputDim];const n=ln(this.inputLength);if(n.length!==e.length-1)throw new ee(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);{let s=0;for(let r=0;r<n.length;++r){const i=n[r],o=e[r+1];if(i!=null&&o!=null&&i!==o)throw new ee(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);i==null&&(n[s]=o),s++}}return[e[0],...n,this.outputDim]}call(e,n){return se(()=>{this.invokeCallHook(e,n);let s=pt(e);s.dtype!=="int32"&&(s=_0(s,"int32"));const r=DK(this.embeddings.read(),Q(s,[s.size]));return Q(r,Ut(this.computeOutputShape(s.shape)))})}getConfig(){const e={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:kn(this.embeddingsInitializer),embeddingsRegularizer:Qt(this.embeddingsRegularizer),activityRegularizer:Qt(this.activityRegularizer),embeddingsConstraint:hs(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},n=super.getConfig();return Object.assign(e,n),e}}Qq.className="Embedding";ge(Qq);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Bd extends $t{constructor(e){super(e||{}),this.supportsMasking=!0}mergeFunction(e){throw new ft}computeElementwiseOpOutputShape(e,n){if(e==null||n==null)return null;if(e.length<n.length)return this.computeElementwiseOpOutputShape(n,e);if(n.length===0)return e;const s=e.slice(0,e.length-n.length);for(let r=0;r<n.length;++r){const i=e[e.length-n.length+r],o=n[r];if(i==null||o==null||i<0||o<0)s.push(null);else if(i===1)s.push(o);else if(o===1)s.push(i);else{if(i!==o)throw new ee("Operands could not be broadcast together with shapes "+JSON.stringify(e)+" "+JSON.stringify(n));s.push(i)}}return s}build(e){if(Array.isArray(e)&&!Array.isArray(e[0])&&(e=[Ut(e)]),e=e,e.length<2)throw new ee(`A merge layer should be called on an Array of at least 2 inputs. Got ${e.length} input(s).`);let n=[];for(const i of e)i!=null&&i[0]!==null&&n.push(i[0]);if(n=Nc(n),n.length>1)throw new ee(`Can not merge tensors with different batch sizes. Got tensors with shapes: ${JSON.stringify(e)}.`);let s=e[0]==null?null:e[0].slice(1);for(let i=1;i<e.length;++i){const o=e[i]==null?null:e[i].slice(1);s=this.computeElementwiseOpOutputShape(s,o)}const r=e.map(i=>i.length);e.indexOf(null)===-1&&Nc(r).length===1?this.reshapeRequired=!1:this.reshapeRequired=!0}call(e,n){return se(()=>{if(e=e,this.reshapeRequired){const s=[],r=e.map(i=>i.rank);if(r.indexOf(null)===-1){const i=Wc(r);for(let o of e){const a=o.rank;for(let l=0;l<i-a;++l)o=E0(o,1);s.push(o)}return this.mergeFunction(s)}else{let i=!1;for(const l of e){const c=l.rank;if(c==null){const u=l.shape,d=u[0],h=u.slice(1).concat([d]);let f=Q(l,[d].concat(Ic(u.slice(1))));f=Nt(f,[1,0]),f=Q(f,h),s.push(f),i=!0}else if(c>1){const u=Vo(1,c).concat([0]);s.push(Nt(l,u)),i=!0}else s.push(l)}let o=this.mergeFunction(s);const a=o.rank;if(i){if(a==null){const l=o.shape,c=l.length,u=l[c-1],d=[u].concat(l.slice(0,l.length-1));o=Q(Nt(Q(o,[-1,u]),[1,0]),d)}else if(a>1){const l=[a-1].concat(Vo(0,a-1));o=Nt(o,l)}}return o}}else return this.mergeFunction(e)})}computeOutputShape(e){e=e;let n;e[0]==null?n=null:n=e[0].slice(1);for(let r=1;r<e.length;++r){const i=e[r]==null?null:e[r].slice(1);n=this.computeElementwiseOpOutputShape(n,i)}let s=[];for(const r of e)r!=null&&r[0]!==null&&s.push(r[0]);return s=Nc(s),s.length===1?n=s.concat(n):n=[null].concat(n),n}computeMask(e,n){return se(()=>{if(n==null)return null;if(!Array.isArray(n))throw new ee("`mask` should be an Array");if(!Array.isArray(e))throw new ee("`inputs` should be an Array");if(n.length!==e.length)throw new ee(`The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths (${e.length} vs ${n.length})`);if(n.every(r=>r==null))return null;n=n.map(r=>r==null?r:as(r,0));let s=n[0];for(let r=1;r<n.length-1;++r)s=Ea(s,n[r]);return s})}}class Jq extends Bd{constructor(e){super(e)}mergeFunction(e){return se(()=>{let n=e[0].clone();for(let s=1;s<e.length;++s)n=fe(n,e[s]);return n})}}Jq.className="Add";ge(Jq);class e9 extends Bd{constructor(e){super(e)}mergeFunction(e){return se(()=>{let n=e[0].clone();for(let s=1;s<e.length;++s)n=Y(n,e[s]);return n})}}e9.className="Multiply";ge(e9);class t9 extends Bd{constructor(e){super(e)}mergeFunction(e){return se(()=>{let n=e[0].clone();for(let s=1;s<e.length;++s)n=fe(n,e[s]);return Y(1/e.length,n)})}}t9.className="Average";ge(t9);class n9 extends Bd{constructor(e){super(e)}mergeFunction(e){return se(()=>{let n=e[0];for(let s=1;s<e.length;++s)n=Oa(n,e[s]);return n})}}n9.className="Maximum";ge(n9);class s9 extends Bd{constructor(e){super(e)}mergeFunction(e){return se(()=>{let n=e[0];for(let s=1;s<e.length;++s)n=S0(n,e[s]);return n})}}s9.className="Minimum";ge(s9);class r9 extends Bd{constructor(e){super(e),this.DEFAULT_AXIS=-1,e==null&&(e={}),this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){if(!(Array.isArray(e)&&Array.isArray(e[0]))||e.length===1)throw new ee("A `Concatenate` layer should be called on a list of at least 2 inputs");e=e;let n=!0;for(const r of e)if(r!=null){n=!1;break}if(n)return;const s=[];for(let r=0;r<e.length;++r){const i=e[r].slice();i.splice(this.axis,1);let o=!1;for(const a of s)if(Et(a,i)){o=!0;break}o||s.push(i)}if(s.length>1)throw new ee("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(e))}mergeFunction(e){return se(()=>QR(e,this.axis))}computeOutputShape(e){if(!(Array.isArray(e)&&Array.isArray(e[0])))throw new ee("A `Concatenate` layer should be called on a list of inputs.");const n=e,s=n[0].slice(),r=this.axis<0?s.length+this.axis:this.axis;for(const i of n.slice(1)){if(s[r]==null||i[r]==null){s[r]=null;break}s[r]+=i[r]}return s}computeMask(e,n){if(n==null)return null;if(!Array.isArray(n))throw new ee("`mask` should be an array for Concatenate");if(!Array.isArray(e))throw new ee("`inputs` should be an array for Concatenate");if(n.length!==e.length)throw new ee(`Mismatch in the length of mask (${n.length}) and the legnth of inputs (${e.length})`);return se(()=>{let s=!0;if(n.forEach(o=>{if(o!=null){s=!1;return}}),s)return null;const r=[];for(let o=0;o<e.length;++o)n[o]==null?r.push(Te(Ni(e[o]),"bool")):n[o].rank<e[o].rank?r.push(as(n[o],-1)):r.push(n[o]);const i=Cn(r,this.axis);return PA(i,-1,!1)})}getConfig(){const e={axis:this.axis},n=super.getConfig();return Object.assign(e,n),e}}r9.className="Concatenate";ge(r9);function Zp(t,e){for(;t<0;)t+=e;return t}function TIe(t,e,n){if(t.shape.length>3||e.shape.length>3)throw new ft("batchDot is not implemented for tensors of 4D or higher rank yet");if(O(t.shape.length>=2,()=>`batchDot requires the rank of x to be >= 2, but got ${t.shape.length}`),O(t.shape.length>=2,()=>`batchDot requires the rank of y to be >= 2, but got ${e.shape.length}`),typeof n=="number"&&(n=[n,n]),t.dtype==="complex64"||e.dtype==="complex64")throw new ft("batchDot is not implemented for complex64-type Tensors yet.");const s=t.shape.length,r=e.shape.length;n==null&&(n=[s-1,r-2]);const i=n;return se(()=>{let o;if(s>r){o=s-r;const l=[];for(let c=0;c<o;++c)l.push(1);e=Q(e,e.shape.concat(l))}else if(r>s){o=r-s;const l=[];for(let c=0;c<o;++c)l.push(1);t=Q(t,t.shape.concat(l))}else o=0;let a;if(t.shape.length===2&&e.shape.length===2)i[0]===i[1]?a=Be(Y(t,e),i[0]):a=Be(Y(Nt(t,[1,0]),e),i[1]);else{const l=i[0]!==t.shape.length-1,c=i[1]===e.shape.length-1;a=Ct(t,e,l,c)}if(o>0){let l;s>r?l=s+r-3:l=s-1;const c=[];for(let u=l;u<l+o;++u)c.push(u);a=Bt(a,c)}return a.shape.length===1&&(a=as(a,1)),a})}class i9 extends Bd{constructor(e){super(e),this.axes=e.axes,this.normalize=e.normalize==null?!1:e.normalize,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){O(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const n=e[0],s=e[1];if(n.length>3||s.length>3)throw new ft("Dot layer does not support tensors of 4D or higher rank yet.");const r=this.interpretAxes(n,s);if(n[r[0]]!==s[r[1]])throw new ee(`Dimension incompatibility: ${n[r[0]]} !== ${s[r[1]]}`)}mergeFunction(e){if(e.length!==2)throw new ee(`A \`Dot\` layer must be called on exactly 2 inputs, but received ${e.length} input(s).`);let n=e[0],s=e[1],r;return Array.isArray(this.axes)?r=this.axes.map((i,o)=>Zp(i,e[o].shape.length)):r=[Zp(this.axes,n.shape.length),Zp(this.axes,s.shape.length)],this.normalize&&(n=dw(n,r[0]),s=dw(s,r[1])),TIe(n,s,r)}interpretAxes(e,n){let s;return Array.isArray(this.axes)?s=this.axes:s=[Zp(this.axes,e.length),Zp(this.axes,n.length)],s}computeOutputShape(e){O(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const n=e[0].slice(),s=e[1].slice();if(n.length>3||s.length>3)throw new ft("Dot layer does not support tensors of 4D or higher rank yet.");const r=this.interpretAxes(n,s);n.splice(r[0],1),s.splice(r[1],1),s.splice(0,1);const i=n.concat(s);return i.length===1&&i.push(1),i}computeMask(e,n){return null}getConfig(){const e={axes:this.axes,normalize:this.normalize},n=super.getConfig();return Object.assign(e,n),e}}i9.className="Dot";ge(i9);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class o9 extends $t{constructor(e){super(e),this.supportsMasking=!0,this.stddev=e.stddev}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={stddev:this.stddev};return Object.assign(n,e),n}call(e,n){return se(()=>{this.invokeCallHook(e,n);const s=pt(e);return A0(()=>fe(ek(s.shape,0,this.stddev),s),()=>s,n.training||!1)})}}o9.className="GaussianNoise";ge(o9);class a9 extends $t{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={rate:this.rate};return Object.assign(n,e),n}call(e,n){return se(()=>{this.invokeCallHook(e,n);const s=pt(e);return this.rate>0&&this.rate<1?A0(()=>{const i=Math.sqrt(this.rate/(1-this.rate));return Y(s,ek(s.shape,1,i))},()=>s,n.training||!1):s})}}a9.className="GaussianDropout";ge(a9);class l9 extends $t{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate,this.noiseShape=e.noiseShape}_getNoiseShape(e){return this.noiseShape||pt(e).shape}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={rate:this.rate};return Object.assign(n,e),n}call(e,n){return se(()=>{if(this.rate<1&&this.rate>0){const s=this._getNoiseShape(e);return A0(()=>{const i=pt(e),o=1.6732632423543772,a=1.0507009873554805,l=-o*a;let c=Md(k0(s),this.rate);c=_0(c,"float32");const u=((1-this.rate)*(1+this.rate*l**2))**-.5,d=-u*l*this.rate,h=fe(Y(i,c),Y(fe(c,-1),l));return fe(Y(h,u),d)},()=>pt(e),n.training||!1)}return e})}}l9.className="AlphaDropout";ge(l9);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Og(t,e,n,s,r,i=.001){let o;if(t.rank===2)o=VG(t,e,n,s,r,i);else if(t.rank===3)o=jG(t,e,n,s,r,i);else if(t.rank===4)o=BG(t,e,n,s,r,i);else throw new ft(`batchNormalization is not implemented for array of rank ${t.rank} yet`);return o}function NIe(t,e,n,s,r=.001){return se(()=>{const i=PS(t,s),o=i.mean,a=i.variance;return[Og(t,o,a,n,e,r),o,a]})}function IIe(t,e,n,s,r=.001){return se(()=>{const i=PS(t,s),o=i.mean,a=i.variance,l=[];for(const p of Vo(0,t.rank))s.indexOf(p)!==-1?l.push(1):l.push(t.shape[p]);const c=Q(o,l),u=Q(a,l),d=e==null?null:Q(e,l),h=n==null?null:Q(n,l);return[Og(t,c,u,h,d,r),o,a]})}function _Ie(t,e,n,s,r=.001){return Et(s.slice().sort(),Vo(0,t.rank-1))?NIe(t,e,n,s,r):IIe(t,e,n,s,r)}class c9 extends $t{constructor(e){e==null&&(e={}),super(e),this.supportsMasking=!0,this.axis=e.axis==null?-1:e.axis,this.momentum=e.momentum==null?.99:e.momentum,this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=xn(e.betaInitializer||"zeros"),this.gammaInitializer=xn(e.gammaInitializer||"ones"),this.movingMeanInitializer=xn(e.movingMeanInitializer||"zeros"),this.movingVarianceInitializer=xn(e.movingVarianceInitializer||"ones"),this.betaConstraint=fs(e.betaConstraint),this.gammaConstraint=fs(e.gammaConstraint),this.betaRegularizer=bn(e.betaRegularizer),this.gammaRegularizer=bn(e.gammaRegularizer)}build(e){e=Ut(e);const n=this.axis>=0?this.axis:this.axis+e.length,s=e[n];if(s==null)throw new ee(`Axis ${n} of input tensor should have a defined dimension but the layer received an input with shape ${JSON.stringify(e)}.`);this.inputSpec=[new ds({ndim:e.length,axes:{[n]:s}})];const r=[s];this.scale&&(this.gamma=this.addWeight("gamma",r,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",r,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",r,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",r,null,this.movingVarianceInitializer,null,!1),this.built=!0}call(e,n){return se(()=>{const s=n.training==null?!1:n.training,r=pt(e),i=r.shape,o=i.length,a=Vo(0,o),l=this.axis>=0?this.axis:this.axis+o;a.splice(l,1);const c=Nd(1,o);c[l]=i[l];const u=a.slice();u.sort();const d=!Et(u,Vo(0,o).slice(0,o-1)),h=()=>{if(d){const x=Q(this.movingMean.read(),c),v=Q(this.movingVariance.read(),c),b=this.center?Q(this.beta.read(),c):null,k=this.scale?Q(this.gamma.read(),c):null;return Og(r,x,v,b,k,this.epsilon)}else return Og(r,this.movingMean.read(),this.movingVariance.read(),this.beta==null?null:this.beta.read(),this.gamma==null?null:this.gamma.read(),this.epsilon)};if(!s)return h();const[f,p,m]=_Ie(r,this.gamma.read(),this.beta.read(),a,this.epsilon),g=(x,v,b)=>{se(()=>{const k=1-b,C=x.read(),N=Y(Ae(C,v),k);x.write(Ae(C,N))})};return(()=>{g(this.movingMean,p,this.momentum),g(this.movingVariance,m,this.momentum)})(),f})}getConfig(){const e={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:kn(this.betaInitializer),gammaInitializer:kn(this.gammaInitializer),movingMeanInitializer:kn(this.movingMeanInitializer),movingVarianceInitializer:kn(this.movingVarianceInitializer),betaRegularizer:Qt(this.betaRegularizer),gammaRegularizer:Qt(this.gammaRegularizer),betaConstraint:hs(this.betaConstraint),gammaConstraint:hs(this.gammaConstraint)},n=super.getConfig();return Object.assign(e,n),e}}c9.className="BatchNormalization";ge(c9);class u9 extends $t{constructor(e){if(e==null&&(e={}),super(e),this.axis=e.axis==null?-1:e.axis,typeof this.axis=="number"){if(!Number.isInteger(this.axis))throw new Error(`Expected axis to be an integer, but received ${this.axis}`)}else if(Array.isArray(this.axis)){for(const n of this.axis)if(!Number.isInteger(n))throw new Error(`Expected axis to be an array of integers, but received ${JSON.stringify(this.axis)}`)}else throw new Error(`Expected axis to be an integer or an array of integers, but received ${JSON.stringify(this.axis)}`);this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=xn(e.betaInitializer||"zeros"),this.gammaInitializer=xn(e.gammaInitializer||"ones"),this.betaRegularizer=bn(e.betaRegularizer),this.gammaRegularizer=bn(e.gammaRegularizer),this.supportsMasking=!0}build(e){e=Ut(e);const n=e.length;typeof this.axis=="number"&&(this.axis=[this.axis]);for(let i=0;i<this.axis.length;++i)this.axis[i]<0&&(this.axis[i]+=n);for(const i of this.axis)if(i<0||i>=n)throw new Error(`Invalid axis: ${i}`);if(this.axis.length!==Nc(this.axis).length)throw new Error(`Found duplicate axes in: ${this.axis}`);const s=this.axis.map(i=>e[i]),r=!0;this.scale?this.gamma=this.addWeight("gamma",s,"float32",this.gammaInitializer,this.gammaRegularizer,r):this.gamma=null,this.center?this.beta=this.addWeight("beta",s,"float32",this.betaInitializer,this.betaRegularizer,r):this.beta=null,this.built=!0}call(e,n){const s=pt(e),r=s.shape,i=r.length;return se(()=>{let{mean:a,variance:l}=PS(s,this.axis,!0);const c=Nd(1,i);for(const m of this.axis)c[m]=r[m];const u=m=>m!=null&&m.shape.length!==i?Q(m,c):m;let d=this.scale?u(this.gamma.read()):null,h=this.center?u(this.beta.read()):null;const f=[],p=[];for(let m=0;m<i;++m)this.axis.indexOf(m)!==-1?(f.push(r[m]),p.push(1)):(f.push(1),p.push(r[m]));return a=Ji(a,f),l=Ji(l,f),d!=null&&(d=Ji(d,p)),h!=null&&(h=Ji(h,p)),Og(s,a,l,h,d,this.epsilon)})}getConfig(){const e={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:kn(this.betaInitializer),gammaInitializer:kn(this.gammaInitializer),betaRegularizer:Qt(this.betaRegularizer),gammaRegularizer:Qt(this.gammaRegularizer)},n=super.getConfig();return Object.assign(e,n),e}}u9.className="LayerNormalization";ge(u9);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function EIe(t,e,n){return se(()=>{if(t.rank!==4)throw new ee(`temporalPadding expects input tensor to be 4-D, but received a ${t.rank}-D tensor.`);if(e==null&&(e=[[1,1],[1,1]]),e.length!==2||e[0].length!==2||e[1].length!==2)throw new ee("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(n==null&&(n=jo()),n!=="channelsLast"&&n!=="channelsFirst")throw new ee(`Unknown data format: ${n}. Supported data formats are 'channelsLast' and 'channelsFirst.`);let s;return n==="channelsFirst"?s=[[0,0],[0,0],e[0],e[1]]:s=[[0,0],e[0],e[1],[0,0]],$a(t,s)})}class d9 extends $t{constructor(e){if(e==null&&(e={}),super(e),this.dataFormat=e.dataFormat==null?jo():e.dataFormat,e.padding==null)this.padding=[[1,1],[1,1]];else if(typeof e.padding=="number")this.padding=[[e.padding,e.padding],[e.padding,e.padding]];else{if(e.padding=e.padding,e.padding.length!==2)throw new ee(`ZeroPadding2D expects padding to be a length-2 array, but received a length-${e.padding.length} array.`);let n,s;if(typeof e.padding[0]=="number")n=[e.padding[0],e.padding[0]],s=[e.padding[1],e.padding[1]];else{if(e.padding=e.padding,e.padding[0].length!==2)throw new ee(`ZeroPadding2D expects height padding to be a length-2 array, but received a length-${e.padding[0].length} array.`);if(n=e.padding[0],e.padding[1].length!==2)throw new ee(`ZeroPadding2D expects width padding to be a length-2 array, but received a length-${e.padding[1].length} array.`);s=e.padding[1]}this.padding=[n,s]}this.inputSpec=[new ds({ndim:4})]}computeOutputShape(e){e=Ut(e);let n,s;return this.dataFormat==="channelsFirst"?(e[2]!=null&&e[2]>=0?n=e[2]+this.padding[0][0]+this.padding[0][1]:n=null,e[3]!=null&&e[3]>=0?s=e[3]+this.padding[1][0]+this.padding[1][1]:s=null,[e[0],e[1],n,s]):(e[1]!=null&&e[1]>=0?n=e[1]+this.padding[0][0]+this.padding[0][1]:n=null,e[2]!=null&&e[2]>=0?s=e[2]+this.padding[1][0]+this.padding[1][1]:s=null,[e[0],n,s,e[3]])}call(e,n){return se(()=>EIe(pt(e),this.padding,this.dataFormat))}getConfig(){const e={padding:this.padding,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}d9.className="ZeroPadding2D";ge(d9);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function lk(t,e,n,s,r,i){return se(()=>{Kn(r),EK(i),$i(s),n==null&&(n=[1,1]),s==null&&(s="valid"),r==null&&(r=jo()),i==null&&(i="max"),t=hD(t,r);let o;const a=s==="same"?"same":"valid";return i==="max"?o=OS(t,e,n,a):o=_S(t,e,n,a),r==="channelsFirst"&&(o=Nt(o,[0,3,1,2])),o})}function h9(t,e,n,s,r,i){return se(()=>{Kn(r),EK(i),$i(s),n==null&&(n=[1,1,1]),s==null&&(s="valid"),r==null&&(r=jo()),i==null&&(i="max"),t=Eq(t,r);let o;const a=s==="same"?"same":"valid";return i==="max"?o=f8(t,e,n,a):o=zG(t,e,n,a),r==="channelsFirst"&&(o=Nt(o,[0,4,1,2,3])),o})}class f9 extends $t{constructor(e){if(e.poolSize==null&&(e.poolSize=2),super(e),typeof e.poolSize=="number")this.poolSize=[e.poolSize];else if(Array.isArray(e.poolSize)&&e.poolSize.length===1&&typeof e.poolSize[0]=="number")this.poolSize=e.poolSize;else throw new ee(`poolSize for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.poolSize)}`);if(Ss(this.poolSize,"poolSize"),e.strides==null)this.strides=this.poolSize;else if(typeof e.strides=="number")this.strides=[e.strides];else if(Array.isArray(e.strides)&&e.strides.length===1&&typeof e.strides[0]=="number")this.strides=e.strides;else throw new ee(`strides for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.strides)}`);Ss(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,$i(this.padding),this.inputSpec=[new ds({ndim:3})]}computeOutputShape(e){e=Ut(e);const n=Do(e[1],this.poolSize[0],this.padding,this.strides[0]);return[e[0],n,e[2]]}call(e,n){return se(()=>{this.invokeCallHook(e,n),e=E0(pt(e),2);const s=this.poolingFunction(pt(e),[this.poolSize[0],1],[this.strides[0],1],this.padding,"channelsLast");return Bt(s,[2])})}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides},n=super.getConfig();return Object.assign(e,n),e}}class p9 extends f9{constructor(e){super(e)}poolingFunction(e,n,s,r,i){return Kn(i),$i(r),lk(e,n,s,r,i,"max")}}p9.className="MaxPooling1D";ge(p9);class m9 extends f9{constructor(e){super(e)}poolingFunction(e,n,s,r,i){return Kn(i),$i(r),lk(e,n,s,r,i,"avg")}}m9.className="AveragePooling1D";ge(m9);class g9 extends $t{constructor(e){if(e.poolSize==null&&(e.poolSize=[2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==2)throw new ee(`If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides];Ss(this.poolSize,"poolSize"),Ss(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Kn(this.dataFormat),$i(this.padding),this.inputSpec=[new ds({ndim:4})]}computeOutputShape(e){e=Ut(e);let n=this.dataFormat==="channelsFirst"?e[2]:e[1],s=this.dataFormat==="channelsFirst"?e[3]:e[2];return n=Do(n,this.poolSize[0],this.padding,this.strides[0]),s=Do(s,this.poolSize[1],this.padding,this.strides[1]),this.dataFormat==="channelsFirst"?[e[0],e[1],n,s]:[e[0],n,s,e[3]]}call(e,n){return se(()=>(this.invokeCallHook(e,n),this.poolingFunction(pt(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}class y9 extends g9{constructor(e){super(e)}poolingFunction(e,n,s,r,i){return Kn(i),$i(r),lk(e,n,s,r,i,"max")}}y9.className="MaxPooling2D";ge(y9);class x9 extends g9{constructor(e){super(e)}poolingFunction(e,n,s,r,i){return Kn(i),$i(r),lk(e,n,s,r,i,"avg")}}x9.className="AveragePooling2D";ge(x9);class v9 extends $t{constructor(e){if(e.poolSize==null&&(e.poolSize=[2,2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==3)throw new ee(`If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides,e.strides];Ss(this.poolSize,"poolSize"),Ss(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Kn(this.dataFormat),$i(this.padding),this.inputSpec=[new ds({ndim:5})]}computeOutputShape(e){e=Ut(e);let n=this.dataFormat==="channelsFirst"?e[2]:e[1],s=this.dataFormat==="channelsFirst"?e[3]:e[2],r=this.dataFormat==="channelsFirst"?e[4]:e[3];return n=Do(n,this.poolSize[0],this.padding,this.strides[0]),s=Do(s,this.poolSize[1],this.padding,this.strides[1]),r=Do(r,this.poolSize[2],this.padding,this.strides[2]),this.dataFormat==="channelsFirst"?[e[0],e[1],n,s,r]:[e[0],n,s,r,e[4]]}call(e,n){return se(()=>(this.invokeCallHook(e,n),this.poolingFunction(pt(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}class b9 extends v9{constructor(e){super(e)}poolingFunction(e,n,s,r,i){return Kn(i),$i(r),h9(e,n,s,r,i,"max")}}b9.className="MaxPooling3D";ge(b9);class w9 extends v9{constructor(e){super(e)}poolingFunction(e,n,s,r,i){return Kn(i),$i(r),h9(e,n,s,r,i,"avg")}}w9.className="AveragePooling3D";ge(w9);class S9 extends $t{constructor(e){super(e),this.inputSpec=[new ds({ndim:3})]}computeOutputShape(e){return[e[0],e[2]]}call(e,n){throw new ft}}class k9 extends S9{constructor(e){super(e||{})}call(e,n){return se(()=>{const s=pt(e);return Dn(s,1)})}}k9.className="GlobalAveragePooling1D";ge(k9);class C9 extends S9{constructor(e){super(e||{})}call(e,n){return se(()=>{const s=pt(e);return ro(s,1)})}}C9.className="GlobalMaxPooling1D";ge(C9);class T9 extends $t{constructor(e){super(e),this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Kn(this.dataFormat),this.inputSpec=[new ds({ndim:4})]}computeOutputShape(e){return e=e,this.dataFormat==="channelsLast"?[e[0],e[3]]:[e[0],e[1]]}call(e,n){throw new ft}getConfig(){const e={dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}class N9 extends T9{call(e,n){return se(()=>{const s=pt(e);return this.dataFormat==="channelsLast"?Dn(s,[1,2]):Dn(s,[2,3])})}}N9.className="GlobalAveragePooling2D";ge(N9);class I9 extends T9{call(e,n){return se(()=>{const s=pt(e);return this.dataFormat==="channelsLast"?ro(s,[1,2]):ro(s,[2,3])})}}I9.className="GlobalMaxPooling2D";ge(I9);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class _9 extends $t{constructor(e){super(e),this.layer=e.layer}build(e){this.built=!0}get trainable(){return this.layer!=null?this.layer.trainable:!1}set trainable(e){this.layer!=null&&(this.layer.trainable=e)}get trainableWeights(){return this.layer.trainableWeights}get nonTrainableWeights(){return this.layer.nonTrainableWeights}get updates(){return this.layer._updates}get losses(){return this.layer.losses}getWeights(){return this.layer.getWeights()}setWeights(e){this.layer.setWeights(e)}getConfig(){const e={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},n=super.getConfig();return Object.assign(e,n),e}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.layer!=null&&this.layer.setFastWeightInitDuringBuild(e)}static fromConfig(e,n,s={}){const r=n.layer,i=Ta(r,s);delete n.layer;const o={layer:i};return Object.assign(o,n),new e(o)}}class E9 extends _9{constructor(e){super(e),this.supportsMasking=!0}build(e){if(e=Ut(e),e.length<3)throw new ee(`TimeDistributed layer expects an input shape >= 3D, but received input shape ${JSON.stringify(e)}`);this.inputSpec=[{shape:e}];const n=[e[0]].concat(e.slice(2));this.layer.built||(this.layer.build(n),this.layer.built=!0),super.build(e)}computeOutputShape(e){e=Ut(e);const n=[e[0]].concat(e.slice(2)),s=this.layer.computeOutputShape(n),r=e[1];return[s[0],r].concat(s.slice(1))}call(e,n){return se(()=>(e=pt(e),Mq((o,a)=>[pt(this.layer.call(o,n)),[]],e,[],!1,null,null,!1,!0)[1]))}}E9.className="TimeDistributed";ge(E9);function $Ie(t){jd(qNe,"BidirectionalMergeMode",t)}const AIe="concat";class $9 extends _9{constructor(e){super(e);const n=e.layer.getConfig(),s={};s.className=e.layer.getClassName(),s.config=n,this.forwardLayer=Ta(s),n.goBackwards=n.goBackwards!==!0;const r={};if(r.className=e.layer.getClassName(),r.config=n,this.backwardLayer=Ta(r),this.forwardLayer.name="forward_"+this.forwardLayer.name,this.backwardLayer.name="backward_"+this.backwardLayer.name,this.mergeMode=e.mergeMode===void 0?AIe:e.mergeMode,$Ie(this.mergeMode),e.weights)throw new ft("weights support is not implemented for Bidirectional layer yet.");this._stateful=e.layer.stateful,this.returnSequences=e.layer.returnSequences,this.returnState=e.layer.returnState,this.supportsMasking=!0,this._trainable=!0,this.inputSpec=e.layer.inputSpec,this.numConstants=null}get trainable(){return this._trainable}set trainable(e){this._trainable=e,this.forwardLayer!=null&&(this.forwardLayer.trainable=e),this.backwardLayer!=null&&(this.backwardLayer.trainable=e)}getWeights(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}setWeights(e){const n=e.length,s=Math.floor(n/2);this.forwardLayer.setWeights(e.slice(0,s)),this.backwardLayer.setWeights(e.slice(s))}computeOutputShape(e){let n=this.forwardLayer.computeOutputShape(e);Array.isArray(n)&&Array.isArray(n[0])||(n=[n]),n=n;let s,r,i;return this.returnState&&(i=n.slice(1)),s=n[0],s=s,this.mergeMode==="concat"?(s[s.length-1]*=2,r=[s]):this.mergeMode==null?r=[s,s.slice()]:r=[s],this.returnState?this.mergeMode==null?r.concat(i).concat(i.slice()):[s].concat(i).concat(i.slice()):br(r)}apply(e,n){let s=n==null?null:n.initialState,r=n==null?null:n.constants;n==null&&(n={});const i=Lq(e,s,r,this.numConstants);if(e=i.inputs,s=i.initialState,r=i.constants,Array.isArray(e)&&(s=e.slice(1),e=e[0]),(s==null||s.length===0)&&r==null)return super.apply(e,n);const o=[],a=[];if(s!=null){const c=s.length;if(c%2>0)throw new ee("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");n.initialState=s,o.push(...s);const u=s.map(d=>new ds({shape:d.shape}));this.forwardLayer.stateSpec=u.slice(0,c/2),this.backwardLayer.stateSpec=u.slice(c/2),a.push(...u)}if(r!=null)throw new ft("Support for constants in Bidirectional layers is not implemented yet.");const l=o[0]instanceof fa;for(const c of o)if(c instanceof fa!==l)throw new ee("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(l){const c=[e].concat(o),u=this.inputSpec.concat(a),d=this.inputSpec;this.inputSpec=u;const h=super.apply(c,n);return this.inputSpec=d,h}else return super.apply(e,n)}call(e,n){return se(()=>{const s=n.initialState;let r,i;if(s==null)r=this.forwardLayer.call(e,n),i=this.backwardLayer.call(e,n);else{const l=s.slice(0,s.length/2),c=s.slice(s.length/2);r=this.forwardLayer.call(e,Object.assign(n,{initialState:l})),i=this.backwardLayer.call(e,Object.assign(n,{initialState:c}))}let o;this.returnState&&(Array.isArray(r)&&(o=r.slice(1).concat(i.slice(1))),r=r[0],i=i[0]),this.returnSequences&&(i=ao(i,1));let a;return this.mergeMode==="concat"?a=QR([r,i]):this.mergeMode==="sum"?a=fe(r,i):this.mergeMode==="ave"?a=Y(.5,fe(r,i)):this.mergeMode==="mul"?a=Y(r,i):this.mergeMode==null&&(a=[r,i]),this.returnState?this.mergeMode==null?a.concat(o):[a].concat(o):a})}resetStates(e){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}build(e){rd(this.forwardLayer.name,()=>{this.forwardLayer.build(e)}),rd(this.backwardLayer.name,()=>{this.backwardLayer.build(e)}),this.built=!0}computeMask(e,n){Array.isArray(n)&&(n=n[0]);let s;if(this.returnSequences?this.mergeMode==null?s=[n,n]:s=n:this.mergeMode==null?s=[null,null]:s=null,this.returnState){const i=this.forwardLayer.states.map(o=>null);return Array.isArray(s)?s.concat(i).concat(i):[s].concat(i).concat(i)}else return s}get trainableWeights(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}get nonTrainableWeights(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.forwardLayer!=null&&this.forwardLayer.setFastWeightInitDuringBuild(e),this.backwardLayer!=null&&this.backwardLayer.setFastWeightInitDuringBuild(e)}getConfig(){const e={mergeMode:this.mergeMode},n=super.getConfig();return Object.assign(e,n),e}static fromConfig(e,n){const s=Ta(n.layer);if(delete n.layer,n.numConstants!=null)throw new ft("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");const r=n;return r.layer=s,new e(r)}}$9.className="Bidirectional";ge($9);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class A9 extends $t{constructor(e){super(e),this.scale=e.scale,e.offset?this.offset=e.offset:this.offset=0}getConfig(){const e={scale:this.scale,offset:this.offset},n=super.getConfig();return Object.assign(e,n),e}call(e,n){return se(()=>(e=pt(e),e.dtype!=="float32"&&(e=_0(e,"float32")),fe(Y(e,this.scale),this.offset)))}}A9.className="Rescaling";ge(A9);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var sV;(function(t){t[t.FAIL=0]="FAIL",t[t.SHORTEST=1]="SHORTEST",t[t.LONGEST=2]="LONGEST"})(sV||(sV={}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ve(t,e){Array.isArray(t)||(t=[t]),t.forEach(n=>{n!=null&&O(n.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the CPU backend.`)})}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RIe=mR;class ck extends p${constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new I6(this,Vl())}nextDataId(){return ck.nextDataId++}write(e,n,s){this.firstUse&&(this.firstUse=!1,oe().get("IS_NODE")&&pi(`
============================
Hi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. 
============================`));const r={id:this.nextDataId()};return this.data.set(r,{values:e,dtype:s,refCount:1}),r}makeTensorInfo(e,n,s){let r;if(n==="string"&&s!=null&&s.length>0&&xy(s[0])){const i=s.map(o=>kc(o));r=this.write(i,e,n)}else r=this.write(s,e,n);return{dataId:r,shape:e,dtype:n}}refCount(e){return this.data.has(e)?this.data.get(e).refCount:0}incRef(e){const n=this.data.get(e);n.refCount++}decRef(e){if(this.data.has(e)){const n=this.data.get(e);n.refCount--}}move(e,n,s,r,i){this.data.set(e,{values:n,dtype:r,refCount:i})}numDataIds(){return this.data.numDataIds()}async read(e){return this.readSync(e)}readSync(e){const{dtype:n,complexTensorInfos:s}=this.data.get(e);if(n==="complex64"){const r=this.readSync(s.real.dataId),i=this.readSync(s.imag.dataId);return xl(r,i)}return this.data.get(e).values}bufferSync(e){const n=this.readSync(e.dataId);if(e.dtype==="string")try{const s=n.map(r=>Mc(r));return gt(e.shape,e.dtype,s)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return gt(e.shape,e.dtype,n)}makeOutput(e,n,s){return Vl().makeTensorFromTensorInfo(this.makeTensorInfo(n,s,e),this)}disposeData(e,n=!1){if(this.data.has(e)){if(this.data.get(e).refCount--,!n&&this.data.get(e).refCount>0)return!1;const{complexTensorInfos:s}=this.data.get(e);s!=null&&(this.disposeData(s.real.dataId,!0),this.disposeData(s.imag.dataId,!0)),this.data.delete(e)}return!0}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}async time(e){const n=vr();return e(),{kernelMs:vr()-n}}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(e){Ve([e],"where");const n=this.readSync(e.dataId);return RIe(e.shape,n)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}}ck.nextDataId=0;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R9(t){const e=new Float32Array(t.length);for(let n=0;n<t.length;++n)e[n]=Math.abs(t[n]);return e}const DIe=t=>{const{x:e}=t.inputs,n=t.backend;Ve(e,"abs");let s=new Float32Array(le(e.shape));const r=n.data.get(e.dataId).values;return s=R9(r),n.makeOutput(s,e.shape,e.dtype)},OIe={kernelName:k1,backendName:"cpu",kernelFunc:DIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rs(t){return(e,n,s,r,i)=>{const o=ct(e,n),a=o.length,l=Ye(o),c=le(o),u=Cs(i,c),d=e.length,h=n.length,f=Ye(e),p=Ye(n),m=Df(e,o),g=Df(n,o);if(m.length+g.length===0)for(let y=0;y<u.length;++y)u[y]=t(s[y%s.length],r[y%r.length]);else for(let y=0;y<u.length;++y){const x=rp(y,a,l),v=x.slice(-d);m.forEach(N=>v[N]=0);const b=ba(v,d,f),k=x.slice(-h);g.forEach(N=>k[N]=0);const C=ba(k,h,p);u[y]=t(s[b],r[C])}return[u,o]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wr(t){const{inputs:e,backend:n}=t,{real:s,imag:r}=e,i=n.data.get(s.dataId).values,o=n.data.get(r.dataId).values,a=n.makeTensorInfo(s.shape,"complex64"),l=n.data.get(a.dataId);return l.complexTensorInfos={real:n.makeTensorInfo(s.shape,"float32",i),imag:n.makeTensorInfo(r.shape,"float32",o)},a}const PIe={kernelName:C$,backendName:"cpu",kernelFunc:Wr};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yw(t,e,n="float32"){if(n==="complex64"){const r=yw(t,e,"float32"),i=yw(t,e,"float32");return Wr({inputs:{real:r,imag:i},backend:t})}const s=Xs(le(e),n);return t.makeTensorInfo(e,n,s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ra(t){const{inputs:e,backend:n}=t,{x:s}=e;return n.incRef(s.dataId),{dataId:s.dataId,shape:s.shape,dtype:s.dtype}}const FIe={kernelName:Vy,backendName:"cpu",kernelFunc:Ra};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Id(t){const{inputs:e,backend:n}=t,{input:s}=e,r=n.data.get(s.dataId).complexTensorInfos.real,i=n.data.get(r.dataId).values;return n.makeTensorInfo(r.shape,r.dtype,i)}const LIe={kernelName:tA,backendName:"cpu",kernelFunc:Id};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function D9(t,e,n,s){if(s==="int32"){const r=Int32Array.from(t);return[e,"int32",r]}if(s==="bool"){const r=Ld([0],n),[i,o]=rs((a,l)=>a!==l?1:0)(e,[],t,r,"bool");return[o,"bool",i]}throw new Error(`Error in Cast: failed to cast ${n} to ${s}`)}function Kc(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{dtype:i}=s;if(i==="complex64"){if(r.dtype==="complex64")return Ra({inputs:{x:r},backend:n});const u=yw(n,r.shape,r.dtype),d=Kc({inputs:{x:r},backend:n,attrs:{dtype:"float32"}}),h=Wr({inputs:{real:d,imag:u},backend:n});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(d),h}if(r.dtype==="complex64"){const u=Id({inputs:{input:r},backend:n}),d=Kc({inputs:{x:u},backend:n,attrs:{dtype:i}});return n.disposeIntermediateTensorInfo(u),d}if(!E6(r.dtype,i)){const u=Ra({inputs:{x:r},backend:n});return{dataId:u.dataId,shape:u.shape,dtype:i}}const o=n.data.get(r.dataId).values,[a,l,c]=D9(o,r.shape,r.dtype,i);return n.makeTensorInfo(a,l,c)}const MIe={kernelName:Iy,backendName:"cpu",kernelFunc:Kc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Is(t,e,n,s){return n==null?({inputs:r,backend:i})=>{const{a:o,b:a}=r,l=i;Ve([o,a],t);const c=l.data.get(o.dataId).values,u=l.data.get(a.dataId).values,d=o.dtype==="string"?Cd(c):c,h=o.dtype==="string"?Cd(u):u,f=s||o.dtype,[p,m]=e(o.shape,a.shape,d,h,f);return l.makeTensorInfo(m,f,p)}:({inputs:r,backend:i})=>{const{a:o,b:a}=r,l=i;if(o.dtype==="complex64"||a.dtype==="complex64"){const c=Kc({inputs:{x:o},backend:l,attrs:{dtype:"complex64"}}),u=l.data.get(c.dataId),d=u.complexTensorInfos.real,h=u.complexTensorInfos.imag,f=l.data.get(d.dataId).values,p=l.data.get(h.dataId).values,m=Kc({inputs:{x:a},backend:l,attrs:{dtype:"complex64"}}),g=l.data.get(m.dataId),y=g.complexTensorInfos.real,x=g.complexTensorInfos.imag,v=l.data.get(y.dataId).values,b=l.data.get(x.dataId).values,[k,C,N]=n(o.shape,a.shape,f,p,v,b),I=l.makeTensorInfo(N,"float32",k),$=l.makeTensorInfo(N,"float32",C),A=Wr({inputs:{real:I,imag:$},backend:l});return l.disposeIntermediateTensorInfo(c),l.disposeIntermediateTensorInfo(m),l.disposeIntermediateTensorInfo(I),l.disposeIntermediateTensorInfo($),A}else{const c=l.data.get(o.dataId).values,u=l.data.get(a.dataId).values,d=s||o.dtype,[h,f]=e(o.shape,a.shape,c,u,d);return l.makeTensorInfo(f,d,h)}}}function xD(t){return(e,n,s,r,i,o)=>{const a=ct(e,n),l=le(a),c=a.length,u=Ye(a),d=Cs("float32",l),h=Cs("float32",l),f=Df(e,a),p=Df(n,a),m=xl(s,r),g=xl(i,o),y=e.length,x=Ye(e),v=n.length,b=Ye(n);if(f.length+p.length===0)for(let k=0;k<d.length;k++){const C=k%m.length,N=k%g.length,I=t(m[C*2],m[C*2+1],g[N*2],g[N*2+1]);d[k]=I.real,h[k]=I.imag}else for(let k=0;k<d.length;k++){const C=rp(k,c,u),N=C.slice(-y);f.forEach(F=>N[F]=0);const I=ba(N,y,x),$=C.slice(-v);p.forEach(F=>$[F]=0);const A=ba($,v,b),P=t(m[I*2],m[I*2+1],g[A*2],g[A*2+1]);d[k]=P.real,h[k]=P.imag}return[d,h,a]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const O9=rs((t,e)=>t+e),zIe=xD((t,e,n,s)=>({real:t+n,imag:e+s})),Mf=Is(ip,O9,zIe),VIe={kernelName:ip,backendName:"cpu",kernelFunc:Mf};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vD(t,e,n,s,r){const i=le(s),o=Xs(r,n);for(let a=0;a<t.length;a++){const l=t[a];if(l<0)throw new Error("Input x must be non-negative!");l>=r||(i>0?o[l]+=e[a]:o[l]+=1)}return o}function P9(t,e,n,s=!1){const r=t.shape[0],i=t.shape[1],o=gt([r,n],e.dtype);for(let a=0;a<r;a++)for(let l=0;l<i;l++){const c=t.get(a,l);if(c<0)throw new Error("Input x must be non-negative!");c>=n||(s?o.set(1,a,c):e.size>0?o.set(o.get(a,c)+e.get(a,l),a,c):o.set(o.get(a,c)+1,a,c))}return o}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lu(t){return(e,n,s)=>{const r=Cs(n,e.length);for(let i=0;i<e.length;++i)r[i]=t(e[i],s);return r}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ht(t,e,n){return({inputs:s,attrs:r,backend:i})=>{const{x:o}=s;if(Ve(o,t),o.dtype==="string"||n==="string")throw new Error("unaryKernelFunc does not support string input/output");const a=i,l=a.data.get(o.dataId).values,c=le(o.shape),u=n||o.dtype,d=ws(u,c);for(let h=0;h<c;++h)d[h]=e(l[h],r);return a.makeTensorInfo(o.shape,u,d)}}function hp(t,e,n){return({inputs:s,attrs:r,backend:i})=>{const{x:o}=s;if(Ve(o,t),o.dtype==="string"||n==="string")throw new Error("unaryKernelFunc does not support string input/output");const a=i,l=a.data.get(o.dataId).values,c=n||o.dtype,u=e(l,c,r);return a.makeTensorInfo(o.shape,c,u)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const F9=lu(t=>Math.ceil(t)),jIe=hp(_y,F9),BIe={kernelName:_y,backendName:"cpu",kernelFunc:jIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function L9(t,e,n,s){const r=ws(n,le(e));if(s&&n!=="string"){let i=0;t.forEach(o=>{const a=le(o.shape);r.set(o.vals,i),i+=a})}else{let i=0;t.forEach(o=>{const a=n==="string"?Cd(o.vals):o.vals;let l=0;for(let c=0;c<o.shape[0];++c){const u=c*e[1]+i;for(let d=0;d<o.shape[1];++d)r[u+d]=a[l++]}i+=o.shape[1]})}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const M9=rs((t,e)=>t===e?1:0),z9=Is(z1,M9,null,"bool"),WIe={kernelName:z1,backendName:"cpu",kernelFunc:z9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const V9=lu(t=>Math.exp(t)),j9=hp(Py,V9,"float32"),UIe={kernelName:Py,backendName:"cpu",kernelFunc:j9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const B9=lu(t=>Math.expm1(t)),HIe=hp(Fy,B9),GIe={kernelName:Fy,backendName:"cpu",kernelFunc:HIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const W9=lu(t=>Math.floor(t)),KIe=hp(Ly,W9),qIe={kernelName:Ly,backendName:"cpu",kernelFunc:KIe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U9(t,e,n,s,r,i,o,a,l){const c=gt([s,i],n);for(let u=0;u<s;u++){const d=[];let h=0;for(let f=0;f<r;f++){const p=t[u*r+f];h+=p*o[f],d.push(p)}if(h<0||h>=l/i)throw new Error(`Invalid indices: ${d} does not index into ${a}`);for(let f=0;f<i;f++)c.values[u*i+f]=e.get(...e.indexToLoc(h*i+f))}return c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H9(t,e,n){const s=gt(n,t.dtype);for(let r=0;r<s.size;++r){const o=s.indexToLoc(r).slice(),a=o[0],l=o[2],c=e.locToIndex([a,l]);o[2]=e.values[c];const u=t.locToIndex(o);0<=u&&u<t.values.length&&(s.values[r]=t.values[u])}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const G9=rs((t,e)=>t>e?1:0),XIe=Is(W1,G9,null,"bool"),YIe={kernelName:W1,backendName:"cpu",kernelFunc:XIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const K9=rs((t,e)=>t>=e?1:0),ZIe=Is(zy,K9,null,"bool"),QIe={kernelName:zy,backendName:"cpu",kernelFunc:ZIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const q9=rs((t,e)=>t<e?1:0),JIe=Is(H1,q9,null,"bool"),e_e={kernelName:H1,backendName:"cpu",kernelFunc:JIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const X9=rs((t,e)=>t<=e?1:0),t_e=Is(G1,X9,null,"bool"),n_e={kernelName:G1,backendName:"cpu",kernelFunc:t_e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y9(t,e,n){const s=(e-t)/(n-1),r=Xs(n,"float32");r[0]=t;for(let i=1;i<r.length;i++)r[i]=r[i-1]+s;return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Z9=lu(t=>Math.log(t)),s_e=hp(Uy,Z9),r_e={kernelName:Uy,backendName:"cpu",kernelFunc:s_e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q9(t,e,n,s){const r=Cs(s,le(n));for(let i=0;i<r.length;++i){const o=i*e;let a=t[o];for(let l=0;l<e;++l){const c=t[o+l];(Number.isNaN(c)||c>a)&&(a=c)}r[i]=a}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const J9=rs((t,e)=>Math.max(t,e)),i_e=Is(Gy,J9),o_e={kernelName:Gy,backendName:"cpu",kernelFunc:i_e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eX=rs((t,e)=>Math.min(t,e)),a_e=Is(Ky,eX),l_e={kernelName:Ky,backendName:"cpu",kernelFunc:a_e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bD=rs((t,e)=>t*e),c_e=xD((t,e,n,s)=>({real:t*n-e*s,imag:t*s+e*n})),uk=Is(Xy,bD,c_e),u_e={kernelName:Xy,backendName:"cpu",kernelFunc:uk};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tX(t,e,n){const s=tu(-1,n);return bD([],e,s,t,n)}function d_e(t){const{inputs:e,backend:n}=t,{x:s}=e;Ve(s,"neg");const r=n.data.get(s.dataId).values,[i,o]=tX(r,s.shape,s.dtype);return n.makeTensorInfo(o,s.dtype,i)}const h_e={kernelName:sS,backendName:"cpu",kernelFunc:d_e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nX=rs((t,e)=>t!==e?1:0),f_e=Is(rS,nX,null,"bool"),p_e={kernelName:rS,backendName:"cpu",kernelFunc:f_e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wD(t,e,n,s,r){const i=e.length,o=le(e),a=Ye(e),l=Ye(r),c=Cs(n,le(r));for(let u=0;u<o;++u){const d=rp(u,i,a),h=new Array(d.length);for(let p=0;p<h.length;p++)h[p]=d[s[p]];const f=ba(h,i,l);c[f]=t[u]}return c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _r(t){const{inputs:e,attrs:n,backend:s}=t,{x:r}=e,{perm:i}=n;Ve(r,"transpose");const o=r.shape.length,a=new Array(o);for(let d=0;d<a.length;d++)a[d]=r.shape[i[d]];const l=s.data.get(r.dataId).values,c=wD(l,r.shape,r.dtype,i,a);return{dataId:s.write(c,a,r.dtype),shape:a,dtype:r.dtype}}const m_e={kernelName:Uh,backendName:"cpu",kernelFunc:_r};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sX(t,e,n,s){const[r,i]=Ns(t,s),o=Zr(e,"int32"),a=Xs(le(r),o),l=le(i);for(let c=0;c<a.length;++c){const u=c*l;let d=1;for(let h=0;h<l;++h)d*=n[u+h];a[c]=d}return{outVals:a,outShape:r,outDtype:o}}function g_e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,keepDims:o}=s;Ve(r,"prod");const a=r.shape.length,l=bt(i,r.shape),c=In(l,a);let u=l,d=r;const h=[];c!=null&&(d=_r({inputs:{x:r},backend:n,attrs:{perm:c}}),h.push(d),u=Gn(u.length,a));const f=n.data.get(d.dataId).values,{outVals:p,outShape:m,outDtype:g}=sX(d.shape,d.dtype,f,u);let y=m;return o&&(y=Hn(m,l)),h.forEach(x=>n.disposeIntermediateTensorInfo(x)),n.makeTensorInfo(y,g,p)}const y_e={kernelName:uS,backendName:"cpu",kernelFunc:g_e};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function x_e(t,e,n){t.forEach((s,r)=>{if(s<0||s>=n){const i=rp(r,e.length,Ye(e)).join(",");throw new Error(`indices[${i}] = ${s} is not in [0, ${n})`)}})}function v_e(t,e){for(let n=0;n<t.length;++n){const s=t[n],r=n===t.length-1?e:t[n+1].length;if(s.length===0)throw new Error("Ragged splits may not be empty");if(s[0]<0)throw new Error("Ragged splits must be non-negative");if(s[s.length-1]>r)throw new Error("Ragged splits must not point past values");for(let i=1;i<s.length;++i)if(s[i-1]>s[i])throw new Error("Ragged splits must be sorted in ascending order")}}function b_e(t,e,n,s){const r=[];let i=0;const o=e.length-1+n.length,a=new Array(o).fill(null).map(()=>[0]);v_e(n,s);let l=1;for(let c=0;c<e.length-1;++c){l*=e[c];const u=e[c+1];for(let d=1;d<l+1;++d)a[c].push(d*u)}for(let c=0;c<t.length;++c){let u=t[c],d=t[c]+1;for(let h=0;h<n.length;++h){const f=n[h],p=h+e.length-1;if(p>=0){const m=a[p],g=m[m.length-1]-f[u];for(let y=u;y<d;++y)a[p].push(f[y+1]+g)}u=f[u],d=f[d]}d!==u&&(r.push([u,d]),i+=d-u)}return{outSplits:a,valueSlices:r,numValues:i}}function w_e(t){const e=[];for(let n=0;n<t.length;++n){const s=t[n].length,r=ws("int32",s);e.push(r),t[n].forEach((i,o)=>r[o]=i)}return e}function rV(t,e){const n=t.slice(0,e);for(;n.length<e;)n.push(1);for(let s=e;s<t.length;s++)n[e-1]*=t[s];return n}function S_e(t,e,n,s,r,i){const o=rV(e,2)[1],a=rV(i,2)[1];let l=0;for(const c of n)for(let u=c[0];u<c[1];++u){for(let d=0;d<s;++d)r[l*a+d]=t[u*o+d];++l}}function k_e(t,e,n,s,r){const i=e.slice();i[0]=r;const o=ws(n,le(i)),a=t.length,l=a===0?0:a/e[0];return S_e(t,e,s,l,o,i),[o,i]}function rX(t,e,n,s,r,i,o,a){if(t.length===0)throw new Error("paramsNestedSplits must be non empty");if(e[0].length===0)throw new Error("Split tensors must not be scalars");const l=e[0][0]-1;if(x_e(i,o,l),s.length===0)throw new Error("params.rank must be nonzero");const c=s[0],{outSplits:u,valueSlices:d,numValues:h}=b_e(i,o,t,c),f=w_e(u),p=k_e(n,s,r,d,h);return[f,p[0],p[1]]}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var zi=No;class xw{constructor(e,n,s,r,i,o,a,l,c,u){this.shape=e,this.shapeShape=n,this.values=s,this.valuesShape=r,this.valuesDType=i,this.defaultValue=o,this.defaultValueShape=a,this.rowPartitionValues=l,this.rowPartitionValuesShapes=c,this.rowPartitionTypes=z8(u),this.raggedRank=V8(this.rowPartitionTypes)}getRowPartitionTypeByDimension(e){return this.rowPartitionTypes[0]===zi.FIRST_DIM_SIZE?this.rowPartitionTypes[e+1]:this.rowPartitionTypes[e]}getRowPartitionTensor(e){return this.rowPartitionTypes[0]===zi.FIRST_DIM_SIZE?this.rowPartitionValues[e+1]:this.rowPartitionValues[e]}getMaxWidth(e){const n=this.getRowPartitionTensor(e-1);switch(this.getRowPartitionTypeByDimension(e-1)){case zi.VALUE_ROWIDS:return xw.getMaxWidthValueRowID(n);case zi.ROW_SPLITS:return xw.getMaxWidthRowSplit(n);default:throw new Error(`Cannot handle partition type ${zi[this.getRowPartitionTypeByDimension(e-1)]}`)}}static getMaxWidthRowSplit(e){const n=e.length;if(n===0||n===1)return 0;let s=0;for(let r=0;r<n-1;++r){const i=e[r+1]-e[r];i>s&&(s=i)}return s}static getMaxWidthValueRowID(e){const n=e.length;if(n===0)return 0;let s=0,r=e[0],i=0;for(let o=1;o<n;++o){const a=e[o];a!==r&&(r=a,i=Math.max(o-s,i),s=o)}return Math.max(n-s,i)}tensorShapeFromTensor(e,n,s=!0){if(n.length===0){if(e[0]===-1)return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return oV(e,s)}calculateOutputSize(e){const n=this.valuesShape,s=this.defaultValueShape;j8(s,n);const r=this.tensorShapeFromTensor(this.shape,this.shapeShape),o=M8(this.raggedRank,r,n);o[0]<0&&(o[0]=e);for(let a=1;a<=this.raggedRank;++a)o[a]<0&&(o[a]=this.getMaxWidth(a));return o}calculateFirstParentOutputIndex(e,n,s){const r=Math.min(e,s),i=[];let o=0;for(let a=0;a<r;++a,o+=n)i.push(o);for(let a=r;a<e;++a)i.push(-1);return O(i.length===e,()=>"Final length of result must be equal to firstDimension."),i}calculateOutputIndexRowSplit(e,n,s,r){const i=e.length,o=[];for(let a=0;a<i-1;++a){const l=e[a+1]-e[a];let c=Math.min(r,l),u=n[a];u===-1&&(c=0);for(let d=0;d<c;++d)o.push(u),u+=s;for(let d=0;d<l-c;++d)o.push(-1)}if(i>0&&o.length!==e[i-1])throw new Error("Invalid row split size.");return o}calculateOutputIndexValueRowID(e,n,s,r){const i=e.length,o=[];if(i===0)return[];let a=0,l=e[0];if(l>=n.length)throw new Error(`Got currentValueRowId=${l}, which is not less than ${n.length}`);let c=n[l];o.push(c);for(let u=1;u<i;++u){const d=e[u];if(d===l)c>=0&&(++a,a<r?c+=s:c=-1);else{if(a=0,l=d,d>=n.length)throw new Error(`Got nextValueRowId=${d} which is not less than ${n.length}`);c=n[d]}o.push(c)}if(o.length!==e.length)throw new Error("Invalid row ids.");return o}calculateOutputIndex(e,n,s,r){const i=this.getRowPartitionTensor(e),o=this.getRowPartitionTypeByDimension(e);switch(o){case zi.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(i,n,s,r);case zi.ROW_SPLITS:if(i.length-1>n.length)throw new Error(`Row partition size is greater than output size: ${i.length-1} > ${n.length}`);return this.calculateOutputIndexRowSplit(i,n,s,r);default:throw new Error(`Unsupported partition type: ${zi[o]}`)}}getFirstDimensionSize(){const e=this.rowPartitionValues[0];if(this.rowPartitionTypes.length===0)throw new Error("No row_partition_types given.");const n=this.rowPartitionTypes[0];switch(n){case zi.FIRST_DIM_SIZE:return e[0];case zi.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case zi.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error(`Cannot handle type ${zi[n]}`)}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");const n=this.getFirstDimensionSize(),s=this.calculateOutputSize(n),r=new Array(this.raggedRank+1);r[r.length-1]=1;for(let l=r.length-2;l>=0;--l)r[l]=r[l+1]*s[l+1];const i=oV(s,!1),o=ws(this.valuesDType,le(i));if(r[0]*s[0]>0){let l=this.calculateFirstParentOutputIndex(n,r[0],s[0]);for(let c=1;c<=this.raggedRank;++c)l=this.calculateOutputIndex(c-1,l,r[c],s[c]);this.setOutput(this.raggedRank,l,o,i)}return[i,o]}setOutput(e,n,s,r){if(s.length===0)return;const i=this.values,o=s;let a=r.slice();a=a.slice(e+1);const l=le(a),c=n.length;let u=this.defaultValue;if(u.length!==l&&u.length!==1){const p=this.defaultValueShape;se(()=>{const m=Q(u,p);u=Cc(m,a).dataSync()})}let d=0,h=0,f=0;for(let p=0;p<=c;++p){let m=p<c?n[p]:-1;if(m===f){++f;continue}if(h<f){const g=i.subarray(d*l),y=o.subarray(h*l),x=(f-h)*l;iV(y,g,x)}if(p>=c){const g=s.length;m=Math.floor(g/l)}if(m>f)if(this.defaultValue.length===1)o.subarray(f*l,m*l).fill(this.defaultValue[0]),f=m;else for(;m>f;){const g=o.slice(f*l);iV(g,u,l),++f}m<0?(d=p+1,h=f):(d=p,h=f,f=h+1)}}}function iV(t,e,n){for(let s=0;s<n;s++)t[s]=e[s]}function oV(t,e){const n=[];for(let s of t){if(s<0){if(!e)throw new Error(`Dimension ${s} must be >= 0`);if(s<-1)throw new Error(`Dimension ${s} must be >= -1`);s=-1}n.push(s)}return n}function iX(t,e,n,s,r,i,o,a,l,c){return new xw(t,e,n,s,r,i,o,a,l,c).compute()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oX(t,e,n,s){const r=t===e,i=t<e&&n<0,o=e<t&&n>1;if(r||i||o)return Xs(0,s);const a=Math.abs(Math.ceil((e-t)/n)),l=Xs(a,s);e<t&&n===1&&(n=-1),l[0]=t;for(let c=1;c<l.length;c++)l[c]=l[c-1]+n;return l}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aX=lu(t=>1/Math.sqrt(t)),C_e=hp(t0,aX),T_e={kernelName:t0,backendName:"cpu",kernelFunc:C_e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rh(t,e,n,s,r,i,o,a,l,c){const u=[s/r,r],d=t.values,h=e.values;if(s===0)return gt(n,e.dtype);const f=gt(u,e.dtype);typeof l=="string"||typeof l=="number"?f.values.fill(l):typeof l=="boolean"&&f.values.fill(+l);for(let p=0;p<i;p++){const m=[];let g=0;for(let y=0;y<o;y++){const x=d[p*o+y];m.push(x),g+=x*a[y]}if(g<0||g>=s/r)throw new Error(`Invalid indices: ${m} does not index into ${n}`);for(let y=0;y<r;y++)c?f.values[g*r+y]+=h[p*r+y]:f.values[g*r+y]=e.rank===0?h[0]:h[p*r+y]}return f}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const N_e=lu(t=>1/(1+Math.exp(-t))),lX=Ht(o0,t=>1/(1+Math.exp(-t))),I_e={kernelName:o0,backendName:"cpu",kernelFunc:lX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cX(t,e,n,s,r){const i=AA(s,e,n),o=le(n),a=Ye(s);if(i){const d=RA(e,a);return r==="string"?t.slice(d,d+o):t.subarray(d,d+o)}const l=r==="string"?Cd(t):t,c=gt(s,r,l),u=gt(n,r);for(let d=0;d<u.size;++d){const h=u.indexToLoc(d),f=h.map((p,m)=>p+e[m]);u.set(c.get(...f),...h)}return r==="string"?aK(u.values):u.values}function _d(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{begin:i,size:o}=s;Ve(r,"slice");const[a,l]=IS(r,i,o);EA(r,a,l);const c=n.data.get(r.dataId).values,u=cX(c,a,l,r.shape,r.dtype);return n.makeTensorInfo(l,r.dtype,u)}const __e={kernelName:gS,backendName:"cpu",kernelFunc:_d};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uX(t,e,n,s,r,i,o){const a=e[0],l=i[0],c=new Array(l),u=new Array(a),d=e[1];if(l===0){if(a!==0)throw new Error(q8(a));const g=ws(n,0),y=ws(r,0);return[g,[0,d],y,c,u]}let h=!0,f=0;const p=new Array(l).fill(0);for(let g=0;g<a;++g){const y=t[g*d];if(y<0)throw new Error(X8(g,y));if(y>=l)throw new Error(Y8(g,y,l));++p[y],h=h&&y>=f,f=y}let m=!0;for(let g=0;g<l;++g){const y=p[g]===0;c[g]=y,m=m&&!y,p[g]=Math.max(p[g],1),g>0&&(p[g]+=p[g-1])}if(m&&h){const g=t,y=s;for(let x=0;x<a;++x)u[x]=x;return[g,[a,d],y,c,u]}else{const g=p[l-1],y=ws(n,g*d),x=ws(r,g),v=new Array(l).fill(0);for(let b=0;b<a;++b){const k=t[b*d],C=v[k],N=(k===0?0:p[k-1])+C;v[k]++;for(let I=0;I<d;++I)y[N*d+I]=t[b*d+I];x[N]=s[b],u[b]=N}for(let b=0;b<l;++b)if(v[b]===0){const C=b===0?0:p[b-1];y[C*d+0]=b;for(let N=1;N<d;++N)y[C*d+N]=0;x[C]=o}return[y,[g,d],x,c,u]}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dX(t,e,n,s,r){const i=le(s),o=e[0],a=r.length,l=[];let c=1,u=-1;for(let g=0;g<a;++g){const y=r[g];if(y===-1){if(u!==-1)throw new Error(Z8(u,g));u=g,l.push(1)}else{if(y<0)throw new Error(Q8(g,y));c*=y,l.push(y)}}if(u!==-1){if(c<=0)throw new Error(J8());const g=Math.trunc(i/c);if(c*g!==i)throw new Error(eK(s,l));l[u]=g}if(le(l)!==i)throw new Error(tK(s,l));const h=s.length,f=[];if(h>0){f[h-1]=1;for(let g=h-2;g>=0;--g)f[g]=f[g+1]*s[g+1]}const p=[];if(a>0){p[a-1]=1;for(let g=a-2;g>=0;--g)p[g]=p[g+1]*l[g+1]}const m=ws(n,o*a);for(let g=0;g<o;++g){let y=0;for(let x=0;x<h;++x)y+=t[g*h+x]*f[x];for(let x=0;x<a;++x)m[g*a+x]=Math.trunc(y/p[x]),y%=p[x]}return[m,[o,a],l]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SD(t,e,n,s,r,i=!1,o=0){const a=s.length,l=[e[0],t.length/e[0]],c=l[1],d=a>0?r[a-1]+1:0;if(d<0)throw new Error(Q2());const h=e.slice();h[0]=d;const f=h.reduce((v,b)=>v*b,1),p=ws(n,f);if(a===0)return d>0&&p.fill(o),[p,h];if(d<=0)throw new Error(Q2());let m=0,g=1,y=0,x=r[m];for(;;){let v=0;if(g<a){if(v=r[g],x===v){++g;continue}if(x>=v)throw new Error(nK())}if(x<0||x>=d)throw new Error(sK(x,d));x>y&&p.fill(o,y*c,x*c);for(let b=m;b<g;++b){const k=s[b];if(k<0||k>=l[0])throw new Error(rK(b,s[b],l[0]));for(let C=0;C<c;C++)p[x*c+C]+=t[k*c+C]}if(i)for(let b=0;b<c;b++)p[x*c+b]/=g-m;if(m=g,++g,y=x+1,x=v,g>a)break}return y<d&&p.fill(o,y*c,d*c),[p,h]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const E_e=lu(t=>Math.sqrt(t)),$_e=Ht(l0,t=>Math.sqrt(t)),A_e={kernelName:l0,backendName:"cpu",kernelFunc:$_e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hX=rs((t,e)=>{const n=t-e;return n*n}),R_e=Is(c0,hX),D_e={kernelName:c0,backendName:"cpu",kernelFunc:R_e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fX(t,e,n,s){const r=gt(t,e.dtype);for(let i=0;i<r.size;i++){const o=r.indexToLoc(i),a=new Array(o.length);for(let l=0;l<a.length;l++)a[l]=o[l]*n[l]+s[l];r.set(e.get(...a),...o)}return r}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class O_e{constructor(e,n,s,r,i,o){this.separator=kc(e),this.nGramWidths=n,this.leftPad=kc(s),this.rightPad=kc(r),this.padWidth=i,this.preserveShort=o}getPadWidth(e){return Math.min(this.padWidth<0?e-1:this.padWidth,e-1)}getNumNGrams(e,n){const s=this.getPadWidth(n);return Math.max(0,e+2*s-n+1)}createNGrams(e,n,s,r,i,o){for(let a=0;a<i;++a){const l=this.getPadWidth(o),c=Math.max(0,l-a),u=Math.max(0,l-(i-(a+1))),d=o-(c+u),h=n+(c>0?0:a-l);let f=0;f+=c*this.leftPad.length;for(let x=0;x<d;++x)f+=e[h+x].length;f+=u*this.rightPad.length;const p=c+u+d-1;f+=p*this.separator.length,s[r+a]=new Uint8Array(f);const m=s[r+a];let g=0;const y=x=>x.forEach(v=>m[g++]=v);for(let x=0;x<c;++x)y(this.leftPad),y(this.separator);for(let x=0;x<d-1;++x)y(e[h+x]),y(this.separator);if(d>0){y(e[h+d-1]);for(let x=0;x<u;++x)y(this.separator),y(this.rightPad)}else{for(let x=0;x<u-1;++x)y(this.rightPad),y(this.separator);y(this.rightPad)}}}compute(e,n){const s=e.length,r=n.length;if(r>0){let l=n[0];if(l!==0)throw new Error(`First split value must be 0, got ${l}`);for(let c=1;c<r;++c){let u=n[c]>=l;if(u=u&&n[c]<=s,!u)throw new Error(`Invalid split value ${n[c]}, must be in [${l}, ${s}]`);l=n[c]}if(l!==s)throw new Error(`Last split value must be data size. Expected ${s}, got ${l}`)}const i=r-1,o=ws("int32",r);if(s===0||r===0){const l=new Array(s);for(let c=0;c<=i;++c)o[c]=0;return[l,o]}o[0]=0;for(let l=1;l<=i;++l){const c=n[l]-n[l-1];let u=0;this.nGramWidths.forEach(d=>{u+=this.getNumNGrams(c,d)}),this.preserveShort&&c>0&&u===0&&(u=1),o[l]=o[l-1]+u}const a=new Array(o[i]);for(let l=0;l<i;++l){const c=n[l];let u=o[l];if(this.nGramWidths.forEach(d=>{const h=n[l+1]-n[l],f=this.getNumNGrams(h,d);this.createNGrams(e,c,a,u,f,d),u+=f}),this.preserveShort&&u===o[l]){const d=n[l+1]-n[l];if(d===0)continue;const h=d+2*this.padWidth,f=1;this.createNGrams(e,c,a,u,f,h)}}return[a,o]}}function pX(t,e,n,s,r,i,o,a){return new O_e(n,s,r,i,o,a).compute(t,e)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P_e(t,e,n,s){if(!t.length)return;if(e.length===0){for(let i=0;i<t.length;++i)s.push(t.subarray(i,i+1));return}if(e.length===1){const i=e[0];let o=t.indexOf(i);for(;o!==-1;){const a=t.subarray(0,o);(!n||a.length!==0)&&s.push(a),t=t.subarray(o+1),o=t.indexOf(i)}(!n||t.length!==0)&&s.push(t);return}let r=0;for(let i=0;i<t.length+1;i++)if(i===t.length||e.indexOf(t[i])!==-1){const o=t.subarray(r,i);(!n||o.length!==0)&&s.push(o),r=i+1}}function mX(t,e,n){const s=t.length,r=[];let i=0,o=0;const a=new Array(s);for(let h=0;h<s;++h){const f=r.length;P_e(t[h],e,n,r);const p=r.length-f;a[h]=p,i+=p,o=Math.max(o,p)}const l=ws("int32",i*2),c=new Array(i),u=[s,o];let d=0;for(let h=0;h<s;++h)for(let f=0;f<a[h];++f)l[d*2]=h,l[d*2+1]=f,c[d]=r[d],++d;return[l,c,u]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gX(t,e){const n=ws("int32",t.length);for(let s=0;s<t.length;++s)n[s]=Fge(t[s]).modulo(e).getLowBitsUnsigned();return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yX=rs((t,e)=>t-e),F_e=xD((t,e,n,s)=>({real:t-n,imag:e-s})),kD=Is(u0,yX,F_e),L_e={kernelName:u0,backendName:"cpu",kernelFunc:kD};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xX(t,e){const n=new Array(t.rank);for(let r=0;r<n.length;r++)n[r]=t.shape[r]*e[r];const s=gt(n,t.dtype);for(let r=0;r<s.values.length;++r){const i=s.indexToLoc(r),o=new Array(t.rank);for(let l=0;l<o.length;l++)o[l]=i[l]%t.shape[l];const a=t.locToIndex(o);s.values[r]=t.values[a]}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bm=(t,e)=>{const n=e.value-t.value;return n===0?t.index-e.index:n};function vX(t,e,n=0,s=t.length-1){for(;s>n;){if(s-n>600){const a=s-n+1,l=e-n+1,c=Math.log(a),u=.5*Math.exp(2*c/3),d=.5*Math.sqrt(c*u*(a-u)/a)*Math.sign(l-a/2),h=Math.max(n,Math.floor(e-l*u/a+d)),f=Math.min(s,Math.floor(e+(a-l)*u/a+d));vX(t,e,h,f)}const r=t[e];let i=n,o=s;for(lh(t,n,e),bm(t[s],r)>0&&lh(t,n,s);i<o;){for(lh(t,i,o),i++,o--;bm(t[i],r)<0;)i=i+1;for(;bm(t[o],r)>0;)o=o-1}bm(t[n],r)===0?lh(t,n,o):(o=o+1,lh(t,o,s)),o<=e&&(n=o+1),e<=o&&(s=o-1)}}function bX(t,e,n,s,r){const i=e[e.length-1],[o,a]=[t.length/i,i],l=Cs(n,o*s),c=Cs("int32",o*s);for(let d=0;d<o;d++){const h=d*a,f=t.subarray(h,h+a);let p=new Array(f.length);f.forEach((x,v)=>p[v]={value:x,index:v}),s<p.length&&(vX(p,s),p=p.slice(0,s)),r&&p.sort(bm);const m=d*s,g=l.subarray(m,m+s),y=c.subarray(m,m+s);for(let x=0;x<s;x++)g[x]=p[x].value,y[x]=p[x].index}const u=e.slice();return u[u.length-1]=s,[gt(u,n,l),gt(u,"int32",c)]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wX(t,e,n,s){const r=bt(e,n)[0],i=[1,n[0],1];for(let p=0;p<r;p++)i[0]*=n[p];i[1]=n[r];for(let p=r+1;p<n.length;p++)i[2]*=n[p];const o={},a=new Int32Array(n[r]),l=new ks(i,s,t),c=[],u=i[0]===1&&i[2]===1;for(let p=0;p<n[r];p++){let m;if(u)m=t[p].toString();else{const g=[];for(let y=0;y<i[0];y++)for(let x=0;x<i[2];x++)g.push(l.get(y,p,x));m=g.join(",")}if(o[m]!==void 0)a[p]=o[m];else{const g=Object.keys(o).length;o[m]=g,a[p]=g,c.push(p)}}const d=i.slice();d[1]=Object.keys(o).length;const h=new ks(d,s);c.forEach((p,m)=>{for(let g=0;g<i[0];g++)for(let y=0;y<i[2];y++)h.set(l.get(g,p,y),g,m,y)});const f=n.slice();return f[r]=d[1],{outputValues:h.values,outputShape:f,indices:a}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const M_e=Object.freeze(Object.defineProperty({__proto__:null,addImpl:O9,bincountImpl:vD,bincountReduceImpl:P9,castImpl:D9,ceilImpl:F9,concatImpl:L9,equalImpl:M9,expImpl:V9,expm1Impl:B9,floorImpl:W9,gatherNdImpl:U9,gatherV2Impl:H9,greaterEqualImpl:K9,greaterImpl:G9,lessEqualImpl:X9,lessImpl:q9,linSpaceImpl:Y9,logImpl:Z9,maxImpl:Q9,maximumImpl:J9,minimumImpl:eX,multiplyImpl:bD,negImpl:tX,notEqualImpl:nX,prodImpl:sX,raggedGatherImpl:rX,raggedTensorToTensorImpl:iX,rangeImpl:oX,rsqrtImpl:aX,scatterImpl:Rh,sigmoidImpl:N_e,simpleAbsImpl:R9,sliceImpl:cX,sparseFillEmptyRowsImpl:uX,sparseReshapeImpl:dX,sparseSegmentReductionImpl:SD,sqrtImpl:E_e,squaredDifferenceImpl:hX,stridedSliceImpl:fX,stringNGramsImpl:pX,stringSplitImpl:mX,stringToHashBucketFastImpl:gX,subImpl:yX,tileImpl:xX,topKImpl:bX,transposeImpl:wD,uniqueImpl:wX},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */vG("cpu",()=>new ck,1);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SX=Ht(Dy,t=>t>=0?t:Math.exp(t)-1),z_e={kernelName:Dy,backendName:"cpu",kernelFunc:SX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kX(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{alpha:i}=s;Ve([r],"leakyRelu");const o=le(r.shape),a=n.data.get(r.dataId).values,l=Cs("float32",o);for(let c=0;c<a.length;c++)l[c]=a[c]<0?i*a[c]:a[c];return n.makeTensorInfo(r.shape,"float32",l)}const V_e={kernelName:U1,backendName:"cpu",kernelFunc:kX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const j_e=rs((t,e)=>t<0?e*t:t);function CX(t){const{inputs:e,backend:n}=t,{x:s,alpha:r}=e;Ve([s,r],"prelu");const i=n.data.get(s.dataId).values,o=n.data.get(r.dataId).values,[a,l]=j_e(s.shape,r.shape,i,o,"float32");return n.makeTensorInfo(l,"float32",a)}const B_e={kernelName:cS,backendName:"cpu",kernelFunc:CX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TX=Ht(Qy,t=>Math.max(0,t)),W_e={kernelName:Qy,backendName:"cpu",kernelFunc:TX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NX=Ht(Jy,t=>Math.min(Math.max(0,t),6)),U_e={kernelName:Jy,backendName:"cpu",kernelFunc:NX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vw(t,e,n,s,r){if(n==="linear")return Ra({inputs:{x:e},backend:t});if(n==="relu")return TX({inputs:{x:e},backend:t});if(n==="elu")return SX({inputs:{x:e},backend:t});if(n==="relu6")return NX({inputs:{x:e},backend:t});if(n==="prelu")return CX({inputs:{x:e,alpha:s},backend:t});if(n==="leakyrelu")return kX({inputs:{x:e},backend:t,attrs:{alpha:r}});if(n==="sigmoid")return lX({inputs:{x:e},backend:t});throw new Error(`Activation ${n} has not been implemented for the CPU backend.`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nn(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{shape:i}=s,o=le(r.shape),a=_6(i,o),l=le(a);O(o===l,()=>`The new shape (${a}) has ${l} elements and the old shape (${r.shape}) has ${o} elements. The new shape and old shape must have the same number of elements.`),n.incRef(r.dataId);const c=n.data.get(r.dataId);if(c.complexTensorInfos!=null){const u=c.complexTensorInfos.real,d=c.complexTensorInfos.imag;u.shape=a,d.shape=a}return{dataId:r.dataId,shape:a,dtype:r.dtype}}const H_e={kernelName:dS,backendName:"cpu",kernelFunc:nn};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IX(t){const{inputs:e,backend:n,attrs:s}=t,{a:r,b:i}=e,{transposeA:o,transposeB:a}=s;Ve([r,i],"matMul");const l=r.shape.length,c=i.shape.length,u=o?r.shape[l-2]:r.shape[l-1],d=a?i.shape[c-1]:i.shape[c-2],h=o?r.shape[l-1]:r.shape[l-2],f=a?i.shape[c-2]:i.shape[c-1],p=r.shape.slice(0,-2),m=i.shape.slice(0,-2),g=le(p),y=le(m),v=ct(r.shape.slice(0,-2),i.shape.slice(0,-2)).concat([h,f]);O(u===d,()=>`Error in matMul: inner shapes (${u}) and (${d}) of Tensors with shapes ${r.shape} and ${i.shape} and transposeA=${o} and transposeB=${a} must match.`);const b=o?[g,u,h]:[g,h,u],k=a?[y,f,d]:[y,d,f],C=nn({inputs:{x:r},backend:n,attrs:{shape:b}}),N=nn({inputs:{x:i},backend:n,attrs:{shape:k}}),I=o?C.shape[1]:C.shape[2],$=o?C.shape[2]:C.shape[1],A=a?N.shape[1]:N.shape[2],P=Math.max(g,y),F=n.data.get(C.dataId).values,V=n.data.get(N.dataId).values,z=Ye(C.shape),B=Ye(N.shape),[W,q,M]=o?[z[0],1,z[1]]:[z[0],z[1],1],[G,ne,ie]=a?[1,B[1],B[0]]:[B[1],1,B[0]],de=$*A,he=gt([P,$,A],C.dtype),pe=he.values,me=n.blockSize;for(let ye=0;ye<P;ye++)for(let Ce=0;Ce<$;Ce+=me)for(let Le=0;Le<A;Le+=me)for(let Re=0;Re<I;Re+=me){const Ze=Math.min(Ce+me,$),tt=Math.min(Le+me,A),mt=Math.min(Re+me,I);for(let Xe=Ce;Xe<Ze;Xe++)for(let Me=Le;Me<tt;Me++){let wt=0;for(let it=Re;it<mt;it++){const At=Math.min(ye,g-1)*W,Vt=Math.min(ye,y-1)*ie,_n=F[At+Xe*q+it*M],K=V[it*G+Me*ne+Vt];wt+=_n*K}pe[ye*de+(Xe*A+Me)]+=wt}}return n.disposeIntermediateTensorInfo(C),n.disposeIntermediateTensorInfo(N),n.makeTensorInfo(v,he.dtype,he.values)}const G_e={kernelName:E1,backendName:"cpu",kernelFunc:IX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K_e(t){const{inputs:e,backend:n,attrs:s}=t,{a:r,b:i,bias:o,preluActivationWeights:a}=e,{transposeA:l,transposeB:c,activation:u,leakyreluAlpha:d}=s;let h,f,p;const m=[];h=IX({inputs:{a:r,b:i},attrs:{transposeA:l,transposeB:c},backend:n}),o&&(f=Mf({inputs:{a:h,b:o},backend:n}),m.push(h),h=f),u&&(p=vw(n,h,u,a,d),m.push(h),h=p);for(const y of m)n.disposeIntermediateTensorInfo(y);return h}const q_e={kernelName:Kb,backendName:"cpu",kernelFunc:K_e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const X_e=Ht(by,t=>Math.acos(t)),Y_e={kernelName:by,backendName:"cpu",kernelFunc:X_e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Z_e=Ht(wy,t=>Math.acosh(t)),Q_e={kernelName:wy,backendName:"cpu",kernelFunc:Z_e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J_e(t){const{inputs:e,backend:n}=t,s=e;Ve(e,"addN");const r=s.map(a=>n.data.get(a.dataId).values),i=gt(s[0].shape,s[0].dtype),o=i.values;for(let a=0;a<s.length;a++){const l=r[a];for(let c=0;c<o.length;c++)o[c]+=l[c]}return n.makeTensorInfo(i.shape,i.dtype,i.values)}const eEe={kernelName:C1,backendName:"cpu",kernelFunc:J_e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tEe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,keepDims:o}=s;Ve(r,"all");const a=bt(i,r.shape);let l=a;const c=In(l,r.shape.length);let u=r;c!=null&&(u=_r({inputs:{x:r},backend:n,attrs:{perm:c}}),l=Gn(l.length,r.shape.length)),zs("all",l,u.shape.length);const[d,h]=Ns(u.shape,l),f=le(h),p=Xs(le(d),u.dtype),m=n.data.get(u.dataId).values;for(let y=0;y<p.length;++y){const x=y*f;let v=m[x];for(let b=0;b<f;++b){const k=m[x+b];v=v&&k}p[y]=v}c!=null&&n.disposeIntermediateTensorInfo(u);const g=n.makeTensorInfo(d,u.dtype,p);if(o){const y=Hn(d,a),x=nn({inputs:{x:g},backend:n,attrs:{shape:y}});return n.disposeIntermediateTensorInfo(g),x}return g}const nEe={kernelName:x$,backendName:"cpu",kernelFunc:tEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sEe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,keepDims:o}=s;Ve(r,"any");const a=bt(i,r.shape);let l=a;const c=In(l,r.shape.length);let u=r;c!=null&&(u=_r({inputs:{x:r},backend:n,attrs:{perm:c}}),l=Gn(l.length,r.shape.length)),zs("any",l,u.shape.length);const[d,h]=Ns(u.shape,l),f=le(h),p=Xs(le(d),u.dtype),m=n.data.get(u.dataId).values;for(let y=0;y<p.length;++y){const x=y*f;let v=m[x];for(let b=0;b<f;++b){const k=m[x+b];v=v||k}p[y]=v}c!=null&&n.disposeIntermediateTensorInfo(u);const g=n.makeTensorInfo(d,u.dtype,p);if(o){const y=Hn(d,a),x=nn({inputs:{x:g},backend:n,attrs:{shape:y}});return n.disposeIntermediateTensorInfo(g),x}return g}const rEe={kernelName:v$,backendName:"cpu",kernelFunc:sEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iEe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i}=s;Ve(r,"argMax");let o=bt(i,r.shape);const a=In(o,r.shape.length);let l=r;const c=[];a!=null&&(l=_r({inputs:{x:r},backend:n,attrs:{perm:a}}),c.push(l),o=Gn(o.length,l.shape.length)),o=[o[0]],zs("argMax",o,l.shape.length);const[u,d]=Ns(l.shape,o),h=le(u),f=Xs(h,"int32"),p=le(d),m=n.data.get(l.dataId).values;for(let g=0;g<f.length;++g){const y=g*p;let x=m[y],v=0;for(let b=0;b<p;++b){const k=m[y+b];k>x&&(x=k,v=b)}f[g]=v}return c.forEach(g=>n.disposeIntermediateTensorInfo(g)),n.makeTensorInfo(u,"int32",f)}const oEe={kernelName:T1,backendName:"cpu",kernelFunc:iEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aEe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i}=s;Ve(r,"argMin");let o=bt(i,r.shape);const a=In(o,r.shape.length);let l=r;const c=[];a!=null&&(l=_r({inputs:{x:r},backend:n,attrs:{perm:a}}),c.push(l),o=Gn(o.length,l.shape.length)),o=[o[0]],zs("argMin",o,l.shape.length);const[u,d]=Ns(l.shape,o),h=le(u),f=Xs(h,"int32"),p=le(d),m=n.data.get(l.dataId).values;for(let g=0;g<f.length;++g){const y=g*p;let x=m[y],v=0;for(let b=0;b<p;++b){const k=m[y+b];k<x&&(x=k,v=b)}f[g]=v}return c.forEach(g=>n.disposeIntermediateTensorInfo(g)),n.makeTensorInfo(u,"int32",f)}const lEe={kernelName:N1,backendName:"cpu",kernelFunc:aEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cEe=Ht(Sy,t=>Math.asin(t)),uEe={kernelName:Sy,backendName:"cpu",kernelFunc:cEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dEe=Ht(ky,t=>Math.asinh(t)),hEe={kernelName:ky,backendName:"cpu",kernelFunc:dEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fEe=Ht(Cy,t=>Math.atan(t)),pEe={kernelName:Cy,backendName:"cpu",kernelFunc:fEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mEe=rs((t,e)=>Math.atan2(t,e)),gEe=Is(Ny,mEe),yEe={kernelName:Ny,backendName:"cpu",kernelFunc:gEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xEe=Ht(Ty,t=>Math.atanh(t)),vEe={kernelName:Ty,backendName:"cpu",kernelFunc:xEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CD(t,e,n,s,r,i){const o=r.strideHeight,a=r.strideWidth,l=r.dilationHeight,c=r.dilationWidth,u=r.effectiveFilterHeight,d=r.effectiveFilterWidth,h=r.padInfo.top,f=r.padInfo.left,p=i==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,m=gt(r.outShape,n),g=m.values,y=r.outShape[1]*r.outShape[2]*r.outShape[3],x=r.outShape[2]*r.outShape[3],v=r.outShape[3];for(let b=0;b<r.batchSize;++b){const k=b*y,C=b*s[0];for(let N=0;N<r.inChannels;++N)for(let I=0;I<r.outHeight;++I){const $=I*o-h,A=Math.max(0,$),P=Math.min(r.inHeight,u+$),F=k+I*x;for(let V=0;V<r.outWidth;++V){const z=V*a-f,B=Math.max(0,z),W=Math.min(r.inWidth,d+z);let q=p,M=0,G=0;for(let ie=A;ie<P;ie+=l){const de=C+ie*s[1];for(let he=B;he<W;he+=c){const pe=de+he*s[2],me=t[pe+N];i==="max"&&me>q?q=me:i==="avg"&&(M+=me,G++)}if(isNaN(q))break}const ne=F+V*v+N;g[ne]=i==="avg"?M/G:q}}}return m}function _X(t,e,n,s,r=!1,i=!1){const o=gt(s.outShape,"int32"),a=s.strideHeight,l=s.strideWidth,c=s.dilationHeight,u=s.dilationWidth,d=s.effectiveFilterHeight,h=s.effectiveFilterWidth,f=s.padInfo.top,p=s.padInfo.left,m=gt(e,n,t);for(let g=0;g<s.batchSize;++g)for(let y=0;y<s.inChannels;++y)for(let x=0;x<s.outHeight;++x){const v=x*a-f;let b=v;for(;b<0;)b+=c;const k=Math.min(s.inHeight,d+v);for(let C=0;C<s.outWidth;++C){const N=C*l-p;let I=N;for(;I<0;)I+=u;const $=Math.min(s.inWidth,h+N);let A=Number.NEGATIVE_INFINITY,P=-1;for(let F=b;F<k;F+=c){const V=F-v;for(let z=I;z<$;z+=u){const B=z-N,W=m.get(g,F,z,y);W>A&&(A=W,r?P=i?((g*s.inHeight+F)*s.inWidth+z)*s.inChannels+y:(F*s.inWidth+z)*s.inChannels+y:P=V*h+B)}}o.set(P,g,x,C,y)}}return o}function EX(t,e,n,s,r,i){const o=r.strideDepth,a=r.strideHeight,l=r.strideWidth,c=r.dilationDepth,u=r.dilationHeight,d=r.dilationWidth,h=r.effectiveFilterDepth,f=r.effectiveFilterHeight,p=r.effectiveFilterWidth,m=r.padInfo.front,g=r.padInfo.top,y=r.padInfo.left,x=i==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,v=gt(r.outShape,n),b=v.values,k=r.outShape[1]*r.outShape[2]*r.outShape[3]*r.outShape[4],C=r.outShape[2]*r.outShape[3]*r.outShape[4],N=r.outShape[3]*r.outShape[4],I=r.outShape[4];for(let $=0;$<r.batchSize;++$){const A=$*k,P=$*s[0];for(let F=0;F<r.inChannels;++F)for(let V=0;V<r.outDepth;++V){const z=V*o-m;let B=z;for(;B<0;)B+=c;const W=Math.min(r.inDepth,h+z),q=A+V*C;for(let M=0;M<r.outHeight;++M){const G=M*a-g;let ne=G;for(;ne<0;)ne+=u;const ie=Math.min(r.inHeight,f+G),de=q+M*N;for(let he=0;he<r.outWidth;++he){const pe=he*l-y;let me=pe;for(;me<0;)me+=d;const ye=Math.min(r.inWidth,p+pe),Ce=de+he*I;let Le=x,Re=0,Ze=0;for(let mt=B;mt<W;mt+=c){const Xe=P+mt*s[1];for(let Me=ne;Me<ie;Me+=u){const wt=Xe+Me*s[2];for(let it=me;it<ye;it+=d){const At=wt+it*s[3],Vt=t[At+F];if(i==="max"&&Vt>Le?Le=Vt:i==="avg"&&(Re+=Vt,Ze++),isNaN(Le))break}if(isNaN(Le))break}if(isNaN(Le))break}const tt=Ce+F;b[tt]=i==="avg"?Re/Ze:Le}}}}return v}function bEe(t,e){const n=gt(e.outShape,"int32"),s=e.strideDepth,r=e.strideHeight,i=e.strideWidth,o=e.dilationDepth,a=e.dilationHeight,l=e.dilationWidth,c=e.effectiveFilterDepth,u=e.effectiveFilterHeight,d=e.effectiveFilterWidth,h=e.padInfo.front,f=e.padInfo.top,p=e.padInfo.left;for(let m=0;m<e.batchSize;++m)for(let g=0;g<e.inChannels;++g)for(let y=0;y<e.outDepth;++y){const x=y*s-h;let v=x;for(;v<0;)v+=o;const b=Math.min(e.inDepth,c+x);for(let k=0;k<e.outHeight;++k){const C=k*r-f;let N=C;for(;N<0;)N+=a;const I=Math.min(e.inHeight,u+C);for(let $=0;$<e.outWidth;++$){const A=$*i-p;let P=A;for(;P<0;)P+=l;const F=Math.min(e.inWidth,d+A);let V=Number.NEGATIVE_INFINITY,z=-1;for(let B=v;B<b;B+=o){const W=B-x;for(let q=N;q<I;q+=a){const M=q-C;for(let G=P;G<F;G+=l){const ne=G-A,ie=t.get(m,B,q,G,g);ie>=V&&(V=ie,z=W*u*d+M*u+ne)}}}n.set(z,m,y,k,$,g)}}}return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wEe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e;Ve(r,"avgPool");const{filterSize:i,strides:o,pad:a,dimRoundingMode:l}=s,c=1;O(Ms(o,c),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${c}'`);const u=uo(r.shape,i,o,c,a,l);let d;if(u.filterWidth===1&&u.filterHeight===1&&Et(u.inShape,u.outShape))d=Ra({inputs:{x:r},backend:n});else{const h=n.data.get(r.dataId).values,f=Ye(r.shape),p=CD(h,r.shape,r.dtype,f,u,"avg");d=n.makeTensorInfo(u.outShape,r.dtype,p.values)}return d}const SEe={kernelName:I1,backendName:"cpu",kernelFunc:wEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kEe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{filterSize:i,strides:o,pad:a,dimRoundingMode:l,dataFormat:c}=s;Ve(r,"avgPool3d");const u=wl(r.shape,i,o,1,a,l,c),d=n.data.get(r.dataId).values,h=EX(d,r.shape,r.dtype,Ye(r.shape),u,"avg");return n.makeTensorInfo(h.shape,"float32",h.values)}const CEe={kernelName:_1,backendName:"cpu",kernelFunc:kEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TEe(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:i}=e,{filterSize:o,strides:a,pad:l,dimRoundingMode:c}=s;Ve([r,i],"avgPool3DGrad");const u=wl(i.shape,o,a,1,l,c),d=u.strideDepth,h=u.strideHeight,f=u.strideWidth,p=u.filterDepth,m=u.filterHeight,g=u.filterWidth,y=u.dilationDepth,x=u.dilationHeight,v=u.dilationWidth,b=u.effectiveFilterDepth,k=u.effectiveFilterHeight,C=u.effectiveFilterWidth,N=b-1-u.padInfo.front,I=C-1-u.padInfo.left,$=k-1-u.padInfo.top,A=gt(i.shape,"float32"),P=1/(p*m*g),F=n.bufferSync(r);for(let V=0;V<u.batchSize;++V)for(let z=0;z<u.inChannels;++z)for(let B=0;B<u.inDepth;++B)for(let W=0;W<u.inHeight;++W)for(let q=0;q<u.inWidth;++q){const M=B-N,G=W-$,ne=q-I;let ie=0;for(let de=0;de<b;de+=y){const he=(M+de)/d;if(!(he<0||he>=u.outDepth||Math.floor(he)!==he))for(let pe=0;pe<k;pe+=x){const me=(G+pe)/h;if(!(me<0||me>=u.outHeight||Math.floor(me)!==me))for(let ye=0;ye<C;ye+=v){const Ce=(ne+ye)/f;if(Ce<0||Ce>=u.outWidth||Math.floor(Ce)!==Ce)continue;const Le=F.get(V,he,me,Ce,z);ie+=Le}}}A.set(ie*P,V,B,W,q,z)}return n.makeTensorInfo(A.shape,A.dtype,A.values)}const NEe={kernelName:w$,backendName:"cpu",kernelFunc:TEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IEe(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:i}=e,o=i;Ve([r,i],"avgPoolGrad");const{filterSize:a,strides:l,pad:c}=s,u=uo(o.shape,a,l,1,c),d=u.strideHeight,h=u.strideWidth,f=u.filterHeight,p=u.filterWidth,m=u.dilationHeight,g=u.dilationWidth,y=u.effectiveFilterHeight,x=u.effectiveFilterWidth,v=x-1-u.padInfo.left,b=y-1-u.padInfo.top,k=gt(o.shape,"float32"),C=1/(f*p),N=n.data.get(r.dataId).values,I=gt(r.shape,"float32",N);for(let $=0;$<u.batchSize;++$)for(let A=0;A<u.inChannels;++A)for(let P=0;P<u.inHeight;++P)for(let F=0;F<u.inWidth;++F){const V=P-b,z=F-v;let B=0;for(let W=0;W<y;W+=m){const q=(V+W)/d;if(!(q<0||q>=u.outHeight||Math.floor(q)!==q))for(let M=0;M<x;M+=g){const G=(z+M)/h;if(G<0||G>=u.outWidth||Math.floor(G)!==G)continue;const ne=I.get($,q,G,A);B+=ne}}k.set(B*C,$,P,F,A)}return n.makeTensorInfo(k.shape,k.dtype,k.values)}const _Ee={kernelName:b$,backendName:"cpu",kernelFunc:IEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EEe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,scale:i,offset:o,mean:a,variance:l}=e;O(a.shape.length===l.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),O(o==null||a.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),O(i==null||a.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks."),Ve([r,a,l,i,o],"batchNorm");let{varianceEpsilon:c}=s;c==null&&(c=.001);const u=n.data.get(r.dataId).values,d=n.data.get(a.dataId).values,h=n.data.get(l.dataId).values,f=i?n.data.get(i.dataId).values:new Float32Array([1]),p=o?n.data.get(o.dataId).values:new Float32Array([0]),m=new Float32Array(u.length),g=p.length,y=f.length,x=h.length,v=d.length;let b=0,k=0,C=0,N=0;for(let I=0;I<u.length;++I)m[I]=p[b++]+(u[I]-d[k++])*f[C++]/Math.sqrt(h[N++]+c),b>=g&&(b=0),k>=v&&(k=0),C>=y&&(C=0),N>=x&&(N=0);return n.makeTensorInfo(r.shape,r.dtype,m)}const $Ee={kernelName:j1,backendName:"cpu",kernelFunc:EEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AEe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{blockShape:i,crops:o}=s;Ve([r],"batchToSpaceND");const a=i.reduce((y,x)=>y*x),l=C0(r.shape,i,a),c=T0(l.length,i.length),u=N0(r.shape,i,a),d=AR(o,i.length),h=RR(u,o,i.length),f=nn({inputs:{x:r},backend:n,attrs:{shape:l}}),p=_r({inputs:{x:f},backend:n,attrs:{perm:c}}),m=nn({inputs:{x:p},backend:n,attrs:{shape:u}}),g=_d({inputs:{x:m},backend:n,attrs:{begin:d,size:h}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),g}const REe={kernelName:$1,backendName:"cpu",kernelFunc:AEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DEe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,weights:i}=e,{size:o}=s,a=n.data.get(r.dataId).values,l=n.data.get(i.dataId).values,c=vD(a,l,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,c)}const OEe={kernelName:S$,backendName:"cpu",kernelFunc:DEe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PEe(t){const{inputs:e,backend:n}=t,{s0:s,s1:r}=e,i=n.data.get(s.dataId).values,o=n.data.get(r.dataId).values,a=ct(Array.from(i),Array.from(o));return n.makeTensorInfo([a.length],"int32",Int32Array.from(a))}const FEe={kernelName:k$,backendName:"cpu",kernelFunc:PEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LEe=Ht(Ey,(t,e)=>{const n=e;return t>n.clipValueMax?n.clipValueMax:t<n.clipValueMin?n.clipValueMin:t}),MEe={kernelName:Ey,backendName:"cpu",kernelFunc:LEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zEe=t=>{const{x:e}=t.inputs,n=t.backend,s=new Float32Array(le(e.shape)),r=n.data.get(e.dataId),i=r.complexTensorInfos.real,o=r.complexTensorInfos.imag,a=n.data.get(i.dataId).values,l=n.data.get(o.dataId).values;for(let c=0;c<a.length;c++){const u=a[c],d=l[c];s[c]=Math.hypot(u,d)}return n.makeOutput(s,e.shape,"float32")},VEe={kernelName:A1,backendName:"cpu",kernelFunc:zEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zf(t){const{inputs:e,backend:n}=t,{input:s}=e,r=n.data.get(s.dataId).complexTensorInfos.imag,i=n.data.get(r.dataId).values;return n.makeTensorInfo(r.shape,r.dtype,i)}const jEe={kernelName:B$,backendName:"cpu",kernelFunc:zf};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vf(t){const{inputs:e,backend:n,attrs:s}=t,{axis:r}=s,i=bt(r,e[0].shape)[0],o=e.map(m=>m.shape);_R(o,i);let a=Sa(e.map(m=>m.shape),i);if(le(a)===0)return n.makeTensorInfo(a,e[0].dtype,[]);const l=e.filter(m=>le(m.shape)>0);if(l.length===1)return Ra({inputs:{x:l[0]},backend:n});if(l[0].dtype==="complex64"){const m=l.map(b=>Id({inputs:{input:b},backend:n})),g=l.map(b=>zf({inputs:{input:b},backend:n})),y=Vf({inputs:m,backend:n,attrs:{axis:i}}),x=Vf({inputs:g,backend:n,attrs:{axis:i}}),v=Wr({inputs:{real:y,imag:x},backend:n});return m.forEach(b=>n.disposeIntermediateTensorInfo(b)),g.forEach(b=>n.disposeIntermediateTensorInfo(b)),n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(x),v}const c=l.map(m=>{const y=[-1,le(m.shape.slice(i))];return nn({inputs:{x:m},backend:n,attrs:{shape:y}})}),u=c.map(m=>({vals:n.data.get(m.dataId).values,shape:m.shape}));a=Sa(c.map(m=>m.shape),1);const d=c[0].shape[0]===1,h=L9(u,a,e[0].dtype,d),f=Sa(l.map(m=>m.shape),i),p=n.makeTensorInfo(f,e[0].dtype,h);return c.forEach(m=>n.disposeIntermediateTensorInfo(m)),p}const BEe={kernelName:R1,backendName:"cpu",kernelFunc:Vf};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $X(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:i}=e,{strides:o,pad:a,dataFormat:l,dilations:c,dimRoundingMode:u}=s;Ve([r,i],"conv2d");const d=Sl(l),h=Ts(r.shape,i.shape,o,c,a,u,!1,d),f=h.filterHeight,p=h.filterWidth,m=h.dilationHeight,g=h.dilationWidth,y=h.padInfo.left,x=h.padInfo.top,v=h.dataFormat==="channelsLast",b=new ks(h.outShape,r.dtype),k=Ye(r.shape),C=Ye(i.shape),N=k[0],I=v?k[1]:k[2],$=v?k[2]:1,A=v?1:k[1],P=b.strides[0],F=v?b.strides[1]:b.strides[2],V=v?b.strides[2]:1,z=v?1:b.strides[1],B=n.data.get(r.dataId).values,W=n.data.get(i.dataId).values,q=b.values;for(let M=0;M<h.batchSize;++M){const G=M*N,ne=M*P;for(let ie=0;ie<h.outHeight;++ie){const de=ne+ie*F,he=ie*h.strideHeight-x;for(let pe=0;pe<f;++pe){const me=he+pe*m;if(me<0||me>=h.inHeight)continue;const ye=pe*C[0],Ce=G+me*I;for(let Le=0;Le<h.outWidth;++Le){const Re=de+Le*V,Ze=Le*h.strideWidth-y;for(let tt=0;tt<p;++tt){const mt=Ze+tt*g;if(mt<0||mt>=h.inWidth)continue;const Xe=ye+tt*C[1],Me=Ce+mt*$;let wt=Xe;for(let it=0;it<h.inChannels;++it){const At=B[Me+it*A];for(let Vt=0;Vt<h.outChannels;++Vt)q[Re+Vt*z]+=At*W[wt+Vt];wt+=h.outChannels}}}}}}return n.makeTensorInfo(b.shape,b.dtype,q)}const WEe={kernelName:D1,backendName:"cpu",kernelFunc:$X};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UEe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,dy:i}=e,{strides:o,pad:a,dataFormat:l,dimRoundingMode:c,filterShape:u}=s;Ve([r,i],"conv2dBackpropFilter");const d=Sl(l),h=Ts(r.shape,u,o,1,a,c,!1,d),{strideHeight:f,strideWidth:p,filterHeight:m,filterWidth:g}=h,y=h.dataFormat==="channelsLast",x=new ks(h.filterShape,"float32"),v=h.padInfo.left,b=h.padInfo.top,k=n.data.get(r.dataId).values,C=n.data.get(i.dataId).values,N=new ks(r.shape,r.dtype,k),I=new ks(i.shape,i.dtype,C);for(let $=0;$<m;++$){const A=Math.max(0,Math.ceil((b-$)/f)),P=Math.min(h.outHeight,(h.inHeight+b-$)/f);for(let F=0;F<g;++F){const V=Math.max(0,Math.ceil((v-F)/p)),z=Math.min(h.outWidth,(h.inWidth+v-F)/p);for(let B=0;B<h.inChannels;++B)for(let W=0;W<h.outChannels;++W){let q=0;for(let M=0;M<h.batchSize;++M)for(let G=A;G<P;++G){const ne=$+G*f-b;for(let ie=V;ie<z;++ie){const de=F+ie*p-v;y?q+=N.get(M,ne,de,B)*I.get(M,G,ie,W):q+=N.get(M,B,ne,de)*I.get(M,W,G,ie)}}x.set(q,$,F,B,W)}}}return n.makeTensorInfo(x.shape,x.dtype,x.values)}const HEe={kernelName:T$,backendName:"cpu",kernelFunc:UEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GEe(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,filter:i}=e,{inputShape:o,strides:a,pad:l,dataFormat:c,dimRoundingMode:u}=s;Ve([r,i],"conv2dBackpropInput");const d=Ye(i.shape),h=Ye(r.shape);let f=Sl(c);const p=Ts(o,i.shape,a,1,l,u,!1,f),m=new ks(p.inShape,"float32"),g=m.values,y=n.data.get(r.dataId).values,x=n.data.get(i.dataId).values,[v,b,k]=d,{batchSize:C,filterHeight:N,filterWidth:I,inChannels:$,inHeight:A,inWidth:P,outChannels:F,outHeight:V,outWidth:z,strideHeight:B,strideWidth:W}=p;f=p.dataFormat;const q=N-1-p.padInfo.top,M=I-1-p.padInfo.left,G=f==="channelsLast",ne=m.strides[0],ie=G?m.strides[1]:m.strides[2],de=G?m.strides[2]:1,he=G?1:m.strides[1],pe=h[0],me=G?h[1]:h[2],ye=G?h[2]:1,Ce=G?1:h[1];for(let Le=0;Le<C;++Le)for(let Re=0;Re<$;++Re)for(let Ze=0;Ze<A;++Ze){const tt=Ze-q,mt=Math.max(0,Math.ceil(tt/B)),Xe=Math.min(V,(N+tt)/B);for(let Me=0;Me<P;++Me){const wt=Me-M,it=Math.max(0,Math.ceil(wt/W)),At=Math.min(z,(I+wt)/W);let Vt=0;for(let K=mt;K<Xe;++K){const re=K*B-tt;for(let ce=it;ce<At;++ce){const ke=ce*W-wt,xe=pe*Le+me*K+ye*ce,ve=v*(N-1-re)+b*(I-1-ke)+k*Re;for(let Oe=0;Oe<F;++Oe){const ut=y[xe+Ce*Oe],St=x[ve+Oe];Vt+=ut*St}}}const _n=ne*Le+ie*Ze+de*Me+he*Re;g[_n]=Vt}}return n.makeTensorInfo(m.shape,m.dtype,m.values)}const KEe={kernelName:O1,backendName:"cpu",kernelFunc:GEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qEe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:i}=e,{strides:o,pad:a,dilations:l}=s;Ve([r,i],"conv3d");const c=ru(r.shape,i.shape,o,l,a),{filterDepth:u,filterHeight:d,filterWidth:h,dilationDepth:f,dilationHeight:p,dilationWidth:m,padInfo:g}=c,y=g.front,x=g.left,v=g.top,b=new ks(c.outShape,r.dtype),k=n.data.get(r.dataId).values,C=n.data.get(i.dataId).values,N=b.values,I=Ye(r.shape),$=Ye(i.shape);for(let A=0;A<c.batchSize;++A){const P=A*I[0],F=A*b.strides[0];for(let V=0;V<c.outDepth;++V){const z=F+V*b.strides[1],B=V*c.strideDepth-y;for(let W=0;W<u;++W){const q=B+W*f;if(q<0||q>=c.inDepth)continue;const M=W*$[0],G=P+q*I[1];for(let ne=0;ne<c.outHeight;++ne){const ie=z+ne*b.strides[2],de=ne*c.strideHeight-v;for(let he=0;he<d;++he){const pe=de+he*p;if(pe<0||pe>=c.inHeight)continue;const me=M+he*$[1],ye=G+pe*I[2];for(let Ce=0;Ce<c.outWidth;++Ce){const Le=ie+Ce*c.outChannels,Re=Ce*c.strideWidth-x;for(let Ze=0;Ze<h;++Ze){const tt=Re+Ze*m;if(tt<0||tt>=c.inWidth)continue;const mt=me+Ze*$[2],Xe=ye+tt*c.inChannels;let Me=mt;for(let wt=0;wt<c.inChannels;++wt){const it=k[Xe+wt];for(let At=0;At<c.outChannels;++At)N[Le+At]+=it*C[Me+At];Me+=c.outChannels}}}}}}}}return n.makeTensorInfo(b.shape,b.dtype,b.values)}const XEe={kernelName:P1,backendName:"cpu",kernelFunc:qEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YEe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,dy:i}=e,{strides:o,pad:a,filterShape:l}=s;Ve([r,i],"conv3dBackpropFilterV2");const c=Ye(r.shape),u=Ye(i.shape),d=ru(r.shape,l,o,1,a),h=d.strideDepth,f=d.strideHeight,p=d.strideWidth,m=d.filterDepth,g=d.filterHeight,y=d.filterWidth,x=new ks(d.filterShape,"float32"),v=x.values,[b,k,C,N]=x.strides,I=n.data.get(i.dataId).values,[$,A,P,F]=u,V=n.data.get(r.dataId).values,[z,B,W,q]=c,M=d.padInfo.front,G=d.padInfo.left,ne=d.padInfo.top;for(let ie=0;ie<m;++ie){const de=Math.max(0,Math.ceil((M-ie)/h)),he=Math.min(d.outDepth,(d.inDepth+M-ie)/h),pe=ie*b;for(let me=0;me<g;++me){const ye=Math.max(0,Math.ceil((ne-me)/f)),Ce=Math.min(d.outHeight,(d.inHeight+ne-me)/f),Le=me*k+pe;for(let Re=0;Re<y;++Re){const Ze=Math.max(0,Math.ceil((G-Re)/p)),tt=Math.min(d.outWidth,(d.inWidth+G-Re)/p),mt=Re*C+Le;for(let Xe=0;Xe<d.inChannels;++Xe){const Me=Xe*N+mt;for(let wt=0;wt<d.outChannels;++wt){let it=0;for(let At=0;At<d.batchSize;++At){const Vt=At*z,_n=At*$;for(let K=de;K<he;++K){const ce=(ie+K*h-M)*B+Vt,ke=K*A+_n;for(let xe=ye;xe<Ce;++xe){const Oe=(me+xe*f-ne)*W+ce,ut=xe*P+ke;for(let St=Ze;St<tt;++St){const ri=(Re+St*p-G)*q+Oe,_s=St*F+ut;it+=V[ri+Xe]*I[_s+wt]}}}}v[Me+wt]=it}}}}}return n.makeTensorInfo(x.shape,x.dtype,x.values)}const ZEe={kernelName:N$,backendName:"cpu",kernelFunc:YEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QEe(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,filter:i}=e,{pad:o,strides:a,inputShape:l}=s;Ve([r],"conv3dBackpropInputV2");const c=Ye(r.shape),u=Ye(i.shape),d=ru(l,i.shape,a,1,o),h=new ks(d.inShape,"float32"),f=h.values,[p,m,g,y]=h.strides,x=n.data.get(r.dataId).values,[v,b,k,C]=c,N=n.data.get(i.dataId).values,[I,$,A,P]=u,{batchSize:F,filterDepth:V,filterHeight:z,filterWidth:B,inChannels:W,inDepth:q,inHeight:M,inWidth:G,outChannels:ne,outDepth:ie,outHeight:de,outWidth:he,strideDepth:pe,strideHeight:me,strideWidth:ye}=d,Ce=V-1-d.padInfo.front,Le=z-1-d.padInfo.top,Re=B-1-d.padInfo.left;for(let Ze=0;Ze<F;++Ze)for(let tt=0;tt<W;++tt)for(let mt=0;mt<q;++mt){const Xe=mt-Ce,Me=Math.max(0,Math.ceil(Xe/pe)),wt=Math.min(ie,(V+Xe)/pe);for(let it=0;it<M;++it){const At=it-Le,Vt=Math.max(0,Math.ceil(At/me)),_n=Math.min(de,(z+At)/me);for(let K=0;K<G;++K){const re=K-Re,ce=Math.max(0,Math.ceil(re/ye)),ke=Math.min(he,(B+re)/ye);let xe=0;for(let ve=Me;ve<wt;++ve){const Oe=ve*pe-Xe;for(let ut=Vt;ut<_n;++ut){const St=ut*me-At;for(let hn=ce;hn<ke;++hn){const ri=hn*ye-re,_s=v*Ze+b*ve+k*ut+C*hn,Tl=I*(V-1-Oe)+$*(z-1-St)+A*(B-1-ri)+P*tt;for(let ms=0;ms<ne;++ms){const Ai=x[_s+ms],Nl=N[Tl+ms];xe+=Ai*Nl}}}}f[p*Ze+m*mt+g*it+y*K+tt]=xe}}}return n.makeTensorInfo(h.shape,h.dtype,h.values)}const JEe={kernelName:I$,backendName:"cpu",kernelFunc:QEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const e$e=Ht($y,t=>Math.cos(t)),t$e={kernelName:$y,backendName:"cpu",kernelFunc:e$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const n$e=Ht(Ay,t=>Math.cosh(t)),s$e={kernelName:Ay,backendName:"cpu",kernelFunc:n$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r$e(t){const{inputs:e,backend:n,attrs:s}=t,{image:r,boxes:i,boxInd:o}=e,{cropSize:a,method:l,extrapolationValue:c}=s,[u,d,h,f]=r.shape,p=i.shape[0],[m,g]=a,y=gt([p,m,g,f],"float32"),x=n.data.get(i.dataId).values,v=n.data.get(o.dataId).values,b=n.data.get(r.dataId).values,k=Ye(r.shape),C=Ye(y.shape);for(let N=0;N<p;N++){const I=N*4,$=x[I],A=x[I+1],P=x[I+2],F=x[I+3],V=v[N];if(V>=u)continue;const z=m>1?(P-$)*(d-1)/(m-1):0,B=g>1?(F-A)*(h-1)/(g-1):0;for(let W=0;W<m;W++){const q=m>1?$*(d-1)+W*z:.5*($+P)*(d-1);if(q<0||q>d-1){for(let M=0;M<g;M++)for(let G=0;G<f;G++){const ne=G+M*C[2]+W*C[1]+N*C[0];y.values[ne]=c}continue}if(l==="bilinear"){const M=Math.floor(q),G=Math.ceil(q),ne=q-M;for(let ie=0;ie<g;ie++){const de=g>1?A*(h-1)+ie*B:.5*(A+F)*(h-1);if(de<0||de>h-1){for(let ye=0;ye<f;ye++){const Ce=ye+ie*C[2]+W*C[1]+N*C[0];y.values[Ce]=c}continue}const he=Math.floor(de),pe=Math.ceil(de),me=de-he;for(let ye=0;ye<f;ye++){let Ce=ye+he*k[2]+M*k[1]+V*k[0];const Le=b[Ce];Ce=ye+pe*k[2]+M*k[1]+V*k[0];const Re=b[Ce];Ce=ye+he*k[2]+G*k[1]+V*k[0];const Ze=b[Ce];Ce=ye+pe*k[2]+G*k[1]+V*k[0];const tt=b[Ce],mt=Le+(Re-Le)*me,Xe=Ze+(tt-Ze)*me;Ce=ye+ie*C[2]+W*C[1]+N*C[0],y.values[Ce]=mt+(Xe-mt)*ne}}}else for(let M=0;M<g;++M){const G=g>1?A*(h-1)+M*B:.5*(A+F)*(h-1);if(G<0||G>h-1){for(let de=0;de<f;de++){const he=de+M*C[2]+W*C[1]+N*C[0];y.values[he]=c}continue}const ne=Math.round(G),ie=Math.round(q);for(let de=0;de<f;de++){const he=de+ne*k[2]+ie*k[1]+V*k[0],pe=de+M*C[2]+W*C[1]+N*C[0];y.values[pe]=b[he]}}}}return n.makeTensorInfo(y.shape,y.dtype,y.values)}const i$e={kernelName:E$,backendName:"cpu",kernelFunc:r$e};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o$e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,exclusive:o,reverse:a}=s;Ve(r,"cumprod");const l=In([i],r.shape.length);let c=r;l!=null&&(c=_r({inputs:{x:r},backend:n,attrs:{perm:l}}));const u=Gn(1,r.shape.length)[0];if(u!==c.shape.length-1)throw new Error(`backend.cumprod in CPU expects an inner-most axis=${c.shape.length-1} but got axis=${u}`);const d=Zr(c.dtype,"int32"),h=g$(le(c.shape),d),f=n.data.get(c.dataId).values,p=c.shape[c.shape.length-1],m=a?(y,x)=>y+p-x-1:(y,x)=>y+x;for(let y=0;y<f.length;y+=p)for(let x=0;x<p;x++){const v=m(y,x);if(x===0)h[v]=o?1:f[v];else{const b=m(y,x-1);h[v]=o?f[b]*h[b]:f[v]*h[b]}}const g=n.makeTensorInfo(c.shape,d,h);if(l!=null){const y=iu(l),x=_r({inputs:{x:g},backend:n,attrs:{perm:y}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(c),x}return g}const a$e={kernelName:_$,backendName:"cpu",kernelFunc:o$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l$e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,exclusive:o,reverse:a}=s;Ve(r,"cumsum");const l=In([i],r.shape.length);let c=r;l!=null&&(c=_r({inputs:{x:r},backend:n,attrs:{perm:l}}));const u=Gn(1,r.shape.length)[0];if(u!==c.shape.length-1)throw new Error(`backend.cumsum in CPU expects an inner-most axis=${c.shape.length-1} but got axis=${u}`);const d=Zr(c.dtype,"int32"),h=Xs(le(c.shape),d),f=n.data.get(c.dataId).values,p=c.shape[c.shape.length-1],m=a?(y,x)=>y+p-x-1:(y,x)=>y+x;for(let y=0;y<f.length;y+=p)for(let x=0;x<p;x++){const v=m(y,x);if(x===0)h[v]=o?0:f[v];else{const b=m(y,x-1);h[v]=o?f[b]+h[b]:f[v]+h[b]}}const g=n.makeTensorInfo(c.shape,d,h);if(l!=null){const y=iu(l),x=_r({inputs:{x:g},backend:n,attrs:{perm:y}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(c),x}return g}const c$e={kernelName:F1,backendName:"cpu",kernelFunc:l$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u$e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,weights:i}=e,{size:o,binaryOutput:a}=s;if(r.shape.length===1){const l=n.data.get(r.dataId).values,c=n.data.get(i.dataId).values,u=vD(l,c,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,u)}else if(r.shape.length===2){const l=n.bufferSync(r),c=n.bufferSync(i),u=P9(l,c,o,a);return n.makeTensorInfo(u.shape,i.dtype,u.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${r.shape.length}.`)}const d$e={kernelName:$$,backendName:"cpu",kernelFunc:u$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h$e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{blockSize:i,dataFormat:o}=s;O(o==="NHWC",()=>`Only NHWC dataFormat supported on CPU for depthToSpace. Got ${o}`);const a=r.shape[0],l=r.shape[1],c=r.shape[2],u=r.shape[3],d=l*i,h=c*i,f=u/(i*i),p=n.data.get(r.dataId).values,m=new Float32Array(a*d*h*f);let g=0;for(let y=0;y<a;++y)for(let x=0;x<d;++x){const v=Math.floor(x/i),b=x%i;for(let k=0;k<h;++k){const C=Math.floor(k/i),N=k%i,I=(b*i+N)*f;for(let $=0;$<f;++$){const P=$+I+u*(C+c*(v+l*y));m[g++]=p[P]}}}return n.makeTensorInfo([a,d,h,f],r.dtype,m)}const f$e={kernelName:A$,backendName:"cpu",kernelFunc:h$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AX(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:i}=e,{strides:o,pad:a,dilations:l,dimRoundingMode:c}=s;Ve([r,i],"depthwiseConv2DNative");const u=Ye(r.shape),d=Ye(i.shape);let h=l;h==null&&(h=[1,1]),O(Ms(o,h),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${o} and dilations '${h}'`);const f=Ts(r.shape,i.shape,o,h,a,c,!0),{filterHeight:p,filterWidth:m,dilationHeight:g,dilationWidth:y,padInfo:x}=f,v=x.left,b=x.top,k=f.outChannels/f.inChannels,C=new ks(f.outShape,r.dtype),N=n.data.get(r.dataId).values,I=n.data.get(i.dataId).values,$=C.values;for(let A=0;A<f.batchSize;++A){const P=A*u[0],F=A*C.strides[0];for(let V=0;V<f.outHeight;++V){const z=F+V*C.strides[1],B=V*f.strideHeight-b;for(let W=0;W<p;++W){const q=B+W*g;if(q<0||q>=f.inHeight)continue;const M=W*d[0],G=P+q*u[1];for(let ne=0;ne<f.outWidth;++ne){const ie=z+ne*C.strides[2],de=ne*f.strideWidth-v;for(let he=0;he<m;++he){const pe=de+he*y;if(pe<0||pe>=f.inWidth)continue;const me=M+he*d[1],ye=G+pe*f.inChannels;let Ce=ie,Le=me;for(let Re=0;Re<f.inChannels;++Re){const Ze=N[ye+Re];for(let tt=0;tt<k;++tt)$[Ce+tt]+=Ze*I[Le+tt];Ce+=k,Le+=k}}}}}}return n.makeTensorInfo(C.shape,C.dtype,C.values)}const p$e={kernelName:L1,backendName:"cpu",kernelFunc:AX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m$e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,dy:i}=e,{strides:o,dilations:a,pad:l,dimRoundingMode:c,filterShape:u}=s;Ve([r,i],"depthwiseConv2dNativeBackpropFilter");const d=Ts(r.shape,u,o,a,l,c,!0),{strideHeight:h,strideWidth:f,filterHeight:p,filterWidth:m}=d,g=new ks(d.filterShape,"float32"),y=d.padInfo.left,x=d.padInfo.top,v=d.outChannels/d.inChannels,b=n.data.get(r.dataId).values,k=new ks(r.shape,r.dtype,b),C=n.data.get(i.dataId).values,N=new ks(i.shape,i.dtype,C);for(let I=0;I<p;++I){const $=Math.max(0,Math.ceil((x-I)/h)),A=Math.min(d.outHeight,(d.inHeight+x-I)/h);for(let P=0;P<m;++P){const F=Math.max(0,Math.ceil((y-P)/f)),V=Math.min(d.outWidth,(d.inWidth+y-P)/f);for(let z=0;z<d.outChannels;++z){const B=Math.trunc(z/v),W=z%v;let q=0;for(let M=0;M<d.batchSize;++M)for(let G=$;G<A;++G){const ne=I+G*h-x;for(let ie=F;ie<V;++ie){const de=P+ie*f-y;q+=k.get(M,ne,de,B)*N.get(M,G,ie,z)}}g.set(q,I,P,B,W)}}}return n.makeTensorInfo(g.shape,g.dtype,g.values)}const g$e={kernelName:R$,backendName:"cpu",kernelFunc:m$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y$e(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,filter:i}=e,{strides:o,dilations:a,pad:l,dimRoundingMode:c,inputShape:u}=s;Ve([r,i],"depthwiseConv2DNativeBackpropInput");const d=Ye(r.shape),h=Ye(i.shape),f=Ts(u,i.shape,o,a,l,c,!0),p=new ks(f.inShape,"float32"),m=p.values,[g,y,x]=p.strides,v=n.data.get(r.dataId).values,[b,k,C]=d,N=n.data.get(i.dataId).values,[I,$,A]=h,{batchSize:P,filterHeight:F,filterWidth:V,inChannels:z,inHeight:B,inWidth:W,outChannels:q,outHeight:M,outWidth:G,strideHeight:ne,strideWidth:ie}=f,de=F-1-f.padInfo.top,he=V-1-f.padInfo.left,pe=q/z;for(let me=0;me<P;++me)for(let ye=0;ye<z;++ye)for(let Ce=0;Ce<B;++Ce){const Le=Ce-de,Re=Math.max(0,Math.ceil(Le/ne)),Ze=Math.min(M,(F+Le)/ne);for(let tt=0;tt<W;++tt){const mt=tt-he,Xe=Math.max(0,Math.ceil(mt/ie)),Me=Math.min(G,(V+mt)/ie);let wt=0;for(let it=Re;it<Ze;++it){const At=it*ne-Le;for(let Vt=Xe;Vt<Me;++Vt){const _n=Vt*ie-mt,K=b*me+k*it+C*Vt,re=I*(F-1-At)+$*(V-1-_n)+A*ye;for(let ce=0;ce<pe;++ce){const ke=ye*pe+ce,xe=v[K+ke],ve=N[re+ce];wt+=xe*ve}}}m[g*me+y*Ce+x*tt+ye]=wt}}return n.makeTensorInfo(p.shape,p.dtype,p.values)}const x$e={kernelName:D$,backendName:"cpu",kernelFunc:y$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v$e(t){const{inputs:e,backend:n}=t,{x:s}=e,r=le(s.shape),i=n.data.get(s.dataId).values,o=gt([r,r],s.dtype),a=o.values;for(let c=0;c<i.length;c++)a[c*r+c]=i[c];const l=[...s.shape,...s.shape];return n.makeTensorInfo(l,o.dtype,o.values)}const b$e={kernelName:O$,backendName:"cpu",kernelFunc:v$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const w$e={kernelName:M1,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:s,filter:r}=t,{strides:i,pad:o,dilations:a}=n,l=e,c=l.data.get(s.dataId).values,u=s.shape.length,d=l.data.get(r.dataId).values,h=r.shape.length,{batchSize:f,inHeight:p,inWidth:m,inChannels:g,outHeight:y,outWidth:x,padInfo:v,strideHeight:b,strideWidth:k,filterHeight:C,filterWidth:N,dilationHeight:I,dilationWidth:$,outShape:A}=y0(s.shape,r.shape,i,o,"NHWC",a),P=le(A),F=A.length,V=ws(s.dtype,P);for(let B=0;B<f;++B)for(let W=0;W<y;++W){const q=W*b-v.top;for(let M=0;M<x;++M){const G=M*k-v.left;for(let ne=0;ne<g;++ne){let ie=Number.MIN_SAFE_INTEGER;for(let he=0;he<C;++he){const pe=q+he*I;if(pe>=0&&pe<p)for(let me=0;me<N;++me){const ye=G+me*$;if(ye>=0&&ye<m){const Ce=ba([B,pe,ye,ne],u,Ye(s.shape)),Le=ba([he,me,ne],h,Ye(r.shape)),Re=c[Ce]+d[Le];Re>ie&&(ie=Re)}}}const de=ba([B,W,M,ne],F,Ye(A));V[de]=ie}}}return{dataId:l.write(Ld(V,s.dtype),A,s.dtype),shape:A,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const S$e={kernelName:A2,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:s,filter:r,dy:i}=t,{strides:o,pad:a,dilations:l}=n,c=e,u=so(s.shape,c.data.get(s.dataId).values),d=so(r.shape,c.data.get(r.dataId).values),{batchSize:h,inHeight:f,inWidth:p,inChannels:m,outHeight:g,outWidth:y,padInfo:x,strideHeight:v,strideWidth:b,filterHeight:k,filterWidth:C,dilationHeight:N,dilationWidth:I,outShape:$}=y0(s.shape,r.shape,o,a,"NHWC",l);O(i.rank===$.length,()=>`Error in ${A2}, dy must have the same rank as output ${$.length}, but got ${i.rank}`);const A=so($,c.data.get(i.dataId).values),P=A6(r.shape,r.dtype);for(let V=0;V<h;++V)for(let z=0;z<g;++z){const B=z*v-x.top;for(let W=0;W<y;++W){const q=W*b-x.left;for(let M=0;M<m;++M){let G=Number.MIN_SAFE_INTEGER,ne=0,ie=0;for(let de=0;de<k;++de){const he=B+de*N;if(he>=0&&he<f)for(let pe=0;pe<C;++pe){const me=q+pe*I;if(me>=0&&me<p){const ye=u[V][he][me][M]+d[de][pe][M];ye>G&&(G=ye,ne=de,ie=pe)}}}P[ne][ie][M]+=A[V][z][W][M]}}}return{dataId:c.write(Ld(P,s.dtype),r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const k$e={kernelName:$2,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:s,filter:r,dy:i}=t,{strides:o,pad:a,dilations:l}=n,c=e,u=so(s.shape,c.data.get(s.dataId).values),d=so(r.shape,c.data.get(r.dataId).values),{batchSize:h,inHeight:f,inWidth:p,inChannels:m,outHeight:g,outWidth:y,padInfo:x,strideHeight:v,strideWidth:b,filterHeight:k,filterWidth:C,dilationHeight:N,dilationWidth:I,outShape:$}=y0(s.shape,r.shape,o,a,"NHWC",l);O(i.rank===$.length,()=>`Error in ${$2}, dy must have the same rank as output ${$.length}, but got ${i.rank}`);const A=so($,c.data.get(i.dataId).values),P=A6(s.shape,s.dtype);for(let V=0;V<h;++V)for(let z=0;z<g;++z){const B=z*v-x.top;for(let W=0;W<y;++W){const q=W*b-x.left;for(let M=0;M<m;++M){let G=Number.MIN_SAFE_INTEGER,ne=B<0?0:B,ie=q<0?0:q;for(let de=0;de<k;++de){const he=B+de*N;if(he>=0&&he<f)for(let pe=0;pe<C;++pe){const me=q+pe*I;if(me>=0&&me<p){const ye=u[V][he][me][M]+d[de][pe][M];ye>G&&(G=ye,ne=he,ie=me)}}}P[V][ne][ie][M]+=A[V][z][W][M]}}}return{dataId:c.write(Ld(P,s.dtype),s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F0(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,keepDims:o}=s;Ve(r,"sum");let a;r.dtype==="bool"?a=Kc({inputs:{x:r},backend:n,attrs:{dtype:"int32"}}):a=Ra({inputs:{x:r},backend:n});const l=a.shape.length,c=bt(i,a.shape),u=In(c,l);let d=c,h=a;u!=null&&(h=_r({inputs:{x:a},backend:n,attrs:{perm:u}}),d=Gn(d.length,l)),zs("sum",d,h.shape.length);const[f,p]=Ns(h.shape,d),m=Zr(h.dtype,"int32");let g=yw(n,f,m);const y=le(p),x=n.data.get(g.dataId).values,v=n.data.get(h.dataId).values;for(let b=0;b<x.length;++b){const k=b*y;let C=0;for(let N=0;N<y;++N)C+=v[k+N];x[b]=C}if(o){const b=Hn(g.shape,c),k=g;g=nn({inputs:{x:g},backend:n,attrs:{shape:b}}),n.disposeIntermediateTensorInfo(k)}return n.disposeIntermediateTensorInfo(a),u!=null&&n.disposeIntermediateTensorInfo(h),g}const C$e={kernelName:yS,backendName:"cpu",kernelFunc:F0};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T$e(t){const{inputs:e,backend:n,attrs:s}=t,{equation:r}=s,i=e,{allDims:o,summedDims:a,idDims:l}=VR(r,i.length);BR(o.length,l,i);const{path:c,steps:u}=WR(a,l),d=u.length;let h=null,f=o.length;const p=[];for(let m=0;m<d;++m){for(const g of u[m]){const{permutationIndices:y,expandDims:x}=jR(f,l[g]);let v;UR(y)?v=i[g]:(v=_r({inputs:{x:i[g]},backend:n,attrs:{perm:y}}),p.push(v));const b=v.shape.slice();for(let k=0;k<x.length;++k)b.splice(x[k],0,1);Et(v.shape,b)||(v=nn({inputs:{x:v},backend:n,attrs:{shape:b}}),p.push(v)),h===null?h=v:(h=uk({inputs:{a:v,b:h},backend:n}),p.push(h))}m<d-1&&(c[m]>=0&&(h=F0({inputs:{x:h},backend:n,attrs:{axis:c[m]-(o.length-f),keepDims:!1}}),p.push(h)),f--)}for(const m of p)m!==h&&n.disposeIntermediateTensorInfo(m);return h}const N$e={kernelName:P$,backendName:"cpu",kernelFunc:T$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I$e(t){const{inputs:e,backend:n}=t,{dy:s,y:r}=e;Ve([s,r],"eluGrad");const i=new Float32Array(le(r.shape)),o=n.data.get(r.dataId).values,a=n.data.get(s.dataId).values;for(let l=0;l<o.length;++l){const c=o[l];c>=1?i[l]=a[l]:i[l]=a[l]*(c+1)}return n.makeTensorInfo(r.shape,"float32",i)}const _$e={kernelName:F$,backendName:"cpu",kernelFunc:I$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const E$e=DR,$$e=OR,A$e=PR,R$e=FR,D$e=LR,O$e=MR,P$e=Ht(Oy,t=>{const e=Math.sign(t),n=Math.abs(t),s=1/(1+E$e*n);return e*(1-((((O$e*s+D$e)*s+R$e)*s+A$e)*s+$$e)*s*Math.exp(-n*n))}),F$e={kernelName:Oy,backendName:"cpu",kernelFunc:P$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bw(t){const{inputs:e,backend:n,attrs:s}=t,{input:r}=e,{dim:i}=s,o=r.shape.length,a=r.shape.slice();let l=i;return i<0&&(O(-(o+1)<=i,()=>`Axis must be in the interval [${-(o+1)}, ${o}]`),l=o+i+1),a.splice(l,0,1),nn({inputs:{x:r},backend:n,attrs:{shape:a}})}const L$e={kernelName:V1,backendName:"cpu",kernelFunc:bw};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const M$e=rs((t,e)=>t/e),TD=Is(Ry,M$e),CI={kernelName:Ry,backendName:"cpu",kernelFunc:TD};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RX(t,e,n){const s=t.shape,r=s[0],i=s[1],o=n.data.get(t.dataId),a=o.complexTensorInfos.real,l=o.complexTensorInfos.imag,c=[r,i],u=le(c),d=Cs("float32",u),h=Cs("float32",u);for(let g=0;g<r;g++){const y=_d({inputs:{x:a},backend:n,attrs:{begin:[g,0],size:[1,i]}}),x=_d({inputs:{x:l},backend:n,attrs:{begin:[g,0],size:[1,i]}}),v=Wr({inputs:{real:y,imag:x},backend:n}),{real:b,imag:k}=z$e(v,e,n),C=xl(b,k);for(let N=0;N<i;N++){const I=zR(C,N);d[g*i+N]=I.real,h[g*i+N]=I.imag}n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(v)}const f=n.makeTensorInfo(c,"float32",d),p=n.makeTensorInfo(c,"float32",h),m=Wr({inputs:{real:f,imag:p},backend:n});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),m}function z$e(t,e,n){const s=le(t.shape),r=n.data.get(t.dataId),i=n.data.get(r.complexTensorInfos.real.dataId).values,o=n.data.get(r.complexTensorInfos.imag.dataId).values;if(V$e(s)){const a=TI(i,o,s,e,n),l=[t.shape[0],t.shape[1]];if(e){const c=n.makeTensorInfo(l,"float32",a.real),u=n.makeTensorInfo(l,"float32",a.imag),d=n.makeTensorInfo([],"float32",tu(s,"float32")),h=Ra({inputs:{x:d},backend:n}),f=CI.kernelFunc({inputs:{a:c,b:d},backend:n}),p=CI.kernelFunc({inputs:{a:u,b:h},backend:n}),m=n.data.get(f.dataId).values,g=n.data.get(p.dataId).values;return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),{real:m,imag:g}}return a}else{const a=xl(i,o),l=j$e(a,s,e);return B8(l)}}function V$e(t){return(t&t-1)===0}function TI(t,e,n,s,r){if(n===1)return{real:t,imag:e};const i=xl(t,e),o=n/2,a=W8(i),l=a.real,c=a.imag,u=[l.length],d=r.makeTensorInfo(u,"float32",l),h=r.makeTensorInfo(u,"float32",c),f=Wr({inputs:{real:d,imag:h},backend:r}),p=U8(i),m=p.real,g=p.imag,y=[m.length],x=r.makeTensorInfo(y,"float32",m),v=r.makeTensorInfo(y,"float32",g),b=Wr({inputs:{real:x,imag:v},backend:r}),k=TI(l,c,o,s,r),C=k.real,N=k.imag,I=[C.length],$=r.makeTensorInfo(I,"float32",C),A=r.makeTensorInfo(I,"float32",N),P=Wr({inputs:{real:$,imag:A},backend:r}),F=TI(m,g,o,s,r),V=F.real,z=F.imag,B=[V.length],W=r.makeTensorInfo(B,"float32",V),q=r.makeTensorInfo(B,"float32",z),M=Wr({inputs:{real:W,imag:q},backend:r}),G=G8(n,s),ne=[G.real.length],ie=r.makeTensorInfo(ne,"float32",G.real),de=r.makeTensorInfo(ne,"float32",G.imag),he=Wr({inputs:{real:ie,imag:de},backend:r}),pe=uk({inputs:{a:he,b:M},backend:r}),me=Mf({inputs:{a:P,b:pe},backend:r}),ye=kD({inputs:{a:P,b:pe},backend:r}),Ce=Id({inputs:{input:me},backend:r}),Le=Id({inputs:{input:ye},backend:r}),Re=zf({inputs:{input:me},backend:r}),Ze=zf({inputs:{input:ye},backend:r}),tt=Vf({inputs:[Ce,Le],backend:r,attrs:{axis:0}}),mt=Vf({inputs:[Re,Ze],backend:r,attrs:{axis:0}}),Xe=r.data.get(tt.dataId).values,Me=r.data.get(mt.dataId).values;return r.disposeIntermediateTensorInfo(d),r.disposeIntermediateTensorInfo(h),r.disposeIntermediateTensorInfo(f),r.disposeIntermediateTensorInfo(x),r.disposeIntermediateTensorInfo(v),r.disposeIntermediateTensorInfo(b),r.disposeIntermediateTensorInfo($),r.disposeIntermediateTensorInfo(A),r.disposeIntermediateTensorInfo(P),r.disposeIntermediateTensorInfo(W),r.disposeIntermediateTensorInfo(q),r.disposeIntermediateTensorInfo(M),r.disposeIntermediateTensorInfo(ie),r.disposeIntermediateTensorInfo(de),r.disposeIntermediateTensorInfo(he),r.disposeIntermediateTensorInfo(pe),r.disposeIntermediateTensorInfo(me),r.disposeIntermediateTensorInfo(ye),r.disposeIntermediateTensorInfo(Ce),r.disposeIntermediateTensorInfo(Re),r.disposeIntermediateTensorInfo(Le),r.disposeIntermediateTensorInfo(Ze),r.disposeIntermediateTensorInfo(tt),r.disposeIntermediateTensorInfo(mt),{real:Xe,imag:Me}}function j$e(t,e,n){const s=new Float32Array(e*2);for(let r=0;r<e;r++){let i=0,o=0;for(let a=0;a<e;a++){const l=K8(r*a,e,n),c=zR(t,a);i+=c.real*l.real-c.imag*l.imag,o+=c.real*l.imag+c.imag*l.real}n&&(i/=e,o/=e),H8(s,i,o,r)}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B$e(t){const{inputs:e,backend:n}=t,{input:s}=e,r=le(s.shape),i=s.shape[s.shape.length-1],o=r/i,a=nn({inputs:{x:s},backend:n,attrs:{shape:[o,i]}}),l=RX(a,!1,n),c=nn({inputs:{x:l},backend:n,attrs:{shape:s.shape}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(l),c}const W$e={kernelName:L$,backendName:"cpu",kernelFunc:B$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ND(t){const{backend:e,attrs:n}=t,{shape:s,value:r,dtype:i}=n,o=i||vy(r),a=ws(o,le(s));return H$e(a,r,o),e.makeTensorInfo(s,o,a)}const U$e={kernelName:M$,backendName:"cpu",kernelFunc:ND};function H$e(t,e,n){t.fill(e)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const G$e={kernelName:z$,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:s}=t,r=n,i=Cs(s.dtype,le(s.shape)),[o,a,l,c]=s.shape,u=r.data.get(s.dataId).values;for(let h=0;h<o;h++){const f=h*l*a*c;for(let p=0;p<a;p++){const m=p*(l*c);for(let g=0;g<l;g++){const y=g*c;for(let x=0;x<c;x++){const v=Math.round(l-g-1),b=f+m+y+x;let k=u[b];if(v>=0&&v<l){const C=v*c,N=f+m+C+x;k=u[N]}i[b]=k}}}}return{dataId:r.write(i,s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const K$e=rs((t,e)=>Math.floor(t/e)),q$e=Is(My,K$e,null,"int32"),X$e={kernelName:My,backendName:"cpu",kernelFunc:q$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y$e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:i,bias:o,preluActivationWeights:a}=e,{strides:l,pad:c,dataFormat:u,dilations:d,dimRoundingMode:h,activation:f,leakyreluAlpha:p}=s;let m=$X({inputs:{x:r,filter:i},backend:n,attrs:{strides:l,pad:c,dataFormat:u,dilations:d,dimRoundingMode:h}});if(o){const g=m;if(u==="NCHW"&&o.shape.length===1&&o.shape[0]!==1){const y=nn({inputs:{x:o},backend:n,attrs:{shape:[o.shape[0],1,1]}});m=Mf({inputs:{a:m,b:y},backend:n}),n.disposeIntermediateTensorInfo(y)}else m=Mf({inputs:{a:m,b:o},backend:n});n.disposeIntermediateTensorInfo(g)}if(f){const g=m;if(u==="NCHW"&&f==="prelu"&&a.shape.length===1&&a.shape[0]!==1){const y=nn({inputs:{x:a},backend:n,attrs:{shape:[a.shape[0],1,1]}});m=vw(n,m,f,y,p),n.disposeIntermediateTensorInfo(y)}else m=vw(n,m,f,a,p);n.disposeIntermediateTensorInfo(g)}return m}const Z$e={kernelName:qb,backendName:"cpu",kernelFunc:Y$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q$e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:i,bias:o,preluActivationWeights:a}=e,{strides:l,pad:c,dataFormat:u,dilations:d,dimRoundingMode:h,activation:f,leakyreluAlpha:p}=s;let m=AX({inputs:{x:r,filter:i},backend:n,attrs:{strides:l,pad:c,dataFormat:u,dilations:d,dimRoundingMode:h}});if(o){const g=m;m=Mf({inputs:{a:m,b:o},backend:n}),n.disposeIntermediateTensorInfo(g)}if(f){const g=m;m=vw(n,m,f,a,p),n.disposeIntermediateTensorInfo(g)}return m}const J$e={kernelName:Xb,backendName:"cpu",kernelFunc:Q$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eAe(t){const{inputs:e,backend:n}=t,{params:s,indices:r}=e,i=le(s.shape),o=r.shape,a=o[o.length-1],[l,c,u,d]=_A(s,r);if(c===0)return n.makeTensorInfo(l,s.dtype,[]);const h=n.data.get(r.dataId).values,f=n.bufferSync(s),p=U9(h,f,s.dtype,c,a,u,d,s.shape,i);return n.makeTensorInfo(l,s.dtype,p.values)}const tAe={kernelName:V$,backendName:"cpu",kernelFunc:eAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nAe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,indices:i}=e,{axis:o,batchDims:a}=s;Ve([r,i],"gatherV2");const l=bt(o,r.shape)[0],c=n.data.get(i.dataId).values,u=r.shape[l];for(let b=0;b<c.length;++b){const k=c[b];O(k<=u-1&&k>=0,()=>`GatherV2: the index value ${k} is not in [0, ${u-1}]`)}let d=a;a==null&&(d=0);const h=le(i.shape),f=GR(r,i,l,d),p=nn({inputs:{x:r},backend:n,attrs:{shape:[f.batchSize,f.outerSize,f.dimSize,f.sliceSize]}}),m=nn({inputs:{x:i},backend:n,attrs:{shape:[f.batchSize,h/f.batchSize]}}),g=[f.batchSize,f.outerSize,h/f.batchSize,f.sliceSize],y=n.bufferSync(m),x=n.bufferSync(p),v=H9(x,y,g);return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),n.makeTensorInfo(f.outputShape,v.dtype,v.values)}const sAe={kernelName:B1,backendName:"cpu",kernelFunc:nAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rAe(t){const{inputs:e,backend:n}=t,{input:s}=e,r=le(s.shape),i=s.shape[s.shape.length-1],o=r/i,a=nn({inputs:{x:s},backend:n,attrs:{shape:[o,i]}}),l=RX(a,!0,n),c=nn({inputs:{x:l},backend:n,attrs:{shape:s.shape}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(l),c}const iAe={kernelName:j$,backendName:"cpu",kernelFunc:rAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oAe=Ht(jy,t=>Number.isFinite(t)?1:0,"bool"),aAe={kernelName:jy,backendName:"cpu",kernelFunc:oAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lAe=Ht(By,t=>Math.abs(t)===1/0?1:0,"bool"),cAe={kernelName:By,backendName:"cpu",kernelFunc:lAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uAe=Ht(Wy,t=>Number.isNaN(t)?1:0,"bool"),dAe={kernelName:Wy,backendName:"cpu",kernelFunc:uAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hAe(t){const{backend:e,attrs:n}=t,{start:s,stop:r,num:i}=n,o=Y9(s,r,i);return e.makeTensorInfo([o.length],"float32",o)}const fAe={kernelName:W$,backendName:"cpu",kernelFunc:hAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pAe=Ht(Hy,t=>Math.log1p(t)),mAe={kernelName:Hy,backendName:"cpu",kernelFunc:pAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gAe=rs((t,e)=>t&&e),yAe=Is(K1,gAe,null,"bool"),xAe={kernelName:K1,backendName:"cpu",kernelFunc:yAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vAe=Ht(q1,t=>t?0:1,"bool"),bAe={kernelName:q1,backendName:"cpu",kernelFunc:vAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wAe=rs((t,e)=>t||e),SAe=Is(X1,wAe,null,"bool"),kAe={kernelName:X1,backendName:"cpu",kernelFunc:SAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CAe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{depthRadius:i,bias:o,alpha:a,beta:l}=s;Ve(r,"LRN");const c=r.shape[3],u=c-1,d=n.data.get(r.dataId).values,h=le(r.shape),f=new Float32Array(h);function p(m){const g=m%c;let y=m-g+Math.max(0,g-i);const x=m-g+Math.min(g+i,u);let v=0;for(;y<=x;y++){const b=d[y];v+=b*b}return v}for(let m=0;m<h;m++){const g=p(m),y=d[m]*Math.pow(o+a*g,-l);f[m]=y}return n.makeTensorInfo(r.shape,r.dtype,f)}const TAe={kernelName:Y1,backendName:"cpu",kernelFunc:CAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NAe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,y:i,dy:o}=e,{depthRadius:a,bias:l,alpha:c,beta:u}=s;Ve(o,"LRNGrad");const d=le(o.shape),h=o.shape[3],f=n.data.get(o.dataId).values,p=n.data.get(r.dataId).values,m=n.data.get(i.dataId).values,g=new Float32Array(d),y=d;for(let x=0;x<y;x++){const v=x%h,b=x-v+Math.max(0,v-a),k=x-v+Math.min(h,v+a+1);let C=0;for(let N=b;N<k;N++)C+=Math.pow(p[N],2);C=c*C+l;for(let N=b;N<k;N++){let I=-2*c*u*p[N]*m[x]/C;x===N&&(I+=Math.pow(C,-u)),I*=f[x],g[N]+=I}}return n.makeTensorInfo(o.shape,r.dtype,g)}const IAe={kernelName:U$,backendName:"cpu",kernelFunc:NAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DX(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{reductionIndices:i,keepDims:o}=s,a=n;let l=r.shape;const c=l.length,u=bt(i,l);let d=u;const h=In(d,c);let f=a.data.get(r.dataId).values;if(h!=null){const b=new Array(c);for(let k=0;k<b.length;k++)b[k]=l[h[k]];f=wD(f,l,r.dtype,h,b),d=Gn(d.length,c),l=b}Ve(r,"max"),zs("max",d,c);const[p,m]=Ns(l,d),g=le(m),y=Q9(f,g,p,r.dtype),x=a.write(y,p,r.dtype);let v=p;return o&&(v=Hn(p,u)),{dataId:x,shape:v,dtype:r.dtype}}const _Ae={kernelName:Z1,backendName:"cpu",kernelFunc:DX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EAe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e;Ve(r,"maxPool");const{filterSize:i,strides:o,pad:a,dimRoundingMode:l}=s,c=1;O(Ms(o,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${c}'`);const u=uo(r.shape,i,o,c,a,l);let d;if(u.filterWidth===1&&u.filterHeight===1&&Et(u.inShape,u.outShape))d=Ra({inputs:{x:r},backend:n});else{const h=n.data.get(r.dataId).values,f=Ye(r.shape),p=CD(h,r.shape,r.dtype,f,u,"max");d=n.makeTensorInfo(u.outShape,r.dtype,p.values)}return d}const $Ae={kernelName:Q1,backendName:"cpu",kernelFunc:EAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AAe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{filterSize:i,strides:o,pad:a,dimRoundingMode:l,dataFormat:c}=s;Ve(r,"maxPool3d");const u=wl(r.shape,i,o,1,a,l,c),d=n.data.get(r.dataId).values,h=EX(d,r.shape,r.dtype,Ye(r.shape),u,"max");return n.makeTensorInfo(h.shape,"float32",h.values)}const RAe={kernelName:J1,backendName:"cpu",kernelFunc:AAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DAe(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:i}=e,{filterSize:o,strides:a,pad:l,dimRoundingMode:c}=s;Ve([r,i],"maxPool3DGrad");const u=wl(i.shape,o,a,1,l,c),d=n.bufferSync(i),h=bEe(d,u),f=u.strideDepth,p=u.strideHeight,m=u.strideWidth,g=u.dilationDepth,y=u.dilationHeight,x=u.dilationWidth,v=u.effectiveFilterDepth,b=u.effectiveFilterHeight,k=u.effectiveFilterWidth,C=v-1-u.padInfo.front,N=k-1-u.padInfo.left,I=b-1-u.padInfo.top,$=gt(i.shape,"float32"),A=n.bufferSync(r);for(let P=0;P<u.batchSize;++P)for(let F=0;F<u.inChannels;++F)for(let V=0;V<u.inDepth;++V)for(let z=0;z<u.inHeight;++z)for(let B=0;B<u.inWidth;++B){const W=V-C,q=z-I,M=B-N;let G=0;for(let ne=0;ne<v;ne+=g){const ie=(W+ne)/f;if(!(ie<0||ie>=u.outDepth||Math.floor(ie)!==ie))for(let de=0;de<b;de+=y){const he=(q+de)/p;if(!(he<0||he>=u.outHeight||Math.floor(he)!==he))for(let pe=0;pe<k;pe+=x){const me=(M+pe)/m;if(me<0||me>=u.outWidth||Math.floor(me)!==me)continue;const ye=v*b*k-1-h.get(P,ie,he,me,F),Ce=ne*b*k+de*k+pe,Le=ye===Ce?1:0;if(Le===0)continue;const Re=A.get(P,ie,he,me,F);G+=Re*Le}}}$.set(G,P,V,z,B,F)}return n.makeTensorInfo($.shape,$.dtype,$.values)}const OAe={kernelName:G$,backendName:"cpu",kernelFunc:DAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PAe(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:i,output:o}=e,a=i;Ve([i,o],"maxPoolGrad");const{filterSize:l,strides:c,pad:u,dimRoundingMode:d}=s,h=uo(a.shape,l,c,1,u,d),f=n.data.get(a.dataId).values,p=gt(h.outShape,a.dtype,_X(f,a.shape,a.dtype,h).values),m=h.strideHeight,g=h.strideWidth,y=h.dilationHeight,x=h.dilationWidth,v=h.effectiveFilterHeight,b=h.effectiveFilterWidth,k=b-1-h.padInfo.left,C=v-1-h.padInfo.top,N=gt(a.shape,"float32"),I=n.data.get(r.dataId).values,$=gt(r.shape,"float32",I);for(let A=0;A<h.batchSize;++A)for(let P=0;P<h.inChannels;++P)for(let F=0;F<h.inHeight;++F)for(let V=0;V<h.inWidth;++V){const z=F-C,B=V-k;let W=0;for(let q=0;q<v;q+=y){const M=(z+q)/m;if(!(M<0||M>=h.outHeight||Math.floor(M)!==M))for(let G=0;G<b;G+=x){const ne=(B+G)/g;if(ne<0||ne>=h.outWidth||Math.floor(ne)!==ne)continue;const ie=v*b-1-p.get(A,M,ne,P),de=q*b+G,he=ie===de?1:0;if(he===0)continue;const pe=$.get(A,M,ne,P);W+=pe*he}}N.set(W,A,F,V,P)}return n.makeTensorInfo(N.shape,N.dtype,N.values)}const FAe={kernelName:H$,backendName:"cpu",kernelFunc:PAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LAe(t,e,n,s,r){const i=Ye(e),o=CD(t,e,n,i,r,"max"),a=_X(t,e,n,r,!0,s);return[o.values,a.values]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MAe={kernelName:K$,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:s}=t,{filterSize:r,strides:i,pad:o,includeBatchInIndex:a}=e,l=n;Ve(s,"MaxPoolWithArgmax");const c=l.data.get(s.dataId).values,u=uo(s.shape,r,i,[1,1],o),[d,h]=LAe(c,s.shape,s.dtype,a,u),f=l.write(d,u.outShape,s.dtype),p=l.write(h,u.outShape,s.dtype);return[{dataId:f,shape:u.outShape,dtype:s.dtype},{dataId:p,shape:u.outShape,dtype:"int32"}]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zAe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,keepDims:o}=s,a=bt(i,r.shape),c=Ns(r.shape,a)[1],u=le(c),d=[],h=n.makeTensorInfo([],"float32",new Float32Array([u]));d.push(h);const f=Kc({inputs:{x:r},backend:n,attrs:{dtype:"float32"}});d.push(f);const p=TD({inputs:{a:f,b:h},backend:n});d.push(p);const m=F0({inputs:{x:p},backend:n,attrs:{axis:i,keepDims:o}});return d.forEach(g=>n.disposeIntermediateTensorInfo(g)),m}const VAe={kernelName:eS,backendName:"cpu",kernelFunc:zAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jAe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,keepDims:o}=s;Ve(r,"min");const a=bt(i,r.shape);let l=a;const c=In(l,r.shape.length);let u=r;c!=null&&(u=_r({inputs:{x:r},backend:n,attrs:{perm:c}}),l=Gn(l.length,r.shape.length)),zs("min",l,u.shape.length);const[d,h]=Ns(u.shape,l),f=le(h),p=Xs(le(d),u.dtype),m=n.data.get(u.dataId).values;for(let y=0;y<p.length;++y){const x=y*f;let v=m[x];for(let b=0;b<f;++b){const k=m[x+b];(Number.isNaN(k)||k<v)&&(v=k)}p[y]=v}c!=null&&n.disposeIntermediateTensorInfo(u);const g=n.makeTensorInfo(d,u.dtype,p);if(o){const y=Hn(d,a),x=nn({inputs:{x:g},backend:n,attrs:{shape:y}});return n.disposeIntermediateTensorInfo(g),x}return g}const BAe={kernelName:tS,backendName:"cpu",kernelFunc:jAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WAe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{paddings:i,mode:o}=s;Ve(r,"mirrorPad");const a=i.map((v,b)=>v[0]+r.shape[b]+v[1]),l=i.map(v=>v[0]),c=i.map((v,b)=>v[0]+r.shape[b]),u=o==="reflect"?0:1,d=n.data.get(r.dataId).values,h=r.shape.length,f=Ye(r.shape),p=le(a),m=a.length,g=Ye(a),y=Cs(r.dtype,p);for(let v=0;v<p;v++){let b=rp(v,m,g);for(let C=0;C<m;C++)b[C]<l[C]?b[C]=l[C]*2-b[C]-u:b[C]>=c[C]&&(b[C]=(c[C]-1)*2-b[C]+u);b=b.map((C,N)=>C-l[N]);const k=ba(b,h,f);y[v]=d[k]}return{dataId:n.write(y,a,r.dtype),shape:a,dtype:r.dtype}}const UAe={kernelName:nS,backendName:"cpu",kernelFunc:WAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HAe=rs((t,e)=>{const n=t%e;return t<0&&e<0||t>=0&&e>=0?n:(n+e)%e}),GAe=Is(qy,HAe),KAe={kernelName:qy,backendName:"cpu",kernelFunc:GAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OX(t){const{inputs:e,backend:n,attrs:s}=t,{logits:r}=e,{dim:i}=s,o=r.shape.length;let a=i;if(a===-1&&(a=o-1),a!==o-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${o} and dim was ${a}`);const l=bt([a],r.shape),c=DX({inputs:{x:r},backend:n,attrs:{reductionIndices:l,keepDims:!1}}),u=Hn(c.shape,l),d=nn({inputs:{x:c},backend:n,attrs:{shape:u}}),h=kD({inputs:{a:r,b:d},backend:n}),f=j9({inputs:{x:h},backend:n}),p=F0({inputs:{x:f},backend:n,attrs:{axis:l,keepDims:!1}}),m=nn({inputs:{x:p},backend:n,attrs:{shape:u}}),g=TD({inputs:{a:f,b:m},backend:n});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),g}const qAe={kernelName:bS,backendName:"cpu",kernelFunc:OX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XAe(t){const{inputs:e,backend:n,attrs:s}=t,{logits:r}=e,{numSamples:i,seed:o,normalized:a}=s;Ve(r,"multinomial");const l=a?r:OX({inputs:{logits:r},backend:n,attrs:{dim:-1}}),c=l.shape[0],u=l.shape[1],d=n.data.get(l.dataId).values,h=[c,i],f=Xs(le(h),"int32");for(let p=0;p<c;++p){const m=p*u,g=new Float32Array(u-1);g[0]=d[m];for(let v=1;v<g.length;++v)g[v]=g[v-1]+d[m+v];const y=MS.alea(o.toString()),x=p*i;for(let v=0;v<i;++v){const b=y();f[x+v]=g.length;for(let k=0;k<g.length;k++)if(b<g[k]){f[x+v]=k;break}}}return a||n.disposeIntermediateTensorInfo(l),n.makeTensorInfo(h,"int32",f)}const YAe={kernelName:q$,backendName:"cpu",kernelFunc:XAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZAe=xR;function QAe(t){const{inputs:e,backend:n,attrs:s}=t,{boxes:r,scores:i}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l}=s;Ve(r,"NonMaxSuppression");const c=n.data.get(r.dataId).values,u=n.data.get(i.dataId).values,{selectedIndices:d}=ZAe(c,u,o,a,l);return n.makeTensorInfo([d.length],"int32",new Int32Array(d))}const JAe={kernelName:X$,backendName:"cpu",kernelFunc:QAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eRe=vR;function tRe(t){const{inputs:e,backend:n,attrs:s}=t,{boxes:r,scores:i}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l,padToMaxOutputSize:c}=s;Ve(r,"NonMaxSuppressionPadded");const u=n.data.get(r.dataId).values,d=n.data.get(i.dataId).values,{selectedIndices:h,validOutputs:f}=eRe(u,d,o,a,l,c);return[n.makeTensorInfo([h.length],"int32",new Int32Array(h)),n.makeTensorInfo([],"int32",new Int32Array([f]))]}const nRe={kernelName:Y$,backendName:"cpu",kernelFunc:tRe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sRe=bR;function rRe(t){const{inputs:e,backend:n,attrs:s}=t,{boxes:r,scores:i}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l,softNmsSigma:c}=s;Ve(r,"NonMaxSuppressionWithScore");const u=n.data.get(r.dataId).values,d=n.data.get(i.dataId).values,h=o,f=a,p=l,m=c,{selectedIndices:g,selectedScores:y}=sRe(u,d,h,f,p,m);return[n.makeTensorInfo([g.length],"int32",new Int32Array(g)),n.makeTensorInfo([y.length],"float32",new Float32Array(y))]}const iRe={kernelName:Z$,backendName:"cpu",kernelFunc:rRe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oRe(t){const{inputs:e,backend:n,attrs:s}=t,{indices:r}=e,{dtype:i,depth:o,onValue:a,offValue:l}=s;Ve(r,"oneHot");const c=le(r.shape),u=new Float32Array(c*o);u.fill(l);const d=n.data.get(r.dataId).values;for(let h=0;h<c;++h)d[h]>=0&&d[h]<o&&(u[h*o+d[h]]=a);return n.makeTensorInfo([...r.shape,o],i,u)}const aRe={kernelName:oS,backendName:"cpu",kernelFunc:oRe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ww(t){const{inputs:e,backend:n}=t,{x:s}=e;if(s.dtype==="string")throw new Error("zerosLike is not supported for string tensors");if(s.dtype==="complex64"){const r=Id({inputs:{input:s},backend:n}),i=ww({inputs:{x:r},backend:n}),o=zf({inputs:{input:s},backend:n}),a=ww({inputs:{x:o},backend:n}),l=Wr({inputs:{real:i,imag:a},backend:n});return n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(a),l}else return ND({backend:n,attrs:{shape:s.shape,value:0,dtype:s.dtype}})}const lRe={kernelName:kS,backendName:"cpu",kernelFunc:ww};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PX(t){const{inputs:e,backend:n}=t,{x:s}=e;if(s.dtype==="string")throw new Error("onesLike is not supported for string tensors");if(s.dtype==="complex64"){const r=Id({inputs:{input:s},backend:n}),i=PX({inputs:{x:r},backend:n}),o=zf({inputs:{input:s},backend:n}),a=ww({inputs:{x:o},backend:n}),l=Wr({inputs:{real:i,imag:a},backend:n});return n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(a),l}else return ND({backend:n,attrs:{shape:s.shape,value:1,dtype:s.dtype}})}const cRe={kernelName:iS,backendName:"cpu",kernelFunc:PX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FX(t){const{inputs:e,backend:n,attrs:s}=t,{axis:r}=s;if(e.length===1)return bw({inputs:{input:e[0]},backend:n,attrs:{dim:r}});const i=e[0].shape,o=e[0].dtype;e.forEach(u=>{ni(i,u.shape,"All tensors passed to stack must have matching shapes"),O(o===u.dtype,()=>"All tensors passed to stack must have matching dtypes")});const a=[],l=e.map(u=>{const d=bw({inputs:{input:u},backend:n,attrs:{dim:r}});return a.push(d),d}),c=Vf({inputs:l,backend:n,attrs:{axis:r}});return a.forEach(u=>n.disposeIntermediateTensorInfo(u)),c}const uRe={kernelName:aS,backendName:"cpu",kernelFunc:FX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dRe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{paddings:i,constantValue:o}=s;Ve(r,"pad");const a=i.map((x,v)=>x[0]+r.shape[v]+x[1]),l=i.map(x=>x[0]),c=n.data.get(r.dataId).values,u=le(r.shape),d=r.shape.length,h=Ye(r.shape),f=le(a),p=a.length,m=Ye(a),g=Cs(r.dtype,f);o!==0&&g.fill(o);for(let x=0;x<u;x++){const b=rp(x,d,h).map((C,N)=>C+l[N]),k=ba(b,p,m);g[k]=c[x]}return{dataId:n.write(g,a,r.dtype),shape:a,dtype:r.dtype}}const LX={kernelName:lS,backendName:"cpu",kernelFunc:dRe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hRe=rs((t,e)=>Math.pow(t,e)),fRe=Is(Yy,hRe),pRe={kernelName:Yy,backendName:"cpu",kernelFunc:fRe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mRe(t){const{inputs:e,backend:n,attrs:s}=t,{paramsNestedSplits:r,paramsDenseValues:i,indices:o}=e,a=r.map(g=>n.data.get(g.dataId).values),l=r.map(g=>g.shape),c=n.data.get(i.dataId).values,u=n.data.get(o.dataId).values,[d,h,f]=rX(a,l,c,i.shape,i.dtype,u,o.shape),p=d.map(g=>n.makeTensorInfo([g.length],"int32",g)),m=n.makeTensorInfo(f,i.dtype,h);return p.concat([m])}const gRe={kernelName:Q$,backendName:"cpu",kernelFunc:mRe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yRe(t){const{inputs:e,backend:n,attrs:s}=t,{shape:r,values:i,defaultValue:o,rowPartitionTensors:a}=e,{rowPartitionTypes:l}=s,c=n.data.get(r.dataId).values,u=n.data.get(i.dataId).values,d=n.data.get(o.dataId).values,h=a.map(g=>n.data.get(g.dataId).values),f=a.map(g=>g.shape),[p,m]=iX(c,r.shape,u,i.shape,i.dtype,d,o.shape,h,f,l);return n.makeTensorInfo(p,i.dtype,m)}const xRe={kernelName:J$,backendName:"cpu",kernelFunc:yRe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vRe(t){const{backend:e,attrs:n}=t,{start:s,stop:r,dtype:i,step:o}=n,a=oX(s,r,o,i);return e.makeTensorInfo([a.length],i,a)}const bRe={kernelName:eA,backendName:"cpu",kernelFunc:vRe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wRe=Ht(Zy,t=>1/t),SRe={kernelName:Zy,backendName:"cpu",kernelFunc:wRe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kRe(t){const{inputs:e,backend:n,attrs:s}=t,{images:r}=e,{alignCorners:i,halfPixelCenters:o,size:a}=s;Ve(r,"resizeBilinear");const l=Ye(r.shape),[c,u]=a,[d,h,f,p]=r.shape,m=n.data.get(r.dataId).values,g=new Float32Array(le([d,c,u,p])),y=[i&&c>1?h-1:h,i&&u>1?f-1:f],x=[i&&c>1?c-1:c,i&&u>1?u-1:u];let v=0;const b=y[0]/x[0],k=y[1]/x[1];for(let C=0;C<d;C++)for(let N=0;N<c;N++){let I;o?I=b*(N+.5)-.5:I=b*N;const $=Math.max(0,Math.floor(I)),A=I-$,P=Math.min(h-1,Math.ceil(I)),F=C*l[0]+$*l[1],V=C*l[0]+P*l[1];for(let z=0;z<u;z++){let B;o?B=k*(z+.5)-.5:B=k*z;const W=Math.max(0,Math.floor(B)),q=B-W,M=Math.min(f-1,Math.ceil(B)),G=F+W*l[2],ne=V+W*l[2],ie=F+M*l[2],de=V+M*l[2];for(let he=0;he<p;he++){const pe=m[G+he],me=m[ne+he],ye=m[ie+he],Ce=m[de+he],Le=pe+(ye-pe)*q,Re=me+(Ce-me)*q,Ze=Le+(Re-Le)*A;g[v++]=Ze}}}return n.makeTensorInfo([d,c,u,p],"float32",g)}const CRe={kernelName:fS,backendName:"cpu",kernelFunc:kRe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TRe(t){const{inputs:e,backend:n,attrs:s}=t,{images:r,dy:i}=e,{alignCorners:o}=s;Ve([i,r],"resizeBilinearGrad");const a=Ye(r.shape),[l,c,u,d]=r.shape,[,h,f]=i.shape,p=new Float32Array(l*c*u*d),m=[o&&h>1?c-1:c,o&&f>1?u-1:u],g=[o&&h>1?h-1:h,o&&f>1?f-1:f],y=m[0]/g[0],x=m[1]/g[1],v=n.data.get(i.dataId).values;let b=0;for(let k=0;k<l;k++){const C=k*a[0];for(let N=0;N<h;N++){const I=N*y,$=Math.floor(I),A=Math.min(Math.ceil(I),c-1),P=C+$*a[1],F=C+A*a[1],V=I-$,z=1-V;for(let B=0;B<f;B++){const W=B*x,q=Math.floor(W),M=Math.min(Math.ceil(W),u-1),G=W-q,ne=1-G,ie=P+q*a[2],de=P+M*a[2],he=F+q*a[2],pe=F+M*a[2],me=z*ne,ye=z*G,Ce=V*ne,Le=V*G;for(let Re=0;Re<d;Re++){const Ze=v[b++];p[ie+Re]+=Ze*me,p[de+Re]+=Ze*ye,p[he+Re]+=Ze*Ce,p[pe+Re]+=Ze*Le}}}}return n.makeTensorInfo([l,u,c,d],"float32",p)}const NRe={kernelName:sA,backendName:"cpu",kernelFunc:TRe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IRe(t){const{inputs:e,backend:n,attrs:s}=t,{images:r}=e,{alignCorners:i,halfPixelCenters:o,size:a}=s;Ve(r,"resizeNearestNeighbor");const l=Ye(r.shape),[c,u]=a,[d,h,f,p]=r.shape,m=n.data.get(r.dataId).values,g=new Float32Array(d*c*u*p),y=[i&&c>1?h-1:h,i&&u>1?f-1:f],x=[i&&c>1?c-1:c,i&&u>1?u-1:u],v=y[0]/x[0],b=y[1]/x[1];let k=0;for(let C=0;C<d;C++){const N=C*l[0];for(let I=0;I<c;I++){const $=o?v*(I+.5):v*I;let A=Math.min(h-1,i?Math.round($):Math.floor($));o&&(A=Math.max(0,A));const P=N+A*l[1];for(let F=0;F<u;F++){const V=o?b*(F+.5):b*F;let z=Math.min(f-1,i?Math.round(V):Math.floor(V));o&&(z=Math.max(0,z));const B=P+z*l[2];for(let W=0;W<p;W++){const q=m[B+W];g[k++]=q}}}}return n.makeTensorInfo([d,c,u,p],r.dtype,g)}const _Re={kernelName:hS,backendName:"cpu",kernelFunc:IRe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ERe(t){const{inputs:e,backend:n,attrs:s}=t,{images:r,dy:i}=e,{alignCorners:o}=s;Ve([i,r],"resizeNearestNeighborGrad");const a=Ye(r.shape),l=Ye(i.shape),[c,u,d,h]=r.shape,[,f,p]=i.shape,m=new Float32Array(c*u*d*h),g=n.data.get(i.dataId).values,y=[o&&f>1?u-1:u,o&&p>1?d-1:d],x=[o&&f>1?f-1:f,o&&p>1?p-1:p],v=y[0]/x[0],b=y[1]/x[1],k=1/v,C=1/b,N=Math.ceil(k)*2+2,I=Math.ceil(C)*2+2;for(let $=0;$<c;$++){const A=$*a[0];for(let P=0;P<u;P++){const F=A+P*a[1],V=Math.floor(P*k),z=Math.floor(V-N/2);for(let B=0;B<d;B++){const W=F+B*a[2],q=Math.floor(B*C),M=Math.floor(q-I/2);for(let G=0;G<h;G++){let ne=0;for(let ie=0;ie<N;ie++){const de=ie+z;if(de<0||de>=f)continue;const he=A+de*l[1],pe=de*v,me=Math.min(u-1,o?Math.round(pe):Math.floor(pe));if(P===me)for(let ye=0;ye<I;ye++){const Ce=ye+M;if(Ce<0||Ce>=p)continue;const Le=he+Ce*l[2],Re=Ce*b,Ze=Math.min(d-1,o?Math.round(Re):Math.floor(Re));B===Ze&&(ne+=g[Le+G])}}m[W+G]=ne}}}}return n.makeTensorInfo(r.shape,r.dtype,m)}const $Re={kernelName:nA,backendName:"cpu",kernelFunc:ERe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ARe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{dims:i}=s;Ve(r,"reverse");const o=r.shape.length,a=bt(i,r.shape);if(o===0)return Ra({inputs:{x:r},backend:n});const l=new ks(r.shape,r.dtype),c=n.bufferSync(r);for(let u=0;u<l.size;u++){const d=l.indexToLoc(u),h=d.slice();a.forEach(f=>h[f]=r.shape[f]-1-h[f]),l.set(c.get(...h),...d)}return n.makeTensorInfo(l.shape,l.dtype,l.values)}const RRe={kernelName:pS,backendName:"cpu",kernelFunc:ARe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DRe={kernelName:vA,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:s}=t,{radians:r,fillValue:i,center:o}=e,a=n,l=Cs(s.dtype,le(s.shape)),[c,u,d,h]=s.shape,[f,p]=$R(o,u,d),m=255,g=Math.sin(r),y=Math.cos(r),x=a.data.get(s.dataId).values;for(let b=0;b<c;b++){const k=b*d*u*h;for(let C=0;C<u;C++){const N=C*(d*h);for(let I=0;I<d;I++){const $=I*h;for(let A=0;A<h;A++){const P=[c,C,I,A],F=P[2],V=P[1];let z=(F-f)*y-(V-p)*g,B=(F-f)*g+(V-p)*y;z=Math.round(z+f),B=Math.round(B+p);let W=i;if(typeof i!="number"&&(A===3?W=m:W=i[A]),z>=0&&z<d&&B>=0&&B<u){const M=B*(d*h),G=z*h,ne=k+M+G+A;W=x[ne]}const q=k+N+$+A;l[q]=W}}}}return{dataId:a.write(l,s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ORe=Ht(e0,t=>{const e=Math.floor(t);return t-e<.5?Math.floor(t):t-e>.5?Math.ceil(t):e%2===0?e:e+1}),PRe={kernelName:e0,backendName:"cpu",kernelFunc:ORe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FRe(t){const{inputs:e,backend:n,attrs:s}=t,{indices:r,updates:i}=e,{shape:o}=s,{sliceRank:a,numUpdates:l,sliceSize:c,strides:u,outputSize:d}=g0(i,r,o),h=!0,f=n.bufferSync(r),p=n.bufferSync(i),m=Rh(f,p,o,d,c,l,a,u,0,h);return n.makeTensorInfo(o,m.dtype,m.values)}const LRe={kernelName:rA,backendName:"cpu",kernelFunc:FRe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MRe(t,e){let n=0,s=t.length,r=0;for(;n<s;)r=Math.floor((n+s)/2),t[r]<e?n=r+1:s=r;return s}function zRe(t,e){let n=0,s=t.length,r=0;for(;n<s;)r=Math.floor((n+s)/2),t[r]<=e?n=r+1:s=r;return s}function VRe(t,e,n,s,r,i){const o=ws("int32",n*r);for(let a=0;a<n;++a){const l=t.slice(a*s,(a+1)*s),c=a*r;for(let u=0;u<r;++u)o[c+u]=i==="left"?MRe(l,e[u+c]):zRe(l,e[u+c])}return o}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jRe(t){const{inputs:e,backend:n,attrs:s}=t,{sortedSequence:r,values:i}=e,{side:o}=s,a=n.data.get(r.dataId).values,l=n.data.get(i.dataId).values,c=VRe(a,l,r.shape[0],r.shape[1],i.shape[1],o);return n.makeTensorInfo(i.shape,"int32",c)}const BRe={kernelName:iA,backendName:"cpu",kernelFunc:jRe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WRe(t){const{inputs:e,backend:n}=t,{condition:s,t:r,e:i}=e;Ve([s,r,i],"select");const o=s.shape.length,a=n.data.get(s.dataId).values,l=n.data.get(r.dataId).values,c=n.data.get(i.dataId).values,u=Zr(r.dtype,i.dtype),d=Xs(le(r.shape),u);let h=0;const f=o===0||o>1||r.shape.length===1?1:le(r.shape.slice(1));for(let p=0;p<a.length;p++)for(let m=0;m<f;m++)a[p]===1?d[h++]=l[p]:d[h++]=c[p];return n.makeTensorInfo(r.shape,u,d)}const URe={kernelName:mS,backendName:"cpu",kernelFunc:WRe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HRe=YS,GRe=ZS,KRe=Ht(n0,t=>t>=0?GRe*t:HRe*(Math.exp(t)-1)),qRe={kernelName:n0,backendName:"cpu",kernelFunc:KRe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XRe=Ht(i0,t=>t<0?-1:t>0?1:0),YRe={kernelName:i0,backendName:"cpu",kernelFunc:XRe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZRe=Ht(s0,t=>Math.sin(t)),QRe={kernelName:s0,backendName:"cpu",kernelFunc:ZRe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JRe=Ht(r0,t=>Math.sinh(t)),eDe={kernelName:r0,backendName:"cpu",kernelFunc:JRe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tDe=11920928955078125e-23,aV=Math.log(tDe)+2,nDe=Ht(a0,t=>{const e=t>-aV,n=t<aV,s=Math.exp(t);let r;return n?r=s:e?r=t:r=Math.log(1+s),r}),sDe={kernelName:a0,backendName:"cpu",kernelFunc:nDe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rDe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{blockShape:i,paddings:o}=s;Ve([r],"spaceToBatchND");const a=le(i),l=[[0,0]];l.push(...o);for(let C=1+i.length;C<r.shape.length;++C)l.push([0,0]);const c=LX.kernelFunc({inputs:{x:r},backend:n,attrs:{paddings:l,constantValue:0}}),u=C0(c.shape,i,a,!1),d=T0(u.length,i.length,!1),h=N0(c.shape,i,a,!1),m=nn({inputs:{x:c},backend:n,attrs:{shape:u}}),x=_r({inputs:{x:m},backend:n,attrs:{perm:d}}),k=nn({inputs:{x},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(x),k}const iDe={kernelName:xS,backendName:"cpu",kernelFunc:rDe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oDe(t){const{inputs:e,backend:n}=t,{indices:s,values:r,denseShape:i,defaultValue:o}=e;if(i.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
        ${i.shape}`);if(s.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
        ${s.shape}`);if(r.shape.length!==1)throw new Error(`Values must be a vector, saw:
        ${r.shape}`);if(o.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${o.shape}`);const a=n.data.get(s.dataId).values,l=n.data.get(r.dataId).values,c=n.data.get(i.dataId).values,u=n.data.get(o.dataId).values[0],[d,h,f,p,m]=uX(a,s.shape,s.dtype,l,r.dtype,c,u);return[n.makeTensorInfo(h,s.dtype,d),n.makeTensorInfo([h[0]],r.dtype,f),n.makeTensorInfo([p.length],"bool",new Uint8Array(p.map(g=>Number(g)))),n.makeTensorInfo([m.length],s.dtype,new Int32Array(m))]}const aDe={kernelName:oA,backendName:"cpu",kernelFunc:oDe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lDe(t){const{inputs:e,backend:n}=t,{inputIndices:s,inputShape:r,newShape:i}=e;if(s.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape
        ${s.shape}`);if(r.shape.length!==1)throw new Error(`Input shape should be a vector but received shape
        ${r.shape}`);if(i.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${i.shape}`);const o=Array.from(n.data.get(r.dataId).values),a=n.data.get(s.dataId).values,l=Array.from(n.data.get(i.dataId).values),[c,u,d]=dX(a,s.shape,s.dtype,o,l);return[n.makeTensorInfo(u,s.dtype,c),n.makeTensorInfo([d.length],i.dtype,new Int32Array(d))]}const cDe={kernelName:aA,backendName:"cpu",kernelFunc:lDe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uDe(t){const{inputs:e,backend:n}=t,{data:s,indices:r,segmentIds:i}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
          ${r.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
          ${i.shape}`);if(r.shape[0]!==i.shape[0])throw new Error("segmentIds and indices should have same size.");const o=n.data.get(s.dataId).values,a=n.data.get(r.dataId).values,l=n.data.get(i.dataId).values,[c,u]=SD(o,s.shape,s.dtype,a,l,!0);return n.makeTensorInfo(u,s.dtype,c)}const dDe={kernelName:lA,backendName:"cpu",kernelFunc:uDe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hDe(t){const{inputs:e,backend:n}=t,{data:s,indices:r,segmentIds:i}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
         ${r.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
         ${i.shape}`);if(r.shape[0]!==i.shape[0])throw new Error("segmentIds and indices should have same size.");const o=n.data.get(s.dataId).values,a=n.data.get(r.dataId).values,l=n.data.get(i.dataId).values,[c,u]=SD(o,s.shape,s.dtype,a,l);return n.makeTensorInfo(u,s.dtype,c)}const fDe={kernelName:cA,backendName:"cpu",kernelFunc:hDe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pDe(t){const{inputs:e,backend:n,attrs:s}=t,{sparseIndices:r,sparseValues:i,defaultValue:o}=e,{outputShape:a}=s,{sliceRank:l,numUpdates:c,sliceSize:u,strides:d,outputSize:h}=g0(i,r,a),f=!1,p=n.bufferSync(r);let m;switch(i.dtype){case"bool":{const g=n.bufferSync(i),y=!!n.data.get(o.dataId).values[0];m=Rh(p,g,a,h,u,c,l,d,y,f);break}case"float32":{const g=n.bufferSync(i),y=n.data.get(o.dataId).values[0];m=Rh(p,g,a,h,u,c,l,d,y,f);break}case"int32":{const g=n.bufferSync(i),y=n.data.get(o.dataId).values[0];m=Rh(p,g,a,h,u,c,l,d,y,f);break}case"string":{const g=n.bufferSync(i),y=Mc(n.data.get(o.dataId).values[0]);m=Rh(p,g,a,h,u,c,l,d,y,f);break}default:throw new Error(`Unsupported type ${i.dtype}`)}return n.makeTensorInfo(a,m.dtype,m.values)}const mDe={kernelName:uA,backendName:"cpu",kernelFunc:pDe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gDe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{numOrSizeSplits:i,axis:o}=s,a=bt(o,r.shape)[0],l=HR(r,i,a),c=new Array(r.shape.length).fill(0),u=r.shape.slice();return l.map(d=>{const h=[...u];h[a]=d;const f=_d({inputs:{x:r},backend:n,attrs:{begin:c,size:h}});return c[a]+=d,f})}const yDe={kernelName:vS,backendName:"cpu",kernelFunc:gDe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xDe={kernelName:dA,backendName:"cpu",kernelFunc:({inputs:t,backend:e})=>{const{x:n}=t,s=e;Ve(n,"square");const r=s.data.get(n.dataId).values,i=new Float32Array(r.length);for(let a=0;a<r.length;++a){const l=r[a];i[a]=l*l}return{dataId:s.write(i,n.shape,n.dtype),shape:n.shape,dtype:n.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vDe=Ht(p0,(t,e)=>{const n=e;return isNaN(t)?NaN:t>0?1:n.alpha}),bDe={kernelName:p0,backendName:"cpu",kernelFunc:vDe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wDe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{begin:i,end:o,strides:a,beginMask:l,endMask:c,ellipsisMask:u,newAxisMask:d,shrinkAxisMask:h}=s;Ve(r,"stridedSlice");const{finalShapeSparse:f,finalShape:p,isIdentity:m,sliceDim0:g,isSimpleSlice:y,begin:x,end:v,strides:b}=DA(r.shape,i,o,a,l,c,u,d,h);let k;if(m)k=nn({inputs:{x:r},backend:n,attrs:{shape:p}});else if(g||y){O(r.shape.length>=1,()=>`Input must have rank at least 1, got: ${r.shape.length}`);const C=$A(x,v,b),N=_d({inputs:{x:r},backend:n,attrs:{begin:x,size:C}});k=nn({inputs:{x:N},backend:n,attrs:{shape:p}}),n.disposeIntermediateTensorInfo(N)}else{const C=n.bufferSync(r),N=fX(f,C,b,x);k=n.makeTensorInfo(p,N.dtype,N.values)}return k}const SDe={kernelName:hA,backendName:"cpu",kernelFunc:wDe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kDe(t){const{inputs:e,backend:n,attrs:s}=t,{separator:r,nGramWidths:i,leftPad:o,rightPad:a,padWidth:l,preserveShortSequences:c}=s,{data:u,dataSplits:d}=e,h=n.data.get(u.dataId).values,f=n.data.get(d.dataId).values,[p,m]=pX(h,f,r,i,o,a,l,c);return[n.makeTensorInfo([p.length],"string",p),n.makeTensorInfo(d.shape,"int32",m)]}const CDe={kernelName:fA,backendName:"cpu",kernelFunc:kDe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TDe(t){const{inputs:e,backend:n,attrs:s}=t,{skipEmpty:r}=s,{input:i,delimiter:o}=e;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(i.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${i.shape}`);if(o.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${o.shape}`);const a=n.data.get(i.dataId).values,l=n.data.get(o.dataId).values[0],[c,u,d]=mX(a,l,r),h=u.length;return[n.makeTensorInfo([h,2],"int32",c),n.makeTensorInfo([h],"string",u),n.makeTensorInfo([2],"int32",new Int32Array(d))]}const NDe={kernelName:pA,backendName:"cpu",kernelFunc:TDe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IDe(t){const{inputs:e,backend:n,attrs:s}=t,{numBuckets:r}=s,{input:i}=e;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(r<=0)throw new Error("Number of buckets must be at least 1");const o=n.data.get(i.dataId).values,a=gX(o,r);return n.makeTensorInfo(i.shape,"int32",a)}const _De={kernelName:mA,backendName:"cpu",kernelFunc:IDe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EDe=Ht(d0,t=>Math.tan(t)),$De={kernelName:d0,backendName:"cpu",kernelFunc:EDe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ADe=Ht(h0,t=>Math.tanh(t)),RDe={kernelName:h0,backendName:"cpu",kernelFunc:ADe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DDe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{reps:i}=s;Ve(r,"tile");const o=xX(n.bufferSync(r),i);return n.makeTensorInfo(o.shape,o.dtype,o.values)}const ODe={kernelName:f0,backendName:"cpu",kernelFunc:DDe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PDe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{k:i,sorted:o}=s;Ve(r,"topk");const a=n.data.get(r.dataId).values,[l,c]=bX(a,r.shape,r.dtype,i,o);return[n.makeTensorInfo(l.shape,l.dtype,l.values),n.makeTensorInfo(c.shape,c.dtype,c.values)]}const FDe={kernelName:gA,backendName:"cpu",kernelFunc:PDe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LDe(t){const{inputs:e,attrs:n,backend:s}=t,{image:r,transforms:i}=e,{interpolation:o,fillMode:a,fillValue:l,outputShape:c}=n,[u,d,h,f]=r.shape,[p,m]=c??[d,h],g=[u,p,m,f],y=Ye(r.shape),x=y[0],v=y[1],b=y[2],k=Ye(g),C=k[0],N=k[1],I=k[2],$=Cs(r.dtype,le(g));$.fill(l);const A=s.data.get(r.dataId).values,P=s.data.get(i.dataId).values;for(let V=0;V<u;++V){const z=i.shape[0]===1?P:P.subarray(V*8,V*8+8);for(let B=0;B<p;++B)for(let W=0;W<m;++W)for(let q=0;q<f;++q){let M;const G=z[6]*W+z[7]*B+1;if(G===0)continue;const ne=(z[0]*W+z[1]*B+z[2])/G,ie=(z[3]*W+z[4]*B+z[5])/G,de=lV(ne,h,a),he=lV(ie,d,a);switch(o){case"nearest":M=WDe(A,d,h,x,v,b,V,he,de,q,l);break;case"bilinear":M=UDe(A,d,h,x,v,b,V,he,de,q,l);break;default:throw new Error(`Error in Transform: Expect 'nearest' or 'bilinear', but got ${o}`)}const pe=V*C+B*N+W*I+q;$[pe]=M}return s.makeTensorInfo(g,r.dtype,$)}return{dataId:s.write($,g,r.dtype),shape:r.shape,dtype:r.dtype}}const MDe={kernelName:yA,backendName:"cpu",kernelFunc:LDe};function lV(t,e,n){switch(n){case"reflect":return zDe(t,e);case"wrap":return VDe(t,e);case"nearest":return BDe(t,e);case"constant":default:return jDe(t)}}function zDe(t,e){let n=t;if(n<0)if(e<=1)n=0;else{const s=2*e;n<s&&(n=s*Math.trunc(-n/s)+n),n=n<-e?n+s:-n-1}else if(n>e-1)if(e<=1)n=0;else{const s=2*e;n-=s*Math.trunc(n/s),n>=e&&(n=s-n-1)}return xd(0,n,e-1)}function VDe(t,e){let n=t;if(n<0)if(e<=1)n=0;else{const s=e-1;n+=e*(Math.trunc(-n/s)+1)}else if(n>e-1)if(e<=1)n=0;else{const s=e-1;n-=e*Math.trunc(n/s)}return xd(0,n,e-1)}function jDe(t,e){return t}function BDe(t,e){return xd(0,t,e-1)}function wm(t,e,n,s,r,i,o,a,l,c,u){const d=o*s+a*r+l*i+c;return 0<=a&&a<e&&0<=l&&l<n?t[d]:u}function WDe(t,e,n,s,r,i,o,a,l,c,u){const d=Math.round(a),h=Math.round(l);return wm(t,e,n,s,r,i,o,d,h,c,u)}function UDe(t,e,n,s,r,i,o,a,l,c,u){const d=Math.floor(a),h=Math.floor(l),f=d+1,p=h+1,m=(p-l)*wm(t,e,n,s,r,i,o,d,h,c,u)+(l-h)*wm(t,e,n,s,r,i,o,d,p,c,u),g=(p-l)*wm(t,e,n,s,r,i,o,f,h,c,u)+(l-h)*wm(t,e,n,s,r,i,o,f,p,c,u);return(f-a)*m+(a-d)*g}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HDe(t){const{inputs:e,attrs:n,backend:s}=t,{axis:r}=n,{x:i}=e;Ve(i,"unique");const o=s.data.get(i.dataId).values,{outputValues:a,outputShape:l,indices:c}=wX(o,r,i.shape,i.dtype);return[s.makeTensorInfo(l,i.dtype,a),s.makeTensorInfo([c.length],"int32",c)]}const GDe={kernelName:xA,backendName:"cpu",kernelFunc:HDe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KDe(t){const{inputs:e,backend:n,attrs:s}=t,{value:r}=e;let{axis:i}=s;i<0&&(i+=r.shape.length);const o=r.shape.length,a=r.shape[i],l=new Array(o-1);let c=0;for(let f=0;f<o;f++)f!==i&&(l[c++]=r.shape[f]);const u=new Array(o).fill(0),d=r.shape.slice();d[i]=1;const h=new Array(a);for(let f=0;f<h.length;f++){u[i]=f;const p=_d({inputs:{x:r},backend:n,attrs:{begin:u,size:d}});h[f]=nn({inputs:{x:p},backend:n,attrs:{shape:l}}),n.disposeIntermediateTensorInfo(p)}return h}const qDe={kernelName:wS,backendName:"cpu",kernelFunc:KDe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XDe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,segmentIds:i}=e,{numSegments:o}=s;Ve(r,"unsortedSegmentSum");const a=r.shape.length,l=i.shape.length,c=[],u=[],d=a-l;let h=i;for(let p=0;p<d;++p){const m=bw({inputs:{input:h},backend:n,attrs:{dim:p+1}});h=m,u.push(m)}for(let p=0;p<o;++p){const m=tu(p,"int32"),g=n.makeTensorInfo([],"int32",m),y=z9({inputs:{a:g,b:h},backend:n}),x=Kc({inputs:{x:y},backend:n,attrs:{dtype:"float32"}}),v=uk({inputs:{a:x,b:r},backend:n}),b=F0({inputs:{x:v},backend:n,attrs:{axis:0,keepDims:!1}});c.push(b),u.push(g),u.push(y),u.push(x),u.push(v),u.push(b)}const f=FX({inputs:c,backend:n,attrs:{axis:0}});return u.forEach(p=>n.disposeIntermediateTensorInfo(p)),f}const YDe={kernelName:SS,backendName:"cpu",kernelFunc:XDe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZDe=[q_e,OIe,Y_e,Q_e,VIe,eEe,nEe,rEe,oEe,lEe,uEe,hEe,pEe,yEe,vEe,SEe,CEe,NEe,_Ee,G_e,$Ee,REe,OEe,FEe,MIe,BIe,MEe,PIe,VEe,BEe,WEe,HEe,KEe,XEe,ZEe,JEe,t$e,s$e,i$e,a$e,c$e,d$e,f$e,p$e,g$e,x$e,b$e,w$e,S$e,k$e,N$e,z_e,_$e,WIe,F$e,UIe,L$e,GIe,W$e,U$e,G$e,qIe,X$e,Z$e,J$e,tAe,sAe,YIe,QIe,FIe,iAe,jEe,aAe,cAe,dAe,V_e,e_e,n_e,fAe,r_e,mAe,xAe,bAe,kAe,TAe,IAe,_Ae,o_e,$Ae,RAe,OAe,FAe,MAe,VAe,BAe,l_e,UAe,KAe,YAe,u_e,h_e,JAe,nRe,iRe,p_e,aRe,cRe,uRe,LX,pRe,B_e,y_e,gRe,xRe,bRe,LIe,CI,SRe,W_e,U_e,H_e,CRe,NRe,_Re,$Re,RRe,DRe,PRe,T_e,LRe,BRe,URe,qRe,I_e,YRe,QRe,eDe,__e,qAe,sDe,iDe,aDe,cDe,dDe,fDe,mDe,yDe,A_e,xDe,D_e,bDe,SDe,CDe,NDe,_De,L_e,C$e,$De,RDe,ODe,FDe,MDe,m_e,GDe,qDe,YDe,lRe];for(const t of ZDe)P6(t);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $u={},Xx={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function QDe(t,e){$u[t]=e}function Bo(t,e){if(!(t in $u)||e!=null){const s=eOe(t,e);if(s!==null)$u[t]=s;else return console.log("Could not get context for WebGL version",t),null}const n=$u[t];return n==null||n.isContextLost()?(delete $u[t],Bo(t)):(n.disable(n.DEPTH_TEST),n.disable(n.STENCIL_TEST),n.disable(n.BLEND),n.disable(n.DITHER),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SAMPLE_COVERAGE),n.enable(n.SCISSOR_TEST),n.enable(n.CULL_FACE),n.cullFace(n.BACK),$u[t])}function JDe(t){if(typeof OffscreenCanvas<"u"&&t===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function eOe(t,e){if(t!==1&&t!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");const n=e??JDe(t);return n.addEventListener("webglcontextlost",s=>{s.preventDefault(),delete $u[t]},!1),oe().getBool("SOFTWARE_WEBGL_ENABLED")&&(Xx.failIfMajorPerformanceCaveat=!1),t===1?n.getContext("webgl",Xx)||n.getContext("experimental-webgl",Xx):n.getContext("webgl2",Xx)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Pg;(function(t){t[t.DENSE=0]="DENSE",t[t.SHARED_BATCH=1]="SHARED_BATCH"})(Pg||(Pg={}));var yi;(function(t){t[t.RENDER=0]="RENDER",t[t.UPLOAD=1]="UPLOAD",t[t.PIXELS=2]="PIXELS",t[t.DOWNLOAD=3]="DOWNLOAD"})(yi||(yi={}));var Ds;(function(t){t[t.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",t[t.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",t[t.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",t[t.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",t[t.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"})(Ds||(Ds={}));function L0(t,e){return[e,t]}function tOe(t,e){return t*e}function Yx(t){const e=le(t),n=Math.ceil(e/4);return T2(n)}function fp(t,e){return[Math.max(1,Math.ceil(e/2)),Math.max(1,Math.ceil(t/2))]}function nOe(t,e){const[n,s]=fp(t,e);return n*s*4}function ID(t,e){const n=t;let s,r,i,o,a,l,c,u,d,h;return oe().getNumber("WEBGL_VERSION")===2?(s=n.R32F,r=n.R16F,i=n.RGBA16F,o=n.RGBA32F,a=n.RED,c=4,u=1,d=n.HALF_FLOAT,h=n.FLOAT,l=n.RGBA8):(s=t.RGBA,r=t.RGBA,i=t.RGBA,o=n.RGBA,a=t.RGBA,c=4,u=4,d=e!=null?e.HALF_FLOAT_OES:null,h=t.FLOAT,l=t.RGBA),{internalFormatFloat:s,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:i,internalFormatPackedFloat:o,textureFormatFloat:a,downloadTextureFormat:l,downloadUnpackNumChannels:c,defaultNumChannels:u,textureTypeHalfFloat:d,textureTypeFloat:h}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function je(t,e){const n=e();return oe().getBool("DEBUG")&&sOe(t),n}function sOe(t){const e=t.getError();if(e!==t.NO_ERROR)throw new Error("WebGL Error: "+aOe(t,e))}const rOe=596e-10,iOe=65504;function oOe(t){return!!(oe().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||t===0||rOe<Math.abs(t)&&Math.abs(t)<iOe)}function aOe(t,e){switch(e){case t.NO_ERROR:return"NO_ERROR";case t.INVALID_ENUM:return"INVALID_ENUM";case t.INVALID_VALUE:return"INVALID_VALUE";case t.INVALID_OPERATION:return"INVALID_OPERATION";case t.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case t.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case t.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return`Unknown error code ${e}`}}function Zx(t,e){return Cl(t,()=>t.getExtension(e),'Extension "'+e+'" not supported on this browser.')}function lOe(t,e){const n=Cl(t,()=>t.createShader(t.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if(je(t,()=>t.shaderSource(n,e)),je(t,()=>t.compileShader(n)),t.getShaderParameter(n,t.COMPILE_STATUS)===!1)throw console.log(t.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}function cOe(t,e){const n=Cl(t,()=>t.createShader(t.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if(je(t,()=>t.shaderSource(n,e)),je(t,()=>t.compileShader(n)),oe().get("ENGINE_COMPILE_ONLY"))return n;if(t.getShaderParameter(n,t.COMPILE_STATUS)===!1)throw MX(e,t.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}const uOe=/ERROR: [0-9]+:([0-9]+):/g;function MX(t,e){const n=uOe.exec(e);if(n==null){console.log(`Couldn't parse line number in error: ${e}`),console.log(t);return}const s=+n[1],r=t.split(`
`),i=r.length.toString().length+2,o=r.map((d,h)=>Wh((h+1).toString(),i)+d);let a=0;for(let d=0;d<o.length;d++)a=Math.max(o[d].length,a);const l=o.slice(0,s-1),c=o.slice(s-1,s),u=o.slice(s);console.log(l.join(`
`)),console.log(e.split(`
`)[0]),console.log(`%c ${Wh(c[0],a)}`,"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(u.join(`
`))}function dOe(t){return Cl(t,()=>t.createProgram(),"Unable to create WebGLProgram.")}function hOe(t,e){if(je(t,()=>t.linkProgram(e)),!oe().get("ENGINE_COMPILE_ONLY")&&t.getProgramParameter(e,t.LINK_STATUS)===!1)throw console.log(t.getProgramInfoLog(e)),new Error("Failed to link vertex and fragment shaders.")}function cT(t,e){if(je(t,()=>t.validateProgram(e)),t.getProgramParameter(e,t.VALIDATE_STATUS)===!1)throw console.log(t.getProgramInfoLog(e)),new Error("Shader program validation failed.")}function fOe(t,e){const n=Cl(t,()=>t.createBuffer(),"Unable to create WebGLBuffer");return je(t,()=>t.bindBuffer(t.ARRAY_BUFFER,n)),je(t,()=>t.bufferData(t.ARRAY_BUFFER,e,t.STATIC_DRAW)),n}function pOe(t,e){const n=Cl(t,()=>t.createBuffer(),"Unable to create WebGLBuffer");return je(t,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,n)),je(t,()=>t.bufferData(t.ELEMENT_ARRAY_BUFFER,e,t.STATIC_DRAW)),n}function mOe(t){return Cl(t,()=>t.createTexture(),"Unable to create WebGLTexture.")}function gOe(t,e){const n=oe().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t<=0||e<=0){const s=`[${t}x${e}]`;throw new Error("Requested texture size "+s+" is invalid.")}if(t>n||e>n){const s=`[${t}x${e}]`,r=`[${n}x${n}]`;throw new Error("Requested texture size "+s+" greater than WebGL maximum on this browser / GPU "+r+".")}}function yOe(t){return Cl(t,()=>t.createFramebuffer(),"Unable to create WebGLFramebuffer.")}function cV(t,e,n,s,r,i,o){const a=t.getAttribLocation(e,n);return a===-1?!1:(je(t,()=>t.bindBuffer(t.ARRAY_BUFFER,s)),je(t,()=>t.vertexAttribPointer(a,r,t.FLOAT,!1,i,o)),je(t,()=>t.enableVertexAttribArray(a)),!0)}function xOe(t,e,n){kOe(t,n),je(t,()=>t.activeTexture(t.TEXTURE0+n)),je(t,()=>t.bindTexture(t.TEXTURE_2D,e))}function vOe(t,e,n){return Cl(t,()=>t.getUniformLocation(e,n),'uniform "'+n+'" not present in program.')}function bOe(t,e,n){return t.getUniformLocation(e,n)}function wOe(t,e,n,s){je(t,()=>xOe(t,e,s)),je(t,()=>t.uniform1i(n,s))}function uT(t,e,n){je(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,n)),je(t,()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0))}function uV(t,e){je(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,e)),je(t,()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,null,0))}function Qx(t){const e=t.checkFramebufferStatus(t.FRAMEBUFFER);if(e!==t.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+SOe(t,e))}function SOe(t,e){switch(e){case t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case t.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return`unknown error ${e}`}}function Cl(t,e,n){const s=je(t,()=>e());if(s==null)throw new Error(n);return s}function kOe(t,e){const n=t.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,s=e+t.TEXTURE0;if(s<t.TEXTURE0||s>n){const r=`[gl.TEXTURE0, gl.TEXTURE${n}]`;throw new Error(`textureUnit must be in ${r}.`)}}function jf(t,e=2){return le(t.slice(0,t.length-e))}function Bf(t){if(t.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[t.length>1?t[t.length-2]:1,t[t.length-1]]}function dT(t){let e=[1,1,1];return t.length===0||t.length===1&&t[0]===1||(e=[jf(t),...Bf(t)]),e}function COe(t,e=!1){let n=oe().getNumber("WEBGL_MAX_TEXTURE_SIZE"),s=oe().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");s===1/0&&oe().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(s=n/2),e&&(n=n*2,s=s*2,t=t.map((a,l)=>l>=t.length-2?m$(t[l]):t[l]),t.length===1&&(t=[2,t[0]])),t.length!==2&&(t=eu(t).newShape);let r=le(t),i=null;t.length<=1&&r<=n?i=[1,r]:t.length===2&&t[0]<=n&&t[1]<=n?i=t:t.length===3&&t[0]*t[1]<=n&&t[2]<=n?i=[t[0]*t[1],t[2]]:t.length===3&&t[0]<=n&&t[1]*t[2]<=n?i=[t[0],t[1]*t[2]]:t.length===4&&t[0]*t[1]*t[2]<=n&&t[3]<=n?i=[t[0]*t[1]*t[2],t[3]]:t.length===4&&t[0]<=n&&t[1]*t[2]*t[3]<=n&&(i=[t[0],t[1]*t[2]*t[3]]);const o=i!=null&&Math.max(...i)>s&&Math.min(...i)<=(e?2:1)&&Math.min(...i)>0;if(i==null||o)if(e){const a=jf(t);let l=2,c=2;t.length&&([l,c]=Bf(t)),r=a*(l/2)*(c/2),i=T2(r).map(u=>u*2)}else i=T2(r);return i}function Jx(t){return t%2===0}function Sw(t,e){if(t=t.slice(-2),e=e.slice(-2),Et(t,e)||!t.length||!e.length||t[0]===0||t[1]===0||e[0]===0||e[1]===0)return!0;if(t.length!==e.length){const n=t.slice(-1)[0],s=e.slice(-1)[0];if(n===s||Jx(n)&&Jx(s)&&(t[0]===1||e[0]===1))return!0}return t[1]===e[1]&&Jx(t[0])&&Jx(e[0])}let hT,fT;function TOe(t){if(hT==null){const e=Bo(t);hT=e.getParameter(e.MAX_TEXTURE_SIZE)}return hT}function NOe(t){if(fT==null){const e=Bo(t);fT=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,fT)}function IOe(t){if(t===0)return 0;let e;const n=Bo(t);return to(n,"EXT_disjoint_timer_query_webgl2")&&t===2?e=2:to(n,"EXT_disjoint_timer_query")?e=1:e=0,e}function to(t,e){return t.getExtension(e)!=null}function dV(t){try{if(Bo(t)!=null)return!0}catch(e){return console.log("Error when getting WebGL context: ",e),!1}return!1}function _Oe(t){if(t===0)return!1;const e=Bo(t);if(t===1){if(!to(e,"OES_texture_float"))return!1}else if(!to(e,"EXT_color_buffer_float"))return!1;return NI(e)}function EOe(t){if(t===0)return!1;const e=Bo(t);if(t===1){if(!to(e,"OES_texture_float")||!to(e,"WEBGL_color_buffer_float"))return!1}else{if(to(e,"EXT_color_buffer_float"))return NI(e);const s="EXT_color_buffer_half_float";if(to(e,s)){const r=e.getExtension(s);return $Oe(e,r)}return!1}return NI(e)}function NI(t){const e=ID(t),n=t.createTexture();t.bindTexture(t.TEXTURE_2D,n);const s=1,r=1;t.texImage2D(t.TEXTURE_2D,0,e.internalFormatFloat,s,r,0,e.textureFormatFloat,e.textureTypeFloat,null);const i=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,i),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0);const o=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(n),t.deleteFramebuffer(i),o}function $Oe(t,e){const n=ID(t,e),s=t.createTexture();t.bindTexture(t.TEXTURE_2D,s);const r=1,i=1;t.texImage2D(t.TEXTURE_2D,0,n.internalFormatHalfFloat,r,i,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);const o=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,o),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,s,0);const a=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(s),t.deleteFramebuffer(o),a}function AOe(t){return t!==2?!1:Bo(t).fenceSync!=null}function M0(t,e){Array.isArray(t)||(t=[t]),t.forEach(n=>{n!=null&&O(n.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the WebGL backend.`)})}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ke=oe();Ke.registerFlag("HAS_WEBGL",()=>Ke.getNumber("WEBGL_VERSION")>0);Ke.registerFlag("WEBGL_VERSION",()=>dV(2)?2:dV(1)?1:0);Ke.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",()=>!1);Ke.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>Ke.get("WEBGL_VERSION")===2);Ke.registerFlag("WEBGL_CPU_FORWARD",()=>!0);Ke.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1);Ke.registerFlag("WEBGL_PACK",()=>Ke.getBool("HAS_WEBGL"));Ke.registerFlag("WEBGL_PACK_NORMALIZATION",()=>Ke.getBool("WEBGL_PACK"));Ke.registerFlag("WEBGL_PACK_CLIP",()=>Ke.getBool("WEBGL_PACK"));Ke.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>Ke.getBool("WEBGL_PACK"));Ke.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>Ke.getBool("WEBGL_PACK"));Ke.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>Ke.getBool("WEBGL_PACK"));Ke.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>Ke.getBool("WEBGL_PACK"));Ke.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>Ke.getBool("WEBGL_PACK"));Ke.registerFlag("WEBGL_PACK_REDUCE",()=>Ke.getBool("WEBGL_PACK"));Ke.registerFlag("WEBGL_LAZILY_UNPACK",()=>Ke.getBool("WEBGL_PACK"));Ke.registerFlag("WEBGL_CONV_IM2COL",()=>Ke.getBool("WEBGL_PACK"));Ke.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>TOe(Ke.getNumber("WEBGL_VERSION")));Ke.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>NOe(Ke.getNumber("WEBGL_VERSION")));Ke.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{const t=Ke.getNumber("WEBGL_VERSION");return t===0?0:IOe(t)});Ke.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>Ke.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!X6());Ke.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>_Oe(Ke.getNumber("WEBGL_VERSION")));Ke.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>Ke.getBool("WEBGL_FORCE_F16_TEXTURES")?!1:Ke.getBool("WEBGL_RENDER_FLOAT32_CAPABLE"));Ke.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>EOe(Ke.getNumber("WEBGL_VERSION")));Ke.registerFlag("WEBGL_FENCE_API_ENABLED",()=>AOe(Ke.getNumber("WEBGL_VERSION")));Ke.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>Ke.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0);Ke.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",()=>-1,t=>{if(t<0&&t!==-1)throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ${t}.`)});Ke.registerFlag("WEBGL_FLUSH_THRESHOLD",()=>X6()?1:-1,t=>{if(t<0&&t!==-1)throw new Error(`WEBGL_FLUSH_THRESHOLD must be -1 (indicating never manual flush) or at least 0, but got ${t}.`)});Ke.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",()=>128);Ke.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",()=>!1);Ke.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",()=>1e5);Ke.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",()=>128);Ke.registerFlag("WEBGL_EXP_CONV",()=>!1);Ke.registerFlag("SOFTWARE_WEBGL_ENABLED",()=>Ke.getBool("IS_TEST"));Ke.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",()=>1/0);Ke.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",()=>!1);Ke.registerFlag("WEBGL2_ISNAN_CUSTOM",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ur(){let t,e,n,s,r,i,o,a,l,c;return oe().getNumber("WEBGL_VERSION")===2?(t="#version 300 es",e="in",n="out",s="in",r="texture",i="outputColor",o="out vec4 outputColor;",a=oe().getBool("WEBGL2_ISNAN_CUSTOM")?`
      bool isnan_custom(float val) {
        uint floatToUint = floatBitsToUint(val);
        return (floatToUint & 0x7fffffffu) > 0x7f800000u;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `:"",l="",c=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(t="",e="attribute",n="varying",s="varying",r="texture2D",i="gl_FragColor",o="",a=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,l=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,c=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:t,attribute:e,varyingVs:n,varyingFs:s,texture2D:r,output:i,defineOutput:o,defineSpecialNaN:a,defineSpecialInf:l,defineRound:c}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wd(t,e,n="index"){const s=Ye(e);return s.map((r,i)=>{const o=`int ${t[i]} = ${n} / ${r}`,a=i===s.length-1?`int ${t[i+1]} = ${n} - ${t[i]} * ${r}`:`index -= ${t[i]} * ${r}`;return`${o}; ${a};`}).join("")}function dk(t,e,n="index"){const s=Ye(e);return s.map((r,i)=>{const o=`int ${t[i]} = ${n} / outShapeStrides[${i}]`,a=i===s.length-1?`int ${t[i+1]} = ${n} - ${t[i]} * outShapeStrides[${i}]`:`index -= ${t[i]} * outShapeStrides[${i}]`;return`${o}; ${a};`}).join("")}function ROe(t,e){const n=t.length,s=t.map(i=>`${e}[${i}]`),r=new Array(n-1);r[n-2]=s[n-1];for(let i=n-3;i>=0;--i)r[i]=`(${r[i+1]} * ${s[i+1]})`;return r}function DOe(t,e,n="index"){const s=t.map((i,o)=>o),r=ROe(s,e);return r.map((i,o)=>{const a=`int ${t[o]} = ${n} / ${r[o]}`,l=o===r.length-1?`int ${t[o+1]} = ${n} - ${t[o]} * ${r[o]}`:`index -= ${t[o]} * ${r[o]}`;return`${a}; ${l};`}).join("")}function _D(t){const e=Ye(t).map(n=>n.toString());return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * ${e[0]} + coords.y * ${e[1]} + coords.z;
  }
`}function ED(){return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;
  }
`}const zX=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{getBroadcastDims:VX}=mSe;function OOe(t,e,n){const s=[];if(t.forEach(f=>{const p=le(f.shapeInfo.logicalShape);if(f.shapeInfo.isUniform?s.push(`uniform float ${f.name}${p>1?`[${p}]`:""};`):(s.push(`uniform sampler2D ${f.name};`),s.push(`uniform int offset${f.name};`)),n.enableShapeUniforms){const{uniformShape:m}=$D(n.packedInputs,f.shapeInfo.logicalShape,f.shapeInfo.texShape);switch(m.length){case 1:s.push(`uniform int ${f.name}Shape;`);break;case 2:s.push(`uniform ivec2 ${f.name}Shape;`);break;case 3:s.push(`uniform ivec3 ${f.name}Shape;`);break;case 4:s.push(`uniform ivec4 ${f.name}Shape;`);break}s.push(`uniform ivec2 ${f.name}TexShape;`)}}),n.enableShapeUniforms){switch(e.logicalShape.length){case 1:s.push("uniform int outShape;");break;case 2:s.push("uniform ivec2 outShape;"),s.push("uniform int outShapeStrides;");break;case 3:s.push("uniform ivec3 outShape;"),s.push("uniform ivec2 outShapeStrides;");break;case 4:s.push("uniform ivec4 outShape;"),s.push("uniform ivec3 outShapeStrides;");break}s.push("uniform ivec2 outTexShape;")}n.customUniforms&&n.customUniforms.forEach(f=>{s.push(`uniform ${f.type} ${f.name}${f.arrayIndex?`[${f.arrayIndex}]`:""};`)});const r=s.join(`
`),i=t.map(f=>POe(f,e,n.packedInputs,n.enableShapeUniforms)).join(`
`),o=e.texShape,a=ur(),l=MOe(a);let c,u,d=jOe(a);return e.isPacked?(c=FOe(e.logicalShape,o,n.enableShapeUniforms),u=VOe(a)):(c=LOe(e.logicalShape,o,n.enableShapeUniforms),u=zOe(a)),n.packedInputs&&(d+=HOe),[d,l,u,r,c,i,n.userCode].join(`
`)}function pp(t,e=!1){const n=t.shapeInfo.logicalShape;switch(n.length){case 0:return sPe(t,e);case 1:return iPe(t,e);case 2:return aPe(t,e);case 3:return cPe(t,e);case 4:return dPe(t,e);case 5:return hPe(t);case 6:return fPe(t);default:throw new Error(`${n.length}-D input sampling is not yet supported`)}}function jX(t,e){switch(t.shapeInfo.logicalShape.length){case 0:return nPe(t);case 1:return rPe(t,e);case 2:return oPe(t,e);case 3:return lPe(t,e);default:return uPe(t,e)}}function POe(t,e,n=!1,s){let r="";n?r+=jX(t,s):r+=pp(t,s);const i=t.shapeInfo.logicalShape,o=e.logicalShape;return i.length<=o.length&&(n?r+=pPe(t,e):r+=mPe(t,e)),r}function FOe(t,e,n){switch(t.length){case 0:return BX();case 1:return GOe(t,e,n);case 2:return ePe(t,e,n);case 3:return qOe(t,e,n);default:return YOe(t,e,n)}}function LOe(t,e,n){switch(t.length){case 0:return BX();case 1:return KOe(t,e,n);case 2:return tPe(t,e,n);case 3:return XOe(t,e,n);case 4:return ZOe(t,e,n);case 5:return QOe(t,e);case 6:return JOe(t,e);default:throw new Error(`${t.length}-D output sampling is not yet supported`)}}function MOe(t){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return ${t.texture2D}(textureSampler, uv).r;
    }
  `}function zOe(t){return`
    void setOutput(float val) {
      ${t.output} = vec4(val, 0, 0, 0);
    }
  `}function VOe(t){return`
    void setOutput(vec4 val) {
      ${t.output} = val;
    }
  `}function jOe(t){return`${t.version}
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    ${t.varyingFs} vec2 resultUV;
    ${t.defineOutput}
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    ${t.defineSpecialNaN}
    ${t.defineSpecialInf}
    ${t.defineRound}

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    ${BOe}
    ${WOe}
    ${UOe}
  `}const BOe=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,WOe=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,UOe=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,HOe=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function BX(){return`
    int getOutputCoords() {
      return 0;
    }
  `}function GOe(t,e,n){const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];return s[0]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ${s[1]}.0);
      }
    `:s[1]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ${s[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));
      return 2 * (resTexRC.x * ${s[1]} + resTexRC.y);
    }
  `}function KOe(t,e,n){return e[0]===1?n?`
      int getOutputCoords() {
        return int(resultUV.x * float(outTexShape[1]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.x * ${e[1]}.0);
      }
    `:e[1]===1?n?`
      int getOutputCoords() {
        return int(resultUV.y * float(outTexShape[0]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.y * ${e[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      return resTexRC.x * outTexShape[1] + resTexRC.y;
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      return resTexRC.x * ${e[1]} + resTexRC.y;
    }
  `}function qOe(t,e,n){if(n)return`
    ivec3 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec3(b, r, c);
    }
  `;const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],r=Math.ceil(t[2]/2),i=r*Math.ceil(t[1]/2);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));
      int index = resTexRC.x * ${s[1]} + resTexRC.y;

      int b = index / ${i};
      index -= b * ${i};

      int r = 2 * (index / ${r});
      int c = imod(index, ${r}) * 2;

      return ivec3(b, r, c);
    }
  `}function XOe(t,e,n){if(n)return`
  ivec3 getOutputCoords() {
    ivec2 resTexRC = ivec2(resultUV.yx *
                           vec2(outTexShape[0], outTexShape[1]));
    int index = resTexRC.x * outTexShape[1] + resTexRC.y;
    ${dk(["r","c","d"],t)}
    return ivec3(r, c, d);
  }
`;const s=Wd(["r","c","d"],t);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${s}
      return ivec3(r, c, d);
    }
  `}function YOe(t,e,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatchN = texelsInBatch * outShape[1];

      int b2 = index / texelsInBatchN;
      index -= b2 * texelsInBatchN;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec4(b2, b, r, c);
    }
  `;const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],r=Math.ceil(t[t.length-1]/2),i=r*Math.ceil(t[t.length-2]/2);let o=i,a="",l="b, r, c";for(let c=2;c<t.length-1;c++)o*=t[t.length-c-1],a=`
      int b${c} = index / ${o};
      index -= b${c} * ${o};
    `+a,l=`b${c}, `+l;return`
    ivec${t.length} getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));
      int index = resTexRC.x * ${s[1]} + resTexRC.y;

      ${a}

      int b = index / ${i};
      index -= b * ${i};

      int r = 2 * (index / ${r});
      int c = imod(index, ${r}) * 2;

      return ivec${t.length}(${l});
    }
  `}function ZOe(t,e,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      ${dk(["r","c","d","d2"],t)}
      return ivec4(r, c, d, d2);
    }
  `;const s=Wd(["r","c","d","d2"],t);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${s}
      return ivec4(r, c, d, d2);
    }
  `}function QOe(t,e){const n=Wd(["r","c","d","d2","d3"],t);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(${e[0]},
                             ${e[1]}));

      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${n}

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}function JOe(t,e){const n=Wd(["r","c","d","d2","d3","d4"],t);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${n}

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}function ePe(t,e,n){const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];if(Et(t,e))return n?`
      ivec2 getOutputCoords() {
        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(${s[0]}, ${s[1]}));
      }
    `;const r=Math.ceil(t[1]/2);return n?`
    ivec2 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));

      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;
      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));

      int index = resTexRC.x * ${s[1]} + resTexRC.y;
      int r = 2 * (index / ${r});
      int c = imod(index, ${r}) * 2;

      return ivec2(r, c);
    }
  `}function tPe(t,e,n){return Et(t,e)?n?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(${e[0]}, ${e[1]}));
      }
    `:t[1]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(index, 0);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(index, 0);
      }
    `:t[0]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(0, index);
      }
    `:n?`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      int r = index / outShape[1];
      int c = index - r * outShape[1];
      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      int r = index / ${t[1]};
      int c = index - r * ${t[1]};
      return ivec2(r, c);
    }
  `}function Ud(t){return`offset${t}`}function nPe(t){const e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1),s=ur();return`
    vec4 ${n}() {
      return ${s.texture2D}(${e}, halfCR);
    }
  `}function sPe(t,e){const n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1);if(t.shapeInfo.isUniform)return`float ${s}() {return ${n};}`;const[r,i]=t.shapeInfo.texShape;if(r===1&&i===1)return`
      float ${s}() {
        return sampleTexture(${n}, halfCR);
      }
    `;const o=Ud(n);if(e)return`
    float ${s}() {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], ${o});
      return sampleTexture(${n}, uv);
    }
  `;const[a,l]=t.shapeInfo.texShape;return`
    float ${s}() {
      vec2 uv = uvFromFlat(${a}, ${l}, ${o});
      return sampleTexture(${n}, uv);
    }
  `}function rPe(t,e){const n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1),r=t.shapeInfo.texShape,i=ur();if(e)return`
    vec4 ${s}(int index) {
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      vec2 uv = packedUVfrom1D(
        packedTexShape[0], packedTexShape[1], index);
      return ${i.texture2D}(${n}, uv);
    }
  `;const o=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)];return`
    vec4 ${s}(int index) {
      vec2 uv = packedUVfrom1D(
        ${o[0]}, ${o[1]}, index);
      return ${i.texture2D}(${n}, uv);
    }
  `}function iPe(t,e){const n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1);if(t.shapeInfo.isUniform)return`
      float ${s}(int index) {
        ${mp(t)}
      }
    `;const r=t.shapeInfo.texShape,i=r[0],o=r[1];if(o===1&&i===1)return`
      float ${s}(int index) {
        return sampleTexture(${n}, halfCR);
      }
    `;const a=Ud(n);return o===1?e?`
      float ${s}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${a}) + 0.5) / float(${n}TexShape[0]));
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${s}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${a}) + 0.5) / ${i}.0);
        return sampleTexture(${n}, uv);
      }
    `:i===1?e?`
      float ${s}(int index) {
        vec2 uv = vec2((float(index + ${a}) + 0.5) / float(${n}TexShape[1]), 0.5);
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${s}(int index) {
        vec2 uv = vec2((float(index + ${a}) + 0.5) / ${o}.0, 0.5);
        return sampleTexture(${n}, uv);
      }
    `:e?`
    float ${s}(int index) {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], index + ${a});
      return sampleTexture(${n}, uv);
    }
  `:`
    float ${s}(int index) {
      vec2 uv = uvFromFlat(${i}, ${o}, index + ${a});
      return sampleTexture(${n}, uv);
    }
  `}function oPe(t,e){const n=t.shapeInfo.logicalShape,s=t.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),i=t.shapeInfo.texShape,o=i[0],a=i[1],l=ur();if(i!=null&&Et(n,i))return e?`
      vec4 ${r}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${s}TexShape[1], ${s}TexShape[0]);

        return ${l.texture2D}(${s}, uv);
      }
    `:`
      vec4 ${r}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${a}.0, ${o}.0);

        return ${l.texture2D}(${s}, uv);
      }
    `;if(e)return`
    vec4 ${r}(int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${s}TexShape[0]) / 2.0), ceil(float(${s}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${s}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);
      return ${l.texture2D}(${s}, uv);
    }
  `;const c=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)],u=Math.ceil(n[1]/2);return`
    vec4 ${r}(int row, int col) {
      vec2 uv = packedUVfrom2D(${u}, ${c[0]}, ${c[1]}, row, col);
      return ${l.texture2D}(${s}, uv);
    }
  `}function aPe(t,e){const n=t.shapeInfo.logicalShape,s=t.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),i=t.shapeInfo.texShape;if(i!=null&&Et(n,i)){if(e)return`
      float ${r}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `;const h=i[0],f=i[1];return`
    float ${r}(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(${f}.0, ${h}.0);
      return sampleTexture(${s}, uv);
    }
  `}const{newShape:o,keptDims:a}=eu(n),l=o;if(l.length<n.length){const h=gp(t,l),f=["row","col"];return`
      ${pp(h,e)}
      float ${r}(int row, int col) {
        return ${r}(${yp(f,a)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${r}(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(${n[1]}, 1)));
        ${mp(t)}
      }
    `;const c=i[0],u=i[1],d=Ud(s);return u===1?e?`
      float ${r}(int row, int col) {
        float index = dot(vec3(row, col, ${d}), vec3(${s}Shape[1], 1, 1));
        vec2 uv = vec2(0.5, (index + 0.5) / float(${s}TexShape[0]));
        return sampleTexture(${s}, uv);
      }
    `:`
    float ${r}(int row, int col) {
      float index = dot(vec3(row, col, ${d}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / ${c}.0);
      return sampleTexture(${s}, uv);
    }
  `:c===1?e?`
      float ${r}(int row, int col) {
        float index = dot(vec3(row, col, ${d}), vec3(${s}Shape[1], 1, 1));
        vec2 uv = vec2((index + 0.5) / float(${s}TexShape[1]), 0.5);
        return sampleTexture(${s}, uv);
      }
    `:`
    float ${r}(int row, int col) {
      float index = dot(vec3(row, col, ${d}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2((index + 0.5) / ${u}.0, 0.5);
      return sampleTexture(${s}, uv);
    }
  `:e?`
      float ${r}(int row, int col) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${s}Shape[1] + col + ${d};
        vec2 uv = uvFromFlat(${s}TexShape[0], ${s}TexShape[1], index);
        return sampleTexture(${s}, uv);
      }
    `:`
  float ${r}(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * ${n[1]} + col + ${d};
    vec2 uv = uvFromFlat(${c}, ${u}, index);
    return sampleTexture(${s}, uv);
  }
`}function lPe(t,e){const n=t.shapeInfo.logicalShape,s=t.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),i=t.shapeInfo.texShape,o=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)];if(n[0]===1){const h=n.slice(1),f=[1,2],p=gp(t,h),m=["b","row","col"];return`
        ${jX(p,e)}
        vec4 ${r}(int b, int row, int col) {
          return ${r}(${yp(m,f)});
        }
      `}const a=ur();if(e)return`
    vec4 ${r}(int b, int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${s}TexShape[0]) / 2.0), ceil(float(${s}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${s}Shape[2]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${s}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom3D(
        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);
      return ${a.texture2D}(${s}, uv);
    }
  `;const l=o[0],c=o[1],u=Math.ceil(n[2]/2),d=u*Math.ceil(n[1]/2);return`
    vec4 ${r}(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        ${l}, ${c}, ${d}, ${u}, b, row, col);
      return ${a.texture2D}(${s}, uv);
    }
  `}function cPe(t,e){const n=t.shapeInfo.logicalShape,s=t.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),i=n[1]*n[2],o=n[2],{newShape:a,keptDims:l}=eu(n),c=a;if(c.length<n.length){const m=gp(t,c),g=["row","col","depth"];return`
        ${pp(m,e)}
        float ${r}(int row, int col, int depth) {
          return ${r}(${yp(g,l)});
        }
      `}if(t.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(${i}, ${o}, 1)));
        ${mp(t)}
      }
    `;const u=t.shapeInfo.texShape,d=u[0],h=u[1],f=t.shapeInfo.flatOffset;if(h===i&&f==null)return e?`
      float ${r}(int row, int col, int depth) {
        int stride1 = ${s}Shape[2];
        float texR = float(row);
        float texC = dot(vec2(col, depth), vec2(stride1, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
        float ${r}(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(${o}, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(${h}.0, ${d}.0);
          return sampleTexture(${s}, uv);
        }
      `;if(h===o&&f==null)return e?`
      float ${r}(int row, int col, int depth) {
        float texR = dot(vec2(row, col), vec2(${s}Shape[1], 1));
        float texC = float(depth);
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
    float ${r}(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(${n[1]}, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${h}.0, ${d}.0);
      return sampleTexture(${s}, uv);
    }
  `;const p=Ud(s);return e?`
    float ${r}(int row, int col, int depth) {
      // Explicitly use integer operations as dot() only works on floats.
      int stride0 = ${s}Shape[1] * ${s}Shape[2];
      int stride1 = ${s}Shape[2];
      int index = row * stride0 + col * stride1 + depth + ${p};
      vec2 uv = uvFromFlat(${s}TexShape[0], ${s}TexShape[1], index);
      return sampleTexture(${s}, uv);
    }
    `:`
      float ${r}(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${i} + col * ${o} + depth + ${p};
        vec2 uv = uvFromFlat(${d}, ${h}, index);
        return sampleTexture(${s}, uv);
      }
  `}function uPe(t,e){const n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1),r=ur();if(e)return`
    vec4 ${s}(int b2, int b, int row, int col) {
      int valuesPerRow = int(ceil(float(${n}Shape[3]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${n}Shape[2]) / 2.0));
      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);
      texelsInBatch *= ${n}Shape[1];
      index = b2 * texelsInBatch + index;
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      int texR = index / packedTexShape[1];
      int texC = index - texR * packedTexShape[1];
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ${r.texture2D}(${n}, uv);
    }
  `;const i=t.shapeInfo.logicalShape,o=i.length,a=t.shapeInfo.texShape,l=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)],c=l[0],u=l[1],d=Math.ceil(i[o-1]/2);let h=d*Math.ceil(i[o-2]/2),f="int b, int row, int col",p=`b * ${h} + (row / 2) * ${d} + (col / 2)`;for(let m=2;m<o-1;m++)f=`int b${m}, `+f,h*=i[o-m-1],p=`b${m} * ${h} + `+p;return`
    vec4 ${s}(${f}) {
      int index = ${p};
      int texR = index / ${u};
      int texC = index - texR * ${u};
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${u}, ${c});
      return ${r.texture2D}(${n}, uv);
    }
  `}function dPe(t,e){const n=t.shapeInfo.logicalShape,s=t.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),i=n[3],o=n[2]*i,a=n[1]*o,{newShape:l,keptDims:c}=eu(n);if(l.length<n.length){const x=gp(t,l),v=["row","col","depth","depth2"];return`
      ${pp(x,e)}
      float ${r}(int row, int col, int depth, int depth2) {
        return ${r}(${yp(v,c)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(${a}, ${o}, ${i}, 1)));
        ${mp(t)}
      }
    `;const u=t.shapeInfo.flatOffset,d=t.shapeInfo.texShape,h=d[0],f=d[1],p=`int stride2 = ${s}Shape[3];`,m=`int stride1 = ${s}Shape[2] * stride2;`,g=`int stride0 = ${s}Shape[1] * stride1;`;if(f===a&&u==null)return e?`
      float ${r}(int row, int col, int depth, int depth2) {
        ${p}
        ${m}
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(stride1, stride2, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
      float ${r}(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(${o}, ${i}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${f}.0, ${h}.0);
        return sampleTexture(${s}, uv);
      }
    `;if(f===i&&u==null)return e?`
      float ${r}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${s}Shape[1] * ${s}Shape[2], ${s}Shape[2], 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
      float ${r}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${n[1]*n[2]}, ${n[2]}, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${f}.0, ${h}.0);
        return sampleTexture(${s}, uv);
      }
    `;const y=Ud(s);return e?`
    float ${r}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      ${p}
      ${m}
      ${g}
      int index = row * stride0 + col * stride1 +
          depth * stride2 + depth2;
      vec2 uv = uvFromFlat(${s}TexShape[0], ${s}TexShape[1], index + ${y});
      return sampleTexture(${s}, uv);
    }
  `:`
    float ${r}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${a} + col * ${o} +
          depth * ${i} + depth2;
      vec2 uv = uvFromFlat(${h}, ${f}, index + ${y});
      return sampleTexture(${s}, uv);
    }
  `}function hPe(t){const e=t.shapeInfo.logicalShape,n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1),r=e[4],i=e[3]*r,o=e[2]*i,a=e[1]*o,{newShape:l,keptDims:c}=eu(e);if(l.length<e.length){const m=gp(t,l),g=["row","col","depth","depth2","depth3"];return`
      ${pp(m)}
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        return ${s}(${yp(g,c)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(${a}, ${o}, ${i}, ${r})) +
          depth3;
        ${mp(t)}
      }
    `;const u=t.shapeInfo.flatOffset,d=t.shapeInfo.texShape,h=d[0],f=d[1];if(f===a&&u==null)return`
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(${o}, ${i}, ${r}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${f}.0, ${h}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(f===r&&u==null)return`
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]},
               ${e[2]*e[3]}, ${e[3]}, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${f}.0, ${h}.0);
        return sampleTexture(${n}, uv);
      }
    `;const p=Ud(n);return`
    float ${s}(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${a} + col * ${o} + depth * ${i} +
          depth2 * ${r} + depth3 + ${p};
      vec2 uv = uvFromFlat(${h}, ${f}, index);
      return sampleTexture(${n}, uv);
    }
  `}function fPe(t){const e=t.shapeInfo.logicalShape,n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1),{newShape:r,keptDims:i}=eu(e);if(r.length<e.length){const g=gp(t,r),y=["row","col","depth","depth2","depth3","depth4"];return`
      ${pp(g)}
      float ${s}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return ${s}(${yp(y,i)});
      }
    `}const o=e[5],a=e[4]*o,l=e[3]*a,c=e[2]*l,u=e[1]*c;if(t.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(${u}, ${c}, ${l}, ${a})) +
          dot(
            vec2(depth3, depth4),
            vec2(${o}, 1)));
        ${mp(t)}
      }
    `;const d=t.shapeInfo.flatOffset,h=t.shapeInfo.texShape,f=h[0],p=h[1];if(p===u&&d==null)return`
      float ${s}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(${c}, ${l}, ${a}, ${o})) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${p}.0, ${f}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(p===o&&d==null)return`
      float ${s}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]*e[4]},
               ${e[2]*e[3]*e[4]},
               ${e[3]*e[4]},
               ${e[4]})) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${p}.0, ${f}.0);
        return sampleTexture(${n}, uv);
      }
    `;const m=Ud(n);return`
    float ${s}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${u} + col * ${c} + depth * ${l} +
          depth2 * ${a} + depth3 * ${o} + depth4 + ${m};
      vec2 uv = uvFromFlat(${f}, ${p}, index);
      return sampleTexture(${n}, uv);
    }
  `}function mp(t){const e=t.name,n=le(t.shapeInfo.logicalShape);return n<2?`return ${e};`:`
    for (int i = 0; i < ${n}; i++) {
      if (i == index) {
        return ${e}[i];
      }
    }
  `}function pPe(t,e){const n=t.name,s=n.charAt(0).toUpperCase()+n.slice(1),r="get"+s+"AtOutCoords",i=t.shapeInfo.logicalShape.length,o=e.logicalShape.length,a=VX(t.shapeInfo.logicalShape,e.logicalShape),l=sn(o),c=o-i;let u;const d=["x","y","z","w","u","v"];i===0?u="":o<2&&a.length>=1?u="coords = 0;":u=a.map(x=>`coords.${d[x+c]} = 0;`).join(`
`);let h="";o<2&&i>0?h="coords":h=t.shapeInfo.logicalShape.map((x,v)=>`coords.${d[v+c]}`).join(", ");let f="return outputValue;";const m=le(t.shapeInfo.logicalShape)===1,y=le(e.logicalShape)===1;if(i===1&&!m&&!y)f=`
      return vec4(outputValue.xy, outputValue.xy);
    `;else if(m&&!y)o===1?f=`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:f=`
        return vec4(outputValue.x);
      `;else if(a.length){const x=i-2,v=i-1;a.indexOf(x)>-1&&a.indexOf(v)>-1?f="return vec4(outputValue.x);":a.indexOf(x)>-1?f="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":a.indexOf(v)>-1&&(f="return vec4(outputValue.xx, outputValue.zz);")}return`
    vec4 ${r}() {
      ${l} coords = getOutputCoords();
      ${u}
      vec4 outputValue = get${s}(${h});
      ${f}
    }
  `}function mPe(t,e){const n=t.name,s=n.charAt(0).toUpperCase()+n.slice(1),r="get"+s+"AtOutCoords",i=e.texShape,o=t.shapeInfo.texShape,a=t.shapeInfo.logicalShape.length,l=e.logicalShape.length;if(!t.shapeInfo.isUniform&&a===l&&t.shapeInfo.flatOffset==null&&Et(o,i))return`
      float ${r}() {
        return sampleTexture(${n}, resultUV);
      }
    `;const c=sn(l),u=VX(t.shapeInfo.logicalShape,e.logicalShape),d=l-a;let h;const f=["x","y","z","w","u","v"];a===0?h="":l<2&&u.length>=1?h="coords = 0;":h=u.map(m=>`coords.${f[m+d]} = 0;`).join(`
`);let p="";return l<2&&a>0?p="coords":p=t.shapeInfo.logicalShape.map((m,g)=>`coords.${f[g+d]}`).join(", "),`
    float ${r}() {
      ${c} coords = getOutputCoords();
      ${h}
      return get${s}(${p});
    }
  `}function sn(t){if(t<=1)return"int";if(t===2)return"ivec2";if(t===3)return"ivec3";if(t===4)return"ivec4";if(t===5)return"ivec5";if(t===6)return"ivec6";throw Error(`GPU for rank ${t} is not yet supported`)}function $D(t,e,n){const{newShape:s,keptDims:r}=eu(e),i=e.length,o=t&&i===3&&e[0]===1,a=o?e.slice(1):s,l=!t&&i>1&&!Et(e,n)&&s.length<i||o;return{useSqueezeShape:l,uniformShape:l?a:e,keptDims:r}}function gp(t,e){const n=JSON.parse(JSON.stringify(t));return n.shapeInfo.logicalShape=e,n}function yp(t,e){return e.map(n=>t[n]).join(", ")}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gPe(t,e,n,s){const r=n.map((u,d)=>{const h={logicalShape:u.shape,texShape:u.isUniform?null:u.texData.texShape,isUniform:u.isUniform,isPacked:u.isUniform?!1:u.texData.isPacked,flatOffset:null};return u.texData!=null&&u.texData.slice!=null&&u.texData.slice.flatOffset>0&&(h.flatOffset=u.texData.slice.flatOffset),{name:e.variableNames[d],shapeInfo:h}}),i=r.map(u=>u.shapeInfo),o={logicalShape:s.shape,texShape:s.texData.texShape,isUniform:!1,isPacked:s.texData.isPacked,flatOffset:null},a=OOe(r,o,e),l=cOe(t.gl,a),c=t.createProgram(l);return oe().get("ENGINE_COMPILE_ONLY")?{program:e,fragmentShader:l,source:a,webGLProgram:c,inShapeInfos:i,outShapeInfo:o,uniformLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,inShapesLocations:null,inTexShapesLocations:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:Object.assign({program:e,fragmentShader:l,source:a,webGLProgram:c,inShapeInfos:i,outShapeInfo:o},WX(t,e,c))}function WX(t,e,n){const s={},r={},i={},o=[];let a,l,c,u=null,d=null;d=t.getUniformLocation(n,"NAN",!1),oe().getNumber("WEBGL_VERSION")===1&&(u=t.getUniformLocation(n,"INFINITY",!1));const h=!1;for(let f=0;f<e.variableNames.length;f++){const p=e.variableNames[f];s[p]=t.getUniformLocation(n,p,h),s[`offset${p}`]=t.getUniformLocation(n,`offset${p}`,h),e.enableShapeUniforms&&(r[`${p}Shape`]=t.getUniformLocation(n,`${p}Shape`,h),i[`${p}TexShape`]=t.getUniformLocation(n,`${p}TexShape`,h))}return e.enableShapeUniforms&&(a=t.getUniformLocation(n,"outShape",h),c=t.getUniformLocation(n,"outShapeStrides",h),l=t.getUniformLocation(n,"outTexShape",h)),e.customUniforms&&e.customUniforms.forEach((f,p)=>{o[p]=t.getUniformLocation(n,f.name,h)}),{uniformLocations:s,customUniformLocations:o,infLoc:u,nanLoc:d,inShapesLocations:r,inTexShapesLocations:i,outShapeLocation:a,outShapeStridesLocation:c,outTexShapeLocation:l}}function hV(t,e){if(t.length!==e.length)throw Error(`Binary was compiled with ${t.length} inputs, but was executed with ${e.length} inputs`);t.forEach((n,s)=>{const r=n.logicalShape,i=e[s],o=i.shape;if(!Et(r,o))throw Error(`Binary was compiled with different shapes than the current args. Shapes ${r} and ${o} must match`);if(n.isUniform&&i.isUniform)return;const a=n.texShape,l=i.isUniform?null:i.texData.texShape;if(!Et(a,l))throw Error(`Binary was compiled with different texture shapes than the current args. Shape ${a} and ${l} must match`)})}function yPe(t,e,n,s,r){e.program.enableShapeUniforms||(hV(e.inShapeInfos,n),hV([e.outShapeInfo],[s]));const i=s.texData.texture,o=s.texData.texShape;s.texData.isPacked?t.setOutputPackedMatrixTexture(i.texture,o[0],o[1]):t.setOutputMatrixTexture(i.texture,o[0],o[1]),t.setProgram(e.webGLProgram),oe().getNumber("WEBGL_VERSION")===1&&e.infLoc!==null&&t.gl.uniform1f(e.infLoc,1/0),e.nanLoc!==null&&t.gl.uniform1f(e.nanLoc,NaN),n.forEach((l,c)=>{const u=e.program.variableNames[c],d=e.uniformLocations[u],h=e.uniformLocations[`offset${u}`],f=e.inShapesLocations[`${u}Shape`],p=e.inTexShapesLocations[`${u}TexShape`];if(f){const{uniformShape:m}=$D(e.program.packedInputs,l.shape,l.texData.texShape);switch(m.length){case 1:t.gl.uniform1iv(f,new Int32Array(m));break;case 2:t.gl.uniform2iv(f,new Int32Array(m));break;case 3:t.gl.uniform3iv(f,new Int32Array(m));break;case 4:t.gl.uniform4iv(f,new Int32Array(m));break}}if(p&&t.gl.uniform2i(p,l.texData.texShape[0],l.texData.texShape[1]),d!=null){if(l.isUniform){if(le(l.shape)<2)t.gl.uniform1f(d,l.uniformValues[0]);else{let m=l.uniformValues;m instanceof Float32Array||(m=new Float32Array(m)),t.gl.uniform1fv(d,m)}return}l.texData.slice!=null&&h!=null&&t.gl.uniform1i(h,l.texData.slice.flatOffset),t.setInputMatrixTexture(l.texData.texture.texture,d,c)}});const a=e.outShapeLocation;if(a)switch(s.shape.length){case 1:t.gl.uniform1iv(a,new Int32Array(s.shape));break;case 2:t.gl.uniform2iv(a,new Int32Array(s.shape));break;case 3:t.gl.uniform3iv(a,new Int32Array(s.shape));break;case 4:t.gl.uniform4iv(a,new Int32Array(s.shape));break}if(e.outShapeStridesLocation){const l=Ye(s.shape);switch(s.shape.length){case 2:t.gl.uniform1iv(e.outShapeStridesLocation,new Int32Array(l));break;case 3:t.gl.uniform2iv(e.outShapeStridesLocation,new Int32Array(l));break;case 4:t.gl.uniform3iv(e.outShapeStridesLocation,new Int32Array(l));break}}e.outTexShapeLocation&&t.gl.uniform2i(e.outTexShapeLocation,s.texData.texShape[0],s.texData.texShape[1]),e.program.customUniforms&&r&&e.program.customUniforms.forEach((l,c)=>{const u=e.customUniformLocations[c],d=r[c];if(l.type==="float")t.gl.uniform1fv(u,d);else if(l.type==="vec2")t.gl.uniform2fv(u,d);else if(l.type==="vec3")t.gl.uniform3fv(u,d);else if(l.type==="vec4")t.gl.uniform4fv(u,d);else if(l.type==="int")t.gl.uniform1iv(u,d);else if(l.type==="ivec2")t.gl.uniform2iv(u,d);else if(l.type==="ivec3")t.gl.uniform3iv(u,d);else if(l.type==="ivec4")t.gl.uniform4iv(u,d);else throw Error(`uniform type ${l.type} is not supported yet.`)}),t.executeProgram()}function xPe(t,e,n){let s="";e.concat(n).forEach(o=>{const a=o.texData!=null&&o.texData.slice!=null&&o.texData.slice.flatOffset>0;if(t.enableShapeUniforms&&!o.isUniform){const l=o.texData.texShape,{useSqueezeShape:c,uniformShape:u,keptDims:d}=$D(t.packedInputs,o.shape,l);let h="",f="",p="";if(u.length===1&&t.packedInputs){const k=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)];h=`${k[0]>1}_${k[1]>1}`}else if(u.length===2&&!t.packedInputs)f=`${u[0]>1}_${u[1]>1}`;else if(u.length>2&&!t.packedInputs){const k=Ye(u);p=`${k[0]===l[1]}_${k[k.length-1]===l[1]}`}const m=o.shape.length,g=u.length===2&&Et(o.shape,l),y=le(o.shape)===1,x=Df(o.shape,n.shape),v=!t.packedInputs&&m===n.shape.length&&Et(l,n.texData.texShape),b=t.packedInputs||u.length>2?"":`${l[0]>1}_${l[1]>1}`;s+=`${m}_${v}_${c?d:""}_${u.length}_${y}_${x}_${g}_${h}_${f}_${p}_${b}_${a}`}else{const l=o.isUniform?"uniform":o.texData.texShape;s+=`${o.shape}_${l}_${a}`}});const r=t.userCode;let i=t.constructor.name;return i+="_"+s+"_"+r+`${oe().getNumber("WEBGL_VERSION")}`,i}function dr(t){return oe().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&t<=4}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class vPe{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=Pg.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=ur();this.outputShape=e,this.enableShapeUniforms=dr(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?dk(["r","c","d"],e):Wd(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bPe{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=Pg.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=ur();this.outputShape=e,this.enableShapeUniforms=dr(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?dk(["r","c","d"],e):Wd(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class wPe{constructor(e){this.variableNames=["A"],this.outTexUsage=yi.DOWNLOAD;const n=ur();this.outputShape=e,this.userCode=`
      ${zX}

      void main() {
        float x = getAAtOutCoords();
        ${n.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class SPe{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=yi.DOWNLOAD;const n=ur();this.outputShape=e,this.userCode=`
      ${zX}

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        ${n.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class kPe{constructor(e,n=!1){this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];const s=ur();this.outputShape=e,this.enableShapeUniforms=dr(this.outputShape.length);let r="result";n&&(r="floor(result * 255. + 0.5)"),this.userCode=`
      ${this.enableShapeUniforms?ED():_D(e)}

      void main() {
        ivec3 coords = getOutputCoords();

        int flatIndex = getFlatIndex(coords);
        int offset = imod(flatIndex, 4);

        flatIndex = idiv(flatIndex, 4, 1.);

        int r = flatIndex / texShape[1];
        int c = imod(flatIndex, texShape[1]);
        vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
        vec4 values = ${s.texture2D}(A, uv);

        float result;

        if(offset == 0) {
          result = values[0];
        } else if(offset == 1) {
          result = values[1];
        } else if(offset == 2) {
          result = values[2];
        } else {
          result = values[3];
        }

        ${s.output} = vec4(${r}, 0., 0., 0.);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class CPe{constructor(e,n=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];const s=ur();this.outputShape=e,this.enableShapeUniforms=dr(this.outputShape.length);let r="",i="result";n&&(i="floor(result * 255. + 0.5)");for(let o=0;o<=1;o++)for(let a=0;a<=1;a++){const l=o*2+a;r+=`
          localCoords = coords;
          if(localCoords[2] + ${a} < ${this.enableShapeUniforms?"outShape[2]":`${e[2]}`}) {
          localCoords[2] += ${a};
          if (localCoords[1] + ${o} < ${this.enableShapeUniforms?"outShape[1]":`${e[1]}`}) {
            localCoords[1] += ${o};

            flatIndex = getFlatIndex(localCoords);
            offset = imod(flatIndex, 4);

            flatIndex = idiv(flatIndex, 4, 1.);

            int r = flatIndex / texShape[1];
            int c = imod(flatIndex, texShape[1]);
            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
            values = ${s.texture2D}(A, uv);

            if (offset == 0) {
              result[${l}] = values[0];
            } else if (offset == 1) {
              result[${l}] = values[1];
            } else if (offset == 2) {
              result[${l}] = values[2];
            } else {
              result[${l}] = values[3];
            }
          }
        }
        `}this.userCode=`
        ${this.enableShapeUniforms?ED():_D(e)}

        void main() {
          ivec3 coords = getOutputCoords();

          vec4 result = vec4(0.);
          int flatIndex, r, c, offset;
          ivec3 localCoords;
          vec2 uv;
          vec4 values;

          ${r}

          ${s.output} = ${i};
        }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TPe(t){const e=ur(),n=`${e.version}
    precision highp float;
    ${e.attribute} vec3 clipSpacePos;
    ${e.attribute} vec2 uv;
    ${e.varyingVs} vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`;return lOe(t,n)}function NPe(t){const e=new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]);return fOe(t,e)}function IPe(t){const e=new Uint16Array([0,1,2,2,1,3]);return pOe(t,e)}function z0(t,e,n,s,r,i){gOe(e,n);const o=mOe(t),a=t.TEXTURE_2D;return je(t,()=>t.bindTexture(a,o)),je(t,()=>t.texParameteri(a,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE)),je(t,()=>t.texParameteri(a,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)),je(t,()=>t.texParameteri(a,t.TEXTURE_MIN_FILTER,t.NEAREST)),je(t,()=>t.texParameteri(a,t.TEXTURE_MAG_FILTER,t.NEAREST)),oe().getNumber("WEBGL_VERSION")===1?je(t,()=>t.texImage2D(a,0,s,e,n,0,r,i,null)):je(t,()=>t.texStorage2D(a,1,s,e,n)),je(t,()=>t.bindTexture(t.TEXTURE_2D,null)),{texture:o,texShape:[n,e]}}function UX(t){return t.internalFormatFloat}function _Pe(t,e,n,s){const[r,i]=L0(e,n);return z0(t,r,i,UX(s),s.textureFormatFloat,t.FLOAT)}function HX(t){return t.internalFormatHalfFloat}function EPe(t,e,n,s){const[r,i]=L0(e,n);return z0(t,r,i,HX(s),s.textureFormatFloat,s.textureTypeHalfFloat)}function GX(t){return t.downloadTextureFormat}function $Pe(t,e,n,s){const[r,i]=L0(e,n);return z0(t,r,i,GX(s),t.RGBA,t.UNSIGNED_BYTE)}function KX(t){return t.internalFormatPackedFloat}function APe(t,e,n,s){const[r,i]=fp(e,n);return z0(t,r,i,KX(s),t.RGBA,t.FLOAT)}function qX(t){return t.internalFormatPackedHalfFloat}function RPe(t,e,n,s){const[r,i]=fp(e,n);return z0(t,r,i,qX(s),t.RGBA,s.textureTypeHalfFloat)}function DPe(t,e,n){return je(t,()=>t.bindBuffer(t.ARRAY_BUFFER,n)),cV(t,e,"clipSpacePos",n,3,20,0)&&cV(t,e,"uv",n,2,20,12)}function OPe(t,e,n,s,r,i){je(t,()=>t.bindTexture(t.TEXTURE_2D,e));let o,a,l;r instanceof Uint8Array?(o=new Uint8Array(n*s*4),a=t.UNSIGNED_BYTE,l=t.RGBA):(o=new Float32Array(n*s*4),a=t.FLOAT,l=i.internalFormatPackedFloat),o.set(r),oe().getNumber("WEBGL_VERSION")===2?je(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,n,s,t.RGBA,a,o)):je(t,()=>t.texImage2D(t.TEXTURE_2D,0,l,n,s,0,t.RGBA,a,o)),je(t,()=>t.bindTexture(t.TEXTURE_2D,null))}function PPe(t,e,n){je(t,()=>t.bindTexture(t.TEXTURE_2D,e)),n.data instanceof Uint8Array?oe().getNumber("WEBGL_VERSION")===2?je(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,n.width,n.height,t.RGBA,t.UNSIGNED_BYTE,n.data)):je(t,()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,n.width,n.height,0,t.RGBA,t.UNSIGNED_BYTE,n.data)):oe().getNumber("WEBGL_VERSION")===2?je(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,t.RGBA,t.UNSIGNED_BYTE,n)):je(t,()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,n)),je(t,()=>t.bindTexture(t.TEXTURE_2D,null))}function FPe(t,e,n,s){const r=t.createBuffer();je(t,()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,r));const a=4*4*e*n;return je(t,()=>t.bufferData(t.PIXEL_PACK_BUFFER,a,t.STREAM_READ)),je(t,()=>t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,0)),je(t,()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,null)),r}function LPe(t,e,n){const s=t,r=new Float32Array(n);return s.bindBuffer(s.PIXEL_PACK_BUFFER,e),s.getBufferSubData(s.PIXEL_PACK_BUFFER,0,r),s.bindBuffer(s.PIXEL_PACK_BUFFER,null),r}function MPe(t,e,n,s){const[r,i]=L0(e,n),o=4,a=new Uint8Array(tOe(e*n,o));return je(t,()=>t.readPixels(0,0,r,i,s.downloadTextureFormat,t.UNSIGNED_BYTE,a)),new Float32Array(a.buffer)}function zPe(t,e,n,s,r,i,o,a){const l=t,c=new Float32Array(nOe(i,o));return l.bindBuffer(l.PIXEL_PACK_BUFFER,e),l.getBufferSubData(l.PIXEL_PACK_BUFFER,0,c),l.bindBuffer(l.PIXEL_PACK_BUFFER,null),c}function VPe(t,e,n){const s=new Float32Array(e*n*4);return je(t,()=>t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,s)),s}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class pT{constructor(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];const n=oe().getNumber("WEBGL_VERSION");e!=null?(this.gl=e,QDe(n,e)):this.gl=Bo(n);let s="WEBGL_color_buffer_float";const r="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),oe().getNumber("WEBGL_VERSION")===1){const i="OES_texture_float",o="OES_texture_half_float";if(this.textureFloatExtension=Zx(this.gl,i),to(this.gl,o))this.textureHalfFloatExtension=Zx(this.gl,o);else if(oe().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(s),to(this.gl,r))this.colorBufferHalfFloatExtension=Zx(this.gl,r);else if(oe().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(s="EXT_color_buffer_float",to(this.gl,s))this.colorBufferFloatExtension=this.gl.getExtension(s);else if(to(this.gl,r))this.colorBufferHalfFloatExtension=this.gl.getExtension(r);else throw new Error("GL context does not support color renderable floats");this.vertexBuffer=NPe(this.gl),this.indexBuffer=IPe(this.gl),this.framebuffer=yOe(this.gl),this.textureConfig=ID(this.gl,this.textureHalfFloatExtension)}get debug(){return oe().getBool("DEBUG")}dispose(){if(this.disposed)return;this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");const e=this.gl;je(e,()=>e.finish()),je(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,null)),je(e,()=>e.deleteFramebuffer(this.framebuffer)),je(e,()=>e.bindBuffer(e.ARRAY_BUFFER,null)),je(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)),je(e,()=>e.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(e,n){return this.throwIfDisposed(),_Pe(this.gl,e,n,this.textureConfig)}createFloat16MatrixTexture(e,n){return this.throwIfDisposed(),EPe(this.gl,e,n,this.textureConfig)}createUnsignedBytesMatrixTexture(e,n){return this.throwIfDisposed(),$Pe(this.gl,e,n,this.textureConfig)}uploadPixelDataToTexture(e,n){this.throwIfDisposed(),PPe(this.gl,e,n)}uploadDenseMatrixToTexture(e,n,s,r){this.throwIfDisposed(),OPe(this.gl,e,n,s,r,this.textureConfig)}createFloat16PackedMatrixTexture(e,n){return this.throwIfDisposed(),RPe(this.gl,e,n,this.textureConfig)}createPackedMatrixTexture(e,n){return this.throwIfDisposed(),APe(this.gl,e,n,this.textureConfig)}deleteMatrixTexture(e){this.throwIfDisposed(),this.outputTexture===e&&(uV(this.gl,this.framebuffer),this.outputTexture=null),je(this.gl,()=>this.gl.deleteTexture(e))}downloadByteEncodedFloatMatrixFromOutputTexture(e,n,s){return this.downloadMatrixDriver(e,()=>MPe(this.gl,n,s,this.textureConfig))}downloadPackedMatrixFromBuffer(e,n,s,r,i,o){return zPe(this.gl,e,n,s,r,i,o,this.textureConfig)}downloadFloat32MatrixFromBuffer(e,n){return LPe(this.gl,e,n)}createBufferFromTexture(e,n,s){this.bindTextureToFrameBuffer(e);const r=FPe(this.gl,n,s,this.textureConfig);return this.unbindTextureToFrameBuffer(),r}createAndWaitForFence(){const e=this.createFence(this.gl);return this.pollFence(e)}createFence(e){let n,s;if(oe().getBool("WEBGL_FENCE_API_ENABLED")){const r=e,i=r.fenceSync(r.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),s=()=>{const o=r.clientWaitSync(i,0,0);return o===r.ALREADY_SIGNALED||o===r.CONDITION_SATISFIED},n=i}else oe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(n=this.beginQuery(),this.endQuery(),s=()=>this.isQueryAvailable(n,oe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):s=()=>!0;return{query:n,isFencePassed:s}}downloadMatrixFromPackedTexture(e,n,s){return this.downloadMatrixDriver(e,()=>VPe(this.gl,n,s))}createProgram(e){this.throwIfDisposed();const n=this.gl;this.vertexShader==null&&(this.vertexShader=TPe(n));const s=dOe(n);return je(n,()=>n.attachShader(s,this.vertexShader)),je(n,()=>n.attachShader(s,e)),hOe(n,s),this.debug&&cT(n,s),this.vertexAttrsAreBound||(this.setProgram(s),this.vertexAttrsAreBound=DPe(n,this.program,this.vertexBuffer)),s}deleteProgram(e){this.throwIfDisposed(),e===this.program&&(this.program=null),e!=null&&je(this.gl,()=>this.gl.deleteProgram(e))}setProgram(e){this.throwIfDisposed(),this.program=e,this.program!=null&&this.debug&&cT(this.gl,this.program),je(this.gl,()=>this.gl.useProgram(e))}getUniformLocation(e,n,s=!0){return this.throwIfDisposed(),s?vOe(this.gl,e,n):bOe(this.gl,e,n)}getAttributeLocation(e,n){return this.throwIfDisposed(),je(this.gl,()=>this.gl.getAttribLocation(e,n))}getUniformLocationNoThrow(e,n){return this.throwIfDisposed(),this.gl.getUniformLocation(e,n)}setInputMatrixTexture(e,n,s){this.throwIfDisposed(),this.throwIfNoProgram(),wOe(this.gl,e,n,s)}setOutputMatrixTexture(e,n,s){this.setOutputMatrixTextureDriver(e,s,n)}setOutputPackedMatrixTexture(e,n,s){this.throwIfDisposed();const[r,i]=fp(n,s);this.setOutputMatrixTextureDriver(e,r,i)}setOutputMatrixWriteRegion(e,n,s,r){this.setOutputMatrixWriteRegionDriver(s,e,r,n)}setOutputPackedMatrixWriteRegion(e,n,s,r){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){this.program!=null&&cT(this.gl,this.program),Qx(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();const e=this.gl;this.debug&&this.debugValidate(),je(e,()=>e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),je(this.gl,()=>this.gl.finish())}getQueryTimerExtension(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=Zx(this.gl,oe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(oe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const s=this.gl,r=this.getQueryTimerExtensionWebGL2(),i=s.createQuery();return s.beginQuery(r.TIME_ELAPSED_EXT,i),i}const e=this.getQueryTimerExtensionWebGL1(),n=e.createQueryEXT();return e.beginQueryEXT(e.TIME_ELAPSED_EXT,n),n}endQuery(){if(oe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const n=this.gl,s=this.getQueryTimerExtensionWebGL2();n.endQuery(s.TIME_ELAPSED_EXT);return}const e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(e){return await I3(()=>this.disposed||this.isQueryAvailable(e,oe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),this.getQueryTime(e,oe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(e,n){if(n===0)return null;if(n===2){const s=this.gl;return s.getQueryParameter(e,s.QUERY_RESULT)/1e6}else{const s=this.getQueryTimerExtensionWebGL1();return s.getQueryObjectEXT(e,s.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(e,n){if(n===0)return!0;if(n===2){const s=this.gl,r=this.getQueryTimerExtensionWebGL2(),i=s.getQueryParameter(e,s.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),i&&!this.disjoint}else{const s=this.getQueryTimerExtensionWebGL1(),r=s.getQueryObjectEXT(e,s.QUERY_RESULT_AVAILABLE_EXT);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(s.GPU_DISJOINT_EXT)),r&&!this.disjoint}}pollFence(e){return new Promise(n=>{this.addItemToPoll(()=>e.isFencePassed(),()=>n())})}pollItems(){const e=jPe(this.itemsToPoll.map(n=>n.isDoneFn));for(let n=0;n<=e;++n){const{resolveFn:s}=this.itemsToPoll[n];s()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}addItemToPoll(e,n){if(this.itemsToPoll.push({isDoneFn:e,resolveFn:n}),this.itemsToPoll.length>1)return;let s;"setTimeoutCustom"in oe().platform&&(s=oe().platform.setTimeoutCustom.bind(oe().platform)),I3(()=>(this.pollItems(),this.itemsToPoll.length===0),()=>0,null,s)}bindTextureToFrameBuffer(e){this.throwIfDisposed(),uT(this.gl,e,this.framebuffer),this.debug&&Qx(this.gl)}unbindTextureToFrameBuffer(){this.outputTexture!=null?(uT(this.gl,this.outputTexture,this.framebuffer),this.debug&&Qx(this.gl)):uV(this.gl,this.framebuffer)}downloadMatrixDriver(e,n){this.bindTextureToFrameBuffer(e);const s=n();return this.unbindTextureToFrameBuffer(),s}setOutputMatrixTextureDriver(e,n,s){this.throwIfDisposed();const r=this.gl;uT(r,e,this.framebuffer),this.debug&&Qx(r),this.outputTexture=e,je(r,()=>r.viewport(0,0,n,s)),je(r,()=>r.scissor(0,0,n,s))}setOutputMatrixWriteRegionDriver(e,n,s,r){this.throwIfDisposed(),je(this.gl,()=>this.gl.scissor(e,n,s,r))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(this.program==null)throw new Error("No GPU program is currently set.")}}function jPe(t){let e=0;for(;e<t.length&&t[e]();++e);return e-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{addImpl:BPe,bincountImpl:XX,bincountReduceImpl:WPe,castImpl:UPe,ceilImpl:HPe,concatImpl:GPe,equalImpl:KPe,expImpl:qPe,expm1Impl:XPe,floorImpl:YPe,gatherNdImpl:ZPe,gatherV2Impl:QPe,greaterImpl:JPe,greaterEqualImpl:eFe,lessImpl:tFe,lessEqualImpl:nFe,linSpaceImpl:sFe,logImpl:rFe,maxImpl:iFe,maximumImpl:oFe,minimumImpl:aFe,multiplyImpl:lFe,negImpl:cFe,notEqualImpl:uFe,prodImpl:dFe,raggedGatherImpl:hFe,raggedTensorToTensorImpl:fFe,rangeImpl:pFe,rsqrtImpl:mFe,scatterImpl:gFe,sigmoidImpl:yFe,simpleAbsImpl:YX,sliceImpl:xFe,sparseFillEmptyRowsImpl:vFe,sparseReshapeImpl:bFe,sparseSegmentReductionImpl:ZX,sqrtImpl:wFe,stridedSliceImpl:SFe,stringNGramsImpl:kFe,stringSplitImpl:CFe,stringToHashBucketFastImpl:TFe,subImpl:NFe,tileImpl:IFe,topKImpl:_Fe,transposeImpl:AD,uniqueImpl:EFe}=M_e;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QX(t,e){return["x","y","z","w","u","v"].slice(0,e).map(n=>`${t}.${n}`)}function ir(t,e){return e===1?[t]:QX(t,e)}function $Fe(t,e){if(t===1)return"rc";let n="";for(let s=0;s<t;s++)n+=e[s],s<t-1&&(n+=",");return n}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class AFe{constructor(e){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.enableShapeUniforms=dr(this.outputShape.length),this.rank===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{const n=ir("rc",this.rank),s=sn(this.rank),r=this.getOutOfBoundsCondition(n),i=this.getSetup(n),o=this.getOutput(n);this.userCode=`
        void main() {
          ${s} rc = getOutputCoords();

          if(${r}) {
            setOutput(vec4(0));
          } else {
            ${i}

            setOutput(vec4(${o}));
          }
        }
      `}}getSourceCoordsArr(e){const n=[];for(let s=0;s<=1;s++)for(let r=0;r<=1;r++){let i=`${s===0?"r":"rp1"}, ${r===0?"c":"cp1"}`;for(let o=2;o<this.rank;o++)i=`${e[e.length-1-o]},`+i;n.push(i)}return n}getOutOfBoundsCondition(e){if(this.rank===1)return`rc > ${this.enableShapeUniforms?"outShape":this.outputShape[0]}`;let n="";for(let s=this.rank-2;s<this.rank;s++)n+=`${e[s]} >= ${this.enableShapeUniforms?`outShape[${s}]`:this.outputShape[s]}`,s<this.rank-1&&(n+="||");return n}getSetup(e){if(this.rank===1)return"";const n=e.slice(-2),s=this.enableShapeUniforms?`outShape[${this.rank} - 1]`:this.outputShape[this.rank-1],r=this.enableShapeUniforms?`outShape[${this.rank} - 2]`:this.outputShape[this.rank-2];return`
      int r = ${n[0]};
      int c = ${n[1]};
      int rp1 = r + 1;
      int cp1 = c + 1;

      bool cEdge = cp1 >= ${s};
      bool rEdge = rp1 >= ${r};
    `}getOutput(e){const n=this.getSourceCoordsArr(e);return this.rank===1?`getA(rc), (rc + 1 >= ${this.enableShapeUniforms?"outShape":this.outputShape[0]} ? 0. : getA(rc + 1)), 0, 0`:`getA(${n[0]}),
            cEdge ? 0. : getA(${n[1]}),
            rEdge ? 0. : getA(${n[2]}),
            rEdge || cEdge ? 0. : getA(${n[3]})`}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class JX{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=e,this.enableShapeUniforms=dr(this.outputShape.length);let s="";for(let r=0;r<4;r++){let i="thisRC = rc;";r%2===1&&(i+="thisRC.z += 1;"),r>1&&(i+="thisRC.y += 1;"),s+=`
        ${i}
        ${r>0?"if(thisRC.y < rows && thisRC.z < cols){":""}
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[${r}] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        ${r>0?"}":""}
      `}this.userCode=`
      ${RFe(n,this.enableShapeUniforms)}
      ${this.enableShapeUniforms?ED():_D(e)}

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = ${this.enableShapeUniforms?"outShape[1]":e[1]};
        int cols = ${this.enableShapeUniforms?"outShape[2]":e[2]};

        ${s}

        setOutput(result);
      }
    `}}function RFe(t,e){return`
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      ${e?DOe(["r","c","d"],"inputShape"):Wd(["r","c","d"],t)}
      return ivec3(r, c, d);
    }
  `}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class DFe{constructor(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}acquireTexture(e,n,s){const r=pV(n,s),i=mV(e,r,s);i in this.freeTextures||(this.freeTextures[i]=[]),i in this.usedTextures||(this.usedTextures[i]=[]);const o=fV(e,r,this.gpgpu.gl,this.gpgpu.textureConfig,s);if(this.freeTextures[i].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=o,this.log();const l=this.freeTextures[i].shift();return this.usedTextures[i].push(l),l}let a;return r===Ds.PACKED_2X2_FLOAT32?a=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):r===Ds.PACKED_2X2_FLOAT16?a=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):r===Ds.UNPACKED_FLOAT32?a=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):r===Ds.UNPACKED_FLOAT16?a=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):r===Ds.PACKED_4X1_UNSIGNED_BYTE&&(a=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[i].push(a),this.numUsedTextures++,this._numBytesAllocated+=o,this.log(),a}releaseTexture(e,n,s,r){if(this.freeTextures==null)return;const i=pV(s,r),o=mV(n,i,r);o in this.freeTextures||(this.freeTextures[o]=[]);const a=fV(n,i,this.gpgpu.gl,this.gpgpu.textureConfig,r),l=oe().get("WEBGL_DELETE_TEXTURE_THRESHOLD");l!==-1&&this._numBytesAllocated>l?(this.gpgpu.deleteMatrixTexture(e.texture),this._numBytesAllocated-=a):(this.freeTextures[o].push(e),this.numFreeTextures++,this._numBytesFree+=a),this.numUsedTextures--;const c=this.usedTextures[o],u=c.indexOf(e);if(u<0)throw new Error("Cannot release a texture that was never provided by this texture manager");c.splice(u,1),this.log()}log(){if(!this.logEnabled)return;const e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",`${this.numFreeTextures} / ${this.numUsedTextures}`,`(${e})`);const n=this._numBytesFree/this._numBytesAllocated;console.log(`Bytes allocated: ${this._numBytesAllocated}`),console.log(`Bytes unused: ${this._numBytesFree} (${Math.round(100*n)}%)`)}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(this.freeTextures!=null){for(const e in this.freeTextures)this.freeTextures[e].forEach(n=>{this.gpgpu.deleteMatrixTexture(n.texture)});for(const e in this.usedTextures)this.usedTextures[e].forEach(n=>{this.gpgpu.deleteMatrixTexture(n.texture)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}function OFe(t,e){const n=t;if(e===n.R32F)return 4;if(e===n.R16F)return 2;if(e===n.RGBA32F)return 16;if(e===t.RGBA)return 16;if(e===n.RGBA16F)return 8;if(e===n.RGBA8)return 4;throw new Error(`Unknown internal format ${e}`)}function fV(t,e,n,s,r){const i=PFe(e,s);let o;if(r){const[l,c]=fp(t[0],t[1]);o=l*c}else{const[l,c]=L0(t[0],t[1]);o=l*c}const a=OFe(n,i);return o*a}function PFe(t,e){switch(t){case Ds.PACKED_2X2_FLOAT32:return KX(e);case Ds.PACKED_2X2_FLOAT16:return qX(e);case Ds.UNPACKED_FLOAT32:return UX(e);case Ds.UNPACKED_FLOAT16:return HX(e);case Ds.PACKED_4X1_UNSIGNED_BYTE:return GX(e);default:throw new Error(`Unknown physical texture type ${t}`)}}function FFe(t){return oe().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?t?Ds.PACKED_2X2_FLOAT32:Ds.UNPACKED_FLOAT32:t?Ds.PACKED_2X2_FLOAT16:Ds.UNPACKED_FLOAT16}function pV(t,e){if(t===yi.UPLOAD)return Ds.PACKED_2X2_FLOAT32;if(t===yi.RENDER||t==null)return FFe(e);if(t===yi.DOWNLOAD||t===yi.PIXELS)return Ds.PACKED_4X1_UNSIGNED_BYTE;throw new Error(`Unknown logical texture type ${t}`)}function mV(t,e,n){return`${t[0]}_${t[1]}_${e}_${n}`}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class sl{constructor(e,n){this.variableNames=["A"],this.outputShape=e,this.enableShapeUniforms=dr(this.outputShape.length),this.userCode=`
      float unaryOperation(float x) {
        ${n}
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `}}const fo="if (isnan(x)) return x;",LFe="return x;",gV="return abs(x);",MFe="return (x >= 0.0) ? x : (exp(x) - 1.0);",zFe=fo+`
  return (x < 0.0) ? 0.0 : x;
`,VFe=fo+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,sh="return x;",jFe="return 1.0 / (1.0 + exp(-1.0 * x));";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BFe="return x;",WFe=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,UFe=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,HFe=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,GFe="return 1.0 / (1.0 + exp(-1.0 * x));";class zu{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.enableShapeUniforms=dr(this.outputShape.length),this.userCode=`
      vec4 unaryOperation(vec4 x) {
        ${n}
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class KFe{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e,this.enableShapeUniforms=dr(this.outputShape.length);const n=e.length,s=ir("rc",n),r=sn(n),i=$Fe(n,s),o=s.slice(-2),a=n<=1?"rc":`vec2(${o.join(",")})`;this.userCode=`
      void main() {
        ${r} rc = getOutputCoords();
        vec4 packedInput = getA(${i});

        setOutput(getChannel(packedInput, ${a}));
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qFe=mR,XFe=1e-7,YFe=1e-4,ev={};function ZFe(t){return t in ev||(ev[t]={}),ev[t]}const QFe=oe().getNumber("CPU_HANDOFF_SIZE_THRESHOLD"),JFe=600;function eLe(){return oe().global.screen==null?1024:oe().global.screen.height*oe().global.screen.width*window.devicePixelRatio*JFe/1024/1024}class hk extends p${constructor(e){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!oe().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let n;if(e!=null){if(e instanceof pT)n=e;else{const s=Bo(oe().getNumber("WEBGL_VERSION"),e);n=new pT(s)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{const s=Bo(oe().getNumber("WEBGL_VERSION"));n=new pT(s),this.binaryCache=ZFe(oe().getNumber("WEBGL_VERSION")),this.gpgpuCreatedLocally=!0}this.gpgpu=n,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new DFe(this.gpgpu),this.numMBBeforeWarning=eLe(),this.texData=new I6(this,Vl())}nextDataId(){return hk.nextDataId++}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}write(e,n,s){if((oe().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||oe().getBool("DEBUG"))&&this.checkNumericalProblems(e),s==="complex64"&&e!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const r={id:this.nextDataId()};return this.texData.set(r,{shape:n,dtype:s,values:e,usage:yi.UPLOAD,refCount:1}),r}refCount(e){return this.texData.has(e)?this.texData.get(e).refCount:0}incRef(e){const n=this.texData.get(e);n.refCount++}decRef(e){if(this.texData.has(e)){const n=this.texData.get(e);n.refCount--}}move(e,n,s,r,i){if(oe().getBool("DEBUG")&&this.checkNumericalProblems(n),r==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:s,dtype:r,values:n,usage:yi.UPLOAD,refCount:i})}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}readSync(e){const n=this.texData.get(e),{values:s,dtype:r,complexTensorInfos:i,slice:o,shape:a,isPacked:l}=n;if(o!=null){let h;l?h=new zu(a,sh):h=new sl(a,sh);const f=this.runWebGLProgram(h,[{dataId:e,shape:a,dtype:r}],r),p=this.readSync(f.dataId);return this.disposeIntermediateTensorInfo(f),p}if(s!=null)return this.convertAndCacheOnCPU(e);if(r==="string")return s;const c=this.activeTimers!=null;let u;c&&(u=vr());let d;if(r==="complex64"){const h=this.readSync(i.real.dataId),f=this.readSync(i.imag.dataId);d=xl(h,f)}else d=this.getValuesFromTexture(e);return c&&(this.downloadWaitMs+=vr()-u),this.convertAndCacheOnCPU(e,d)}async read(e){if(this.pendingRead.has(e)){const p=this.pendingRead.get(e);return new Promise(m=>p.push(m))}const n=this.texData.get(e),{values:s,shape:r,slice:i,dtype:o,complexTensorInfos:a,isPacked:l}=n;if(i!=null){let p;l?p=new zu(r,sh):p=new sl(r,sh);const m=this.runWebGLProgram(p,[{dataId:e,shape:r,dtype:o}],o),g=this.read(m.dataId);return this.disposeIntermediateTensorInfo(m),g}if(s!=null)return this.convertAndCacheOnCPU(e);if(oe().getBool("DEBUG")&&!oe().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&oe().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let c=null,u;if(o!=="complex64"&&oe().get("WEBGL_BUFFER_SUPPORTED")){u=this.decode(e);const p=this.texData.get(u.dataId);c=this.gpgpu.createBufferFromTexture(p.texture.texture,...Yx(r))}this.pendingRead.set(e,[]),o!=="complex64"&&await this.gpgpu.createAndWaitForFence();let d;if(o==="complex64"){const p=await Promise.all([this.read(a.real.dataId),this.read(a.imag.dataId)]),m=p[0],g=p[1];d=xl(m,g)}else if(c==null)d=this.getValuesFromTexture(e);else{const p=le(r);d=this.gpgpu.downloadFloat32MatrixFromBuffer(c,p)}if(u!=null&&this.disposeIntermediateTensorInfo(u),c!=null){const p=this.gpgpu.gl;je(p,()=>p.deleteBuffer(c))}const h=this.convertAndCacheOnCPU(e,d),f=this.pendingRead.get(e);return this.pendingRead.delete(e),f.forEach(p=>p(h)),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e)&&Vl().removeDataId(e,this),this.pendingDeletes--),h}readToGPU(e,n={}){const s=this.texData.get(e),{values:r,shape:i,slice:o,dtype:a,isPacked:l,texture:c}=s;if(a==="complex64")throw new Error("Does not support reading texture for complex64 dtype.");if(o!=null){let f;l?f=new zu(i,sh):f=new sl(i,sh);const p=this.runWebGLProgram(f,[{dataId:e,shape:i,dtype:a}],a),m=this.readToGPU(p,n);return this.disposeIntermediateTensorInfo(p),m}if(c==null)throw r!=null?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");const u=this.decode(e,n.customTexShape),d=Vl().makeTensorFromTensorInfo(u),h=this.texData.get(u.dataId);return Object.assign({tensorRef:d},h.texture)}bufferSync(e){const n=this.readSync(e.dataId);if(e.dtype==="string")try{const s=n.map(r=>Mc(r));return gt(e.shape,e.dtype,s)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return gt(e.shape,e.dtype,n)}checkNumericalProblems(e){if(e!=null)for(let n=0;n<e.length;n++){const s=e[n];if(!oOe(s))throw oe().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error(`The value ${s} cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'`):Error(`The value ${s} cannot be represented on this device.`)}}getValuesFromTexture(e){const{shape:n,dtype:s,isPacked:r}=this.texData.get(e),i=le(n);if(oe().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){const h=this.decode(e),f=this.texData.get(h.dataId),p=this.gpgpu.downloadMatrixFromPackedTexture(f.texture.texture,...Yx(n)).subarray(0,i);return this.disposeIntermediateTensorInfo(h),p}const o=oe().getBool("WEBGL_PACK")&&r===!0,a=o?dT(n):n,l=o?new SPe(a):new wPe(a),c=this.runWebGLProgram(l,[{shape:a,dtype:s,dataId:e}],"float32"),u=this.texData.get(c.dataId),d=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(u.texture.texture,u.texShape[0],u.texShape[1]).subarray(0,i);return this.disposeIntermediateTensorInfo(c),d}timerAvailable(){return oe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(e){const n=this.activeTimers,s=[];let r=!1;this.programTimersStack==null?(this.programTimersStack=s,r=!0):this.activeTimers.push(s),this.activeTimers=s,e();const i=_f(this.activeTimers.map(l=>l.query)).filter(l=>l!=null),o=_f(this.activeTimers.map(l=>l.name)).filter(l=>l!=null);this.activeTimers=n,r&&(this.programTimersStack=null);const a={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(async()=>{if(oe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){const l=await Promise.all(i);a.kernelMs=mge(l),a.getExtraProfileInfo=()=>l.map((c,u)=>({name:o[u],ms:c})).map(c=>`${c.name}: ${c.ms}`).join(", ")}else a.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,a})()}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return oe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:vr(),endMs:null}}endTimer(e){return oe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=vr(),e)}async getQueryTime(e){if(oe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(e);const n=e;return n.endMs-n.startMs}disposeData(e,n=!1){if(this.pendingDisposal.has(e))return!1;if(!this.texData.has(e))return!0;if(n?this.texData.get(e).refCount=0:this.texData.get(e).refCount--,!n&&this.texData.get(e).refCount>0)return!1;if(this.pendingRead.has(e))return this.pendingDisposal.add(e),this.pendingDeletes++,!1;this.releaseGPUData(e);const{complexTensorInfos:s}=this.texData.get(e);return s!=null&&(this.disposeData(s.real.dataId,n),this.disposeData(s.imag.dataId,n)),this.texData.delete(e),!0}releaseGPUData(e){const{texture:n,dtype:s,texShape:r,usage:i,isPacked:o,slice:a}=this.texData.get(e),l=a&&a.origDataId||e,c=this.dataRefCount.get(l);c>1?this.dataRefCount.set(l,c-1):(this.dataRefCount.delete(l),n!=null&&(this.numBytesInGPU-=this.computeBytes(r,s),this.textureManager.releaseTexture(n,r,i,o)));const u=this.texData.get(e);u.texture=null,u.texShape=null,u.isPacked=!1,u.slice=null}getTexture(e){return this.uploadToGPU(e),this.texData.get(e).texture.texture}getDataInfo(e){return this.texData.get(e)}shouldExecuteOnCPU(e,n=QFe){return oe().getBool("WEBGL_CPU_FORWARD")&&e.every(s=>this.texData.get(s.dataId).texture==null&&le(s.shape)<n)}getGPGPUContext(){return this.gpgpu}where(e){pi("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");const n=e.dataSync();return qFe(e.shape,n)}packedUnaryOp(e,n,s){const r=new zu(e.shape,n),i=this.compileAndRun(r,[e],s);return Vl().makeTensorFromTensorInfo(i)}abs(e){if(this.shouldExecuteOnCPU([e])&&e.dtype!=="complex64"){const r=YX(this.texData.get(e.dataId).values);return this.makeOutput(e.shape,e.dtype,r)}if(oe().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,gV,e.dtype);const n=new sl(e.shape,gV),s=this.compileAndRun(n,[e]);return Vl().makeTensorFromTensorInfo(s)}makeTensorInfo(e,n,s){let r;if(n==="string"&&s!=null&&s.length>0&&xy(s[0])){const i=s.map(o=>kc(o));r=this.write(i,e,n)}else r=this.write(s,e,n);return this.texData.get(r).usage=null,{dataId:r,shape:e,dtype:n}}makeOutput(e,n,s){return Vl().makeTensorFromTensorInfo(this.makeTensorInfo(e,n,s),this)}unpackTensor(e){const n=new KFe(e.shape);return this.runWebGLProgram(n,[e],e.dtype)}packTensor(e){const n=new AFe(e.shape),s=!0;return this.runWebGLProgram(n,[e],e.dtype,null,s)}packedReshape(e,n){const s=[jf(e.shape),...Bf(e.shape)],r={dtype:e.dtype,shape:s,dataId:e.dataId},i=[jf(n),...Bf(n)],o=new JX(i,s),a=!0,l=[s],c=this.runWebGLProgram(o,[r],e.dtype,l,a);return{dataId:c.dataId,shape:n,dtype:c.dtype}}decode(e,n){const s=this.texData.get(e),{isPacked:r,shape:i,dtype:o}=s;if(n!=null){const h=le(i),f=n[0]*n[1]*4;O(h<=f,()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data.")}const a=dT(i);let l;r?l=new bPe(a):l=new vPe(a);const c=!0,u=[n??Yx(a)],d=this.runWebGLProgram(l,[{shape:a,dtype:o,dataId:e}],o,u,c,n);return{dtype:o,shape:i,dataId:d.dataId}}runWebGLProgram(e,n,s,r,i=!1,o){const a=this.makeTensorInfo(e.outputShape,s),l=this.texData.get(a.dataId);if(e.packedOutput&&(l.isPacked=!0),e.outPackingScheme===Pg.DENSE){const y=o??Yx(e.outputShape);l.texShape=y.map(x=>x*2)}if(e.outTexUsage!=null&&(l.usage=e.outTexUsage),le(a.shape)===0)return l.values=Cs(a.dtype,0),a;const c=[],u=n.map(y=>{if(y.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let x=this.texData.get(y.dataId);if(x.texture==null){if(!e.packedInputs&&le(y.shape)<=oe().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:y.shape,texData:null,isUniform:!0,uniformValues:x.values};e.packedInputs&&(x.isPacked=!0,x.shape=y.shape)}if(this.uploadToGPU(y.dataId),!!x.isPacked!=!!e.packedInputs)y=x.isPacked?this.unpackTensor(y):this.packTensor(y),c.push(y),x=this.texData.get(y.dataId);else if(x.isPacked&&!Sw(x.shape,y.shape)){const v=y,b=y.shape;y.shape=x.shape,y=this.packedReshape(y,b),c.push(y),x=this.texData.get(y.dataId),v.shape=b}return{shape:y.shape,texData:x,isUniform:!1}});this.uploadToGPU(a.dataId);const d={shape:a.shape,texData:l,isUniform:!1},h=xPe(e,u,d),f=this.getAndSaveBinary(h,()=>gPe(this.gpgpu,e,u,d)),p=this.activeTimers!=null;let m;p&&(m=this.startTimer()),oe().get("ENGINE_COMPILE_ONLY")||yPe(this.gpgpu,f,u,d,r),c.forEach(y=>this.disposeIntermediateTensorInfo(y)),p&&(m=this.endTimer(m),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(m)}));const g=oe().get("WEBGL_FLUSH_THRESHOLD");if(g>0){const y=vr();y-this.lastGlFlushTime>g&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=y)}if(!oe().getBool("WEBGL_LAZILY_UNPACK")&&l.isPacked&&i===!1){const y=this.unpackTensor(a);return this.disposeIntermediateTensorInfo(a),y}return a}compileAndRun(e,n,s,r,i=!1){return s=s||n[0].dtype,this.runWebGLProgram(e,n,s,r,i)}getAndSaveBinary(e,n){return e in this.binaryCache||(this.binaryCache[e]=n()),this.binaryCache[e]}getTextureManager(){return this.textureManager}dispose(){this.disposed||(oe().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(n=>{this.gpgpu.deleteProgram(this.binaryCache[n].webGLProgram),delete this.binaryCache[n]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}floatPrecision(){return this.floatPrecisionValue==null&&(this.floatPrecisionValue=se(()=>{if(!oe().get("WEBGL_RENDER_FLOAT32_ENABLED")){const e=oe().getBool("DEBUG");oe().set("DEBUG",!1);const n=this.abs(Ge(1e-8)).dataSync()[0];if(oe().set("DEBUG",e),n>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return this.floatPrecision()===32?XFe:YFe}uploadToGPU(e){const n=this.texData.get(e),{shape:s,dtype:r,values:i,texture:o,usage:a,isPacked:l}=n;if(o!=null)return;const c=this.activeTimers!=null;let u;c&&(u=vr());let d=n.texShape;if(d==null&&(d=COe(s,l),n.texShape=d),i!=null){const h=dT(s);let f,p=d[1],m=d[0];const g=i instanceof Uint8Array||i instanceof Uint8ClampedArray;(l||!g)&&([p,m]=fp(d[0],d[1])),l?f=new CPe(h,g):f=new kPe(h,g);const y=g?[m,p]:d,x=this.makeTensorInfo(y,r),v=this.texData.get(x.dataId);g?v.usage=yi.PIXELS:v.usage=yi.UPLOAD,v.texShape=y,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(x.dataId),p,m,i);const b=[[m,p]],k=!0,C=this.runWebGLProgram(f,[x],r,b,k),N=this.texData.get(C.dataId);n.texShape=N.texShape,n.isPacked=N.isPacked,n.usage=N.usage,oe().get("ENGINE_COMPILE_ONLY")?this.disposeData(C.dataId):(n.texture=N.texture,n.values=null,this.texData.delete(C.dataId)),this.disposeIntermediateTensorInfo(x),c&&(this.uploadWaitMs+=vr()-u)}else{const h=this.acquireTexture(d,a,r,l);n.texture=h}}convertAndCacheOnCPU(e,n){const s=this.texData.get(e),{dtype:r}=s;return this.releaseGPUData(e),n!=null&&(s.values=tLe(n,r)),s.values}acquireTexture(e,n,s,r){if(this.numBytesInGPU+=this.computeBytes(e,s),!this.warnedAboutMemory&&this.numBytesInGPU>this.numMBBeforeWarning*1024*1024){const i=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn(`High memory usage in GPU: ${i} MB, most likely due to a memory leak`)}return this.textureManager.acquireTexture(e,n,r)}computeBytes(e,n){return e[0]*e[1]*N2(n)}checkCompileCompletion(){for(const[,e]of Object.entries(this.binaryCache))this.checkCompletion_(e)}async checkCompileCompletionAsync(){const e=[];if(this.gpgpu.parallelCompilationExtension){for(const[,n]of Object.entries(this.binaryCache))e.push(this.checkCompletionAsync_(n));return Promise.all(e)}else{for(const[,n]of Object.entries(this.binaryCache)){const s=new Promise(r=>{try{this.checkCompletion_(n),r(!0)}catch(i){throw i}});e.push(s)}return Promise.all(e)}}async checkCompletionAsync_(e){return this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(e):(await L8(),this.checkCompletionAsync_(e))}checkCompletion_(e){if(this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.gl.LINK_STATUS)===!1)throw console.log(this.gpgpu.gl.getProgramInfoLog(e.webGLProgram)),this.gpgpu.gl.getShaderParameter(e.fragmentShader,this.gpgpu.gl.COMPILE_STATUS)===!1?(MX(e.source,this.gpgpu.gl.getShaderInfoLog(e.fragmentShader)),new Error("Failed to compile fragment shader.")):new Error("Failed to link vertex and fragment shaders.");return!0}getUniformLocations(){for(const[,e]of Object.entries(this.binaryCache)){const{uniformLocations:n,customUniformLocations:s,infLoc:r,nanLoc:i,inShapesLocations:o,inTexShapesLocations:a,outShapeLocation:l,outShapeStridesLocation:c,outTexShapeLocation:u}=WX(this.gpgpu,e.program,e.webGLProgram);e.uniformLocations=n,e.customUniformLocations=s,e.infLoc=r,e.nanLoc=i,e.inShapesLocations=o,e.inTexShapesLocations=a,e.outShapeLocation=l,e.outShapeStridesLocation=c,e.outTexShapeLocation=u}}}hk.nextDataId=0;function tLe(t,e){if(e==="float32"||e==="complex64")return t;if(e==="int32"||e==="bool"){const n=e==="int32"?new Int32Array(t.length):new Uint8Array(t.length);for(let s=0;s<n.length;++s)n[s]=Math.round(t[s]);return n}else throw new Error(`Unknown dtype ${e}`)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y6()&&vG("webgl",()=>new hk,2);/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RD=`
  if (isnan(a)) return a;
  if (isnan(b)) return b;
`;class Wf{constructor(e,n,s){this.variableNames=["A","B"],this.outputShape=ct(n,s),this.enableShapeUniforms=dr(this.outputShape.length),this.userCode=`
      float binaryOperation(float a, float b) {
        ${e}
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const V0=`
  result.r = isNaN.r ? NAN : result.r;
  result.g = isNaN.g ? NAN : result.g;
  result.b = isNaN.b ? NAN : result.b;
  result.a = isNaN.a ? NAN : result.a;
`;class j0{constructor(e,n,s,r=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=ct(n,s);const i=this.outputShape.length;this.enableShapeUniforms=dr(i);let o="";if(r)if(i===0||le(this.outputShape)===1)o=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(o=`
          ${sn(i)} coords = getOutputCoords();
        `,i===1)this.enableShapeUniforms?o+=`
            result.y = (coords + 1) >= outShape ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `:o+=`
            result.y = (coords + 1) >= ${this.outputShape[0]} ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{const l=ir("coords",i);this.enableShapeUniforms?o+=`
            bool nextRowOutOfBounds =
              (${l[i-2]} + 1) >= outShape[${i} - 2];
            bool nextColOutOfBounds =
              (${l[i-1]} + 1) >= outShape[${i} - 1];
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `:o+=`
            bool nextRowOutOfBounds =
              (${l[i-2]} + 1) >= ${this.outputShape[i-2]};
            bool nextColOutOfBounds =
              (${l[i-1]} + 1) >= ${this.outputShape[i-1]};
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        ${e}
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        ${o}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ei(t){const{inputs:e,backend:n}=t,{x:s}=e;return n.incRef(s.dataId),{dataId:s.dataId,shape:s.shape,dtype:s.dtype}}const nLe={kernelName:Vy,backendName:"webgl",kernelFunc:ei};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cu(t){const{inputs:e,backend:n}=t,{real:s,imag:r}=e,i=n.makeTensorInfo(s.shape,"complex64"),o=n.texData.get(i.dataId),a=ei({inputs:{x:s},backend:n}),l=ei({inputs:{x:r},backend:n});return o.complexTensorInfos={real:a,imag:l},i}const sLe={kernelName:C$,backendName:"webgl",kernelFunc:cu};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const e7="return (a < 0.) ? b * a : a;",t7=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function rLe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{alpha:i}=s,o=n.makeTensorInfo([],"float32",tu(i,"float32")),a=oe().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new j0(t7,r.shape,o.shape):new Wf(e7,r.shape,o.shape),l=n.runWebGLProgram(a,[r,o],"float32");return n.disposeIntermediateTensorInfo(o),l}const iLe={kernelName:U1,backendName:"webgl",kernelFunc:rLe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const n7="return (a < 0.) ? b * a : a;",s7=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function oLe(t){const{inputs:e,backend:n}=t,{x:s,alpha:r}=e,i=oe().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new j0(s7,s.shape,r.shape):new Wf(n7,s.shape,r.shape);return n.runWebGLProgram(i,[s,r],"float32")}const aLe={kernelName:cS,backendName:"webgl",kernelFunc:oLe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xp="if (isnan(x)) return x;";function Dt({opSnippet:t,packedOpSnippet:e,cpuKernelImpl:n,dtype:s}){return({inputs:r,backend:i})=>{const{x:o}=r,a=i,l=s||o.dtype;if(a.shouldExecuteOnCPU([o])&&n!=null){const d=a.texData.get(o.dataId),h=n(d.values,l);return a.makeTensorInfo(o.shape,l,h)}const c=oe().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&e!=null;let u;return c?u=new zu(o.shape,e):u=new sl(o.shape,t),a.runWebGLProgram(u,[o],l)}}function Vs({opSnippet:t,packedOpSnippet:e,checkOutOfBounds:n=!1,supportsComplex:s=!1,cpuKernelImpl:r,dtype:i}){return({inputs:o,backend:a})=>{const{a:l,b:c}=o,u=a;if(s&&l.dtype==="complex64"){const p=u.texData.get(l.dataId),m=u.texData.get(c.dataId),[g,y]=[[p.complexTensorInfos.real,m.complexTensorInfos.real],[p.complexTensorInfos.imag,m.complexTensorInfos.imag]].map(v=>{const[b,k]=v,C={dataId:b.dataId,dtype:b.dtype,shape:l.shape},N={dataId:k.dataId,dtype:k.dtype,shape:c.shape},I=new Wf(t,l.shape,c.shape);return u.runWebGLProgram(I,[C,N],Zr(b.dtype,k.dtype))}),x=cu({inputs:{real:g,imag:y},backend:u});return u.disposeIntermediateTensorInfo(g),u.disposeIntermediateTensorInfo(y),x}const d=i||Zr(l.dtype,c.dtype);if((l.dtype==="string"||c.dtype==="string"||u.shouldExecuteOnCPU([l,c]))&&r!=null){const p=u.texData.get(l.dataId).values,m=u.texData.get(c.dataId).values,g=l.dtype==="string"?Cd(p):p,y=l.dtype==="string"?Cd(m):m,[x,v]=r(l.shape,c.shape,g,y,d),b=u.makeTensorInfo(v,d),k=u.texData.get(b.dataId);return k.values=x,b}const h=oe().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&e!=null;let f;return h?f=new j0(e,l.shape,c.shape,n):f=new Wf(t,l.shape,c.shape),u.runWebGLProgram(f,[l,c],d)}}function Fg(t,e=!1){if(t==="linear")return e?BFe:LFe;if(t==="relu")return e?UFe:zFe;if(t==="elu")return e?WFe:MFe;if(t==="relu6")return e?HFe:VFe;if(t==="prelu")return e?s7:n7;if(t==="leakyrelu")return e?t7:e7;if(t==="sigmoid")return e?GFe:jFe;throw new Error(`Activation ${t} has not been implemented for the WebGL backend.`)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class r7{constructor(e,n,s,r=!1,i=!1,o=!1,a=null,l=!1,c=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=s,this.enableShapeUniforms=dr(this.outputShape.length);const u=r?e[1]:e[2],d=Math.ceil(u/2),h=r?"i * 2, rc.y":"rc.y, i * 2",f=i?"rc.z, i * 2":"i * 2, rc.z",p=r?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],m=i?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"];let g="",y="";a&&(l?g=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${a}
        }`:c?g=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${a}
        }`:g=`vec4 activation(vec4 x) {
          ${a}
        }`,y="result = activation(result);");const x=o?"result += getBiasAtOutCoords();":"";o&&this.variableNames.push("bias"),l&&this.variableNames.push("preluActivationWeights"),c&&this.variableNames.push("leakyreluAlpha");let v="rc.x",b="rc.x";e[0]<n[0]?v=`int(min(float(rc.x), ${e[0]-1}.))`:n[0]<e[0]&&(b=`int(min(float(rc.x), ${n[0]-1}.))`),this.userCode=`
      ${g}
      // Don't use uniform for sharedDimensionPacked for performance.
      const float sharedDimension = ${d}.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        for (int i = 0; i < ${d}; i++) {
          int batchA = ${v};
          int batchB = ${b};
          vec4 a = getMatrixA(batchA, ${h});
          vec4 b = getMatrixB(batchB, ${f});

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (${p[0]} * ${m[0]});
          result += (${p[1]} * ${m[1]});
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        ${x}

        ${y}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yV={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"};class xV{constructor(e,n,s){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=ct(n,s),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        ${e}
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vV="return a * b;";function DD(t){const{inputs:e,backend:n}=t,{a:s,b:r}=e,i=Zr(s.dtype,r.dtype);if(s.dtype==="complex64"){const a=n.texData.get(s.dataId),l=n.texData.get(r.dataId),c=new xV(yV.REAL,s.shape,r.shape),u=new xV(yV.IMAG,s.shape,r.shape),d=[{dataId:a.complexTensorInfos.real.dataId,dtype:a.complexTensorInfos.real.dtype,shape:s.shape},{dataId:a.complexTensorInfos.imag.dataId,dtype:a.complexTensorInfos.imag.dtype,shape:s.shape},{dataId:l.complexTensorInfos.real.dataId,dtype:l.complexTensorInfos.real.dtype,shape:r.shape},{dataId:l.complexTensorInfos.imag.dataId,dtype:l.complexTensorInfos.imag.dtype,shape:r.shape}],h=n.runWebGLProgram(c,d,"float32"),f=n.runWebGLProgram(u,d,"float32"),p=cu({inputs:{real:h,imag:f},backend:n});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),p}if(n.shouldExecuteOnCPU([s,r])){const a=n.texData.get(s.dataId),l=n.texData.get(r.dataId),[c,u]=lFe(s.shape,r.shape,a.values,l.values,i),d=n.makeTensorInfo(u,i),h=n.texData.get(d.dataId);return h.values=c,d}let o;return oe().getBool("WEBGL_PACK_BINARY_OPERATIONS")?o=new j0(vV,s.shape,r.shape):o=new Wf(vV,s.shape,r.shape),n.runWebGLProgram(o,[s,r],i)}const lLe={kernelName:Xy,backendName:"webgl",kernelFunc:DD};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cLe(t,e,n){const s=[jf(t.shape),...Bf(t.shape)],r={dtype:t.dtype,shape:s,dataId:t.dataId},i=[jf(e),...Bf(e)],o=new JX(i,s),a=!0,l=[s],c=n.runWebGLProgram(o,[r],t.dtype,l,a);return{dataId:c.dataId,shape:e,dtype:c.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{shape:i}=s,o=n,a=le(r.shape),l=_6(i,a),c=le(l);O(a===c,()=>`The new shape (${l}) has ${c} elements and the old shape (${r.shape}) has ${a} elements. The new shape and old shape must have the same number of elements.`);const u=o.texData.get(r.dataId);return u.isPacked&&!Sw(r.shape,l)&&!(u.texture!==null&&Sw(u.shape,l))?cLe(r,l,o):(o.incRef(r.dataId),{dataId:r.dataId,shape:l,dtype:r.dtype})}const uLe={kernelName:dS,backendName:"webgl",kernelFunc:_e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bV{constructor(e,n){this.variableNames=["x"];const{windowSize:s,batchSize:r,inSize:i,outSize:o}=e;this.outputShape=[r,o];const a=Math.floor(s/4)*4,l=s%4;let c="sumValue += dot(values, ones);";if(n!=null){const d=1/n;c=`sumValue += dot(values * ${Ef(d)?d.toPrecision(2):d}, ones);`}let u="";i%s>0&&(u=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return 0.0;
        }
      `),this.userCode=`
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${u}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${s};

        float sumValue = 0.0;

        for (int i = 0; i < ${a}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${c}
        }

        int inIdx = inOffset + ${a};
        if (${l===1}) {
          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);

          ${c}
        } else if (${l===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1), 0.0, 0.0);

          ${c}
        } else if (${l===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2), 0.0);

          ${c}
        }
        setOutput(sumValue);
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class dLe{constructor(e,n){this.variableNames=["x"];const{windowSize:s,batchSize:r,inSize:i,outSize:o}=e;this.outputShape=[r,o];let a="0.0",l="";n==="prod"?a="1.0":n==="min"?(a="1.0 / 1e-20",l="min"):n==="max"&&(a="-1.0 / 1e-20",l="max");let c=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="sum"?c="sumValue":n==="prod"?c="prodValue":n==="all"?c="allValue":n==="any"&&(c="anyValue");const u=Math.floor(s/4)*4,d=s%4;let h=`
      if (${n==="sum"}) {
        sumValue += dot(values, ones);
      } else if (${n==="prod"}) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = ${l}(values, minMaxValue);
        if (${n==="min"} || ${n==="max"}) {
          minMaxValue = ${l}(values, minMaxValue);
          bvec4 isNaN = isnan(values);
          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {
            minMaxValue = vec4(NAN);
          }
        }
      }
    `,f="vec4";n==="all"?(a="1.0",h=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,f="bvec4"):n==="any"&&(a="0.0",h=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,f="bvec4");let p="";i%s>0&&(p=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = ${a};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${p}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${s};

        vec4 minMaxValue = vec4(${a});
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < ${u}; i += 4) {
          int inIdx = inOffset + i;
          ${f} values = ${f}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${h}
        }

        int inIdx = inOffset + ${u};
        if (${d===1}) {
          ${f} values = ${f}(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          ${h}
        } else if (${d===2}) {
          ${f} values = ${f}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          ${h}
        } else if (${d===3}) {
          ${f} values = ${f}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          ${h}
        }
        setOutput(${c});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hLe(t){const e=[];for(;e.length===0||e[e.length-1].outSize!==1;){const n=e.length?e[e.length-1].outSize:t[1],s=XS(n);e.push({inSize:n,windowSize:s,outSize:Math.ceil(n/s)})}return e}function Hd(t,e,n,s){const r=hLe(t.shape);let i=t;for(let o=0;o<r.length;o++){const{inSize:a,windowSize:l,outSize:c}=r[o];let u,d;n==="mean"?u=o===0?new bV({windowSize:l,inSize:a,batchSize:t.shape[0],outSize:c},a):new bV({windowSize:l,inSize:a,batchSize:t.shape[0],outSize:c}):u=new dLe({windowSize:l,inSize:a,batchSize:t.shape[0],outSize:c},n),d=i,i=s.runWebGLProgram(u,[i],e),d.dataId!==t.dataId&&s.disposeIntermediateTensorInfo(d)}return i}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class fLe{constructor(e,n){this.variableNames=["A"];const s=new Array(e.length);for(let o=0;o<s.length;o++)s[o]=e[n[o]];this.outputShape=s,this.rank=s.length;const r=sn(this.rank),i=pLe(n);this.userCode=`
    void main() {
      ${r} resRC = getOutputCoords();
      setOutput(getA(${i}));
    }
    `}}function pLe(t){const e=t.length;if(e>6)throw Error(`Transpose for rank ${e} is not yet supported`);const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],s=new Array(e);for(let r=0;r<t.length;r++)s[t[r]]=n[r];return s.join()}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mLe{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;const s=new Array(e.length);for(let u=0;u<s.length;u++)s[u]=e[n[u]];if(this.outputShape=s,this.rank=s.length,this.rank>6)throw Error(`Packed transpose for rank ${this.rank} is not yet supported.`);const r=sn(this.rank),i=QX("rc",this.rank),o=new Array(this.rank);for(let u=0;u<n.length;u++)o[n[u]]=i[u];const a=`vec2(${o.slice(-2).join()})`,l=`++${i[this.rank-1]} < ${s[this.rank-1]}`,c=`getChannel(getA(${o.join()}), ${a})`;this.userCode=`
    void main() {
      ${r} rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = ${c};
      if(${l}) {
        result[1] = ${c};
      }
      --${i[this.rank-1]};
      if(++${i[this.rank-2]} < ${s[this.rank-2]}) {
        result[2] = ${c};
        if(${l}) {
          result[3] = ${c};
        }
      }
      setOutput(result);
    }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fk(t,e,n){const s=oe().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new mLe(t.shape,e):new fLe(t.shape,e);return n.runWebGLProgram(s,[t],t.dtype)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gLe(t,e,n,s){const r=e,i=t.shape.length,o=bt(r,t.shape);let a=o;const l=In(a,i),c=l!=null;let u=t;c&&(u=fk(t,l,s),a=Gn(a.length,i)),zs("sum",a,i);const[d,h]=Ns(u.shape,a);let f=d;n&&(f=Hn(d,o));const p=le(h),g=le(t.shape)/p,y=_e({inputs:{x:u},attrs:{shape:[g,p]},backend:s}),x=wA(t.dtype),v=Hd(y,x,"sum",s),b=_e({inputs:{x:v},attrs:{shape:f},backend:s});return s.disposeIntermediateTensorInfo(y),s.disposeIntermediateTensorInfo(v),c&&s.disposeIntermediateTensorInfo(u),b}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pk(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,keepDims:o}=s;return gLe(r,i,o,n)}const yLe={kernelName:yS,backendName:"webgl",kernelFunc:pk};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lr(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{perm:i}=s,o=n,a=r.shape.length,l=new Array(a);for(let u=0;u<l.length;u++)l[u]=r.shape[i[u]];let c;if(o.shouldExecuteOnCPU([r])){const d=o.texData.get(r.dataId).values,h=AD(d,r.shape,r.dtype,i,l);c=o.makeTensorInfo(l,r.dtype);const f=o.texData.get(c.dataId);f.values=h}else c=fk(r,i,o);return c}const xLe={kernelName:Uh,backendName:"webgl",kernelFunc:lr};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const i7=1e3;function kw({a:t,b:e,transposeA:n,transposeB:s,backend:r,bias:i=null,preluActivationWeights:o=null,leakyreluAlpha:a=0,activation:l=null}){const c=t.shape.length,u=e.shape.length,d=n?t.shape[c-2]:t.shape[c-1],h=s?e.shape[u-1]:e.shape[u-2],f=n?t.shape[c-1]:t.shape[c-2],p=s?e.shape[u-2]:e.shape[u-1],m=t.shape.slice(0,-2),g=e.shape.slice(0,-2),y=le(m),x=le(g),b=ct(t.shape.slice(0,-2),e.shape.slice(0,-2)).concat([f,p]);O(d===h,()=>`Error in matMul: inner shapes (${d}) and (${h}) of Tensors with shapes ${t.shape} and ${e.shape} and transposeA=${n} and transposeB=${s} must match.`);const k=n?[y,d,f]:[y,f,d],C=s?[x,p,h]:[x,h,p],N=_e({inputs:{x:t},backend:r,attrs:{shape:k}}),I=_e({inputs:{x:e},backend:r,attrs:{shape:C}}),$=[N,I],A=Math.max(y,x),P=n?N.shape[1]:N.shape[2],F=i!=null,V=o!=null,z=l==="leakyrelu",B=l!=null?Fg(l,!0):null,W=F||V||z||B!=null;let q;if((f===1||p===1)&&P>i7&&W===!1){let G=N,ne=I;n&&(G=lr({inputs:{x:N},backend:r,attrs:{perm:[0,2,1]}}),$.push(G)),s&&(ne=lr({inputs:{x:I},backend:r,attrs:{perm:[0,2,1]}}),$.push(ne));const ie=p!==1,de=p===1;let he=G;ie&&(he=_e({inputs:{x:G},backend:r,attrs:{shape:[A,P,1]}}),$.push(he));const pe=p===1?2:1;let me=ne;de&&(me=_e({inputs:{x:ne},backend:r,attrs:{shape:[A,1,P]}}),$.push(me));const ye=DD({inputs:{a:he,b:me},backend:r});q=pk({inputs:{x:ye},backend:r,attrs:{axis:pe,keepDims:!0}}),$.push(ye)}else{const G=Zr(t.dtype,e.dtype),ne=new r7(k,C,[A,f,p],n,s,F,B,V,z),ie=[N,I];if(i!=null&&ie.push(i),V&&ie.push(o),z){const de=r.makeTensorInfo([],"float32",tu(a,"float32"));ie.push(de),$.push(de)}q=r.runWebGLProgram(ne,ie,G)}const M=_e({inputs:{x:q},backend:r,attrs:{shape:b}});$.push(q);for(const G of $)r.disposeIntermediateTensorInfo(G);return M}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vLe(t){const{inputs:e,backend:n,attrs:s}=t,{a:r,b:i,bias:o,preluActivationWeights:a}=e,{transposeA:l,transposeB:c,activation:u,leakyreluAlpha:d}=s;return kw({a:r,b:i,transposeA:l,transposeB:c,backend:n,bias:o,preluActivationWeights:a,leakyreluAlpha:d,activation:u})}const bLe={kernelName:Kb,backendName:"webgl",kernelFunc:vLe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wV="return abs(x);";function wLe(t){const{inputs:e,backend:n}=t,{x:s}=e;if(n.shouldExecuteOnCPU([s])&&s.dtype!=="complex64"){const i=n.texData.get(s.dataId),o=YX(i.values);return n.makeTensorInfo(s.shape,s.dtype,o)}let r;return oe().getBool("WEBGL_PACK_UNARY_OPERATIONS")?r=new zu(s.shape,wV):r=new sl(s.shape,wV),n.runWebGLProgram(r,[s],s.dtype)}const SLe={kernelName:k1,backendName:"webgl",kernelFunc:wLe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kLe=fo+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,CLe=Dt({opSnippet:kLe}),TLe={kernelName:by,backendName:"webgl",kernelFunc:CLe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NLe=fo+`
  if (x < 1.0) return NAN;
return log(x + sqrt(x * x - 1.0));`,ILe=Dt({opSnippet:NLe}),_Le={kernelName:wy,backendName:"webgl",kernelFunc:ILe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SV="return a + b;",ELe=Vs({opSnippet:SV,packedOpSnippet:SV,supportsComplex:!0,cpuKernelImpl:BPe}),$Le={kernelName:ip,backendName:"webgl",kernelFunc:ELe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ALe{constructor(e,n){this.outputShape=[],this.outputShape=e,this.variableNames=n.map((i,o)=>`T${o}`);const s=[];this.variableNames.forEach(i=>{s.push(`float v${i} = get${i}AtOutCoords();`)});const r=this.variableNames.map(i=>`v${i}`).join(" + ");this.userCode=`
      void main() {
        ${s.join(`
        `)}

        float result = ${r};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class RLe{constructor(e,n){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=n.map((i,o)=>`T${o}`);const s=[];this.variableNames.forEach(i=>{s.push(`vec4 v${i} = get${i}AtOutCoords();`)});const r=this.variableNames.map(i=>`v${i}`).join(" + ");this.userCode=`
      void main() {
        ${s.join(`
        `)}

        vec4 result = ${r};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mv(t){const{inputs:e,backend:n}=t,s=e;if(s.length===1)return ei({inputs:{x:s[0]},backend:n});if(s.length>oe().get("WEBGL_MAX_TEXTURES_IN_SHADER")){const l=Math.floor(s.length/2),c=Mv({inputs:s.slice(0,l),backend:n}),u=Mv({inputs:s.slice(l),backend:n});return Mv({inputs:[c,u],backend:n})}const r=s.map(l=>l.dtype).reduce((l,c)=>Zr(l,c)),i=s.map(l=>l.shape),a=oe().getBool("WEBGL_PACK")?new RLe(s[0].shape,i):new ALe(s[0].shape,i);return n.runWebGLProgram(a,s,r)}const DLe={kernelName:C1,backendName:"webgl",kernelFunc:Mv};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OLe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,keepDims:o}=s,a=r.shape.length,l=bt(i,r.shape);let c=l;const u=In(c,a);let d=r;u!=null&&(d=lr({inputs:{x:r},backend:n,attrs:{perm:u}}),c=Gn(c.length,a)),zs("all",c,a);const[h,f]=Ns(d.shape,c),p=le(f),m=_e({inputs:{x:d},backend:n,attrs:{shape:[-1,p]}}),g=Hd(m,m.dtype,"all",n);let y;if(o){const x=Hn(h,l);y=_e({inputs:{x:g},backend:n,attrs:{shape:x}})}else y=_e({inputs:{x:g},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),u!=null&&n.disposeIntermediateTensorInfo(d),y}const PLe={kernelName:x$,backendName:"webgl",kernelFunc:OLe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FLe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,keepDims:o}=s,a=r.shape.length,l=bt(i,r.shape);let c=l;const u=In(c,a);let d=r;u!=null&&(d=lr({inputs:{x:r},backend:n,attrs:{perm:u}}),c=Gn(c.length,a)),zs("any",c,a);const[h,f]=Ns(d.shape,c),p=le(f),m=_e({inputs:{x:d},backend:n,attrs:{shape:[-1,p]}}),g=Hd(m,m.dtype,"any",n);let y;if(o){const x=Hn(h,l);y=_e({inputs:{x:g},backend:n,attrs:{shape:x}})}else y=_e({inputs:{x:g},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),u!=null&&n.disposeIntermediateTensorInfo(d),y}const LLe={kernelName:v$,backendName:"webgl",kernelFunc:FLe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class MLe{constructor(e,n,s){this.variableNames=["A"];const{windowSize:r,batchSize:i,outSize:o}=e;s||this.variableNames.push("bestIndicesA"),this.outputShape=[i,o];const a=n==="max"?">":"<",l=s?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < ${r}; i++) {
          int inIdx = ${l};
          float candidate = getA(batch, inIdx);
          if (candidate ${a} bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zLe{constructor(e,n,s,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,O(e.length>2,()=>`Packed arg${s.charAt(0).toUpperCase()+s.slice(1)} supports only inputs with rank above 2.`);const i=e[e.length-1],o=Math.ceil(i/n);this.outputShape=e.slice(0,-1),o>1&&this.outputShape.push(o),r||this.variableNames.push("bestIndicesA");const a=this.outputShape,l=a.length,c=sn(l),u=ir("coords",l);let d,h;if(o===1){h=l+1;const I=sn(h);d=`
        ${I} sourceLocR = ${I}(${u.join()}, 0);
        ++${u[l-1]};
        ${I} sourceLocG = ${I}(${u.join()}, 0);
        ++${u[l-2]};
        ${I} sourceLocA = ${I}(${u.join()}, 0);
        --${u[l-1]};
        ${I} sourceLocB = ${I}(${u.join()}, 0);
        --${u[l-2]};`}else h=l,d=`
        ${c} sourceLocR = coords;
        ++${u[l-1]};
        ${c} sourceLocG = coords;
        ++${u[l-2]};
        ${c} sourceLocA = coords;
        --${u[l-1]};
        ${c} sourceLocB = coords;
        --${u[l-2]};`;const f=["x","y","z","w","u","v"].slice(0,h),p="."+f[h-1],m=f.map(I=>"int "+I),g=ir("sourceLocR",h-1).concat("inIdx.r"),y=ir("sourceLocG",h-1).concat("inIdx.g"),x=ir("sourceLocB",h-1).concat("inIdx.b"),v=ir("sourceLocA",h-1).concat("inIdx.a"),b=s==="max"?"greaterThan":"lessThan",k=r?"":`
          inIdx = round(vec4(getBestIndicesAChannel(${g.join()}),
                             getBestIndicesAChannel(${y.join()}),
                             getBestIndicesAChannel(${x.join()}),
                             getBestIndicesAChannel(${v.join()})));`,C=`vec4(
            getAChannel(${g.join()}),
            hasNextCol ? getAChannel(${y.join()}) : 0.,
            hasNextRow ? getAChannel(${x.join()}) : 0.,
            hasNextRow && hasNextCol ? getAChannel(${v.join()}) : 0.)`,N=r?"":`
      float getBestIndicesAChannel(${m.join()}) {
        return getChannel(getBestIndicesA(${f.join()}),
                                          vec2(${f.slice(-2).join()}));
      }`;this.userCode=`
      float getAChannel(${m.join()}) {
        return getChannel(getA(${f.join()}),
                               vec2(${f.slice(-2).join()}));
      }
      ${N}
      void main() {
        ${c} coords = getOutputCoords();
        bool hasNextCol = ${u[l-1]} < ${a[l-1]-1};
        bool hasNextRow = ${u[l-2]} < ${a[l-2]-1};
        ${d}
        ivec4 srcIdx = ivec4(sourceLocR${p}, sourceLocG${p},
          sourceLocB${p}, sourceLocA${p}) * ${n};
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = ${C};

        for (int i = 0; i < ${n}; i++) {
          inIdx = srcIdx;
          ${k}
          vec4 candidate = ${C};
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(${b}(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o7(t,e,n,s=null){let r=e.shape[0],i=e.shape[1];s!=null&&(r=s.shape[0],i=s.shape[1]);const o=XS(i),a={windowSize:o,inSize:i,batchSize:r,outSize:Math.ceil(i/o)},l=new MLe(a,n,s==null),c=[e];s!=null&&c.push(s);const u=t.runWebGLProgram(l,c,"int32");if(u.shape[1]===1)return u;const d=o7(t,e,n,u);return t.disposeIntermediateTensorInfo(u),d}function a7(t,e,n,s=null){const r=s!=null?s.shape:e.shape,i=r[r.length-1],o=XS(i),a=new zLe(r,o,n,s==null),l=s==null?[e]:[e,s],c=t.runWebGLProgram(a,l,"int32");if(c.shape.length===e.shape.length){const u=a7(t,e,n,c);return t.disposeIntermediateTensorInfo(c),u}return c}function l7(t,e,n,s){const r=[n];if(zs("arg"+s.charAt(0).toUpperCase()+s.slice(1),r,e.shape.length),!oe().getBool("WEBGL_PACK_REDUCE")||e.shape.length<=2){const i=[],o=t.texData.get(e.dataId),a=o!==null&&o.isPacked;let l=e;a&&(l=t.unpackTensor(e),i.push(l));const[c,u]=Ns(l.shape,r),d=le(u),h=_e({inputs:{x:l},backend:t,attrs:{shape:[-1,d]}});i.push(h);const f=o7(t,h,s);i.push(f);const p=_e({inputs:{x:f},backend:t,attrs:{shape:c}});return i.forEach(m=>t.disposeIntermediateTensorInfo(m)),p}return a7(t,e,s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VLe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i}=s;let o=bt(i,r.shape);const a=In(o,r.shape.length);let l=r;const c=[];a!=null&&(l=lr({inputs:{x:r},backend:n,attrs:{perm:a}}),c.push(l),o=Gn(o.length,l.shape.length)),zs("argMax",[o[0]],l.shape.length);const u=l7(n,l,o[0],"max");return c.forEach(d=>n.disposeIntermediateTensorInfo(d)),u}const jLe={kernelName:T1,backendName:"webgl",kernelFunc:VLe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BLe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i}=s;let o=bt(i,r.shape);const a=In(o,r.shape.length);let l=r;const c=[];a!=null&&(l=lr({inputs:{x:r},backend:n,attrs:{perm:a}}),c.push(l),o=Gn(o.length,l.shape.length)),zs("argMin",[o[0]],l.shape.length);const u=l7(n,l,o[0],"min");return c.forEach(d=>n.disposeIntermediateTensorInfo(d)),u}const WLe={kernelName:N1,backendName:"webgl",kernelFunc:BLe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ULe=fo+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,HLe=Dt({opSnippet:ULe}),GLe={kernelName:Sy,backendName:"webgl",kernelFunc:HLe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KLe=fo+"return log(x + sqrt(x * x + 1.0));",qLe=Dt({opSnippet:KLe}),XLe={kernelName:ky,backendName:"webgl",kernelFunc:qLe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YLe=fo+`
  return atan(x);
`,ZLe=Dt({opSnippet:YLe}),QLe={kernelName:Cy,backendName:"webgl",kernelFunc:ZLe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JLe=RD+`
  return atan(a, b);
`,eMe=`
  vec4 result = atan(a, b);
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+V0+`
  return result;
`,tMe=Vs({opSnippet:JLe,packedOpSnippet:eMe}),nMe={kernelName:Ny,backendName:"webgl",kernelFunc:tMe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sMe=fo+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,rMe=Dt({opSnippet:sMe}),iMe={kernelName:Ty,backendName:"webgl",kernelFunc:rMe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Lg{constructor(e,n,s,r=!1,i=!1){if(this.variableNames=["x"],n==="avg"&&s)throw new Error("Cannot compute positions for average pool.");const o=e.filterWidth,a=e.strideHeight,l=e.strideWidth,c=e.dilationHeight,u=e.dilationWidth,d=e.effectiveFilterHeight,h=e.effectiveFilterWidth,f=e.padInfo.top,p=e.padInfo.left;this.outputShape=e.outShape;const m=n==="avg",g=`((batch  * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + d`,y=`(xR * ${e.inWidth} + xC) * ${e.inChannels} + d`;let x="0.0";if(m||(x="-1.0 / 1e-20"),s){const I=">=";this.userCode=`
        const ivec2 strides = ivec2(${a}, ${l});
        const ivec2 pads = ivec2(${f}, ${p});

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < ${d};
              wR += ${c}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${h};
                wC += ${u}) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value ${I} currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = ${r?i?g:y:`wR * ${h} + wC`};
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const v="max";let b=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="avg"&&(b="avgValue / count");const k=Math.floor(o/4)*4,C=o%4,N=`
      if (${m}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${v}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(${a}, ${l});
      const ivec2 pads = ivec2(${f}, ${p});
      const float initializationValue = ${x};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(${x});
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < ${d};
            wR += ${c}) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${k}; wC += 4) {
            int xC = xCCorner + wC * ${u};

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${u}, d),
              getValue(batch, xR, xC + 2 * ${u}, d),
              getValue(batch, xR, xC + 3 * ${u}, d)
            );

            ${N}
          }

          int xC = xCCorner + ${k};
          if (${C===1}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            ${N}
          } else if (${C===2}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${u}, d),
              initializationValue,
              initializationValue
            );

            ${N}
          } else if (${C===3}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${u}, d),
              getValue(batch, xR, xC + 2 * ${u}, d),
              initializationValue
            );

            ${N}
          }
        }
        setOutput(${b});
      }
    `}}class OD{constructor(e,n,s,r=!1,i=!1){if(this.variableNames=["x"],n==="avg"&&s)throw new Error("Cannot compute positions for average pool.");const o=e.filterWidth,a=e.strideDepth,l=e.strideHeight,c=e.strideWidth,u=e.dilationDepth,d=e.dilationHeight,h=e.dilationWidth,f=e.effectiveFilterDepth,p=e.effectiveFilterHeight,m=e.effectiveFilterWidth,g=e.padInfo.front,y=e.padInfo.top,x=e.padInfo.left;this.outputShape=e.outShape;const v=n==="avg";let b="0.0";if(v||(b="-1.0 / 1e-20"),s){const A=">=";this.userCode=`
        const ivec3 strides =
            ivec3(${a}, ${l}, ${c});
        const ivec3 pads = ivec3(${g}, ${y}, ${x});

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < ${f};
              wD += ${u}) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= ${e.inDepth}) {
              continue;
            }

            for (int wR = 0; wR < ${p};
                wR += ${d}) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int wC = 0; wC < ${m};
                  wC += ${h}) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value ${A} currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition = ${r?i?`(((batch * ${e.inDepth} + xD) * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`((xD * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`wD * ${p} * ${m} +
                      wR * ${m} + wC`};
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const k="max";let C=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="avg"&&(C="avgValue / count");const N=Math.floor(o/4)*4,I=o%4,$=`
      if (${v}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${k}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(${a}, ${l}, ${c});
      const ivec3 pads = ivec3(${g}, ${y}, ${x});
      const float initializationValue = ${b};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(${b});
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < ${f};
            wD += ${u}) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${p};
            wR += ${d}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${N}; wC += 4) {
              int xC = xCCorner + wC * ${h};

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${h}, ch),
                getValue(batch, xD, xR, xC + 2 * ${h}, ch),
                getValue(batch, xD, xR, xC + 3 * ${h}, ch)
              );

              ${$}
            }

            int xC = xCCorner + ${N};
            if (${I===1}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              ${$}
            } else if (${I===2}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${h}, ch),
                initializationValue,
                initializationValue
              );

              ${$}
            } else if (${I===3}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${h}, ch),
                getValue(batch, xD, xR, xC + 2 * ${h}, ch),
                initializationValue
              );

              ${$}
            }
          }
          setOutput(${C});
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oMe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e;M0(r,"avgPool");const{filterSize:i,strides:o,pad:a,dimRoundingMode:l}=s,c=1;O(Ms(o,c),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${c}'`);const u=uo(r.shape,i,o,c,a,l);if(u.filterWidth===1&&u.filterHeight===1&&Et(u.inShape,u.outShape))return ei({inputs:{x:r},backend:n});const d=new Lg(u,"avg",!1);return n.runWebGLProgram(d,[r],"float32")}const aMe={kernelName:I1,backendName:"webgl",kernelFunc:oMe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lMe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{filterSize:i,strides:o,pad:a,dimRoundingMode:l,dataFormat:c}=s,u=[1,1,1],d=wl(r.shape,i,o,u,a,l,c),h=new OD(d,"avg",!1);return n.runWebGLProgram(h,[r],"float32")}const cMe={kernelName:_1,backendName:"webgl",kernelFunc:lMe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class uMe{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const n=e.filterHeight,s=e.filterWidth,r=e.strideHeight,i=e.strideWidth,o=e.dilationHeight,a=e.dilationWidth,l=e.effectiveFilterHeight,c=e.effectiveFilterWidth,u=l-1-e.padInfo.top,d=c-1-e.padInfo.left,h=1/(n*s);this.userCode=`
      const ivec2 pads = ivec2(${u}, ${d});
      const float avgMultiplier = float(${h});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${l};
            wR += ${o}) {
          float dyR = float(dyRCorner + wR) / ${r}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${c};
            wC+= ${a}) {
            float dyC = float(dyCCorner + wC) / ${i}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `}}class dMe{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const n=e.filterDepth,s=e.filterHeight,r=e.filterWidth,i=e.strideDepth,o=e.strideHeight,a=e.strideWidth,l=e.dilationDepth,c=e.dilationHeight,u=e.dilationWidth,d=e.effectiveFilterDepth,h=e.effectiveFilterHeight,f=e.effectiveFilterWidth,p=d-1-e.padInfo.front,m=h-1-e.padInfo.top,g=f-1-e.padInfo.left,y=1/(n*s*r);this.userCode=`
      const ivec3 pads = ivec3(${p}, ${m}, ${g});
      const float avgMultiplier = float(${y});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${d};
            wD += ${l}) {
          float dyD = float(dyDCorner + wD) / ${i}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${h};
              wR += ${c}) {
            float dyR = float(dyRCorner + wR) / ${o}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${f};
                wC += ${u}) {
              float dyC = float(dyCCorner + wC) / ${a}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hMe(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:i}=e,o=i,{filterSize:a,strides:l,pad:c,dimRoundingMode:u}=s,d=[1,1,1],h=wl(o.shape,a,l,d,c,u),f=new dMe(h);return n.runWebGLProgram(f,[r],o.dtype)}const fMe={kernelName:w$,backendName:"webgl",kernelFunc:hMe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pMe(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:i}=e,o=i;M0([r,i],"avgPoolGrad");const{filterSize:a,strides:l,pad:c}=s,u=uo(o.shape,a,l,1,c),d=new uMe(u);return n.runWebGLProgram(d,[r],o.dtype)}const mMe={kernelName:b$,backendName:"webgl",kernelFunc:pMe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gMe(t){const{inputs:e,backend:n,attrs:s}=t,{a:r,b:i}=e,{transposeA:o,transposeB:a}=s;return kw({a:r,b:i,transposeA:o,transposeB:a,backend:n})}const yMe={kernelName:E1,backendName:"webgl",kernelFunc:gMe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xMe{constructor(e,n,s,r,i,o){this.outputShape=[],this.variableNames=["x","mean","variance"],ct(e,n),ct(e,s);let a="0.0";r!=null&&(ct(e,r),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let l="1.0";i!=null&&(ct(e,i),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = ${a};
        float scale = ${l};
        float inv = scale * inversesqrt(variance + float(${o}));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class vMe{constructor(e,n,s,r,i,o){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],ct(e,n),ct(e,s);let a="vec4(0.0)";r!=null&&(ct(e,r),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let l="vec4(1.0)";i!=null&&(ct(e,i),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        vec4 offset = ${a};
        vec4 scale = ${l};

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(${o}));

        setOutput((x - mean) * inv + offset);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bMe=({inputs:t,backend:e,attrs:n})=>{const{x:s,mean:r,variance:i,offset:o,scale:a}=t;O(r.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),O(o==null||r.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),O(a==null||r.shape.length===a.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let{varianceEpsilon:l}=n;l==null&&(l=.001);const c=[s,r,i];let u=null;o!=null&&(u=o.shape,c.push(o));let d=null;a!=null&&(d=a.shape,c.push(a));const h=oe().getBool("WEBGL_PACK_NORMALIZATION")?new vMe(s.shape,r.shape,i.shape,u,d,l):new xMe(s.shape,r.shape,i.shape,u,d,l);return e.runWebGLProgram(h,c,c[0].dtype)},wMe={kernelName:j1,backendName:"webgl",kernelFunc:bMe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class SMe{constructor(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;const n=sn(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const s=kMe(this.rank);let r;const i=e.map((o,a)=>`sourceLoc.${II[a]} = start[${a}] + coords.${II[a]};`);r=`
        ${n} sourceLoc;
        ${n} coords = getOutputCoords();
        ${i.join(`
`)}
      `,this.userCode=`
      void main() {
        ${r}
        setOutput(getSource(${s}));
      }
    `}}const II=["x","y","z","w","u","v"];function kMe(t){if(t===1)return"sourceLoc";if(t<=6)return II.slice(0,t).map(e=>"sourceLoc."+e).join(",");throw Error(`Slicing for rank ${t} is not yet supported`)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class CMe{constructor(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const n=sn(this.rank),s=ir("coords",this.rank),r=ir("sourceLoc",this.rank),i=this.rank===1?"sourceLoc":`vec2(${r.slice(-2).join()})`,o=`getChannel(getSource(${r.join()}), ${i})`,a=`
      result.x = ${o};
      if (++${s[this.rank-1]} < ${e[this.rank-1]}) {
        ++${r[this.rank-1]};
        result.y = ${o};
        --${r[this.rank-1]};
      }
    `,l=this.rank===1?"":`
      --${s[this.rank-1]};
      if (++${s[this.rank-2]} < ${e[this.rank-2]}) {
        ++${r[this.rank-2]};
        result.z = ${o};
        if (++${s[this.rank-1]} < ${e[this.rank-1]}) {
          ++${r[this.rank-1]};
          result.w = ${o};
        }
      }
    `,c=this.rank<=4?`sourceLoc = coords +
            ${n}(${e.map((u,d)=>`start[${d}]`).join()});`:e.map((u,d)=>`${r[d]} = ${s[d]} + start[${d}];`).join(`
`);this.userCode=`
      void main() {
        ${n} coords = getOutputCoords();
        ${n} sourceLoc;
        ${c}
        vec4 result = vec4(0.);
        ${a}
        ${l}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TMe(t,e,n,s){const r=s.texData.get(t.dataId),i=s.makeTensorInfo(n,t.dtype),o=s.texData.get(i.dataId);Object.assign(o,r),o.refCount=1,o.shape=n,o.dtype=t.dtype;let a=RA(e,Ye(t.shape));r.slice&&(a+=r.slice.flatOffset),o.slice={flatOffset:a,origDataId:r.slice&&r.slice.origDataId||t.dataId};const l=s.dataRefCount.get(o.slice.origDataId)||1;return s.dataRefCount.set(o.slice.origDataId,l+1),i}function vp(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{begin:i,size:o}=s,[a,l]=IS(r,i,o);if(EA(r,a,l),le(l)===0)return n.makeTensorInfo(l,r.dtype,[]);if(n.shouldExecuteOnCPU([r])||r.dtype==="string"){const d=n.texData.get(r.dataId),h=xFe(d.values,a,l,r.shape,r.dtype);return n.makeTensorInfo(l,r.dtype,h)}const{isPacked:c}=n.texData.get(r.dataId),u=AA(r.shape,a,l);if(c||!u){const d=oe().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new CMe(l):new SMe(l),h=[a];return n.runWebGLProgram(d,[r],r.dtype,h)}return n.uploadToGPU(r.dataId),TMe(r,a,l,n)}const NMe={kernelName:gS,backendName:"webgl",kernelFunc:vp};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IMe=t=>{const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{blockShape:i,crops:o}=s;O(r.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");const a=i.reduce((x,v)=>x*v),l=C0(r.shape,i,a),c=T0(l.length,i.length),u=N0(r.shape,i,a),d=AR(o,i.length),h=RR(u,o,i.length),f=[],p=_e({inputs:{x:r},backend:n,attrs:{shape:l}}),m=lr({inputs:{x:p},backend:n,attrs:{perm:c}}),g=_e({inputs:{x:m},backend:n,attrs:{shape:u}}),y=vp({inputs:{x:g},backend:n,attrs:{begin:d,size:h}});return f.push(p),f.push(m),f.push(g),f.forEach(x=>n.disposeIntermediateTensorInfo(x)),y},_Me={kernelName:$1,backendName:"webgl",kernelFunc:IMe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EMe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,weights:i}=e,{size:o}=s,a=n.readSync(r.dataId),l=n.readSync(i.dataId),c=XX(a,l,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,c)}const $Me={kernelName:S$,backendName:"webgl",kernelFunc:EMe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AMe(t){const{inputs:e,backend:n}=t,{s0:s,s1:r}=e,i=n.readSync(s.dataId),o=n.readSync(r.dataId),a=ct(Array.from(i),Array.from(o));return n.makeTensorInfo([a.length],"int32",Int32Array.from(a))}const RMe={kernelName:k$,backendName:"webgl",kernelFunc:AMe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DMe="return float(a != b);",c7=Vs({opSnippet:DMe,cpuKernelImpl:uFe,dtype:"bool"}),OMe={kernelName:rS,backendName:"webgl",kernelFunc:c7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B0(t){const{inputs:e,backend:n}=t,{input:s}=e,r=n.texData.get(s.dataId);return ei({inputs:{x:r.complexTensorInfos.real},backend:n})}const PMe={kernelName:tA,backendName:"webgl",kernelFunc:B0};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FMe="return float(int(x));";function LMe(t,e){const n=new sl(t.shape,FMe),s=e.runWebGLProgram(n,[t],"int32");return{dataId:s.dataId,shape:s.shape,dtype:s.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _I(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{dtype:i}=s;if(i==="complex64"){if(r.dtype==="complex64")return ei({inputs:{x:r},backend:n});const o=es(r.shape),a=_I({inputs:{x:r},backend:n,attrs:{dtype:"float32"}}),l=cu({inputs:{real:a,imag:o},backend:n});return o.dispose(),n.disposeIntermediateTensorInfo(a),l}if(r.dtype==="complex64"){const o=B0({inputs:{input:r},backend:n}),a=_I({inputs:{x:o},backend:n,attrs:{dtype:i}});return n.disposeIntermediateTensorInfo(o),a}if(!E6(r.dtype,i)){const o=ei({inputs:{x:r},backend:n});return{dataId:o.dataId,shape:o.shape,dtype:i}}if(n.shouldExecuteOnCPU([r])){const o=n.texData.get(r.dataId).values,[a,l,c]=UPe(o,r.shape,r.dtype,i);return n.makeTensorInfo(a,l,c)}if(i==="int32")return LMe(r,n);if(i==="bool"){const o=n.makeTensorInfo([],"bool",Cs("bool",1)),l=c7({inputs:{a:r,b:o},backend:n});return n.disposeIntermediateTensorInfo(o),l}throw new Error(`Error in Cast: failed to cast ${r.dtype} to ${i}`)}const MMe={kernelName:Iy,backendName:"webgl",kernelFunc:_I};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kV="return ceil(x);",zMe=Dt({opSnippet:kV,packedOpSnippet:kV,cpuKernelImpl:HPe}),VMe={kernelName:_y,backendName:"webgl",kernelFunc:zMe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class jMe{constructor(e){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class BMe{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`
      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WMe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{clipValueMin:i,clipValueMax:o}=s;let a;oe().getBool("WEBGL_PACK_CLIP")?a=new BMe(r.shape):a=new jMe(r.shape);const l=[[i],[o]];return n.runWebGLProgram(a,[r],r.dtype,l)}const UMe={kernelName:Ey,backendName:"webgl",kernelFunc:WMe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class HMe{constructor(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CV(t,e){return{dataId:e.dataId,dtype:e.dtype,shape:t.shape}}function GMe(t){const{inputs:e,backend:n}=t,{x:s}=e,r=n.texData.get(s.dataId),i=new HMe(s.shape),o=[CV(s,r.complexTensorInfos.real),CV(s,r.complexTensorInfos.imag)];return n.runWebGLProgram(i,o,o[0].dtype)}const KMe={kernelName:A1,backendName:"webgl",kernelFunc:GMe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class qMe{constructor(e){this.outputShape=[],this.outputShape=Sa(e,1),this.variableNames=e.map((o,a)=>`T${a}`);const n=new Array(e.length-1);n[0]=e[0][1];for(let o=1;o<n.length;o++)n[o]=n[o-1]+e[o][1];const s=[`if (yC < ${n[0]}) setOutput(getT0(yR, yC));`];for(let o=1;o<n.length;o++){const a=n[o-1];s.push(`else if (yC < ${n[o]}) setOutput(getT${o}(yR, yC-${a}));`)}const r=n.length,i=n[n.length-1];s.push(`else setOutput(getT${r}(yR, yC-${i}));`),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        ${s.join(`
        `)}
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class XMe{constructor(e,n){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=Sa(e,n);const s=this.outputShape,r=s.length,i=sn(r),o=ir("coords",r),a=["x","y","z","w","u","v"].slice(0,r);this.variableNames=e.map((m,g)=>`T${g}`);const l=new Array(e.length-1);l[0]=e[0][n];for(let m=1;m<l.length;m++)l[m]=l[m-1]+e[m][n];const c=a[n],u=a.slice(-2),d=a.join();let h=`if (${c} < ${l[0]}) {
        return getChannel(
            getT0(${d}), vec2(${u.join()}));
        }`;for(let m=1;m<l.length;m++){const g=l[m-1];h+=`
        if (${c} < ${l[m]}  && ${c} >= ${l[m-1]}) {
          return getChannel(
            getT${m}(${tv(a,c,g)}),
            vec2(${tv(u,c,g)}));
        }`}const f=l.length,p=l[l.length-1];h+=`
        return getChannel(
          getT${f}(${tv(a,c,p)}),
          vec2(${tv(u,c,p)}));`,this.userCode=`
      float getValue(${a.map(m=>"int "+m)}) {
        ${h}
      }

      void main() {
        ${i} coords = getOutputCoords();
        vec4 result = vec4(getValue(${o}), 0., 0., 0.);

        ${o[r-1]} = ${o[r-1]} + 1;
        if (${o[r-1]} < ${s[r-1]}) {
          result.g = getValue(${o});
        }

        ${o[r-2]} = ${o[r-2]} + 1;
        if (${o[r-2]} < ${s[r-2]}) {
          result.a = getValue(${o});
        }

        ${o[r-1]} = ${o[r-1]} - 1;
        if (${o[r-2]} < ${s[r-2]} &&
            ${o[r-1]} < ${s[r-1]}) {
          result.b = getValue(${o});
        }
        setOutput(result);
      }
    `}}function tv(t,e,n){const s=t.indexOf(e);return t.map((i,o)=>o===s?`${i} - ${n}`:i).join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mk(t){const{inputs:e,backend:n}=t,{input:s}=e,r=n.texData.get(s.dataId);return ei({inputs:{x:r.complexTensorInfos.imag},backend:n})}const YMe={kernelName:B$,backendName:"webgl",kernelFunc:mk};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sm(t,e,n){const s=t[0].dtype;if(s==="complex64"){const d=t.map(g=>B0({inputs:{input:g},backend:n})),h=t.map(g=>mk({inputs:{input:g},backend:n})),f=Sm(d,e,n),p=Sm(h,e,n),m=cu({inputs:{real:f,imag:p},backend:n});return d.forEach(g=>n.disposeIntermediateTensorInfo(g)),h.forEach(g=>n.disposeIntermediateTensorInfo(g)),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),m}let r=n.shouldExecuteOnCPU(t);if(s==="string"&&(r=!0),r){const d=t.map(x=>{const b=[-1,le(x.shape.slice(e))];return _e({inputs:{x},backend:n,attrs:{shape:b}})}),h=d.map(x=>({vals:n.readSync(x.dataId),shape:x.shape})),f=Sa(d.map(x=>x.shape),1),p=d[0].shape[0]===1,m=GPe(h,f,s,p),g=Sa(t.map(x=>x.shape),e),y=n.makeTensorInfo(g,s,m);return d.forEach(x=>n.disposeIntermediateTensorInfo(x)),y}const i=oe().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(t.length>i){const d=[];for(let f=0;f<t.length;f+=i){const p=t.slice(f,f+i);d.push(Sm(p,e,n))}const h=Sm(d,e,n);for(const f of d)n.disposeIntermediateTensorInfo(f);return h}if(oe().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&t[0].shape.length>1){const d=new XMe(t.map(h=>h.shape),e);return n.runWebGLProgram(d,t,s)}const{tensors2D:o,outShape:a}=ZMe(t,e,n),l=new qMe(o.map(d=>d.shape)),c=n.runWebGLProgram(l,o,s);o.forEach(d=>n.disposeIntermediateTensorInfo(d));const u=_e({inputs:{x:c},attrs:{shape:a},backend:n});return n.disposeIntermediateTensorInfo(c),u}function ZMe(t,e,n){const s=Sa(t.map(i=>i.shape),e);return{tensors2D:t.map(i=>_e({inputs:{x:i},attrs:{shape:[-1,le(i.shape.slice(e))]},backend:n})),outShape:s}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u7(t){const{inputs:e,backend:n,attrs:s}=t,{axis:r}=s,i=bt(r,e[0].shape)[0],o=e.map(c=>c.shape);_R(o,i);const a=Sa(e.map(c=>c.shape),i);if(le(a)===0)return n.makeTensorInfo(a,e[0].dtype,[]);const l=e.filter(c=>le(c.shape)>0);return l.length===1?ei({inputs:{x:l[0]},backend:n}):Sm(l,i,n)}const QMe={kernelName:R1,backendName:"webgl",kernelFunc:u7};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class d7{constructor(e,n=!1,s=null,r=!1,i=!1){this.variableNames=["x","W"],this.outputShape=e.outShape;const o=e.padInfo.top,a=e.padInfo.left,l=e.strideHeight,c=e.strideWidth,u=e.dilationHeight,d=e.dilationWidth,h=e.filterHeight,f=e.filterWidth,p=Math.floor(e.inChannels/4)*4,m=e.inChannels%4,g=e.dataFormat==="channelsLast",y=g?1:2,x=g?2:3,v=g?3:1;let b="",k="";s&&(r?b=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:i?b=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:b=`
          float activation(float x) {
            ${s}
          }
        `,k="result = activation(result);");const C=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${b}

      const ivec2 strides = ivec2(${l}, ${c});
      const ivec2 pads = ivec2(${o}, ${a});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[${v}];

        ivec2 xRCCorner =
            ivec2(coords[${y}], coords[${x}]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${h}; wR++) {
          int xR = xRCorner + wR * ${u};

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${f}; wC++) {
            int xC = xCCorner + wC * ${d};

            if (xC < 0 || xC >= ${e.inWidth}) {
              continue;
            }

            for (int d1 = 0; d1 < ${p}; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (${g}) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (${m===1}) {

              if (${g}) {
                dotProd +=
                    getX(batch, xR, xC, ${p}) *
                    getW(wR, wC, ${p}, d2);
              } else {
                dotProd +=
                    getX(batch, ${p}, xR, xC) *
                    getW(wR, wC, ${p}, d2);
              }

            } else if (${m===2}) {
              vec2 wValues = vec2(
                getW(wR, wC, ${p}, d2),
                getW(wR, wC, ${p} + 1, d2)
              );

              if (${g}) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, ${p}),
                  getX(batch, xR, xC, ${p} + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, ${p}, xR, xC),
                  getX(batch, ${p} + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (${m===3}) {
              vec3 wValues = vec3(
                getW(wR, wC, ${p}, d2),
                getW(wR, wC, ${p} + 1, d2),
                getW(wR, wC, ${p} + 2, d2)
              );

              if (${g}) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, ${p}),
                  getX(batch, xR, xC, ${p} + 1),
                  getX(batch, xR, xC, ${p} + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, ${p}, xR, xC),
                  getX(batch, ${p} + 1, xR, xC),
                  getX(batch, ${p} + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        ${C}
        ${k}
        setOutput(result);
      }
    `}}class JMe{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const n=e.padInfo.front,s=e.padInfo.top,r=e.padInfo.left,i=e.strideDepth,o=e.strideHeight,a=e.strideWidth,l=e.dilationDepth,c=e.dilationHeight,u=e.dilationWidth,d=e.filterDepth,h=e.filterHeight,f=e.filterWidth,p=Math.floor(e.inChannels/4)*4,m=e.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(${i}, ${o}, ${a});
      const ivec3 pads = ivec3(${n}, ${s}, ${r});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < ${d}; wF++) {
          int xF = xFCorner + wF * ${l};

          if (xF < 0 || xF >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${h}; wR++) {
            int xR = xRCorner + wR * ${c};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${f}; wC++) {
              int xC = xCCorner + wC * ${u};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              for (int d1 = 0; d1 < ${p}; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (${m===1}) {
                dotProd +=
                  getX(batch, xF, xR, xC, ${p}) *
                  getW(wF, wR, wC, ${p}, d2);
              } else if (${m===2}) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, ${p}),
                  getX(batch, xF, xR, xC, ${p} + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, ${p}, d2),
                  getW(wF, wR, wC, ${p} + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (${m===3}) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, ${p}),
                  getX(batch, xF, xR, xC, ${p} + 1),
                  getX(batch, xF, xR, xC, ${p} + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, ${p}, d2),
                  getW(wF, wR, wC, ${p} + 1, d2),
                  getW(wF, wR, wC, ${p} + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class h7{constructor(e,n=!1,s=null,r=!1,i=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=dr(this.outputShape.length);const o=e.padInfo.left,a=e.strideWidth,l=e.dilationWidth,c=e.filterHeight,u=e.filterWidth,d=u;let h=`
       int xR; int xC; int xCOffset;
       vec4 wTexel; vec4 previous; vec4 final;`;for(let g=0;g<u;g++)h+=`
           vec4 xTexelC${g*2};
           int xTexelC${g*2}Ready;
           vec4 xTexelC${g*2+1};
           int xTexelC${g*2+1}Ready;
           vec4 xC${g};`;h+=`
     for (int r = 0; r < ${c}; r++) {
      for (int d1 = 0; d1 < ${e.inChannels}; d1 += 2) {
       `;for(let g=0;g<u;g++)h+=`
           xTexelC${g*2} = vec4(0.0);
           xTexelC${g*2}Ready = 0;
           xTexelC${g*2+1} = vec4(0.0);
           xTexelC${g*2+1}Ready = 0;
           xC${g} = vec4(0.0);`;h+=`
         xR = xRCorner + r * dilations[0];
         if (xR >=0 && xR < inDims[0]) {
       `;for(let g=0;g<(d+1)/2;g++){const y=g*2;if(h+=`
           xC = xCCorner + ${y*l};
           `,a===1){if(y<u&&(o%2===1?(h+=`
                 xCOffset = xC + 1;
                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y}Ready == 0) {
                   xTexelC${y} = getX(batch, xR, xCOffset, d1);

                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${y}.zw = vec2(0.0);
                   }
                   xTexelC${y}Ready = 1;
                 }
               `,l===1&&y>0?h+=`
                 xC${y} = vec4(xTexelC${y-2}.zw, xTexelC${y}.xy);
                 `:h+=`
                   xCOffset = xC + 1 - 2;

                   if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       previous.zw = vec2(0.0);
                     }

                     xC${y} = vec4(previous.zw, xTexelC${y}.xy);
                   } else {
                     xC${y} = vec4(0.0, 0.0, xTexelC${y}.xy);
                   }
                   `):h+=`
                 if (xC >= 0 && xC < inDims[1] && xTexelC${y}Ready == 0) {
                   xTexelC${y} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${y}.zw = vec2(0.0);
                   }
                   xTexelC${y}Ready = 1;
                 }

                 xC${y} = xTexelC${y};
                 `,y+1<u)){const x=o%2===0?m$(l):l;l%2===0&&o%2===1||l%2!==0&&o%2!==1?(h+=`
                   xCOffset = xC + imod(pads[1], 2) + ${x};

                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y+1}Ready == 0) {
                     xTexelC${y+1} = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       xTexelC${y+1}.zw = vec2(0.0);
                     }
                     xTexelC${y+1}Ready = 1;
                   }
                   `,l>1?h+=`
                     xCOffset -= 2;
                     if (xCOffset >= 0 && xCOffset < inDims[1]) {
                      previous = getX(batch, xR, xCOffset, d1);
                      xC${y+1} = vec4(previous.zw, xTexelC${y+1}.xy);
                     } else {
                      xC${y+1} = vec4(0.0, 0.0, xTexelC${y+1}.xy);
                     }
                     `:h+=`
                     xC${y+1} = vec4(xTexelC${y}.zw, xTexelC${y+1}.xy);
                     `):x===1?h+=`
                     xC${y+1} = xTexelC${y};
                     `:h+=`
                     xCOffset = xC + ${x};

                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y+1}Ready == 0) {
                       xTexelC${y+1} = getX(batch, xR, xCOffset, d1);
                       if (xCOffset + 1 >= inDims[1]) {
                         xTexelC${y+1}.zw = vec2(0.0);
                       }
                       xTexelC${y+1}Ready = 1;
                     }

                     xC${y+1} = xTexelC${y+1};
                     `}}else y<u&&(o%2===1?(h+=`
                 xCOffset = xC + 1 - strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y}Ready == 0) {
                   xTexelC${y} = getX(batch, xR, xCOffset, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${y}.zw = vec2(0.0);
                   }
                   xTexelC${y}Ready = 1;
                 }

                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${y+1}Ready == 0) {
                   xTexelC${y+1} = getX(batch, xR, xC + 1, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xC + 2 >= inDims[1]) {
                     xTexelC${y+1}.zw = vec2(0.0);
                   }
                   xTexelC${y+1}Ready = 1;
                 }

                 xC${y} = vec4(xTexelC${y}.zw, xTexelC${y+1}.zw);
               `,y+1<u&&(h+=`
                   final = vec4(0.0);
                   xCOffset = xC + 1 + strides[1];
                   if(xCOffset >= 0 && xCOffset < inDims[1]) {
                     final = getX(batch, xR, xCOffset, d1);
                   }
                   xC${y+1} = vec4(xTexelC${y+1}.xy, final.xy);
                 `)):(h+=`
                 if(xC >= 0 && xC < inDims[1] && xTexelC${y}Ready == 0) {
                   xTexelC${y} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${y}.zw = vec2(0.0);
                   }
                   xTexelC${y}Ready = 1;
                 }

                 xCOffset = xC + strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y+1}Ready == 0) {
                   xTexelC${y+1} = getX(batch, xR, xCOffset, d1);
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${y+1}.zw = vec2(0.);
                   }
                   xTexelC${y+1}Ready = 1;
                 }

                 xC${y} = vec4(
                   xTexelC${y}.xy, xTexelC${y+1}.xy);
               `,y+1<u&&(h+=`
                   xC${y+1} = vec4(xTexelC${y}.zw, xTexelC${y+1}.zw);
                 `)));y<u&&(h+=`
             wTexel = getW(r, ${y}, d1, d2);
             dotProd += xC${y}.xxzz * vec4(wTexel.xy, wTexel.xy);
             if(d1 + 1 < ${e.inChannels}) {
               dotProd += xC${y}.yyww * vec4(wTexel.zw, wTexel.zw);
             }
           `,y+1<u&&(h+=`
               wTexel = getW(r, ${y+1}, d1, d2);
               dotProd += xC${y+1}.xxzz * vec4(wTexel.xy, wTexel.xy);
               if(d1 + 1 < ${e.inChannels}) {
                 dotProd += xC${y+1}.yyww * vec4(wTexel.zw, wTexel.zw);
               }
             `))}h+=`
     }
   `,h+=`
     }
   `,h+=`
     }
   `;let f="",p="";s&&(r?f=`vec4 activation(vec4 a) {
           vec4 b = getPreluActivationWeightsAtOutCoords();
           ${s}
         }`:i?f=`vec4 activation(vec4 a) {
           vec4 b = getLeakyreluAlphaAtOutCoords();
           ${s}
         }`:f=`vec4 activation(vec4 x) {
           ${s}
         }`,p="result = activation(result);");const m=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
       ${f}

       void main() {
         ivec4 coords = getOutputCoords();
         int batch = coords.x;
         ivec2 xRCCorner = coords.yz * strides - pads;
         int d2 = coords.w;
         int xRCorner = xRCCorner.x;
         int xCCorner = xRCCorner.y;

         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
         vec4 dotProd = vec4(0.000000000000001);

         ${h}

         vec4 result = dotProd - vec4(0.000000000000001);
         ${m}
         ${p}
         setOutput(result);
       }
     `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class e3e{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=e,this.enableShapeUniforms=dr(this.outputShape.length);const{dataFormat:s}=n,r=ur(),i=s==="channelsLast",o=i?1:2,a=i?2:3,l=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":`if(blockIndex < ${e[2]} && pos < ${e[1]}) {`;let c="";for(let u=0;u<=1;u++)for(let d=0;d<=1;d++)c+=`
          blockIndex = rc.z + ${d};
          pos = rc.y + ${u};

          ${l}
            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];
            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);

            if(d0 < inputShape[${o}] && d0 >= 0) {
              // Use custom imod instead mod. On Intel GPU, mod may generate
              // unexpected value.
              // https://github.com/tensorflow/tfjs/issues/5447
              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];
              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /
                  inChannels);

              if(d1 < inputShape[${a}] && d1 >= 0) {

                ch = imod(pos, inChannels);

                if (${i}) {
                  innerDims = vec2(d1, ch);
                  result[${u*2+d}] = getChannel(
                    getA(rc.x, d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[${u*2+d}] = getChannel(
                    getA(rc.x, ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        ${c}

        ${r.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cw(t,e){const n=t.length;return n>=3?e?[...t.slice(0,-3),t[n-3]*t[n-2],t[n-1]]:[...t.slice(0,-3),t[n-3],t[n-2]*t[n-1]]:!e&&n===1&&t[0]>1?[t[0],1]:null}function f7({x:t,filter:e,convInfo:n,backend:s,bias:r=null,preluActivationWeights:i=null,leakyreluAlpha:o=0,activation:a=null}){const l=t.shape,c=s.texData.get(t.dataId),u=n.inChannels,d=l[0]*l[1]*l[2],h=n.outChannels,f=n.dataFormat==="channelsLast",p=!1,m=!1;let g;const y=[];if(i!=null){const b=Cw(i.shape,f);b!=null&&(i=_e({inputs:{x:i},backend:s,attrs:{shape:b}}),y.push(i))}if(r!=null){const b=Cw(r.shape,f);b!=null&&(r=_e({inputs:{x:r},backend:s,attrs:{shape:b}}),y.push(r))}if(!((d===1||h===1)&&u>i7)&&c.isPacked&&f&&c.texture!=null&&l[2]%2!==0&&Et(c.shape.slice(-3),l.slice(-3))){const b=l[0]*l[1]*(l[2]+1),k={dataId:t.dataId,shape:[1,b,n.inChannels],dtype:t.dtype},C=c.shape;c.shape=c.shape.slice(),c.shape[c.shape.length-2]++,O(Sw(c.shape,k.shape),()=>`packed reshape ${c.shape} to ${k.shape} isn't free`);const N=_e({inputs:{x:e},backend:s,attrs:{shape:[1,n.inChannels,n.outChannels]}});y.push(N);const I=kw({a:k,b:N,backend:s,transposeA:p,transposeB:m,bias:r,activation:a,preluActivationWeights:i,leakyreluAlpha:o}),$=s.texData.get(I.dataId);O($.isPacked,()=>"batchMatMul result is expected to be packed"),c.shape=C,$.shape=n.outShape,g=ei({inputs:{x:I},backend:s}),g.shape=n.outShape,y.push(I)}else{const b=n.outHeight*n.outWidth,k=_e({inputs:{x:t},backend:s,attrs:{shape:f?[n.batchSize,b,n.inChannels]:[n.batchSize,n.inChannels,b]}}),C=_e({inputs:{x:e},backend:s,attrs:{shape:[1,n.inChannels,n.outChannels]}}),N=kw({a:f?k:C,b:f?C:k,transposeA:!f,transposeB:m,backend:s,bias:r,activation:a,preluActivationWeights:i,leakyreluAlpha:o});g=_e({inputs:{x:N},backend:s,attrs:{shape:n.outShape}}),y.push(k),y.push(C),y.push(N)}for(const b of y)s.disposeIntermediateTensorInfo(b);return g}function p7({x:t,filter:e,convInfo:n,backend:s,bias:r=null,preluActivationWeights:i=null,leakyreluAlpha:o=0,activation:a=null}){const{filterWidth:l,filterHeight:c,inChannels:u,outWidth:d,outHeight:h,dataFormat:f}=n,p=f==="channelsLast",m=l*c*u,g=h*d,y=[n.batchSize,m,g],x=!0,v=!1,b=[];if(i!=null){const M=Cw(i.shape,p);M!=null&&(i=_e({inputs:{x:i},backend:s,attrs:{shape:M}}),b.push(i))}if(r!=null){const M=Cw(r.shape,p);M!=null&&(r=_e({inputs:{x:r},backend:s,attrs:{shape:M}}),b.push(r))}const k=_e({inputs:{x:e},backend:s,attrs:{shape:[1,m,le(e.shape)/m]}});b.push(k);const C=new e3e(y,n),N=[t.shape,[n.padInfo.top,n.padInfo.left],[n.strideHeight,n.strideWidth],[n.dilationHeight,n.dilationWidth],[n.inChannels],[n.filterWidth*n.inChannels],[n.outWidth]],I=s.runWebGLProgram(C,[t],"float32",N),$=_e({inputs:{x:I},backend:s,attrs:{shape:y}});b.push(I),b.push($);const A=r!=null,P=i!=null,F=a==="leakyrelu",V=a?Fg(a,!0):null,z=new r7(p?$.shape:k.shape,p?k.shape:$.shape,p?[n.batchSize,g,n.outChannels]:[n.batchSize,n.outChannels,g],x,v,A,V,P,F),B=p?[$,k]:[k,$];if(r&&B.push(r),P&&B.push(i),F){const M=s.makeTensorInfo([],"float32",tu(o,"float32"));B.push(M),b.push(M)}const W=s.runWebGLProgram(z,B,"float32"),q=_e({inputs:{x:W},backend:s,attrs:{shape:n.outShape}});b.push(W);for(const M of b)s.disposeIntermediateTensorInfo(M);return q}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t3e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:i}=e,{strides:o,pad:a,dataFormat:l,dilations:c,dimRoundingMode:u}=s,d=Sl(l),h=Ts(r.shape,i.shape,o,c,a,u,!1,d);let f;if(h.filterHeight===1&&h.filterWidth===1&&h.dilationHeight===1&&h.dilationWidth===1&&h.strideHeight===1&&h.strideWidth===1&&(h.padInfo.type==="SAME"||h.padInfo.type==="VALID"))f=f7({x:r,filter:i,convInfo:h,backend:n});else if(h.strideWidth<=2&&d==="channelsLast"&&oe().getBool("WEBGL_EXP_CONV")){const m=new h7(h),g=[[h.padInfo.top,h.padInfo.left],[h.strideHeight,h.strideWidth],[h.dilationHeight,h.dilationWidth],[h.inHeight,h.inWidth]];f=n.runWebGLProgram(m,[r,i],"float32",g)}else if(oe().getBool("WEBGL_CONV_IM2COL"))f=p7({x:r,filter:i,convInfo:h,backend:n});else{const m=new d7(h);f=n.runWebGLProgram(m,[r,i],"float32")}const p=_e({inputs:{x:f},backend:n,attrs:{shape:h.outShape}});return n.disposeIntermediateTensorInfo(f),p}const n3e={kernelName:D1,backendName:"webgl",kernelFunc:t3e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class s3e{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideHeight,s=e.strideWidth,r=e.padInfo.top,i=e.padInfo.left,o=e.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${n} - ${r};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${s} - ${i};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              if (${o}) {
                float dyValue = getDy(b, yR, yC, d2);
                float xValue = getX(b, xR, xC, d1);
                dotProd += (xValue * dyValue);
              } else {
                float dyValue = getDy(b, d2, yR, yC);
                float xValue = getX(b, d1, xR, xC);
                dotProd += (xValue * dyValue);
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}}class r3e{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterHeight,s=e.filterWidth,r=e.strideHeight,i=e.strideWidth,o=e.dataFormat==="channelsLast",a=n-1-e.padInfo.top,l=s-1-e.padInfo.left,c=o?1:2,u=o?2:3,d=o?3:1;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[${d}];

        ivec2 dyCorner = ivec2(coords[${c}], coords[${u}]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / ${r}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${s}; wC++) {
            float dyC = float(dyCCorner + wC) / ${i}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${s} - 1 - wC;

            for (int d2 = 0; d2 < ${e.outChannels}; d2++) {

              if (${o}) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}}class i3e{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideDepth,s=e.strideHeight,r=e.strideWidth,i=e.padInfo.front,o=e.padInfo.top,a=e.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yF = 0; yF < ${e.outDepth}; yF++) {
            int xF = wF + yF * ${n} - ${i};

            if (xF < 0 || xF >= ${e.inDepth}) {
              continue;
            }

            for (int yR = 0; yR < ${e.outHeight}; yR++) {
              int xR = wR + yR * ${s} - ${o};

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int yC = 0; yC < ${e.outWidth}; yC++) {
                int xC = wC + yC * ${r} - ${a};

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class o3e{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterDepth,s=e.filterHeight,r=e.filterWidth,i=e.strideDepth,o=e.strideHeight,a=e.strideWidth,l=n-1-e.padInfo.front,c=s-1-e.padInfo.top,u=r-1-e.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(${l}, ${c}, ${u});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < ${n}; wF++) {
          float dyF = float(dyFCorner + wF) / ${i}.0;

          if (dyF < 0.0 || dyF >= ${e.outDepth}.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = ${n} - 1 - wF;

          for (int wR = 0; wR < ${s}; wR++) {
            float dyR = float(dyRCorner + wR) / ${o}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = ${s} - 1 - wR;

            for (int wC = 0; wC < ${r}; wC++) {
              float dyC = float(dyCCorner + wC) / ${a}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = ${r} - 1 - wC;

              for (int d2 = 0; d2 < ${e.outChannels}; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a3e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,dy:i}=e,{strides:o,pad:a,dataFormat:l,dimRoundingMode:c,filterShape:u}=s,d=Sl(l),h=Ts(r.shape,u,o,1,a,c,!1,d),f=new s3e(h);return n.runWebGLProgram(f,[r,i],"float32")}const l3e={kernelName:T$,backendName:"webgl",kernelFunc:a3e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function c3e(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,filter:i}=e,{inputShape:o,strides:a,pad:l,dataFormat:c,dimRoundingMode:u}=s,d=Sl(c),h=Ts(o,i.shape,a,1,l,u,!1,d),f=new r3e(h);return n.runWebGLProgram(f,[r,i],"float32")}const u3e={kernelName:O1,backendName:"webgl",kernelFunc:c3e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d3e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:i}=e,{strides:o,pad:a,dilations:l}=s,c=ru(r.shape,i.shape,o,l,a),u=new JMe(c);return n.runWebGLProgram(u,[r,i],"float32")}const h3e={kernelName:P1,backendName:"webgl",kernelFunc:d3e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f3e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,dy:i}=e,{strides:o,pad:a,filterShape:l}=s,c=ru(r.shape,l,o,1,a),u=new i3e(c);return n.runWebGLProgram(u,[r,i],"float32")}const p3e={kernelName:N$,backendName:"webgl",kernelFunc:f3e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m3e(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,filter:i}=e,{pad:o,strides:a,inputShape:l}=s,c=ru(l,i.shape,a,1,o),u=new o3e(c);return n.runWebGLProgram(u,[r,i],"float32")}const g3e={kernelName:I$,backendName:"webgl",kernelFunc:m3e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const y3e=xp+`
  return cos(x);
`,x3e=Dt({opSnippet:y3e}),v3e={kernelName:$y,backendName:"webgl",kernelFunc:x3e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const b3e=`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`,w3e=Dt({opSnippet:b3e}),S3e={kernelName:Ay,backendName:"webgl",kernelFunc:w3e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class k3e{constructor(e,n,s,r,i){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];const[o,a,l,c]=e,[u]=n,[d,h]=s;this.outputShape=[u,d,h,c];const f=r==="bilinear"?1:0,[p,m]=[`${a-1}.0`,`${l-1}.0`],[g,y,x]=d>1?[`${(a-1)/(d-1)}`,"(y2-y1) * height_ratio",`y1*${p} + float(y)*(height_scale)`]:["0.0","0.0",`0.5 * (y1+y2) * ${p}`],[v,b,k]=h>1?[`${(l-1)/(h-1)}`,"(x2-x1) * width_ratio",`x1*${m} + float(x)*(width_scale)`]:["0.0","0.0",`0.5 * (x1+x2) * ${m}`];this.userCode=`
      const float height_ratio = float(${g});
      const float width_ratio = float(${v});
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= ${o}) {
          return;
        }

        float height_scale = ${y};
        float width_scale = ${b};

        float in_y = ${x};
        if( in_y < 0.0 || in_y > ${p} ) {
          setOutput(float(${i}));
          return;
        }
        float in_x = ${k};
        if( in_x < 0.0 || in_x > ${m} ) {
          setOutput(float(${i}));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(${f} == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const C3e=t=>{const{inputs:e,backend:n,attrs:s}=t,{image:r,boxes:i,boxInd:o}=e,{cropSize:a,method:l,extrapolationValue:c}=s,u=new k3e(r.shape,i.shape,a,l,c);return n.runWebGLProgram(u,[r,i,o],"float32")},T3e={kernelName:E$,backendName:"webgl",kernelFunc:C3e};var Mg;(function(t){t.Prod="*",t.Sum="+"})(Mg||(Mg={}));class TV{constructor(e,n,s,r){this.op=e,this.outputShape=n,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];const i=this.outputShape.length,o=this.op===Mg.Prod?"1.0":"0.0",a=s?o:`getX(${NV(i,"coords",this.op)})`,l=this.outputShape[this.outputShape.length-1];let c="",u="";s?(c=r?`end != ${l-1}`:"end != 0",u=r?"end + 1":"end - 1"):(c=r?`end + pow2 < ${l}`:"end >= pow2",u=r?"end + pow2":"end - pow2"),this.userCode=`
      void main() {
        ${sn(i)} coords = getOutputCoords();
        int end = ${IV(i,"coords",this.op)};
        float val = ${a};
        int pow2 = int(pow(2.0, index));
        if (${c}) {
          int idx = ${u};
          ${IV(i,"coords",this.op)} = idx;
          val ${this.op}= getX(${NV(i,"coords",this.op)});
        }
        setOutput(val);
      }
    `}}function NV(t,e,n){if(t===1)return`${e}`;if(t===2)return`${e}.x, ${e}.y`;if(t===3)return`${e}.x, ${e}.y, ${e}.z`;if(t===4)return`${e}.x, ${e}.y, ${e}.z, ${e}.w`;throw new Error(`Cumulative ${n} for rank ${t} is not yet supported`)}function IV(t,e,n){if(t===1)return`${e}`;if(t===2)return`${e}.y`;if(t===3)return`${e}.z`;if(t===4)return`${e}.w`;throw new Error(`Cumulative ${n} for rank ${t} is not yet supported`)}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m7(t,e,n,s,r,i){const o=e.shape.length,a=In([s],o);let l=e;a!=null&&(l=lr({inputs:{x:e},backend:n,attrs:{perm:a}}));const c=Gn(1,o)[0];if(c!==o-1)throw new Error(`WebGL cumprod shader expects an inner-most axis=${e.shape.length-1} but got axis=${s}`);const u=l.shape[c];let d=ei({inputs:{x:l},backend:n});for(let h=0;h<=Math.ceil(Math.log2(u))-1;h++){const f=new TV(t,l.shape,!1,i),p=[[h]],m=d;d=n.runWebGLProgram(f,[d],d.dtype,p),n.disposeIntermediateTensorInfo(m)}if(r){const h=new TV(t,l.shape,r,i),f=d;d=n.runWebGLProgram(h,[d],d.dtype),n.disposeIntermediateTensorInfo(f)}if(a!=null){const h=iu(a),f=lr({inputs:{x:d},backend:n,attrs:{perm:h}});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(l),f}return d}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N3e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,exclusive:o,reverse:a}=s;return m7(Mg.Prod,r,n,i,o,a)}const I3e={kernelName:_$,backendName:"webgl",kernelFunc:N3e};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _3e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,exclusive:o,reverse:a}=s;return m7(Mg.Sum,r,n,i,o,a)}const E3e={kernelName:F1,backendName:"webgl",kernelFunc:_3e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $3e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,weights:i}=e,{size:o,binaryOutput:a}=s;if(r.shape.length===1){const l=n.readSync(r.dataId),c=n.readSync(i.dataId),u=XX(l,c,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,u)}else if(r.shape.length===2){const l=n.bufferSync(r),c=n.bufferSync(i),u=WPe(l,c,o,a);return n.makeTensorInfo(u.shape,i.dtype,u.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${r.shape.length}.`)}const A3e={kernelName:$$,backendName:"webgl",kernelFunc:$3e};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class R3e{constructor(e,n,s){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=n,this.dataFormat=s,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = ${this.getHeightCoordString()};
      int w = ${this.getWidthCoordString()};
      int d = ${this.getDepthCoordString()};

      int in_h = h / ${n};
      int offset_h = imod(h, ${n});
      int in_w = w / ${n};
      int offset_w = imod(w, ${n});
      int offset_d = (offset_h * ${n} + offset_w) *
        ${this.getOutputDepthSize()};
      int in_d = d + offset_d;

      float result = ${this.getInputSamplingString()};
      setOutput(result);
    }
  `}getHeightCoordString(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"}getWidthCoordString(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"}getDepthCoordString(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"}getOutputDepthSize(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function D3e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{blockSize:i,dataFormat:o}=s,a=r.shape[0],l=o==="NHWC"?r.shape[1]:r.shape[2],c=o==="NHWC"?r.shape[2]:r.shape[3],u=o==="NHWC"?r.shape[3]:r.shape[1],d=l*i,h=c*i,f=u/(i*i),p=o==="NHWC"?[a,d,h,f]:[a,f,d,h],m=new R3e(p,i,o);return n.runWebGLProgram(m,[r],r.dtype)}const O3e={kernelName:A$,backendName:"webgl",kernelFunc:D3e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class g7{constructor(e,n=!1,s=null,r=!1,i=!1){this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=dr(this.outputShape.length);const o=e.filterHeight,a=e.filterWidth,l=e.outChannels/e.inChannels;let c="",u="";s&&(r?c=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:i?c=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:c=`
          float activation(float x) {
            ${s}
          }
        `,u="result = activation(result);");const d=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${c}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${l};
        int q = d2 - d1 * ${l};

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < ${o}; wR++) {
          int xR = xRCorner + wR * dilations[0];

          if (xR < 0 || xR >= inDims[0]) {
            continue;
          }

          for (int wC = 0; wC < ${a}; wC++) {
            int xC = xCCorner + wC * dilations[1];

            if (xC < 0 || xC >= inDims[1]) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        ${d}
        ${u}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class y7{constructor(e,n=!1,s=null,r=!1,i=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=dr(this.outputShape.length);const o=e.outChannels/e.inChannels,a=e.padInfo.left,l=e.strideWidth,c=e.dilationWidth,u=e.filterHeight,d=e.filterWidth,h=d;let f=`
      int xR; int xC; int xCOffset;
      vec4 wTexel; vec4 previous; vec4 final;`;for(let y=0;y<d;y++)f+=`
          vec4 xTexelC${y*2};
          int xTexelC${y*2}Ready;
          vec4 xTexelC${y*2+1};
          int xTexelC${y*2+1}Ready;
          vec4 xC${y};`;f+=`
    for (int r = 0; r < ${u}; r++) {
      `;for(let y=0;y<d;y++)f+=`
          xTexelC${y*2} = vec4(0.0);
          xTexelC${y*2}Ready = 0;
          xTexelC${y*2+1} = vec4(0.0);
          xTexelC${y*2+1}Ready = 0;
          xC${y} = vec4(0.0);`;f+=`
        xR = xRCorner + r * dilations[0];
        if (xR >=0 && xR < inDims[0]) {
      `;for(let y=0;y<(h+1)/2;y++){const x=y*2;if(f+=`
          xC = xCCorner + ${x*c};
          `,l===1){if(x<d&&(a%2===1?(f+=`
                xCOffset = xC + 1;
                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x}Ready == 0) {
                  xTexelC${x} = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${x}.zw = vec2(0.0);
                  }
                  xTexelC${x}Ready = 1;
                }
              `,c===1&&x>0?f+=`
                xC${x} = vec4(xTexelC${x-2}.zw, xTexelC${x}.xy);
                `:f+=`
                  xCOffset = xC + 1 - 2;

                  if (xCOffset >= 0 && xCOffset < inDims[1]) {
                    previous = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      previous.zw = vec2(0.0);
                    }

                    xC${x} = vec4(previous.zw, xTexelC${x}.xy);
                  } else {
                    xC${x} = vec4(0.0, 0.0, xTexelC${x}.xy);
                  }
                  `):f+=`
                if (xC >= 0 && xC < inDims[1] && xTexelC${x}Ready == 0) {
                  xTexelC${x} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${x}.zw = vec2(0.0);
                  }
                  xTexelC${x}Ready = 1;
                }

                xC${x} = xTexelC${x};
                `,x+1<d)){const v=a%2===0?m$(c):c;c%2===0&&a%2===1||c%2!==0&&a%2!==1?(f+=`
                  xCOffset = xC + imod(pads[1], 2) + ${v};

                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x+1}Ready == 0) {
                    xTexelC${x+1} = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      xTexelC${x+1}.zw = vec2(0.0);
                    }
                    xTexelC${x+1}Ready = 1;
                  }
                  `,c>1?f+=`
                    xCOffset -= 2;
                    if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);
                     xC${x+1} = vec4(previous.zw, xTexelC${x+1}.xy);
                    } else {
                     xC${x+1} = vec4(0.0, 0.0, xTexelC${x+1}.xy);
                    }
                    `:f+=`
                    xC${x+1} = vec4(xTexelC${x}.zw, xTexelC${x+1}.xy);
                    `):v===1?f+=`
                    xC${x+1} = xTexelC${x};
                    `:f+=`
                    xCOffset = xC + ${v};

                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x+1}Ready == 0) {
                      xTexelC${x+1} = getX(batch, xR, xCOffset, d1);
                      if (xCOffset + 1 >= inDims[1]) {
                        xTexelC${x+1}.zw = vec2(0.0);
                      }
                      xTexelC${x+1}Ready = 1;
                    }

                    xC${x+1} = xTexelC${x+1};
                    `}}else x<d&&(a%2===1?(f+=`
                xCOffset = xC + 1 - strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x}Ready == 0) {
                  xTexelC${x} = getX(batch, xR, xCOffset, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${x}.zw = vec2(0.0);
                  }
                  xTexelC${x}Ready = 1;
                }

                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${x+1}Ready == 0) {
                  xTexelC${x+1} = getX(batch, xR, xC + 1, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xC + 2 >= inDims[1]) {
                    xTexelC${x+1}.zw = vec2(0.0);
                  }
                  xTexelC${x+1}Ready = 1;
                }

                xC${x} = vec4(xTexelC${x}.zw, xTexelC${x+1}.zw);
              `,x+1<d&&(f+=`
                  final = vec4(0.0);
                  xCOffset = xC + 1 + strides[1];
                  if(xCOffset >= 0 && xCOffset < inDims[1]) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xC${x+1} = vec4(xTexelC${x+1}.xy, final.xy);
                `)):(f+=`
                if(xC >= 0 && xC < inDims[1] && xTexelC${x}Ready == 0) {
                  xTexelC${x} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${x}.zw = vec2(0.0);
                  }
                  xTexelC${x}Ready = 1;
                }

                xCOffset = xC + strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x+1}Ready == 0) {
                  xTexelC${x+1} = getX(batch, xR, xCOffset, d1);
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${x+1}.zw = vec2(0.);
                  }
                  xTexelC${x+1}Ready = 1;
                }

                xC${x} = vec4(
                  xTexelC${x}.xy, xTexelC${x+1}.xy);
              `,x+1<d&&(f+=`
                  xC${x+1} = vec4(xTexelC${x}.zw, xTexelC${x+1}.zw);
                `)));x<d&&(f+=`
            wTexel = getW(r, ${x}, d1, q);
            dotProd += xC${x} * vec4(wTexel.xz, wTexel.xz);
          `,x+1<d&&(f+=`
              wTexel = getW(r, ${x+1}, d1, q);
              dotProd += xC${x+1} * vec4(wTexel.xz, wTexel.xz);
            `))}f+=`
    }
  `,f+=`
      }
    `;let p="",m="";s&&(r?p=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:i?p=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:p=`vec4 activation(vec4 x) {
          ${s}
        }`,m="result = activation(result);");const g=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${p}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${o};
        int q = d2 - d1 * ${o};
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
        vec4 dotProd = vec4(0.000000000000001);

        ${f}

        vec4 result = dotProd - vec4(0.000000000000001);
        ${g}
        ${m}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P3e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:i}=e,{strides:o,pad:a,dilations:l,dimRoundingMode:c}=s;let u=l;u==null&&(u=[1,1]),O(Ms(o,u),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${o} and dilations '${u}'`);const d=Ts(r.shape,i.shape,o,u,a,c,!0);let h;oe().getBool("WEBGL_PACK_DEPTHWISECONV")&&d.strideWidth<=2&&d.outChannels/d.inChannels===1?h=new y7(d):h=new g7(d);const f=[[d.padInfo.top,d.padInfo.left],[d.strideHeight,d.strideWidth],[d.dilationHeight,d.dilationWidth],[d.inHeight,d.inWidth]];return n.runWebGLProgram(h,[r,i],"float32",f)}const F3e={kernelName:L1,backendName:"webgl",kernelFunc:P3e};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class L3e{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideHeight,s=e.strideWidth,r=e.padInfo.top,i=e.padInfo.left,o=e.outChannels/e.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * ${o} + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${n} - ${r};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${s} - ${i};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class M3e{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterHeight,s=e.filterWidth,r=e.strideHeight,i=e.strideWidth,o=n-1-e.padInfo.top,a=s-1-e.padInfo.left,l=e.outChannels/e.inChannels;this.userCode=`
      const ivec2 pads = ivec2(${o}, ${a});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / ${r}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${s}; wC++) {
            float dyC = float(dyCCorner + wC) / ${i}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${s} - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < ${l}; dm++) {
              int d2 = d1 * ${l} + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z3e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,dy:i}=e,{strides:o,dilations:a,pad:l,dimRoundingMode:c,filterShape:u}=s,d=Ts(r.shape,u,o,a,l,c,!0),h=new L3e(d);return n.runWebGLProgram(h,[r,i],"float32")}const V3e={kernelName:R$,backendName:"webgl",kernelFunc:z3e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j3e(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,filter:i}=e,{strides:o,dilations:a,pad:l,dimRoundingMode:c,inputShape:u}=s,d=Ts(u,i.shape,o,a,l,c,!0),h=new M3e(d);return n.runWebGLProgram(h,[r,i],"float32")}const B3e={kernelName:D$,backendName:"webgl",kernelFunc:j3e};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class W3e{constructor(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U3e(t){const{inputs:e,backend:n}=t,{x:s}=e,r=[...s.shape,...s.shape],i=le(s.shape),o=_e({inputs:{x:s},backend:n,attrs:{shape:[i]}}),a=new W3e(i),l=n.runWebGLProgram(a,[o],o.dtype),c=_e({inputs:{x:l},backend:n,attrs:{shape:r}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(l),c}const H3e={kernelName:O$,backendName:"webgl",kernelFunc:U3e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class G3e{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const{inHeight:n,inWidth:s,padInfo:r,strideHeight:i,strideWidth:o,filterHeight:a,filterWidth:l,dilationHeight:c,dilationWidth:u}=e,{top:d,left:h}=r;this.userCode=`
      const ivec2 strides = ivec2(${i}, ${o});
      const ivec2 pads = ivec2(${d}, ${h});
      const float neg_infinity = -3.4e38;

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.w;
        ivec2 outTopLeftCorner =
            coords.yz * strides - pads;
        int hBeg = outTopLeftCorner.x;
        int wBeg = outTopLeftCorner.y;

        float curVal = neg_infinity;
        for (int h = 0; h < ${a}; h++) {
          int hIn = hBeg + h * ${c};

          if (hIn >= 0 && hIn < ${n}) {
            for (int w = 0; w < ${l}; w++) {
              int wIn = wBeg + w * ${u};

              if (wIn >= 0 && wIn < ${s}) {
                float xVal = getX(batch, hIn, wIn, d1);
                float wVal = getW(h, w, d1);

                float val = xVal + wVal;
                if (val > curVal) {
                  curVal = val;
                }
              }
            }
          }
        }

        float result = curVal;
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K3e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:i}=e,{strides:o,pad:a,dilations:l}=s,c=y0(r.shape,i.shape,o,a,"NHWC",l);let u;const d=new G3e(c);u=n.runWebGLProgram(d,[r,i],"float32");const h=_e({inputs:{x:u},backend:n,attrs:{shape:c.outShape}});return n.disposeIntermediateTensorInfo(u),h}const q3e={kernelName:M1,backendName:"webgl",kernelFunc:K3e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X3e(t){const{inputs:e,backend:n,attrs:s}=t,{equation:r}=s,i=e,{allDims:o,summedDims:a,idDims:l}=VR(r,i.length);BR(o.length,l,i);const{path:c,steps:u}=WR(a,l),d=u.length;let h=null,f=o.length;const p=[];for(let m=0;m<d;++m){for(const g of u[m]){const{permutationIndices:y,expandDims:x}=jR(f,l[g]);let v;UR(y)?v=i[g]:(v=lr({inputs:{x:i[g]},backend:n,attrs:{perm:y}}),p.push(v));const b=v.shape.slice();for(let k=0;k<x.length;++k)b.splice(x[k],0,1);Et(v.shape,b)||(v=_e({inputs:{x:v},backend:n,attrs:{shape:b}}),p.push(v)),h===null?h=v:(h=DD({inputs:{a:v,b:h},backend:n}),p.push(h))}m<d-1&&(c[m]>=0&&(h=pk({inputs:{x:h},backend:n,attrs:{axis:c[m]-(o.length-f),keepDims:!1}}),p.push(h)),f--)}for(const m of p)m!==h&&n.disposeIntermediateTensorInfo(m);return h}const Y3e={kernelName:P$,backendName:"webgl",kernelFunc:X3e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Z3e="return (x >= 0.0) ? x : (exp(x) - 1.0);",Q3e=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,J3e=Dt({opSnippet:Z3e,packedOpSnippet:Q3e}),eze={kernelName:Dy,backendName:"webgl",kernelFunc:J3e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tze="return (b >= 1.0) ? a : a * (b + 1.0);",nze=`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,sze=t=>{const{inputs:e,backend:n}=t,{dy:s,y:r}=e,i=oe().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new j0(nze,s.shape,r.shape):new Wf(tze,s.shape,r.shape);return n.runWebGLProgram(i,[s,r],s.dtype)},rze={kernelName:F$,backendName:"webgl",kernelFunc:sze};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ize=`
  return vec4(equal(a, b));
`,oze="return float(a == b);",aze=Vs({opSnippet:oze,packedOpSnippet:ize,dtype:"bool",cpuKernelImpl:KPe}),lze={kernelName:z1,backendName:"webgl",kernelFunc:aze};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cze=`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = ${DR};
  float a1 = ${OR};
  float a2 = ${PR};
  float a3 = ${FR};
  float a4 = ${LR};
  float a5 = ${MR};

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`,uze=Dt({opSnippet:cze}),dze={kernelName:Oy,backendName:"webgl",kernelFunc:uze};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hze=xp+`
  return exp(x);
`,fze=`
  vec4 result = exp(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,x7=Dt({opSnippet:hze,packedOpSnippet:fze,cpuKernelImpl:qPe,dtype:"float32"}),pze={kernelName:Py,backendName:"webgl",kernelFunc:x7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EI(t){const{inputs:e,attrs:n,backend:s}=t,{dim:r}=n,{input:i}=e,o=i.shape.length,a=i.shape.slice();let l=r;return r<0&&(O(-(o+1)<=r,()=>`Axis must be in the interval [${-(o+1)}, ${o}]`),l=o+r+1),a.splice(l,0,1),_e({inputs:{x:i},backend:s,attrs:{shape:a}})}const mze={kernelName:V1,backendName:"webgl",kernelFunc:EI};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _V="return exp(x) - 1.0;",gze=Dt({opSnippet:_V,packedOpSnippet:_V,cpuKernelImpl:XPe}),yze={kernelName:Fy,backendName:"webgl",kernelFunc:gze};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class EV{constructor(e,n,s){this.variableNames=["real","imag"];const r=n[1];this.outputShape=n;const i=s?`2.0 * ${Math.PI}`:`-2.0 * ${Math.PI}`,o=s?`${r}.0`:"1.0";let a;if(e==="real")a="return real * expR - imag * expI;";else if(e==="imag")a="return real * expI + imag * expR;";else throw new Error(`FFT component must be either "real" or "imag", got ${e}.`);this.userCode=`
      const float exponentMultiplier = ${i};

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        ${a}
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(${r});
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < ${r}; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / ${o};
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v7(t,e,n){const s=n.texData.get(t.dataId),r=le(t.shape),i=t.shape[t.shape.length-1],o=r/i,a=_e({inputs:{x:t},backend:n,attrs:{shape:[o,i]}}),l=a.shape,c=new EV("real",l,e),u=new EV("imag",l,e),d=[{dataId:s.complexTensorInfos.real.dataId,dtype:s.complexTensorInfos.real.dtype,shape:l},{dataId:s.complexTensorInfos.imag.dataId,dtype:s.complexTensorInfos.imag.dtype,shape:l}],h=n.runWebGLProgram(c,d,"float32"),f=n.runWebGLProgram(u,d,"float32"),p=cu({inputs:{real:h,imag:f},backend:n});n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f);const m=_e({inputs:{x:p},backend:n,attrs:{shape:t.shape}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(p),m}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xze(t){const{inputs:e,backend:n}=t,{input:s}=e;return v7(s,!1,n)}const vze={kernelName:L$,backendName:"webgl",kernelFunc:xze};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bze{constructor(e,n){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=e,this.userCode=`
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W0(t){const{backend:e,attrs:n}=t,{shape:s,value:r}=n;let{dtype:i}=n;if(i=i||vy(r),i==="string"){const o=ws(i,le(s));return o.fill(r),e.makeTensorInfo(s,i,o)}else{const o=new bze(s,r),a=[[r]];return e.runWebGLProgram(o,[],i,a)}}const wze={kernelName:M$,backendName:"webgl",kernelFunc:W0};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Sze{constructor(e){this.variableNames=["Image"],this.outputShape=[];const n=e[2];this.outputShape=e,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];

          int coordX = ${n} - x - 1;
          float outputValue;
          if(coordX >= 0 && coordX < ${n}) {
            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);
          } else {
            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kze={kernelName:z$,backendName:"webgl",kernelFunc:({inputs:t,backend:e})=>{const{image:n}=t,s=e,r=new Sze(n.shape);return s.runWebGLProgram(r,[n],n.dtype)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $V="return floor(x);",Cze=Dt({opSnippet:$V,packedOpSnippet:$V,cpuKernelImpl:YPe}),Tze={kernelName:Ly,backendName:"webgl",kernelFunc:Cze};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nze=`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,Ize=`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,_ze=Vs({opSnippet:Nze,packedOpSnippet:Ize,dtype:"int32"}),Eze={kernelName:My,backendName:"webgl",kernelFunc:_ze};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $ze{constructor(e){this.variableNames=["A"];const n=ur(),[s,r]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${r}.0, ${s}.0);

        vec4 values = ${n.texture2D}(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Aze{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const n=ur(),[s,r]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(${r}.0, ${s}.0);
            vec4 values = ${n.texture2D}(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rze={kernelName:R2,backendName:"webgl",kernelFunc:Dze};let rh,mT=oe().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");function Dze(t){const{inputs:e,backend:n,attrs:s}=t;let{pixels:r}=e;const{numChannels:i}=s,o=typeof HTMLVideoElement<"u"&&r instanceof HTMLVideoElement,a=typeof HTMLImageElement<"u"&&r instanceof HTMLImageElement,[l,c]=o?[r.videoWidth,r.videoHeight]:[r.width,r.height],u=[c,l],d=[c,l,i];if(a||o){const m=oe().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");(rh==null||m!==mT)&&(mT=m,rh=document.createElement("canvas").getContext("2d",{willReadFrequently:mT})),rh.canvas.width=l,rh.canvas.height=c,rh.drawImage(r,0,0,l,c),r=rh.canvas}const h=n.makeTensorInfo(u,"int32");n.texData.get(h.dataId).usage=yi.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(h.dataId),r);const f=oe().getBool("WEBGL_PACK")?new Aze(d):new $ze(d),p=n.runWebGLProgram(f,[h],"int32");return n.disposeData(h.dataId),p}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oze(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:i,bias:o,preluActivationWeights:a}=e,{strides:l,pad:c,dataFormat:u,dilations:d,dimRoundingMode:h,activation:f,leakyreluAlpha:p}=s,m=Sl(u),g=Ts(r.shape,i.shape,l,d,c,h,!1,m);let y;const x=[],v=o!=null,b=a!=null,k=f==="leakyrelu",C=()=>{const I=[r,i],$=(A,P)=>{if(P==="NCHW"&&A.shape.length===1&&A.shape[0]!==1){const F=_e({inputs:{x:A},backend:n,attrs:{shape:[A.shape[0],1,1]}});return x.push(F),F}return A};if(v&&I.push($(o,u)),b&&I.push($(a,u)),k){const A=n.makeTensorInfo([],"float32",tu(p,"float32"));I.push(A),x.push(A)}return I};if(g.filterHeight===1&&g.filterWidth===1&&g.dilationHeight===1&&g.dilationWidth===1&&g.strideHeight===1&&g.strideWidth===1&&(g.padInfo.type==="SAME"||g.padInfo.type==="VALID"))y=f7({x:r,filter:i,convInfo:g,backend:n,bias:o,activation:f,preluActivationWeights:a,leakyreluAlpha:p});else if(g.strideWidth<=2&&m==="channelsLast"&&oe().getBool("WEBGL_EXP_CONV")){const I=f?Fg(f,!0):null,$=new h7(g,v,I,b,k),A=[[g.padInfo.top,g.padInfo.left],[g.strideHeight,g.strideWidth],[g.dilationHeight,g.dilationWidth],[g.inHeight,g.inWidth]],P=C();y=n.runWebGLProgram($,P,"float32",A)}else if(oe().getBool("WEBGL_CONV_IM2COL"))y=p7({x:r,filter:i,convInfo:g,backend:n,bias:o,activation:f,preluActivationWeights:a,leakyreluAlpha:p});else{const I=f?Fg(f,!1):null,$=new d7(g,v,I,b,k),A=C();y=n.runWebGLProgram($,A,"float32")}const N=_e({inputs:{x:y},backend:n,attrs:{shape:g.outShape}});return x.push(y),x.forEach(I=>n.disposeIntermediateTensorInfo(I)),N}const Pze={kernelName:qb,backendName:"webgl",kernelFunc:Oze};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fze(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:i,bias:o,preluActivationWeights:a}=e,{strides:l,pad:c,dilations:u,dimRoundingMode:d,activation:h,leakyreluAlpha:f}=s,p=[];let m=u;m==null&&(m=[1,1]),O(Ms(l,m),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${l} and dilations '${m}'`);const g=Ts(r.shape,i.shape,l,m,c,d,!0),y=oe().getBool("WEBGL_PACK_DEPTHWISECONV")&&g.strideWidth<=2&&g.outChannels/g.inChannels===1,x=h?Fg(h,y):null,v=[r,i],b=o!=null,k=a!=null,C=h==="leakyrelu";if(b&&v.push(o),k&&v.push(a),C){const A=n.makeTensorInfo([],"float32",tu(f,"float32"));v.push(A),p.push(A)}let N;y?N=new y7(g,b,x,k,C):N=new g7(g,b,x,k,C);const I=[[g.padInfo.top,g.padInfo.left],[g.strideHeight,g.strideWidth],[g.dilationHeight,g.dilationWidth],[g.inHeight,g.inWidth]],$=n.runWebGLProgram(N,v,"float32",I);return p.forEach(A=>n.disposeIntermediateTensorInfo(A)),$}const Lze={kernelName:Xb,backendName:"webgl",kernelFunc:Fze};class Mze{constructor(e,n,s,r){this.sliceDim=e,this.strides=n,this.paramsShape=r,this.variableNames=["x","indices"],this.outputShape=s;const i=sn(s.length);let o=`
    int index;`;for(let a=0;a<this.sliceDim;a++)o+=`
          index = round(getIndices(coords[0], ${a}));
          out_of_bounds = out_of_bounds || index < 0;
          out_of_bounds = out_of_bounds || index >= ${this.paramsShape[a]};
          flattenIndex += index * ${this.strides[a]};`;this.userCode=`
         void main() {
          ${i} coords = getOutputCoords();
          int flattenIndex = 0;
          bool out_of_bounds = false;

          ${o}

          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zze(t){const{inputs:e,backend:n}=t,{params:s,indices:r}=e,i=r.shape,o=i[i.length-1],a=le(s.shape),[l,c,u,d]=_A(s,r),h=_e({inputs:{x:r},backend:n,attrs:{shape:[c,o]}}),f=_e({inputs:{x:s},backend:n,attrs:{shape:[le(s.shape)/u,u]}});if(n.shouldExecuteOnCPU([s,r])||s.dtype==="string"){const y=n.readSync(r.dataId),x=n.bufferSync(s),v=ZPe(y,x,s.dtype,c,o,u,d,s.shape,a);return n.makeTensorInfo(l,s.dtype,v.values)}const p=new Mze(o,d,[c,u],s.shape),m=n.runWebGLProgram(p,[f,h],f.dtype),g=_e({inputs:{x:m},backend:n,attrs:{shape:l}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),g}const Vze={kernelName:V$,backendName:"webgl",kernelFunc:zze};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class jze{constructor(e,n){this.variableNames=["A","indices"],this.outputShape=n,this.rank=n.length;const s=sn(this.rank),r=Bze(e);this.userCode=`
      void main() {
        ${s} resRC = getOutputCoords();
        int index = int(getIndices(resRC.x, resRC.z));
        float inBounds = (index >= 0) && (index < ${e[2]}) ? 1.0 : 0.0;
        setOutput(inBounds * getA(${r}));
      }
    `}}function Bze(t,e){const n=["resRC.x","resRC.y","resRC.z","resRC.w"],s=[];for(let r=0;r<t.length;r++)r===2?s.push("index"):s.push(`${n[r]}`);return s.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b7(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,indices:i}=e,{axis:o,batchDims:a}=s,l=bt(o,r.shape)[0];if(oe().get("DEBUG")){const x=n.readSync(i.dataId),v=r.shape[l];for(let b=0;b<x.length;++b){const k=x[b];O(k<=v-1&&k>=0,()=>`GatherV2: the index value ${k} is not in [0, ${v-1}]`)}}const c=GR(r,i,l,a),u=le(i.shape),d=[],h=_e({inputs:{x:r},backend:n,attrs:{shape:[c.batchSize,c.outerSize,c.dimSize,c.sliceSize]}}),f=_e({inputs:{x:i},backend:n,attrs:{shape:[c.batchSize,u/c.batchSize]}});d.push(h),d.push(f);const p=[c.batchSize,c.outerSize,u/c.batchSize,c.sliceSize];if(n.shouldExecuteOnCPU([r,i])||r.dtype==="string"){const x=n.bufferSync(f),v=n.bufferSync(h),b=QPe(v,x,p);return d.forEach(k=>n.disposeIntermediateTensorInfo(k)),n.makeTensorInfo(c.outputShape,b.dtype,b.values)}const m=new jze(h.shape,p),g=n.runWebGLProgram(m,[h,f],h.dtype);d.push(g);const y=_e({inputs:{x:g},backend:n,attrs:{shape:c.outputShape}});return d.forEach(x=>n.disposeIntermediateTensorInfo(x)),y}const Wze={kernelName:B1,backendName:"webgl",kernelFunc:b7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Uze="return float(a > b);",Hze=`
  return vec4(greaterThan(a, b));
`,Gze=Vs({opSnippet:Uze,packedOpSnippet:Hze,cpuKernelImpl:JPe,dtype:"bool"}),Kze={kernelName:W1,backendName:"webgl",kernelFunc:Gze};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qze="return float(a >= b);",Xze=`
  return vec4(greaterThanEqual(a, b));
`,Yze=Vs({opSnippet:qze,packedOpSnippet:Xze,dtype:"bool",cpuKernelImpl:eFe}),Zze={kernelName:zy,backendName:"webgl",kernelFunc:Yze};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qze(t){const{inputs:e,backend:n}=t,{input:s}=e;return v7(s,!0,n)}const Jze={kernelName:j$,backendName:"webgl",kernelFunc:Qze};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eVe="return float(!isnan(x) && !isinf(x));",tVe=Dt({opSnippet:eVe,dtype:"bool"}),nVe={kernelName:jy,backendName:"webgl",kernelFunc:tVe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sVe="return float(isinf(x));",rVe=Dt({opSnippet:sVe,dtype:"bool"}),iVe={kernelName:By,backendName:"webgl",kernelFunc:rVe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oVe="return float(isnan(x));",aVe=Dt({opSnippet:oVe,dtype:"bool"}),lVe={kernelName:Wy,backendName:"webgl",kernelFunc:aVe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cVe="return float(a < b);",uVe=`
  return vec4(lessThan(a, b));
`,dVe=Vs({opSnippet:cVe,packedOpSnippet:uVe,cpuKernelImpl:tFe,dtype:"bool"}),hVe={kernelName:H1,backendName:"webgl",kernelFunc:dVe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fVe="return float(a <= b);",pVe=`
  return vec4(lessThanEqual(a, b));
`,mVe=Vs({opSnippet:fVe,packedOpSnippet:pVe,cpuKernelImpl:nFe,dtype:"bool"}),gVe={kernelName:G1,backendName:"webgl",kernelFunc:mVe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yVe(t){const{backend:e,attrs:n}=t,{start:s,stop:r,num:i}=n,o=sFe(s,r,i);return e.makeTensorInfo([o.length],"float32",o)}const xVe={kernelName:W$,backendName:"webgl",kernelFunc:yVe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vVe=xp+`
  return x < 0.0 ? 0./0. : log(x);
`,bVe=`
  vec4 result = log(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);
  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);
  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);
  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);
  return result;
`,wVe=Dt({opSnippet:vVe,packedOpSnippet:bVe,cpuKernelImpl:rFe}),SVe={kernelName:Uy,backendName:"webgl",kernelFunc:wVe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kVe=xp+`
  return log(1.0 + x);
`,CVe=Dt({opSnippet:kVe}),TVe={kernelName:Hy,backendName:"webgl",kernelFunc:CVe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NVe="return float(a >= 1.0 && b >= 1.0);",IVe=`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,_Ve=Vs({opSnippet:NVe,packedOpSnippet:IVe,dtype:"bool"}),EVe={kernelName:K1,backendName:"webgl",kernelFunc:_Ve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $Ve="return float(!(x >= 1.0));",AVe=Dt({opSnippet:$Ve}),RVe={kernelName:q1,backendName:"webgl",kernelFunc:AVe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DVe="return float(a >= 1.0 || b >= 1.0);",OVe=`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,PVe=Vs({opSnippet:DVe,packedOpSnippet:OVe,dtype:"bool"}),FVe={kernelName:X1,backendName:"webgl",kernelFunc:PVe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class LVe{constructor(e,n,s,r,i){this.variableNames=["x"],this.outputShape=[];const o=n,a=e[3]-1;this.outputShape=e;let l;const c=`float(${s}) + float(${r}) * sum`;i===.5?l=`inversesqrt(${c})`:i===1?l=`1.0/(${c})`:l=`exp(log(${c}) * float(-${i}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -${o}; j <= ${o}; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  ${a}) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * ${l};
        setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class MVe{constructor(e,n,s,r,i){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;const o=n,a=e[3]-1;this.outputShape=e;let l;const c=`float(${s}) + float(${r}) * sum`;i===.5?l=`inversesqrt(${c})`:i===1?l=`1.0/(${c})`:l=`exp(log(${c}) * float(-${i}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < ${this.outputShape[3]};
        bool hasNextRow = c < ${this.outputShape[2]};

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - ${o};
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - ${o}; j <= ${o}; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(${a}));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * ${l};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zVe=t=>{const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{depthRadius:i,bias:o,alpha:a,beta:l}=s,c=oe().getBool("WEBGL_PACK_NORMALIZATION")?new MVe(r.shape,i,o,a,l):new LVe(r.shape,i,o,a,l);return n.runWebGLProgram(c,[r],r.dtype)},VVe={kernelName:Y1,backendName:"webgl",kernelFunc:zVe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class jVe{constructor(e,n,s,r,i){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=n,this.bias=s,this.alpha=r,this.beta=i,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < ${this.depth}; ++d) {
          int depthBegin = int(max(0.0, float(d - ${n})));
          int depthEnd = int(min(float(${this.depth}),
              float(d + ${n} + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = ${this.depth};

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(${r}) * norm + float(${s});

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(${r})
                * float(${i})
                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * ${i});
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BVe=t=>{const{inputs:e,backend:n,attrs:s}=t,{x:r,y:i,dy:o}=e,{depthRadius:a,bias:l,alpha:c,beta:u}=s,d=new jVe(r.shape,a,l,c,u);return n.runWebGLProgram(d,[r,i,o],r.dtype)},WVe={kernelName:U$,backendName:"webgl",kernelFunc:BVe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UVe(t,e,n,s){const r=le(e),o=le(t.shape)/r,a=_e({inputs:{x:t},attrs:{shape:[o,r]},backend:s}),l=Hd(a,t.dtype,"max",s),c=_e({inputs:{x:l},attrs:{shape:n},backend:s});return s.disposeIntermediateTensorInfo(a),s.disposeIntermediateTensorInfo(l),c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w7(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{reductionIndices:i,keepDims:o}=s,a=r.shape.length,l=bt(i,r.shape);let c=l;const u=In(c,a),d=u!=null,h=n.shouldExecuteOnCPU([r]);let f=r;if(d){if(h){const v=n.texData.get(f.dataId).values,b=new Array(a);for(let N=0;N<b.length;N++)b[N]=r.shape[u[N]];const k=AD(v,r.shape,r.dtype,u,b);f=n.makeTensorInfo(b,r.dtype);const C=n.texData.get(f.dataId);C.values=k}else f=fk(r,u,n);c=Gn(c.length,a)}zs("max",c,a);const[p,m]=Ns(f.shape,c);let g=p;o&&(g=Hn(p,l));let y;if(h){const v=n.texData.get(f.dataId).values,b=iFe(v,le(m),g,r.dtype);y=n.makeTensorInfo(g,r.dtype);const k=n.texData.get(y.dataId);k.values=b}else y=UVe(f,m,g,n);return d&&n.disposeIntermediateTensorInfo(f),y}const HVe={kernelName:Z1,backendName:"webgl",kernelFunc:w7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GVe=RD+`
  return max(a, b);
`,KVe=`
  vec4 result = vec4(max(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+V0+`
  return result;
`,qVe=Vs({opSnippet:GVe,packedOpSnippet:KVe,cpuKernelImpl:oFe}),XVe={kernelName:Gy,backendName:"webgl",kernelFunc:qVe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YVe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e;M0(r,"maxPool");const{filterSize:i,strides:o,pad:a,dimRoundingMode:l}=s,c=1;O(Ms(o,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${c}'`);const u=uo(r.shape,i,o,c,a,l);if(u.filterWidth===1&&u.filterHeight===1&&Et(u.inShape,u.outShape))return ei({inputs:{x:r},backend:n});const d=new Lg(u,"max",!1);return n.runWebGLProgram(d,[r],r.dtype)}const ZVe={kernelName:Q1,backendName:"webgl",kernelFunc:YVe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QVe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{filterSize:i,strides:o,pad:a,dataFormat:l,dimRoundingMode:c}=s,u=[1,1,1],d=wl(r.shape,i,o,u,a,c,l),h=new OD(d,"max",!1);return n.runWebGLProgram(h,[r],r.dtype)}const JVe={kernelName:J1,backendName:"webgl",kernelFunc:QVe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class eje{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const n=e.strideHeight,s=e.strideWidth,r=e.dilationHeight,i=e.effectiveFilterHeight,o=e.effectiveFilterWidth,a=i-1-e.padInfo.top,l=o-1-e.padInfo.left,c=i*o-1;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${i};
          wR += ${r}) {
          float dyR = float(dyRCorner + wR) / ${n}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${o}; wC++) {
            float dyC = float(dyCCorner + wC) / ${s}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = ${c} - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * ${o} + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `}}class tje{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const n=e.strideDepth,s=e.strideHeight,r=e.strideWidth,i=e.dilationDepth,o=e.dilationHeight,a=e.dilationWidth,l=e.effectiveFilterDepth,c=e.effectiveFilterHeight,u=e.effectiveFilterWidth,d=l-1-e.padInfo.front,h=c-1-e.padInfo.top,f=u-1-e.padInfo.left,p=l*c*u-1;this.userCode=`
      const ivec3 pads = ivec3(${d}, ${h}, ${f});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${l};
           wD += ${i}) {
          float dyD = float(dyDCorner + wD) / ${n}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${c};
              wR += ${o}) {
            float dyR = float(dyRCorner + wR) / ${s}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${u};
                wC += ${a}) {
              float dyC = float(dyCCorner + wC) / ${r}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = ${p} -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * ${c} * ${u} +
                  wR * ${u} + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nje(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:i}=e,o=i,{filterSize:a,strides:l,pad:c,dimRoundingMode:u}=s,d=[1,1,1],h=wl(o.shape,a,l,d,c,u),f=new OD(h,"max",!0),p=n.runWebGLProgram(f,[o],o.dtype),m=new tje(h),g=n.runWebGLProgram(m,[r,p],o.dtype);return n.disposeIntermediateTensorInfo(p),g}const sje={kernelName:G$,backendName:"webgl",kernelFunc:nje};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rje(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:i,output:o}=e,a=i;M0([i,o],"maxPoolGrad");const{filterSize:l,strides:c,pad:u,dimRoundingMode:d}=s,h=uo(a.shape,l,c,1,u,d),f=!0,p=new Lg(h,"max",f),m=n.runWebGLProgram(p,[a],a.dtype),g=new eje(h),y=n.runWebGLProgram(g,[r,m],a.dtype);return n.disposeIntermediateTensorInfo(m),y}const ije={kernelName:H$,backendName:"webgl",kernelFunc:rje};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oje(t,e,n,s){let r=new Lg(n,"max",!1);const i=s.runWebGLProgram(r,[t],"float32");r=new Lg(n,"max",!0,!0,e);const o=s.runWebGLProgram(r,[t],"float32");return[i,o]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aje={kernelName:K$,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:s}=t,{filterSize:r,strides:i,pad:o,includeBatchInIndex:a}=e,l=n;O(s.shape.length===4,()=>`Error in maxPool: input must be rank 4 but got rank ${s.shape.length}.`);const c=[1,1];O(Ms(i,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${c}'`);const u=uo(s.shape,r,i,c,o),[d,h]=oje(s,a,u,l);return[d,h]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lje(t,e,n,s){const r=le(e),o=le(t.shape)/r,a=_e({inputs:{x:t},attrs:{shape:[o,r]},backend:s}),l=Hd(a,"float32","mean",s),c=_e({inputs:{x:l},attrs:{shape:n},backend:s});return s.disposeIntermediateTensorInfo(a),s.disposeIntermediateTensorInfo(l),c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cje={kernelName:eS,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:s}=t,{keepDims:r,axis:i}=e,o=n,a=s.shape.length,l=bt(i,s.shape);let c=l;const u=In(c,a),d=u!=null,h=o.shouldExecuteOnCPU([s]),f=[];let p=s;if(d){if(h){const b=o.texData.get(p.dataId).values,k=new Array(a);for(let I=0;I<k.length;I++)k[I]=s.shape[u[I]];const C=AD(b,s.shape,s.dtype,u,k);p=o.makeTensorInfo(k,s.dtype);const N=o.texData.get(p.dataId);N.values=C}else p=fk(s,u,o);f.push(p),c=Gn(c.length,a)}zs("sum",c,a);const[m,g]=Ns(p.shape,c);let y=m;r&&(y=Hn(m,l));const x=lje(p,g,y,o);for(const v of f)o.disposeIntermediateTensorInfo(v);return x}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uje(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,keepDims:o}=s,a=r.shape.length,l=bt(i,r.shape);let c=l;const u=In(c,a);let d=r;u!=null&&(d=lr({inputs:{x:r},backend:n,attrs:{perm:u}}),c=Gn(c.length,r.shape.length)),zs("min",c,a);const[h,f]=Ns(d.shape,c),p=le(f),m=_e({inputs:{x:d},backend:n,attrs:{shape:[-1,p]}}),g=Hd(m,m.dtype,"min",n);let y;if(o){const x=Hn(h,l);y=_e({inputs:{x:g},backend:n,attrs:{shape:x}})}else y=_e({inputs:{x:g},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),u!=null&&n.disposeIntermediateTensorInfo(d),y}const dje={kernelName:tS,backendName:"webgl",kernelFunc:uje};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hje=RD+`
  return min(a, b);
`,fje=`
  vec4 result = vec4(min(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+V0+`
  return result;
`,pje=Vs({opSnippet:hje,packedOpSnippet:fje,cpuKernelImpl:aFe}),mje={kernelName:Ky,backendName:"webgl",kernelFunc:pje};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class gje{constructor(e,n,s){this.variableNames=["x"],this.outputShape=n.map((u,d)=>u[0]+e[d]+u[1]);const r=e.length,i=sn(r),o=n.map(u=>u[0]).join(","),a=n.map((u,d)=>u[0]+e[d]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r),c=s==="reflect"?0:1;if(r===1){this.userCode=`
        int start = ${o};
        int end = ${a};

        void main() {
          int outC = getOutputCoords();
          if (outC < start) {
            outC = start * 2 - outC - ${c};
          } else if(outC >= end) {
            outC = (end - 1) * 2 - outC + ${c};
          }
          setOutput(getX(outC - start));
        }
      `;return}this.userCode=`
      ${i} start = ${i}(${o});
      ${i} end = ${i}(${a});

      void main() {
        ${i} outC = getOutputCoords();
        for (int i = 0; i < ${r}; i++) {
          if (outC[i] < start[i]) {
            outC[i] = start[i] * 2 - outC[i] - ${c};
          } else if(outC[i] >= end[i]) {
            outC[i] = (end[i] - 1) * 2 - outC[i] + ${c};
          }
        }
        ${i} coords = outC - start;
        setOutput(getX(${l}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class yje{constructor(e,n,s){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n.map((p,m)=>p[0]+e[m]+p[1]);const r=e.length,i=sn(r),o=n.map(p=>p[0]).join(","),a=n.map((p,m)=>p[0]+e[m]).join(","),l=ir("rc",r),c=ir("source",r),u=`${l[r-1]} < ${this.outputShape[r-1]}`,d=r===1?"source":`vec2(${c.slice(-2).join()})`,h=s==="reflect"?0:1;let f="";if(r===1){const p=`
        ${i} source = rc;
        if (source < start) {
          source = start * 2 - source - ${h};
        } else if (source >= end) {
          source = (end - 1) * 2 - source + ${h};
        }
        source -= start;
      `;f=`
        ${i} rc = outputLoc;
        ${p}
        result[0] = getChannel(getX(${c.join()}), ${d});
        ${l[r-1]} += 1;
        if(${u}) {
          ${p}
          result[1] = getChannel(getX(${c.join()}), ${d});
        }
      `}else{const p=`
        ${i} source = rc;
        ${i} lt = ${i}(lessThan(source, start));
        ${i} gte = ${i}(greaterThanEqual(source, end));
        ${i} orig = 1 - (lt + gte);
        source = orig * source +
                lt * (start * 2 - source - ${h}) +
                gte * ((end - 1) * 2 - source + ${h});
        source -= start;
      `;f=`
        ${i} rc = outputLoc;
        ${p}
        result[0] = getChannel(getX(${c.join()}), ${d});
        ${l[r-1]} += 1;
        if(${u}) {
          ${p}
          result[1] = getChannel(getX(${c.join()}), ${d});
        }
        rc = outputLoc;
        ${l[r-2]} += 1;
        if(${l[r-2]} < ${this.outputShape[r-2]}) {
          ${p}
          result[2] = getChannel(getX(${c.join()}), ${d});
          ${l[r-1]} += 1;
          if(${u}) {
            ${p}
            result[3] = getChannel(getX(${c.join()}), ${d});
          }
        }
      `}this.userCode=`
      const ${i} start = ${i}(${o});
      const ${i} end = ${i}(${a});

      void main() {
        ${i} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${f}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xje=({inputs:t,backend:e,attrs:n})=>{const{x:s}=t,{paddings:r,mode:i}=n,o=oe().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new yje(s.shape,r,i):new gje(s.shape,r,i);return e.runWebGLProgram(o,[s],s.dtype)},vje={kernelName:nS,backendName:"webgl",kernelFunc:xje};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bje=`if (b == 0.0) return NAN;
  return mod(a, b);`,wje=`
  vec4 result = mod(a, b);
  bvec4 isNaN = equal(b, vec4(0.0));
  `+V0+`
  return result;
`,Sje=Vs({opSnippet:bje,packedOpSnippet:wje}),kje={kernelName:qy,backendName:"webgl",kernelFunc:Sje};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Cje{constructor(e,n,s){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[e,s],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < ${n-1}; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(${n-1}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tje=`
if (a == b) {
  return 1.0;
};
return a / b;`,Nje=`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,S7=Vs({opSnippet:Tje,packedOpSnippet:Nje,checkOutOfBounds:!0}),Ije={kernelName:Ry,backendName:"webgl",kernelFunc:S7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AV="return a - b;",k7=Vs({opSnippet:AV,packedOpSnippet:AV,supportsComplex:!0,cpuKernelImpl:NFe}),_je={kernelName:u0,backendName:"webgl",kernelFunc:k7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C7(t){const{inputs:e,backend:n,attrs:s}=t,{logits:r}=e,{dim:i}=s,o=bt([i],r.shape),a=w7({inputs:{x:r},backend:n,attrs:{reductionIndices:o,keepDims:!1}}),l=Hn(a.shape,o),c=_e({inputs:{x:a},backend:n,attrs:{shape:l}}),u=k7({inputs:{a:r,b:c},backend:n}),d=x7({inputs:{x:u},backend:n}),h=pk({inputs:{x:d},backend:n,attrs:{axis:o,keepDims:!1}}),f=_e({inputs:{x:h},backend:n,attrs:{shape:l}}),p=S7({inputs:{a:d,b:f},backend:n});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),p}const Eje={kernelName:bS,backendName:"webgl",kernelFunc:C7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $je(t){const{inputs:e,backend:n,attrs:s}=t,{logits:r}=e,{numSamples:i,seed:o,normalized:a}=s,l=a?r:C7({inputs:{logits:r},backend:n,attrs:{dim:r.shape.length-1}}),c=l.shape[0],u=l.shape[1],d=new Cje(c,u,i),h=[[o]],f=n.runWebGLProgram(d,[l],"int32",h);return a||n.disposeIntermediateTensorInfo(l),f}const Aje={kernelName:q$,backendName:"webgl",kernelFunc:$je};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rje=fo+`
  return -x;
`,Dje=`
  vec4 result = -x;
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`;function Oje(t){const{inputs:e,backend:n}=t,{x:s}=e;if(n.shouldExecuteOnCPU([s])){const i=n.texData.get(s.dataId),[o,a]=cFe(i.values,s.shape,s.dtype);return n.makeTensorInfo(a,s.dtype,o)}let r;return oe().getBool("WEBGL_PACK_UNARY_OPERATIONS")?r=new zu(s.shape,Dje):r=new sl(s.shape,Rje),n.runWebGLProgram(r,[s],s.dtype)}const Pje={kernelName:sS,backendName:"webgl",kernelFunc:Oje};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fje=xR;function Lje(t){pi("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:s}=t,{boxes:r,scores:i}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l}=s,c=n.readSync(r.dataId),u=n.readSync(i.dataId),{selectedIndices:d}=Fje(c,u,o,a,l);return n.makeTensorInfo([d.length],"int32",new Int32Array(d))}const Mje={kernelName:X$,backendName:"webgl",kernelFunc:Lje};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zje=vR;function Vje(t){pi("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:s}=t,{boxes:r,scores:i}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l,padToMaxOutputSize:c}=s,u=n.readSync(r.dataId),d=n.readSync(i.dataId),{selectedIndices:h,validOutputs:f}=zje(u,d,o,a,l,c);return[n.makeTensorInfo([h.length],"int32",new Int32Array(h)),n.makeTensorInfo([],"int32",new Int32Array([f]))]}const jje={kernelName:Y$,backendName:"webgl",kernelFunc:Vje};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bje=bR;function Wje(t){pi("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:s}=t,{boxes:r,scores:i}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l,softNmsSigma:c}=s,u=n.readSync(r.dataId),d=n.readSync(i.dataId),h=o,f=a,p=l,m=c,{selectedIndices:g,selectedScores:y}=Bje(u,d,h,f,p,m);return[n.makeTensorInfo([g.length],"int32",new Int32Array(g)),n.makeTensorInfo([y.length],"float32",new Float32Array(y))]}const Uje={kernelName:Z$,backendName:"webgl",kernelFunc:Wje};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Hje{constructor(e,n,s,r){this.variableNames=["indices"],this.outputShape=[e,n],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(${r}), float(${s}),
                      float(index == coords.y)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gje=t=>{const{inputs:e,backend:n,attrs:s}=t,{indices:r}=e,{dtype:i,depth:o,onValue:a,offValue:l}=s,c=le(r.shape),u=new Hje(c,o,a,l),d=_e({inputs:{x:r},backend:n,attrs:{shape:[c]}}),h=n.runWebGLProgram(u,[d],i);n.disposeIntermediateTensorInfo(d);const f=[...r.shape,o],p=_e({inputs:{x:h},backend:n,attrs:{shape:f}});return n.disposeIntermediateTensorInfo(h),p},Kje={kernelName:oS,backendName:"webgl",kernelFunc:Gje};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tw(t){const{inputs:e,backend:n}=t,{x:s}=e;if(s.dtype==="complex64"){const r=B0({inputs:{input:s},backend:n}),i=Tw({inputs:{x:r},backend:n}),o=mk({inputs:{input:s},backend:n}),a=Tw({inputs:{x:o},backend:n}),l=cu({inputs:{real:i,imag:a},backend:n});return n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(a),l}else return W0({attrs:{shape:s.shape,dtype:s.dtype,value:s.dtype==="string"?"":0},backend:n})}const qje={kernelName:kS,backendName:"webgl",kernelFunc:Tw};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T7(t){const{inputs:e,backend:n}=t,{x:s}=e;if(s.dtype==="string")throw new Error("onesLike is not supported under string dtype");if(s.dtype==="complex64"){const r=B0({inputs:{input:s},backend:n}),i=T7({inputs:{x:r},backend:n}),o=mk({inputs:{input:s},backend:n}),a=Tw({inputs:{x:o},backend:n}),l=cu({inputs:{real:i,imag:a},backend:n});return n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(a),l}else return W0({attrs:{shape:s.shape,dtype:s.dtype,value:1},backend:n})}const Xje={kernelName:iS,backendName:"webgl",kernelFunc:T7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yje(t){const{inputs:e,backend:n,attrs:s}=t,{axis:r}=s;if(e.length===1)return EI({inputs:{input:e[0]},backend:n,attrs:{dim:r}});const i=e[0].shape,o=e[0].dtype;e.forEach(u=>{ni(i,u.shape,"All tensors passed to stack must have matching shapes"),O(o===u.dtype,()=>"All tensors passed to stack must have matching dtypes")});const a=[],l=e.map(u=>{const d=EI({inputs:{input:u},backend:n,attrs:{dim:r}});return a.push(d),d}),c=u7({inputs:l,backend:n,attrs:{axis:r}});return a.forEach(u=>n.disposeIntermediateTensorInfo(u)),c}const Zje={kernelName:aS,backendName:"webgl",kernelFunc:Yje};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Qje{constructor(e,n,s){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((c,u)=>c[0]+e[u]+c[1]);const r=e.length,i=sn(r),o=n.map(c=>c[0]).join(","),a=n.map((c,u)=>c[0]+e[u]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);if(r===1){this.userCode=`
        int start = ${o};
        int end = ${a};

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(value);
          } else {
            setOutput(getX(outC - start));
          }
        }
      `;return}this.userCode=`
      ${i} start = ${i}(${o});
      ${i} end = ${i}(${a});

      void main() {
        ${i} outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(value);
        } else {
          ${i} coords = outC - start;
          setOutput(getX(${l}));
        }
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Jje{constructor(e,n,s){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((m,g)=>m[0]+e[g]+m[1]);const r=e.length,i=sn(r),o=n.map(m=>m[0]).join(","),a=n.map((m,g)=>m[0]+e[g]).join(","),l=ir("rc",r),c=ir("source",r),u=`${l[r-1]} < ${this.outputShape[r-1]}`,d=r===1?"source":`vec2(${c.slice(-2).join()})`,h=[`${i} rc = outputLoc;`,`${l[r-1]} += 1;
       if(${u}) {
      `,r===1?"":`}
       rc = outputLoc;
       ${l[r-2]} += 1;
       if(${l[r-2]} < ${this.outputShape[r-2]}) {`,r===1?"":`  ${l[r-1]} += 1;
         if(${u}) {`],f=r===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))";let p="";for(let m=0,g=r===1?2:4;m<g;m++)p+=`
        ${h[m]}
        if (${f}) {
          result[${m}] = float(value);
        } else {
          ${i} source = rc - start;
          result[${m}] = getChannel(getX(${c.join()}), ${d});
        }
      `;p+=r===1?"} ":"}}",this.userCode=`
      const ${i} start = ${i}(${o});
      const ${i} end = ${i}(${a});

      void main() {
        ${i} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${p}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const N7=t=>{const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{paddings:i,constantValue:o}=s;if(le(r.shape)===0){const c=i.map((u,d)=>u[0]+r.shape[d]+u[1]);return W0({backend:n,attrs:{shape:c,value:o,dtype:r.dtype}})}const a=oe().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Jje(r.shape,i,o):new Qje(r.shape,i,o),l=[[o]];return n.runWebGLProgram(a,[r],r.dtype,l)},eBe={kernelName:lS,backendName:"webgl",kernelFunc:N7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tBe=`
  if(a < 0.0 && floor(b) < b){
    return NAN;
  }
  if (b == 0.0) {
    return 1.0;
  }
  return (round(mod(b, 2.0)) != 1) ?
      pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,nBe=`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  bvec4 isNaN1 = lessThan(a, vec4(0.0));
  bvec4 isNaN2 = lessThan(floor(b), b);
  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);
  `+V0+`
  return result;
`,sBe=Vs({opSnippet:tBe,packedOpSnippet:nBe}),rBe={kernelName:Yy,backendName:"webgl",kernelFunc:sBe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iBe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,keepDims:o}=s,a=r.shape.length,l=[],c=bt(i,r.shape);let u=c;const d=In(u,a);let h=r;d!=null&&(h=lr({inputs:{x:r},backend:n,attrs:{perm:d}}),u=Gn(u.length,a),l.push(h)),zs("prod",u,a);let f;if(n.shouldExecuteOnCPU([h])){const p=n.texData.get(h.dataId).values,{outVals:m,outShape:g,outDtype:y}=dFe(h.shape,h.dtype,p,u);f=n.makeTensorInfo(g,y,m)}else{const[p,m]=Ns(h.shape,u),g=le(m),y=_e({inputs:{x:h},backend:n,attrs:{shape:[-1,g]}}),x=wA(r.dtype),v=Hd(y,x,"prod",n);f=_e({inputs:{x:v},backend:n,attrs:{shape:p}}),l.push(y),l.push(v)}if(o){l.push(f);const p=Hn(f.shape,c);f=_e({inputs:{x:f},backend:n,attrs:{shape:p}})}return l.forEach(p=>n.disposeIntermediateTensorInfo(p)),f}const oBe={kernelName:uS,backendName:"webgl",kernelFunc:iBe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aBe(t){const{inputs:e,backend:n,attrs:s}=t,{paramsNestedSplits:r,paramsDenseValues:i,indices:o}=e,{outputRaggedRank:a}=s,l=r.map(y=>n.readSync(y.dataId)),c=r.map(y=>y.shape),u=n.readSync(i.dataId),d=n.readSync(o.dataId),[h,f,p]=hFe(l,c,u,i.shape,i.dtype,d,o.shape,a),m=h.map(y=>n.makeTensorInfo([y.length],"int32",y)),g=n.makeTensorInfo(p,i.dtype,f);return m.concat([g])}const lBe={kernelName:Q$,backendName:"webgl",kernelFunc:aBe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cBe(t){const{inputs:e,backend:n,attrs:s}=t,{shape:r,values:i,defaultValue:o,rowPartitionTensors:a}=e,{rowPartitionTypes:l}=s,c=n.readSync(r.dataId),u=n.readSync(i.dataId),d=n.readSync(o.dataId),h=a.map(g=>n.readSync(g.dataId)),f=a.map(g=>g.shape),[p,m]=fFe(c,r.shape,u,i.shape,i.dtype,d,o.shape,h,f,l);return n.makeTensorInfo(p,i.dtype,m)}const uBe={kernelName:J$,backendName:"webgl",kernelFunc:cBe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const I7=t=>{const{backend:e,attrs:n}=t,{start:s,stop:r,step:i,dtype:o}=n,a=pFe(s,r,i,o);return e.makeTensorInfo([a.length],o,a)},dBe={kernelName:eA,backendName:"webgl",kernelFunc:I7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hBe="return 1.0 / x;",fBe=Dt({opSnippet:hBe}),pBe={kernelName:Zy,backendName:"webgl",kernelFunc:fBe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mBe=fo+`
  return (x < 0.0) ? 0.0 : x;
`,gBe=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,yBe=Dt({opSnippet:mBe,packedOpSnippet:gBe}),xBe={kernelName:Qy,backendName:"webgl",kernelFunc:yBe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vBe=fo+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,bBe=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,wBe=Dt({opSnippet:vBe,packedOpSnippet:bBe}),SBe={kernelName:Jy,backendName:"webgl",kernelFunc:wBe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class kBe{constructor(e,n,s,r,i){this.variableNames=["A"],this.outputShape=[];const[o,a,l,c]=e;this.outputShape=[o,n,s,c];const u=[r&&n>1?a-1:a,r&&s>1?l-1:l],d=[r&&n>1?n-1:n,r&&s>1?s-1:s];let h;i?h="(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":h="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${u[0]/d[0]},
          ${u[1]/d[1]});
      const vec2 inputShapeRC = vec2(${a}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${h};

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class CBe{constructor(e,n,s,r,i){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[o,a,l,c]=e;this.outputShape=[o,n,s,c];const u=[r&&n>1?a-1:a,r&&s>1?l-1:l],d=[r&&n>1?n-1:n,r&&s>1?s-1:s];let h;i?h="(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":h="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${u[0]/d[0]},
          ${u[1]/d[1]},
          ${u[1]/d[1]});
      const vec3 inputShapeRC = vec3(${a}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${h};

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${c-1};
        bool hasNextRow = coords.z < ${s-1};

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TBe(t){const{inputs:e,backend:n,attrs:s}=t,{images:r}=e,{alignCorners:i,halfPixelCenters:o,size:a}=s,[l,c]=a,u=oe().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new CBe(r.shape,l,c,i,o):new kBe(r.shape,l,c,i,o);return n.runWebGLProgram(u,[r],"float32")}const NBe={kernelName:fS,backendName:"webgl",kernelFunc:TBe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class IBe{constructor(e,n,s){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;const[,r,i]=n,[,o,a]=e,l=[s&&o>1?r-1:r,s&&a>1?i-1:i],c=[s&&o>1?o-1:o,s&&a>1?a-1:a],u=l[0]/c[0],d=l[1]/c[1],h=1/u,f=1/d,p=Math.ceil(h)*2+2,m=Math.ceil(f)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${u});
        const float widthScale = float(${d});

        const float invHeightScale = float(${h});
        const float invWidthScale = float(${f});

        const int winHeight = int(${p});
        const int winWidth = int(${m});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${o}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${a}) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), ${r-1}.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), ${i-1}.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _Be(t){const{inputs:e,backend:n,attrs:s}=t,{images:r,dy:i}=e,{alignCorners:o}=s,a=new IBe(i.shape,r.shape,o);return n.runWebGLProgram(a,[i],i.dtype)}const EBe={kernelName:sA,backendName:"webgl",kernelFunc:_Be};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $Be{constructor(e,n,s,r,i){this.variableNames=["A"],this.outputShape=[];const[o,a,l,c]=e;this.outputShape=[o,n,s,c];const u=[r&&n>1?a-1:a,r&&s>1?l-1:l],d=[r&&n>1?n-1:n,r&&s>1?s-1:s],h=r?"0.5":"0.0";let f;i?f="max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":f="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${u[0]/d[0]},
          ${u[1]/d[1]});
      const vec2 inputShapeRC = vec2(${a}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${f};

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${h})));
        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ABe{constructor(e,n,s,r,i){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[o,a,l,c]=e;this.outputShape=[o,n,s,c];const u=[r&&n>1?a-1:a,r&&s>1?l-1:l],d=[r&&n>1?n-1:n,r&&s>1?s-1:s],h=r?"0.5":"0.0";let f;i?f="max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":f="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${u[0]/d[0]},
          ${u[1]/d[1]},
          ${u[1]/d[1]});
      const vec3 inputShapeRC = vec3(${a}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${f};

        // Compute the coordinators of nearest neighbor point.
        ivec3 sourceNearestRC = ivec3(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${h})));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${c-1};
        bool hasNextRow = coords.z < ${s-1};

        vec4 newValue = vec4(
          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),
          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RBe(t){const{inputs:e,backend:n,attrs:s}=t,{images:r}=e,{alignCorners:i,halfPixelCenters:o,size:a}=s,[l,c]=a,u=oe().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new ABe(r.shape,l,c,i,o):new $Be(r.shape,l,c,i,o);return n.runWebGLProgram(u,[r],r.dtype)}const DBe={kernelName:hS,backendName:"webgl",kernelFunc:RBe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class OBe{constructor(e,n,s){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;const[,r,i]=n,[,o,a]=e,l=[s&&o>1?r-1:r,s&&a>1?i-1:i],c=[s&&o>1?o-1:o,s&&a>1?a-1:a],u=l[0]/c[0],d=l[1]/c[1],h=1/u,f=1/d,p=Math.ceil(h)*2+2,m=Math.ceil(f)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${u});
        const float widthScale = float(${d});

        const float invHeightScale = float(${h});
        const float invWidthScale = float(${f});

        const int winHeight = int(${p});
        const int winWidth = int(${m});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${o}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${a}) {
              continue;
            }

            float sourceFracRow =
              float(${l[0]}) *
                (float(dyR) / float(${c[0]}));

            float sourceFracCol =
                float(${l[1]}) *
                  (float(dyC) / float(${c[1]}));

            int sourceNearestRow = int(min(
                float(int(${r}) - 1),
                ${s} ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(${i}) - 1),
                ${s} ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PBe(t){const{inputs:e,backend:n,attrs:s}=t,{images:r,dy:i}=e,{alignCorners:o}=s,a=new OBe(i.shape,r.shape,o);return n.runWebGLProgram(a,[i],i.dtype)}const FBe={kernelName:nA,backendName:"webgl",kernelFunc:PBe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class LBe{constructor(e,n){this.variableNames=["x"];const s=e.length;if(s>4)throw new Error(`WebGL backend: Reverse of rank-${s} tensor is not yet supported`);if(this.outputShape=e,s===1){this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(${e[0]} - coord - 1));
        }
      `;return}const r=a=>n.indexOf(a)!==-1&&e[a]!==1?`${e[a]} - coords[${a}] - 1`:`coords[${a}]`,i=e.map((a,l)=>r(l)).join(","),o=sn(s);this.userCode=`
      void main() {
        ${o} coords = getOutputCoords();
        setOutput(getX(${i}));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class MBe{constructor(e,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;const s=e.length;if(s>4)throw new Error(`WebGL backend: Reverse of rank-${s} tensor is not yet supported`);this.outputShape=e;const r=ir("rc",s),i=`${r[s-1]} + 1 < ${this.outputShape[s-1]}`,o=`${r[s-2]} + 1 < ${this.outputShape[s-2]}`,a=sn(s);s===1?this.userCode=`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(${e[0]} - rc - 1),
            ${e[0]} - rc - 1);
          if(${i}){
              result.g = getChannel(getX(${e[0]} - (rc  + 1) - 1),
                ${e[0]} - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:this.userCode=`
        void main() {
          ${a} rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = ${l(r.slice())};
          if(${i}){
            result.g = ${c(r.slice())};
          }
          if(${o}) {
            result.b = ${u(r.slice())};
            if(${i}) {
              result.a = ${d(r.slice())};
            }
          }
          setOutput(result);
        }
    `;function l(p){return h(p)}function c(p){return p[s-1]="("+p[s-1]+" + 1)",h(p)}function u(p){return p[s-2]="("+p[s-2]+" + 1)",h(p)}function d(p){return p[s-1]="("+p[s-1]+" + 1)",p[s-2]="("+p[s-2]+" + 1)",h(p)}function h(p){const m=e.map((x,v)=>f(v,p)),g=m.join(","),y=m.slice(-2).join(",");return`getChannel(getX(${g}), vec2(${y}))`}function f(p,m){return n.indexOf(p)!==-1&&e[p]!==1?`${e[p]} - ${m[p]} - 1`:`${m[p]}`}}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zBe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{dims:i}=s,o=r.shape.length,a=bt(i,r.shape);if(o===0)return ei({inputs:{x:r},backend:n});const l=oe().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new MBe(r.shape,a):new LBe(r.shape,a);return n.runWebGLProgram(l,[r],r.dtype)}const VBe={kernelName:pS,backendName:"webgl",kernelFunc:zBe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class jBe{constructor(e,n){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];const s=e[1],r=e[2];this.outputShape=e;let i="";typeof n=="number"?i=`float outputValue = ${n.toFixed(2)};`:i=`
        vec3 fill = vec3(${n.join(",")});
        float outputValue = fill[coords[3]];`,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];
          int y = coords[1];
          float coordXFloat = (float(x) - params[0]) * params[3] -
            (float(y) - params[1]) * params[2];
          float coordYFloat = (float(x) - params[0]) * params[2] +
            (float(y) - params[1]) * params[3];
          int coordX = int(round(coordXFloat + params[0]));
          int coordY = int(round(coordYFloat + params[1]));
          ${i}
          if(coordX >= 0 && coordX < ${r} && coordY >= 0 && coordY < ${s}) {
            outputValue = getImage(coords[0], coordY, coordX, coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BBe={kernelName:vA,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:s}=t,{radians:r,fillValue:i,center:o}=e,a=n,l=new jBe(s.shape,i),[c,u]=$R(o,s.shape[1],s.shape[2]),d=[[c,u,Math.sin(r),Math.cos(r)]];return a.runWebGLProgram(l,[s],s.dtype,d)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WBe=`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`,UBe=Dt({opSnippet:WBe}),HBe={kernelName:e0,backendName:"webgl",kernelFunc:UBe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GBe="return inversesqrt(x);",KBe=Dt({opSnippet:GBe,cpuKernelImpl:mFe}),qBe={kernelName:t0,backendName:"webgl",kernelFunc:KBe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _7{constructor(e,n,s,r,i,o,a=!0){this.variableNames=["updates","indices","defaultValue"],this.outputShape=o;const l=sn(i.length),c=sn(o.length);let u="";s===1?u="i":s===2&&(u="i, j");const d=`getIndices(${u})`;let h="";r===1?h="i":r===2&&(h="i, coords[1]");const f=`getUpdates(${h})`,p=n>1?"strides[j]":"strides";this.userCode=`
        ${l} strides = ${l}(${i});

        void main() {
          ${c} coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < ${e}; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < ${n}; j++) {
              int index = round(${d});
              flattenedIndex += index * ${p};
            }
            if (flattenedIndex == coords[0]) {
              sum += ${f};
              found = true;
            }
          }
          setOutput(mix(getDefaultValue(), sum, float(found)));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XBe(t){const{inputs:e,backend:n,attrs:s}=t,{indices:r,updates:i}=e,{shape:o}=s,{sliceRank:a,numUpdates:l,sliceSize:c,strides:u,outputSize:d}=g0(i,r,o),h=[d/c,c];if(d===0)return n.makeTensorInfo(o,r.dtype);const f=_e({inputs:{x:r},backend:n,attrs:{shape:[l,a]}}),p=_e({inputs:{x:i},backend:n,attrs:{shape:[l,c]}}),m=n.makeTensorInfo([],"float32",new Float32Array([0])),g=new _7(l,a,f.shape.length,p.shape.length,u,h),y=n.runWebGLProgram(g,[p,f,m],p.dtype),x=_e({inputs:{x:y},backend:n,attrs:{shape:o}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(m),x}const YBe={kernelName:rA,backendName:"webgl",kernelFunc:XBe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ZBe{constructor(e,n,s,r){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[e,s];const i="while (left < right) {",o=`for (int i = 0; i < ${Math.ceil(Math.log2(n+1))}; ++i) { if (left >= right) break;`,a=oe().getNumber("WEBGL_VERSION")===2?i:o,l=r==="left"?"<":"<=";this.userCode=`
       int findBound(int batch, float value) {
         int left = 0;
         int right = numInputs;
         int mid;
         ${a}
           mid = (left + right) / 2;
           if (getSortedSequence(batch, mid) ${l} value) {
             left = mid + 1;
           } else {
             right = mid;
           }
         }
         return right;
       }

       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int valueIndex = coords[1];

         float value = getValues(batch, valueIndex);

         setOutput(float(findBound(batch, value)));
       }
     `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QBe(t){const{inputs:e,backend:n,attrs:s}=t,{sortedSequence:r,values:i}=e,{side:o}=s,a=new ZBe(r.shape[0],r.shape[1],i.shape[1],o),l=[[r.shape[1]]];return n.runWebGLProgram(a,[r,i],"int32",l)}const JBe={kernelName:iA,backendName:"webgl",kernelFunc:QBe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class e4e{constructor(e,n,s){this.variableNames=["c","a","b"],this.outputShape=n;let r,i;if(s>4)throw Error(`Where for rank ${s} is not yet supported`);if(s===1)i="resRC",r="resRC";else{const a=["resRC.x","resRC.y","resRC.z","resRC.w"],l=[],c=[];for(let u=0;u<n.length;u++)c.push(`${a[u]}`),u<e&&l.push(`${a[u]}`);r=l.join(),i=c.join()}const o=sn(s);this.userCode=`
      void main() {
        ${o} resRC = getOutputCoords();
        float cVal = getC(${r});
        if (cVal >= 1.0) {
          setOutput(getA(${i}));
        } else {
          setOutput(getB(${i}));
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t4e(t){const{inputs:e,backend:n}=t,{condition:s,t:r,e:i}=e,o=new e4e(s.shape.length,r.shape,r.shape.length);return n.runWebGLProgram(o,[s,r,i],Zr(r.dtype,i.dtype))}const n4e={kernelName:mS,backendName:"webgl",kernelFunc:t4e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const s4e=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = ${YS};
  float scale = ${ZS};
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,r4e=Dt({opSnippet:s4e}),i4e={kernelName:n0,backendName:"webgl",kernelFunc:r4e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const o4e=xp+`
  return 1.0 / (1.0 + exp(-1.0 * x));
`,a4e=`
  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,l4e=Dt({opSnippet:o4e,packedOpSnippet:a4e,cpuKernelImpl:yFe}),c4e={kernelName:o0,backendName:"webgl",kernelFunc:l4e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const u4e=`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`,d4e=Dt({opSnippet:u4e}),h4e={kernelName:i0,backendName:"webgl",kernelFunc:d4e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const f4e=xp+`
  return sin(x);
`,p4e=Dt({opSnippet:f4e}),m4e={kernelName:s0,backendName:"webgl",kernelFunc:p4e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const g4e=`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`,y4e=Dt({opSnippet:g4e}),x4e={kernelName:r0,backendName:"webgl",kernelFunc:y4e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const v4e=`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`,b4e=Dt({opSnippet:v4e}),w4e={kernelName:a0,backendName:"webgl",kernelFunc:b4e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const S4e=t=>{const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{blockShape:i,paddings:o}=s;O(r.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");const a=i.reduce((y,x)=>y*x),l=[[0,0]];l.push(...o);for(let y=1+i.length;y<r.shape.length;++y)l.push([0,0]);const c=[],u=N7({inputs:{x:r},backend:n,attrs:{paddings:l,constantValue:0}}),d=C0(u.shape,i,a,!1),h=T0(d.length,i.length,!1),f=N0(u.shape,i,a,!1),p=_e({inputs:{x:u},backend:n,attrs:{shape:d}}),m=lr({inputs:{x:p},backend:n,attrs:{perm:h}}),g=_e({inputs:{x:m},backend:n,attrs:{shape:f}});return c.push(u),c.push(p),c.push(m),c.forEach(y=>n.disposeIntermediateTensorInfo(y)),g},k4e={kernelName:xS,backendName:"webgl",kernelFunc:S4e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C4e(t){const{inputs:e,backend:n}=t,{indices:s,values:r,denseShape:i,defaultValue:o}=e;if(i.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
         ${i.shape}`);if(s.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
         ${s.shape}`);if(r.shape.length!==1)throw new Error(`Values must be a vector, saw:
         ${r.shape}`);if(o.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${o.shape}`);const a=n.readSync(s.dataId),l=n.readSync(r.dataId),c=n.readSync(i.dataId),u=n.readSync(o.dataId)[0],[d,h,f,p,m]=vFe(a,s.shape,s.dtype,l,r.dtype,c,u);return[n.makeTensorInfo(h,s.dtype,d),n.makeTensorInfo([h[0]],r.dtype,f),n.makeTensorInfo([p.length],"bool",new Uint8Array(p.map(g=>Number(g)))),n.makeTensorInfo([m.length],s.dtype,new Int32Array(m))]}const T4e={kernelName:oA,backendName:"webgl",kernelFunc:C4e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N4e(t){const{inputs:e,backend:n}=t,{inputIndices:s,inputShape:r,newShape:i}=e;if(s.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape ${s.shape}`);if(r.shape.length!==1)throw new Error(`Input shape should be a vector but received shape ${r.shape}`);if(i.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${i.shape}`);const o=Array.from(n.readSync(r.dataId)),a=n.readSync(s.dataId),l=Array.from(n.readSync(i.dataId)),[c,u,d]=bFe(a,s.shape,s.dtype,o,l);return[n.makeTensorInfo(u,s.dtype,c),n.makeTensorInfo([d.length],i.dtype,new Int32Array(d))]}const I4e={kernelName:aA,backendName:"webgl",kernelFunc:N4e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _4e(t){const{inputs:e,backend:n}=t,{data:s,indices:r,segmentIds:i}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
              ${r.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
              ${i.shape}`);const o=n.readSync(s.dataId),a=n.readSync(r.dataId),l=n.readSync(i.dataId),[c,u]=ZX(o,s.shape,s.dtype,a,l,!0);return n.makeTensorInfo(u,s.dtype,c)}const E4e={kernelName:lA,backendName:"webgl",kernelFunc:_4e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $4e(t){const{inputs:e,backend:n}=t,{data:s,indices:r,segmentIds:i}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
             ${r.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
             ${i.shape}`);const o=n.readSync(s.dataId),a=n.readSync(r.dataId),l=n.readSync(i.dataId),[c,u]=ZX(o,s.shape,s.dtype,a,l);return n.makeTensorInfo(u,s.dtype,c)}const A4e={kernelName:cA,backendName:"webgl",kernelFunc:$4e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R4e(t){const{inputs:e,backend:n,attrs:s}=t,{sparseIndices:r,sparseValues:i,defaultValue:o}=e,{outputShape:a}=s,{sliceRank:l,numUpdates:c,sliceSize:u,strides:d,outputSize:h}=g0(i,r,a),f=!1;if(i.dtype==="string"){const y=n.bufferSync(r),x=n.bufferSync(i),v=Mc(n.readSync(o.dataId)[0]),b=gFe(y,x,a,h,u,c,l,d,v,f);return n.makeTensorInfo(a,b.dtype,b.values)}const p=new _7(c,l,r.shape.length,i.shape.length,d,[h,1],f),m=n.runWebGLProgram(p,[i,r,o],i.dtype),g=_e({inputs:{x:m},backend:n,attrs:{shape:a}});return n.disposeIntermediateTensorInfo(m),g}const D4e={kernelName:uA,backendName:"webgl",kernelFunc:R4e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O4e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{numOrSizeSplits:i,axis:o}=s,a=bt(o,r.shape)[0],l=HR(r,i,a),c=r.shape.length,u=new Array(c).fill(0),d=r.shape.slice();return l.map(h=>{const f=[...d];f[a]=h;const p=vp({inputs:{x:r},backend:n,attrs:{begin:u,size:f}});return u[a]+=h,p})}const P4e={kernelName:vS,backendName:"webgl",kernelFunc:O4e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RV="return sqrt(x);",F4e=Dt({opSnippet:RV,packedOpSnippet:RV,cpuKernelImpl:wFe}),L4e={kernelName:l0,backendName:"webgl",kernelFunc:F4e};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const M4e="return x * x;",z4e=Dt({opSnippet:M4e}),V4e={kernelName:dA,backendName:"webgl",kernelFunc:z4e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DV="return (a - b) * (a - b);",j4e=Vs({opSnippet:DV,packedOpSnippet:DV}),B4e={kernelName:c0,backendName:"webgl",kernelFunc:j4e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W4e({inputs:t,attrs:e,backend:n}){const{x:s}=t,r=fo+`
    return x > 0.0 ? 1.0 : float(${e.alpha});
  `,i=new sl(s.shape,r);return n.runWebGLProgram(i,[s],s.dtype)}const U4e={kernelName:p0,backendName:"webgl",kernelFunc:W4e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class H4e{constructor(e,n,s){this.variableNames=["x"],this.outputShape=s;const r=s.length,i=sn(s.length),o=sn(s.length);let a="";if(r===1)a="coords * strides + begin";else{let l=0;a=s.map((c,u)=>(l++,s.length===1?`coords * strides[${u}] + begin[${u}]`:`coords[${l-1}] * strides[${u}] + begin[${u}]`)).join(",")}this.userCode=`
      ${i} begin = ${i}(${e});
      ${i} strides = ${i}(${n});

      void main() {
        ${o} coords = getOutputCoords();
        setOutput(getX(${a}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G4e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{begin:i,end:o,strides:a,beginMask:l,endMask:c,ellipsisMask:u,newAxisMask:d,shrinkAxisMask:h}=s,{finalShapeSparse:f,finalShape:p,isIdentity:m,sliceDim0:g,isSimpleSlice:y,begin:x,end:v,strides:b}=DA(r.shape,i,o,a,l,c,u,d,h);let k;if(m)k=_e({inputs:{x:r},backend:n,attrs:{shape:p}});else if(g||y){O(r.shape.length>=1,()=>`Input must have rank at least 1, got: ${r.shape.length}`);const N=$A(x,v,b),I=vp({inputs:{x:r},backend:n,attrs:{begin:x,size:N}});k=_e({inputs:{x:I},backend:n,attrs:{shape:p}}),n.disposeIntermediateTensorInfo(I)}else if(n.shouldExecuteOnCPU([r])){const I=n.readSync(r.dataId),$=gt(r.shape,r.dtype,I),A=SFe(f,$,b,x);k=n.makeTensorInfo(p,r.dtype,A.values)}else{const I=new H4e(x,b,f);k=n.runWebGLProgram(I,[r],r.dtype)}const C=_e({inputs:{x:k},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(k),C}const K4e={kernelName:hA,backendName:"webgl",kernelFunc:G4e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function q4e(t){const{inputs:e,backend:n,attrs:s}=t,{separator:r,nGramWidths:i,leftPad:o,rightPad:a,padWidth:l,preserveShortSequences:c}=s,{data:u,dataSplits:d}=e,h=n.readSync(u.dataId),f=n.readSync(d.dataId),[p,m]=kFe(h,f,r,i,o,a,l,c);return[n.makeTensorInfo([p.length],"string",p),n.makeTensorInfo(d.shape,"int32",m)]}const X4e={kernelName:fA,backendName:"webgl",kernelFunc:q4e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y4e(t){const{inputs:e,backend:n,attrs:s}=t,{skipEmpty:r}=s,{input:i,delimiter:o}=e;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(i.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${i.shape}`);if(o.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${o.shape}`);const a=n.readSync(i.dataId),l=n.readSync(o.dataId)[0],[c,u,d]=CFe(a,l,r),h=u.length;return[n.makeTensorInfo([h,2],"int32",c),n.makeTensorInfo([h],"string",u),n.makeTensorInfo([2],"int32",new Int32Array(d))]}const Z4e={kernelName:pA,backendName:"webgl",kernelFunc:Y4e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q4e(t){const{inputs:e,backend:n,attrs:s}=t,{numBuckets:r}=s,{input:i}=e;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(r<=0)throw new Error("Number of buckets must be at least 1");const o=n.readSync(i.dataId),a=TFe(o,r);return n.makeTensorInfo(i.shape,"int32",a)}const J4e={kernelName:mA,backendName:"webgl",kernelFunc:Q4e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eWe="return tan(x);",tWe=Dt({opSnippet:eWe}),nWe={kernelName:d0,backendName:"webgl",kernelFunc:tWe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sWe=`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`,rWe=Dt({opSnippet:sWe}),iWe={kernelName:h0,backendName:"webgl",kernelFunc:rWe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class oWe{constructor(e,n){this.variableNames=["A"];const s=new Array(e.length);for(let o=0;o<s.length;o++)s[o]=e[o]*n[o];this.outputShape=s,this.rank=s.length;const r=sn(this.rank),i=aWe(e);this.userCode=`
      void main() {
        ${r} resRC = getOutputCoords();
        setOutput(getA(${i}));
      }
    `}}function aWe(t){const e=t.length;if(e>5)throw Error(`Tile for rank ${e} is not yet supported`);if(e===1)return`imod(resRC, ${t[0]})`;const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],s=[];for(let r=0;r<t.length;r++)s.push(`imod(${n[r]}, ${t[r]})`);return s.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E7(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{reps:i}=s;if(r.dtype==="string"||r.shape.length>5){const l=n.readSync(r.dataId),c=r.dtype==="string"?l.map(h=>Mc(h)):l,u=gt(r.shape,r.dtype,c),d=IFe(u,i);return n.makeTensorInfo(d.shape,d.dtype,d.values)}const o=new oWe(r.shape,i);return n.runWebGLProgram(o,[r],r.dtype)}const lWe={kernelName:f0,backendName:"webgl",kernelFunc:E7};class cWe{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=e,this.userCode=`
       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // We compare elements pair-wise within a group of size 2 * inc.
         // The comparing rule for each group alternates between ascending
         // and descending. Within each group, we compare each pair at
         // positions i and i+inc. To decide whether an element at position i
         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than
         // inc, it is in the first half of the group, we denote it as x0,
         // otherwise we denote it as x1.
         // For example, as shown in the Bitonic top K paper referenced above,
         // Figure5(a) shows that element[1] is in the
         // second half of the group when group size is 2, but it is in the
         // first half of the group when group size is 4.

         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;
         int i = isFirstInPair ? elemIdx : elemIdx - inc;

         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));
         float x0 = i0 < n ? getX(batch, i0) : negativeInf;
         float x1 = i1 < n ? getX(batch, i1) : negativeInf;

         // Denotes which direction indices are in (ascending or descending).
         bool reverse = imod(elemIdx, 2 * dir) >= dir;
         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);
         if (reverse == isGreater) { // Elements in opposite order of direction
           int iTemp = i0;
           i0 = i1;
           i1 = iTemp;
         }
         if (isFirstInPair) {
            setOutput(float(i0));
         } else {
            setOutput(float(i1));
         }
       }
     `}}class uWe{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=e,this.userCode=`
    void main() {
         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // The output size is half of the previous size.
         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),
         // we only need to output the indices at positions |, the indices at
         // positions _ can be thrown away, see Figure5(b) After Phase 2
         // (Merge phase) in the Bitonic Top K paper referenced above.
         // For example, the paper shows we only need to output the orange bars.
         // The output sequence should look like this | | | | | | | |.
         // Because the sequence is halved, to map the output index back
         // to the previous sequence to find the corresponding value,
         // we need to double the index. When we double the index,
         // we basically interpolate a position, so 2i looks like
         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position
         // of each 2k positions by - elemIdx % k. E.g. for output at
         // index 4,5,6,7, we want to get the corresponding element at
         // original index 8,9,10,11, for output at index 8,9,10,11,
         // we want to get the corresponding element at original index
         // 16,17,18,19, so on and so forth.

         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));
         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));

         float x0 = getX(batch, i0);
         float x1 = i1 < n ? getX(batch, i1) : x0;

         setOutput(x0 >= x1 ? float(i0) : float(i1));
       }
     `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wu(t,e){e!==null&&t.disposeIntermediateTensorInfo(e)}function OV(t){let e=1;for(;e<t;)e*=2;return e}function dWe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{k:i,sorted:o}=s,a=oe().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),l=oe().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),c=r.shape,u=c[c.length-1];if(n.shouldExecuteOnCPU([r])||u<a||i>l){const A=n.readSync(r.dataId),[P,F]=_Fe(A,c,r.dtype,i,o);return[n.makeTensorInfo(P.shape,P.dtype,P.values),n.makeTensorInfo(F.shape,F.dtype,F.values)]}if(i===0)return c[c.length-1]=0,[n.makeTensorInfo(c,r.dtype,[]),n.makeTensorInfo(c,"int32",[])];if(u===1)return[r,W0({attrs:{shape:c,dtype:"int32",value:0},backend:n})];const d=n.texData.get(r.dataId),h=d!==null&&d.isPacked,f=h?n.unpackTensor(r):r,m=le(c)/u,g=_e({inputs:{x:f},attrs:{shape:[m,u]},backend:n});h&&wu(n,f);const y=OV(i),x=OV(u);let v=null;const b=()=>v===null?[g,g]:[g,v],k=(A,P,F)=>{const V=b(),z=new cWe(F),W=[[u],[v===null?1:0],[Number.NEGATIVE_INFINITY],[A],[P]],q=v;v=n.runWebGLProgram(z,V,"int32",W),wu(n,q)};for(let A=1;A<y;A*=2){const P=A*2;for(let F=A;F>=1;F/=2)k(P,F,[m,x])}for(let A=x;A>y;A/=2){const P=b(),F=new uWe([m,A/2]),z=[[u],[v===null?1:0],[y]],B=v;v=n.runWebGLProgram(F,P,"int32",z),wu(n,B);const W=y/2,q=W*2;for(let M=W;M>=1;M/=2)k(q,M,v.shape)}let C=v;v=vp({inputs:{x:v},backend:n,attrs:{begin:0,size:[m,i]}}),wu(n,C);let N=b7({inputs:{x:g,indices:v},backend:n,attrs:{axis:1,batchDims:1}});wu(n,g);const I=c.slice(0,-1);I.push(i),C=v,v=_e({inputs:{x:v},attrs:{shape:I},backend:n}),wu(n,C);const $=N;return N=_e({inputs:{x:N},attrs:{shape:I},backend:n}),wu(n,$),[N,v]}const hWe={kernelName:gA,backendName:"webgl",kernelFunc:dWe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class fWe{constructor(e,n,s,r,i,o){this.variableNames=["Image","Transforms"],this.outputShape=o;const a=s==="nearest"?1:2;let l;switch(r){case"constant":l=1;break;case"reflect":l=2;break;case"wrap":l=3;break;case"nearest":l=4;break;default:l=1;break}this.userCode=`
            float mapCoord(float outCoord, float len) {
              float inCoord = outCoord;
              if(${l} == 2) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    if (inCoord < sz2) {
                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +
                      inCoord;
                    }
                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    inCoord -= sz2 * float(int(float(inCoord / sz2)));
                    if (inCoord >= len) {
                      inCoord = sz2 - inCoord - 1.0;
                    }
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 3) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord -= len * float(int(float(inCoord / sz)));
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 4) {
                return clamp(outCoord, 0.0, len - 1.0);
              } else {
                return outCoord;
              }
            }

            float readWithFillValue(int batch, int coordY, int coordX,
              int channel) {
              float outputValue;
              if (0 <= coordY && coordY < ${e} && 0 <= coordX && coordX < ${n}) {
                  outputValue = getImage(batch, coordY, coordX, channel);
              } else {
                outputValue = float(${i});
              }
              return outputValue;
            }

            void main() {
              ivec4 coords = getOutputCoords();
              float outputValue;
              int batch = coords[0];
              int x = coords[2];
              int y = coords[1];
              int channel = coords[3];
              float xf = float(x);
              float yf = float(y);
              float a1 = getTransforms(batch, 0);
              float a2 = getTransforms(batch, 1);
              float a3 = getTransforms(batch, 2);
              float b1 = getTransforms(batch, 3);
              float b2 = getTransforms(batch, 4);
              float b3 = getTransforms(batch, 5);
              float c1 = getTransforms(batch, 6);
              float c2 = getTransforms(batch, 7);
              float projection = c1 * xf + c2 * yf + 1.0;
              if (projection == 0.0) {
                outputValue = float(${i});
              } else {
                float inX = (a1 * xf + a2 * yf + a3) / projection;
                float inY = (b1 * xf + b2 * yf + b3) / projection;
                float mapX = mapCoord(inX, float(${n}));
                float mapY = mapCoord(inY, float(${e}));

                if (${a} == 1) {
                  int coordY = int(round(mapY));
                  int coordX = int(round(mapX));
                  outputValue = readWithFillValue(batch, coordY, coordX,
                    channel);
                } else {
                  float yFloor = floor(mapY);
                  float xFloor = floor(mapX);
                  float yCeil = yFloor + 1.0;
                  float xCeil = xFloor + 1.0;
                  float valueYFloor = (xCeil - mapX) *
                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);
                  float valueYCeil = (xCeil - mapX) *
                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);
                  outputValue = (yCeil - mapY) * valueYFloor +
                  (mapY - yFloor) * valueYCeil;
                }
              }
              setOutput(outputValue);
            }
        `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pWe(t){const{inputs:e,backend:n,attrs:s}=t,{image:r,transforms:i}=e,{interpolation:o,fillMode:a,fillValue:l,outputShape:c}=s,[u,d,h,f]=r.shape,[p,m]=c??[d,h],g=[u,p,m,f],y=new fWe(d,h,o,a,l,g);return n.runWebGLProgram(y,[r,i],"float32")}const mWe={kernelName:yA,backendName:"webgl",kernelFunc:pWe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gWe(t){const{inputs:e,attrs:n,backend:s}=t,{axis:r}=n,{x:i}=e;M0(i,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");const o=s.readSync(i.dataId),{outputValues:a,outputShape:l,indices:c}=EFe(o,r,i.shape,i.dtype);return[s.makeTensorInfo(l,i.dtype,a),s.makeTensorInfo([c.length],"int32",c)]}const yWe={kernelName:xA,backendName:"webgl",kernelFunc:gWe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xWe(t){const{inputs:e,backend:n,attrs:s}=t,{value:r}=e;let{axis:i}=s;i<0&&(i+=r.shape.length);const o=r,a=o.shape.length,l=r.shape[i],c=new Array(a-1);let u=0;for(let m=0;m<a;m++)m!==i&&(c[u++]=o.shape[m]);const d=[],h=new Array(a).fill(0),f=o.shape.slice();f[i]=1;const p=new Array(l);for(let m=0;m<p.length;m++){h[i]=m;const g=vp({inputs:{x:o},backend:n,attrs:{begin:h,size:f}}),y=_e({inputs:{x:g},backend:n,attrs:{shape:c}});p[m]=y,d.push(g)}return d.forEach(m=>n.disposeIntermediateTensorInfo(m)),p}const vWe={kernelName:wS,backendName:"webgl",kernelFunc:xWe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bWe{constructor(e,n){this.variableNames=["x","segmentIds"];const s=e.windowSize,r=e.batchSize,i=e.inSize,o=e.numSegments,a=o*Math.ceil(i/s);this.outputShape=[r,a];const l="0.0",c="sumValue",u=Math.floor(s/4)*4,d=s%4,h=`
        sumValue += dot(values, segFilter);
    `;let f="";i%s>0&&(f=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return initializationValue;
        }
      `);let p="";i%s>0&&(p=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = ${l};

      float getValue(int batch, int inIdx) {
        ${f}
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        ${p}
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          ${o})) * float(${s}));
        int currentSeg = int(mod(float(outIdx), float(${o})));

        float sumValue = 0.0;

        for (int i = 0; i < ${u}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          ${h}
        }

        int inIdx = inOffset + ${u};
        if (${d===1}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          ${h}
        } else if (${d===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          ${h}
        } else if (${d===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          ${h}
        }
        setOutput(${c});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wWe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,segmentIds:i}=e,{numSegments:o}=s,a=r.shape.length,l=[];let c=0;const u=In([c],a);let d=r;u!=null&&(d=lr({inputs:{x:r},backend:n,attrs:{perm:u}}),l.push(d),c=Gn(1,a)[0]);const h=oK(d.shape,c,o),f=le([d.shape[c]]),p=_e({inputs:{x:d},backend:n,attrs:{shape:[-1,f]}});l.push(p);const m=wA(r.dtype),g=(b,k,C,N,I)=>{const $=b.shape[0],A=b.shape[1],P=iK(A,I),F={windowSize:P,inSize:A,batchSize:$,numSegments:I},V=new bWe(F,k),z=n.compileAndRun(V,[b,C],N);if(l.push(z),z.shape[1]===I)return z;const B=I7({backend:n,attrs:{start:0,stop:I,step:1,dtype:"float32"}}),W=E7({inputs:{x:B},backend:n,attrs:{reps:[A/P]}});return l.push(B),l.push(W),g(z,k,W,N,I)},y=g(p,"unsortedSegmentSum",i,m,o),x=_e({inputs:{x:y},backend:n,attrs:{shape:h}});let v=x;if(u!=null){l.push(x);const b=iu(u);v=lr({inputs:{x:v},backend:n,attrs:{perm:b}})}return l.forEach(b=>n.disposeIntermediateTensorInfo(b)),v}const SWe={kernelName:SS,backendName:"webgl",kernelFunc:wWe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kWe=[bLe,SLe,TLe,_Le,$Le,DLe,PLe,LLe,jLe,WLe,GLe,XLe,QLe,nMe,iMe,aMe,cMe,fMe,mMe,yMe,wMe,_Me,$Me,RMe,MMe,VMe,UMe,sLe,KMe,QMe,n3e,l3e,u3e,h3e,p3e,g3e,v3e,S3e,T3e,I3e,E3e,A3e,O3e,F3e,V3e,B3e,H3e,q3e,Y3e,eze,rze,lze,dze,pze,mze,yze,vze,wze,kze,Tze,Eze,Rze,Pze,Lze,Vze,Wze,Kze,Zze,nLe,Jze,YMe,nVe,iVe,lVe,iLe,hVe,gVe,xVe,SVe,TVe,EVe,RVe,FVe,VVe,WVe,HVe,XVe,ZVe,JVe,sje,ije,aje,cje,dje,mje,vje,kje,Aje,lLe,Pje,Mje,jje,Uje,OMe,Kje,Xje,Zje,eBe,rBe,aLe,oBe,lBe,uBe,dBe,PMe,Ije,pBe,xBe,SBe,uLe,NBe,EBe,DBe,FBe,VBe,BBe,HBe,qBe,YBe,JBe,n4e,i4e,c4e,h4e,m4e,x4e,NMe,Eje,w4e,k4e,T4e,I4e,E4e,A4e,D4e,P4e,L4e,V4e,B4e,U4e,K4e,X4e,Z4e,J4e,_je,yLe,nWe,iWe,lWe,hWe,mWe,xLe,yWe,vWe,SWe,qje];for(const t of kWe)P6(t);var $7={exports:{}};(function(t,e){(function(s,r){t.exports=r(D)})($o,function(n){return function(s){var r={};function i(o){if(r[o])return r[o].exports;var a=r[o]={i:o,l:!1,exports:{}};return s[o].call(a.exports,a,a.exports,i),a.l=!0,a.exports}return i.m=s,i.c=r,i.d=function(o,a,l){i.o(o,a)||Object.defineProperty(o,a,{enumerable:!0,get:l})},i.r=function(o){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(o,"__esModule",{value:!0})},i.t=function(o,a){if(a&1&&(o=i(o)),a&8||a&4&&typeof o=="object"&&o&&o.__esModule)return o;var l=Object.create(null);if(i.r(l),Object.defineProperty(l,"default",{enumerable:!0,value:o}),a&2&&typeof o!="string")for(var c in o)i.d(l,c,(function(u){return o[u]}).bind(null,c));return l},i.n=function(o){var a=o&&o.__esModule?function(){return o.default}:function(){return o};return i.d(a,"a",a),a},i.o=function(o,a){return Object.prototype.hasOwnProperty.call(o,a)},i.p="",i(i.s="./src/react-webcam.tsx")}({"./src/react-webcam.tsx":function(s,r,i){i.r(r);var o=i("react"),a=function(){var h=function(f,p){return h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(m,g){m.__proto__=g}||function(m,g){for(var y in g)g.hasOwnProperty(y)&&(m[y]=g[y])},h(f,p)};return function(f,p){h(f,p);function m(){this.constructor=f}f.prototype=p===null?Object.create(p):(m.prototype=p.prototype,new m)}}(),l=function(){return l=Object.assign||function(h){for(var f,p=1,m=arguments.length;p<m;p++){f=arguments[p];for(var g in f)Object.prototype.hasOwnProperty.call(f,g)&&(h[g]=f[g])}return h},l.apply(this,arguments)},c=function(h,f){var p={};for(var m in h)Object.prototype.hasOwnProperty.call(h,m)&&f.indexOf(m)<0&&(p[m]=h[m]);if(h!=null&&typeof Object.getOwnPropertySymbols=="function")for(var g=0,m=Object.getOwnPropertySymbols(h);g<m.length;g++)f.indexOf(m[g])<0&&Object.prototype.propertyIsEnumerable.call(h,m[g])&&(p[m[g]]=h[m[g]]);return p};(function(){typeof window>"u"||(navigator.mediaDevices===void 0&&(navigator.mediaDevices={}),navigator.mediaDevices.getUserMedia===void 0&&(navigator.mediaDevices.getUserMedia=function(f){var p=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;return p?new Promise(function(m,g){p.call(navigator,f,m,g)}):Promise.reject(new Error("getUserMedia is not implemented in this browser"))}))})();function u(){return!!(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia)}var d=function(h){a(f,h);function f(p){var m=h.call(this,p)||this;return m.canvas=null,m.ctx=null,m.requestUserMediaId=0,m.unmounted=!1,m.state={hasUserMedia:!1},m}return f.prototype.componentDidMount=function(){var p=this,m=p.state,g=p.props;if(!u()){g.onUserMediaError("getUserMedia not supported");return}m.hasUserMedia||this.requestUserMedia()},f.prototype.componentDidUpdate=function(p){var m=this.props;if(!u()){m.onUserMediaError("getUserMedia not supported");return}var g=JSON.stringify(p.audioConstraints)!==JSON.stringify(m.audioConstraints),y=JSON.stringify(p.videoConstraints)!==JSON.stringify(m.videoConstraints),x=p.minScreenshotWidth!==m.minScreenshotWidth,v=p.minScreenshotHeight!==m.minScreenshotHeight;(y||x||v)&&(this.canvas=null,this.ctx=null),(g||y)&&(this.stopAndCleanup(),this.requestUserMedia())},f.prototype.componentWillUnmount=function(){this.unmounted=!0,this.stopAndCleanup()},f.stopMediaStream=function(p){p&&(p.getVideoTracks&&p.getAudioTracks?(p.getVideoTracks().map(function(m){p.removeTrack(m),m.stop()}),p.getAudioTracks().map(function(m){p.removeTrack(m),m.stop()})):p.stop())},f.prototype.stopAndCleanup=function(){var p=this.state;p.hasUserMedia&&(f.stopMediaStream(this.stream),p.src&&window.URL.revokeObjectURL(p.src))},f.prototype.getScreenshot=function(p){var m=this,g=m.state,y=m.props;if(!g.hasUserMedia)return null;var x=this.getCanvas(p);return x&&x.toDataURL(y.screenshotFormat,y.screenshotQuality)},f.prototype.getCanvas=function(p){var m=this,g=m.state,y=m.props;if(!this.video||!g.hasUserMedia||!this.video.videoHeight)return null;if(!this.ctx){var x=this.video.videoWidth,v=this.video.videoHeight;if(!this.props.forceScreenshotSourceSize){var b=x/v;x=y.minScreenshotWidth||this.video.clientWidth,v=x/b,y.minScreenshotHeight&&v<y.minScreenshotHeight&&(v=y.minScreenshotHeight,x=v*b)}this.canvas=document.createElement("canvas"),this.canvas.width=(p==null?void 0:p.width)||x,this.canvas.height=(p==null?void 0:p.height)||v,this.ctx=this.canvas.getContext("2d")}var k=this,C=k.ctx,N=k.canvas;return C&&N&&(y.mirrored&&(C.translate(N.width,0),C.scale(-1,1)),C.imageSmoothingEnabled=y.imageSmoothing,C.drawImage(this.video,0,0,(p==null?void 0:p.width)||N.width,(p==null?void 0:p.height)||N.height),y.mirrored&&(C.scale(-1,1),C.translate(-N.width,0))),N},f.prototype.requestUserMedia=function(){var p=this,m=this.props,g=function(v,b){var k={video:typeof b<"u"?b:!0};m.audio&&(k.audio=typeof v<"u"?v:!0),p.requestUserMediaId++;var C=p.requestUserMediaId;navigator.mediaDevices.getUserMedia(k).then(function(N){p.unmounted||C!==p.requestUserMediaId?f.stopMediaStream(N):p.handleUserMedia(null,N)}).catch(function(N){p.handleUserMedia(N)})};if("mediaDevices"in navigator)g(m.audioConstraints,m.videoConstraints);else{var y=function(v){return{optional:[{sourceId:v}]}},x=function(v){var b=v.deviceId;return typeof b=="string"?b:Array.isArray(b)&&b.length>0?b[0]:typeof b=="object"&&b.ideal?b.ideal:null};MediaStreamTrack.getSources(function(v){var b=null,k=null;v.forEach(function(I){I.kind==="audio"?b=I.id:I.kind==="video"&&(k=I.id)});var C=x(m.audioConstraints);C&&(b=C);var N=x(m.videoConstraints);N&&(k=N),g(y(b),y(k))})}},f.prototype.handleUserMedia=function(p,m){var g=this.props;if(p||!m){this.setState({hasUserMedia:!1}),g.onUserMediaError(p);return}this.stream=m;try{this.video&&(this.video.srcObject=m),this.setState({hasUserMedia:!0})}catch{this.setState({hasUserMedia:!0,src:window.URL.createObjectURL(m)})}g.onUserMedia(m)},f.prototype.render=function(){var p=this,m=this,g=m.state,y=m.props,x=y.audio;y.forceScreenshotSourceSize,y.onUserMedia,y.onUserMediaError,y.screenshotFormat,y.screenshotQuality,y.minScreenshotWidth,y.minScreenshotHeight,y.audioConstraints,y.videoConstraints,y.imageSmoothing;var v=y.mirrored,b=y.style,k=b===void 0?{}:b,C=c(y,["audio","forceScreenshotSourceSize","onUserMedia","onUserMediaError","screenshotFormat","screenshotQuality","minScreenshotWidth","minScreenshotHeight","audioConstraints","videoConstraints","imageSmoothing","mirrored","style"]),N=v?l(l({},k),{transform:(k.transform||"")+" scaleX(-1)"}):k;return o.createElement("video",l({autoPlay:!0,src:g.src,muted:!x,playsInline:!0,ref:function(I){p.video=I},style:N},C))},f.defaultProps={audio:!1,forceScreenshotSourceSize:!1,imageSmoothing:!0,mirrored:!1,onUserMedia:function(){},onUserMediaError:function(){},screenshotFormat:"image/webp",screenshotQuality:.92},f}(o.Component);r.default=d},react:function(s,r){s.exports=n}}).default})})($7);var CWe=$7.exports;const TWe=Iw(CWe),NWe="/assets/count-9acf12e7.wav",PV=({currentPose:t,instructions:e})=>e[t]?S.jsx("ul",{style:{listStyleType:"disc",paddingLeft:"20px",margin:0},children:e[t].map((n,s)=>S.jsx("li",{className:"instruction",style:{marginBottom:"12px",fontSize:"1rem",color:"#222"},children:n},s))}):null,FV={Tree:["Get into position. Tree pose often starts from mountain pose (or Tadasana), with both feet planted firmly on the ground and your weight adequately distributed so that you are balanced.","Bend one leg at the knee. Choose the leg you are going to fold in first. If your left leg is your standing leg, keep your left foot planted on the ground, and slowly bend in your right leg at the right knee so that the sole of your right foot rests against your left inner thigh (known as the half-lotus position in Bikram yoga). Point the knee of your bent leg outward, away from your body.","Lengthen your body. Clasp your hands together in Anjali Mudra (also called the “prayer position”)","Hold and repeat. Hold the pose for as long as necessary, making sure to breathe properly. When you’re ready to switch legs, exhale, and return to mountain pose to start again."],Cobra:["Lie prone on the floor. Stretch your legs back, tops of the feet on the floor. Spread your hands on the floor under your shoulders. Hug the elbows back into your body.","On an inhalation, begin to straighten the arms to lift the chest off the floor, going only to the height at which you can maintain a connection through your pubis to your legs. Press the tailbone toward the pubis and lift the pubis toward the navel. Narrow the hip points. Firm but don’t harden the buttocks.","Firm the shoulder blades against the back, puffing the side ribs forward. Lift through the top of the sternum but avoid pushing the front ribs forward, which only hardens the lower back. Distribute the backbend evenly throughout the entire spine.","Hold the pose anywhere from 15 to 30 seconds, breathing easily. Release back to the floor with an exhalation.","Source: Yoga Journal - https://www.yogajournal.com/poses/types/cobra-pose-2/"],Dog:["Come onto your hands and knees, with your hands a tiny bit in front of your shoulders and your knees directly below your hips. Spread your palms, rooting down through all four corners of your hands, and turn your toes under.","Exhale and lift your knees from the floor, at first keeping your knees slightly bent and your heels lifted off the floor. Lengthen your tailbone away from the back of your pelvis, lift the sitting bones toward the ceiling, and draw your inner legs from your inner ankles up through your groins.","On an exhalation, push your top thighs back and stretch your heels toward the floor. Straighten your knees without locking them.","Firm your outer arms and press the bases of your index fingers actively into the floor. Lift along your inner arms from the wrists to the tops of the shoulders. Firm your shoulder blades against your back, then widen them and draw them toward your tailbone. Keep your head between your upper arms.","Stay in the pose for 10 or more breaths, then bend your knees on an exhalation and lower yourself into Child’s Pose","Source: Yoga Journal - https://www.yogajournal.com/poses/types/downward-facing-dog/"],Chair:["Stand straight and tall with your feet slightly wider than hip­-width apart and your arms at your sides.","Inhale and lift your arms next to your ears, stretching them straight and parallel with wrists and fingers long. Keep your shoulders down and spine neutral.","Exhale as you bend your knees, keeping your thighs and knees parallel. Lean your torso forward to create a right angle with the tops of your thighs. Keep your neck and head in line with your torso and arms. Hold for 30 seconds to 1 minute.","Source: classpass - https://classpass.com/movements/chair-pose"],Warrior:["Begin in lunge with your front knee bent, your back leg straight and your back heel lifted. Your hips and chest should be squared to front of the mat. Raise your arms above your head.","Move your hands to your heart, with palms pressed against each other in a prayer position. Lean forward until your back leg extends straight back, even with your hips. Keep your foot flexed and your gaze downward.","Make sure your standing leg is strong and straight, but not locked at knee. Reach your arms forward so your body forms a “T” shape.","Source classpass - https://classpass.com/movements/warrior-3-pose"],Traingle:["Begin standing, then lightly jump your feet apart to a wide position about three to four feet apart. Turn your left foot out and turn to face that direction. Take a slight bend in your left leg and raise your arms out on your sides, forming a “T” shape.","Straighten through your left leg, then hinge and reach your torso over your left leg as your hips jut back. Rotate your left palm so it faces the ceiling, and gaze out over your left arm.","Maintain a long, straight spine as you reach your left hand to the mat, placing it in front of your left foot. If you feel off balance, bring in your back leg closer to shorten your stance. Gaze towards your right arm, which should be extended overhead. Hold and repeat on the other side.","Source classpass - https://classpass.com/movements/triangle-pose"],Shoulderstand:["Start with a stack of two folded blankets. Lay down on your mat aligning shoulders onto the blankets. With legs bent and feet on the floor (as if setting up for bridge pose) begin to walk your shoulders underneath your upper back feeling the chest gently rising.","Lift your hips off of the mat coming into bridge pose and extend your arms onto the ground, palms facing down as if your hands could touch your heels. Press firmly into the palms using them as leverage to lift onto the balls of the feet and extend one leg up. Bend at the elbows, place your hands on your low back creating a shelf, and then extend the next leg up.","Once you raise the legs, don't turn your head to the side to look around the room, since you can injure your neck. Keep your gaze upward and your neck straight.","Lift up through the balls of your feet. Walk your hands further up the back for more stability. Feel the chest reaching towards the chin to support opening the upper back.","Move your hips toward the front of the room and your feet toward the back of the room to straighten the body. The correct alignment is with the hips over the shoulders and feet over the hips. Ask your teacher or a friend to help you determine if your legs are perpendicular to the floor.","Stay in the pose for up to 10 breaths","Source: verywellfit - https://www.verywellfit.com/shoulderstand-salamba-sarvangasana-3567115"]},ja={NOSE:0,LEFT_EYE:1,RIGHT_EYE:2,LEFT_EAR:3,RIGHT_EAR:4,LEFT_SHOULDER:5,RIGHT_SHOULDER:6,LEFT_ELBOW:7,RIGHT_ELBOW:8,LEFT_WRIST:9,RIGHT_WRIST:10,LEFT_HIP:11,RIGHT_HIP:12,LEFT_KNEE:13,RIGHT_KNEE:14,LEFT_ANKLE:15,RIGHT_ANKLE:16},IWe={nose:["left_ear","right_ear"],left_ear:["left_shoulder"],right_ear:["right_shoulder"],left_shoulder:["right_shoulder","left_elbow","left_hip"],right_shoulder:["right_elbow","right_hip"],left_elbow:["left_wrist"],right_elbow:["right_wrist"],left_hip:["left_knee","right_hip"],right_hip:["right_knee"],left_knee:["left_ankle"],right_knee:["right_ankle"]};const _We=({options:t,onSelect:e,selectedOption:n,poseImages:s})=>S.jsxs("div",{className:"flex items-center justify-center my-6",children:[S.jsx("select",{value:n,onChange:r=>e(r.target.value),className:"border-2 border-primary-300 rounded-xl px-5 py-2 text-base font-semibold bg-white text-primary-900 shadow focus:border-primary-500 outline-none min-w-[200px] transition-colors",children:t.map(r=>S.jsx("option",{value:r,className:"px-3 py-2 bg-white text-primary-700 font-semibold",children:r},r))}),S.jsx("img",{src:s[n],alt:n,className:"w-12 h-12 object-contain ml-4 rounded-xl border-2 border-primary-300 shadow bg-primary-50"})]}),EWe="/assets/chair-0ec1ba9e.jpg",$We="/assets/cobra-b0b93fe1.jpg",AWe="/assets/dog-2fb3d0d0.jpg",RWe="/assets/tree-950681ad.jpg",DWe="/assets/warrior-60b6d01e.jpg",OWe="/assets/traingle-390e7c85.jpg",PWe="/assets/shoulderstand-a9882824.jpg",gT={Tree:RWe,Cobra:$We,Dog:AWe,Warrior:DWe,Chair:EWe,Traingle:OWe,Shoulderstand:PWe};function FWe(t,[e,n],[s,r],i){t.beginPath(),t.moveTo(e,n),t.lineTo(s,r),t.lineWidth=5,t.strokeStyle=i,t.stroke()}function LWe(t,e,n,s,r){t.beginPath(),t.arc(e,n,s,0,2*Math.PI),t.fillStyle=r,t.fill()}let nv="rgb(255,255,255)";const MWe=["Tree","Chair","Cobra","Warrior","Dog","Shoulderstand","Traingle"];let yT,sv=!1;function zWe(){const t=D.useRef(null),e=D.useRef(null),[n,s]=D.useState(0),[r,i]=D.useState(0),[o,a]=D.useState(0),[l,c]=D.useState(0),[u,d]=D.useState("Tree"),[h,f]=D.useState(!1);D.useEffect(()=>{const N=(r-n)/1e3;sv&&a(N),(r-n)/1e3>l&&c(N)},[r]),D.useEffect(()=>{i(0),a(0),c(0)},[u]);const p={Chair:0,Cobra:1,Dog:2,No_Pose:3,Shoulderstand:4,Traingle:5,Tree:6,Warrior:7};function m(N,I,$){let A=Tc(N,I,1),P=Tc(N,$,1);return fe(Y(A,.5),Y(P,.5))}function g(N,I=2.5){let $=m(N,ja.LEFT_HIP,ja.RIGHT_HIP),A=m(N,ja.LEFT_SHOULDER,ja.RIGHT_SHOULDER),P=kd(Ae(A,$)),F=m(N,ja.LEFT_HIP,ja.RIGHT_HIP);F=as(F,1),F=Cc(F,[1,17,2]);let V=Tc(Ae(N,F),0,0),z=ro(kd(V,"euclidean",0));return Oa(Y(P,I),z)}function y(N){let I=m(N,ja.LEFT_HIP,ja.RIGHT_HIP);I=as(I,1),I=Cc(I,[1,17,2]),N=Ae(N,I);let $=g(N);return N=$e(N,$),N}function x(N){return N=y(as(N,0)),Q(N,[1,34])}const v=async()=>{const N={modelType:PCe.modelType.SINGLEPOSE_THUNDER},I=await OCe(ka.MoveNet,N),$=await vIe("https://models.s3.jp-tok.cloud-object-storage.appdomain.cloud/model.json"),A=new Audio(NWe);A.loop=!0,yT=setInterval(()=>{b(I,$,A)},100)},b=async(N,I,$)=>{if(t.current&&t.current.video&&t.current.video.readyState===4){let A=0;const P=t.current.video,F=await N.estimatePoses(P);if(!e.current)return;const V=e.current.getContext("2d");if(!V)return;V.clearRect(0,0,e.current.width,e.current.height);try{const z=F[0].keypoints;let B=z.map(M=>{if(M.score>.4){if(!(M.name==="left_eye"||M.name==="right_eye")){LWe(V,M.x,M.y,8,"rgb(255,255,255)");const G=IWe[M.name];try{G.forEach(ne=>{let ie=ne.toUpperCase();const de=ja[ie];FWe(V,[M.x,M.y],[z[de].x,z[de].y],nv)})}catch{}}}else A+=1;return[M.x,M.y]});if(A>4){nv="rgb(255,255,255)";return}const W=x(B);I.predict(W).array().then(M=>{const G=p[u];console.log(M[0][G]),M[0][G]>.97?(sv||($.play(),s(new Date(Date()).getTime()),sv=!0),i(new Date(Date()).getTime()),nv="rgb(0,255,0)"):(sv=!1,nv="rgb(255,255,255)",$.pause(),$.currentTime=0)})}catch(z){console.log(z)}}};function k(){f(!0),v()}function C(){f(!1),yT&&clearInterval(yT)}return S.jsxs("div",{className:"yoga-container w-full px-2 sm:px-4 md:px-8 max-w-6xl mx-auto",children:[S.jsx(_We,{options:MWe,selectedOption:u,onSelect:d,poseImages:gT}),!h&&S.jsxs("div",{className:"flex flex-col md:flex-row justify-center items-stretch gap-6 mt-8 w-full",children:[S.jsx("div",{className:"shadow-lg rounded-xl bg-white p-6 max-h-[350px] w-full md:w-[350px] overflow-y-auto flex-1",children:S.jsx(PV,{currentPose:u,instructions:FV})}),S.jsx("div",{className:"shadow-lg rounded-xl bg-white p-6 w-full md:w-[350px] flex items-center justify-center",children:S.jsx("img",{src:gT[u],className:"pose-img max-w-full max-h-[300px] object-contain",alt:u})})]}),h&&S.jsxs(S.Fragment,{children:[S.jsxs("div",{className:"w-full max-w-2xl mx-auto flex flex-wrap justify-between items-center py-6 gap-4",children:[S.jsx("button",{onClick:C,className:"secondary-btn min-w-[120px] flex-1",children:"Stop Pose"}),S.jsxs("div",{className:"pose-performance text-left",children:[S.jsxs("h4",{children:["Pose Time: ",o," s"]}),S.jsxs("h4",{children:["Best: ",l," s"]})]})]}),S.jsxs("div",{className:"relative w-full max-w-2xl mx-auto",children:[et.createElement(TWe,{width:"100%",height:"auto",id:"webcam",ref:t,style:{width:"100%",maxWidth:"640px",height:"auto",aspectRatio:"4/3",objectFit:"cover",borderRadius:"24px",boxShadow:"0 4px 24px rgba(67,198,172,0.18)",display:"block",margin:"0 auto"}}),S.jsx("canvas",{ref:e,id:"my-canvas",width:"640px",height:"480px",style:{position:"absolute",left:0,top:0,zIndex:1,width:"100%",maxWidth:"640px",height:"100%",pointerEvents:"none"}})]}),S.jsxs("div",{className:"flex flex-col md:flex-row justify-center items-stretch gap-6 mt-8 w-full",children:[S.jsx("div",{className:"shadow-lg rounded-xl bg-white p-6 max-h-[350px] w-full md:w-[350px] overflow-y-auto flex-1",children:S.jsx(PV,{currentPose:u,instructions:FV})}),S.jsx("div",{className:"shadow-lg rounded-xl bg-white p-6 w-full md:w-[350px] flex items-center justify-center",children:S.jsx("img",{src:gT[u],className:"pose-img max-w-full max-h-[300px] object-contain",alt:u})})]})]}),!h&&S.jsx("button",{onClick:k,className:"secondary-btn mt-8 w-full sm:w-auto",children:"Start Pose"})]})}function VWe(){return S.jsx(zWe,{})}function jWe(){return S.jsxs(vJ,{children:[S.jsx(yo,{path:"/",component:Vle}),S.jsx(yo,{path:"/login",component:aue}),S.jsx(yo,{path:"/signup",component:lue}),S.jsx(yo,{path:"/assessment",component:Qce}),S.jsx(yo,{path:"/routines",component:tue}),S.jsx(yo,{path:"/poses",component:nue}),S.jsx(yo,{path:"/start-routine",component:rue}),S.jsx(yo,{path:"/pose/:slug",component:oue}),S.jsx(yo,{path:"/profile",component:uge}),S.jsx(yo,{path:"/live-detection",component:VWe}),S.jsx(yo,{component:cue})]})}function BWe(){return S.jsx(D4,{client:$_,children:S.jsxs(Fse,{children:[S.jsx(Qte,{}),S.jsx(jle,{}),S.jsx(jWe,{})]})})}a4(document.getElementById("root")).render(S.jsx(D4,{client:$_,children:S.jsx(BWe,{})}));
